/*! For license information please see 857.min.js.LICENSE.txt */
(self.webpackChunkDoodle_world=self.webpackChunkDoodle_world||[]).push([[857],{7676:(e,t,r)=>{var n=r(5277),i=r(8768),s=TypeError;e.exports=function(e){if(n(e))return e;throw s(i(e)+" is not a function")}},5017:(e,t,r)=>{var n=r(5277),i=String,s=TypeError;e.exports=function(e){if("object"==typeof e||n(e))return e;throw s("Can't set "+i(e)+" as a prototype")}},6677:(e,t,r)=>{var n=r(2280),i=r(1569),s=r(6385).f,o=n("unscopables"),a=Array.prototype;null==a[o]&&s(a,o,{configurable:!0,value:i(null)}),e.exports=function(e){a[o][e]=!0}},3350:(e,t,r)=>{"use strict";var n=r(1140).charAt;e.exports=function(e,t,r){return t+(r?n(e,t).length:1)}},3875:(e,t,r)=>{var n=r(2786),i=String,s=TypeError;e.exports=function(e){if(n(e))return e;throw s(i(e)+" is not an object")}},379:(e,t,r)=>{"use strict";var n=r(8671).forEach,i=r(4324)("forEach");e.exports=i?[].forEach:function(e){return n(this,e,arguments.length>1?arguments[1]:void 0)}},4899:(e,t,r)=>{"use strict";var n=r(8166),i=r(9611),s=r(744),o=r(9637),a=r(8089),l=r(1536),c=r(7046),u=r(5039),h=r(1805),d=r(7193),p=Array;e.exports=function(e){var t=s(e),r=l(this),f=arguments.length,m=f>1?arguments[1]:void 0,g=void 0!==m;g&&(m=n(m,f>2?arguments[2]:void 0));var y,v,_,x,b,w,S=d(t),M=0;if(!S||this===p&&a(S))for(y=c(t),v=r?new this(y):p(y);y>M;M++)w=g?m(t[M],M):t[M],u(v,M,w);else for(b=(x=h(t,S)).next,v=r?new this:[];!(_=i(b,x)).done;M++)w=g?o(x,m,[_.value,M],!0):_.value,u(v,M,w);return v.length=M,v}},7190:(e,t,r)=>{var n=r(9580),i=r(2565),s=r(7046),o=function(e){return function(t,r,o){var a,l=n(t),c=s(l),u=i(o,c);if(e&&r!=r){for(;c>u;)if((a=l[u++])!=a)return!0}else for(;c>u;u++)if((e||u in l)&&l[u]===r)return e||u||0;return!e&&-1}};e.exports={includes:o(!0),indexOf:o(!1)}},8671:(e,t,r)=>{var n=r(8166),i=r(8697),s=r(8609),o=r(744),a=r(7046),l=r(150),c=i([].push),u=function(e){var t=1==e,r=2==e,i=3==e,u=4==e,h=6==e,d=7==e,p=5==e||h;return function(f,m,g,y){for(var v,_,x=o(f),b=s(x),w=n(m,g),S=a(b),M=0,T=y||l,E=t?T(f,S):r||d?T(f,0):void 0;S>M;M++)if((p||M in b)&&(_=w(v=b[M],M,x),e))if(t)E[M]=_;else if(_)switch(e){case 3:return!0;case 5:return v;case 6:return M;case 2:c(E,v)}else switch(e){case 4:return!1;case 7:c(E,v)}return h?-1:i||u?u:E}};e.exports={forEach:u(0),map:u(1),filter:u(2),some:u(3),every:u(4),find:u(5),findIndex:u(6),filterReject:u(7)}},2091:(e,t,r)=>{var n=r(9044),i=r(2280),s=r(1197),o=i("species");e.exports=function(e){return s>=51||!n((function(){var t=[];return(t.constructor={})[o]=function(){return{foo:1}},1!==t[e](Boolean).foo}))}},4324:(e,t,r)=>{"use strict";var n=r(9044);e.exports=function(e,t){var r=[][e];return!!r&&n((function(){r.call(null,t||function(){return 1},1)}))}},1478:(e,t,r)=>{"use strict";var n=r(7493),i=r(1982),s=TypeError,o=Object.getOwnPropertyDescriptor,a=n&&!function(){if(void 0!==this)return!0;try{Object.defineProperty([],"length",{writable:!1}).length=1}catch(e){return e instanceof TypeError}}();e.exports=a?function(e,t){if(i(e)&&!o(e,"length").writable)throw s("Cannot set read only .length");return e.length=t}:function(e,t){return e.length=t}},8990:(e,t,r)=>{var n=r(2565),i=r(7046),s=r(5039),o=Array,a=Math.max;e.exports=function(e,t,r){for(var l=i(e),c=n(t,l),u=n(void 0===r?l:r,l),h=o(a(u-c,0)),d=0;c<u;c++,d++)s(h,d,e[c]);return h.length=d,h}},5629:(e,t,r)=>{var n=r(8697);e.exports=n([].slice)},2013:(e,t,r)=>{var n=r(8990),i=Math.floor,s=function(e,t){var r=e.length,l=i(r/2);return r<8?o(e,t):a(e,s(n(e,0,l),t),s(n(e,l),t),t)},o=function(e,t){for(var r,n,i=e.length,s=1;s<i;){for(n=s,r=e[s];n&&t(e[n-1],r)>0;)e[n]=e[--n];n!==s++&&(e[n]=r)}return e},a=function(e,t,r,n){for(var i=t.length,s=r.length,o=0,a=0;o<i||a<s;)e[o+a]=o<i&&a<s?n(t[o],r[a])<=0?t[o++]:r[a++]:o<i?t[o++]:r[a++];return e};e.exports=s},765:(e,t,r)=>{var n=r(1982),i=r(1536),s=r(2786),o=r(2280)("species"),a=Array;e.exports=function(e){var t;return n(e)&&(t=e.constructor,(i(t)&&(t===a||n(t.prototype))||s(t)&&null===(t=t[o]))&&(t=void 0)),void 0===t?a:t}},150:(e,t,r)=>{var n=r(765);e.exports=function(e,t){return new(n(e))(0===t?0:t)}},9637:(e,t,r)=>{var n=r(3875),i=r(8744);e.exports=function(e,t,r,s){try{return s?t(n(r)[0],r[1]):t(r)}catch(t){i(e,"throw",t)}}},8662:(e,t,r)=>{var n=r(2280)("iterator"),i=!1;try{var s=0,o={next:function(){return{done:!!s++}},return:function(){i=!0}};o[n]=function(){return this},Array.from(o,(function(){throw 2}))}catch(e){}e.exports=function(e,t){if(!t&&!i)return!1;var r=!1;try{var s={};s[n]=function(){return{next:function(){return{done:r=!0}}}},e(s)}catch(e){}return r}},9159:(e,t,r)=>{var n=r(8697),i=n({}.toString),s=n("".slice);e.exports=function(e){return s(i(e),8,-1)}},6994:(e,t,r)=>{var n=r(7301),i=r(5277),s=r(9159),o=r(2280)("toStringTag"),a=Object,l="Arguments"==s(function(){return arguments}());e.exports=n?s:function(e){var t,r,n;return void 0===e?"Undefined":null===e?"Null":"string"==typeof(r=function(e,t){try{return e[t]}catch(e){}}(t=a(e),o))?r:l?s(t):"Object"==(n=s(t))&&i(t.callee)?"Arguments":n}},3870:(e,t,r)=>{var n=r(4792),i=r(1561),s=r(6012),o=r(6385);e.exports=function(e,t,r){for(var a=i(t),l=o.f,c=s.f,u=0;u<a.length;u++){var h=a[u];n(e,h)||r&&n(r,h)||l(e,h,c(t,h))}}},5115:(e,t,r)=>{var n=r(9044);e.exports=!n((function(){function e(){}return e.prototype.constructor=null,Object.getPrototypeOf(new e)!==e.prototype}))},6145:e=>{e.exports=function(e,t){return{value:e,done:t}}},5899:(e,t,r)=>{var n=r(7493),i=r(6385),s=r(9199);e.exports=n?function(e,t,r){return i.f(e,t,s(1,r))}:function(e,t,r){return e[t]=r,e}},9199:e=>{e.exports=function(e,t){return{enumerable:!(1&e),configurable:!(2&e),writable:!(4&e),value:t}}},5039:(e,t,r)=>{"use strict";var n=r(383),i=r(6385),s=r(9199);e.exports=function(e,t,r){var o=n(t);o in e?i.f(e,o,s(0,r)):e[o]=r}},7707:(e,t,r)=>{"use strict";var n=r(3875),i=r(7141),s=TypeError;e.exports=function(e){if(n(this),"string"===e||"default"===e)e="string";else if("number"!==e)throw s("Incorrect hint");return i(this,e)}},3600:(e,t,r)=>{var n=r(833),i=r(6385);e.exports=function(e,t,r){return r.get&&n(r.get,t,{getter:!0}),r.set&&n(r.set,t,{setter:!0}),i.f(e,t,r)}},403:(e,t,r)=>{var n=r(5277),i=r(6385),s=r(833),o=r(2359);e.exports=function(e,t,r,a){a||(a={});var l=a.enumerable,c=void 0!==a.name?a.name:t;if(n(r)&&s(r,c,a),a.global)l?e[t]=r:o(t,r);else{try{a.unsafe?e[t]&&(l=!0):delete e[t]}catch(e){}l?e[t]=r:i.f(e,t,{value:r,enumerable:!1,configurable:!a.nonConfigurable,writable:!a.nonWritable})}return e}},2359:(e,t,r)=>{var n=r(8363),i=Object.defineProperty;e.exports=function(e,t){try{i(n,e,{value:t,configurable:!0,writable:!0})}catch(r){n[e]=t}return t}},3731:(e,t,r)=>{"use strict";var n=r(8768),i=TypeError;e.exports=function(e,t){if(!delete e[t])throw i("Cannot delete property "+n(t)+" of "+n(e))}},7493:(e,t,r)=>{var n=r(9044);e.exports=!n((function(){return 7!=Object.defineProperty({},1,{get:function(){return 7}})[1]}))},3966:e=>{var t="object"==typeof document&&document.all,r=void 0===t&&void 0!==t;e.exports={all:t,IS_HTMLDDA:r}},2750:(e,t,r)=>{var n=r(8363),i=r(2786),s=n.document,o=i(s)&&i(s.createElement);e.exports=function(e){return o?s.createElement(e):{}}},4758:e=>{var t=TypeError;e.exports=function(e){if(e>9007199254740991)throw t("Maximum allowed index exceeded");return e}},2848:e=>{e.exports={CSSRuleList:0,CSSStyleDeclaration:0,CSSValueList:0,ClientRectList:0,DOMRectList:0,DOMStringList:0,DOMTokenList:1,DataTransferItemList:0,FileList:0,HTMLAllCollection:0,HTMLCollection:0,HTMLFormElement:0,HTMLSelectElement:0,MediaList:0,MimeTypeArray:0,NamedNodeMap:0,NodeList:1,PaintRequestList:0,Plugin:0,PluginArray:0,SVGLengthList:0,SVGNumberList:0,SVGPathSegList:0,SVGPointList:0,SVGStringList:0,SVGTransformList:0,SourceBufferList:0,StyleSheetList:0,TextTrackCueList:0,TextTrackList:0,TouchList:0}},9189:(e,t,r)=>{var n=r(2750)("span").classList,i=n&&n.constructor&&n.constructor.prototype;e.exports=i===Object.prototype?void 0:i},4631:(e,t,r)=>{var n=r(2647).match(/firefox\/(\d+)/i);e.exports=!!n&&+n[1]},442:(e,t,r)=>{var n=r(2647);e.exports=/MSIE|Trident/.test(n)},2647:e=>{e.exports="undefined"!=typeof navigator&&String(navigator.userAgent)||""},1197:(e,t,r)=>{var n,i,s=r(8363),o=r(2647),a=s.process,l=s.Deno,c=a&&a.versions||l&&l.version,u=c&&c.v8;u&&(i=(n=u.split("."))[0]>0&&n[0]<4?1:+(n[0]+n[1])),!i&&o&&(!(n=o.match(/Edge\/(\d+)/))||n[1]>=74)&&(n=o.match(/Chrome\/(\d+)/))&&(i=+n[1]),e.exports=i},6929:(e,t,r)=>{var n=r(2647).match(/AppleWebKit\/(\d+)\./);e.exports=!!n&&+n[1]},8869:e=>{e.exports=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"]},9882:(e,t,r)=>{var n=r(8363),i=r(6012).f,s=r(5899),o=r(403),a=r(2359),l=r(3870),c=r(6291);e.exports=function(e,t){var r,u,h,d,p,f=e.target,m=e.global,g=e.stat;if(r=m?n:g?n[f]||a(f,{}):(n[f]||{}).prototype)for(u in t){if(d=t[u],h=e.dontCallGetSet?(p=i(r,u))&&p.value:r[u],!c(m?u:f+(g?".":"#")+u,e.forced)&&void 0!==h){if(typeof d==typeof h)continue;l(d,h)}(e.sham||h&&h.sham)&&s(d,"sham",!0),o(r,u,d,e)}}},9044:e=>{e.exports=function(e){try{return!!e()}catch(e){return!0}}},1492:(e,t,r)=>{"use strict";r(9275);var n=r(5785),i=r(403),s=r(9749),o=r(9044),a=r(2280),l=r(5899),c=a("species"),u=RegExp.prototype;e.exports=function(e,t,r,h){var d=a(e),p=!o((function(){var t={};return t[d]=function(){return 7},7!=""[e](t)})),f=p&&!o((function(){var t=!1,r=/a/;return"split"===e&&((r={}).constructor={},r.constructor[c]=function(){return r},r.flags="",r[d]=/./[d]),r.exec=function(){return t=!0,null},r[d](""),!t}));if(!p||!f||r){var m=n(/./[d]),g=t(d,""[e],(function(e,t,r,i,o){var a=n(e),l=t.exec;return l===s||l===u.exec?p&&!o?{done:!0,value:m(t,r,i)}:{done:!0,value:a(r,t,i)}:{done:!1}}));i(String.prototype,e,g[0]),i(u,d,g[1])}h&&l(u[d],"sham",!0)}},3530:(e,t,r)=>{var n=r(3996),i=Function.prototype,s=i.apply,o=i.call;e.exports="object"==typeof Reflect&&Reflect.apply||(n?o.bind(s):function(){return o.apply(s,arguments)})},8166:(e,t,r)=>{var n=r(5785),i=r(7676),s=r(3996),o=n(n.bind);e.exports=function(e,t){return i(e),void 0===t?e:s?o(e,t):function(){return e.apply(t,arguments)}}},3996:(e,t,r)=>{var n=r(9044);e.exports=!n((function(){var e=function(){}.bind();return"function"!=typeof e||e.hasOwnProperty("prototype")}))},9611:(e,t,r)=>{var n=r(3996),i=Function.prototype.call;e.exports=n?i.bind(i):function(){return i.apply(i,arguments)}},5316:(e,t,r)=>{var n=r(7493),i=r(4792),s=Function.prototype,o=n&&Object.getOwnPropertyDescriptor,a=i(s,"name"),l=a&&"something"===function(){}.name,c=a&&(!n||n&&o(s,"name").configurable);e.exports={EXISTS:a,PROPER:l,CONFIGURABLE:c}},2575:(e,t,r)=>{var n=r(8697),i=r(7676);e.exports=function(e,t,r){try{return n(i(Object.getOwnPropertyDescriptor(e,t)[r]))}catch(e){}}},5785:(e,t,r)=>{var n=r(9159),i=r(8697);e.exports=function(e){if("Function"===n(e))return i(e)}},8697:(e,t,r)=>{var n=r(3996),i=Function.prototype,s=i.call,o=n&&i.bind.bind(s,s);e.exports=n?o:function(e){return function(){return s.apply(e,arguments)}}},2773:(e,t,r)=>{var n=r(8363),i=r(5277),s=function(e){return i(e)?e:void 0};e.exports=function(e,t){return arguments.length<2?s(n[e]):n[e]&&n[e][t]}},7193:(e,t,r)=>{var n=r(6994),i=r(7219),s=r(9903),o=r(4818),a=r(2280)("iterator");e.exports=function(e){if(!s(e))return i(e,a)||i(e,"@@iterator")||o[n(e)]}},1805:(e,t,r)=>{var n=r(9611),i=r(7676),s=r(3875),o=r(8768),a=r(7193),l=TypeError;e.exports=function(e,t){var r=arguments.length<2?a(e):t;if(i(r))return s(n(r,e));throw l(o(e)+" is not iterable")}},6590:(e,t,r)=>{var n=r(8697),i=r(1982),s=r(5277),o=r(9159),a=r(8967),l=n([].push);e.exports=function(e){if(s(e))return e;if(i(e)){for(var t=e.length,r=[],n=0;n<t;n++){var c=e[n];"string"==typeof c?l(r,c):"number"!=typeof c&&"Number"!=o(c)&&"String"!=o(c)||l(r,a(c))}var u=r.length,h=!0;return function(e,t){if(h)return h=!1,t;if(i(this))return t;for(var n=0;n<u;n++)if(r[n]===e)return t}}}},7219:(e,t,r)=>{var n=r(7676),i=r(9903);e.exports=function(e,t){var r=e[t];return i(r)?void 0:n(r)}},1373:(e,t,r)=>{var n=r(8697),i=r(744),s=Math.floor,o=n("".charAt),a=n("".replace),l=n("".slice),c=/\$([$&'`]|\d{1,2}|<[^>]*>)/g,u=/\$([$&'`]|\d{1,2})/g;e.exports=function(e,t,r,n,h,d){var p=r+e.length,f=n.length,m=u;return void 0!==h&&(h=i(h),m=c),a(d,m,(function(i,a){var c;switch(o(a,0)){case"$":return"$";case"&":return e;case"`":return l(t,0,r);case"'":return l(t,p);case"<":c=h[l(a,1,-1)];break;default:var u=+a;if(0===u)return i;if(u>f){var d=s(u/10);return 0===d?i:d<=f?void 0===n[d-1]?o(a,1):n[d-1]+o(a,1):i}c=n[u-1]}return void 0===c?"":c}))}},8363:(e,t,r)=>{var n=function(e){return e&&e.Math==Math&&e};e.exports=n("object"==typeof globalThis&&globalThis)||n("object"==typeof window&&window)||n("object"==typeof self&&self)||n("object"==typeof r.g&&r.g)||function(){return this}()||Function("return this")()},4792:(e,t,r)=>{var n=r(8697),i=r(744),s=n({}.hasOwnProperty);e.exports=Object.hasOwn||function(e,t){return s(i(e),t)}},7505:e=>{e.exports={}},7055:(e,t,r)=>{var n=r(2773);e.exports=n("document","documentElement")},7548:(e,t,r)=>{var n=r(7493),i=r(9044),s=r(2750);e.exports=!n&&!i((function(){return 7!=Object.defineProperty(s("div"),"a",{get:function(){return 7}}).a}))},8609:(e,t,r)=>{var n=r(8697),i=r(9044),s=r(9159),o=Object,a=n("".split);e.exports=i((function(){return!o("z").propertyIsEnumerable(0)}))?function(e){return"String"==s(e)?a(e,""):o(e)}:o},9250:(e,t,r)=>{var n=r(5277),i=r(2786),s=r(2412);e.exports=function(e,t,r){var o,a;return s&&n(o=t.constructor)&&o!==r&&i(a=o.prototype)&&a!==r.prototype&&s(e,a),e}},6429:(e,t,r)=>{var n=r(8697),i=r(5277),s=r(9415),o=n(Function.toString);i(s.inspectSource)||(s.inspectSource=function(e){return o(e)}),e.exports=s.inspectSource},821:(e,t,r)=>{var n,i,s,o=r(2512),a=r(8363),l=r(2786),c=r(5899),u=r(4792),h=r(9415),d=r(466),p=r(7505),f="Object already initialized",m=a.TypeError,g=a.WeakMap;if(o||h.state){var y=h.state||(h.state=new g);y.get=y.get,y.has=y.has,y.set=y.set,n=function(e,t){if(y.has(e))throw m(f);return t.facade=e,y.set(e,t),t},i=function(e){return y.get(e)||{}},s=function(e){return y.has(e)}}else{var v=d("state");p[v]=!0,n=function(e,t){if(u(e,v))throw m(f);return t.facade=e,c(e,v,t),t},i=function(e){return u(e,v)?e[v]:{}},s=function(e){return u(e,v)}}e.exports={set:n,get:i,has:s,enforce:function(e){return s(e)?i(e):n(e,{})},getterFor:function(e){return function(t){var r;if(!l(t)||(r=i(t)).type!==e)throw m("Incompatible receiver, "+e+" required");return r}}}},8089:(e,t,r)=>{var n=r(2280),i=r(4818),s=n("iterator"),o=Array.prototype;e.exports=function(e){return void 0!==e&&(i.Array===e||o[s]===e)}},1982:(e,t,r)=>{var n=r(9159);e.exports=Array.isArray||function(e){return"Array"==n(e)}},5277:(e,t,r)=>{var n=r(3966),i=n.all;e.exports=n.IS_HTMLDDA?function(e){return"function"==typeof e||e===i}:function(e){return"function"==typeof e}},1536:(e,t,r)=>{var n=r(8697),i=r(9044),s=r(5277),o=r(6994),a=r(2773),l=r(6429),c=function(){},u=[],h=a("Reflect","construct"),d=/^\s*(?:class|function)\b/,p=n(d.exec),f=!d.exec(c),m=function(e){if(!s(e))return!1;try{return h(c,u,e),!0}catch(e){return!1}},g=function(e){if(!s(e))return!1;switch(o(e)){case"AsyncFunction":case"GeneratorFunction":case"AsyncGeneratorFunction":return!1}try{return f||!!p(d,l(e))}catch(e){return!0}};g.sham=!0,e.exports=!h||i((function(){var e;return m(m.call)||!m(Object)||!m((function(){e=!0}))||e}))?g:m},6291:(e,t,r)=>{var n=r(9044),i=r(5277),s=/#|\.prototype\./,o=function(e,t){var r=l[a(e)];return r==u||r!=c&&(i(t)?n(t):!!t)},a=o.normalize=function(e){return String(e).replace(s,".").toLowerCase()},l=o.data={},c=o.NATIVE="N",u=o.POLYFILL="P";e.exports=o},9903:e=>{e.exports=function(e){return null==e}},2786:(e,t,r)=>{var n=r(5277),i=r(3966),s=i.all;e.exports=i.IS_HTMLDDA?function(e){return"object"==typeof e?null!==e:n(e)||e===s}:function(e){return"object"==typeof e?null!==e:n(e)}},1178:e=>{e.exports=!1},6681:(e,t,r)=>{var n=r(2773),i=r(5277),s=r(2010),o=r(189),a=Object;e.exports=o?function(e){return"symbol"==typeof e}:function(e){var t=n("Symbol");return i(t)&&s(t.prototype,a(e))}},8744:(e,t,r)=>{var n=r(9611),i=r(3875),s=r(7219);e.exports=function(e,t,r){var o,a;i(e);try{if(!(o=s(e,"return"))){if("throw"===t)throw r;return r}o=n(o,e)}catch(e){a=!0,o=e}if("throw"===t)throw r;if(a)throw o;return i(o),r}},9952:(e,t,r)=>{"use strict";var n=r(7022).IteratorPrototype,i=r(1569),s=r(9199),o=r(878),a=r(4818),l=function(){return this};e.exports=function(e,t,r,c){var u=t+" Iterator";return e.prototype=i(n,{next:s(+!c,r)}),o(e,u,!1,!0),a[u]=l,e}},8150:(e,t,r)=>{"use strict";var n=r(9882),i=r(9611),s=r(1178),o=r(5316),a=r(5277),l=r(9952),c=r(2654),u=r(2412),h=r(878),d=r(5899),p=r(403),f=r(2280),m=r(4818),g=r(7022),y=o.PROPER,v=o.CONFIGURABLE,_=g.IteratorPrototype,x=g.BUGGY_SAFARI_ITERATORS,b=f("iterator"),w="keys",S="values",M="entries",T=function(){return this};e.exports=function(e,t,r,o,f,g,E){l(r,t,o);var A,C,L,R=function(e){if(e===f&&O)return O;if(!x&&e in I)return I[e];switch(e){case w:case S:case M:return function(){return new r(this,e)}}return function(){return new r(this)}},P=t+" Iterator",j=!1,I=e.prototype,D=I[b]||I["@@iterator"]||f&&I[f],O=!x&&D||R(f),N="Array"==t&&I.entries||D;if(N&&(A=c(N.call(new e)))!==Object.prototype&&A.next&&(s||c(A)===_||(u?u(A,_):a(A[b])||p(A,b,T)),h(A,P,!0,!0),s&&(m[P]=T)),y&&f==S&&D&&D.name!==S&&(!s&&v?d(I,"name",S):(j=!0,O=function(){return i(D,this)})),f)if(C={values:R(S),keys:g?O:R(w),entries:R(M)},E)for(L in C)(x||j||!(L in I))&&p(I,L,C[L]);else n({target:t,proto:!0,forced:x||j},C);return s&&!E||I[b]===O||p(I,b,O,{name:f}),m[t]=O,C}},7022:(e,t,r)=>{"use strict";var n,i,s,o=r(9044),a=r(5277),l=r(2786),c=r(1569),u=r(2654),h=r(403),d=r(2280),p=r(1178),f=d("iterator"),m=!1;[].keys&&("next"in(s=[].keys())?(i=u(u(s)))!==Object.prototype&&(n=i):m=!0),!l(n)||o((function(){var e={};return n[f].call(e)!==e}))?n={}:p&&(n=c(n)),a(n[f])||h(n,f,(function(){return this})),e.exports={IteratorPrototype:n,BUGGY_SAFARI_ITERATORS:m}},4818:e=>{e.exports={}},7046:(e,t,r)=>{var n=r(5108);e.exports=function(e){return n(e.length)}},833:(e,t,r)=>{var n=r(8697),i=r(9044),s=r(5277),o=r(4792),a=r(7493),l=r(5316).CONFIGURABLE,c=r(6429),u=r(821),h=u.enforce,d=u.get,p=String,f=Object.defineProperty,m=n("".slice),g=n("".replace),y=n([].join),v=a&&!i((function(){return 8!==f((function(){}),"length",{value:8}).length})),_=String(String).split("String"),x=e.exports=function(e,t,r){"Symbol("===m(p(t),0,7)&&(t="["+g(p(t),/^Symbol\(([^)]*)\)/,"$1")+"]"),r&&r.getter&&(t="get "+t),r&&r.setter&&(t="set "+t),(!o(e,"name")||l&&e.name!==t)&&(a?f(e,"name",{value:t,configurable:!0}):e.name=t),v&&r&&o(r,"arity")&&e.length!==r.arity&&f(e,"length",{value:r.arity});try{r&&o(r,"constructor")&&r.constructor?a&&f(e,"prototype",{writable:!1}):e.prototype&&(e.prototype=void 0)}catch(e){}var n=h(e);return o(n,"source")||(n.source=y(_,"string"==typeof t?t:"")),e};Function.prototype.toString=x((function(){return s(this)&&d(this).source||c(this)}),"toString")},8300:e=>{var t=Math.ceil,r=Math.floor;e.exports=Math.trunc||function(e){var n=+e;return(n>0?r:t)(n)}},1569:(e,t,r)=>{var n,i=r(3875),s=r(7840),o=r(8869),a=r(7505),l=r(7055),c=r(2750),u=r(466),h="prototype",d="script",p=u("IE_PROTO"),f=function(){},m=function(e){return"<"+d+">"+e+"</"+d+">"},g=function(e){e.write(m("")),e.close();var t=e.parentWindow.Object;return e=null,t},y=function(){try{n=new ActiveXObject("htmlfile")}catch(e){}var e,t,r;y="undefined"!=typeof document?document.domain&&n?g(n):(t=c("iframe"),r="java"+d+":",t.style.display="none",l.appendChild(t),t.src=String(r),(e=t.contentWindow.document).open(),e.write(m("document.F=Object")),e.close(),e.F):g(n);for(var i=o.length;i--;)delete y[h][o[i]];return y()};a[p]=!0,e.exports=Object.create||function(e,t){var r;return null!==e?(f[h]=i(e),r=new f,f[h]=null,r[p]=e):r=y(),void 0===t?r:s.f(r,t)}},7840:(e,t,r)=>{var n=r(7493),i=r(1010),s=r(6385),o=r(3875),a=r(9580),l=r(667);t.f=n&&!i?Object.defineProperties:function(e,t){o(e);for(var r,n=a(t),i=l(t),c=i.length,u=0;c>u;)s.f(e,r=i[u++],n[r]);return e}},6385:(e,t,r)=>{var n=r(7493),i=r(7548),s=r(1010),o=r(3875),a=r(383),l=TypeError,c=Object.defineProperty,u=Object.getOwnPropertyDescriptor,h="enumerable",d="configurable",p="writable";t.f=n?s?function(e,t,r){if(o(e),t=a(t),o(r),"function"==typeof e&&"prototype"===t&&"value"in r&&p in r&&!r[p]){var n=u(e,t);n&&n[p]&&(e[t]=r.value,r={configurable:d in r?r[d]:n[d],enumerable:h in r?r[h]:n[h],writable:!1})}return c(e,t,r)}:c:function(e,t,r){if(o(e),t=a(t),o(r),i)try{return c(e,t,r)}catch(e){}if("get"in r||"set"in r)throw l("Accessors not supported");return"value"in r&&(e[t]=r.value),e}},6012:(e,t,r)=>{var n=r(7493),i=r(9611),s=r(1513),o=r(9199),a=r(9580),l=r(383),c=r(4792),u=r(7548),h=Object.getOwnPropertyDescriptor;t.f=n?h:function(e,t){if(e=a(e),t=l(t),u)try{return h(e,t)}catch(e){}if(c(e,t))return o(!i(s.f,e,t),e[t])}},4938:(e,t,r)=>{var n=r(9159),i=r(9580),s=r(7994).f,o=r(8990),a="object"==typeof window&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[];e.exports.f=function(e){return a&&"Window"==n(e)?function(e){try{return s(e)}catch(e){return o(a)}}(e):s(i(e))}},7994:(e,t,r)=>{var n=r(8794),i=r(8869).concat("length","prototype");t.f=Object.getOwnPropertyNames||function(e){return n(e,i)}},9612:(e,t)=>{t.f=Object.getOwnPropertySymbols},2654:(e,t,r)=>{var n=r(4792),i=r(5277),s=r(744),o=r(466),a=r(5115),l=o("IE_PROTO"),c=Object,u=c.prototype;e.exports=a?c.getPrototypeOf:function(e){var t=s(e);if(n(t,l))return t[l];var r=t.constructor;return i(r)&&t instanceof r?r.prototype:t instanceof c?u:null}},2010:(e,t,r)=>{var n=r(8697);e.exports=n({}.isPrototypeOf)},8794:(e,t,r)=>{var n=r(8697),i=r(4792),s=r(9580),o=r(7190).indexOf,a=r(7505),l=n([].push);e.exports=function(e,t){var r,n=s(e),c=0,u=[];for(r in n)!i(a,r)&&i(n,r)&&l(u,r);for(;t.length>c;)i(n,r=t[c++])&&(~o(u,r)||l(u,r));return u}},667:(e,t,r)=>{var n=r(8794),i=r(8869);e.exports=Object.keys||function(e){return n(e,i)}},1513:(e,t)=>{"use strict";var r={}.propertyIsEnumerable,n=Object.getOwnPropertyDescriptor,i=n&&!r.call({1:2},1);t.f=i?function(e){var t=n(this,e);return!!t&&t.enumerable}:r},2412:(e,t,r)=>{var n=r(2575),i=r(3875),s=r(5017);e.exports=Object.setPrototypeOf||("__proto__"in{}?function(){var e,t=!1,r={};try{(e=n(Object.prototype,"__proto__","set"))(r,[]),t=r instanceof Array}catch(e){}return function(r,n){return i(r),s(n),t?e(r,n):r.__proto__=n,r}}():void 0)},6699:(e,t,r)=>{"use strict";var n=r(7301),i=r(6994);e.exports=n?{}.toString:function(){return"[object "+i(this)+"]"}},7141:(e,t,r)=>{var n=r(9611),i=r(5277),s=r(2786),o=TypeError;e.exports=function(e,t){var r,a;if("string"===t&&i(r=e.toString)&&!s(a=n(r,e)))return a;if(i(r=e.valueOf)&&!s(a=n(r,e)))return a;if("string"!==t&&i(r=e.toString)&&!s(a=n(r,e)))return a;throw o("Can't convert object to primitive value")}},1561:(e,t,r)=>{var n=r(2773),i=r(8697),s=r(7994),o=r(9612),a=r(3875),l=i([].concat);e.exports=n("Reflect","ownKeys")||function(e){var t=s.f(a(e)),r=o.f;return r?l(t,r(e)):t}},7290:(e,t,r)=>{var n=r(8363);e.exports=n},4088:(e,t,r)=>{var n=r(9611),i=r(3875),s=r(5277),o=r(9159),a=r(9749),l=TypeError;e.exports=function(e,t){var r=e.exec;if(s(r)){var c=n(r,e,t);return null!==c&&i(c),c}if("RegExp"===o(e))return n(a,e,t);throw l("RegExp#exec called on incompatible receiver")}},9749:(e,t,r)=>{"use strict";var n,i,s=r(9611),o=r(8697),a=r(8967),l=r(8083),c=r(7047),u=r(3580),h=r(1569),d=r(821).get,p=r(1669),f=r(1638),m=u("native-string-replace",String.prototype.replace),g=RegExp.prototype.exec,y=g,v=o("".charAt),_=o("".indexOf),x=o("".replace),b=o("".slice),w=(i=/b*/g,s(g,n=/a/,"a"),s(g,i,"a"),0!==n.lastIndex||0!==i.lastIndex),S=c.BROKEN_CARET,M=void 0!==/()??/.exec("")[1];(w||M||S||p||f)&&(y=function(e){var t,r,n,i,o,c,u,p=this,f=d(p),T=a(e),E=f.raw;if(E)return E.lastIndex=p.lastIndex,t=s(y,E,T),p.lastIndex=E.lastIndex,t;var A=f.groups,C=S&&p.sticky,L=s(l,p),R=p.source,P=0,j=T;if(C&&(L=x(L,"y",""),-1===_(L,"g")&&(L+="g"),j=b(T,p.lastIndex),p.lastIndex>0&&(!p.multiline||p.multiline&&"\n"!==v(T,p.lastIndex-1))&&(R="(?: "+R+")",j=" "+j,P++),r=new RegExp("^(?:"+R+")",L)),M&&(r=new RegExp("^"+R+"$(?!\\s)",L)),w&&(n=p.lastIndex),i=s(g,C?r:p,j),C?i?(i.input=b(i.input,P),i[0]=b(i[0],P),i.index=p.lastIndex,p.lastIndex+=i[0].length):p.lastIndex=0:w&&i&&(p.lastIndex=p.global?i.index+i[0].length:n),M&&i&&i.length>1&&s(m,i[0],r,(function(){for(o=1;o<arguments.length-2;o++)void 0===arguments[o]&&(i[o]=void 0)})),i&&A)for(i.groups=c=h(null),o=0;o<A.length;o++)c[(u=A[o])[0]]=i[u[1]];return i}),e.exports=y},8083:(e,t,r)=>{"use strict";var n=r(3875);e.exports=function(){var e=n(this),t="";return e.hasIndices&&(t+="d"),e.global&&(t+="g"),e.ignoreCase&&(t+="i"),e.multiline&&(t+="m"),e.dotAll&&(t+="s"),e.unicode&&(t+="u"),e.unicodeSets&&(t+="v"),e.sticky&&(t+="y"),t}},7047:(e,t,r)=>{var n=r(9044),i=r(8363).RegExp,s=n((function(){var e=i("a","y");return e.lastIndex=2,null!=e.exec("abcd")})),o=s||n((function(){return!i("a","y").sticky})),a=s||n((function(){var e=i("^r","gy");return e.lastIndex=2,null!=e.exec("str")}));e.exports={BROKEN_CARET:a,MISSED_STICKY:o,UNSUPPORTED_Y:s}},1669:(e,t,r)=>{var n=r(9044),i=r(8363).RegExp;e.exports=n((function(){var e=i(".","s");return!(e.dotAll&&e.exec("\n")&&"s"===e.flags)}))},1638:(e,t,r)=>{var n=r(9044),i=r(8363).RegExp;e.exports=n((function(){var e=i("(?<a>b)","g");return"b"!==e.exec("b").groups.a||"bc"!=="b".replace(e,"$<a>c")}))},6411:(e,t,r)=>{var n=r(9903),i=TypeError;e.exports=function(e){if(n(e))throw i("Can't call method on "+e);return e}},878:(e,t,r)=>{var n=r(6385).f,i=r(4792),s=r(2280)("toStringTag");e.exports=function(e,t,r){e&&!r&&(e=e.prototype),e&&!i(e,s)&&n(e,s,{configurable:!0,value:t})}},466:(e,t,r)=>{var n=r(3580),i=r(4524),s=n("keys");e.exports=function(e){return s[e]||(s[e]=i(e))}},9415:(e,t,r)=>{var n=r(8363),i=r(2359),s="__core-js_shared__",o=n[s]||i(s,{});e.exports=o},3580:(e,t,r)=>{var n=r(1178),i=r(9415);(e.exports=function(e,t){return i[e]||(i[e]=void 0!==t?t:{})})("versions",[]).push({version:"3.29.0",mode:n?"pure":"global",copyright:"© 2014-2023 Denis Pushkarev (zloirock.ru)",license:"https://github.com/zloirock/core-js/blob/v3.29.0/LICENSE",source:"https://github.com/zloirock/core-js"})},1140:(e,t,r)=>{var n=r(8697),i=r(4229),s=r(8967),o=r(6411),a=n("".charAt),l=n("".charCodeAt),c=n("".slice),u=function(e){return function(t,r){var n,u,h=s(o(t)),d=i(r),p=h.length;return d<0||d>=p?e?"":void 0:(n=l(h,d))<55296||n>56319||d+1===p||(u=l(h,d+1))<56320||u>57343?e?a(h,d):n:e?c(h,d,d+2):u-56320+(n-55296<<10)+65536}};e.exports={codeAt:u(!1),charAt:u(!0)}},6031:(e,t,r)=>{"use strict";var n=r(4229),i=r(8967),s=r(6411),o=RangeError;e.exports=function(e){var t=i(s(this)),r="",a=n(e);if(a<0||a==1/0)throw o("Wrong number of repetitions");for(;a>0;(a>>>=1)&&(t+=t))1&a&&(r+=t);return r}},287:(e,t,r)=>{var n=r(8697),i=r(6411),s=r(8967),o=r(2569),a=n("".replace),l=RegExp("^["+o+"]+"),c=RegExp("(^|[^"+o+"])["+o+"]+$"),u=function(e){return function(t){var r=s(i(t));return 1&e&&(r=a(r,l,"")),2&e&&(r=a(r,c,"$1")),r}};e.exports={start:u(1),end:u(2),trim:u(3)}},746:(e,t,r)=>{var n=r(1197),i=r(9044);e.exports=!!Object.getOwnPropertySymbols&&!i((function(){var e=Symbol();return!String(e)||!(Object(e)instanceof Symbol)||!Symbol.sham&&n&&n<41}))},455:(e,t,r)=>{var n=r(9611),i=r(2773),s=r(2280),o=r(403);e.exports=function(){var e=i("Symbol"),t=e&&e.prototype,r=t&&t.valueOf,a=s("toPrimitive");t&&!t[a]&&o(t,a,(function(e){return n(r,this)}),{arity:1})}},3429:(e,t,r)=>{var n=r(746);e.exports=n&&!!Symbol.for&&!!Symbol.keyFor},1655:(e,t,r)=>{var n=r(8697);e.exports=n(1..valueOf)},2565:(e,t,r)=>{var n=r(4229),i=Math.max,s=Math.min;e.exports=function(e,t){var r=n(e);return r<0?i(r+t,0):s(r,t)}},9580:(e,t,r)=>{var n=r(8609),i=r(6411);e.exports=function(e){return n(i(e))}},4229:(e,t,r)=>{var n=r(8300);e.exports=function(e){var t=+e;return t!=t||0===t?0:n(t)}},5108:(e,t,r)=>{var n=r(4229),i=Math.min;e.exports=function(e){return e>0?i(n(e),9007199254740991):0}},744:(e,t,r)=>{var n=r(6411),i=Object;e.exports=function(e){return i(n(e))}},1893:(e,t,r)=>{var n=r(9611),i=r(2786),s=r(6681),o=r(7219),a=r(7141),l=r(2280),c=TypeError,u=l("toPrimitive");e.exports=function(e,t){if(!i(e)||s(e))return e;var r,l=o(e,u);if(l){if(void 0===t&&(t="default"),r=n(l,e,t),!i(r)||s(r))return r;throw c("Can't convert object to primitive value")}return void 0===t&&(t="number"),a(e,t)}},383:(e,t,r)=>{var n=r(1893),i=r(6681);e.exports=function(e){var t=n(e,"string");return i(t)?t:t+""}},7301:(e,t,r)=>{var n={};n[r(2280)("toStringTag")]="z",e.exports="[object z]"===String(n)},8967:(e,t,r)=>{var n=r(6994),i=String;e.exports=function(e){if("Symbol"===n(e))throw TypeError("Cannot convert a Symbol value to a string");return i(e)}},8768:e=>{var t=String;e.exports=function(e){try{return t(e)}catch(e){return"Object"}}},4524:(e,t,r)=>{var n=r(8697),i=0,s=Math.random(),o=n(1..toString);e.exports=function(e){return"Symbol("+(void 0===e?"":e)+")_"+o(++i+s,36)}},189:(e,t,r)=>{var n=r(746);e.exports=n&&!Symbol.sham&&"symbol"==typeof Symbol.iterator},1010:(e,t,r)=>{var n=r(7493),i=r(9044);e.exports=n&&i((function(){return 42!=Object.defineProperty((function(){}),"prototype",{value:42,writable:!1}).prototype}))},2512:(e,t,r)=>{var n=r(8363),i=r(5277),s=n.WeakMap;e.exports=i(s)&&/native code/.test(String(s))},5443:(e,t,r)=>{var n=r(7290),i=r(4792),s=r(127),o=r(6385).f;e.exports=function(e){var t=n.Symbol||(n.Symbol={});i(t,e)||o(t,e,{value:s.f(e)})}},127:(e,t,r)=>{var n=r(2280);t.f=n},2280:(e,t,r)=>{var n=r(8363),i=r(3580),s=r(4792),o=r(4524),a=r(746),l=r(189),c=n.Symbol,u=i("wks"),h=l?c.for||c:c&&c.withoutSetter||o;e.exports=function(e){return s(u,e)||(u[e]=a&&s(c,e)?c[e]:h("Symbol."+e)),u[e]}},2569:e=>{e.exports="\t\n\v\f\r                　\u2028\u2029\ufeff"},5862:(e,t,r)=>{"use strict";var n=r(9882),i=r(9044),s=r(1982),o=r(2786),a=r(744),l=r(7046),c=r(4758),u=r(5039),h=r(150),d=r(2091),p=r(2280),f=r(1197),m=p("isConcatSpreadable"),g=f>=51||!i((function(){var e=[];return e[m]=!1,e.concat()[0]!==e})),y=function(e){if(!o(e))return!1;var t=e[m];return void 0!==t?!!t:s(e)};n({target:"Array",proto:!0,arity:1,forced:!g||!d("concat")},{concat:function(e){var t,r,n,i,s,o=a(this),d=h(o,0),p=0;for(t=-1,n=arguments.length;t<n;t++)if(y(s=-1===t?o:arguments[t]))for(i=l(s),c(p+i),r=0;r<i;r++,p++)r in s&&u(d,p,s[r]);else c(p+1),u(d,p++,s);return d.length=p,d}})},9701:(e,t,r)=>{"use strict";var n=r(9882),i=r(8671).filter;n({target:"Array",proto:!0,forced:!r(2091)("filter")},{filter:function(e){return i(this,e,arguments.length>1?arguments[1]:void 0)}})},2900:(e,t,r)=>{"use strict";var n=r(9882),i=r(8671).find,s=r(6677),o="find",a=!0;o in[]&&Array(1)[o]((function(){a=!1})),n({target:"Array",proto:!0,forced:a},{find:function(e){return i(this,e,arguments.length>1?arguments[1]:void 0)}}),s(o)},4845:(e,t,r)=>{var n=r(9882),i=r(4899);n({target:"Array",stat:!0,forced:!r(8662)((function(e){Array.from(e)}))},{from:i})},4883:(e,t,r)=>{"use strict";var n=r(9580),i=r(6677),s=r(4818),o=r(821),a=r(6385).f,l=r(8150),c=r(6145),u=r(1178),h=r(7493),d="Array Iterator",p=o.set,f=o.getterFor(d);e.exports=l(Array,"Array",(function(e,t){p(this,{type:d,target:n(e),index:0,kind:t})}),(function(){var e=f(this),t=e.target,r=e.kind,n=e.index++;return!t||n>=t.length?(e.target=void 0,c(void 0,!0)):c("keys"==r?n:"values"==r?t[n]:[n,t[n]],!1)}),"values");var m=s.Arguments=s.Array;if(i("keys"),i("values"),i("entries"),!u&&h&&"values"!==m.name)try{a(m,"name",{value:"values"})}catch(e){}},3214:(e,t,r)=>{"use strict";var n=r(9882),i=r(8671).map;n({target:"Array",proto:!0,forced:!r(2091)("map")},{map:function(e){return i(this,e,arguments.length>1?arguments[1]:void 0)}})},8821:(e,t,r)=>{"use strict";var n=r(9882),i=r(1982),s=r(1536),o=r(2786),a=r(2565),l=r(7046),c=r(9580),u=r(5039),h=r(2280),d=r(2091),p=r(5629),f=d("slice"),m=h("species"),g=Array,y=Math.max;n({target:"Array",proto:!0,forced:!f},{slice:function(e,t){var r,n,h,d=c(this),f=l(d),v=a(e,f),_=a(void 0===t?f:t,f);if(i(d)&&(r=d.constructor,(s(r)&&(r===g||i(r.prototype))||o(r)&&null===(r=r[m]))&&(r=void 0),r===g||void 0===r))return p(d,v,_);for(n=new(void 0===r?g:r)(y(_-v,0)),h=0;v<_;v++,h++)v in d&&u(n,h,d[v]);return n.length=h,n}})},5281:(e,t,r)=>{"use strict";var n=r(9882),i=r(8697),s=r(7676),o=r(744),a=r(7046),l=r(3731),c=r(8967),u=r(9044),h=r(2013),d=r(4324),p=r(4631),f=r(442),m=r(1197),g=r(6929),y=[],v=i(y.sort),_=i(y.push),x=u((function(){y.sort(void 0)})),b=u((function(){y.sort(null)})),w=d("sort"),S=!u((function(){if(m)return m<70;if(!(p&&p>3)){if(f)return!0;if(g)return g<603;var e,t,r,n,i="";for(e=65;e<76;e++){switch(t=String.fromCharCode(e),e){case 66:case 69:case 70:case 72:r=3;break;case 68:case 71:r=4;break;default:r=2}for(n=0;n<47;n++)y.push({k:t+n,v:r})}for(y.sort((function(e,t){return t.v-e.v})),n=0;n<y.length;n++)t=y[n].k.charAt(0),i.charAt(i.length-1)!==t&&(i+=t);return"DGBEFHACIJK"!==i}}));n({target:"Array",proto:!0,forced:x||!b||!w||!S},{sort:function(e){void 0!==e&&s(e);var t=o(this);if(S)return void 0===e?v(t):v(t,e);var r,n,i=[],u=a(t);for(n=0;n<u;n++)n in t&&_(i,t[n]);for(h(i,function(e){return function(t,r){return void 0===r?-1:void 0===t?1:void 0!==e?+e(t,r)||0:c(t)>c(r)?1:-1}}(e)),r=a(i),n=0;n<r;)t[n]=i[n++];for(;n<u;)l(t,n++);return t}})},5550:(e,t,r)=>{"use strict";var n=r(9882),i=r(744),s=r(2565),o=r(4229),a=r(7046),l=r(1478),c=r(4758),u=r(150),h=r(5039),d=r(3731),p=r(2091)("splice"),f=Math.max,m=Math.min;n({target:"Array",proto:!0,forced:!p},{splice:function(e,t){var r,n,p,g,y,v,_=i(this),x=a(_),b=s(e,x),w=arguments.length;for(0===w?r=n=0:1===w?(r=0,n=x-b):(r=w-2,n=m(f(o(t),0),x-b)),c(x+r-n),p=u(_,n),g=0;g<n;g++)(y=b+g)in _&&h(p,g,_[y]);if(p.length=n,r<n){for(g=b;g<x-n;g++)v=g+r,(y=g+n)in _?_[v]=_[y]:d(_,v);for(g=x;g>x-n+r;g--)d(_,g-1)}else if(r>n)for(g=x-n;g>b;g--)v=g+r-1,(y=g+n-1)in _?_[v]=_[y]:d(_,v);for(g=0;g<r;g++)_[g+b]=arguments[g+2];return l(_,x-n+r),p}})},3142:(e,t,r)=>{var n=r(4792),i=r(403),s=r(7707),o=r(2280)("toPrimitive"),a=Date.prototype;n(a,o)||i(a,o,s)},4994:(e,t,r)=>{var n=r(7493),i=r(5316).EXISTS,s=r(8697),o=r(3600),a=Function.prototype,l=s(a.toString),c=/function\b(?:\s|\/\*[\S\s]*?\*\/|\/\/[^\n\r]*[\n\r]+)*([^\s(/]*)/,u=s(c.exec);n&&!i&&o(a,"name",{configurable:!0,get:function(){try{return u(c,l(this))[1]}catch(e){return""}}})},3749:(e,t,r)=>{var n=r(9882),i=r(2773),s=r(3530),o=r(9611),a=r(8697),l=r(9044),c=r(5277),u=r(6681),h=r(5629),d=r(6590),p=r(746),f=String,m=i("JSON","stringify"),g=a(/./.exec),y=a("".charAt),v=a("".charCodeAt),_=a("".replace),x=a(1..toString),b=/[\uD800-\uDFFF]/g,w=/^[\uD800-\uDBFF]$/,S=/^[\uDC00-\uDFFF]$/,M=!p||l((function(){var e=i("Symbol")();return"[null]"!=m([e])||"{}"!=m({a:e})||"{}"!=m(Object(e))})),T=l((function(){return'"\\udf06\\ud834"'!==m("\udf06\ud834")||'"\\udead"'!==m("\udead")})),E=function(e,t){var r=h(arguments),n=d(t);if(c(n)||void 0!==e&&!u(e))return r[1]=function(e,t){if(c(n)&&(t=o(n,this,f(e),t)),!u(t))return t},s(m,null,r)},A=function(e,t,r){var n=y(r,t-1),i=y(r,t+1);return g(w,e)&&!g(S,i)||g(S,e)&&!g(w,n)?"\\u"+x(v(e,0),16):e};m&&n({target:"JSON",stat:!0,arity:3,forced:M||T},{stringify:function(e,t,r){var n=h(arguments),i=s(M?E:m,null,n);return T&&"string"==typeof i?_(i,b,A):i}})},174:(e,t,r)=>{"use strict";var n=r(9882),i=r(1178),s=r(7493),o=r(8363),a=r(7290),l=r(8697),c=r(6291),u=r(4792),h=r(9250),d=r(2010),p=r(6681),f=r(1893),m=r(9044),g=r(7994).f,y=r(6012).f,v=r(6385).f,_=r(1655),x=r(287).trim,b="Number",w=o[b],S=a[b],M=w.prototype,T=o.TypeError,E=l("".slice),A=l("".charCodeAt),C=function(e){var t=f(e,"number");return"bigint"==typeof t?t:L(t)},L=function(e){var t,r,n,i,s,o,a,l,c=f(e,"number");if(p(c))throw T("Cannot convert a Symbol value to a number");if("string"==typeof c&&c.length>2)if(c=x(c),43===(t=A(c,0))||45===t){if(88===(r=A(c,2))||120===r)return NaN}else if(48===t){switch(A(c,1)){case 66:case 98:n=2,i=49;break;case 79:case 111:n=8,i=55;break;default:return+c}for(o=(s=E(c,2)).length,a=0;a<o;a++)if((l=A(s,a))<48||l>i)return NaN;return parseInt(s,n)}return+c},R=c(b,!w(" 0o1")||!w("0b1")||w("+0x1")),P=function(e){return d(M,e)&&m((function(){_(e)}))},j=function(e){var t=arguments.length<1?0:w(C(e));return P(this)?h(Object(t),this,j):t};j.prototype=M,R&&!i&&(M.constructor=j),n({global:!0,constructor:!0,wrap:!0,forced:R},{Number:j});var I=function(e,t){for(var r,n=s?g(t):"MAX_VALUE,MIN_VALUE,NaN,NEGATIVE_INFINITY,POSITIVE_INFINITY,EPSILON,MAX_SAFE_INTEGER,MIN_SAFE_INTEGER,isFinite,isInteger,isNaN,isSafeInteger,parseFloat,parseInt,fromString,range".split(","),i=0;n.length>i;i++)u(t,r=n[i])&&!u(e,r)&&v(e,r,y(t,r))};i&&S&&I(a[b],S),(R||i)&&I(a[b],w)},238:(e,t,r)=>{var n=r(9882),i=r(9044),s=r(9580),o=r(6012).f,a=r(7493);n({target:"Object",stat:!0,forced:!a||i((function(){o(1)})),sham:!a},{getOwnPropertyDescriptor:function(e,t){return o(s(e),t)}})},2938:(e,t,r)=>{var n=r(9882),i=r(7493),s=r(1561),o=r(9580),a=r(6012),l=r(5039);n({target:"Object",stat:!0,sham:!i},{getOwnPropertyDescriptors:function(e){for(var t,r,n=o(e),i=a.f,c=s(n),u={},h=0;c.length>h;)void 0!==(r=i(n,t=c[h++]))&&l(u,t,r);return u}})},5090:(e,t,r)=>{var n=r(9882),i=r(746),s=r(9044),o=r(9612),a=r(744);n({target:"Object",stat:!0,forced:!i||s((function(){o.f(1)}))},{getOwnPropertySymbols:function(e){var t=o.f;return t?t(a(e)):[]}})},44:(e,t,r)=>{var n=r(9882),i=r(744),s=r(667);n({target:"Object",stat:!0,forced:r(9044)((function(){s(1)}))},{keys:function(e){return s(i(e))}})},853:(e,t,r)=>{var n=r(7301),i=r(403),s=r(6699);n||i(Object.prototype,"toString",s,{unsafe:!0})},9275:(e,t,r)=>{"use strict";var n=r(9882),i=r(9749);n({target:"RegExp",proto:!0,forced:/./.exec!==i},{exec:i})},5007:(e,t,r)=>{"use strict";var n=r(1140).charAt,i=r(8967),s=r(821),o=r(8150),a=r(6145),l="String Iterator",c=s.set,u=s.getterFor(l);o(String,"String",(function(e){c(this,{type:l,string:i(e),index:0})}),(function(){var e,t=u(this),r=t.string,i=t.index;return i>=r.length?a(void 0,!0):(e=n(r,i),t.index+=e.length,a(e,!1))}))},4750:(e,t,r)=>{r(9882)({target:"String",proto:!0},{repeat:r(6031)})},2321:(e,t,r)=>{"use strict";var n=r(3530),i=r(9611),s=r(8697),o=r(1492),a=r(9044),l=r(3875),c=r(5277),u=r(9903),h=r(4229),d=r(5108),p=r(8967),f=r(6411),m=r(3350),g=r(7219),y=r(1373),v=r(4088),_=r(2280)("replace"),x=Math.max,b=Math.min,w=s([].concat),S=s([].push),M=s("".indexOf),T=s("".slice),E="$0"==="a".replace(/./,"$0"),A=!!/./[_]&&""===/./[_]("a","$0");o("replace",(function(e,t,r){var s=A?"$":"$0";return[function(e,r){var n=f(this),s=u(e)?void 0:g(e,_);return s?i(s,e,n,r):i(t,p(n),e,r)},function(e,i){var o=l(this),a=p(e);if("string"==typeof i&&-1===M(i,s)&&-1===M(i,"$<")){var u=r(t,o,a,i);if(u.done)return u.value}var f=c(i);f||(i=p(i));var g=o.global;if(g){var _=o.unicode;o.lastIndex=0}for(var E=[];;){var A=v(o,a);if(null===A)break;if(S(E,A),!g)break;""===p(A[0])&&(o.lastIndex=m(a,d(o.lastIndex),_))}for(var C,L="",R=0,P=0;P<E.length;P++){for(var j=p((A=E[P])[0]),I=x(b(h(A.index),a.length),0),D=[],O=1;O<A.length;O++)S(D,void 0===(C=A[O])?C:String(C));var N=A.groups;if(f){var U=w([j],D,I,a);void 0!==N&&S(U,N);var k=p(n(i,void 0,U))}else k=y(j,a,I,D,N,i);I>=R&&(L+=T(a,R,I)+k,R=I+j.length)}return L+T(a,R)}]}),!!a((function(){var e=/./;return e.exec=function(){var e=[];return e.groups={a:"7"},e},"7"!=="".replace(e,"$<a>")}))||!E||A)},7070:(e,t,r)=>{"use strict";var n=r(9882),i=r(8363),s=r(9611),o=r(8697),a=r(1178),l=r(7493),c=r(746),u=r(9044),h=r(4792),d=r(2010),p=r(3875),f=r(9580),m=r(383),g=r(8967),y=r(9199),v=r(1569),_=r(667),x=r(7994),b=r(4938),w=r(9612),S=r(6012),M=r(6385),T=r(7840),E=r(1513),A=r(403),C=r(3600),L=r(3580),R=r(466),P=r(7505),j=r(4524),I=r(2280),D=r(127),O=r(5443),N=r(455),U=r(878),k=r(821),F=r(8671).forEach,B=R("hidden"),z="Symbol",G="prototype",V=k.set,H=k.getterFor(z),W=Object[G],X=i.Symbol,q=X&&X[G],Y=i.TypeError,Z=i.QObject,J=S.f,K=M.f,Q=b.f,$=E.f,ee=o([].push),te=L("symbols"),re=L("op-symbols"),ne=L("wks"),ie=!Z||!Z[G]||!Z[G].findChild,se=l&&u((function(){return 7!=v(K({},"a",{get:function(){return K(this,"a",{value:7}).a}})).a}))?function(e,t,r){var n=J(W,t);n&&delete W[t],K(e,t,r),n&&e!==W&&K(W,t,n)}:K,oe=function(e,t){var r=te[e]=v(q);return V(r,{type:z,tag:e,description:t}),l||(r.description=t),r},ae=function(e,t,r){e===W&&ae(re,t,r),p(e);var n=m(t);return p(r),h(te,n)?(r.enumerable?(h(e,B)&&e[B][n]&&(e[B][n]=!1),r=v(r,{enumerable:y(0,!1)})):(h(e,B)||K(e,B,y(1,{})),e[B][n]=!0),se(e,n,r)):K(e,n,r)},le=function(e,t){p(e);var r=f(t),n=_(r).concat(de(r));return F(n,(function(t){l&&!s(ce,r,t)||ae(e,t,r[t])})),e},ce=function(e){var t=m(e),r=s($,this,t);return!(this===W&&h(te,t)&&!h(re,t))&&(!(r||!h(this,t)||!h(te,t)||h(this,B)&&this[B][t])||r)},ue=function(e,t){var r=f(e),n=m(t);if(r!==W||!h(te,n)||h(re,n)){var i=J(r,n);return!i||!h(te,n)||h(r,B)&&r[B][n]||(i.enumerable=!0),i}},he=function(e){var t=Q(f(e)),r=[];return F(t,(function(e){h(te,e)||h(P,e)||ee(r,e)})),r},de=function(e){var t=e===W,r=Q(t?re:f(e)),n=[];return F(r,(function(e){!h(te,e)||t&&!h(W,e)||ee(n,te[e])})),n};c||(A(q=(X=function(){if(d(q,this))throw Y("Symbol is not a constructor");var e=arguments.length&&void 0!==arguments[0]?g(arguments[0]):void 0,t=j(e),r=function(e){this===W&&s(r,re,e),h(this,B)&&h(this[B],t)&&(this[B][t]=!1),se(this,t,y(1,e))};return l&&ie&&se(W,t,{configurable:!0,set:r}),oe(t,e)})[G],"toString",(function(){return H(this).tag})),A(X,"withoutSetter",(function(e){return oe(j(e),e)})),E.f=ce,M.f=ae,T.f=le,S.f=ue,x.f=b.f=he,w.f=de,D.f=function(e){return oe(I(e),e)},l&&(C(q,"description",{configurable:!0,get:function(){return H(this).description}}),a||A(W,"propertyIsEnumerable",ce,{unsafe:!0}))),n({global:!0,constructor:!0,wrap:!0,forced:!c,sham:!c},{Symbol:X}),F(_(ne),(function(e){O(e)})),n({target:z,stat:!0,forced:!c},{useSetter:function(){ie=!0},useSimple:function(){ie=!1}}),n({target:"Object",stat:!0,forced:!c,sham:!l},{create:function(e,t){return void 0===t?v(e):le(v(e),t)},defineProperty:ae,defineProperties:le,getOwnPropertyDescriptor:ue}),n({target:"Object",stat:!0,forced:!c},{getOwnPropertyNames:he}),N(),U(X,z),P[B]=!0},6632:(e,t,r)=>{"use strict";var n=r(9882),i=r(7493),s=r(8363),o=r(8697),a=r(4792),l=r(5277),c=r(2010),u=r(8967),h=r(3600),d=r(3870),p=s.Symbol,f=p&&p.prototype;if(i&&l(p)&&(!("description"in f)||void 0!==p().description)){var m={},g=function(){var e=arguments.length<1||void 0===arguments[0]?void 0:u(arguments[0]),t=c(f,this)?new p(e):void 0===e?p():p(e);return""===e&&(m[t]=!0),t};d(g,p),g.prototype=f,f.constructor=g;var y="Symbol(test)"==String(p("test")),v=o(f.valueOf),_=o(f.toString),x=/^Symbol\((.*)\)[^)]+$/,b=o("".replace),w=o("".slice);h(f,"description",{configurable:!0,get:function(){var e=v(this);if(a(m,e))return"";var t=_(e),r=y?w(t,7,-1):b(t,x,"$1");return""===r?void 0:r}}),n({global:!0,constructor:!0,forced:!0},{Symbol:g})}},3086:(e,t,r)=>{var n=r(9882),i=r(2773),s=r(4792),o=r(8967),a=r(3580),l=r(3429),c=a("string-to-symbol-registry"),u=a("symbol-to-string-registry");n({target:"Symbol",stat:!0,forced:!l},{for:function(e){var t=o(e);if(s(c,t))return c[t];var r=i("Symbol")(t);return c[t]=r,u[r]=t,r}})},1928:(e,t,r)=>{r(5443)("iterator")},6364:(e,t,r)=>{r(7070),r(3086),r(7484),r(3749),r(5090)},7484:(e,t,r)=>{var n=r(9882),i=r(4792),s=r(6681),o=r(8768),a=r(3580),l=r(3429),c=a("symbol-to-string-registry");n({target:"Symbol",stat:!0,forced:!l},{keyFor:function(e){if(!s(e))throw TypeError(o(e)+" is not a symbol");if(i(c,e))return c[e]}})},6543:(e,t,r)=>{var n=r(5443),i=r(455);n("toPrimitive"),i()},6208:(e,t,r)=>{var n=r(8363),i=r(2848),s=r(9189),o=r(379),a=r(5899),l=function(e){if(e&&e.forEach!==o)try{a(e,"forEach",o)}catch(t){e.forEach=o}};for(var c in i)i[c]&&l(n[c]&&n[c].prototype);l(s)},8995:(e,t,r)=>{var n=r(8363),i=r(2848),s=r(9189),o=r(4883),a=r(5899),l=r(2280),c=l("iterator"),u=l("toStringTag"),h=o.values,d=function(e,t){if(e){if(e[c]!==h)try{a(e,c,h)}catch(t){e[c]=h}if(e[u]||a(e,u,t),i[t])for(var r in o)if(e[r]!==o[r])try{a(e,r,o[r])}catch(t){e[r]=o[r]}}};for(var p in i)d(n[p]&&n[p].prototype,p);d(s,"DOMTokenList")},5435:(e,t,r)=>{"use strict";function n(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function i(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,e.__proto__=t}r.d(t,{ZP:()=>qn});var s,o,a,l,c,u,h,d,p,f,m,g,y,v,_,x={autoSleep:120,force3D:"auto",nullTargetWarn:1,units:{lineHeight:""}},b={duration:.5,overwrite:!1,delay:0},w=1e8,S=1/w,M=2*Math.PI,T=M/4,E=0,A=Math.sqrt,C=Math.cos,L=Math.sin,R=function(e){return"string"==typeof e},P=function(e){return"function"==typeof e},j=function(e){return"number"==typeof e},I=function(e){return void 0===e},D=function(e){return"object"==typeof e},O=function(e){return!1!==e},N=function(){return"undefined"!=typeof window},U=function(e){return P(e)||R(e)},k="function"==typeof ArrayBuffer&&ArrayBuffer.isView||function(){},F=Array.isArray,B=/(?:-?\.?\d|\.)+/gi,z=/[-+=.]*\d+[.e\-+]*\d*[e\-+]*\d*/g,G=/[-+=.]*\d+[.e-]*\d*[a-z%]*/g,V=/[-+=.]*\d+\.?\d*(?:e-|e\+)?\d*/gi,H=/[+-]=-?[.\d]+/,W=/[^,'"\[\]\s]+/gi,X=/^[+\-=e\s\d]*\d+[.\d]*([a-z]*|%)\s*$/i,q={},Y={},Z=function(e){return(Y=Se(e,q))&&Mr},J=function(e,t){return!t&&void 0},K=function(e,t){return e&&(q[e]=t)&&Y&&(Y[e]=t)||q},Q=function(){return 0},$={suppressEvents:!0,isStart:!0,kill:!1},ee={suppressEvents:!0,kill:!1},te={suppressEvents:!0},re={},ne=[],ie={},se={},oe={},ae=30,le=[],ce="",ue=function(e){var t,r,n=e[0];if(D(n)||P(n)||(e=[e]),!(t=(n._gsap||{}).harness)){for(r=le.length;r--&&!le[r].targetTest(n););t=le[r]}for(r=e.length;r--;)e[r]&&(e[r]._gsap||(e[r]._gsap=new Ft(e[r],t)))||e.splice(r,1);return e},he=function(e){return e._gsap||ue(rt(e))[0]._gsap},de=function(e,t,r){return(r=e[t])&&P(r)?e[t]():I(r)&&e.getAttribute&&e.getAttribute(t)||r},pe=function(e,t){return(e=e.split(",")).forEach(t)||e},fe=function(e){return Math.round(1e5*e)/1e5||0},me=function(e){return Math.round(1e7*e)/1e7||0},ge=function(e,t){var r=t.charAt(0),n=parseFloat(t.substr(2));return e=parseFloat(e),"+"===r?e+n:"-"===r?e-n:"*"===r?e*n:e/n},ye=function(e,t){for(var r=t.length,n=0;e.indexOf(t[n])<0&&++n<r;);return n<r},ve=function(){var e,t,r=ne.length,n=ne.slice(0);for(ie={},ne.length=0,e=0;e<r;e++)(t=n[e])&&t._lazy&&(t.render(t._lazy[0],t._lazy[1],!0)._lazy=0)},_e=function(e,t,r,n){ne.length&&!o&&ve(),e.render(t,r,n||o&&t<0&&(e._initted||e._startAt)),ne.length&&!o&&ve()},xe=function(e){var t=parseFloat(e);return(t||0===t)&&(e+"").match(W).length<2?t:R(e)?e.trim():e},be=function(e){return e},we=function(e,t){for(var r in t)r in e||(e[r]=t[r]);return e},Se=function(e,t){for(var r in t)e[r]=t[r];return e},Me=function e(t,r){for(var n in r)"__proto__"!==n&&"constructor"!==n&&"prototype"!==n&&(t[n]=D(r[n])?e(t[n]||(t[n]={}),r[n]):r[n]);return t},Te=function(e,t){var r,n={};for(r in e)r in t||(n[r]=e[r]);return n},Ee=function(e){var t,r=e.parent||l,n=e.keyframes?(t=F(e.keyframes),function(e,r){for(var n in r)n in e||"duration"===n&&t||"ease"===n||(e[n]=r[n])}):we;if(O(e.inherit))for(;r;)n(e,r.vars.defaults),r=r.parent||r._dp;return e},Ae=function(e,t,r,n,i){void 0===r&&(r="_first"),void 0===n&&(n="_last");var s,o=e[n];if(i)for(s=t[i];o&&o[i]>s;)o=o._prev;return o?(t._next=o._next,o._next=t):(t._next=e[r],e[r]=t),t._next?t._next._prev=t:e[n]=t,t._prev=o,t.parent=t._dp=e,t},Ce=function(e,t,r,n){void 0===r&&(r="_first"),void 0===n&&(n="_last");var i=t._prev,s=t._next;i?i._next=s:e[r]===t&&(e[r]=s),s?s._prev=i:e[n]===t&&(e[n]=i),t._next=t._prev=t.parent=null},Le=function(e,t){e.parent&&(!t||e.parent.autoRemoveChildren)&&e.parent.remove(e),e._act=0},Re=function(e,t){if(e&&(!t||t._end>e._dur||t._start<0))for(var r=e;r;)r._dirty=1,r=r.parent;return e},Pe=function(e){for(var t=e.parent;t&&t.parent;)t._dirty=1,t.totalDuration(),t=t.parent;return e},je=function(e,t,r,n){return e._startAt&&(o?e._startAt.revert(ee):e.vars.immediateRender&&!e.vars.autoRevert||e._startAt.render(t,!0,n))},Ie=function e(t){return!t||t._ts&&e(t.parent)},De=function(e){return e._repeat?Oe(e._tTime,e=e.duration()+e._rDelay)*e:0},Oe=function(e,t){var r=Math.floor(e/=t);return e&&r===e?r-1:r},Ne=function(e,t){return(e-t._start)*t._ts+(t._ts>=0?0:t._dirty?t.totalDuration():t._tDur)},Ue=function(e){return e._end=me(e._start+(e._tDur/Math.abs(e._ts||e._rts||S)||0))},ke=function(e,t){var r=e._dp;return r&&r.smoothChildTiming&&e._ts&&(e._start=me(r._time-(e._ts>0?t/e._ts:((e._dirty?e.totalDuration():e._tDur)-t)/-e._ts)),Ue(e),r._dirty||Re(r,e)),e},Fe=function(e,t){var r;if((t._time||t._initted&&!t._dur)&&(r=Ne(e.rawTime(),t),(!t._dur||Ke(0,t.totalDuration(),r)-t._tTime>S)&&t.render(r,!0)),Re(e,t)._dp&&e._initted&&e._time>=e._dur&&e._ts){if(e._dur<e.duration())for(r=e;r._dp;)r.rawTime()>=0&&r.totalTime(r._tTime),r=r._dp;e._zTime=-S}},Be=function(e,t,r,n){return t.parent&&Le(t),t._start=me((j(r)?r:r||e!==l?Ye(e,r,t):e._time)+t._delay),t._end=me(t._start+(t.totalDuration()/Math.abs(t.timeScale())||0)),Ae(e,t,"_first","_last",e._sort?"_start":0),He(t)||(e._recent=t),n||Fe(e,t),e._ts<0&&ke(e,e._tTime),e},ze=function(e,t){return q.ScrollTrigger?q.ScrollTrigger.create(t,e):void 0},Ge=function(e,t,r,n,i){return qt(e,t,i),e._initted?!r&&e._pt&&!o&&(e._dur&&!1!==e.vars.lazy||!e._dur&&e.vars.lazy)&&p!==Et.frame?(ne.push(e),e._lazy=[i,n],1):void 0:1},Ve=function e(t){var r=t.parent;return r&&r._ts&&r._initted&&!r._lock&&(r.rawTime()<0||e(r))},He=function(e){var t=e.data;return"isFromStart"===t||"isStart"===t},We=function(e,t,r,n){var i=e._repeat,s=me(t)||0,o=e._tTime/e._tDur;return o&&!n&&(e._time*=s/e._dur),e._dur=s,e._tDur=i?i<0?1e10:me(s*(i+1)+e._rDelay*i):s,o>0&&!n&&ke(e,e._tTime=e._tDur*o),e.parent&&Ue(e),r||Re(e.parent,e),e},Xe=function(e){return e instanceof zt?Re(e):We(e,e._dur)},qe={_start:0,endTime:Q,totalDuration:Q},Ye=function e(t,r,n){var i,s,o,a=t.labels,l=t._recent||qe,c=t.duration()>=w?l.endTime(!1):t._dur;return R(r)&&(isNaN(r)||r in a)?(s=r.charAt(0),o="%"===r.substr(-1),i=r.indexOf("="),"<"===s||">"===s?(i>=0&&(r=r.replace(/=/,"")),("<"===s?l._start:l.endTime(l._repeat>=0))+(parseFloat(r.substr(1))||0)*(o?(i<0?l:n).totalDuration()/100:1)):i<0?(r in a||(a[r]=c),a[r]):(s=parseFloat(r.charAt(i-1)+r.substr(i+1)),o&&n&&(s=s/100*(F(n)?n[0]:n).totalDuration()),i>1?e(t,r.substr(0,i-1),n)+s:c+s)):null==r?c:+r},Ze=function(e,t,r){var n,i,s=j(t[1]),o=(s?2:1)+(e<2?0:1),a=t[o];if(s&&(a.duration=t[1]),a.parent=r,e){for(n=a,i=r;i&&!("immediateRender"in n);)n=i.vars.defaults||{},i=O(i.vars.inherit)&&i.parent;a.immediateRender=O(n.immediateRender),e<2?a.runBackwards=1:a.startAt=t[o-1]}return new Qt(t[0],a,t[o+1])},Je=function(e,t){return e||0===e?t(e):t},Ke=function(e,t,r){return r<e?e:r>t?t:r},Qe=function(e,t){return R(e)&&(t=X.exec(e))?t[1]:""},$e=[].slice,et=function(e,t){return e&&D(e)&&"length"in e&&(!t&&!e.length||e.length-1 in e&&D(e[0]))&&!e.nodeType&&e!==c},tt=function(e,t,r){return void 0===r&&(r=[]),e.forEach((function(e){var n;return R(e)&&!t||et(e,1)?(n=r).push.apply(n,rt(e)):r.push(e)}))||r},rt=function(e,t,r){return a&&!t&&a.selector?a.selector(e):!R(e)||r||!u&&At()?F(e)?tt(e,r):et(e)?$e.call(e,0):e?[e]:[]:$e.call((t||h).querySelectorAll(e),0)},nt=function(e){return e=rt(e)[0]||J("Invalid scope")||{},function(t){var r=e.current||e.nativeElement||e;return rt(t,r.querySelectorAll?r:r===e?J("Invalid scope")||h.createElement("div"):e)}},it=function(e){return e.sort((function(){return.5-Math.random()}))},st=function(e){if(P(e))return e;var t=D(e)?e:{each:e},r=Dt(t.ease),n=t.from||0,i=parseFloat(t.base)||0,s={},o=n>0&&n<1,a=isNaN(n)||o,l=t.axis,c=n,u=n;return R(n)?c=u={center:.5,edges:.5,end:1}[n]||0:!o&&a&&(c=n[0],u=n[1]),function(e,o,h){var d,p,f,m,g,y,v,_,x,b=(h||t).length,S=s[b];if(!S){if(!(x="auto"===t.grid?0:(t.grid||[1,w])[1])){for(v=-w;v<(v=h[x++].getBoundingClientRect().left)&&x<b;);x--}for(S=s[b]=[],d=a?Math.min(x,b)*c-.5:n%x,p=x===w?0:a?b*u/x-.5:n/x|0,v=0,_=w,y=0;y<b;y++)f=y%x-d,m=p-(y/x|0),S[y]=g=l?Math.abs("y"===l?m:f):A(f*f+m*m),g>v&&(v=g),g<_&&(_=g);"random"===n&&it(S),S.max=v-_,S.min=_,S.v=b=(parseFloat(t.amount)||parseFloat(t.each)*(x>b?b-1:l?"y"===l?b/x:x:Math.max(x,b/x))||0)*("edges"===n?-1:1),S.b=b<0?i-b:i,S.u=Qe(t.amount||t.each)||0,r=r&&b<0?jt(r):r}return b=(S[e]-S.min)/S.max||0,me(S.b+(r?r(b):b)*S.v)+S.u}},ot=function(e){var t=Math.pow(10,((e+"").split(".")[1]||"").length);return function(r){var n=me(Math.round(parseFloat(r)/e)*e*t);return(n-n%1)/t+(j(r)?0:Qe(r))}},at=function(e,t){var r,n,i=F(e);return!i&&D(e)&&(r=i=e.radius||w,e.values?(e=rt(e.values),(n=!j(e[0]))&&(r*=r)):e=ot(e.increment)),Je(t,i?P(e)?function(t){return n=e(t),Math.abs(n-t)<=r?n:t}:function(t){for(var i,s,o=parseFloat(n?t.x:t),a=parseFloat(n?t.y:0),l=w,c=0,u=e.length;u--;)(i=n?(i=e[u].x-o)*i+(s=e[u].y-a)*s:Math.abs(e[u]-o))<l&&(l=i,c=u);return c=!r||l<=r?e[c]:t,n||c===t||j(t)?c:c+Qe(t)}:ot(e))},lt=function(e,t,r,n){return Je(F(e)?!t:!0===r?!!(r=0):!n,(function(){return F(e)?e[~~(Math.random()*e.length)]:(r=r||1e-5)&&(n=r<1?Math.pow(10,(r+"").length-2):1)&&Math.floor(Math.round((e-r/2+Math.random()*(t-e+.99*r))/r)*r*n)/n}))},ct=function(e,t,r){return Je(r,(function(r){return e[~~t(r)]}))},ut=function(e){for(var t,r,n,i,s=0,o="";~(t=e.indexOf("random(",s));)n=e.indexOf(")",t),i="["===e.charAt(t+7),r=e.substr(t+7,n-t-7).match(i?W:B),o+=e.substr(s,t-s)+lt(i?r:+r[0],i?0:+r[1],+r[2]||1e-5),s=n+1;return o+e.substr(s,e.length-s)},ht=function(e,t,r,n,i){var s=t-e,o=n-r;return Je(i,(function(t){return r+((t-e)/s*o||0)}))},dt=function(e,t,r){var n,i,s,o=e.labels,a=w;for(n in o)(i=o[n]-t)<0==!!r&&i&&a>(i=Math.abs(i))&&(s=n,a=i);return s},pt=function(e,t,r){var n,i,s,o=e.vars,l=o[t],c=a,u=e._ctx;if(l)return n=o[t+"Params"],i=o.callbackScope||e,r&&ne.length&&ve(),u&&(a=u),s=n?l.apply(i,n):l.call(i),a=c,s},ft=function(e){return Le(e),e.scrollTrigger&&e.scrollTrigger.kill(!!o),e.progress()<1&&pt(e,"onInterrupt"),e},mt=[],gt=function(e){if(N()){var t=(e=!e.name&&e.default||e).name,r=P(e),n=t&&!r&&e.init?function(){this._props=[]}:e,i={init:Q,render:ar,add:Wt,kill:cr,modifier:lr,rawVars:0},s={targetTest:0,get:0,getSetter:nr,aliases:{},register:0};if(At(),e!==n){if(se[t])return;we(n,we(Te(e,i),s)),Se(n.prototype,Se(i,Te(e,s))),se[n.prop=t]=n,e.targetTest&&(le.push(n),re[t]=1),t=("css"===t?"CSS":t.charAt(0).toUpperCase()+t.substr(1))+"Plugin"}K(t,n),e.register&&e.register(Mr,n,dr)}else mt.push(e)},yt=255,vt={aqua:[0,yt,yt],lime:[0,yt,0],silver:[192,192,192],black:[0,0,0],maroon:[128,0,0],teal:[0,128,128],blue:[0,0,yt],navy:[0,0,128],white:[yt,yt,yt],olive:[128,128,0],yellow:[yt,yt,0],orange:[yt,165,0],gray:[128,128,128],purple:[128,0,128],green:[0,128,0],red:[yt,0,0],pink:[yt,192,203],cyan:[0,yt,yt],transparent:[yt,yt,yt,0]},_t=function(e,t,r){return(6*(e+=e<0?1:e>1?-1:0)<1?t+(r-t)*e*6:e<.5?r:3*e<2?t+(r-t)*(2/3-e)*6:t)*yt+.5|0},xt=function(e,t,r){var n,i,s,o,a,l,c,u,h,d,p=e?j(e)?[e>>16,e>>8&yt,e&yt]:0:vt.black;if(!p){if(","===e.substr(-1)&&(e=e.substr(0,e.length-1)),vt[e])p=vt[e];else if("#"===e.charAt(0)){if(e.length<6&&(n=e.charAt(1),i=e.charAt(2),s=e.charAt(3),e="#"+n+n+i+i+s+s+(5===e.length?e.charAt(4)+e.charAt(4):"")),9===e.length)return[(p=parseInt(e.substr(1,6),16))>>16,p>>8&yt,p&yt,parseInt(e.substr(7),16)/255];p=[(e=parseInt(e.substr(1),16))>>16,e>>8&yt,e&yt]}else if("hsl"===e.substr(0,3))if(p=d=e.match(B),t){if(~e.indexOf("="))return p=e.match(z),r&&p.length<4&&(p[3]=1),p}else o=+p[0]%360/360,a=+p[1]/100,n=2*(l=+p[2]/100)-(i=l<=.5?l*(a+1):l+a-l*a),p.length>3&&(p[3]*=1),p[0]=_t(o+1/3,n,i),p[1]=_t(o,n,i),p[2]=_t(o-1/3,n,i);else p=e.match(B)||vt.transparent;p=p.map(Number)}return t&&!d&&(n=p[0]/yt,i=p[1]/yt,s=p[2]/yt,l=((c=Math.max(n,i,s))+(u=Math.min(n,i,s)))/2,c===u?o=a=0:(h=c-u,a=l>.5?h/(2-c-u):h/(c+u),o=c===n?(i-s)/h+(i<s?6:0):c===i?(s-n)/h+2:(n-i)/h+4,o*=60),p[0]=~~(o+.5),p[1]=~~(100*a+.5),p[2]=~~(100*l+.5)),r&&p.length<4&&(p[3]=1),p},bt=function(e){var t=[],r=[],n=-1;return e.split(St).forEach((function(e){var i=e.match(G)||[];t.push.apply(t,i),r.push(n+=i.length+1)})),t.c=r,t},wt=function(e,t,r){var n,i,s,o,a="",l=(e+a).match(St),c=t?"hsla(":"rgba(",u=0;if(!l)return e;if(l=l.map((function(e){return(e=xt(e,t,1))&&c+(t?e[0]+","+e[1]+"%,"+e[2]+"%,"+e[3]:e.join(","))+")"})),r&&(s=bt(e),(n=r.c).join(a)!==s.c.join(a)))for(o=(i=e.replace(St,"1").split(G)).length-1;u<o;u++)a+=i[u]+(~n.indexOf(u)?l.shift()||c+"0,0,0,0)":(s.length?s:l.length?l:r).shift());if(!i)for(o=(i=e.split(St)).length-1;u<o;u++)a+=i[u]+l[u];return a+i[o]},St=function(){var e,t="(?:\\b(?:(?:rgb|rgba|hsl|hsla)\\(.+?\\))|\\B#(?:[0-9a-f]{3,4}){1,2}\\b";for(e in vt)t+="|"+e+"\\b";return new RegExp(t+")","gi")}(),Mt=/hsl[a]?\(/,Tt=function(e){var t,r=e.join(" ");if(St.lastIndex=0,St.test(r))return t=Mt.test(r),e[1]=wt(e[1],t),e[0]=wt(e[0],t,bt(e[1])),!0},Et=function(){var e,t,r,n,i,s,o=Date.now,a=500,l=33,p=o(),f=p,g=1e3/240,y=g,v=[],_=function r(c){var u,h,d,m,_=o()-f,x=!0===c;if(_>a&&(p+=_-l),((u=(d=(f+=_)-p)-y)>0||x)&&(m=++n.frame,i=d-1e3*n.time,n.time=d/=1e3,y+=u+(u>=g?4:g-u),h=1),x||(e=t(r)),h)for(s=0;s<v.length;s++)v[s](d,i,m,c)};return n={time:0,frame:0,tick:function(){_(!0)},deltaRatio:function(e){return i/(1e3/(e||60))},wake:function(){d&&(!u&&N()&&(c=u=window,h=c.document||{},q.gsap=Mr,(c.gsapVersions||(c.gsapVersions=[])).push(Mr.version),Z(Y||c.GreenSockGlobals||!c.gsap&&c||{}),r=c.requestAnimationFrame,mt.forEach(gt)),e&&n.sleep(),t=r||function(e){return setTimeout(e,y-1e3*n.time+1|0)},m=1,_(2))},sleep:function(){(r?c.cancelAnimationFrame:clearTimeout)(e),m=0,t=Q},lagSmoothing:function(e,t){a=e||1/0,l=Math.min(t||33,a)},fps:function(e){g=1e3/(e||240),y=1e3*n.time+g},add:function(e,t,r){var i=t?function(t,r,s,o){e(t,r,s,o),n.remove(i)}:e;return n.remove(e),v[r?"unshift":"push"](i),At(),i},remove:function(e,t){~(t=v.indexOf(e))&&v.splice(t,1)&&s>=t&&s--},_listeners:v}}(),At=function(){return!m&&Et.wake()},Ct={},Lt=/^[\d.\-M][\d.\-,\s]/,Rt=/["']/g,Pt=function(e){for(var t,r,n,i={},s=e.substr(1,e.length-3).split(":"),o=s[0],a=1,l=s.length;a<l;a++)r=s[a],t=a!==l-1?r.lastIndexOf(","):r.length,n=r.substr(0,t),i[o]=isNaN(n)?n.replace(Rt,"").trim():+n,o=r.substr(t+1).trim();return i},jt=function(e){return function(t){return 1-e(1-t)}},It=function e(t,r){for(var n,i=t._first;i;)i instanceof zt?e(i,r):!i.vars.yoyoEase||i._yoyo&&i._repeat||i._yoyo===r||(i.timeline?e(i.timeline,r):(n=i._ease,i._ease=i._yEase,i._yEase=n,i._yoyo=r)),i=i._next},Dt=function(e,t){return e&&(P(e)?e:Ct[e]||function(e){var t,r,n,i,s=(e+"").split("("),o=Ct[s[0]];return o&&s.length>1&&o.config?o.config.apply(null,~e.indexOf("{")?[Pt(s[1])]:(t=e,r=t.indexOf("(")+1,n=t.indexOf(")"),i=t.indexOf("(",r),t.substring(r,~i&&i<n?t.indexOf(")",n+1):n)).split(",").map(xe)):Ct._CE&&Lt.test(e)?Ct._CE("",e):o}(e))||t},Ot=function(e,t,r,n){void 0===r&&(r=function(e){return 1-t(1-e)}),void 0===n&&(n=function(e){return e<.5?t(2*e)/2:1-t(2*(1-e))/2});var i,s={easeIn:t,easeOut:r,easeInOut:n};return pe(e,(function(e){for(var t in Ct[e]=q[e]=s,Ct[i=e.toLowerCase()]=r,s)Ct[i+("easeIn"===t?".in":"easeOut"===t?".out":".inOut")]=Ct[e+"."+t]=s[t]})),s},Nt=function(e){return function(t){return t<.5?(1-e(1-2*t))/2:.5+e(2*(t-.5))/2}},Ut=function e(t,r,n){var i=r>=1?r:1,s=(n||(t?.3:.45))/(r<1?r:1),o=s/M*(Math.asin(1/i)||0),a=function(e){return 1===e?1:i*Math.pow(2,-10*e)*L((e-o)*s)+1},l="out"===t?a:"in"===t?function(e){return 1-a(1-e)}:Nt(a);return s=M/s,l.config=function(r,n){return e(t,r,n)},l},kt=function e(t,r){void 0===r&&(r=1.70158);var n=function(e){return e?--e*e*((r+1)*e+r)+1:0},i="out"===t?n:"in"===t?function(e){return 1-n(1-e)}:Nt(n);return i.config=function(r){return e(t,r)},i};pe("Linear,Quad,Cubic,Quart,Quint,Strong",(function(e,t){var r=t<5?t+1:t;Ot(e+",Power"+(r-1),t?function(e){return Math.pow(e,r)}:function(e){return e},(function(e){return 1-Math.pow(1-e,r)}),(function(e){return e<.5?Math.pow(2*e,r)/2:1-Math.pow(2*(1-e),r)/2}))})),Ct.Linear.easeNone=Ct.none=Ct.Linear.easeIn,Ot("Elastic",Ut("in"),Ut("out"),Ut()),g=7.5625,v=1/(y=2.75),Ot("Bounce",(function(e){return 1-_(1-e)}),_=function(e){return e<v?g*e*e:e<.7272727272727273?g*Math.pow(e-1.5/y,2)+.75:e<.9090909090909092?g*(e-=2.25/y)*e+.9375:g*Math.pow(e-2.625/y,2)+.984375}),Ot("Expo",(function(e){return e?Math.pow(2,10*(e-1)):0})),Ot("Circ",(function(e){return-(A(1-e*e)-1)})),Ot("Sine",(function(e){return 1===e?1:1-C(e*T)})),Ot("Back",kt("in"),kt("out"),kt()),Ct.SteppedEase=Ct.steps=q.SteppedEase={config:function(e,t){void 0===e&&(e=1);var r=1/e,n=e+(t?0:1),i=t?1:0,s=1-S;return function(e){return((n*Ke(0,s,e)|0)+i)*r}}},b.ease=Ct["quad.out"],pe("onComplete,onUpdate,onStart,onRepeat,onReverseComplete,onInterrupt",(function(e){return ce+=e+","+e+"Params,"}));var Ft=function(e,t){this.id=E++,e._gsap=this,this.target=e,this.harness=t,this.get=t?t.get:de,this.set=t?t.getSetter:nr},Bt=function(){function e(e){this.vars=e,this._delay=+e.delay||0,(this._repeat=e.repeat===1/0?-2:e.repeat||0)&&(this._rDelay=e.repeatDelay||0,this._yoyo=!!e.yoyo||!!e.yoyoEase),this._ts=1,We(this,+e.duration,1,1),this.data=e.data,a&&(this._ctx=a,a.data.push(this)),m||Et.wake()}var t=e.prototype;return t.delay=function(e){return e||0===e?(this.parent&&this.parent.smoothChildTiming&&this.startTime(this._start+e-this._delay),this._delay=e,this):this._delay},t.duration=function(e){return arguments.length?this.totalDuration(this._repeat>0?e+(e+this._rDelay)*this._repeat:e):this.totalDuration()&&this._dur},t.totalDuration=function(e){return arguments.length?(this._dirty=0,We(this,this._repeat<0?e:(e-this._repeat*this._rDelay)/(this._repeat+1))):this._tDur},t.totalTime=function(e,t){if(At(),!arguments.length)return this._tTime;var r=this._dp;if(r&&r.smoothChildTiming&&this._ts){for(ke(this,e),!r._dp||r.parent||Fe(r,this);r&&r.parent;)r.parent._time!==r._start+(r._ts>=0?r._tTime/r._ts:(r.totalDuration()-r._tTime)/-r._ts)&&r.totalTime(r._tTime,!0),r=r.parent;!this.parent&&this._dp.autoRemoveChildren&&(this._ts>0&&e<this._tDur||this._ts<0&&e>0||!this._tDur&&!e)&&Be(this._dp,this,this._start-this._delay)}return(this._tTime!==e||!this._dur&&!t||this._initted&&Math.abs(this._zTime)===S||!e&&!this._initted&&(this.add||this._ptLookup))&&(this._ts||(this._pTime=e),_e(this,e,t)),this},t.time=function(e,t){return arguments.length?this.totalTime(Math.min(this.totalDuration(),e+De(this))%(this._dur+this._rDelay)||(e?this._dur:0),t):this._time},t.totalProgress=function(e,t){return arguments.length?this.totalTime(this.totalDuration()*e,t):this.totalDuration()?Math.min(1,this._tTime/this._tDur):this.ratio},t.progress=function(e,t){return arguments.length?this.totalTime(this.duration()*(!this._yoyo||1&this.iteration()?e:1-e)+De(this),t):this.duration()?Math.min(1,this._time/this._dur):this.ratio},t.iteration=function(e,t){var r=this.duration()+this._rDelay;return arguments.length?this.totalTime(this._time+(e-1)*r,t):this._repeat?Oe(this._tTime,r)+1:1},t.timeScale=function(e){if(!arguments.length)return this._rts===-S?0:this._rts;if(this._rts===e)return this;var t=this.parent&&this._ts?Ne(this.parent._time,this):this._tTime;return this._rts=+e||0,this._ts=this._ps||e===-S?0:this._rts,this.totalTime(Ke(-Math.abs(this._delay),this._tDur,t),!0),Ue(this),Pe(this)},t.paused=function(e){return arguments.length?(this._ps!==e&&(this._ps=e,e?(this._pTime=this._tTime||Math.max(-this._delay,this.rawTime()),this._ts=this._act=0):(At(),this._ts=this._rts,this.totalTime(this.parent&&!this.parent.smoothChildTiming?this.rawTime():this._tTime||this._pTime,1===this.progress()&&Math.abs(this._zTime)!==S&&(this._tTime-=S)))),this):this._ps},t.startTime=function(e){if(arguments.length){this._start=e;var t=this.parent||this._dp;return t&&(t._sort||!this.parent)&&Be(t,this,e-this._delay),this}return this._start},t.endTime=function(e){return this._start+(O(e)?this.totalDuration():this.duration())/Math.abs(this._ts||1)},t.rawTime=function(e){var t=this.parent||this._dp;return t?e&&(!this._ts||this._repeat&&this._time&&this.totalProgress()<1)?this._tTime%(this._dur+this._rDelay):this._ts?Ne(t.rawTime(e),this):this._tTime:this._tTime},t.revert=function(e){void 0===e&&(e=te);var t=o;return o=e,(this._initted||this._startAt)&&(this.timeline&&this.timeline.revert(e),this.totalTime(-.01,e.suppressEvents)),"nested"!==this.data&&!1!==e.kill&&this.kill(),o=t,this},t.globalTime=function(e){for(var t=this,r=arguments.length?e:t.rawTime();t;)r=t._start+r/(t._ts||1),t=t._dp;return!this.parent&&this._sat?this._sat.vars.immediateRender?-1:this._sat.globalTime(e):r},t.repeat=function(e){return arguments.length?(this._repeat=e===1/0?-2:e,Xe(this)):-2===this._repeat?1/0:this._repeat},t.repeatDelay=function(e){if(arguments.length){var t=this._time;return this._rDelay=e,Xe(this),t?this.time(t):this}return this._rDelay},t.yoyo=function(e){return arguments.length?(this._yoyo=e,this):this._yoyo},t.seek=function(e,t){return this.totalTime(Ye(this,e),O(t))},t.restart=function(e,t){return this.play().totalTime(e?-this._delay:0,O(t))},t.play=function(e,t){return null!=e&&this.seek(e,t),this.reversed(!1).paused(!1)},t.reverse=function(e,t){return null!=e&&this.seek(e||this.totalDuration(),t),this.reversed(!0).paused(!1)},t.pause=function(e,t){return null!=e&&this.seek(e,t),this.paused(!0)},t.resume=function(){return this.paused(!1)},t.reversed=function(e){return arguments.length?(!!e!==this.reversed()&&this.timeScale(-this._rts||(e?-S:0)),this):this._rts<0},t.invalidate=function(){return this._initted=this._act=0,this._zTime=-S,this},t.isActive=function(){var e,t=this.parent||this._dp,r=this._start;return!(t&&!(this._ts&&this._initted&&t.isActive()&&(e=t.rawTime(!0))>=r&&e<this.endTime(!0)-S))},t.eventCallback=function(e,t,r){var n=this.vars;return arguments.length>1?(t?(n[e]=t,r&&(n[e+"Params"]=r),"onUpdate"===e&&(this._onUpdate=t)):delete n[e],this):n[e]},t.then=function(e){var t=this;return new Promise((function(r){var n=P(e)?e:be,i=function(){var e=t.then;t.then=null,P(n)&&(n=n(t))&&(n.then||n===t)&&(t.then=e),r(n),t.then=e};t._initted&&1===t.totalProgress()&&t._ts>=0||!t._tTime&&t._ts<0?i():t._prom=i}))},t.kill=function(){ft(this)},e}();we(Bt.prototype,{_time:0,_start:0,_end:0,_tTime:0,_tDur:0,_dirty:0,_repeat:0,_yoyo:!1,parent:null,_initted:!1,_rDelay:0,_ts:1,_dp:0,ratio:0,_zTime:-S,_prom:0,_ps:!1,_rts:1});var zt=function(e){function t(t,r){var i;return void 0===t&&(t={}),(i=e.call(this,t)||this).labels={},i.smoothChildTiming=!!t.smoothChildTiming,i.autoRemoveChildren=!!t.autoRemoveChildren,i._sort=O(t.sortChildren),l&&Be(t.parent||l,n(i),r),t.reversed&&i.reverse(),t.paused&&i.paused(!0),t.scrollTrigger&&ze(n(i),t.scrollTrigger),i}i(t,e);var r=t.prototype;return r.to=function(e,t,r){return Ze(0,arguments,this),this},r.from=function(e,t,r){return Ze(1,arguments,this),this},r.fromTo=function(e,t,r,n){return Ze(2,arguments,this),this},r.set=function(e,t,r){return t.duration=0,t.parent=this,Ee(t).repeatDelay||(t.repeat=0),t.immediateRender=!!t.immediateRender,new Qt(e,t,Ye(this,r),1),this},r.call=function(e,t,r){return Be(this,Qt.delayedCall(0,e,t),r)},r.staggerTo=function(e,t,r,n,i,s,o){return r.duration=t,r.stagger=r.stagger||n,r.onComplete=s,r.onCompleteParams=o,r.parent=this,new Qt(e,r,Ye(this,i)),this},r.staggerFrom=function(e,t,r,n,i,s,o){return r.runBackwards=1,Ee(r).immediateRender=O(r.immediateRender),this.staggerTo(e,t,r,n,i,s,o)},r.staggerFromTo=function(e,t,r,n,i,s,o,a){return n.startAt=r,Ee(n).immediateRender=O(n.immediateRender),this.staggerTo(e,t,n,i,s,o,a)},r.render=function(e,t,r){var n,i,s,a,c,u,h,d,p,f,m,g,y=this._time,v=this._dirty?this.totalDuration():this._tDur,_=this._dur,x=e<=0?0:me(e),b=this._zTime<0!=e<0&&(this._initted||!_);if(this!==l&&x>v&&e>=0&&(x=v),x!==this._tTime||r||b){if(y!==this._time&&_&&(x+=this._time-y,e+=this._time-y),n=x,p=this._start,u=!(d=this._ts),b&&(_||(y=this._zTime),(e||!t)&&(this._zTime=e)),this._repeat){if(m=this._yoyo,c=_+this._rDelay,this._repeat<-1&&e<0)return this.totalTime(100*c+e,t,r);if(n=me(x%c),x===v?(a=this._repeat,n=_):((a=~~(x/c))&&a===x/c&&(n=_,a--),n>_&&(n=_)),f=Oe(this._tTime,c),!y&&this._tTime&&f!==a&&this._tTime-f*c-this._dur<=0&&(f=a),m&&1&a&&(n=_-n,g=1),a!==f&&!this._lock){var w=m&&1&f,M=w===(m&&1&a);if(a<f&&(w=!w),y=w?0:_,this._lock=1,this.render(y||(g?0:me(a*c)),t,!_)._lock=0,this._tTime=x,!t&&this.parent&&pt(this,"onRepeat"),this.vars.repeatRefresh&&!g&&(this.invalidate()._lock=1),y&&y!==this._time||u!==!this._ts||this.vars.onRepeat&&!this.parent&&!this._act)return this;if(_=this._dur,v=this._tDur,M&&(this._lock=2,y=w?_:-1e-4,this.render(y,!0),this.vars.repeatRefresh&&!g&&this.invalidate()),this._lock=0,!this._ts&&!u)return this;It(this,g)}}if(this._hasPause&&!this._forcing&&this._lock<2&&(h=function(e,t,r){var n;if(r>t)for(n=e._first;n&&n._start<=r;){if("isPause"===n.data&&n._start>t)return n;n=n._next}else for(n=e._last;n&&n._start>=r;){if("isPause"===n.data&&n._start<t)return n;n=n._prev}}(this,me(y),me(n)),h&&(x-=n-(n=h._start))),this._tTime=x,this._time=n,this._act=!d,this._initted||(this._onUpdate=this.vars.onUpdate,this._initted=1,this._zTime=e,y=0),!y&&n&&!t&&!a&&(pt(this,"onStart"),this._tTime!==x))return this;if(n>=y&&e>=0)for(i=this._first;i;){if(s=i._next,(i._act||n>=i._start)&&i._ts&&h!==i){if(i.parent!==this)return this.render(e,t,r);if(i.render(i._ts>0?(n-i._start)*i._ts:(i._dirty?i.totalDuration():i._tDur)+(n-i._start)*i._ts,t,r),n!==this._time||!this._ts&&!u){h=0,s&&(x+=this._zTime=-S);break}}i=s}else{i=this._last;for(var T=e<0?e:n;i;){if(s=i._prev,(i._act||T<=i._end)&&i._ts&&h!==i){if(i.parent!==this)return this.render(e,t,r);if(i.render(i._ts>0?(T-i._start)*i._ts:(i._dirty?i.totalDuration():i._tDur)+(T-i._start)*i._ts,t,r||o&&(i._initted||i._startAt)),n!==this._time||!this._ts&&!u){h=0,s&&(x+=this._zTime=T?-S:S);break}}i=s}}if(h&&!t&&(this.pause(),h.render(n>=y?0:-S)._zTime=n>=y?1:-1,this._ts))return this._start=p,Ue(this),this.render(e,t,r);this._onUpdate&&!t&&pt(this,"onUpdate",!0),(x===v&&this._tTime>=this.totalDuration()||!x&&y)&&(p!==this._start&&Math.abs(d)===Math.abs(this._ts)||this._lock||((e||!_)&&(x===v&&this._ts>0||!x&&this._ts<0)&&Le(this,1),t||e<0&&!y||!x&&!y&&v||(pt(this,x===v&&e>=0?"onComplete":"onReverseComplete",!0),this._prom&&!(x<v&&this.timeScale()>0)&&this._prom())))}return this},r.add=function(e,t){var r=this;if(j(t)||(t=Ye(this,t,e)),!(e instanceof Bt)){if(F(e))return e.forEach((function(e){return r.add(e,t)})),this;if(R(e))return this.addLabel(e,t);if(!P(e))return this;e=Qt.delayedCall(0,e)}return this!==e?Be(this,e,t):this},r.getChildren=function(e,t,r,n){void 0===e&&(e=!0),void 0===t&&(t=!0),void 0===r&&(r=!0),void 0===n&&(n=-w);for(var i=[],s=this._first;s;)s._start>=n&&(s instanceof Qt?t&&i.push(s):(r&&i.push(s),e&&i.push.apply(i,s.getChildren(!0,t,r)))),s=s._next;return i},r.getById=function(e){for(var t=this.getChildren(1,1,1),r=t.length;r--;)if(t[r].vars.id===e)return t[r]},r.remove=function(e){return R(e)?this.removeLabel(e):P(e)?this.killTweensOf(e):(Ce(this,e),e===this._recent&&(this._recent=this._last),Re(this))},r.totalTime=function(t,r){return arguments.length?(this._forcing=1,!this._dp&&this._ts&&(this._start=me(Et.time-(this._ts>0?t/this._ts:(this.totalDuration()-t)/-this._ts))),e.prototype.totalTime.call(this,t,r),this._forcing=0,this):this._tTime},r.addLabel=function(e,t){return this.labels[e]=Ye(this,t),this},r.removeLabel=function(e){return delete this.labels[e],this},r.addPause=function(e,t,r){var n=Qt.delayedCall(0,t||Q,r);return n.data="isPause",this._hasPause=1,Be(this,n,Ye(this,e))},r.removePause=function(e){var t=this._first;for(e=Ye(this,e);t;)t._start===e&&"isPause"===t.data&&Le(t),t=t._next},r.killTweensOf=function(e,t,r){for(var n=this.getTweensOf(e,r),i=n.length;i--;)Gt!==n[i]&&n[i].kill(e,t);return this},r.getTweensOf=function(e,t){for(var r,n=[],i=rt(e),s=this._first,o=j(t);s;)s instanceof Qt?ye(s._targets,i)&&(o?(!Gt||s._initted&&s._ts)&&s.globalTime(0)<=t&&s.globalTime(s.totalDuration())>t:!t||s.isActive())&&n.push(s):(r=s.getTweensOf(i,t)).length&&n.push.apply(n,r),s=s._next;return n},r.tweenTo=function(e,t){t=t||{};var r,n=this,i=Ye(n,e),s=t,o=s.startAt,a=s.onStart,l=s.onStartParams,c=s.immediateRender,u=Qt.to(n,we({ease:t.ease||"none",lazy:!1,immediateRender:!1,time:i,overwrite:"auto",duration:t.duration||Math.abs((i-(o&&"time"in o?o.time:n._time))/n.timeScale())||S,onStart:function(){if(n.pause(),!r){var e=t.duration||Math.abs((i-(o&&"time"in o?o.time:n._time))/n.timeScale());u._dur!==e&&We(u,e,0,1).render(u._time,!0,!0),r=1}a&&a.apply(u,l||[])}},t));return c?u.render(0):u},r.tweenFromTo=function(e,t,r){return this.tweenTo(t,we({startAt:{time:Ye(this,e)}},r))},r.recent=function(){return this._recent},r.nextLabel=function(e){return void 0===e&&(e=this._time),dt(this,Ye(this,e))},r.previousLabel=function(e){return void 0===e&&(e=this._time),dt(this,Ye(this,e),1)},r.currentLabel=function(e){return arguments.length?this.seek(e,!0):this.previousLabel(this._time+S)},r.shiftChildren=function(e,t,r){void 0===r&&(r=0);for(var n,i=this._first,s=this.labels;i;)i._start>=r&&(i._start+=e,i._end+=e),i=i._next;if(t)for(n in s)s[n]>=r&&(s[n]+=e);return Re(this)},r.invalidate=function(t){var r=this._first;for(this._lock=0;r;)r.invalidate(t),r=r._next;return e.prototype.invalidate.call(this,t)},r.clear=function(e){void 0===e&&(e=!0);for(var t,r=this._first;r;)t=r._next,this.remove(r),r=t;return this._dp&&(this._time=this._tTime=this._pTime=0),e&&(this.labels={}),Re(this)},r.totalDuration=function(e){var t,r,n,i=0,s=this,o=s._last,a=w;if(arguments.length)return s.timeScale((s._repeat<0?s.duration():s.totalDuration())/(s.reversed()?-e:e));if(s._dirty){for(n=s.parent;o;)t=o._prev,o._dirty&&o.totalDuration(),(r=o._start)>a&&s._sort&&o._ts&&!s._lock?(s._lock=1,Be(s,o,r-o._delay,1)._lock=0):a=r,r<0&&o._ts&&(i-=r,(!n&&!s._dp||n&&n.smoothChildTiming)&&(s._start+=r/s._ts,s._time-=r,s._tTime-=r),s.shiftChildren(-r,!1,-Infinity),a=0),o._end>i&&o._ts&&(i=o._end),o=t;We(s,s===l&&s._time>i?s._time:i,1,1),s._dirty=0}return s._tDur},t.updateRoot=function(e){if(l._ts&&(_e(l,Ne(e,l)),p=Et.frame),Et.frame>=ae){ae+=x.autoSleep||120;var t=l._first;if((!t||!t._ts)&&x.autoSleep&&Et._listeners.length<2){for(;t&&!t._ts;)t=t._next;t||Et.sleep()}}},t}(Bt);we(zt.prototype,{_lock:0,_hasPause:0,_forcing:0});var Gt,Vt,Ht=function(e,t,r,n,i,s,o){var a,l,c,u,h,d,p,f,m=new dr(this._pt,e,t,0,1,or,null,i),g=0,y=0;for(m.b=r,m.e=n,r+="",(p=~(n+="").indexOf("random("))&&(n=ut(n)),s&&(s(f=[r,n],e,t),r=f[0],n=f[1]),l=r.match(V)||[];a=V.exec(n);)u=a[0],h=n.substring(g,a.index),c?c=(c+1)%5:"rgba("===h.substr(-5)&&(c=1),u!==l[y++]&&(d=parseFloat(l[y-1])||0,m._pt={_next:m._pt,p:h||1===y?h:",",s:d,c:"="===u.charAt(1)?ge(d,u)-d:parseFloat(u)-d,m:c&&c<4?Math.round:0},g=V.lastIndex);return m.c=g<n.length?n.substring(g,n.length):"",m.fp=o,(H.test(n)||p)&&(m.e=0),this._pt=m,m},Wt=function(e,t,r,n,i,s,o,a,l,c){P(n)&&(n=n(i||0,e,s));var u,h=e[t],d="get"!==r?r:P(h)?l?e[t.indexOf("set")||!P(e["get"+t.substr(3)])?t:"get"+t.substr(3)](l):e[t]():h,p=P(h)?l?tr:er:$t;if(R(n)&&(~n.indexOf("random(")&&(n=ut(n)),"="===n.charAt(1)&&((u=ge(d,n)+(Qe(d)||0))||0===u)&&(n=u)),!c||d!==n||Vt)return isNaN(d*n)||""===n?Ht.call(this,e,t,d,n,p,a||x.stringFilter,l):(u=new dr(this._pt,e,t,+d||0,n-(d||0),"boolean"==typeof h?sr:ir,0,p),l&&(u.fp=l),o&&u.modifier(o,this,e),this._pt=u)},Xt=function(e,t,r,n,i,s){var o,a,l,c;if(se[e]&&!1!==(o=new se[e]).init(i,o.rawVars?t[e]:function(e,t,r,n,i){if(P(e)&&(e=Zt(e,i,t,r,n)),!D(e)||e.style&&e.nodeType||F(e)||k(e))return R(e)?Zt(e,i,t,r,n):e;var s,o={};for(s in e)o[s]=Zt(e[s],i,t,r,n);return o}(t[e],n,i,s,r),r,n,s)&&(r._pt=a=new dr(r._pt,i,e,0,1,o.render,o,0,o.priority),r!==f))for(l=r._ptLookup[r._targets.indexOf(i)],c=o._props.length;c--;)l[o._props[c]]=a;return o},qt=function e(t,r,n){var i,a,c,u,h,d,p,f,m,g,y,v,_,x=t.vars,M=x.ease,T=x.startAt,E=x.immediateRender,A=x.lazy,C=x.onUpdate,L=x.onUpdateParams,R=x.callbackScope,P=x.runBackwards,j=x.yoyoEase,I=x.keyframes,D=x.autoRevert,N=t._dur,U=t._startAt,k=t._targets,F=t.parent,B=F&&"nested"===F.data?F.vars.targets:k,z="auto"===t._overwrite&&!s,G=t.timeline;if(G&&(!I||!M)&&(M="none"),t._ease=Dt(M,b.ease),t._yEase=j?jt(Dt(!0===j?M:j,b.ease)):0,j&&t._yoyo&&!t._repeat&&(j=t._yEase,t._yEase=t._ease,t._ease=j),t._from=!G&&!!x.runBackwards,!G||I&&!x.stagger){if(v=(f=k[0]?he(k[0]).harness:0)&&x[f.prop],i=Te(x,re),U&&(U._zTime<0&&U.progress(1),r<0&&P&&E&&!D?U.render(-1,!0):U.revert(P&&N?ee:$),U._lazy=0),T){if(Le(t._startAt=Qt.set(k,we({data:"isStart",overwrite:!1,parent:F,immediateRender:!0,lazy:!U&&O(A),startAt:null,delay:0,onUpdate:C,onUpdateParams:L,callbackScope:R,stagger:0},T))),t._startAt._dp=0,t._startAt._sat=t,r<0&&(o||!E&&!D)&&t._startAt.revert(ee),E&&N&&r<=0&&n<=0)return void(r&&(t._zTime=r))}else if(P&&N&&!U)if(r&&(E=!1),c=we({overwrite:!1,data:"isFromStart",lazy:E&&!U&&O(A),immediateRender:E,stagger:0,parent:F},i),v&&(c[f.prop]=v),Le(t._startAt=Qt.set(k,c)),t._startAt._dp=0,t._startAt._sat=t,r<0&&(o?t._startAt.revert(ee):t._startAt.render(-1,!0)),t._zTime=r,E){if(!r)return}else e(t._startAt,S,S);for(t._pt=t._ptCache=0,A=N&&O(A)||A&&!N,a=0;a<k.length;a++){if(p=(h=k[a])._gsap||ue(k)[a]._gsap,t._ptLookup[a]=g={},ie[p.id]&&ne.length&&ve(),y=B===k?a:B.indexOf(h),f&&!1!==(m=new f).init(h,v||i,t,y,B)&&(t._pt=u=new dr(t._pt,h,m.name,0,1,m.render,m,0,m.priority),m._props.forEach((function(e){g[e]=u})),m.priority&&(d=1)),!f||v)for(c in i)se[c]&&(m=Xt(c,i,t,y,h,B))?m.priority&&(d=1):g[c]=u=Wt.call(t,h,c,"get",i[c],y,B,0,x.stringFilter);t._op&&t._op[a]&&t.kill(h,t._op[a]),z&&t._pt&&(Gt=t,l.killTweensOf(h,g,t.globalTime(r)),_=!t.parent,Gt=0),t._pt&&A&&(ie[p.id]=1)}d&&hr(t),t._onInit&&t._onInit(t)}t._onUpdate=C,t._initted=(!t._op||t._pt)&&!_,I&&r<=0&&G.render(w,!0,!0)},Yt=function(e,t,r,n){var i,s,o=t.ease||n||"power1.inOut";if(F(t))s=r[e]||(r[e]=[]),t.forEach((function(e,r){return s.push({t:r/(t.length-1)*100,v:e,e:o})}));else for(i in t)s=r[i]||(r[i]=[]),"ease"===i||s.push({t:parseFloat(e),v:t[i],e:o})},Zt=function(e,t,r,n,i){return P(e)?e.call(t,r,n,i):R(e)&&~e.indexOf("random(")?ut(e):e},Jt=ce+"repeat,repeatDelay,yoyo,repeatRefresh,yoyoEase,autoRevert",Kt={};pe(Jt+",id,stagger,delay,duration,paused,scrollTrigger",(function(e){return Kt[e]=1}));var Qt=function(e){function t(t,r,i,o){var a;"number"==typeof r&&(i.duration=r,r=i,i=null);var c,u,h,d,p,f,m,g,y=(a=e.call(this,o?r:Ee(r))||this).vars,v=y.duration,_=y.delay,b=y.immediateRender,w=y.stagger,M=y.overwrite,T=y.keyframes,E=y.defaults,A=y.scrollTrigger,C=y.yoyoEase,L=r.parent||l,R=(F(t)||k(t)?j(t[0]):"length"in r)?[t]:rt(t);if(a._targets=R.length?ue(R):J("GSAP target "+t+" not found. https://greensock.com",!x.nullTargetWarn)||[],a._ptLookup=[],a._overwrite=M,T||w||U(v)||U(_)){if(r=a.vars,(c=a.timeline=new zt({data:"nested",defaults:E||{},targets:L&&"nested"===L.data?L.vars.targets:R})).kill(),c.parent=c._dp=n(a),c._start=0,w||U(v)||U(_)){if(d=R.length,m=w&&st(w),D(w))for(p in w)~Jt.indexOf(p)&&(g||(g={}),g[p]=w[p]);for(u=0;u<d;u++)(h=Te(r,Kt)).stagger=0,C&&(h.yoyoEase=C),g&&Se(h,g),f=R[u],h.duration=+Zt(v,n(a),u,f,R),h.delay=(+Zt(_,n(a),u,f,R)||0)-a._delay,!w&&1===d&&h.delay&&(a._delay=_=h.delay,a._start+=_,h.delay=0),c.to(f,h,m?m(u,f,R):0),c._ease=Ct.none;c.duration()?v=_=0:a.timeline=0}else if(T){Ee(we(c.vars.defaults,{ease:"none"})),c._ease=Dt(T.ease||r.ease||"none");var P,I,N,B=0;if(F(T))T.forEach((function(e){return c.to(R,e,">")})),c.duration();else{for(p in h={},T)"ease"===p||"easeEach"===p||Yt(p,T[p],h,T.easeEach);for(p in h)for(P=h[p].sort((function(e,t){return e.t-t.t})),B=0,u=0;u<P.length;u++)(N={ease:(I=P[u]).e,duration:(I.t-(u?P[u-1].t:0))/100*v})[p]=I.v,c.to(R,N,B),B+=N.duration;c.duration()<v&&c.to({},{duration:v-c.duration()})}}v||a.duration(v=c.duration())}else a.timeline=0;return!0!==M||s||(Gt=n(a),l.killTweensOf(R),Gt=0),Be(L,n(a),i),r.reversed&&a.reverse(),r.paused&&a.paused(!0),(b||!v&&!T&&a._start===me(L._time)&&O(b)&&Ie(n(a))&&"nested"!==L.data)&&(a._tTime=-S,a.render(Math.max(0,-_)||0)),A&&ze(n(a),A),a}i(t,e);var r=t.prototype;return r.render=function(e,t,r){var n,i,s,a,l,c,u,h,d,p=this._time,f=this._tDur,m=this._dur,g=e<0,y=e>f-S&&!g?f:e<S?0:e;if(m){if(y!==this._tTime||!e||r||!this._initted&&this._tTime||this._startAt&&this._zTime<0!==g){if(n=y,h=this.timeline,this._repeat){if(a=m+this._rDelay,this._repeat<-1&&g)return this.totalTime(100*a+e,t,r);if(n=me(y%a),y===f?(s=this._repeat,n=m):((s=~~(y/a))&&s===y/a&&(n=m,s--),n>m&&(n=m)),(c=this._yoyo&&1&s)&&(d=this._yEase,n=m-n),l=Oe(this._tTime,a),n===p&&!r&&this._initted)return this._tTime=y,this;s!==l&&(h&&this._yEase&&It(h,c),!this.vars.repeatRefresh||c||this._lock||(this._lock=r=1,this.render(me(a*s),!0).invalidate()._lock=0))}if(!this._initted){if(Ge(this,g?e:n,r,t,y))return this._tTime=0,this;if(p!==this._time)return this;if(m!==this._dur)return this.render(e,t,r)}if(this._tTime=y,this._time=n,!this._act&&this._ts&&(this._act=1,this._lazy=0),this.ratio=u=(d||this._ease)(n/m),this._from&&(this.ratio=u=1-u),n&&!p&&!t&&!s&&(pt(this,"onStart"),this._tTime!==y))return this;for(i=this._pt;i;)i.r(u,i.d),i=i._next;h&&h.render(e<0?e:!n&&c?-S:h._dur*h._ease(n/this._dur),t,r)||this._startAt&&(this._zTime=e),this._onUpdate&&!t&&(g&&je(this,e,0,r),pt(this,"onUpdate")),this._repeat&&s!==l&&this.vars.onRepeat&&!t&&this.parent&&pt(this,"onRepeat"),y!==this._tDur&&y||this._tTime!==y||(g&&!this._onUpdate&&je(this,e,0,!0),(e||!m)&&(y===this._tDur&&this._ts>0||!y&&this._ts<0)&&Le(this,1),t||g&&!p||!(y||p||c)||(pt(this,y===f?"onComplete":"onReverseComplete",!0),this._prom&&!(y<f&&this.timeScale()>0)&&this._prom()))}}else!function(e,t,r,n){var i,s,a,l=e.ratio,c=t<0||!t&&(!e._start&&Ve(e)&&(e._initted||!He(e))||(e._ts<0||e._dp._ts<0)&&!He(e))?0:1,u=e._rDelay,h=0;if(u&&e._repeat&&(h=Ke(0,e._tDur,t),s=Oe(h,u),e._yoyo&&1&s&&(c=1-c),s!==Oe(e._tTime,u)&&(l=1-c,e.vars.repeatRefresh&&e._initted&&e.invalidate())),c!==l||o||n||e._zTime===S||!t&&e._zTime){if(!e._initted&&Ge(e,t,n,r,h))return;for(a=e._zTime,e._zTime=t||(r?S:0),r||(r=t&&!a),e.ratio=c,e._from&&(c=1-c),e._time=0,e._tTime=h,i=e._pt;i;)i.r(c,i.d),i=i._next;t<0&&je(e,t,0,!0),e._onUpdate&&!r&&pt(e,"onUpdate"),h&&e._repeat&&!r&&e.parent&&pt(e,"onRepeat"),(t>=e._tDur||t<0)&&e.ratio===c&&(c&&Le(e,1),r||o||(pt(e,c?"onComplete":"onReverseComplete",!0),e._prom&&e._prom()))}else e._zTime||(e._zTime=t)}(this,e,t,r);return this},r.targets=function(){return this._targets},r.invalidate=function(t){return(!t||!this.vars.runBackwards)&&(this._startAt=0),this._pt=this._op=this._onUpdate=this._lazy=this.ratio=0,this._ptLookup=[],this.timeline&&this.timeline.invalidate(t),e.prototype.invalidate.call(this,t)},r.resetTo=function(e,t,r,n){m||Et.wake(),this._ts||this.play();var i=Math.min(this._dur,(this._dp._time-this._start)*this._ts);return this._initted||qt(this,i),function(e,t,r,n,i,s,o){var a,l,c,u,h=(e._pt&&e._ptCache||(e._ptCache={}))[t];if(!h)for(h=e._ptCache[t]=[],c=e._ptLookup,u=e._targets.length;u--;){if((a=c[u][t])&&a.d&&a.d._pt)for(a=a.d._pt;a&&a.p!==t&&a.fp!==t;)a=a._next;if(!a)return Vt=1,e.vars[t]="+=0",qt(e,o),Vt=0,1;h.push(a)}for(u=h.length;u--;)(a=(l=h[u])._pt||l).s=!n&&0!==n||i?a.s+(n||0)+s*a.c:n,a.c=r-a.s,l.e&&(l.e=fe(r)+Qe(l.e)),l.b&&(l.b=a.s+Qe(l.b))}(this,e,t,r,n,this._ease(i/this._dur),i)?this.resetTo(e,t,r,n):(ke(this,0),this.parent||Ae(this._dp,this,"_first","_last",this._dp._sort?"_start":0),this.render(0))},r.kill=function(e,t){if(void 0===t&&(t="all"),!(e||t&&"all"!==t))return this._lazy=this._pt=0,this.parent?ft(this):this;if(this.timeline){var r=this.timeline.totalDuration();return this.timeline.killTweensOf(e,t,Gt&&!0!==Gt.vars.overwrite)._first||ft(this),this.parent&&r!==this.timeline.totalDuration()&&We(this,this._dur*this.timeline._tDur/r,0,1),this}var n,i,s,o,a,l,c,u=this._targets,h=e?rt(e):u,d=this._ptLookup,p=this._pt;if((!t||"all"===t)&&function(e,t){for(var r=e.length,n=r===t.length;n&&r--&&e[r]===t[r];);return r<0}(u,h))return"all"===t&&(this._pt=0),ft(this);for(n=this._op=this._op||[],"all"!==t&&(R(t)&&(a={},pe(t,(function(e){return a[e]=1})),t=a),t=function(e,t){var r,n,i,s,o=e[0]?he(e[0]).harness:0,a=o&&o.aliases;if(!a)return t;for(n in r=Se({},t),a)if(n in r)for(i=(s=a[n].split(",")).length;i--;)r[s[i]]=r[n];return r}(u,t)),c=u.length;c--;)if(~h.indexOf(u[c]))for(a in i=d[c],"all"===t?(n[c]=t,o=i,s={}):(s=n[c]=n[c]||{},o=t),o)(l=i&&i[a])&&("kill"in l.d&&!0!==l.d.kill(a)||Ce(this,l,"_pt"),delete i[a]),"all"!==s&&(s[a]=1);return this._initted&&!this._pt&&p&&ft(this),this},t.to=function(e,r){return new t(e,r,arguments[2])},t.from=function(e,t){return Ze(1,arguments)},t.delayedCall=function(e,r,n,i){return new t(r,0,{immediateRender:!1,lazy:!1,overwrite:!1,delay:e,onComplete:r,onReverseComplete:r,onCompleteParams:n,onReverseCompleteParams:n,callbackScope:i})},t.fromTo=function(e,t,r){return Ze(2,arguments)},t.set=function(e,r){return r.duration=0,r.repeatDelay||(r.repeat=0),new t(e,r)},t.killTweensOf=function(e,t,r){return l.killTweensOf(e,t,r)},t}(Bt);we(Qt.prototype,{_targets:[],_lazy:0,_startAt:0,_op:0,_onInit:0}),pe("staggerTo,staggerFrom,staggerFromTo",(function(e){Qt[e]=function(){var t=new zt,r=$e.call(arguments,0);return r.splice("staggerFromTo"===e?5:4,0,0),t[e].apply(t,r)}}));var $t=function(e,t,r){return e[t]=r},er=function(e,t,r){return e[t](r)},tr=function(e,t,r,n){return e[t](n.fp,r)},rr=function(e,t,r){return e.setAttribute(t,r)},nr=function(e,t){return P(e[t])?er:I(e[t])&&e.setAttribute?rr:$t},ir=function(e,t){return t.set(t.t,t.p,Math.round(1e6*(t.s+t.c*e))/1e6,t)},sr=function(e,t){return t.set(t.t,t.p,!!(t.s+t.c*e),t)},or=function(e,t){var r=t._pt,n="";if(!e&&t.b)n=t.b;else if(1===e&&t.e)n=t.e;else{for(;r;)n=r.p+(r.m?r.m(r.s+r.c*e):Math.round(1e4*(r.s+r.c*e))/1e4)+n,r=r._next;n+=t.c}t.set(t.t,t.p,n,t)},ar=function(e,t){for(var r=t._pt;r;)r.r(e,r.d),r=r._next},lr=function(e,t,r,n){for(var i,s=this._pt;s;)i=s._next,s.p===n&&s.modifier(e,t,r),s=i},cr=function(e){for(var t,r,n=this._pt;n;)r=n._next,n.p===e&&!n.op||n.op===e?Ce(this,n,"_pt"):n.dep||(t=1),n=r;return!t},ur=function(e,t,r,n){n.mSet(e,t,n.m.call(n.tween,r,n.mt),n)},hr=function(e){for(var t,r,n,i,s=e._pt;s;){for(t=s._next,r=n;r&&r.pr>s.pr;)r=r._next;(s._prev=r?r._prev:i)?s._prev._next=s:n=s,(s._next=r)?r._prev=s:i=s,s=t}e._pt=n},dr=function(){function e(e,t,r,n,i,s,o,a,l){this.t=t,this.s=n,this.c=i,this.p=r,this.r=s||ir,this.d=o||this,this.set=a||$t,this.pr=l||0,this._next=e,e&&(e._prev=this)}return e.prototype.modifier=function(e,t,r){this.mSet=this.mSet||this.set,this.set=ur,this.m=e,this.mt=r,this.tween=t},e}();pe(ce+"parent,duration,ease,delay,overwrite,runBackwards,startAt,yoyo,immediateRender,repeat,repeatDelay,data,paused,reversed,lazy,callbackScope,stringFilter,id,yoyoEase,stagger,inherit,repeatRefresh,keyframes,autoRevert,scrollTrigger",(function(e){return re[e]=1})),q.TweenMax=q.TweenLite=Qt,q.TimelineLite=q.TimelineMax=zt,l=new zt({sortChildren:!1,defaults:b,autoRemoveChildren:!0,id:"root",smoothChildTiming:!0}),x.stringFilter=Tt;var pr=[],fr={},mr=[],gr=0,yr=function(e){return(fr[e]||mr).map((function(e){return e()}))},vr=function(){var e=Date.now(),t=[];e-gr>2&&(yr("matchMediaInit"),pr.forEach((function(e){var r,n,i,s,o=e.queries,a=e.conditions;for(n in o)(r=c.matchMedia(o[n]).matches)&&(i=1),r!==a[n]&&(a[n]=r,s=1);s&&(e.revert(),i&&t.push(e))})),yr("matchMediaRevert"),t.forEach((function(e){return e.onMatch(e)})),gr=e,yr("matchMedia"))},_r=function(){function e(e,t){this.selector=t&&nt(t),this.data=[],this._r=[],this.isReverted=!1,e&&this.add(e)}var t=e.prototype;return t.add=function(e,t,r){P(e)&&(r=t,t=e,e=P);var n=this,i=function(){var e,i=a,s=n.selector;return i&&i!==n&&i.data.push(n),r&&(n.selector=nt(r)),a=n,e=t.apply(n,arguments),P(e)&&n._r.push(e),a=i,n.selector=s,n.isReverted=!1,e};return n.last=i,e===P?i(n):e?n[e]=i:i},t.ignore=function(e){var t=a;a=null,e(this),a=t},t.getTweens=function(){var t=[];return this.data.forEach((function(r){return r instanceof e?t.push.apply(t,r.getTweens()):r instanceof Qt&&!(r.parent&&"nested"===r.parent.data)&&t.push(r)})),t},t.clear=function(){this._r.length=this.data.length=0},t.kill=function(e,t){var r=this;if(e){var n=this.getTweens();this.data.forEach((function(e){"isFlip"===e.data&&(e.revert(),e.getChildren(!0,!0,!1).forEach((function(e){return n.splice(n.indexOf(e),1)})))})),n.map((function(e){return{g:e.globalTime(0),t:e}})).sort((function(e,t){return t.g-e.g||-1})).forEach((function(t){return t.t.revert(e)})),this.data.forEach((function(t){return!(t instanceof Bt)&&t.revert&&t.revert(e)})),this._r.forEach((function(t){return t(e,r)})),this.isReverted=!0}else this.data.forEach((function(e){return e.kill&&e.kill()}));if(this.clear(),t){var i=pr.indexOf(this);~i&&pr.splice(i,1)}},t.revert=function(e){this.kill(e||{})},e}(),xr=function(){function e(e){this.contexts=[],this.scope=e}var t=e.prototype;return t.add=function(e,t,r){D(e)||(e={matches:e});var n,i,s,o=new _r(0,r||this.scope),a=o.conditions={};for(i in this.contexts.push(o),t=o.add("onMatch",t),o.queries=e,e)"all"===i?s=1:(n=c.matchMedia(e[i]))&&(pr.indexOf(o)<0&&pr.push(o),(a[i]=n.matches)&&(s=1),n.addListener?n.addListener(vr):n.addEventListener("change",vr));return s&&t(o),this},t.revert=function(e){this.kill(e||{})},t.kill=function(e){this.contexts.forEach((function(t){return t.kill(e,!0)}))},e}(),br={registerPlugin:function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];t.forEach((function(e){return gt(e)}))},timeline:function(e){return new zt(e)},getTweensOf:function(e,t){return l.getTweensOf(e,t)},getProperty:function(e,t,r,n){R(e)&&(e=rt(e)[0]);var i=he(e||{}).get,s=r?be:xe;return"native"===r&&(r=""),e?t?s((se[t]&&se[t].get||i)(e,t,r,n)):function(t,r,n){return s((se[t]&&se[t].get||i)(e,t,r,n))}:e},quickSetter:function(e,t,r){if((e=rt(e)).length>1){var n=e.map((function(e){return Mr.quickSetter(e,t,r)})),i=n.length;return function(e){for(var t=i;t--;)n[t](e)}}e=e[0]||{};var s=se[t],o=he(e),a=o.harness&&(o.harness.aliases||{})[t]||t,l=s?function(t){var n=new s;f._pt=0,n.init(e,r?t+r:t,f,0,[e]),n.render(1,n),f._pt&&ar(1,f)}:o.set(e,a);return s?l:function(t){return l(e,a,r?t+r:t,o,1)}},quickTo:function(e,t,r){var n,i=Mr.to(e,Se(((n={})[t]="+=0.1",n.paused=!0,n),r||{})),s=function(e,r,n){return i.resetTo(t,e,r,n)};return s.tween=i,s},isTweening:function(e){return l.getTweensOf(e,!0).length>0},defaults:function(e){return e&&e.ease&&(e.ease=Dt(e.ease,b.ease)),Me(b,e||{})},config:function(e){return Me(x,e||{})},registerEffect:function(e){var t=e.name,r=e.effect,n=e.plugins,i=e.defaults,s=e.extendTimeline;(n||"").split(",").forEach((function(e){return e&&!se[e]&&!q[e]&&J(t+" effect requires "+e+" plugin.")})),oe[t]=function(e,t,n){return r(rt(e),we(t||{},i),n)},s&&(zt.prototype[t]=function(e,r,n){return this.add(oe[t](e,D(r)?r:(n=r)&&{},this),n)})},registerEase:function(e,t){Ct[e]=Dt(t)},parseEase:function(e,t){return arguments.length?Dt(e,t):Ct},getById:function(e){return l.getById(e)},exportRoot:function(e,t){void 0===e&&(e={});var r,n,i=new zt(e);for(i.smoothChildTiming=O(e.smoothChildTiming),l.remove(i),i._dp=0,i._time=i._tTime=l._time,r=l._first;r;)n=r._next,!t&&!r._dur&&r instanceof Qt&&r.vars.onComplete===r._targets[0]||Be(i,r,r._start-r._delay),r=n;return Be(l,i,0),i},context:function(e,t){return e?new _r(e,t):a},matchMedia:function(e){return new xr(e)},matchMediaRefresh:function(){return pr.forEach((function(e){var t,r,n=e.conditions;for(r in n)n[r]&&(n[r]=!1,t=1);t&&e.revert()}))||vr()},addEventListener:function(e,t){var r=fr[e]||(fr[e]=[]);~r.indexOf(t)||r.push(t)},removeEventListener:function(e,t){var r=fr[e],n=r&&r.indexOf(t);n>=0&&r.splice(n,1)},utils:{wrap:function e(t,r,n){var i=r-t;return F(t)?ct(t,e(0,t.length),r):Je(n,(function(e){return(i+(e-t)%i)%i+t}))},wrapYoyo:function e(t,r,n){var i=r-t,s=2*i;return F(t)?ct(t,e(0,t.length-1),r):Je(n,(function(e){return t+((e=(s+(e-t)%s)%s||0)>i?s-e:e)}))},distribute:st,random:lt,snap:at,normalize:function(e,t,r){return ht(e,t,0,1,r)},getUnit:Qe,clamp:function(e,t,r){return Je(r,(function(r){return Ke(e,t,r)}))},splitColor:xt,toArray:rt,selector:nt,mapRange:ht,pipe:function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return function(e){return t.reduce((function(e,t){return t(e)}),e)}},unitize:function(e,t){return function(r){return e(parseFloat(r))+(t||Qe(r))}},interpolate:function e(t,r,n,i){var s=isNaN(t+r)?0:function(e){return(1-e)*t+e*r};if(!s){var o,a,l,c,u,h=R(t),d={};if(!0===n&&(i=1)&&(n=null),h)t={p:t},r={p:r};else if(F(t)&&!F(r)){for(l=[],c=t.length,u=c-2,a=1;a<c;a++)l.push(e(t[a-1],t[a]));c--,s=function(e){e*=c;var t=Math.min(u,~~e);return l[t](e-t)},n=r}else i||(t=Se(F(t)?[]:{},t));if(!l){for(o in r)Wt.call(d,t,o,"get",r[o]);s=function(e){return ar(e,d)||(h?t.p:t)}}}return Je(n,s)},shuffle:it},install:Z,effects:oe,ticker:Et,updateRoot:zt.updateRoot,plugins:se,globalTimeline:l,core:{PropTween:dr,globals:K,Tween:Qt,Timeline:zt,Animation:Bt,getCache:he,_removeLinkedListItem:Ce,reverting:function(){return o},context:function(e){return e&&a&&(a.data.push(e),e._ctx=a),a},suppressOverwrites:function(e){return s=e}}};pe("to,from,fromTo,delayedCall,set,killTweensOf",(function(e){return br[e]=Qt[e]})),Et.add(zt.updateRoot),f=br.to({},{duration:0});var wr=function(e,t){for(var r=e._pt;r&&r.p!==t&&r.op!==t&&r.fp!==t;)r=r._next;return r},Sr=function(e,t){return{name:e,rawVars:1,init:function(e,r,n){n._onInit=function(e){var n,i;if(R(r)&&(n={},pe(r,(function(e){return n[e]=1})),r=n),t){for(i in n={},r)n[i]=t(r[i]);r=n}!function(e,t){var r,n,i,s=e._targets;for(r in t)for(n=s.length;n--;)(i=e._ptLookup[n][r])&&(i=i.d)&&(i._pt&&(i=wr(i,r)),i&&i.modifier&&i.modifier(t[r],e,s[n],r))}(e,r)}}}},Mr=br.registerPlugin({name:"attr",init:function(e,t,r,n,i){var s,o,a;for(s in this.tween=r,t)a=e.getAttribute(s)||"",(o=this.add(e,"setAttribute",(a||0)+"",t[s],n,i,0,0,s)).op=s,o.b=a,this._props.push(s)},render:function(e,t){for(var r=t._pt;r;)o?r.set(r.t,r.p,r.b,r):r.r(e,r.d),r=r._next}},{name:"endArray",init:function(e,t){for(var r=t.length;r--;)this.add(e,r,e[r]||0,t[r],0,0,0,0,0,1)}},Sr("roundProps",ot),Sr("modifiers"),Sr("snap",at))||br;Qt.version=zt.version=Mr.version="3.11.5",d=1,N()&&At();Ct.Power0,Ct.Power1,Ct.Power2,Ct.Power3,Ct.Power4,Ct.Linear,Ct.Quad,Ct.Cubic,Ct.Quart,Ct.Quint,Ct.Strong,Ct.Elastic,Ct.Back,Ct.SteppedEase,Ct.Bounce,Ct.Sine,Ct.Expo,Ct.Circ;var Tr,Er,Ar,Cr,Lr,Rr,Pr,jr,Ir={},Dr=180/Math.PI,Or=Math.PI/180,Nr=Math.atan2,Ur=/([A-Z])/g,kr=/(left|right|width|margin|padding|x)/i,Fr=/[\s,\(]\S/,Br={autoAlpha:"opacity,visibility",scale:"scaleX,scaleY",alpha:"opacity"},zr=function(e,t){return t.set(t.t,t.p,Math.round(1e4*(t.s+t.c*e))/1e4+t.u,t)},Gr=function(e,t){return t.set(t.t,t.p,1===e?t.e:Math.round(1e4*(t.s+t.c*e))/1e4+t.u,t)},Vr=function(e,t){return t.set(t.t,t.p,e?Math.round(1e4*(t.s+t.c*e))/1e4+t.u:t.b,t)},Hr=function(e,t){var r=t.s+t.c*e;t.set(t.t,t.p,~~(r+(r<0?-.5:.5))+t.u,t)},Wr=function(e,t){return t.set(t.t,t.p,e?t.e:t.b,t)},Xr=function(e,t){return t.set(t.t,t.p,1!==e?t.b:t.e,t)},qr=function(e,t,r){return e.style[t]=r},Yr=function(e,t,r){return e.style.setProperty(t,r)},Zr=function(e,t,r){return e._gsap[t]=r},Jr=function(e,t,r){return e._gsap.scaleX=e._gsap.scaleY=r},Kr=function(e,t,r,n,i){var s=e._gsap;s.scaleX=s.scaleY=r,s.renderTransform(i,s)},Qr=function(e,t,r,n,i){var s=e._gsap;s[t]=r,s.renderTransform(i,s)},$r="transform",en=$r+"Origin",tn=function e(t,r){var n=this,i=this.target,s=i.style;if(t in Ir){if(this.tfm=this.tfm||{},"transform"===t)return Br.transform.split(",").forEach((function(t){return e.call(n,t,r)}));if(~(t=Br[t]||t).indexOf(",")?t.split(",").forEach((function(e){return n.tfm[e]=xn(i,e)})):this.tfm[t]=i._gsap.x?i._gsap[t]:xn(i,t),this.props.indexOf($r)>=0)return;i._gsap.svg&&(this.svgo=i.getAttribute("data-svg-origin"),this.props.push(en,r,"")),t=$r}(s||r)&&this.props.push(t,r,s[t])},rn=function(e){e.translate&&(e.removeProperty("translate"),e.removeProperty("scale"),e.removeProperty("rotate"))},nn=function(){var e,t,r=this.props,n=this.target,i=n.style,s=n._gsap;for(e=0;e<r.length;e+=3)r[e+1]?n[r[e]]=r[e+2]:r[e+2]?i[r[e]]=r[e+2]:i.removeProperty("--"===r[e].substr(0,2)?r[e]:r[e].replace(Ur,"-$1").toLowerCase());if(this.tfm){for(t in this.tfm)s[t]=this.tfm[t];s.svg&&(s.renderTransform(),n.setAttribute("data-svg-origin",this.svgo||"")),(e=Pr())&&e.isStart||i[$r]||(rn(i),s.uncache=1)}},sn=function(e,t){var r={target:e,props:[],revert:nn,save:tn};return e._gsap||Mr.core.getCache(e),t&&t.split(",").forEach((function(e){return r.save(e)})),r},on=function(e,t){var r=Er.createElementNS?Er.createElementNS((t||"http://www.w3.org/1999/xhtml").replace(/^https/,"http"),e):Er.createElement(e);return r.style?r:Er.createElement(e)},an=function e(t,r,n){var i=getComputedStyle(t);return i[r]||i.getPropertyValue(r.replace(Ur,"-$1").toLowerCase())||i.getPropertyValue(r)||!n&&e(t,cn(r)||r,1)||""},ln="O,Moz,ms,Ms,Webkit".split(","),cn=function(e,t,r){var n=(t||Lr).style,i=5;if(e in n&&!r)return e;for(e=e.charAt(0).toUpperCase()+e.substr(1);i--&&!(ln[i]+e in n););return i<0?null:(3===i?"ms":i>=0?ln[i]:"")+e},un=function(){"undefined"!=typeof window&&window.document&&(Tr=window,Er=Tr.document,Ar=Er.documentElement,Lr=on("div")||{style:{}},on("div"),$r=cn($r),en=$r+"Origin",Lr.style.cssText="border-width:0;line-height:0;position:absolute;padding:0",jr=!!cn("perspective"),Pr=Mr.core.reverting,Cr=1)},hn=function e(t){var r,n=on("svg",this.ownerSVGElement&&this.ownerSVGElement.getAttribute("xmlns")||"http://www.w3.org/2000/svg"),i=this.parentNode,s=this.nextSibling,o=this.style.cssText;if(Ar.appendChild(n),n.appendChild(this),this.style.display="block",t)try{r=this.getBBox(),this._gsapBBox=this.getBBox,this.getBBox=e}catch(e){}else this._gsapBBox&&(r=this._gsapBBox());return i&&(s?i.insertBefore(this,s):i.appendChild(this)),Ar.removeChild(n),this.style.cssText=o,r},dn=function(e,t){for(var r=t.length;r--;)if(e.hasAttribute(t[r]))return e.getAttribute(t[r])},pn=function(e){var t;try{t=e.getBBox()}catch(r){t=hn.call(e,!0)}return t&&(t.width||t.height)||e.getBBox===hn||(t=hn.call(e,!0)),!t||t.width||t.x||t.y?t:{x:+dn(e,["x","cx","x1"])||0,y:+dn(e,["y","cy","y1"])||0,width:0,height:0}},fn=function(e){return!(!e.getCTM||e.parentNode&&!e.ownerSVGElement||!pn(e))},mn=function(e,t){if(t){var r=e.style;t in Ir&&t!==en&&(t=$r),r.removeProperty?("ms"!==t.substr(0,2)&&"webkit"!==t.substr(0,6)||(t="-"+t),r.removeProperty(t.replace(Ur,"-$1").toLowerCase())):r.removeAttribute(t)}},gn=function(e,t,r,n,i,s){var o=new dr(e._pt,t,r,0,1,s?Xr:Wr);return e._pt=o,o.b=n,o.e=i,e._props.push(r),o},yn={deg:1,rad:1,turn:1},vn={grid:1,flex:1},_n=function e(t,r,n,i){var s,o,a,l,c=parseFloat(n)||0,u=(n+"").trim().substr((c+"").length)||"px",h=Lr.style,d=kr.test(r),p="svg"===t.tagName.toLowerCase(),f=(p?"client":"offset")+(d?"Width":"Height"),m=100,g="px"===i,y="%"===i;return i===u||!c||yn[i]||yn[u]?c:("px"!==u&&!g&&(c=e(t,r,n,"px")),l=t.getCTM&&fn(t),!y&&"%"!==u||!Ir[r]&&!~r.indexOf("adius")?(h[d?"width":"height"]=m+(g?u:i),o=~r.indexOf("adius")||"em"===i&&t.appendChild&&!p?t:t.parentNode,l&&(o=(t.ownerSVGElement||{}).parentNode),o&&o!==Er&&o.appendChild||(o=Er.body),(a=o._gsap)&&y&&a.width&&d&&a.time===Et.time&&!a.uncache?fe(c/a.width*m):((y||"%"===u)&&!vn[an(o,"display")]&&(h.position=an(t,"position")),o===t&&(h.position="static"),o.appendChild(Lr),s=Lr[f],o.removeChild(Lr),h.position="absolute",d&&y&&((a=he(o)).time=Et.time,a.width=o[f]),fe(g?s*c/m:s&&c?m/s*c:0))):(s=l?t.getBBox()[d?"width":"height"]:t[f],fe(y?c/s*m:c/100*s)))},xn=function(e,t,r,n){var i;return Cr||un(),t in Br&&"transform"!==t&&~(t=Br[t]).indexOf(",")&&(t=t.split(",")[0]),Ir[t]&&"transform"!==t?(i=Pn(e,n),i="transformOrigin"!==t?i[t]:i.svg?i.origin:jn(an(e,en))+" "+i.zOrigin+"px"):(!(i=e.style[t])||"auto"===i||n||~(i+"").indexOf("calc("))&&(i=Mn[t]&&Mn[t](e,t,r)||an(e,t)||de(e,t)||("opacity"===t?1:0)),r&&!~(i+"").trim().indexOf(" ")?_n(e,t,i,r)+r:i},bn=function(e,t,r,n){if(!r||"none"===r){var i=cn(t,e,1),s=i&&an(e,i,1);s&&s!==r?(t=i,r=s):"borderColor"===t&&(r=an(e,"borderTopColor"))}var o,a,l,c,u,h,d,p,f,m,g,y=new dr(this._pt,e.style,t,0,1,or),v=0,_=0;if(y.b=r,y.e=n,r+="","auto"===(n+="")&&(e.style[t]=n,n=an(e,t)||n,e.style[t]=r),Tt(o=[r,n]),n=o[1],l=(r=o[0]).match(G)||[],(n.match(G)||[]).length){for(;a=G.exec(n);)d=a[0],f=n.substring(v,a.index),u?u=(u+1)%5:"rgba("!==f.substr(-5)&&"hsla("!==f.substr(-5)||(u=1),d!==(h=l[_++]||"")&&(c=parseFloat(h)||0,g=h.substr((c+"").length),"="===d.charAt(1)&&(d=ge(c,d)+g),p=parseFloat(d),m=d.substr((p+"").length),v=G.lastIndex-m.length,m||(m=m||x.units[t]||g,v===n.length&&(n+=m,y.e+=m)),g!==m&&(c=_n(e,t,h,m)||0),y._pt={_next:y._pt,p:f||1===_?f:",",s:c,c:p-c,m:u&&u<4||"zIndex"===t?Math.round:0});y.c=v<n.length?n.substring(v,n.length):""}else y.r="display"===t&&"none"===n?Xr:Wr;return H.test(n)&&(y.e=0),this._pt=y,y},wn={top:"0%",bottom:"100%",left:"0%",right:"100%",center:"50%"},Sn=function(e,t){if(t.tween&&t.tween._time===t.tween._dur){var r,n,i,s=t.t,o=s.style,a=t.u,l=s._gsap;if("all"===a||!0===a)o.cssText="",n=1;else for(i=(a=a.split(",")).length;--i>-1;)r=a[i],Ir[r]&&(n=1,r="transformOrigin"===r?en:$r),mn(s,r);n&&(mn(s,$r),l&&(l.svg&&s.removeAttribute("transform"),Pn(s,1),l.uncache=1,rn(o)))}},Mn={clearProps:function(e,t,r,n,i){if("isFromStart"!==i.data){var s=e._pt=new dr(e._pt,t,r,0,0,Sn);return s.u=n,s.pr=-10,s.tween=i,e._props.push(r),1}}},Tn=[1,0,0,1,0,0],En={},An=function(e){return"matrix(1, 0, 0, 1, 0, 0)"===e||"none"===e||!e},Cn=function(e){var t=an(e,$r);return An(t)?Tn:t.substr(7).match(z).map(fe)},Ln=function(e,t){var r,n,i,s,o=e._gsap||he(e),a=e.style,l=Cn(e);return o.svg&&e.getAttribute("transform")?"1,0,0,1,0,0"===(l=[(i=e.transform.baseVal.consolidate().matrix).a,i.b,i.c,i.d,i.e,i.f]).join(",")?Tn:l:(l!==Tn||e.offsetParent||e===Ar||o.svg||(i=a.display,a.display="block",(r=e.parentNode)&&e.offsetParent||(s=1,n=e.nextElementSibling,Ar.appendChild(e)),l=Cn(e),i?a.display=i:mn(e,"display"),s&&(n?r.insertBefore(e,n):r?r.appendChild(e):Ar.removeChild(e))),t&&l.length>6?[l[0],l[1],l[4],l[5],l[12],l[13]]:l)},Rn=function(e,t,r,n,i,s){var o,a,l,c=e._gsap,u=i||Ln(e,!0),h=c.xOrigin||0,d=c.yOrigin||0,p=c.xOffset||0,f=c.yOffset||0,m=u[0],g=u[1],y=u[2],v=u[3],_=u[4],x=u[5],b=t.split(" "),w=parseFloat(b[0])||0,S=parseFloat(b[1])||0;r?u!==Tn&&(a=m*v-g*y)&&(l=w*(-g/a)+S*(m/a)-(m*x-g*_)/a,w=w*(v/a)+S*(-y/a)+(y*x-v*_)/a,S=l):(w=(o=pn(e)).x+(~b[0].indexOf("%")?w/100*o.width:w),S=o.y+(~(b[1]||b[0]).indexOf("%")?S/100*o.height:S)),n||!1!==n&&c.smooth?(_=w-h,x=S-d,c.xOffset=p+(_*m+x*y)-_,c.yOffset=f+(_*g+x*v)-x):c.xOffset=c.yOffset=0,c.xOrigin=w,c.yOrigin=S,c.smooth=!!n,c.origin=t,c.originIsAbsolute=!!r,e.style[en]="0px 0px",s&&(gn(s,c,"xOrigin",h,w),gn(s,c,"yOrigin",d,S),gn(s,c,"xOffset",p,c.xOffset),gn(s,c,"yOffset",f,c.yOffset)),e.setAttribute("data-svg-origin",w+" "+S)},Pn=function(e,t){var r=e._gsap||new Ft(e);if("x"in r&&!t&&!r.uncache)return r;var n,i,s,o,a,l,c,u,h,d,p,f,m,g,y,v,_,b,w,S,M,T,E,A,C,L,R,P,j,I,D,O,N=e.style,U=r.scaleX<0,k="px",F="deg",B=getComputedStyle(e),z=an(e,en)||"0";return n=i=s=l=c=u=h=d=p=0,o=a=1,r.svg=!(!e.getCTM||!fn(e)),B.translate&&("none"===B.translate&&"none"===B.scale&&"none"===B.rotate||(N[$r]=("none"!==B.translate?"translate3d("+(B.translate+" 0 0").split(" ").slice(0,3).join(", ")+") ":"")+("none"!==B.rotate?"rotate("+B.rotate+") ":"")+("none"!==B.scale?"scale("+B.scale.split(" ").join(",")+") ":"")+("none"!==B[$r]?B[$r]:"")),N.scale=N.rotate=N.translate="none"),g=Ln(e,r.svg),r.svg&&(r.uncache?(C=e.getBBox(),z=r.xOrigin-C.x+"px "+(r.yOrigin-C.y)+"px",A=""):A=!t&&e.getAttribute("data-svg-origin"),Rn(e,A||z,!!A||r.originIsAbsolute,!1!==r.smooth,g)),f=r.xOrigin||0,m=r.yOrigin||0,g!==Tn&&(b=g[0],w=g[1],S=g[2],M=g[3],n=T=g[4],i=E=g[5],6===g.length?(o=Math.sqrt(b*b+w*w),a=Math.sqrt(M*M+S*S),l=b||w?Nr(w,b)*Dr:0,(h=S||M?Nr(S,M)*Dr+l:0)&&(a*=Math.abs(Math.cos(h*Or))),r.svg&&(n-=f-(f*b+m*S),i-=m-(f*w+m*M))):(O=g[6],I=g[7],R=g[8],P=g[9],j=g[10],D=g[11],n=g[12],i=g[13],s=g[14],c=(y=Nr(O,j))*Dr,y&&(A=T*(v=Math.cos(-y))+R*(_=Math.sin(-y)),C=E*v+P*_,L=O*v+j*_,R=T*-_+R*v,P=E*-_+P*v,j=O*-_+j*v,D=I*-_+D*v,T=A,E=C,O=L),u=(y=Nr(-S,j))*Dr,y&&(v=Math.cos(-y),D=M*(_=Math.sin(-y))+D*v,b=A=b*v-R*_,w=C=w*v-P*_,S=L=S*v-j*_),l=(y=Nr(w,b))*Dr,y&&(A=b*(v=Math.cos(y))+w*(_=Math.sin(y)),C=T*v+E*_,w=w*v-b*_,E=E*v-T*_,b=A,T=C),c&&Math.abs(c)+Math.abs(l)>359.9&&(c=l=0,u=180-u),o=fe(Math.sqrt(b*b+w*w+S*S)),a=fe(Math.sqrt(E*E+O*O)),y=Nr(T,E),h=Math.abs(y)>2e-4?y*Dr:0,p=D?1/(D<0?-D:D):0),r.svg&&(A=e.getAttribute("transform"),r.forceCSS=e.setAttribute("transform","")||!An(an(e,$r)),A&&e.setAttribute("transform",A))),Math.abs(h)>90&&Math.abs(h)<270&&(U?(o*=-1,h+=l<=0?180:-180,l+=l<=0?180:-180):(a*=-1,h+=h<=0?180:-180)),t=t||r.uncache,r.x=n-((r.xPercent=n&&(!t&&r.xPercent||(Math.round(e.offsetWidth/2)===Math.round(-n)?-50:0)))?e.offsetWidth*r.xPercent/100:0)+k,r.y=i-((r.yPercent=i&&(!t&&r.yPercent||(Math.round(e.offsetHeight/2)===Math.round(-i)?-50:0)))?e.offsetHeight*r.yPercent/100:0)+k,r.z=s+k,r.scaleX=fe(o),r.scaleY=fe(a),r.rotation=fe(l)+F,r.rotationX=fe(c)+F,r.rotationY=fe(u)+F,r.skewX=h+F,r.skewY=d+F,r.transformPerspective=p+k,(r.zOrigin=parseFloat(z.split(" ")[2])||0)&&(N[en]=jn(z)),r.xOffset=r.yOffset=0,r.force3D=x.force3D,r.renderTransform=r.svg?Fn:jr?kn:Dn,r.uncache=0,r},jn=function(e){return(e=e.split(" "))[0]+" "+e[1]},In=function(e,t,r){var n=Qe(t);return fe(parseFloat(t)+parseFloat(_n(e,"x",r+"px",n)))+n},Dn=function(e,t){t.z="0px",t.rotationY=t.rotationX="0deg",t.force3D=0,kn(e,t)},On="0deg",Nn="0px",Un=") ",kn=function(e,t){var r=t||this,n=r.xPercent,i=r.yPercent,s=r.x,o=r.y,a=r.z,l=r.rotation,c=r.rotationY,u=r.rotationX,h=r.skewX,d=r.skewY,p=r.scaleX,f=r.scaleY,m=r.transformPerspective,g=r.force3D,y=r.target,v=r.zOrigin,_="",x="auto"===g&&e&&1!==e||!0===g;if(v&&(u!==On||c!==On)){var b,w=parseFloat(c)*Or,S=Math.sin(w),M=Math.cos(w);w=parseFloat(u)*Or,b=Math.cos(w),s=In(y,s,S*b*-v),o=In(y,o,-Math.sin(w)*-v),a=In(y,a,M*b*-v+v)}m!==Nn&&(_+="perspective("+m+Un),(n||i)&&(_+="translate("+n+"%, "+i+"%) "),(x||s!==Nn||o!==Nn||a!==Nn)&&(_+=a!==Nn||x?"translate3d("+s+", "+o+", "+a+") ":"translate("+s+", "+o+Un),l!==On&&(_+="rotate("+l+Un),c!==On&&(_+="rotateY("+c+Un),u!==On&&(_+="rotateX("+u+Un),h===On&&d===On||(_+="skew("+h+", "+d+Un),1===p&&1===f||(_+="scale("+p+", "+f+Un),y.style[$r]=_||"translate(0, 0)"},Fn=function(e,t){var r,n,i,s,o,a=t||this,l=a.xPercent,c=a.yPercent,u=a.x,h=a.y,d=a.rotation,p=a.skewX,f=a.skewY,m=a.scaleX,g=a.scaleY,y=a.target,v=a.xOrigin,_=a.yOrigin,x=a.xOffset,b=a.yOffset,w=a.forceCSS,S=parseFloat(u),M=parseFloat(h);d=parseFloat(d),p=parseFloat(p),(f=parseFloat(f))&&(p+=f=parseFloat(f),d+=f),d||p?(d*=Or,p*=Or,r=Math.cos(d)*m,n=Math.sin(d)*m,i=Math.sin(d-p)*-g,s=Math.cos(d-p)*g,p&&(f*=Or,o=Math.tan(p-f),i*=o=Math.sqrt(1+o*o),s*=o,f&&(o=Math.tan(f),r*=o=Math.sqrt(1+o*o),n*=o)),r=fe(r),n=fe(n),i=fe(i),s=fe(s)):(r=m,s=g,n=i=0),(S&&!~(u+"").indexOf("px")||M&&!~(h+"").indexOf("px"))&&(S=_n(y,"x",u,"px"),M=_n(y,"y",h,"px")),(v||_||x||b)&&(S=fe(S+v-(v*r+_*i)+x),M=fe(M+_-(v*n+_*s)+b)),(l||c)&&(o=y.getBBox(),S=fe(S+l/100*o.width),M=fe(M+c/100*o.height)),o="matrix("+r+","+n+","+i+","+s+","+S+","+M+")",y.setAttribute("transform",o),w&&(y.style[$r]=o)},Bn=function(e,t,r,n,i){var s,o,a=360,l=R(i),c=parseFloat(i)*(l&&~i.indexOf("rad")?Dr:1)-n,u=n+c+"deg";return l&&("short"===(s=i.split("_")[1])&&(c%=a)!==c%180&&(c+=c<0?a:-360),"cw"===s&&c<0?c=(c+36e9)%a-~~(c/a)*a:"ccw"===s&&c>0&&(c=(c-36e9)%a-~~(c/a)*a)),e._pt=o=new dr(e._pt,t,r,n,c,Gr),o.e=u,o.u="deg",e._props.push(r),o},zn=function(e,t){for(var r in t)e[r]=t[r];return e},Gn=function(e,t,r){var n,i,s,o,a,l,c,u=zn({},r._gsap),h=r.style;for(i in u.svg?(s=r.getAttribute("transform"),r.setAttribute("transform",""),h[$r]=t,n=Pn(r,1),mn(r,$r),r.setAttribute("transform",s)):(s=getComputedStyle(r)[$r],h[$r]=t,n=Pn(r,1),h[$r]=s),Ir)(s=u[i])!==(o=n[i])&&"perspective,force3D,transformOrigin,svgOrigin".indexOf(i)<0&&(a=Qe(s)!==(c=Qe(o))?_n(r,i,s,c):parseFloat(s),l=parseFloat(o),e._pt=new dr(e._pt,n,i,a,l-a,zr),e._pt.u=c||0,e._props.push(i));zn(n,u)};pe("padding,margin,Width,Radius",(function(e,t){var r="Top",n="Right",i="Bottom",s="Left",o=(t<3?[r,n,i,s]:[r+s,r+n,i+n,i+s]).map((function(r){return t<2?e+r:"border"+r+e}));Mn[t>1?"border"+e:e]=function(e,t,r,n,i){var s,a;if(arguments.length<4)return s=o.map((function(t){return xn(e,t,r)})),5===(a=s.join(" ")).split(s[0]).length?s[0]:a;s=(n+"").split(" "),a={},o.forEach((function(e,t){return a[e]=s[t]=s[t]||s[(t-1)/2|0]})),e.init(t,a,i)}}));var Vn,Hn,Wn,Xn={name:"css",register:un,targetTest:function(e){return e.style&&e.nodeType},init:function(e,t,r,n,i){var s,o,a,l,c,u,h,d,p,f,m,g,y,v,_,b,w,S,M,T,E=this._props,A=e.style,C=r.vars.startAt;for(h in Cr||un(),this.styles=this.styles||sn(e),b=this.styles.props,this.tween=r,t)if("autoRound"!==h&&(o=t[h],!se[h]||!Xt(h,t,r,n,e,i)))if(c=typeof o,u=Mn[h],"function"===c&&(c=typeof(o=o.call(r,n,e,i))),"string"===c&&~o.indexOf("random(")&&(o=ut(o)),u)u(this,e,h,o,r)&&(_=1);else if("--"===h.substr(0,2))s=(getComputedStyle(e).getPropertyValue(h)+"").trim(),o+="",St.lastIndex=0,St.test(s)||(d=Qe(s),p=Qe(o)),p?d!==p&&(s=_n(e,h,s,p)+p):d&&(o+=d),this.add(A,"setProperty",s,o,n,i,0,0,h),E.push(h),b.push(h,0,A[h]);else if("undefined"!==c){if(C&&h in C?(s="function"==typeof C[h]?C[h].call(r,n,e,i):C[h],R(s)&&~s.indexOf("random(")&&(s=ut(s)),Qe(s+"")||(s+=x.units[h]||Qe(xn(e,h))||""),"="===(s+"").charAt(1)&&(s=xn(e,h))):s=xn(e,h),l=parseFloat(s),(f="string"===c&&"="===o.charAt(1)&&o.substr(0,2))&&(o=o.substr(2)),a=parseFloat(o),h in Br&&("autoAlpha"===h&&(1===l&&"hidden"===xn(e,"visibility")&&a&&(l=0),b.push("visibility",0,A.visibility),gn(this,A,"visibility",l?"inherit":"hidden",a?"inherit":"hidden",!a)),"scale"!==h&&"transform"!==h&&~(h=Br[h]).indexOf(",")&&(h=h.split(",")[0])),m=h in Ir)if(this.styles.save(h),g||((y=e._gsap).renderTransform&&!t.parseTransform||Pn(e,t.parseTransform),v=!1!==t.smoothOrigin&&y.smooth,(g=this._pt=new dr(this._pt,A,$r,0,1,y.renderTransform,y,0,-1)).dep=1),"scale"===h)this._pt=new dr(this._pt,y,"scaleY",y.scaleY,(f?ge(y.scaleY,f+a):a)-y.scaleY||0,zr),this._pt.u=0,E.push("scaleY",h),h+="X";else{if("transformOrigin"===h){b.push(en,0,A[en]),S=void 0,M=void 0,T=void 0,S=(w=o).split(" "),M=S[0],T=S[1]||"50%","top"!==M&&"bottom"!==M&&"left"!==T&&"right"!==T||(w=M,M=T,T=w),S[0]=wn[M]||M,S[1]=wn[T]||T,o=S.join(" "),y.svg?Rn(e,o,0,v,0,this):((p=parseFloat(o.split(" ")[2])||0)!==y.zOrigin&&gn(this,y,"zOrigin",y.zOrigin,p),gn(this,A,h,jn(s),jn(o)));continue}if("svgOrigin"===h){Rn(e,o,1,v,0,this);continue}if(h in En){Bn(this,y,h,l,f?ge(l,f+o):o);continue}if("smoothOrigin"===h){gn(this,y,"smooth",y.smooth,o);continue}if("force3D"===h){y[h]=o;continue}if("transform"===h){Gn(this,o,e);continue}}else h in A||(h=cn(h)||h);if(m||(a||0===a)&&(l||0===l)&&!Fr.test(o)&&h in A)a||(a=0),(d=(s+"").substr((l+"").length))!==(p=Qe(o)||(h in x.units?x.units[h]:d))&&(l=_n(e,h,s,p)),this._pt=new dr(this._pt,m?y:A,h,l,(f?ge(l,f+a):a)-l,m||"px"!==p&&"zIndex"!==h||!1===t.autoRound?zr:Hr),this._pt.u=p||0,d!==p&&"%"!==p&&(this._pt.b=s,this._pt.r=Vr);else if(h in A)bn.call(this,e,h,s,f?f+o:o);else if(h in e)this.add(e,h,s||e[h],f?f+o:o,n,i);else if("parseTransform"!==h)continue;m||(h in A?b.push(h,0,A[h]):b.push(h,1,s||e[h])),E.push(h)}_&&hr(this)},render:function(e,t){if(t.tween._time||!Pr())for(var r=t._pt;r;)r.r(e,r.d),r=r._next;else t.styles.revert()},get:xn,aliases:Br,getSetter:function(e,t,r){var n=Br[t];return n&&n.indexOf(",")<0&&(t=n),t in Ir&&t!==en&&(e._gsap.x||xn(e,"x"))?r&&Rr===r?"scale"===t?Jr:Zr:(Rr=r||{})&&("scale"===t?Kr:Qr):e.style&&!I(e.style[t])?qr:~t.indexOf("-")?Yr:nr(e,t)},core:{_removeProperty:mn,_getMatrix:Ln}};Mr.utils.checkPrefix=cn,Mr.core.getStyleSaver=sn,Wn=pe((Vn="x,y,z,scale,scaleX,scaleY,xPercent,yPercent")+","+(Hn="rotation,rotationX,rotationY,skewX,skewY")+",transform,transformOrigin,svgOrigin,force3D,smoothOrigin,transformPerspective",(function(e){Ir[e]=1})),pe(Hn,(function(e){x.units[e]="deg",En[e]=1})),Br[Wn[13]]=Vn+","+Hn,pe("0:translateX,1:translateY,2:translateZ,8:rotate,8:rotationZ,8:rotateZ,9:rotateX,10:rotateY",(function(e){var t=e.split(":");Br[t[1]]=Wn[t[0]]})),pe("x,y,z,top,right,bottom,left,width,height,fontSize,padding,margin,perspective",(function(e){x.units[e]="px"})),Mr.registerPlugin(Xn);var qn=Mr.registerPlugin(Xn)||Mr;qn.core.Tween},1891:(e,t,r)=>{!function(t){e.exports=t()}((function(){return function e(t,r,n){function i(o,a){if(!r[o]){if(!t[o]){var l=void 0;if(!a&&l)return require(o,!0);if(s)return s(o,!0);throw(a=new Error("Cannot find module '"+o+"'")).code="MODULE_NOT_FOUND",a}l=r[o]={exports:{}},t[o][0].call(l.exports,(function(e){return i(t[o][1][e]||e)}),l,l.exports,e,t,r,n)}return r[o].exports}for(var s=void 0,o=0;o<n.length;o++)i(n[o]);return i}({1:[function(e,t,r){"use strict";r.byteLength=function(e){return 3*((e=c(e))[0]+(e=e[1]))/4-e},r.toByteArray=function(e){var t,r,n=(o=c(e))[0],o=o[1],a=new s(function(e,t){return 3*(e+t)/4-t}(n,o)),l=0,u=0<o?n-4:n;for(r=0;r<u;r+=4)t=i[e.charCodeAt(r)]<<18|i[e.charCodeAt(r+1)]<<12|i[e.charCodeAt(r+2)]<<6|i[e.charCodeAt(r+3)],a[l++]=t>>16&255,a[l++]=t>>8&255,a[l++]=255&t;return 2===o&&(t=i[e.charCodeAt(r)]<<2|i[e.charCodeAt(r+1)]>>4,a[l++]=255&t),1===o&&(t=i[e.charCodeAt(r)]<<10|i[e.charCodeAt(r+1)]<<4|i[e.charCodeAt(r+2)]>>2,a[l++]=t>>8&255,a[l++]=255&t),a},r.fromByteArray=function(e){for(var t,r=e.length,i=r%3,s=[],o=0,a=r-i;o<a;o+=16383)s.push(function(e,t,r){for(var i,s=[],o=t;o<r;o+=3)i=(e[o]<<16&16711680)+(e[o+1]<<8&65280)+(255&e[o+2]),s.push(function(e){return n[e>>18&63]+n[e>>12&63]+n[e>>6&63]+n[63&e]}(i));return s.join("")}(e,o,a<o+16383?a:o+16383));return 1==i?(t=e[r-1],s.push(n[t>>2]+n[t<<4&63]+"==")):2==i&&(t=(e[r-2]<<8)+e[r-1],s.push(n[t>>10]+n[t>>4&63]+n[t<<2&63]+"=")),s.join("")};for(var n=[],i=[],s="undefined"!=typeof Uint8Array?Uint8Array:Array,o="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",a=0,l=o.length;a<l;++a)n[a]=o[a],i[o.charCodeAt(a)]=a;function c(e){var t=e.length;if(0<t%4)throw new Error("Invalid string. Length must be a multiple of 4");return t=(e=-1===(e=e.indexOf("="))?t:e)===t?0:4-e%4,[e,t]}i["-".charCodeAt(0)]=62,i["_".charCodeAt(0)]=63},{}],2:[function(e,t,r){},{}],3:[function(e,t,r){arguments[4][2][0].apply(r,arguments)},{dup:2}],4:[function(e,t,r){(function(t){"use strict";var n=e("base64-js"),i=e("ieee754"),s="function"==typeof Symbol&&"function"==typeof Symbol.for?Symbol.for("nodejs.util.inspect.custom"):null,o=(r.Buffer=t,r.SlowBuffer=function(e){return+e!=e&&(e=0),t.alloc(+e)},r.INSPECT_MAX_BYTES=50,2147483647);function a(e){if(o<e)throw new RangeError('The value "'+e+'" is invalid for option "size"');return e=new Uint8Array(e),Object.setPrototypeOf(e,t.prototype),e}function t(e,t,r){if("number"!=typeof e)return l(e,t,r);if("string"==typeof t)throw new TypeError('The "string" argument must be of type string. Received type number');return u(e)}function l(e,r,n){if("string"==typeof e){var i=e,s=r;if(t.isEncoding(s="string"==typeof s&&""!==s?s:"utf8"))return(i=(l=a(o=0|p(i,s))).write(i,s))!==o?l.slice(0,i):l;throw new TypeError("Unknown encoding: "+s)}if(ArrayBuffer.isView(e))return h(e);if(null!=e){if(P(e,ArrayBuffer)||e&&P(e.buffer,ArrayBuffer)){var o=e,l=n;if((i=r)<0||o.byteLength<i)throw new RangeError('"offset" is outside of buffer bounds');if(o.byteLength<i+(l||0))throw new RangeError('"length" is outside of buffer bounds');return o=void 0===i&&void 0===l?new Uint8Array(o):void 0===l?new Uint8Array(o,i):new Uint8Array(o,i,l),Object.setPrototypeOf(o,t.prototype),o}if("number"==typeof e)throw new TypeError('The "value" argument must not be of type number. Received type number');if(null!=(s=e.valueOf&&e.valueOf())&&s!==e)return t.from(s,r,n);var c=function(e){var r,n;return t.isBuffer(e)?(0!==(n=a(r=0|d(e.length))).length&&e.copy(n,0,0,r),n):void 0!==e.length?"number"!=typeof e.length||j(e.length)?a(0):h(e):"Buffer"===e.type&&Array.isArray(e.data)?h(e.data):void 0}(e);if(c)return c;if("undefined"!=typeof Symbol&&null!=Symbol.toPrimitive&&"function"==typeof e[Symbol.toPrimitive])return t.from(e[Symbol.toPrimitive]("string"),r,n)}throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof e)}function c(e){if("number"!=typeof e)throw new TypeError('"size" argument must be of type number');if(e<0)throw new RangeError('The value "'+e+'" is invalid for option "size"')}function u(e){return c(e),a(e<0?0:0|d(e))}function h(e){for(var t=e.length<0?0:0|d(e.length),r=a(t),n=0;n<t;n+=1)r[n]=255&e[n];return r}function d(e){if(o<=e)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+o.toString(16)+" bytes");return 0|e}function p(e,r){if(t.isBuffer(e))return e.length;if(ArrayBuffer.isView(e)||P(e,ArrayBuffer))return e.byteLength;if("string"!=typeof e)throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof e);var n=e.length,i=2<arguments.length&&!0===arguments[2];if(!i&&0===n)return 0;for(var s=!1;;)switch(r){case"ascii":case"latin1":case"binary":return n;case"utf8":case"utf-8":return C(e).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*n;case"hex":return n>>>1;case"base64":return L(e).length;default:if(s)return i?-1:C(e).length;r=(""+r).toLowerCase(),s=!0}}function f(e,t,r){var i,s=!1;if((t=void 0===t||t<0?0:t)>this.length)return"";if((r=void 0===r||r>this.length?this.length:r)<=0)return"";if((r>>>=0)<=(t>>>=0))return"";for(e=e||"utf8";;)switch(e){case"hex":var o=t,a=r,l=this.length;(!a||a<0||l<a)&&(a=l);for(var c="",u=o=!o||o<0?0:o;u<a;++u)c+=I[this[u]];return c;case"utf8":case"utf-8":return x(this,t,r);case"ascii":l=t;var h=r,d="";h=Math.min(this.length,h);for(var p=l;p<h;++p)d+=String.fromCharCode(127&this[p]);return d;case"latin1":case"binary":o=t;var f=r,m="";f=Math.min(this.length,f);for(var g=o;g<f;++g)m+=String.fromCharCode(this[g]);return m;case"base64":return y=this,i=r,0===(v=t)&&i===y.length?n.fromByteArray(y):n.fromByteArray(y.slice(v,i));case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":for(var y=t,v=r,_=this.slice(y,v),b="",w=0;w<_.length;w+=2)b+=String.fromCharCode(_[w]+256*_[w+1]);return b;default:if(s)throw new TypeError("Unknown encoding: "+e);e=(e+"").toLowerCase(),s=!0}}function m(e,t,r){var n=e[t];e[t]=e[r],e[r]=n}function g(e,r,n,i,s){if(0===e.length)return-1;if("string"==typeof n?(i=n,n=0):2147483647<n?n=2147483647:n<-2147483648&&(n=-2147483648),(n=(n=j(n=+n)?s?0:e.length-1:n)<0?e.length+n:n)>=e.length){if(s)return-1;n=e.length-1}else if(n<0){if(!s)return-1;n=0}if("string"==typeof r&&(r=t.from(r,i)),t.isBuffer(r))return 0===r.length?-1:y(e,r,n,i,s);if("number"==typeof r)return r&=255,"function"==typeof Uint8Array.prototype.indexOf?(s?Uint8Array.prototype.indexOf:Uint8Array.prototype.lastIndexOf).call(e,r,n):y(e,[r],n,i,s);throw new TypeError("val must be string, number or Buffer")}function y(e,t,r,n,i){var s=1,o=e.length,a=t.length;if(void 0!==n&&("ucs2"===(n=String(n).toLowerCase())||"ucs-2"===n||"utf16le"===n||"utf-16le"===n)){if(e.length<2||t.length<2)return-1;o/=s=2,a/=2,r/=2}function l(e,t){return 1===s?e[t]:e.readUInt16BE(t*s)}if(i)for(var c=-1,u=r;u<o;u++)if(l(e,u)===l(t,-1===c?0:u-c)){if(u-(c=-1===c?u:c)+1===a)return c*s}else-1!==c&&(u-=u-c),c=-1;else for(u=r=o<r+a?o-a:r;0<=u;u--){for(var h=!0,d=0;d<a;d++)if(l(e,u+d)!==l(t,d)){h=!1;break}if(h)return u}return-1}function v(e,t,r,n){return R(function(e){for(var t=[],r=0;r<e.length;++r)t.push(255&e.charCodeAt(r));return t}(t),e,r,n)}function _(e,t,r,n){return R(function(e,t){for(var r,n,i=[],s=0;s<e.length&&!((t-=2)<0);++s)r=(n=e.charCodeAt(s))>>8,n%=256,i.push(n),i.push(r);return i}(t,e.length-r),e,r,n)}function x(e,t,r){r=Math.min(e.length,r);for(var n=[],i=t;i<r;){var s,o,a,l,c=e[i],u=null,h=239<c?4:223<c?3:191<c?2:1;if(i+h<=r)switch(h){case 1:c<128&&(u=c);break;case 2:128==(192&(s=e[i+1]))&&127<(l=(31&c)<<6|63&s)&&(u=l);break;case 3:s=e[i+1],o=e[i+2],128==(192&s)&&128==(192&o)&&2047<(l=(15&c)<<12|(63&s)<<6|63&o)&&(l<55296||57343<l)&&(u=l);break;case 4:s=e[i+1],o=e[i+2],a=e[i+3],128==(192&s)&&128==(192&o)&&128==(192&a)&&65535<(l=(15&c)<<18|(63&s)<<12|(63&o)<<6|63&a)&&l<1114112&&(u=l)}null===u?(u=65533,h=1):65535<u&&(u-=65536,n.push(u>>>10&1023|55296),u=56320|1023&u),n.push(u),i+=h}var d=n,p=d.length;if(p<=b)return String.fromCharCode.apply(String,d);for(var f="",m=0;m<p;)f+=String.fromCharCode.apply(String,d.slice(m,m+=b));return f}r.kMaxLength=o,(t.TYPED_ARRAY_SUPPORT=function(){try{var e=new Uint8Array(1),t={foo:function(){return 42}};return Object.setPrototypeOf(t,Uint8Array.prototype),Object.setPrototypeOf(e,t),42===e.foo()}catch(e){return!1}}())||"undefined"==typeof console||console.error,Object.defineProperty(t.prototype,"parent",{enumerable:!0,get:function(){if(t.isBuffer(this))return this.buffer}}),Object.defineProperty(t.prototype,"offset",{enumerable:!0,get:function(){if(t.isBuffer(this))return this.byteOffset}}),"undefined"!=typeof Symbol&&null!=Symbol.species&&t[Symbol.species]===t&&Object.defineProperty(t,Symbol.species,{value:null,configurable:!0,enumerable:!1,writable:!1}),t.poolSize=8192,t.from=l,Object.setPrototypeOf(t.prototype,Uint8Array.prototype),Object.setPrototypeOf(t,Uint8Array),t.alloc=function(e,t,r){return c(e),e<=0||void 0===t?a(e):"string"==typeof r?a(e).fill(t,r):a(e).fill(t)},t.allocUnsafe=u,t.allocUnsafeSlow=u,t.isBuffer=function(e){return null!=e&&!0===e._isBuffer&&e!==t.prototype},t.compare=function(e,r){if(P(e,Uint8Array)&&(e=t.from(e,e.offset,e.byteLength)),P(r,Uint8Array)&&(r=t.from(r,r.offset,r.byteLength)),!t.isBuffer(e)||!t.isBuffer(r))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(e===r)return 0;for(var n=e.length,i=r.length,s=0,o=Math.min(n,i);s<o;++s)if(e[s]!==r[s]){n=e[s],i=r[s];break}return n<i?-1:i<n?1:0},t.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},t.concat=function(e,r){if(!Array.isArray(e))throw new TypeError('"list" argument must be an Array of Buffers');if(0===e.length)return t.alloc(0);if(void 0===r)for(s=r=0;s<e.length;++s)r+=e[s].length;for(var n=t.allocUnsafe(r),i=0,s=0;s<e.length;++s){var o=e[s];if(P(o,Uint8Array)&&(o=t.from(o)),!t.isBuffer(o))throw new TypeError('"list" argument must be an Array of Buffers');o.copy(n,i),i+=o.length}return n},t.byteLength=p,t.prototype._isBuffer=!0,t.prototype.swap16=function(){var e=this.length;if(e%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var t=0;t<e;t+=2)m(this,t,t+1);return this},t.prototype.swap32=function(){var e=this.length;if(e%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var t=0;t<e;t+=4)m(this,t,t+3),m(this,t+1,t+2);return this},t.prototype.swap64=function(){var e=this.length;if(e%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var t=0;t<e;t+=8)m(this,t,t+7),m(this,t+1,t+6),m(this,t+2,t+5),m(this,t+3,t+4);return this},t.prototype.toLocaleString=t.prototype.toString=function(){var e=this.length;return 0===e?"":0===arguments.length?x(this,0,e):f.apply(this,arguments)},t.prototype.equals=function(e){if(t.isBuffer(e))return this===e||0===t.compare(this,e);throw new TypeError("Argument must be a Buffer")},t.prototype.inspect=function(){var e="",t=r.INSPECT_MAX_BYTES;e=this.toString("hex",0,t).replace(/(.{2})/g,"$1 ").trim();return this.length>t&&(e+=" ... "),"<Buffer "+e+">"},s&&(t.prototype[s]=t.prototype.inspect),t.prototype.compare=function(e,r,n,i,s){if(P(e,Uint8Array)&&(e=t.from(e,e.offset,e.byteLength)),!t.isBuffer(e))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof e);if(void 0===n&&(n=e?e.length:0),void 0===i&&(i=0),void 0===s&&(s=this.length),(r=void 0===r?0:r)<0||n>e.length||i<0||s>this.length)throw new RangeError("out of range index");if(s<=i&&n<=r)return 0;if(s<=i)return-1;if(n<=r)return 1;if(this===e)return 0;for(var o=(s>>>=0)-(i>>>=0),a=(n>>>=0)-(r>>>=0),l=Math.min(o,a),c=this.slice(i,s),u=e.slice(r,n),h=0;h<l;++h)if(c[h]!==u[h]){o=c[h],a=u[h];break}return o<a?-1:a<o?1:0},t.prototype.includes=function(e,t,r){return-1!==this.indexOf(e,t,r)},t.prototype.indexOf=function(e,t,r){return g(this,e,t,r,!0)},t.prototype.lastIndexOf=function(e,t,r){return g(this,e,t,r,!1)},t.prototype.write=function(e,t,r,n){if(void 0===t)n="utf8",r=this.length,t=0;else if(void 0===r&&"string"==typeof t)n=t,r=this.length,t=0;else{if(!isFinite(t))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");t>>>=0,isFinite(r)?(r>>>=0,void 0===n&&(n="utf8")):(n=r,r=void 0)}var i=this.length-t;if((void 0===r||i<r)&&(r=i),0<e.length&&(r<0||t<0)||t>this.length)throw new RangeError("Attempt to write outside buffer bounds");n=n||"utf8";for(var s,o,a,l=!1;;)switch(n){case"hex":var c=e,u=t,h=r,d=(u=Number(u)||0,this.length-u);(!h||d<(h=Number(h)))&&(h=d),(d=c.length)/2<h&&(h=d/2);for(var p=0;p<h;++p){var f=parseInt(c.substr(2*p,2),16);if(j(f))return p;this[u+p]=f}return p;case"utf8":case"utf-8":return d=t,a=r,R(C(e,(o=this).length-d),o,d,a);case"ascii":case"latin1":case"binary":return v(this,e,t,r);case"base64":return o=this,a=t,s=r,R(L(e),o,a,s);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return _(this,e,t,r);default:if(l)throw new TypeError("Unknown encoding: "+n);n=(""+n).toLowerCase(),l=!0}},t.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var b=4096;function w(e,t,r){if(e%1!=0||e<0)throw new RangeError("offset is not uint");if(r<e+t)throw new RangeError("Trying to access beyond buffer length")}function S(e,r,n,i,s,o){if(!t.isBuffer(e))throw new TypeError('"buffer" argument must be a Buffer instance');if(s<r||r<o)throw new RangeError('"value" argument is out of bounds');if(n+i>e.length)throw new RangeError("Index out of range")}function M(e,t,r,n){if(r+n>e.length)throw new RangeError("Index out of range");if(r<0)throw new RangeError("Index out of range")}function T(e,t,r,n,s){return t=+t,r>>>=0,s||M(e,0,r,4),i.write(e,t,r,n,23,4),r+4}function E(e,t,r,n,s){return t=+t,r>>>=0,s||M(e,0,r,8),i.write(e,t,r,n,52,8),r+8}t.prototype.slice=function(e,r){var n=this.length;(e=~~e)<0?(e+=n)<0&&(e=0):n<e&&(e=n),(r=void 0===r?n:~~r)<0?(r+=n)<0&&(r=0):n<r&&(r=n),r<e&&(r=e),n=this.subarray(e,r);return Object.setPrototypeOf(n,t.prototype),n},t.prototype.readUIntLE=function(e,t,r){e>>>=0,t>>>=0,r||w(e,t,this.length);for(var n=this[e],i=1,s=0;++s<t&&(i*=256);)n+=this[e+s]*i;return n},t.prototype.readUIntBE=function(e,t,r){e>>>=0,t>>>=0,r||w(e,t,this.length);for(var n=this[e+--t],i=1;0<t&&(i*=256);)n+=this[e+--t]*i;return n},t.prototype.readUInt8=function(e,t){return e>>>=0,t||w(e,1,this.length),this[e]},t.prototype.readUInt16LE=function(e,t){return e>>>=0,t||w(e,2,this.length),this[e]|this[e+1]<<8},t.prototype.readUInt16BE=function(e,t){return e>>>=0,t||w(e,2,this.length),this[e]<<8|this[e+1]},t.prototype.readUInt32LE=function(e,t){return e>>>=0,t||w(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+16777216*this[e+3]},t.prototype.readUInt32BE=function(e,t){return e>>>=0,t||w(e,4,this.length),16777216*this[e]+(this[e+1]<<16|this[e+2]<<8|this[e+3])},t.prototype.readIntLE=function(e,t,r){e>>>=0,t>>>=0,r||w(e,t,this.length);for(var n=this[e],i=1,s=0;++s<t&&(i*=256);)n+=this[e+s]*i;return(i*=128)<=n&&(n-=Math.pow(2,8*t)),n},t.prototype.readIntBE=function(e,t,r){e>>>=0,t>>>=0,r||w(e,t,this.length);for(var n=t,i=1,s=this[e+--n];0<n&&(i*=256);)s+=this[e+--n]*i;return(i*=128)<=s&&(s-=Math.pow(2,8*t)),s},t.prototype.readInt8=function(e,t){return e>>>=0,t||w(e,1,this.length),128&this[e]?-1*(255-this[e]+1):this[e]},t.prototype.readInt16LE=function(e,t){return e>>>=0,t||w(e,2,this.length),32768&(t=this[e]|this[e+1]<<8)?4294901760|t:t},t.prototype.readInt16BE=function(e,t){return e>>>=0,t||w(e,2,this.length),32768&(t=this[e+1]|this[e]<<8)?4294901760|t:t},t.prototype.readInt32LE=function(e,t){return e>>>=0,t||w(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24},t.prototype.readInt32BE=function(e,t){return e>>>=0,t||w(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]},t.prototype.readFloatLE=function(e,t){return e>>>=0,t||w(e,4,this.length),i.read(this,e,!0,23,4)},t.prototype.readFloatBE=function(e,t){return e>>>=0,t||w(e,4,this.length),i.read(this,e,!1,23,4)},t.prototype.readDoubleLE=function(e,t){return e>>>=0,t||w(e,8,this.length),i.read(this,e,!0,52,8)},t.prototype.readDoubleBE=function(e,t){return e>>>=0,t||w(e,8,this.length),i.read(this,e,!1,52,8)},t.prototype.writeUIntLE=function(e,t,r,n){e=+e,t>>>=0,r>>>=0,n||S(this,e,t,r,Math.pow(2,8*r)-1,0);var i=1,s=0;for(this[t]=255&e;++s<r&&(i*=256);)this[t+s]=e/i&255;return t+r},t.prototype.writeUIntBE=function(e,t,r,n){e=+e,t>>>=0,r>>>=0,n||S(this,e,t,r,Math.pow(2,8*r)-1,0);var i=r-1,s=1;for(this[t+i]=255&e;0<=--i&&(s*=256);)this[t+i]=e/s&255;return t+r},t.prototype.writeUInt8=function(e,t,r){return e=+e,t>>>=0,r||S(this,e,t,1,255,0),this[t]=255&e,t+1},t.prototype.writeUInt16LE=function(e,t,r){return e=+e,t>>>=0,r||S(this,e,t,2,65535,0),this[t]=255&e,this[t+1]=e>>>8,t+2},t.prototype.writeUInt16BE=function(e,t,r){return e=+e,t>>>=0,r||S(this,e,t,2,65535,0),this[t]=e>>>8,this[t+1]=255&e,t+2},t.prototype.writeUInt32LE=function(e,t,r){return e=+e,t>>>=0,r||S(this,e,t,4,4294967295,0),this[t+3]=e>>>24,this[t+2]=e>>>16,this[t+1]=e>>>8,this[t]=255&e,t+4},t.prototype.writeUInt32BE=function(e,t,r){return e=+e,t>>>=0,r||S(this,e,t,4,4294967295,0),this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e,t+4},t.prototype.writeIntLE=function(e,t,r,n){e=+e,t>>>=0,n||S(this,e,t,r,(n=Math.pow(2,8*r-1))-1,-n);var i=0,s=1,o=0;for(this[t]=255&e;++i<r&&(s*=256);)e<0&&0===o&&0!==this[t+i-1]&&(o=1),this[t+i]=(e/s>>0)-o&255;return t+r},t.prototype.writeIntBE=function(e,t,r,n){e=+e,t>>>=0,n||S(this,e,t,r,(n=Math.pow(2,8*r-1))-1,-n);var i=r-1,s=1,o=0;for(this[t+i]=255&e;0<=--i&&(s*=256);)e<0&&0===o&&0!==this[t+i+1]&&(o=1),this[t+i]=(e/s>>0)-o&255;return t+r},t.prototype.writeInt8=function(e,t,r){return e=+e,t>>>=0,r||S(this,e,t,1,127,-128),this[t]=255&(e=e<0?255+e+1:e),t+1},t.prototype.writeInt16LE=function(e,t,r){return e=+e,t>>>=0,r||S(this,e,t,2,32767,-32768),this[t]=255&e,this[t+1]=e>>>8,t+2},t.prototype.writeInt16BE=function(e,t,r){return e=+e,t>>>=0,r||S(this,e,t,2,32767,-32768),this[t]=e>>>8,this[t+1]=255&e,t+2},t.prototype.writeInt32LE=function(e,t,r){return e=+e,t>>>=0,r||S(this,e,t,4,2147483647,-2147483648),this[t]=255&e,this[t+1]=e>>>8,this[t+2]=e>>>16,this[t+3]=e>>>24,t+4},t.prototype.writeInt32BE=function(e,t,r){return e=+e,t>>>=0,r||S(this,e,t,4,2147483647,-2147483648),this[t]=(e=e<0?4294967295+e+1:e)>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e,t+4},t.prototype.writeFloatLE=function(e,t,r){return T(this,e,t,!0,r)},t.prototype.writeFloatBE=function(e,t,r){return T(this,e,t,!1,r)},t.prototype.writeDoubleLE=function(e,t,r){return E(this,e,t,!0,r)},t.prototype.writeDoubleBE=function(e,t,r){return E(this,e,t,!1,r)},t.prototype.copy=function(e,r,n,i){if(!t.isBuffer(e))throw new TypeError("argument should be a Buffer");if(n=n||0,i||0===i||(i=this.length),r>=e.length&&(r=e.length),(i=0<i&&i<n?n:i)===n)return 0;if(0===e.length||0===this.length)return 0;if((r=r||0)<0)throw new RangeError("targetStart out of bounds");if(n<0||n>=this.length)throw new RangeError("Index out of range");if(i<0)throw new RangeError("sourceEnd out of bounds");i>this.length&&(i=this.length);var s=(i=e.length-r<i-n?e.length-r+n:i)-n;if(this===e&&"function"==typeof Uint8Array.prototype.copyWithin)this.copyWithin(r,n,i);else if(this===e&&n<r&&r<i)for(var o=s-1;0<=o;--o)e[o+r]=this[o+n];else Uint8Array.prototype.set.call(e,this.subarray(n,i),r);return s},t.prototype.fill=function(e,r,n,i){if("string"==typeof e){if("string"==typeof r?(i=r,r=0,n=this.length):"string"==typeof n&&(i=n,n=this.length),void 0!==i&&"string"!=typeof i)throw new TypeError("encoding must be a string");if("string"==typeof i&&!t.isEncoding(i))throw new TypeError("Unknown encoding: "+i);var s;1===e.length&&(s=e.charCodeAt(0),("utf8"===i&&s<128||"latin1"===i)&&(e=s))}else"number"==typeof e?e&=255:"boolean"==typeof e&&(e=Number(e));if(r<0||this.length<r||this.length<n)throw new RangeError("Out of range index");var o;if(!(n<=r))if(r>>>=0,n=void 0===n?this.length:n>>>0,"number"==typeof(e=e||0))for(o=r;o<n;++o)this[o]=e;else{var a=t.isBuffer(e)?e:t.from(e,i),l=a.length;if(0===l)throw new TypeError('The value "'+e+'" is invalid for argument "value"');for(o=0;o<n-r;++o)this[o+r]=a[o%l]}return this};var A=/[^+/0-9A-Za-z-_]/g;function C(e,t){t=t||1/0;for(var r,n=e.length,i=null,s=[],o=0;o<n;++o){if(55295<(r=e.charCodeAt(o))&&r<57344){if(!i){if(56319<r){-1<(t-=3)&&s.push(239,191,189);continue}if(o+1===n){-1<(t-=3)&&s.push(239,191,189);continue}i=r;continue}if(r<56320){-1<(t-=3)&&s.push(239,191,189),i=r;continue}r=65536+(i-55296<<10|r-56320)}else i&&-1<(t-=3)&&s.push(239,191,189);if(i=null,r<128){if(--t<0)break;s.push(r)}else if(r<2048){if((t-=2)<0)break;s.push(r>>6|192,63&r|128)}else if(r<65536){if((t-=3)<0)break;s.push(r>>12|224,r>>6&63|128,63&r|128)}else{if(!(r<1114112))throw new Error("Invalid code point");if((t-=4)<0)break;s.push(r>>18|240,r>>12&63|128,r>>6&63|128,63&r|128)}}return s}function L(e){return n.toByteArray(function(e){if((e=(e=e.split("=")[0]).trim().replace(A,"")).length<2)return"";for(;e.length%4!=0;)e+="=";return e}(e))}function R(e,t,r,n){for(var i=0;i<n&&!(i+r>=t.length||i>=e.length);++i)t[i+r]=e[i];return i}function P(e,t){return e instanceof t||null!=e&&null!=e.constructor&&null!=e.constructor.name&&e.constructor.name===t.name}function j(e){return e!=e}var I=function(){for(var e="0123456789abcdef",t=new Array(256),r=0;r<16;++r)for(var n=16*r,i=0;i<16;++i)t[n+i]=e[r]+e[i];return t}()}).call(this,e("buffer").Buffer)},{"base64-js":1,buffer:4,ieee754:238}],5:[function(e,t,r){t.exports=function(e){if("function"!=typeof e)throw TypeError(String(e)+" is not a function");return e}},{}],6:[function(e,t,r){var n=e("../internals/is-object");t.exports=function(e){if(n(e)||null===e)return e;throw TypeError("Can't set "+String(e)+" as a prototype")}},{"../internals/is-object":74}],7:[function(e,t,r){var n=e("../internals/well-known-symbol"),i=e("../internals/object-create"),s=(e=e("../internals/object-define-property"),n("unscopables")),o=Array.prototype;null==o[s]&&e.f(o,s,{configurable:!0,value:i(null)}),t.exports=function(e){o[s][e]=!0}},{"../internals/object-create":90,"../internals/object-define-property":92,"../internals/well-known-symbol":146}],8:[function(e,t,r){"use strict";var n=e("../internals/string-multibyte").charAt;t.exports=function(e,t,r){return t+(r?n(e,t).length:1)}},{"../internals/string-multibyte":123}],9:[function(e,t,r){t.exports=function(e,t,r){if(e instanceof t)return e;throw TypeError("Incorrect "+(r?r+" ":"")+"invocation")}},{}],10:[function(e,t,r){var n=e("../internals/is-object");t.exports=function(e){if(n(e))return e;throw TypeError(String(e)+" is not an object")}},{"../internals/is-object":74}],11:[function(e,t,r){t.exports="undefined"!=typeof ArrayBuffer&&"undefined"!=typeof DataView},{}],12:[function(e,t,r){"use strict";function n(e){return l(e)&&c(E,u(e))}var i,s=e("../internals/array-buffer-native"),o=e("../internals/descriptors"),a=e("../internals/global"),l=e("../internals/is-object"),c=e("../internals/has"),u=e("../internals/classof"),h=e("../internals/create-non-enumerable-property"),d=e("../internals/redefine"),p=e("../internals/object-define-property").f,f=e("../internals/object-get-prototype-of"),m=e("../internals/object-set-prototype-of"),g=e("../internals/well-known-symbol"),y=(e=e("../internals/uid"),a.Int8Array),v=y&&y.prototype,_=(_=a.Uint8ClampedArray)&&_.prototype,x=y&&f(y),b=v&&f(v),w=Object.prototype,S=w.isPrototypeOf,M=(g=g("toStringTag"),e("TYPED_ARRAY_TAG")),T=s&&!!m&&"Opera"!==u(a.opera),E=(e=!1,{Int8Array:1,Uint8Array:1,Uint8ClampedArray:1,Int16Array:2,Uint16Array:2,Int32Array:4,Uint32Array:4,Float32Array:4,Float64Array:8});for(i in E)a[i]||(T=!1);if((!T||"function"!=typeof x||x===Function.prototype)&&(x=function(){throw TypeError("Incorrect invocation")},T))for(i in E)a[i]&&m(a[i],x);if((!T||!b||b===w)&&(b=x.prototype,T))for(i in E)a[i]&&m(a[i].prototype,b);if(T&&f(_)!==b&&m(_,b),o&&!c(b,g))for(i in e=!0,p(b,g,{get:function(){return l(this)?this[M]:void 0}}),E)a[i]&&h(a[i],M,i);t.exports={NATIVE_ARRAY_BUFFER_VIEWS:T,TYPED_ARRAY_TAG:e&&M,aTypedArray:function(e){if(n(e))return e;throw TypeError("Target is not a typed array")},aTypedArrayConstructor:function(e){if(m){if(S.call(x,e))return e}else for(var t in E)if(c(E,i)&&(t=a[t])&&(e===t||S.call(t,e)))return e;throw TypeError("Target is not a typed array constructor")},exportTypedArrayMethod:function(e,t,r){if(o){if(r)for(var n in E)(n=a[n])&&c(n.prototype,e)&&delete n.prototype[e];b[e]&&!r||d(b,e,!r&&T&&v[e]||t)}},exportTypedArrayStaticMethod:function(e,t,r){var n,i;if(o){if(m){if(r)for(n in E)(i=a[n])&&c(i,e)&&delete i[e];if(x[e]&&!r)return;try{return d(x,e,!r&&T&&y[e]||t)}catch(e){}}for(n in E)!(i=a[n])||i[e]&&!r||d(i,e,t)}},isView:function(e){return"DataView"===(e=u(e))||c(E,e)},isTypedArray:n,TypedArray:x,TypedArrayPrototype:b}},{"../internals/array-buffer-native":11,"../internals/classof":29,"../internals/create-non-enumerable-property":38,"../internals/descriptors":43,"../internals/global":59,"../internals/has":60,"../internals/is-object":74,"../internals/object-define-property":92,"../internals/object-get-prototype-of":97,"../internals/object-set-prototype-of":101,"../internals/redefine":108,"../internals/uid":143,"../internals/well-known-symbol":146}],13:[function(e,t,r){"use strict";function n(e){return[255&e]}function i(e){return[255&e,e>>8&255]}function s(e){return[255&e,e>>8&255,e>>16&255,e>>24&255]}function o(e){return e[3]<<24|e[2]<<16|e[1]<<8|e[0]}function a(e){return B(e,23,4)}function l(e){return B(e,52,8)}function c(e,t){E(e[I],t,{get:function(){return L(this)[t]}})}function u(e,t,r,n){if((r=b(r))+t>(e=L(e)).byteLength)throw F(D);var i=L(e.buffer).bytes;r+=e.byteOffset,e=i.slice(r,r+t);return n?e:e.reverse()}function h(e,t,r,n,i,s){if((r=b(r))+t>(e=L(e)).byteLength)throw F(D);for(var o=L(e.buffer).bytes,a=r+e.byteOffset,l=n(+i),c=0;c<t;c++)o[a+c]=l[s?c:t-c-1]}var d=e("../internals/global"),p=e("../internals/descriptors"),f=e("../internals/array-buffer-native"),m=e("../internals/create-non-enumerable-property"),g=e("../internals/redefine-all"),y=e("../internals/fails"),v=e("../internals/an-instance"),_=e("../internals/to-integer"),x=e("../internals/to-length"),b=e("../internals/to-index"),w=e("../internals/ieee754"),S=e("../internals/object-get-prototype-of"),M=e("../internals/object-set-prototype-of"),T=e("../internals/object-get-own-property-names").f,E=e("../internals/object-define-property").f,A=e("../internals/array-fill"),C=e("../internals/set-to-string-tag"),L=(e=e("../internals/internal-state")).get,R=e.set,P="ArrayBuffer",j="DataView",I="prototype",D="Wrong index",O=d[P],N=O,U=d[j],k=(e=U&&U[I],Object.prototype),F=d.RangeError,B=w.pack,z=w.unpack;if(f){if(!y((function(){O(1)}))||!y((function(){new O(-1)}))||y((function(){return new O,new O(1.5),new O(NaN),O.name!=P}))){d=(N=function(e){return v(this,N),new O(b(e))})[I]=O[I];for(var G,V=T(O),H=0;V.length>H;)(G=V[H++])in N||m(N,G,O[G]);d.constructor=N}M&&S(e)!==k&&M(e,k);w=new U(new N(2));var W=e.setInt8;w.setInt8(0,2147483648),w.setInt8(1,2147483649),!w.getInt8(0)&&w.getInt8(1)||g(e,{setInt8:function(e,t){W.call(this,e,t<<24>>24)},setUint8:function(e,t){W.call(this,e,t<<24>>24)}},{unsafe:!0})}else N=function(e){v(this,N,P),e=b(e),R(this,{bytes:A.call(new Array(e),0),byteLength:e}),p||(this.byteLength=e)},U=function(e,t,r){v(this,U,j),v(e,N,j);var n=L(e).byteLength;if((t=_(t))<0||n<t)throw F("Wrong offset");if(n<t+(r=void 0===r?n-t:x(r)))throw F("Wrong length");R(this,{buffer:e,byteLength:r,byteOffset:t}),p||(this.buffer=e,this.byteLength=r,this.byteOffset=t)},p&&(c(N,"byteLength"),c(U,"buffer"),c(U,"byteLength"),c(U,"byteOffset")),g(U[I],{getInt8:function(e){return u(this,1,e)[0]<<24>>24},getUint8:function(e){return u(this,1,e)[0]},getInt16:function(e){return((e=u(this,2,e,1<arguments.length?arguments[1]:void 0))[1]<<8|e[0])<<16>>16},getUint16:function(e){return(e=u(this,2,e,1<arguments.length?arguments[1]:void 0))[1]<<8|e[0]},getInt32:function(e){return o(u(this,4,e,1<arguments.length?arguments[1]:void 0))},getUint32:function(e){return o(u(this,4,e,1<arguments.length?arguments[1]:void 0))>>>0},getFloat32:function(e){return z(u(this,4,e,1<arguments.length?arguments[1]:void 0),23)},getFloat64:function(e){return z(u(this,8,e,1<arguments.length?arguments[1]:void 0),52)},setInt8:function(e,t){h(this,1,e,n,t)},setUint8:function(e,t){h(this,1,e,n,t)},setInt16:function(e,t){h(this,2,e,i,t,2<arguments.length?arguments[2]:void 0)},setUint16:function(e,t){h(this,2,e,i,t,2<arguments.length?arguments[2]:void 0)},setInt32:function(e,t){h(this,4,e,s,t,2<arguments.length?arguments[2]:void 0)},setUint32:function(e,t){h(this,4,e,s,t,2<arguments.length?arguments[2]:void 0)},setFloat32:function(e,t){h(this,4,e,a,t,2<arguments.length?arguments[2]:void 0)},setFloat64:function(e,t){h(this,8,e,l,t,2<arguments.length?arguments[2]:void 0)}});C(N,P),C(U,j),t.exports={ArrayBuffer:N,DataView:U}},{"../internals/an-instance":9,"../internals/array-buffer-native":11,"../internals/array-fill":15,"../internals/create-non-enumerable-property":38,"../internals/descriptors":43,"../internals/fails":51,"../internals/global":59,"../internals/ieee754":65,"../internals/internal-state":70,"../internals/object-define-property":92,"../internals/object-get-own-property-names":95,"../internals/object-get-prototype-of":97,"../internals/object-set-prototype-of":101,"../internals/redefine-all":107,"../internals/set-to-string-tag":117,"../internals/to-index":131,"../internals/to-integer":133,"../internals/to-length":134}],14:[function(e,t,r){"use strict";var n=e("../internals/to-object"),i=e("../internals/to-absolute-index"),s=e("../internals/to-length"),o=Math.min;t.exports=[].copyWithin||function(e,t){var r=n(this),a=s(r.length),l=i(e,a),c=i(t,a),u=o((void 0===(e=2<arguments.length?arguments[2]:void 0)?a:i(e,a))-c,a-l),h=1;for(c<l&&l<c+u&&(h=-1,c+=u-1,l+=u-1);0<u--;)c in r?r[l]=r[c]:delete r[l],l+=h,c+=h;return r}},{"../internals/to-absolute-index":130,"../internals/to-length":134,"../internals/to-object":135}],15:[function(e,t,r){"use strict";var n=e("../internals/to-object"),i=e("../internals/to-absolute-index"),s=e("../internals/to-length");t.exports=function(e){for(var t,r=n(this),o=s(r.length),a=i(1<(t=arguments.length)?arguments[1]:void 0,o),l=void 0===(t=2<t?arguments[2]:void 0)?o:i(t,o);a<l;)r[a++]=e;return r}},{"../internals/to-absolute-index":130,"../internals/to-length":134,"../internals/to-object":135}],16:[function(e,t,r){"use strict";var n=e("../internals/array-iteration").forEach,i=e("../internals/array-method-is-strict");e=e("../internals/array-method-uses-to-length"),i=i("forEach"),e=e("forEach");t.exports=i&&e?[].forEach:function(e){return n(this,e,1<arguments.length?arguments[1]:void 0)}},{"../internals/array-iteration":19,"../internals/array-method-is-strict":22,"../internals/array-method-uses-to-length":23}],17:[function(e,t,r){"use strict";var n=e("../internals/function-bind-context"),i=e("../internals/to-object"),s=e("../internals/call-with-safe-iteration-closing"),o=e("../internals/is-array-iterator-method"),a=e("../internals/to-length"),l=e("../internals/create-property"),c=e("../internals/get-iterator-method");t.exports=function(e){var t,r,u,h,d,p,f=i(e),m=(e="function"==typeof this?this:Array,arguments.length),g=1<m?arguments[1]:void 0,y=void 0!==g,v=c(f),_=0;if(y&&(g=n(g,2<m?arguments[2]:void 0,2)),null==v||e==Array&&o(v))for(r=new e(t=a(f.length));_<t;_++)p=y?g(f[_],_):f[_],l(r,_,p);else for(d=(h=v.call(f)).next,r=new e;!(u=d.call(h)).done;_++)p=y?s(h,g,[u.value,_],!0):u.value,l(r,_,p);return r.length=_,r}},{"../internals/call-with-safe-iteration-closing":26,"../internals/create-property":40,"../internals/function-bind-context":54,"../internals/get-iterator-method":57,"../internals/is-array-iterator-method":71,"../internals/to-length":134,"../internals/to-object":135}],18:[function(e,t,r){function n(e){return function(t,r,n){var a,l=i(t),c=s(l.length),u=o(n,c);if(e&&r!=r){for(;u<c;)if((a=l[u++])!=a)return!0}else for(;u<c;u++)if((e||u in l)&&l[u]===r)return e||u||0;return!e&&-1}}var i=e("../internals/to-indexed-object"),s=e("../internals/to-length"),o=e("../internals/to-absolute-index");t.exports={includes:n(!0),indexOf:n(!1)}},{"../internals/to-absolute-index":130,"../internals/to-indexed-object":132,"../internals/to-length":134}],19:[function(e,t,r){function n(e){var t=1==e,r=2==e,n=3==e,u=4==e,h=6==e,d=5==e||h;return function(p,f,m,g){for(var y,v,_=o(p),x=s(_),b=i(f,m,3),w=a(x.length),S=0,M=(f=g||l,t?f(p,w):r?f(p,0):void 0);S<w;S++)if((d||S in x)&&(v=b(y=x[S],S,_),e))if(t)M[S]=v;else if(v)switch(e){case 3:return!0;case 5:return y;case 6:return S;case 2:c.call(M,y)}else if(u)return!1;return h?-1:n||u?u:M}}var i=e("../internals/function-bind-context"),s=e("../internals/indexed-object"),o=e("../internals/to-object"),a=e("../internals/to-length"),l=e("../internals/array-species-create"),c=[].push;t.exports={forEach:n(0),map:n(1),filter:n(2),some:n(3),every:n(4),find:n(5),findIndex:n(6)}},{"../internals/array-species-create":25,"../internals/function-bind-context":54,"../internals/indexed-object":66,"../internals/to-length":134,"../internals/to-object":135}],20:[function(e,t,r){"use strict";var n=e("../internals/to-indexed-object"),i=e("../internals/to-integer"),s=e("../internals/to-length"),o=e("../internals/array-method-is-strict"),a=(e=e("../internals/array-method-uses-to-length"),Math.min),l=[].lastIndexOf,c=!!l&&1/[1].lastIndexOf(1,-0)<0;o=o("lastIndexOf"),e=e("indexOf",{ACCESSORS:!0,1:0});t.exports=!c&&o&&e?l:function(e){if(c)return l.apply(this,arguments)||0;var t=n(this),r=s(t.length),o=r-1;for((o=1<arguments.length?a(o,i(arguments[1])):o)<0&&(o=r+o);0<=o;o--)if(o in t&&t[o]===e)return o||0;return-1}},{"../internals/array-method-is-strict":22,"../internals/array-method-uses-to-length":23,"../internals/to-indexed-object":132,"../internals/to-integer":133,"../internals/to-length":134}],21:[function(e,t,r){var n=e("../internals/fails"),i=e("../internals/well-known-symbol"),s=e("../internals/engine-v8-version"),o=i("species");t.exports=function(e){return 51<=s||!n((function(){var t=[];return(t.constructor={})[o]=function(){return{foo:1}},1!==t[e](Boolean).foo}))}},{"../internals/engine-v8-version":48,"../internals/fails":51,"../internals/well-known-symbol":146}],22:[function(e,t,r){"use strict";var n=e("../internals/fails");t.exports=function(e,t){var r=[][e];return!!r&&n((function(){r.call(null,t||function(){throw 1},1)}))}},{"../internals/fails":51}],23:[function(e,t,r){function n(e){throw e}var i=e("../internals/descriptors"),s=e("../internals/fails"),o=e("../internals/has"),a=Object.defineProperty,l={};t.exports=function(e,t){var r,c,u,h;return o(l,e)?l[e]:(r=[][e],c=!!o(t=t||{},"ACCESSORS")&&t.ACCESSORS,u=o(t,0)?t[0]:n,h=o(t,1)?t[1]:void 0,l[e]=!!r&&!s((function(){if(c&&!i)return!0;var e={length:-1};c?a(e,1,{enumerable:!0,get:n}):e[1]=1,r.call(e,u,h)})))}},{"../internals/descriptors":43,"../internals/fails":51,"../internals/has":60}],24:[function(e,t,r){function n(e){return function(t,r,n,l){i(r);var c=s(t),u=o(c),h=a(c.length),d=e?h-1:0,p=e?-1:1;if(n<2)for(;;){if(d in u){l=u[d],d+=p;break}if(d+=p,e?d<0:h<=d)throw TypeError("Reduce of empty array with no initial value")}for(;e?0<=d:d<h;d+=p)d in u&&(l=r(l,u[d],d,c));return l}}var i=e("../internals/a-function"),s=e("../internals/to-object"),o=e("../internals/indexed-object"),a=e("../internals/to-length");t.exports={left:n(!1),right:n(!0)}},{"../internals/a-function":5,"../internals/indexed-object":66,"../internals/to-length":134,"../internals/to-object":135}],25:[function(e,t,r){var n=e("../internals/is-object"),i=e("../internals/is-array"),s=e("../internals/well-known-symbol")("species");t.exports=function(e,t){var r;return new(void 0===(r=i(e)&&("function"==typeof(r=e.constructor)&&(r===Array||i(r.prototype))||n(r)&&null===(r=r[s]))?void 0:r)?Array:r)(0===t?0:t)}},{"../internals/is-array":72,"../internals/is-object":74,"../internals/well-known-symbol":146}],26:[function(e,t,r){var n=e("../internals/an-object");t.exports=function(e,t,r,i){try{return i?t(n(r)[0],r[1]):t(r)}catch(t){throw void 0!==(i=e.return)&&n(i.call(e)),t}}},{"../internals/an-object":10}],27:[function(e,t,r){var n=e("../internals/well-known-symbol")("iterator"),i=!1;try{var s=0,o={next:function(){return{done:!!s++}},return:function(){i=!0}};o[n]=function(){return this},Array.from(o,(function(){throw 2}))}catch(e){}t.exports=function(e,t){if(!t&&!i)return!1;var r=!1;try{var s={};s[n]=function(){return{next:function(){return{done:r=!0}}}},e(s)}catch(e){}return r}},{"../internals/well-known-symbol":146}],28:[function(e,t,r){var n={}.toString;t.exports=function(e){return n.call(e).slice(8,-1)}},{}],29:[function(e,t,r){var n=e("../internals/to-string-tag-support"),i=e("../internals/classof-raw"),s=e("../internals/well-known-symbol")("toStringTag"),o="Arguments"==i(function(){return arguments}());t.exports=n?i:function(e){var t;return void 0===e?"Undefined":null===e?"Null":"string"==typeof(t=function(e,t){try{return e[t]}catch(e){}}(e=Object(e),s))?t:o?i(e):"Object"==(t=i(e))&&"function"==typeof e.callee?"Arguments":t}},{"../internals/classof-raw":28,"../internals/to-string-tag-support":139,"../internals/well-known-symbol":146}],30:[function(e,t,r){"use strict";var n=e("../internals/object-define-property").f,i=e("../internals/object-create"),s=e("../internals/redefine-all"),o=e("../internals/function-bind-context"),a=e("../internals/an-instance"),l=e("../internals/iterate"),c=e("../internals/define-iterator"),u=e("../internals/set-species"),h=e("../internals/descriptors"),d=e("../internals/internal-metadata").fastKey,p=(e=e("../internals/internal-state")).set,f=e.getterFor;t.exports={getConstructor:function(e,t,r,c){function u(e,t,r){var n,i=y(e),s=m(e,t);return s?s.value=r:(i.last=s={index:n=d(t,!0),key:t,value:r,previous:t=i.last,next:void 0,removed:!1},i.first||(i.first=s),t&&(t.next=s),h?i.size++:e.size++,"F"!==n&&(i.index[n]=s)),e}function m(e,t){e=y(e);var r,n=d(t);if("F"!==n)return e.index[n];for(r=e.first;r;r=r.next)if(r.key==t)return r}var g=e((function(e,n){a(e,g,t),p(e,{type:t,index:i(null),first:void 0,last:void 0,size:0}),h||(e.size=0),null!=n&&l(n,e[c],e,r)})),y=f(t);return s(g.prototype,{clear:function(){for(var e=y(this),t=e.index,r=e.first;r;)r.removed=!0,r.previous&&(r.previous=r.previous.next=void 0),delete t[r.index],r=r.next;e.first=e.last=void 0,h?e.size=0:this.size=0},delete:function(e){var t,r,n=y(this);return(e=m(this,e))&&(t=e.next,r=e.previous,delete n.index[e.index],e.removed=!0,r&&(r.next=t),t&&(t.previous=r),n.first==e&&(n.first=t),n.last==e&&(n.last=r),h?n.size--:this.size--),!!e},forEach:function(e){for(var t,r=y(this),n=o(e,1<arguments.length?arguments[1]:void 0,3);t=t?t.next:r.first;)for(n(t.value,t.key,this);t&&t.removed;)t=t.previous},has:function(e){return!!m(this,e)}}),s(g.prototype,r?{get:function(e){return(e=m(this,e))&&e.value},set:function(e,t){return u(this,0===e?0:e,t)}}:{add:function(e){return u(this,e=0===e?0:e,e)}}),h&&n(g.prototype,"size",{get:function(){return y(this).size}}),g},setStrong:function(e,t,r){var n=t+" Iterator",i=f(t),s=f(n);c(e,t,(function(e,t){p(this,{type:n,target:e,state:i(e),kind:t,last:void 0})}),(function(){for(var e=s(this),t=e.kind,r=e.last;r&&r.removed;)r=r.previous;return e.target&&(e.last=r=r?r.next:e.state.first)?"keys"==t?{value:r.key,done:!1}:"values"==t?{value:r.value,done:!1}:{value:[r.key,r.value],done:!1}:{value:e.target=void 0,done:!0}}),r?"entries":"values",!r,!0),u(t)}}},{"../internals/an-instance":9,"../internals/define-iterator":41,"../internals/descriptors":43,"../internals/function-bind-context":54,"../internals/internal-metadata":69,"../internals/internal-state":70,"../internals/iterate":77,"../internals/object-create":90,"../internals/object-define-property":92,"../internals/redefine-all":107,"../internals/set-species":116}],31:[function(e,t,r){"use strict";function n(e){return e.frozen||(e.frozen=new i)}function i(){this.entries=[]}function s(e,t){return g(e.entries,(function(e){return e[0]===t}))}var o=e("../internals/redefine-all"),a=e("../internals/internal-metadata").getWeakData,l=e("../internals/an-object"),c=e("../internals/is-object"),u=e("../internals/an-instance"),h=e("../internals/iterate"),d=e("../internals/array-iteration"),p=e("../internals/has"),f=(e=e("../internals/internal-state")).set,m=e.getterFor,g=d.find,y=d.findIndex,v=0;i.prototype={get:function(e){if(e=s(this,e))return e[1]},has:function(e){return!!s(this,e)},set:function(e,t){var r=s(this,e);r?r[1]=t:this.entries.push([e,t])},delete:function(e){var t=y(this.entries,(function(t){return t[0]===e}));return~t&&this.entries.splice(t,1),!!~t}},t.exports={getConstructor:function(e,t,r,i){function s(e,t,r){var i=g(e),s=a(l(t),!0);return!0===s?n(i).set(t,r):s[i.id]=r,e}var d=e((function(e,n){u(e,d,t),f(e,{type:t,id:v++,frozen:void 0}),null!=n&&h(n,e[i],e,r)})),g=m(t);return o(d.prototype,{delete:function(e){var t,r=g(this);return!!c(e)&&(!0===(t=a(e))?n(r).delete(e):t&&p(t,r.id)&&delete t[r.id])},has:function(e){var t,r=g(this);return!!c(e)&&(!0===(t=a(e))?n(r).has(e):t&&p(t,r.id))}}),o(d.prototype,r?{get:function(e){var t,r=g(this);if(c(e))return!0===(t=a(e))?n(r).get(e):t?t[r.id]:void 0},set:function(e,t){return s(this,e,t)}}:{add:function(e){return s(this,e,!0)}}),d}}},{"../internals/an-instance":9,"../internals/an-object":10,"../internals/array-iteration":19,"../internals/has":60,"../internals/internal-metadata":69,"../internals/internal-state":70,"../internals/is-object":74,"../internals/iterate":77,"../internals/redefine-all":107}],32:[function(e,t,r){"use strict";var n=e("../internals/export"),i=e("../internals/global"),s=e("../internals/is-forced"),o=e("../internals/redefine"),a=e("../internals/internal-metadata"),l=e("../internals/iterate"),c=e("../internals/an-instance"),u=e("../internals/is-object"),h=e("../internals/fails"),d=e("../internals/check-correctness-of-iteration"),p=e("../internals/set-to-string-tag"),f=e("../internals/inherit-if-required");t.exports=function(e,t,r){function m(e){var t=T[e];o(T,e,"add"==e?function(e){return t.call(this,0===e?0:e),this}:"delete"==e?function(e){return!(w&&!u(e))&&t.call(this,0===e?0:e)}:"get"==e?function(e){return w&&!u(e)?void 0:t.call(this,0===e?0:e)}:"has"==e?function(e){return!(w&&!u(e))&&t.call(this,0===e?0:e)}:function(e,r){return t.call(this,0===e?0:e,r),this})}var g,y,v,_,x,b=-1!==e.indexOf("Map"),w=-1!==e.indexOf("Weak"),S=b?"set":"add",M=i[e],T=M&&M.prototype,E=M,A={};return s(e,"function"!=typeof M||!(w||T.forEach&&!h((function(){(new M).entries().next()}))))?(E=r.getConstructor(t,e,b,S),a.REQUIRED=!0):s(e,!0)&&(y=(g=new E)[S](w?{}:-0,1)!=g,v=h((function(){g.has(1)})),_=d((function(e){new M(e)})),x=!w&&h((function(){for(var e=new M,t=5;t--;)e[S](t,t);return!e.has(-0)})),_||(((E=t((function(t,r){return c(t,E,e),t=f(new M,t,E),null!=r&&l(r,t[S],t,b),t}))).prototype=T).constructor=E),(v||x)&&(m("delete"),m("has"),b&&m("get")),(x||y)&&m(S),w&&T.clear&&delete T.clear),A[e]=E,n({global:!0,forced:E!=M},A),p(E,e),w||r.setStrong(E,e,b),E}},{"../internals/an-instance":9,"../internals/check-correctness-of-iteration":27,"../internals/export":50,"../internals/fails":51,"../internals/global":59,"../internals/inherit-if-required":67,"../internals/internal-metadata":69,"../internals/is-forced":73,"../internals/is-object":74,"../internals/iterate":77,"../internals/redefine":108,"../internals/set-to-string-tag":117}],33:[function(e,t,r){var n=e("../internals/has"),i=e("../internals/own-keys"),s=e("../internals/object-get-own-property-descriptor"),o=e("../internals/object-define-property");t.exports=function(e,t){for(var r=i(t),a=o.f,l=s.f,c=0;c<r.length;c++){var u=r[c];n(e,u)||a(e,u,l(t,u))}}},{"../internals/has":60,"../internals/object-define-property":92,"../internals/object-get-own-property-descriptor":93,"../internals/own-keys":103}],34:[function(e,t,r){var n=e("../internals/well-known-symbol")("match");t.exports=function(e){var t=/./;try{"/./"[e](t)}catch(r){try{return t[n]=!1,"/./"[e](t)}catch(e){}}return!1}},{"../internals/well-known-symbol":146}],35:[function(e,t,r){e=e("../internals/fails"),t.exports=!e((function(){function e(){}return e.prototype.constructor=null,Object.getPrototypeOf(new e)!==e.prototype}))},{"../internals/fails":51}],36:[function(e,t,r){var n=e("../internals/require-object-coercible"),i=/"/g;t.exports=function(e,t,r,s){e=String(n(e));var o="<"+t;return""!==r&&(o+=" "+r+'="'+String(s).replace(i,"&quot;")+'"'),o+">"+e+"</"+t+">"}},{"../internals/require-object-coercible":113}],37:[function(e,t,r){"use strict";function n(){return this}var i=e("../internals/iterators-core").IteratorPrototype,s=e("../internals/object-create"),o=e("../internals/create-property-descriptor"),a=e("../internals/set-to-string-tag"),l=e("../internals/iterators");t.exports=function(e,t,r){return t+=" Iterator",e.prototype=s(i,{next:o(1,r)}),a(e,t,!1,!0),l[t]=n,e}},{"../internals/create-property-descriptor":39,"../internals/iterators":79,"../internals/iterators-core":78,"../internals/object-create":90,"../internals/set-to-string-tag":117}],38:[function(e,t,r){var n=e("../internals/descriptors"),i=e("../internals/object-define-property"),s=e("../internals/create-property-descriptor");t.exports=n?function(e,t,r){return i.f(e,t,s(1,r))}:function(e,t,r){return e[t]=r,e}},{"../internals/create-property-descriptor":39,"../internals/descriptors":43,"../internals/object-define-property":92}],39:[function(e,t,r){t.exports=function(e,t){return{enumerable:!(1&e),configurable:!(2&e),writable:!(4&e),value:t}}},{}],40:[function(e,t,r){"use strict";var n=e("../internals/to-primitive"),i=e("../internals/object-define-property"),s=e("../internals/create-property-descriptor");t.exports=function(e,t,r){(t=n(t))in e?i.f(e,t,s(0,r)):e[t]=r}},{"../internals/create-property-descriptor":39,"../internals/object-define-property":92,"../internals/to-primitive":138}],41:[function(e,t,r){"use strict";function n(){return this}var i=e("../internals/export"),s=e("../internals/create-iterator-constructor"),o=e("../internals/object-get-prototype-of"),a=e("../internals/object-set-prototype-of"),l=e("../internals/set-to-string-tag"),c=e("../internals/create-non-enumerable-property"),u=e("../internals/redefine"),h=e("../internals/well-known-symbol"),d=e("../internals/is-pure"),p=e("../internals/iterators"),f=(e=e("../internals/iterators-core")).IteratorPrototype,m=e.BUGGY_SAFARI_ITERATORS,g=h("iterator"),y="values",v="entries";t.exports=function(e,t,r,h,_,x,b){function w(e){if(e===_&&C)return C;if(!m&&e in E)return E[e];switch(e){case"keys":case y:case v:return function(){return new r(this,e)}}return function(){return new r(this)}}s(r,t,h);h=t+" Iterator";var S,M,T=!1,E=e.prototype,A=E[g]||E["@@iterator"]||_&&E[_],C=!m&&A||w(_),L="Array"==t&&E.entries||A;if(L&&(L=o(L.call(new e)),f!==Object.prototype&&L.next&&(d||o(L)===f||(a?a(L,f):"function"!=typeof L[g]&&c(L,g,n)),l(L,h,!0,!0),d&&(p[h]=n))),_==y&&A&&A.name!==y&&(T=!0,C=function(){return A.call(this)}),d&&!b||E[g]===C||c(E,g,C),p[t]=C,_)if(S={values:w(y),keys:x?C:w("keys"),entries:w(v)},b)for(M in S)!m&&!T&&M in E||u(E,M,S[M]);else i({target:t,proto:!0,forced:m||T},S);return S}},{"../internals/create-iterator-constructor":37,"../internals/create-non-enumerable-property":38,"../internals/export":50,"../internals/is-pure":75,"../internals/iterators":79,"../internals/iterators-core":78,"../internals/object-get-prototype-of":97,"../internals/object-set-prototype-of":101,"../internals/redefine":108,"../internals/set-to-string-tag":117,"../internals/well-known-symbol":146}],42:[function(e,t,r){var n=e("../internals/path"),i=e("../internals/has"),s=e("../internals/well-known-symbol-wrapped"),o=e("../internals/object-define-property").f;t.exports=function(e){var t=n.Symbol||(n.Symbol={});i(t,e)||o(t,e,{value:s.f(e)})}},{"../internals/has":60,"../internals/object-define-property":92,"../internals/path":104,"../internals/well-known-symbol-wrapped":145}],43:[function(e,t,r){e=e("../internals/fails"),t.exports=!e((function(){return 7!=Object.defineProperty({},1,{get:function(){return 7}})[1]}))},{"../internals/fails":51}],44:[function(e,t,r){var n=e("../internals/global"),i=(e=e("../internals/is-object"),n.document),s=e(i)&&e(i.createElement);t.exports=function(e){return s?i.createElement(e):{}}},{"../internals/global":59,"../internals/is-object":74}],45:[function(e,t,r){t.exports={CSSRuleList:0,CSSStyleDeclaration:0,CSSValueList:0,ClientRectList:0,DOMRectList:0,DOMStringList:0,DOMTokenList:1,DataTransferItemList:0,FileList:0,HTMLAllCollection:0,HTMLCollection:0,HTMLFormElement:0,HTMLSelectElement:0,MediaList:0,MimeTypeArray:0,NamedNodeMap:0,NodeList:1,PaintRequestList:0,Plugin:0,PluginArray:0,SVGLengthList:0,SVGNumberList:0,SVGPathSegList:0,SVGPointList:0,SVGStringList:0,SVGTransformList:0,SourceBufferList:0,StyleSheetList:0,TextTrackCueList:0,TextTrackList:0,TouchList:0}},{}],46:[function(e,t,r){e=e("../internals/engine-user-agent"),t.exports=/(iphone|ipod|ipad).*applewebkit/i.test(e)},{"../internals/engine-user-agent":47}],47:[function(e,t,r){e=e("../internals/get-built-in"),t.exports=e("navigator","userAgent")||""},{"../internals/get-built-in":56}],48:[function(e,t,r){var n,i,s=e("../internals/global");e=e("../internals/engine-user-agent");(s=(s=(s=s.process)&&s.versions)&&s.v8)?i=(n=s.split("."))[0]+n[1]:e&&(!(n=e.match(/Edge\/(\d+)/))||74<=n[1])&&(n=e.match(/Chrome\/(\d+)/))&&(i=n[1]),t.exports=i&&+i},{"../internals/engine-user-agent":47,"../internals/global":59}],49:[function(e,t,r){t.exports=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"]},{}],50:[function(e,t,r){var n=e("../internals/global"),i=e("../internals/object-get-own-property-descriptor").f,s=e("../internals/create-non-enumerable-property"),o=e("../internals/redefine"),a=e("../internals/set-global"),l=e("../internals/copy-constructor-properties"),c=e("../internals/is-forced");t.exports=function(e,t){var r,u,h,d=e.target,p=e.global,f=e.stat,m=p?n:f?n[d]||a(d,{}):(n[d]||{}).prototype;if(m)for(r in t){if(u=t[r],h=e.noTargetGet?(h=i(m,r))&&h.value:m[r],!c(p?r:d+(f?".":"#")+r,e.forced)&&void 0!==h){if(typeof u==typeof h)continue;l(u,h)}(e.sham||h&&h.sham)&&s(u,"sham",!0),o(m,r,u,e)}}},{"../internals/copy-constructor-properties":33,"../internals/create-non-enumerable-property":38,"../internals/global":59,"../internals/is-forced":73,"../internals/object-get-own-property-descriptor":93,"../internals/redefine":108,"../internals/set-global":115}],51:[function(e,t,r){t.exports=function(e){try{return!!e()}catch(e){return!0}}},{}],52:[function(e,t,r){"use strict";e("../modules/es.regexp.exec");var n=e("../internals/redefine"),i=e("../internals/fails"),s=e("../internals/well-known-symbol"),o=e("../internals/regexp-exec"),a=e("../internals/create-non-enumerable-property"),l=s("species"),c=!i((function(){var e=/./;return e.exec=function(){var e=[];return e.groups={a:"7"},e},"7"!=="".replace(e,"$<a>")})),u="$0"==="a".replace(/./,"$0"),h=!!/./[e=s("replace")]&&""===/./[e]("a","$0"),d=!i((function(){var e=(t=/(?:)/).exec,t=(t.exec=function(){return e.apply(this,arguments)},"ab".split(t));return 2!==t.length||"a"!==t[0]||"b"!==t[1]}));t.exports=function(e,t,r,p){var f,m,g=s(e),y=!i((function(){var t={};return t[g]=function(){return 7},7!=""[e](t)})),v=y&&!i((function(){var t=!1,r=/a/;return"split"===e&&((r={constructor:{}}).constructor[l]=function(){return r},r.flags="",r[g]=/./[g]),r.exec=function(){return t=!0,null},r[g](""),!t}));y&&v&&("replace"!==e||c&&u&&!h)&&("split"!==e||d)||(f=/./[g],r=(v=r(g,""[e],(function(e,t,r,n,i){return t.exec===o?y&&!i?{done:!0,value:f.call(t,r,n)}:{done:!0,value:e.call(r,t,n)}:{done:!1}}),{REPLACE_KEEPS_$0:u,REGEXP_REPLACE_SUBSTITUTES_UNDEFINED_CAPTURE:h}))[0],m=v[1],n(String.prototype,e,r),n(RegExp.prototype,g,2==t?function(e,t){return m.call(e,this,t)}:function(e){return m.call(e,this)})),p&&a(RegExp.prototype[g],"sham",!0)}},{"../internals/create-non-enumerable-property":38,"../internals/fails":51,"../internals/redefine":108,"../internals/regexp-exec":110,"../internals/well-known-symbol":146,"../modules/es.regexp.exec":181}],53:[function(e,t,r){e=e("../internals/fails"),t.exports=!e((function(){return Object.isExtensible(Object.preventExtensions({}))}))},{"../internals/fails":51}],54:[function(e,t,r){var n=e("../internals/a-function");t.exports=function(e,t,r){if(n(e),void 0===t)return e;switch(r){case 0:return function(){return e.call(t)};case 1:return function(r){return e.call(t,r)};case 2:return function(r,n){return e.call(t,r,n)};case 3:return function(r,n,i){return e.call(t,r,n,i)}}return function(){return e.apply(t,arguments)}}},{"../internals/a-function":5}],55:[function(e,t,r){"use strict";var n=e("../internals/a-function"),i=e("../internals/is-object"),s=[].slice,o={};t.exports=Function.bind||function(e){var t=n(this),r=s.call(arguments,1),a=function(){var n=r.concat(s.call(arguments));if(this instanceof a){var i=t,l=n.length,c=n;if(!(l in o)){for(var u=[],h=0;h<l;h++)u[h]="a["+h+"]";o[l]=Function("C,a","return new C("+u.join(",")+")")}return o[l](i,c)}return t.apply(e,n)};return i(t.prototype)&&(a.prototype=t.prototype),a}},{"../internals/a-function":5,"../internals/is-object":74}],56:[function(e,t,r){function n(e){return"function"==typeof e?e:void 0}var i=e("../internals/path"),s=e("../internals/global");t.exports=function(e,t){return arguments.length<2?n(i[e])||n(s[e]):i[e]&&i[e][t]||s[e]&&s[e][t]}},{"../internals/global":59,"../internals/path":104}],57:[function(e,t,r){var n=e("../internals/classof"),i=e("../internals/iterators"),s=e("../internals/well-known-symbol")("iterator");t.exports=function(e){if(null!=e)return e[s]||e["@@iterator"]||i[n(e)]}},{"../internals/classof":29,"../internals/iterators":79,"../internals/well-known-symbol":146}],58:[function(e,t,r){var n=e("../internals/an-object"),i=e("../internals/get-iterator-method");t.exports=function(e){var t=i(e);if("function"!=typeof t)throw TypeError(String(e)+" is not iterable");return n(t.call(e))}},{"../internals/an-object":10,"../internals/get-iterator-method":57}],59:[function(e,t,n){(function(e){function r(e){return e&&e.Math==Math&&e}t.exports=r("object"==typeof globalThis&&globalThis)||r("object"==typeof window&&window)||r("object"==typeof self&&self)||r("object"==typeof e&&e)||Function("return this")()}).call(this,void 0!==r.g?r.g:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],60:[function(e,t,r){var n={}.hasOwnProperty;t.exports=function(e,t){return n.call(e,t)}},{}],61:[function(e,t,r){t.exports={}},{}],62:[function(e,t,r){var n=e("../internals/global");t.exports=function(e,t){var r=n.console;r&&r.error&&(1===arguments.length?r.error(e):r.error(e,t))}},{"../internals/global":59}],63:[function(e,t,r){e=e("../internals/get-built-in"),t.exports=e("document","documentElement")},{"../internals/get-built-in":56}],64:[function(e,t,r){var n=e("../internals/descriptors"),i=e("../internals/fails"),s=e("../internals/document-create-element");t.exports=!n&&!i((function(){return 7!=Object.defineProperty(s("div"),"a",{get:function(){return 7}}).a}))},{"../internals/descriptors":43,"../internals/document-create-element":44,"../internals/fails":51}],65:[function(e,t,r){var n=Math.abs,i=Math.pow,s=Math.floor,o=Math.log,a=Math.LN2;t.exports={pack:function(e,t,r){var l,c,u,h=new Array(r),d=8*r-t-1,p=(r=(1<<d)-1)>>1,f=23===t?i(2,-24)-i(2,-77):0,m=e<0||0===e&&1/e<0?1:0,g=0;for((e=n(e))!=e||e===1/0?(c=e!=e?1:0,l=r):(l=s(o(e)/a),e*(u=i(2,-l))<1&&(l--,u*=2),2<=(e+=1<=l+p?f/u:f*i(2,1-p))*u&&(l++,u/=2),r<=l+p?(c=0,l=r):1<=l+p?(c=(e*u-1)*i(2,t),l+=p):(c=e*i(2,p-1)*i(2,t),l=0));8<=t;h[g++]=255&c,c/=256,t-=8);for(l=l<<t|c,d+=t;0<d;h[g++]=255&l,l/=256,d-=8);return h[--g]|=128*m,h},unpack:function(e,t){var r,n,s=e.length,o=(1<<(n=8*s-t-1))-1,a=o>>1,l=n-7,c=s-1,u=127&(n=e[c--]);for(n>>=7;0<l;u=256*u+e[c],c--,l-=8);for(r=u&(1<<-l)-1,u>>=-l,l+=t;0<l;r=256*r+e[c],c--,l-=8);if(0===u)u=1-a;else{if(u===o)return r?NaN:n?-1/0:1/0;r+=i(2,t),u-=a}return(n?-1:1)*r*i(2,u-t)}}},{}],66:[function(e,t,r){var n=e("../internals/fails"),i=e("../internals/classof-raw"),s="".split;t.exports=n((function(){return!Object("z").propertyIsEnumerable(0)}))?function(e){return"String"==i(e)?s.call(e,""):Object(e)}:Object},{"../internals/classof-raw":28,"../internals/fails":51}],67:[function(e,t,r){var n=e("../internals/is-object"),i=e("../internals/object-set-prototype-of");t.exports=function(e,t,r){return i&&"function"==typeof(t=t.constructor)&&t!==r&&n(t=t.prototype)&&t!==r.prototype&&i(e,t),e}},{"../internals/is-object":74,"../internals/object-set-prototype-of":101}],68:[function(e,t,r){e=e("../internals/shared-store");var n=Function.toString;"function"!=typeof e.inspectSource&&(e.inspectSource=function(e){return n.call(e)}),t.exports=e.inspectSource},{"../internals/shared-store":119}],69:[function(e,t,r){function n(e){a(e,u,{value:{objectID:"O"+ ++h,weakData:{}}})}var i=e("../internals/hidden-keys"),s=e("../internals/is-object"),o=e("../internals/has"),a=e("../internals/object-define-property").f,l=e("../internals/uid"),c=e("../internals/freezing"),u=l("meta"),h=0,d=Object.isExtensible||function(){return!0},p=t.exports={REQUIRED:!1,fastKey:function(e,t){if(!s(e))return"symbol"==typeof e?e:("string"==typeof e?"S":"P")+e;if(!o(e,u)){if(!d(e))return"F";if(!t)return"E";n(e)}return e[u].objectID},getWeakData:function(e,t){if(!o(e,u)){if(!d(e))return!0;if(!t)return!1;n(e)}return e[u].weakData},onFreeze:function(e){return c&&p.REQUIRED&&d(e)&&!o(e,u)&&n(e),e}};i[u]=!0},{"../internals/freezing":53,"../internals/has":60,"../internals/hidden-keys":61,"../internals/is-object":74,"../internals/object-define-property":92,"../internals/uid":143}],70:[function(e,t,r){var n,i,s,o,a,l,c,u,h=e("../internals/native-weak-map"),d=e("../internals/global"),p=e("../internals/is-object"),f=e("../internals/create-non-enumerable-property"),m=e("../internals/has"),g=e("../internals/shared-key");e=e("../internals/hidden-keys"),d=d.WeakMap;c=h?(n=new d,i=n.get,s=n.has,o=n.set,a=function(e,t){return o.call(n,e,t),t},l=function(e){return i.call(n,e)||{}},function(e){return s.call(n,e)}):(e[u=g("state")]=!0,a=function(e,t){return f(e,u,t),t},l=function(e){return m(e,u)?e[u]:{}},function(e){return m(e,u)}),t.exports={set:a,get:l,has:c,enforce:function(e){return c(e)?l(e):a(e,{})},getterFor:function(e){return function(t){if(p(t)&&(t=l(t)).type===e)return t;throw TypeError("Incompatible receiver, "+e+" required")}}}},{"../internals/create-non-enumerable-property":38,"../internals/global":59,"../internals/has":60,"../internals/hidden-keys":61,"../internals/is-object":74,"../internals/native-weak-map":85,"../internals/shared-key":118}],71:[function(e,t,r){var n=e("../internals/well-known-symbol"),i=e("../internals/iterators"),s=n("iterator"),o=Array.prototype;t.exports=function(e){return void 0!==e&&(i.Array===e||o[s]===e)}},{"../internals/iterators":79,"../internals/well-known-symbol":146}],72:[function(e,t,r){var n=e("../internals/classof-raw");t.exports=Array.isArray||function(e){return"Array"==n(e)}},{"../internals/classof-raw":28}],73:[function(e,t,r){function n(e,t){return(e=a[o(e)])==c||e!=l&&("function"==typeof t?i(t):!!t)}var i=e("../internals/fails"),s=/#|\.prototype\./,o=n.normalize=function(e){return String(e).replace(s,".").toLowerCase()},a=n.data={},l=n.NATIVE="N",c=n.POLYFILL="P";t.exports=n},{"../internals/fails":51}],74:[function(e,t,r){t.exports=function(e){return"object"==typeof e?null!==e:"function"==typeof e}},{}],75:[function(e,t,r){t.exports=!1},{}],76:[function(e,t,r){var n=e("../internals/is-object"),i=e("../internals/classof-raw"),s=e("../internals/well-known-symbol")("match");t.exports=function(e){var t;return n(e)&&(void 0!==(t=e[s])?!!t:"RegExp"==i(e))}},{"../internals/classof-raw":28,"../internals/is-object":74,"../internals/well-known-symbol":146}],77:[function(e,t,r){function n(e,t){this.stopped=e,this.result=t}var i=e("../internals/an-object"),s=e("../internals/is-array-iterator-method"),o=e("../internals/to-length"),a=e("../internals/function-bind-context"),l=e("../internals/get-iterator-method"),c=e("../internals/call-with-safe-iteration-closing");(t.exports=function(e,t,r,u,h){var d,p,f,m,g,y,v=a(t,r,u?2:1);if(h)d=e;else{if("function"!=typeof(t=l(e)))throw TypeError("Target is not iterable");if(s(t)){for(p=0,f=o(e.length);p<f;p++)if((m=u?v(i(y=e[p])[0],y[1]):v(e[p]))&&m instanceof n)return m;return new n(!1)}d=t.call(e)}for(g=d.next;!(y=g.call(d)).done;)if("object"==typeof(m=c(d,v,y.value,u))&&m&&m instanceof n)return m;return new n(!1)}).stop=function(e){return new n(!0,e)}},{"../internals/an-object":10,"../internals/call-with-safe-iteration-closing":26,"../internals/function-bind-context":54,"../internals/get-iterator-method":57,"../internals/is-array-iterator-method":71,"../internals/to-length":134}],78:[function(e,t,r){"use strict";var n,i,s=e("../internals/object-get-prototype-of"),o=e("../internals/create-non-enumerable-property"),a=e("../internals/has"),l=e("../internals/well-known-symbol"),c=(e=e("../internals/is-pure"),l=l("iterator"),!1);[].keys&&("next"in(i=[].keys())?(s=s(s(i)))!==Object.prototype&&(n=s):c=!0),null==n&&(n={}),e||a(n,l)||o(n,l,(function(){return this})),t.exports={IteratorPrototype:n,BUGGY_SAFARI_ITERATORS:c}},{"../internals/create-non-enumerable-property":38,"../internals/has":60,"../internals/is-pure":75,"../internals/object-get-prototype-of":97,"../internals/well-known-symbol":146}],79:[function(e,t,r){t.exports={}},{}],80:[function(e,t,r){t.exports=Math.sign||function(e){return 0==(e=+e)||e!=e?e:e<0?-1:1}},{}],81:[function(e,t,r){var n,i,s,o,a,l,c,u,h=e("../internals/global"),d=e("../internals/object-get-own-property-descriptor").f,p=e("../internals/classof-raw"),f=e("../internals/task").set,m=(e=e("../internals/engine-is-ios"),h.MutationObserver||h.WebKitMutationObserver),g=h.process,y=h.Promise,v="process"==p(g);p=d(h,"queueMicrotask");(d=p&&p.value)||(n=function(){var e,t;for(v&&(e=g.domain)&&e.exit();i;){t=i.fn,i=i.next;try{t()}catch(e){throw i?o():s=void 0,e}}s=void 0,e&&e.enter()},o=v?function(){g.nextTick(n)}:m&&!e?(a=!0,l=document.createTextNode(""),new m(n).observe(l,{characterData:!0}),function(){l.data=a=!a}):y&&y.resolve?(c=y.resolve(void 0),u=c.then,function(){u.call(c,n)}):function(){f.call(h,n)}),t.exports=d||function(e){e={fn:e,next:void 0},s&&(s.next=e),i||(i=e,o()),s=e}},{"../internals/classof-raw":28,"../internals/engine-is-ios":46,"../internals/global":59,"../internals/object-get-own-property-descriptor":93,"../internals/task":128}],82:[function(e,t,r){e=e("../internals/global"),t.exports=e.Promise},{"../internals/global":59}],83:[function(e,t,r){e=e("../internals/fails"),t.exports=!!Object.getOwnPropertySymbols&&!e((function(){return!String(Symbol())}))},{"../internals/fails":51}],84:[function(e,t,r){var n=e("../internals/fails"),i=e("../internals/well-known-symbol"),s=e("../internals/is-pure"),o=i("iterator");t.exports=!n((function(){var e=new URL("b?a=1&b=2&c=3","http://a"),t=e.searchParams,r="";return e.pathname="c%20d",t.forEach((function(e,n){t.delete("b"),r+=n+e})),s&&!e.toJSON||!t.sort||"http://a/c%20d?a=1&c=3"!==e.href||"3"!==t.get("c")||"a=1"!==String(new URLSearchParams("?a=1"))||!t[o]||"a"!==new URL("https://a@b").username||"b"!==new URLSearchParams(new URLSearchParams("a=b")).get("a")||"xn--e1aybc"!==new URL("http://тест").host||"#%D0%B1"!==new URL("http://a#б").hash||"a1c3"!==r||"x"!==new URL("http://x",void 0).host}))},{"../internals/fails":51,"../internals/is-pure":75,"../internals/well-known-symbol":146}],85:[function(e,t,r){var n=e("../internals/global");e=e("../internals/inspect-source"),n=n.WeakMap;t.exports="function"==typeof n&&/native code/.test(e(n))},{"../internals/global":59,"../internals/inspect-source":68}],86:[function(e,t,r){"use strict";function n(e){var t,r;this.promise=new e((function(e,n){if(void 0!==t||void 0!==r)throw TypeError("Bad Promise constructor");t=e,r=n})),this.resolve=i(t),this.reject=i(r)}var i=e("../internals/a-function");t.exports.f=function(e){return new n(e)}},{"../internals/a-function":5}],87:[function(e,t,r){var n=e("../internals/is-regexp");t.exports=function(e){if(n(e))throw TypeError("The method doesn't accept regular expressions");return e}},{"../internals/is-regexp":76}],88:[function(e,t,r){var n=e("../internals/global").isFinite;t.exports=Number.isFinite||function(e){return"number"==typeof e&&n(e)}},{"../internals/global":59}],89:[function(e,t,r){"use strict";var n=e("../internals/descriptors"),i=e("../internals/fails"),s=e("../internals/object-keys"),o=e("../internals/object-get-own-property-symbols"),a=e("../internals/object-property-is-enumerable"),l=e("../internals/to-object"),c=e("../internals/indexed-object"),u=Object.assign,h=Object.defineProperty;t.exports=!u||i((function(){var e,t,r,i;return!(!n||1===u({b:1},u(h({},"a",{enumerable:!0,get:function(){h(this,"b",{value:3,enumerable:!1})}}),{b:2})).b)||(t={},i="abcdefghijklmnopqrst",(e={})[r=Symbol()]=7,i.split("").forEach((function(e){t[e]=e})),7!=u({},e)[r]||s(u({},t)).join("")!=i)}))?function(e,t){for(var r=l(e),i=arguments.length,u=1,h=o.f,d=a.f;u<i;)for(var p,f=c(arguments[u++]),m=h?s(f).concat(h(f)):s(f),g=m.length,y=0;y<g;)p=m[y++],n&&!d.call(f,p)||(r[p]=f[p]);return r}:u},{"../internals/descriptors":43,"../internals/fails":51,"../internals/indexed-object":66,"../internals/object-get-own-property-symbols":96,"../internals/object-keys":99,"../internals/object-property-is-enumerable":100,"../internals/to-object":135}],90:[function(e,t,r){function n(){}var i,s=e("../internals/an-object"),o=e("../internals/object-define-properties"),a=e("../internals/enum-bug-keys"),l=e("../internals/hidden-keys"),c=e("../internals/html"),u=e("../internals/document-create-element"),h=(e=e("../internals/shared-key"),"prototype"),d="script",p=e("IE_PROTO"),f=function(e){return"<"+d+">"+e+"</"+d+">"},m=function(){try{i=document.domain&&new ActiveXObject("htmlfile")}catch(e){}m=i?((e=i).write(f("")),e.close(),t=e.parentWindow.Object,e=null,t):(e=u("iframe"),t="java"+d+":",e.style.display="none",c.appendChild(e),e.src=String(t),(t=e.contentWindow.document).open(),t.write(f("document.F=Object")),t.close(),t.F);for(var e,t,r=a.length;r--;)delete m[h][a[r]];return m()};l[p]=!0,t.exports=Object.create||function(e,t){var r;return null!==e?(n[h]=s(e),r=new n,n[h]=null,r[p]=e):r=m(),void 0===t?r:o(r,t)}},{"../internals/an-object":10,"../internals/document-create-element":44,"../internals/enum-bug-keys":49,"../internals/hidden-keys":61,"../internals/html":63,"../internals/object-define-properties":91,"../internals/shared-key":118}],91:[function(e,t,r){var n=e("../internals/descriptors"),i=e("../internals/object-define-property"),s=e("../internals/an-object"),o=e("../internals/object-keys");t.exports=n?Object.defineProperties:function(e,t){s(e);for(var r,n=o(t),a=n.length,l=0;l<a;)i.f(e,r=n[l++],t[r]);return e}},{"../internals/an-object":10,"../internals/descriptors":43,"../internals/object-define-property":92,"../internals/object-keys":99}],92:[function(e,t,r){var n=e("../internals/descriptors"),i=e("../internals/ie8-dom-define"),s=e("../internals/an-object"),o=e("../internals/to-primitive"),a=Object.defineProperty;r.f=n?a:function(e,t,r){if(s(e),t=o(t,!0),s(r),i)try{return a(e,t,r)}catch(e){}if("get"in r||"set"in r)throw TypeError("Accessors not supported");return"value"in r&&(e[t]=r.value),e}},{"../internals/an-object":10,"../internals/descriptors":43,"../internals/ie8-dom-define":64,"../internals/to-primitive":138}],93:[function(e,t,r){var n=e("../internals/descriptors"),i=e("../internals/object-property-is-enumerable"),s=e("../internals/create-property-descriptor"),o=e("../internals/to-indexed-object"),a=e("../internals/to-primitive"),l=e("../internals/has"),c=e("../internals/ie8-dom-define"),u=Object.getOwnPropertyDescriptor;r.f=n?u:function(e,t){if(e=o(e),t=a(t,!0),c)try{return u(e,t)}catch(e){}if(l(e,t))return s(!i.f.call(e,t),e[t])}},{"../internals/create-property-descriptor":39,"../internals/descriptors":43,"../internals/has":60,"../internals/ie8-dom-define":64,"../internals/object-property-is-enumerable":100,"../internals/to-indexed-object":132,"../internals/to-primitive":138}],94:[function(e,t,r){var n=e("../internals/to-indexed-object"),i=e("../internals/object-get-own-property-names").f,s={}.toString,o="object"==typeof window&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[];t.exports.f=function(e){if(!o||"[object Window]"!=s.call(e))return i(n(e));try{return i(e)}catch(e){return o.slice()}}},{"../internals/object-get-own-property-names":95,"../internals/to-indexed-object":132}],95:[function(e,t,r){var n=e("../internals/object-keys-internal"),i=e("../internals/enum-bug-keys").concat("length","prototype");r.f=Object.getOwnPropertyNames||function(e){return n(e,i)}},{"../internals/enum-bug-keys":49,"../internals/object-keys-internal":98}],96:[function(e,t,r){r.f=Object.getOwnPropertySymbols},{}],97:[function(e,t,r){var n=e("../internals/has"),i=e("../internals/to-object"),s=e("../internals/shared-key"),o=(e=e("../internals/correct-prototype-getter"),s("IE_PROTO")),a=Object.prototype;t.exports=e?Object.getPrototypeOf:function(e){return e=i(e),n(e,o)?e[o]:"function"==typeof e.constructor&&e instanceof e.constructor?e.constructor.prototype:e instanceof Object?a:null}},{"../internals/correct-prototype-getter":35,"../internals/has":60,"../internals/shared-key":118,"../internals/to-object":135}],98:[function(e,t,r){var n=e("../internals/has"),i=e("../internals/to-indexed-object"),s=e("../internals/array-includes").indexOf,o=e("../internals/hidden-keys");t.exports=function(e,t){var r,a=i(e),l=0,c=[];for(r in a)!n(o,r)&&n(a,r)&&c.push(r);for(;t.length>l;)!n(a,r=t[l++])||~s(c,r)||c.push(r);return c}},{"../internals/array-includes":18,"../internals/has":60,"../internals/hidden-keys":61,"../internals/to-indexed-object":132}],99:[function(e,t,r){var n=e("../internals/object-keys-internal"),i=e("../internals/enum-bug-keys");t.exports=Object.keys||function(e){return n(e,i)}},{"../internals/enum-bug-keys":49,"../internals/object-keys-internal":98}],100:[function(e,t,r){"use strict";var n={}.propertyIsEnumerable,i=Object.getOwnPropertyDescriptor,s=i&&!n.call({1:2},1);r.f=s?function(e){return!!(e=i(this,e))&&e.enumerable}:n},{}],101:[function(e,t,r){var n=e("../internals/an-object"),i=e("../internals/a-possible-prototype");t.exports=Object.setPrototypeOf||("__proto__"in{}?function(){var e,t=!1,r={};try{(e=Object.getOwnPropertyDescriptor(Object.prototype,"__proto__").set).call(r,[]),t=r instanceof Array}catch(r){}return function(r,s){return n(r),i(s),t?e.call(r,s):r.__proto__=s,r}}():void 0)},{"../internals/a-possible-prototype":6,"../internals/an-object":10}],102:[function(e,t,r){"use strict";var n=e("../internals/to-string-tag-support"),i=e("../internals/classof");t.exports=n?{}.toString:function(){return"[object "+i(this)+"]"}},{"../internals/classof":29,"../internals/to-string-tag-support":139}],103:[function(e,t,r){var n=e("../internals/get-built-in"),i=e("../internals/object-get-own-property-names"),s=e("../internals/object-get-own-property-symbols"),o=e("../internals/an-object");t.exports=n("Reflect","ownKeys")||function(e){var t=i.f(o(e)),r=s.f;return r?t.concat(r(e)):t}},{"../internals/an-object":10,"../internals/get-built-in":56,"../internals/object-get-own-property-names":95,"../internals/object-get-own-property-symbols":96}],104:[function(e,t,r){e=e("../internals/global"),t.exports=e},{"../internals/global":59}],105:[function(e,t,r){t.exports=function(e){try{return{error:!1,value:e()}}catch(e){return{error:!0,value:e}}}},{}],106:[function(e,t,r){var n=e("../internals/an-object"),i=e("../internals/is-object"),s=e("../internals/new-promise-capability");t.exports=function(e,t){return n(e),i(t)&&t.constructor===e?t:((0,(e=s.f(e)).resolve)(t),e.promise)}},{"../internals/an-object":10,"../internals/is-object":74,"../internals/new-promise-capability":86}],107:[function(e,t,r){var n=e("../internals/redefine");t.exports=function(e,t,r){for(var i in t)n(e,i,t[i],r);return e}},{"../internals/redefine":108}],108:[function(e,t,r){var n=e("../internals/global"),i=e("../internals/create-non-enumerable-property"),s=e("../internals/has"),o=e("../internals/set-global"),a=e("../internals/inspect-source"),l=(e=e("../internals/internal-state")).get,c=e.enforce,u=String(String).split("String");(t.exports=function(e,t,r,a){var l=!!a&&!!a.unsafe,h=!!a&&!!a.enumerable;a=!!a&&!!a.noTargetGet;"function"==typeof r&&("string"!=typeof t||s(r,"name")||i(r,"name",t),c(r).source=u.join("string"==typeof t?t:"")),e===n?h?e[t]=r:o(t,r):(l?!a&&e[t]&&(h=!0):delete e[t],h?e[t]=r:i(e,t,r))})(Function.prototype,"toString",(function(){return"function"==typeof this&&l(this).source||a(this)}))},{"../internals/create-non-enumerable-property":38,"../internals/global":59,"../internals/has":60,"../internals/inspect-source":68,"../internals/internal-state":70,"../internals/set-global":115}],109:[function(e,t,r){var n=e("./classof-raw"),i=e("./regexp-exec");t.exports=function(e,t){var r=e.exec;if("function"==typeof r){if("object"!=typeof(r=r.call(e,t)))throw TypeError("RegExp exec method returned something other than an Object or null");return r}if("RegExp"!==n(e))throw TypeError("RegExp#exec called on incompatible receiver");return i.call(e,t)}},{"./classof-raw":28,"./regexp-exec":110}],110:[function(e,t,r){"use strict";var n,i,s=e("./regexp-flags"),o=(e=e("./regexp-sticky-helpers"),RegExp.prototype.exec),a=String.prototype.replace,l=o,c=(n=/a/,i=/b*/g,o.call(n,"a"),o.call(i,"a"),0!==n.lastIndex||0!==i.lastIndex),u=e.UNSUPPORTED_Y||e.BROKEN_CARET,h=void 0!==/()??/.exec("")[1];t.exports=l=c||h||u?function(e){var t,r,n,i,l=this,d=u&&l.sticky,p=s.call(l),f=l.source,m=0,g=e;return d&&(-1===(p=p.replace("y","")).indexOf("g")&&(p+="g"),g=String(e).slice(l.lastIndex),0<l.lastIndex&&(!l.multiline||l.multiline&&"\n"!==e[l.lastIndex-1])&&(f="(?: "+f+")",g=" "+g,m++),r=new RegExp("^(?:"+f+")",p)),h&&(r=new RegExp("^"+f+"$(?!\\s)",p)),c&&(t=l.lastIndex),n=o.call(d?r:l,g),d?n?(n.input=n.input.slice(m),n[0]=n[0].slice(m),n.index=l.lastIndex,l.lastIndex+=n[0].length):l.lastIndex=0:c&&n&&(l.lastIndex=l.global?n.index+n[0].length:t),h&&n&&1<n.length&&a.call(n[0],r,(function(){for(i=1;i<arguments.length-2;i++)void 0===arguments[i]&&(n[i]=void 0)})),n}:l},{"./regexp-flags":111,"./regexp-sticky-helpers":112}],111:[function(e,t,r){"use strict";var n=e("../internals/an-object");t.exports=function(){var e=n(this),t="";return e.global&&(t+="g"),e.ignoreCase&&(t+="i"),e.multiline&&(t+="m"),e.dotAll&&(t+="s"),e.unicode&&(t+="u"),e.sticky&&(t+="y"),t}},{"../internals/an-object":10}],112:[function(e,t,r){"use strict";function n(e,t){return RegExp(e,t)}e=e("./fails"),r.UNSUPPORTED_Y=e((function(){var e=n("a","y");return e.lastIndex=2,null!=e.exec("abcd")})),r.BROKEN_CARET=e((function(){var e=n("^r","gy");return e.lastIndex=2,null!=e.exec("str")}))},{"./fails":51}],113:[function(e,t,r){t.exports=function(e){if(null==e)throw TypeError("Can't call method on "+e);return e}},{}],114:[function(e,t,r){t.exports=Object.is||function(e,t){return e===t?0!==e||1/e==1/t:e!=e&&t!=t}},{}],115:[function(e,t,r){var n=e("../internals/global"),i=e("../internals/create-non-enumerable-property");t.exports=function(e,t){try{i(n,e,t)}catch(r){n[e]=t}return t}},{"../internals/create-non-enumerable-property":38,"../internals/global":59}],116:[function(e,t,r){"use strict";var n=e("../internals/get-built-in"),i=e("../internals/object-define-property"),s=e("../internals/well-known-symbol"),o=e("../internals/descriptors"),a=s("species");t.exports=function(e){e=n(e);var t=i.f;o&&e&&!e[a]&&t(e,a,{configurable:!0,get:function(){return this}})}},{"../internals/descriptors":43,"../internals/get-built-in":56,"../internals/object-define-property":92,"../internals/well-known-symbol":146}],117:[function(e,t,r){var n=e("../internals/object-define-property").f,i=e("../internals/has"),s=e("../internals/well-known-symbol")("toStringTag");t.exports=function(e,t,r){e&&!i(e=r?e:e.prototype,s)&&n(e,s,{configurable:!0,value:t})}},{"../internals/has":60,"../internals/object-define-property":92,"../internals/well-known-symbol":146}],118:[function(e,t,r){var n=e("../internals/shared"),i=e("../internals/uid"),s=n("keys");t.exports=function(e){return s[e]||(s[e]=i(e))}},{"../internals/shared":120,"../internals/uid":143}],119:[function(e,t,r){var n=e("../internals/global"),i=(e=e("../internals/set-global"),"__core-js_shared__");n=n[i]||e(i,{});t.exports=n},{"../internals/global":59,"../internals/set-global":115}],120:[function(e,t,r){var n=e("../internals/is-pure"),i=e("../internals/shared-store");(t.exports=function(e,t){return i[e]||(i[e]=void 0!==t?t:{})})("versions",[]).push({version:"3.6.5",mode:n?"pure":"global",copyright:"© 2020 Denis Pushkarev (zloirock.ru)"})},{"../internals/is-pure":75,"../internals/shared-store":119}],121:[function(e,t,r){var n=e("../internals/an-object"),i=e("../internals/a-function"),s=e("../internals/well-known-symbol")("species");t.exports=function(e,t){return void 0===(e=n(e).constructor)||null==(e=n(e)[s])?t:i(e)}},{"../internals/a-function":5,"../internals/an-object":10,"../internals/well-known-symbol":146}],122:[function(e,t,r){var n=e("../internals/fails");t.exports=function(e){return n((function(){var t=""[e]('"');return t!==t.toLowerCase()||3<t.split('"').length}))}},{"../internals/fails":51}],123:[function(e,t,r){function n(e){return function(t,r){t=String(s(t)),r=i(r);var n,o=t.length;return r<0||o<=r?e?"":void 0:(n=t.charCodeAt(r))<55296||56319<n||r+1===o||(o=t.charCodeAt(r+1))<56320||57343<o?e?t.charAt(r):n:e?t.slice(r,r+2):o-56320+(n-55296<<10)+65536}}var i=e("../internals/to-integer"),s=e("../internals/require-object-coercible");t.exports={codeAt:n(!1),charAt:n(!0)}},{"../internals/require-object-coercible":113,"../internals/to-integer":133}],124:[function(e,t,r){"use strict";function n(e){return e+22+75*(e<26)}function i(e){var t,r=[],i=(e=function(e){for(var t=[],r=0,n=e.length;r<n;){var i,s=e.charCodeAt(r++);55296<=s&&s<=56319&&r<n?56320==(64512&(i=e.charCodeAt(r++)))?t.push(((1023&s)<<10)+(1023&i)+65536):(t.push(s),r--):t.push(s)}return t}(e)).length,u=128,h=0,g=72;for(x=0;x<e.length;x++)(t=e[x])<128&&r.push(m(t));var y=r.length,v=y;for(y&&r.push("-");v<i;){for(var _=s,x=0;x<e.length;x++)u<=(t=e[x])&&t<_&&(_=t);var b=v+1;if(_-u>f((s-h)/b))throw RangeError(d);for(h+=(_-u)*b,u=_,x=0;x<e.length;x++){if((t=e[x])<u&&++h>s)throw RangeError(d);if(t==u){for(var w=h,S=o;;S+=o){var M=S<=g?1:g+a<=S?a:S-g;if(w<M)break;var T=w-M,E=o-M;r.push(m(n(M+T%E))),w=f(T/E)}r.push(m(n(w))),g=function(e,t,r){var n=0;for(e=r?f(e/c):e>>1,e+=f(e/t);p*a>>1<e;n+=o)e=f(e/p);return f(n+(p+1)*e/(e+l))}(h,b,v==y),h=0,++v}}++h,++u}return r.join("")}var s=2147483647,o=36,a=26,l=38,c=700,u=/[^\0-\u007E]/,h=/[.\u3002\uFF0E\uFF61]/g,d="Overflow: input needs wider integers to process",p=o-1,f=Math.floor,m=String.fromCharCode;t.exports=function(e){for(var t,r=[],n=e.toLowerCase().replace(h,".").split("."),s=0;s<n.length;s++)t=n[s],r.push(u.test(t)?"xn--"+i(t):t);return r.join(".")}},{}],125:[function(e,t,r){"use strict";var n=e("../internals/to-integer"),i=e("../internals/require-object-coercible");t.exports="".repeat||function(e){var t=String(i(this)),r="",s=n(e);if(s<0||s==1/0)throw RangeError("Wrong number of repetitions");for(;0<s;(s>>>=1)&&(t+=t))1&s&&(r+=t);return r}},{"../internals/require-object-coercible":113,"../internals/to-integer":133}],126:[function(e,t,r){var n=e("../internals/fails"),i=e("../internals/whitespaces");t.exports=function(e){return n((function(){return!!i[e]()||"​᠎"!="​᠎"[e]()||i[e].name!==e}))}},{"../internals/fails":51,"../internals/whitespaces":147}],127:[function(e,t,r){function n(e){return function(t){return t=String(i(t)),1&e&&(t=t.replace(s,"")),2&e?t.replace(o,""):t}}var i=e("../internals/require-object-coercible"),s=(e="["+e("../internals/whitespaces")+"]",RegExp("^"+e+e+"*")),o=RegExp(e+e+"*$");t.exports={start:n(1),end:n(2),trim:n(3)}},{"../internals/require-object-coercible":113,"../internals/whitespaces":147}],128:[function(e,t,r){function n(e){return function(){w(e)}}function i(e){w(e.data)}function s(e){a.postMessage(e+"",p.protocol+"//"+p.host)}var o,a=e("../internals/global"),l=e("../internals/fails"),c=e("../internals/classof-raw"),u=e("../internals/function-bind-context"),h=e("../internals/html"),d=e("../internals/document-create-element"),p=(e=e("../internals/engine-is-ios"),a.location),f=a.setImmediate,m=a.clearImmediate,g=a.process,y=a.MessageChannel,v=a.Dispatch,_=0,x={},b="onreadystatechange",w=function(e){var t;x.hasOwnProperty(e)&&(t=x[e],delete x[e],t())};f&&m||(f=function(e){for(var t=[],r=1;r<arguments.length;)t.push(arguments[r++]);return x[++_]=function(){("function"==typeof e?e:Function(e)).apply(void 0,t)},o(_),_},m=function(e){delete x[e]},"process"==c(g)?o=function(e){g.nextTick(n(e))}:v&&v.now?o=function(e){v.now(n(e))}:y&&!e?(e=(c=new y).port2,c.port1.onmessage=i,o=u(e.postMessage,e,1)):!a.addEventListener||"function"!=typeof postMessage||a.importScripts||l(s)||"file:"===p.protocol?o=b in d("script")?function(e){h.appendChild(d("script"))[b]=function(){h.removeChild(this),w(e)}}:function(e){setTimeout(n(e),0)}:(o=s,a.addEventListener("message",i,!1))),t.exports={set:f,clear:m}},{"../internals/classof-raw":28,"../internals/document-create-element":44,"../internals/engine-is-ios":46,"../internals/fails":51,"../internals/function-bind-context":54,"../internals/global":59,"../internals/html":63}],129:[function(e,t,r){var n=e("../internals/classof-raw");t.exports=function(e){if("number"!=typeof e&&"Number"!=n(e))throw TypeError("Incorrect invocation");return+e}},{"../internals/classof-raw":28}],130:[function(e,t,r){var n=e("../internals/to-integer"),i=Math.max,s=Math.min;t.exports=function(e,t){return(e=n(e))<0?i(e+t,0):s(e,t)}},{"../internals/to-integer":133}],131:[function(e,t,r){var n=e("../internals/to-integer"),i=e("../internals/to-length");t.exports=function(e){if(void 0===e)return 0;e=n(e);var t=i(e);if(e!==t)throw RangeError("Wrong length or index");return t}},{"../internals/to-integer":133,"../internals/to-length":134}],132:[function(e,t,r){var n=e("../internals/indexed-object"),i=e("../internals/require-object-coercible");t.exports=function(e){return n(i(e))}},{"../internals/indexed-object":66,"../internals/require-object-coercible":113}],133:[function(e,t,r){var n=Math.ceil,i=Math.floor;t.exports=function(e){return isNaN(e=+e)?0:(0<e?i:n)(e)}},{}],134:[function(e,t,r){var n=e("../internals/to-integer"),i=Math.min;t.exports=function(e){return 0<e?i(n(e),9007199254740991):0}},{"../internals/to-integer":133}],135:[function(e,t,r){var n=e("../internals/require-object-coercible");t.exports=function(e){return Object(n(e))}},{"../internals/require-object-coercible":113}],136:[function(e,t,r){var n=e("../internals/to-positive-integer");t.exports=function(e,t){if((e=n(e))%t)throw RangeError("Wrong offset");return e}},{"../internals/to-positive-integer":137}],137:[function(e,t,r){var n=e("../internals/to-integer");t.exports=function(e){if((e=n(e))<0)throw RangeError("The argument can't be less than 0");return e}},{"../internals/to-integer":133}],138:[function(e,t,r){var n=e("../internals/is-object");t.exports=function(e,t){if(!n(e))return e;var r,i;if(t&&"function"==typeof(r=e.toString)&&!n(i=r.call(e))||"function"==typeof(r=e.valueOf)&&!n(i=r.call(e))||!t&&"function"==typeof(r=e.toString)&&!n(i=r.call(e)))return i;throw TypeError("Can't convert object to primitive value")}},{"../internals/is-object":74}],139:[function(e,t,r){var n={};n[e("../internals/well-known-symbol")("toStringTag")]="z",t.exports="[object z]"===String(n)},{"../internals/well-known-symbol":146}],140:[function(e,t,r){"use strict";function n(e,t){for(var r=0,n=t.length,i=new(q(e))(n);r<n;)i[r]=t[r++];return i}function i(e,t){U(e,t,{get:function(){return O(this)[t]}})}function s(e){return e instanceof z||"ArrayBuffer"==(e=S(e))||"SharedArrayBuffer"==e}function o(e,t){return Y(e)&&"symbol"!=typeof t&&t in e&&String(+t)==String(t)}function a(e,t){return o(e,t=b(t,!0))?g(2,e[t]):k(e,t)}function l(e,t,r){return!(o(e,t=b(t,!0))&&M(r)&&w(r,"value"))||w(r,"get")||w(r,"set")||r.configurable||w(r,"writable")&&!r.writable||w(r,"enumerable")&&!r.enumerable?U(e,t,r):(e[t]=r.value,e)}var c=e("../internals/export"),u=e("../internals/global"),h=e("../internals/descriptors"),d=e("../internals/typed-array-constructors-require-wrappers"),p=e("../internals/array-buffer-view-core"),f=e("../internals/array-buffer"),m=e("../internals/an-instance"),g=e("../internals/create-property-descriptor"),y=e("../internals/create-non-enumerable-property"),v=e("../internals/to-length"),_=e("../internals/to-index"),x=e("../internals/to-offset"),b=e("../internals/to-primitive"),w=e("../internals/has"),S=e("../internals/classof"),M=e("../internals/is-object"),T=e("../internals/object-create"),E=e("../internals/object-set-prototype-of"),A=e("../internals/object-get-own-property-names").f,C=e("../internals/typed-array-from"),L=e("../internals/array-iteration").forEach,R=e("../internals/set-species"),P=e("../internals/object-define-property"),j=e("../internals/object-get-own-property-descriptor"),I=e("../internals/internal-state"),D=e("../internals/inherit-if-required"),O=I.get,N=I.set,U=P.f,k=j.f,F=Math.round,B=u.RangeError,z=f.ArrayBuffer,G=f.DataView,V=p.NATIVE_ARRAY_BUFFER_VIEWS,H=p.TYPED_ARRAY_TAG,W=p.TypedArray,X=p.TypedArrayPrototype,q=p.aTypedArrayConstructor,Y=p.isTypedArray,Z="BYTES_PER_ELEMENT",J="Wrong length";h?(V||(j.f=a,P.f=l,i(X,"buffer"),i(X,"byteOffset"),i(X,"byteLength"),i(X,"length")),c({target:"Object",stat:!0,forced:!V},{getOwnPropertyDescriptor:a,defineProperty:l}),t.exports=function(e,t,r){function i(e,t){U(e,t,{get:function(){var e=this,r=t;return(e=O(e)).view[l](r*o+e.byteOffset,!0)},set:function(e){var n=this,i=t;n=O(n),r&&(e=(e=F(e))<0?0:255<e?255:255&e),n.view[h](i*o+n.byteOffset,e,!0)},enumerable:!0})}var o=e.match(/\d+$/)[0]/8,a=e+(r?"Clamped":"")+"Array",l="get"+e,h="set"+e,p=u[a],f=p,g=(e=f&&f.prototype,{});V?d&&(f=t((function(e,t,r,i){return m(e,f,a),D(M(t)?s(t)?void 0!==i?new p(t,x(r,o),i):void 0!==r?new p(t,x(r,o)):new p(t):Y(t)?n(f,t):C.call(f,t):new p(_(t)),e,f)})),E&&E(f,W),L(A(p),(function(e){e in f||y(f,e,p[e])})),f.prototype=e):(f=t((function(e,t,r,l){m(e,f,a);var c,u,h=0,d=0;if(M(t)){if(!s(t))return Y(t)?n(f,t):C.call(f,t);var p=t;d=x(r,o),r=t.byteLength;if(void 0===l){if(r%o)throw B(J);if((c=r-d)<0)throw B(J)}else if(r<(c=v(l)*o)+d)throw B(J);u=c/o}else u=_(t),p=new z(c=u*o);for(N(e,{buffer:p,byteOffset:d,byteLength:c,length:u,view:new G(p)});h<u;)i(e,h++)})),E&&E(f,W),e=f.prototype=T(X)),e.constructor!==f&&y(e,"constructor",f),H&&y(e,H,a),g[a]=f,c({global:!0,forced:f!=p,sham:!V},g),Z in f||y(f,Z,o),Z in e||y(e,Z,o),R(a)}):t.exports=function(){}},{"../internals/an-instance":9,"../internals/array-buffer":13,"../internals/array-buffer-view-core":12,"../internals/array-iteration":19,"../internals/classof":29,"../internals/create-non-enumerable-property":38,"../internals/create-property-descriptor":39,"../internals/descriptors":43,"../internals/export":50,"../internals/global":59,"../internals/has":60,"../internals/inherit-if-required":67,"../internals/internal-state":70,"../internals/is-object":74,"../internals/object-create":90,"../internals/object-define-property":92,"../internals/object-get-own-property-descriptor":93,"../internals/object-get-own-property-names":95,"../internals/object-set-prototype-of":101,"../internals/set-species":116,"../internals/to-index":131,"../internals/to-length":134,"../internals/to-offset":136,"../internals/to-primitive":138,"../internals/typed-array-constructors-require-wrappers":141,"../internals/typed-array-from":142}],141:[function(e,t,r){var n=e("../internals/global"),i=e("../internals/fails"),s=e("../internals/check-correctness-of-iteration"),o=(e=e("../internals/array-buffer-view-core").NATIVE_ARRAY_BUFFER_VIEWS,n.ArrayBuffer),a=n.Int8Array;t.exports=!e||!i((function(){a(1)}))||!i((function(){new a(-1)}))||!s((function(e){new a,new a(null),new a(1.5),new a(e)}),!0)||i((function(){return 1!==new a(new o(2),1,void 0).length}))},{"../internals/array-buffer-view-core":12,"../internals/check-correctness-of-iteration":27,"../internals/fails":51,"../internals/global":59}],142:[function(e,t,r){var n=e("../internals/to-object"),i=e("../internals/to-length"),s=e("../internals/get-iterator-method"),o=e("../internals/is-array-iterator-method"),a=e("../internals/function-bind-context"),l=e("../internals/array-buffer-view-core").aTypedArrayConstructor;t.exports=function(e){var t,r,c,u,h,d,p=n(e),f=arguments.length,m=1<f?arguments[1]:void 0,g=void 0!==m,y=s(p);if(null!=y&&!o(y))for(d=(h=y.call(p)).next,p=[];!(u=d.call(h)).done;)p.push(u.value);for(g&&2<f&&(m=a(m,arguments[2],2)),r=i(p.length),c=new(l(this))(r),t=0;t<r;t++)c[t]=g?m(p[t],t):p[t];return c}},{"../internals/array-buffer-view-core":12,"../internals/function-bind-context":54,"../internals/get-iterator-method":57,"../internals/is-array-iterator-method":71,"../internals/to-length":134,"../internals/to-object":135}],143:[function(e,t,r){var n=0,i=Math.random();t.exports=function(e){return"Symbol("+String(void 0===e?"":e)+")_"+(++n+i).toString(36)}},{}],144:[function(e,t,r){e=e("../internals/native-symbol"),t.exports=e&&!Symbol.sham&&"symbol"==typeof Symbol.iterator},{"../internals/native-symbol":83}],145:[function(e,t,r){e=e("../internals/well-known-symbol"),r.f=e},{"../internals/well-known-symbol":146}],146:[function(e,t,r){var n=e("../internals/global"),i=e("../internals/shared"),s=e("../internals/has"),o=e("../internals/uid"),a=e("../internals/native-symbol"),l=(e=e("../internals/use-symbol-as-uid"),i("wks")),c=n.Symbol,u=e?c:c&&c.withoutSetter||o;t.exports=function(e){return s(l,e)||(a&&s(c,e)?l[e]=c[e]:l[e]=u("Symbol."+e)),l[e]}},{"../internals/global":59,"../internals/has":60,"../internals/native-symbol":83,"../internals/shared":120,"../internals/uid":143,"../internals/use-symbol-as-uid":144}],147:[function(e,t,r){t.exports="\t\n\v\f\r                　\u2028\u2029\ufeff"},{}],148:[function(e,t,r){"use strict";var n=e("../internals/export"),i=e("../internals/global"),s=e("../internals/array-buffer"),o=(e=e("../internals/set-species"),"ArrayBuffer");s=s[o];n({global:!0,forced:i[o]!==s},{ArrayBuffer:s}),e(o)},{"../internals/array-buffer":13,"../internals/export":50,"../internals/global":59,"../internals/set-species":116}],149:[function(e,t,r){"use strict";var n=e("../internals/export"),i=e("../internals/fails"),s=e("../internals/is-array"),o=e("../internals/is-object"),a=e("../internals/to-object"),l=e("../internals/to-length"),c=e("../internals/create-property"),u=e("../internals/array-species-create"),h=e("../internals/array-method-has-species-support"),d=e("../internals/well-known-symbol"),p=(e=e("../internals/engine-v8-version"),d("isConcatSpreadable")),f=9007199254740991,m="Maximum allowed index exceeded";d=51<=e||!i((function(){var e=[];return e[p]=!1,e.concat()[0]!==e})),e=h("concat");n({target:"Array",proto:!0,forced:!d||!e},{concat:function(e){for(var t,r,n,i,h,d=a(this),g=u(d,0),y=0,v=-1,_=arguments.length;v<_;v++)if(h=void 0,o(i=n=-1===v?d:arguments[v])&&(void 0!==(h=i[p])?h:s(i))){if(r=l(n.length),f<y+r)throw TypeError(m);for(t=0;t<r;t++,y++)t in n&&c(g,y,n[t])}else{if(f<=y)throw TypeError(m);c(g,y++,n)}return g.length=y,g}})},{"../internals/array-method-has-species-support":21,"../internals/array-species-create":25,"../internals/create-property":40,"../internals/engine-v8-version":48,"../internals/export":50,"../internals/fails":51,"../internals/is-array":72,"../internals/is-object":74,"../internals/to-length":134,"../internals/to-object":135,"../internals/well-known-symbol":146}],150:[function(e,t,r){var n=e("../internals/export"),i=e("../internals/array-copy-within");e=e("../internals/add-to-unscopables");n({target:"Array",proto:!0},{copyWithin:i}),e("copyWithin")},{"../internals/add-to-unscopables":7,"../internals/array-copy-within":14,"../internals/export":50}],151:[function(e,t,r){"use strict";var n=e("../internals/export"),i=e("../internals/array-iteration").every,s=e("../internals/array-method-is-strict");e=e("../internals/array-method-uses-to-length"),s=s("every"),e=e("every");n({target:"Array",proto:!0,forced:!s||!e},{every:function(e){return i(this,e,1<arguments.length?arguments[1]:void 0)}})},{"../internals/array-iteration":19,"../internals/array-method-is-strict":22,"../internals/array-method-uses-to-length":23,"../internals/export":50}],152:[function(e,t,r){var n=e("../internals/export"),i=e("../internals/array-fill");e=e("../internals/add-to-unscopables");n({target:"Array",proto:!0},{fill:i}),e("fill")},{"../internals/add-to-unscopables":7,"../internals/array-fill":15,"../internals/export":50}],153:[function(e,t,r){"use strict";var n=e("../internals/export"),i=e("../internals/array-iteration").filter,s=e("../internals/array-method-has-species-support");e=e("../internals/array-method-uses-to-length"),s=s("filter"),e=e("filter");n({target:"Array",proto:!0,forced:!s||!e},{filter:function(e){return i(this,e,1<arguments.length?arguments[1]:void 0)}})},{"../internals/array-iteration":19,"../internals/array-method-has-species-support":21,"../internals/array-method-uses-to-length":23,"../internals/export":50}],154:[function(e,t,r){"use strict";var n=e("../internals/export");e=e("../internals/array-for-each");n({target:"Array",proto:!0,forced:[].forEach!=e},{forEach:e})},{"../internals/array-for-each":16,"../internals/export":50}],155:[function(e,t,r){var n=e("../internals/export"),i=e("../internals/array-from");n({target:"Array",stat:!0,forced:!e("../internals/check-correctness-of-iteration")((function(e){Array.from(e)}))},{from:i})},{"../internals/array-from":17,"../internals/check-correctness-of-iteration":27,"../internals/export":50}],156:[function(e,t,r){"use strict";var n=e("../internals/export"),i=e("../internals/array-includes").includes,s=e("../internals/add-to-unscopables");n({target:"Array",proto:!0,forced:!e("../internals/array-method-uses-to-length")("indexOf",{ACCESSORS:!0,1:0})},{includes:function(e){return i(this,e,1<arguments.length?arguments[1]:void 0)}}),s("includes")},{"../internals/add-to-unscopables":7,"../internals/array-includes":18,"../internals/array-method-uses-to-length":23,"../internals/export":50}],157:[function(e,t,r){"use strict";var n=e("../internals/export"),i=e("../internals/array-includes").indexOf,s=e("../internals/array-method-is-strict"),o=(e=e("../internals/array-method-uses-to-length"),[].indexOf),a=!!o&&1/[1].indexOf(1,-0)<0;s=s("indexOf"),e=e("indexOf",{ACCESSORS:!0,1:0});n({target:"Array",proto:!0,forced:a||!s||!e},{indexOf:function(e){return a?o.apply(this,arguments)||0:i(this,e,1<arguments.length?arguments[1]:void 0)}})},{"../internals/array-includes":18,"../internals/array-method-is-strict":22,"../internals/array-method-uses-to-length":23,"../internals/export":50}],158:[function(e,t,r){"use strict";var n=e("../internals/to-indexed-object"),i=e("../internals/add-to-unscopables"),s=e("../internals/iterators"),o=e("../internals/internal-state"),a=(e=e("../internals/define-iterator"),"Array Iterator"),l=o.set,c=o.getterFor(a);t.exports=e(Array,"Array",(function(e,t){l(this,{type:a,target:n(e),index:0,kind:t})}),(function(){var e=c(this),t=e.target,r=e.kind,n=e.index++;return!t||n>=t.length?{value:e.target=void 0,done:!0}:"keys"==r?{value:n,done:!1}:"values"==r?{value:t[n],done:!1}:{value:[n,t[n]],done:!1}}),"values"),s.Arguments=s.Array,i("keys"),i("values"),i("entries")},{"../internals/add-to-unscopables":7,"../internals/define-iterator":41,"../internals/internal-state":70,"../internals/iterators":79,"../internals/to-indexed-object":132}],159:[function(e,t,r){"use strict";var n=e("../internals/export"),i=e("../internals/indexed-object"),s=e("../internals/to-indexed-object"),o=(e=e("../internals/array-method-is-strict"),[].join);i=i!=Object,e=e("join",",");n({target:"Array",proto:!0,forced:i||!e},{join:function(e){return o.call(s(this),void 0===e?",":e)}})},{"../internals/array-method-is-strict":22,"../internals/export":50,"../internals/indexed-object":66,"../internals/to-indexed-object":132}],160:[function(e,t,r){e("../internals/export")({target:"Array",proto:!0,forced:(e=e("../internals/array-last-index-of"))!==[].lastIndexOf},{lastIndexOf:e})},{"../internals/array-last-index-of":20,"../internals/export":50}],161:[function(e,t,r){"use strict";var n=e("../internals/export"),i=e("../internals/array-iteration").map,s=e("../internals/array-method-has-species-support");e=e("../internals/array-method-uses-to-length"),s=s("map"),e=e("map");n({target:"Array",proto:!0,forced:!s||!e},{map:function(e){return i(this,e,1<arguments.length?arguments[1]:void 0)}})},{"../internals/array-iteration":19,"../internals/array-method-has-species-support":21,"../internals/array-method-uses-to-length":23,"../internals/export":50}],162:[function(e,t,r){"use strict";var n=e("../internals/export"),i=e("../internals/is-object"),s=e("../internals/is-array"),o=e("../internals/to-absolute-index"),a=e("../internals/to-length"),l=e("../internals/to-indexed-object"),c=e("../internals/create-property"),u=e("../internals/well-known-symbol"),h=e("../internals/array-method-has-species-support"),d=(e=e("../internals/array-method-uses-to-length"),h=h("slice"),e=e("slice",{ACCESSORS:!0,0:0,1:2}),u("species")),p=[].slice,f=Math.max;n({target:"Array",proto:!0,forced:!h||!e},{slice:function(e,t){var r,n,u,h=l(this),m=a(h.length),g=o(e,m),y=o(void 0===t?m:t,m);if(s(h)&&((r="function"==typeof(r=h.constructor)&&(r===Array||s(r.prototype))||i(r)&&null===(r=r[d])?void 0:r)===Array||void 0===r))return p.call(h,g,y);for(n=new(void 0===r?Array:r)(f(y-g,0)),u=0;g<y;g++,u++)g in h&&c(n,u,h[g]);return n.length=u,n}})},{"../internals/array-method-has-species-support":21,"../internals/array-method-uses-to-length":23,"../internals/create-property":40,"../internals/export":50,"../internals/is-array":72,"../internals/is-object":74,"../internals/to-absolute-index":130,"../internals/to-indexed-object":132,"../internals/to-length":134,"../internals/well-known-symbol":146}],163:[function(e,t,r){"use strict";var n=e("../internals/export"),i=e("../internals/array-iteration").some,s=e("../internals/array-method-is-strict");e=e("../internals/array-method-uses-to-length"),s=s("some"),e=e("some");n({target:"Array",proto:!0,forced:!s||!e},{some:function(e){return i(this,e,1<arguments.length?arguments[1]:void 0)}})},{"../internals/array-iteration":19,"../internals/array-method-is-strict":22,"../internals/array-method-uses-to-length":23,"../internals/export":50}],164:[function(e,t,r){"use strict";var n=e("../internals/export"),i=e("../internals/to-absolute-index"),s=e("../internals/to-integer"),o=e("../internals/to-length"),a=e("../internals/to-object"),l=e("../internals/array-species-create"),c=e("../internals/create-property"),u=e("../internals/array-method-has-species-support"),h=(e=e("../internals/array-method-uses-to-length"),u=u("splice"),e=e("splice",{ACCESSORS:!0,0:0,1:2}),Math.max),d=Math.min;n({target:"Array",proto:!0,forced:!u||!e},{splice:function(e,t){var r,n,u,p,f,m,g=a(this),y=o(g.length),v=i(e,y);if(0===(e=arguments.length)?r=n=0:n=1===e?(r=0,y-v):(r=e-2,d(h(s(t),0),y-v)),9007199254740991<y+r-n)throw TypeError("Maximum allowed length exceeded");for(u=l(g,n),p=0;p<n;p++)(f=v+p)in g&&c(u,p,g[f]);if(r<(u.length=n)){for(p=v;p<y-n;p++)m=p+r,(f=p+n)in g?g[m]=g[f]:delete g[m];for(p=y;y-n+r<p;p--)delete g[p-1]}else if(n<r)for(p=y-n;v<p;p--)m=p+r-1,(f=p+n-1)in g?g[m]=g[f]:delete g[m];for(p=0;p<r;p++)g[p+v]=arguments[p+2];return g.length=y-n+r,u}})},{"../internals/array-method-has-species-support":21,"../internals/array-method-uses-to-length":23,"../internals/array-species-create":25,"../internals/create-property":40,"../internals/export":50,"../internals/to-absolute-index":130,"../internals/to-integer":133,"../internals/to-length":134,"../internals/to-object":135}],165:[function(e,t,r){var n=e("../internals/descriptors"),i=(e=e("../internals/object-define-property").f,Function.prototype),s=i.toString,o=/^\s*function ([^ (]*)/;!n||"name"in i||e(i,"name",{configurable:!0,get:function(){try{return s.call(this).match(o)[1]}catch(e){return""}}})},{"../internals/descriptors":43,"../internals/object-define-property":92}],166:[function(e,t,r){"use strict";var n=e("../internals/collection");e=e("../internals/collection-strong");t.exports=n("Map",(function(e){return function(){return e(this,arguments.length?arguments[0]:void 0)}}),e)},{"../internals/collection":32,"../internals/collection-strong":30}],167:[function(e,t,r){e=e("../internals/export");var n=Math.hypot,i=Math.abs,s=Math.sqrt;e({target:"Math",stat:!0,forced:!!n&&n(1/0,NaN)!==1/0},{hypot:function(e,t){for(var r,n,o=0,a=0,l=arguments.length,c=0;a<l;)c<(r=i(arguments[a++]))?(o=o*(n=c/r)*n+1,c=r):o+=0<r?(n=r/c)*n:r;return c===1/0?1/0:c*s(o)}})},{"../internals/export":50}],168:[function(e,t,r){e("../internals/export")({target:"Math",stat:!0},{sign:e("../internals/math-sign")})},{"../internals/export":50,"../internals/math-sign":80}],169:[function(e,t,r){"use strict";function n(e){var t,r,n,i,s,o,a,l=h(e,!1);if("string"==typeof l&&2<l.length)if(43===(e=(l=y(l)).charCodeAt(0))||45===e){if(88===(t=l.charCodeAt(2))||120===t)return NaN}else if(48===e){switch(l.charCodeAt(1)){case 66:case 98:r=2,n=49;break;case 79:case 111:r=8,n=55;break;default:return+l}for(s=(i=l.slice(2)).length,o=0;o<s;o++)if((a=i.charCodeAt(o))<48||n<a)return NaN;return parseInt(i,r)}return+l}var i=e("../internals/descriptors"),s=e("../internals/global"),o=e("../internals/is-forced"),a=e("../internals/redefine"),l=e("../internals/has"),c=e("../internals/classof-raw"),u=e("../internals/inherit-if-required"),h=e("../internals/to-primitive"),d=e("../internals/fails"),p=e("../internals/object-create"),f=e("../internals/object-get-own-property-names").f,m=e("../internals/object-get-own-property-descriptor").f,g=e("../internals/object-define-property").f,y=e("../internals/string-trim").trim,v="Number",_=s[v],x=_.prototype,b=c(p(x))==v;if(o(v,!_(" 0o1")||!_("0b1")||_("+0x1"))){for(var w,S=function(e){e=arguments.length<1?0:e;var t=this;return t instanceof S&&(b?d((function(){x.valueOf.call(t)})):c(t)!=v)?u(new _(n(e)),t,S):n(e)},M=i?f(_):"MAX_VALUE,MIN_VALUE,NaN,NEGATIVE_INFINITY,POSITIVE_INFINITY,EPSILON,isFinite,isInteger,isNaN,isSafeInteger,MAX_SAFE_INTEGER,MIN_SAFE_INTEGER,parseFloat,parseInt,isInteger".split(","),T=0;M.length>T;T++)l(_,w=M[T])&&!l(S,w)&&g(S,w,m(_,w));(S.prototype=x).constructor=S,a(s,v,S)}},{"../internals/classof-raw":28,"../internals/descriptors":43,"../internals/fails":51,"../internals/global":59,"../internals/has":60,"../internals/inherit-if-required":67,"../internals/is-forced":73,"../internals/object-create":90,"../internals/object-define-property":92,"../internals/object-get-own-property-descriptor":93,"../internals/object-get-own-property-names":95,"../internals/redefine":108,"../internals/string-trim":127,"../internals/to-primitive":138}],170:[function(e,t,r){e("../internals/export")({target:"Number",stat:!0},{isFinite:e("../internals/number-is-finite")})},{"../internals/export":50,"../internals/number-is-finite":88}],171:[function(e,t,r){"use strict";function n(e,t,r){return 0===t?r:t%2==1?n(e,t-1,r*e):n(e*e,t/2,r)}var i=e("../internals/export"),s=e("../internals/to-integer"),o=e("../internals/this-number-value"),a=e("../internals/string-repeat"),l=(e=e("../internals/fails"),1..toFixed),c=Math.floor;i({target:"Number",proto:!0,forced:l&&("0.000"!==8e-5.toFixed(3)||"1"!==.9.toFixed(0)||"1.25"!==1.255.toFixed(2)||"1000000000000000128"!==(0xde0b6b3a7640080).toFixed(0))||!e((function(){l.call({})}))},{toFixed:function(e){function t(e,t){for(var r=-1,n=t;++r<6;)n+=e*d[r],d[r]=n%1e7,n=c(n/1e7)}function r(e){for(var t=6,r=0;0<=--t;)r+=d[t],d[t]=c(r/e),r=r%e*1e7}function i(){for(var e,t=6,r="";0<=--t;)""===r&&0!==t&&0===d[t]||(e=String(d[t]),r=""===r?e:r+a.call("0",7-e.length)+e);return r}var l,u,h=o(this),d=(e=s(e),[0,0,0,0,0,0]),p="",f="0";if(e<0||20<e)throw RangeError("Incorrect fraction digits");if(h!=h)return"NaN";if(h<=-1e21||1e21<=h)return String(h);if(h<0&&(p="-",h=-h),1e-21<h)if(h=(l=function(e){for(var t=0,r=e;4096<=r;)t+=12,r/=4096;for(;2<=r;)t+=1,r/=2;return t}(h*n(2,69,1))-69)<0?h*n(2,-l,1):h/n(2,l,1),h*=4503599627370496,0<(l=52-l)){for(t(0,h),u=e;7<=u;)t(1e7,0),u-=7;for(t(n(10,u,1),0),u=l-1;23<=u;)r(1<<23),u-=23;r(1<<u),t(1,1),r(2),f=i()}else t(0,h),t(1<<-l,0),f=i()+a.call("0",e);return 0<e?p+((h=f.length)<=e?"0."+a.call("0",e-h)+f:f.slice(0,h-e)+"."+f.slice(h-e)):p+f}})},{"../internals/export":50,"../internals/fails":51,"../internals/string-repeat":125,"../internals/this-number-value":129,"../internals/to-integer":133}],172:[function(e,t,r){var n=e("../internals/export");e=e("../internals/object-assign");n({target:"Object",stat:!0,forced:Object.assign!==e},{assign:e})},{"../internals/export":50,"../internals/object-assign":89}],173:[function(e,t,r){var n=e("../internals/export"),i=e("../internals/fails"),s=e("../internals/to-indexed-object"),o=e("../internals/object-get-own-property-descriptor").f;e=e("../internals/descriptors"),i=i((function(){o(1)}));n({target:"Object",stat:!0,forced:!e||i,sham:!e},{getOwnPropertyDescriptor:function(e,t){return o(s(e),t)}})},{"../internals/descriptors":43,"../internals/export":50,"../internals/fails":51,"../internals/object-get-own-property-descriptor":93,"../internals/to-indexed-object":132}],174:[function(e,t,r){var n=e("../internals/export"),i=e("../internals/fails");e=e("../internals/object-get-own-property-names-external").f;n({target:"Object",stat:!0,forced:i((function(){return!Object.getOwnPropertyNames(1)}))},{getOwnPropertyNames:e})},{"../internals/export":50,"../internals/fails":51,"../internals/object-get-own-property-names-external":94}],175:[function(e,t,r){var n=e("../internals/export"),i=e("../internals/fails"),s=e("../internals/to-object"),o=e("../internals/object-get-prototype-of");e=e("../internals/correct-prototype-getter");n({target:"Object",stat:!0,forced:i((function(){o(1)})),sham:!e},{getPrototypeOf:function(e){return o(s(e))}})},{"../internals/correct-prototype-getter":35,"../internals/export":50,"../internals/fails":51,"../internals/object-get-prototype-of":97,"../internals/to-object":135}],176:[function(e,t,r){var n=e("../internals/export"),i=e("../internals/to-object"),s=e("../internals/object-keys");n({target:"Object",stat:!0,forced:e("../internals/fails")((function(){s(1)}))},{keys:function(e){return s(i(e))}})},{"../internals/export":50,"../internals/fails":51,"../internals/object-keys":99,"../internals/to-object":135}],177:[function(e,t,r){var n=e("../internals/to-string-tag-support"),i=e("../internals/redefine");e=e("../internals/object-to-string");n||i(Object.prototype,"toString",e,{unsafe:!0})},{"../internals/object-to-string":102,"../internals/redefine":108,"../internals/to-string-tag-support":139}],178:[function(e,t,r){"use strict";var n,i,s,o,a=e("../internals/export"),l=e("../internals/is-pure"),c=e("../internals/global"),u=e("../internals/get-built-in"),h=e("../internals/native-promise-constructor"),d=e("../internals/redefine"),p=e("../internals/redefine-all"),f=e("../internals/set-to-string-tag"),m=e("../internals/set-species"),g=e("../internals/is-object"),y=e("../internals/a-function"),v=e("../internals/an-instance"),_=e("../internals/classof-raw"),x=e("../internals/inspect-source"),b=e("../internals/iterate"),w=e("../internals/check-correctness-of-iteration"),S=e("../internals/species-constructor"),M=e("../internals/task").set,T=e("../internals/microtask"),E=e("../internals/promise-resolve"),A=e("../internals/host-report-errors"),C=e("../internals/new-promise-capability"),L=e("../internals/perform"),R=e("../internals/internal-state"),P=e("../internals/is-forced"),j=e("../internals/well-known-symbol"),I=e("../internals/engine-v8-version"),D=j("species"),O="Promise",N=R.get,U=R.set,k=R.getterFor(O),F=h,B=c.TypeError,z=c.document,G=c.process,V=u("fetch"),H=C.f,W=H,X="process"==_(G),q=!!(z&&z.createEvent&&c.dispatchEvent),Y="unhandledrejection",Z=(e=P(O,(function(){var e,t;if(x(F)===String(F)){if(66===I)return!0;if(!X&&"function"!=typeof PromiseRejectionEvent)return!0}return!((!l||F.prototype.finally)&&(51<=I&&/native code/.test(F)||(t=function(e){e((function(){}),(function(){}))},((e=F.resolve(1)).constructor={})[D]=t,e.then((function(){}))instanceof t)))})),j=e||!w((function(e){F.all(e).catch((function(){}))})),function(e){var t;return!(!g(e)||"function"!=typeof(t=e.then))&&t}),J=function(e,t,r){var n;t.notified||(t.notified=!0,n=t.reactions,T((function(){for(var i,s,o=t.value,a=1==t.state,l=0;n.length>l;){var u,h,d,p=n[l++],f=a?p.ok:p.fail,m=p.resolve,g=p.reject,y=p.domain;try{f?(a||(2===t.rejection&&function(e,t){M.call(c,(function(){X?G.emit("rejectionHandled",e):K("rejectionhandled",e,t.value)}))}(e,t),t.rejection=1),!0===f?u=o:(y&&y.enter(),u=f(o),y&&(y.exit(),d=!0)),u===p.promise?g(B("Promise-chain cycle")):(h=Z(u))?h.call(u,m,g):m(u)):g(o)}catch(o){y&&!d&&y.exit(),g(o)}}t.reactions=[],t.notified=!1,r&&!t.rejection&&(i=e,s=t,M.call(c,(function(){var e=s.value,t=Q(s);if(t&&(t=L((function(){X?G.emit("unhandledRejection",e,i):K(Y,i,e)})),s.rejection=X||Q(s)?2:1,t.error))throw t.value})))})))},K=function(e,t,r){var n;q?((n=z.createEvent("Event")).promise=t,n.reason=r,n.initEvent(e,!1,!0),c.dispatchEvent(n)):n={promise:t,reason:r},(t=c["on"+e])?t(n):e===Y&&A("Unhandled promise rejection",r)},Q=function(e){return 1!==e.rejection&&!e.parent},$=function(e,t,r,n){return function(i){e(t,r,i,n)}},ee=function(e,t,r,n){t.done||(t.done=!0,(t=n||t).value=r,t.state=2,J(e,t,!0))},te=function(e,t,r,n){if(!t.done){t.done=!0,n&&(t=n);try{if(e===r)throw B("Promise can't be resolved itself");var i=Z(r);i?T((function(){var n={done:!1};try{i.call(r,$(te,e,n,t),$(ee,e,n,t))}catch(r){ee(e,n,r,t)}})):(t.value=r,t.state=1,J(e,t,!1))}catch(r){ee(e,{done:!1},r,t)}}};e&&(F=function(e){v(this,F,O),y(e),n.call(this);var t=N(this);try{e($(te,this,t),$(ee,this,t))}catch(e){ee(this,t,e)}},(n=function(e){U(this,{type:O,done:!1,notified:!1,parent:!1,reactions:[],rejection:!1,state:0,value:void 0})}).prototype=p(F.prototype,{then:function(e,t){var r=k(this),n=H(S(this,F));return n.ok="function"!=typeof e||e,n.fail="function"==typeof t&&t,n.domain=X?G.domain:void 0,r.parent=!0,r.reactions.push(n),0!=r.state&&J(this,r,!1),n.promise},catch:function(e){return this.then(void 0,e)}}),i=function(){var e=new n,t=N(e);this.promise=e,this.resolve=$(te,e,t),this.reject=$(ee,e,t)},C.f=H=function(e){return e===F||e===s?new i:W(e)},l||"function"!=typeof h||(o=h.prototype.then,d(h.prototype,"then",(function(e,t){var r=this;return new F((function(e,t){o.call(r,e,t)})).then(e,t)}),{unsafe:!0}),"function"==typeof V&&a({global:!0,enumerable:!0,forced:!0},{fetch:function(e){return E(F,V.apply(c,arguments))}}))),a({global:!0,wrap:!0,forced:e},{Promise:F}),f(F,O,!1,!0),m(O),s=u(O),a({target:O,stat:!0,forced:e},{reject:function(e){var t=H(this);return t.reject.call(void 0,e),t.promise}}),a({target:O,stat:!0,forced:l||e},{resolve:function(e){return E(l&&this===s?F:this,e)}}),a({target:O,stat:!0,forced:j},{all:function(e){var t=this,r=H(t),n=r.resolve,i=r.reject,s=L((function(){var r=y(t.resolve),s=[],o=0,a=1;b(e,(function(e){var l=o++,c=!1;s.push(void 0),a++,r.call(t,e).then((function(e){c||(c=!0,s[l]=e,--a||n(s))}),i)})),--a||n(s)}));return s.error&&i(s.value),r.promise},race:function(e){var t=this,r=H(t),n=r.reject,i=L((function(){var i=y(t.resolve);b(e,(function(e){i.call(t,e).then(r.resolve,n)}))}));return i.error&&n(i.value),r.promise}})},{"../internals/a-function":5,"../internals/an-instance":9,"../internals/check-correctness-of-iteration":27,"../internals/classof-raw":28,"../internals/engine-v8-version":48,"../internals/export":50,"../internals/get-built-in":56,"../internals/global":59,"../internals/host-report-errors":62,"../internals/inspect-source":68,"../internals/internal-state":70,"../internals/is-forced":73,"../internals/is-object":74,"../internals/is-pure":75,"../internals/iterate":77,"../internals/microtask":81,"../internals/native-promise-constructor":82,"../internals/new-promise-capability":86,"../internals/perform":105,"../internals/promise-resolve":106,"../internals/redefine":108,"../internals/redefine-all":107,"../internals/set-species":116,"../internals/set-to-string-tag":117,"../internals/species-constructor":121,"../internals/task":128,"../internals/well-known-symbol":146}],179:[function(e,t,r){var n=e("../internals/export"),i=e("../internals/get-built-in"),s=e("../internals/a-function"),o=e("../internals/an-object"),a=e("../internals/is-object"),l=e("../internals/object-create"),c=e("../internals/function-bind"),u=(e=e("../internals/fails"),i("Reflect","construct")),h=e((function(){function e(){}return!(u((function(){}),[],e)instanceof e)})),d=!e((function(){u((function(){}))}));n({target:"Reflect",stat:!0,forced:i=h||d,sham:i},{construct:function(e,t){s(e),o(t);var r=arguments.length<3?e:s(arguments[2]);if(d&&!h)return u(e,t,r);if(e==r){switch(t.length){case 0:return new e;case 1:return new e(t[0]);case 2:return new e(t[0],t[1]);case 3:return new e(t[0],t[1],t[2]);case 4:return new e(t[0],t[1],t[2],t[3])}var n=[null];return n.push.apply(n,t),new(c.apply(e,n))}return n=r.prototype,r=l(a(n)?n:Object.prototype),n=Function.apply.call(e,r,t),a(n)?n:r}})},{"../internals/a-function":5,"../internals/an-object":10,"../internals/export":50,"../internals/fails":51,"../internals/function-bind":55,"../internals/get-built-in":56,"../internals/is-object":74,"../internals/object-create":90}],180:[function(e,t,r){var n=e("../internals/descriptors"),i=e("../internals/global"),s=e("../internals/is-forced"),o=e("../internals/inherit-if-required"),a=e("../internals/object-define-property").f,l=e("../internals/object-get-own-property-names").f,c=e("../internals/is-regexp"),u=e("../internals/regexp-flags"),h=e("../internals/regexp-sticky-helpers"),d=e("../internals/redefine"),p=e("../internals/fails"),f=e("../internals/internal-state").set,m=e("../internals/set-species"),g=e("../internals/well-known-symbol")("match"),y=i.RegExp,v=y.prototype,_=/a/g,x=/a/g,b=new y(_)!==_,w=h.UNSUPPORTED_Y;if(n&&s("RegExp",!b||w||p((function(){return x[g]=!1,y(_)!=_||y(x)==x||"/a/i"!=y(_,"i")})))){for(var S=function(e,t){var r,n=this instanceof S,i=c(e),s=void 0===t;return!n&&i&&e.constructor===S&&s?e:(b?i&&!s&&(e=e.source):e instanceof S&&(s&&(t=u.call(e)),e=e.source),w&&(r=!!t&&-1<t.indexOf("y"))&&(t=t.replace(/y/g,"")),i=o(b?new y(e,t):y(e,t),n?this:v,S),w&&r&&f(i,{sticky:r}),i)},M=l(y),T=0;M.length>T;)!function(e){e in S||a(S,e,{configurable:!0,get:function(){return y[e]},set:function(t){y[e]=t}})}(M[T++]);(v.constructor=S).prototype=v,d(i,"RegExp",S)}m("RegExp")},{"../internals/descriptors":43,"../internals/fails":51,"../internals/global":59,"../internals/inherit-if-required":67,"../internals/internal-state":70,"../internals/is-forced":73,"../internals/is-regexp":76,"../internals/object-define-property":92,"../internals/object-get-own-property-names":95,"../internals/redefine":108,"../internals/regexp-flags":111,"../internals/regexp-sticky-helpers":112,"../internals/set-species":116,"../internals/well-known-symbol":146}],181:[function(e,t,r){"use strict";var n=e("../internals/export");e=e("../internals/regexp-exec");n({target:"RegExp",proto:!0,forced:/./.exec!==e},{exec:e})},{"../internals/export":50,"../internals/regexp-exec":110}],182:[function(e,t,r){"use strict";var n=e("../internals/redefine"),i=e("../internals/an-object"),s=e("../internals/fails"),o=e("../internals/regexp-flags"),a=(e="toString",RegExp.prototype),l=a[e],c=(s=s((function(){return"/a/b"!=l.call({source:"a",flags:"b"})})),l.name!=e);(s||c)&&n(RegExp.prototype,e,(function(){var e=i(this),t=String(e.source),r=e.flags;return"/"+t+"/"+String(void 0===r&&e instanceof RegExp&&!("flags"in a)?o.call(e):r)}),{unsafe:!0})},{"../internals/an-object":10,"../internals/fails":51,"../internals/redefine":108,"../internals/regexp-flags":111}],183:[function(e,t,r){"use strict";var n=e("../internals/collection");e=e("../internals/collection-strong");t.exports=n("Set",(function(e){return function(){return e(this,arguments.length?arguments[0]:void 0)}}),e)},{"../internals/collection":32,"../internals/collection-strong":30}],184:[function(e,t,r){"use strict";var n=e("../internals/export"),i=e("../internals/object-get-own-property-descriptor").f,s=e("../internals/to-length"),o=e("../internals/not-a-regexp"),a=e("../internals/require-object-coercible"),l=e("../internals/correct-is-regexp-logic"),c=(e=e("../internals/is-pure"),"".endsWith),u=Math.min;l=l("endsWith");n({target:"String",proto:!0,forced:!(!e&&!l&&(n=i(String.prototype,"endsWith"))&&!n.writable||l)},{endsWith:function(e){var t=String(a(this)),r=(o(e),1<arguments.length?arguments[1]:void 0),n=s(t.length);r=void 0===r?n:u(s(r),n),n=String(e);return c?c.call(t,n,r):t.slice(r-n.length,r)===n}})},{"../internals/correct-is-regexp-logic":34,"../internals/export":50,"../internals/is-pure":75,"../internals/not-a-regexp":87,"../internals/object-get-own-property-descriptor":93,"../internals/require-object-coercible":113,"../internals/to-length":134}],185:[function(e,t,r){"use strict";var n=e("../internals/export"),i=e("../internals/not-a-regexp"),s=e("../internals/require-object-coercible");n({target:"String",proto:!0,forced:!e("../internals/correct-is-regexp-logic")("includes")},{includes:function(e){return!!~String(s(this)).indexOf(i(e),1<arguments.length?arguments[1]:void 0)}})},{"../internals/correct-is-regexp-logic":34,"../internals/export":50,"../internals/not-a-regexp":87,"../internals/require-object-coercible":113}],186:[function(e,t,r){"use strict";var n=e("../internals/string-multibyte").charAt,i=e("../internals/internal-state"),s=(e=e("../internals/define-iterator"),"String Iterator"),o=i.set,a=i.getterFor(s);e(String,"String",(function(e){o(this,{type:s,string:String(e),index:0})}),(function(){var e=a(this),t=e.string,r=e.index;return r>=t.length?{value:void 0,done:!0}:(t=n(t,r),e.index+=t.length,{value:t,done:!1})}))},{"../internals/define-iterator":41,"../internals/internal-state":70,"../internals/string-multibyte":123}],187:[function(e,t,r){"use strict";var n=e("../internals/fix-regexp-well-known-symbol-logic"),i=e("../internals/an-object"),s=e("../internals/to-length"),o=e("../internals/require-object-coercible"),a=e("../internals/advance-string-index"),l=e("../internals/regexp-exec-abstract");n("match",1,(function(e,t,r){return[function(t){var r=o(this),n=null==t?void 0:t[e];return void 0!==n?n.call(t,r):new RegExp(t)[e](String(r))},function(e){var n=r(t,e,this);if(n.done)return n.value;var o=i(e),c=String(this);if(!o.global)return l(o,c);for(var u=o.unicode,h=[],d=o.lastIndex=0;null!==(p=l(o,c));){var p=String(p[0]);""===(h[d]=p)&&(o.lastIndex=a(c,s(o.lastIndex),u)),d++}return 0===d?null:h}]}))},{"../internals/advance-string-index":8,"../internals/an-object":10,"../internals/fix-regexp-well-known-symbol-logic":52,"../internals/regexp-exec-abstract":109,"../internals/require-object-coercible":113,"../internals/to-length":134}],188:[function(e,t,r){e("../internals/export")({target:"String",proto:!0},{repeat:e("../internals/string-repeat")})},{"../internals/export":50,"../internals/string-repeat":125}],189:[function(e,t,r){"use strict";var n=e("../internals/fix-regexp-well-known-symbol-logic"),i=e("../internals/an-object"),s=e("../internals/to-object"),o=e("../internals/to-length"),a=e("../internals/to-integer"),l=e("../internals/require-object-coercible"),c=e("../internals/advance-string-index"),u=e("../internals/regexp-exec-abstract"),h=Math.max,d=Math.min,p=Math.floor,f=/\$([$&'`]|\d\d?|<[^>]*>)/g,m=/\$([$&'`]|\d\d?)/g;n("replace",2,(function(e,t,r,n){var g=n.REGEXP_REPLACE_SUBSTITUTES_UNDEFINED_CAPTURE,y=n.REPLACE_KEEPS_$0,v=g?"$":"$0";return[function(r,n){var i=l(this),s=null==r?void 0:r[e];return void 0!==s?s.call(r,i,n):t.call(String(i),r,n)},function(e,n){if(!g&&y||"string"==typeof n&&-1===n.indexOf(v)){var l=r(t,e,this,n);if(l.done)return l.value}for(var _,x=i(e),b=String(this),w="function"==typeof n,S=(w||(n=String(n)),x.global),M=(S&&(_=x.unicode,x.lastIndex=0),[]);null!==(L=u(x,b))&&(M.push(L),S);)""===String(L[0])&&(x.lastIndex=c(b,o(x.lastIndex),_));for(var T,E="",A=0,C=0;C<M.length;C++){for(var L=M[C],R=String(L[0]),P=h(d(a(L.index),b.length),0),j=[],I=1;I<L.length;I++)j.push(void 0===(T=L[I])?T:String(T));var D=L.groups,O=w?(O=[R].concat(j,P,b),void 0!==D&&O.push(D),String(n.apply(void 0,O))):function(e,r,n,i,o,a){var l=n+e.length,c=i.length,u=m;return void 0!==o&&(o=s(o),u=f),t.call(a,u,(function(t,s){var a;switch(s.charAt(0)){case"$":return"$";case"&":return e;case"`":return r.slice(0,n);case"'":return r.slice(l);case"<":a=o[s.slice(1,-1)];break;default:var u,h=+s;if(0==h)return t;if(c<h)return 0!==(u=p(h/10))&&u<=c?void 0===i[u-1]?s.charAt(1):i[u-1]+s.charAt(1):t;a=i[h-1]}return void 0===a?"":a}))}(R,b,P,j,D,n);A<=P&&(E+=b.slice(A,P)+O,A=P+R.length)}return E+b.slice(A)}]}))},{"../internals/advance-string-index":8,"../internals/an-object":10,"../internals/fix-regexp-well-known-symbol-logic":52,"../internals/regexp-exec-abstract":109,"../internals/require-object-coercible":113,"../internals/to-integer":133,"../internals/to-length":134,"../internals/to-object":135}],190:[function(e,t,r){"use strict";var n=e("../internals/fix-regexp-well-known-symbol-logic"),i=e("../internals/an-object"),s=e("../internals/require-object-coercible"),o=e("../internals/same-value"),a=e("../internals/regexp-exec-abstract");n("search",1,(function(e,t,r){return[function(t){var r=s(this),n=null==t?void 0:t[e];return void 0!==n?n.call(t,r):new RegExp(t)[e](String(r))},function(e){var n,s=r(t,e,this);return s.done?s.value:(s=i(e),e=String(this),n=s.lastIndex,o(n,0)||(s.lastIndex=0),e=a(s,e),o(s.lastIndex,n)||(s.lastIndex=n),null===e?-1:e.index)}]}))},{"../internals/an-object":10,"../internals/fix-regexp-well-known-symbol-logic":52,"../internals/regexp-exec-abstract":109,"../internals/require-object-coercible":113,"../internals/same-value":114}],191:[function(e,t,r){"use strict";var n=e("../internals/fix-regexp-well-known-symbol-logic"),i=e("../internals/is-regexp"),s=e("../internals/an-object"),o=e("../internals/require-object-coercible"),a=e("../internals/species-constructor"),l=e("../internals/advance-string-index"),c=e("../internals/to-length"),u=e("../internals/regexp-exec-abstract"),h=e("../internals/regexp-exec"),d=(e=e("../internals/fails"),[].push),p=Math.min,f=4294967295,m=!e((function(){return!RegExp(f,"y")}));n("split",2,(function(e,t,r){var n="c"=="abbc".split(/(b)*/)[1]||4!="test".split(/(?:)/,-1).length||2!="ab".split(/(?:ab)*/).length||4!=".".split(/(.?)(.?)/).length||1<".".split(/()()/).length||"".split(/.?/).length?function(e,r){var n=String(o(this)),s=void 0===r?f:r>>>0;if(0==s)return[];if(void 0===e)return[n];if(!i(e))return t.call(n,e,s);for(var a,l,c,u=[],p=(r=(e.ignoreCase?"i":"")+(e.multiline?"m":"")+(e.unicode?"u":"")+(e.sticky?"y":""),0),m=new RegExp(e.source,r+"g");(a=h.call(m,n))&&!(p<(l=m.lastIndex)&&(u.push(n.slice(p,a.index)),1<a.length&&a.index<n.length&&d.apply(u,a.slice(1)),c=a[0].length,p=l,u.length>=s));)m.lastIndex===a.index&&m.lastIndex++;return p===n.length?!c&&m.test("")||u.push(""):u.push(n.slice(p)),u.length>s?u.slice(0,s):u}:"0".split(void 0,0).length?function(e,r){return void 0===e&&0===r?[]:t.call(this,e,r)}:t;return[function(t,r){var i=o(this),s=null==t?void 0:t[e];return void 0!==s?s.call(t,i,r):n.call(String(i),t,r)},function(e,i){if((o=r(n,e,this,i,n!==t)).done)return o.value;var o=s(e),h=String(this),d=(e=a(o,RegExp),o.unicode),g=(o.ignoreCase?"i":"")+(o.multiline?"m":"")+(o.unicode?"u":"")+(m?"y":"g"),y=new e(m?o:"^(?:"+o.source+")",g),v=void 0===i?f:i>>>0;if(0==v)return[];if(0===h.length)return null===u(y,h)?[h]:[];for(var _=0,x=0,b=[];x<h.length;){y.lastIndex=m?x:0;var w,S=u(y,m?h:h.slice(x));if(null===S||(w=p(c(y.lastIndex+(m?0:x)),h.length))===_)x=l(h,x,d);else{if(b.push(h.slice(_,x)),b.length===v)return b;for(var M=1;M<=S.length-1;M++)if(b.push(S[M]),b.length===v)return b;x=_=w}}return b.push(h.slice(_)),b}]}),!m)},{"../internals/advance-string-index":8,"../internals/an-object":10,"../internals/fails":51,"../internals/fix-regexp-well-known-symbol-logic":52,"../internals/is-regexp":76,"../internals/regexp-exec":110,"../internals/regexp-exec-abstract":109,"../internals/require-object-coercible":113,"../internals/species-constructor":121,"../internals/to-length":134}],192:[function(e,t,r){"use strict";var n=e("../internals/export"),i=e("../internals/create-html");n({target:"String",proto:!0,forced:e("../internals/string-html-forced")("sub")},{sub:function(){return i(this,"sub","","")}})},{"../internals/create-html":36,"../internals/export":50,"../internals/string-html-forced":122}],193:[function(e,t,r){"use strict";var n=e("../internals/export"),i=e("../internals/string-trim").trim;n({target:"String",proto:!0,forced:e("../internals/string-trim-forced")("trim")},{trim:function(){return i(this)}})},{"../internals/export":50,"../internals/string-trim":127,"../internals/string-trim-forced":126}],194:[function(e,t,r){"use strict";var n,i,s,o,a,l=e("../internals/export"),c=e("../internals/descriptors"),u=e("../internals/global"),h=e("../internals/has"),d=e("../internals/is-object"),p=e("../internals/object-define-property").f,f=(e=e("../internals/copy-constructor-properties"),u.Symbol);!c||"function"!=typeof f||"description"in f.prototype&&void 0===f().description||(n={},e(i=function(){var e=arguments.length<1||void 0===arguments[0]?void 0:String(arguments[0]),t=this instanceof i?new f(e):void 0===e?f():f(e);return""===e&&(n[t]=!0),t},f),(u=i.prototype=f.prototype).constructor=i,s=u.toString,o="Symbol(test)"==String(f("test")),a=/^Symbol\((.*)\)[^)]+$/,p(u,"description",{configurable:!0,get:function(){var e=d(this)?this.valueOf():this,t=s.call(e);return h(n,e)?"":""===(e=o?t.slice(7,-1):t.replace(a,"$1"))?void 0:e}}),l({global:!0,forced:!0},{Symbol:i}))},{"../internals/copy-constructor-properties":33,"../internals/descriptors":43,"../internals/export":50,"../internals/global":59,"../internals/has":60,"../internals/is-object":74,"../internals/object-define-property":92}],195:[function(e,t,r){e("../internals/define-well-known-symbol")("iterator")},{"../internals/define-well-known-symbol":42}],196:[function(e,t,r){"use strict";function n(e,t){var r=te[e]=S(Z[W]);return X(r,{type:H,tag:e,description:t}),h||(r.description=t),r}function i(e,t){v(e);var r=x(t);t=M(r).concat(ue(r));return G(t,(function(t){h&&!ce.call(r,t)||le(e,t,r[t])})),e}function s(e,t){var r;e=x(e),t=b(t,!0);if(e!==Y||!m(te,t)||m(re,t))return!(r=K(e,t))||!m(te,t)||m(e,V)&&e[V][t]||(r.enumerable=!0),r}function o(e){e=$(x(e));var t=[];return G(e,(function(e){m(te,e)||m(O,e)||t.push(e)})),t}var a=e("../internals/export"),l=e("../internals/global"),c=e("../internals/get-built-in"),u=e("../internals/is-pure"),h=e("../internals/descriptors"),d=e("../internals/native-symbol"),p=e("../internals/use-symbol-as-uid"),f=e("../internals/fails"),m=e("../internals/has"),g=e("../internals/is-array"),y=e("../internals/is-object"),v=e("../internals/an-object"),_=e("../internals/to-object"),x=e("../internals/to-indexed-object"),b=e("../internals/to-primitive"),w=e("../internals/create-property-descriptor"),S=e("../internals/object-create"),M=e("../internals/object-keys"),T=e("../internals/object-get-own-property-names"),E=e("../internals/object-get-own-property-names-external"),A=e("../internals/object-get-own-property-symbols"),C=e("../internals/object-get-own-property-descriptor"),L=e("../internals/object-define-property"),R=e("../internals/object-property-is-enumerable"),P=e("../internals/create-non-enumerable-property"),j=e("../internals/redefine"),I=e("../internals/shared"),D=e("../internals/shared-key"),O=e("../internals/hidden-keys"),N=e("../internals/uid"),U=e("../internals/well-known-symbol"),k=e("../internals/well-known-symbol-wrapped"),F=e("../internals/define-well-known-symbol"),B=e("../internals/set-to-string-tag"),z=e("../internals/internal-state"),G=e("../internals/array-iteration").forEach,V=D("hidden"),H="Symbol",W="prototype",X=(e=U("toPrimitive"),z.set),q=z.getterFor(H),Y=Object[W],Z=l.Symbol,J=c("JSON","stringify"),K=C.f,Q=L.f,$=E.f,ee=R.f,te=I("symbols"),re=I("op-symbols"),ne=I("string-to-symbol-registry"),ie=I("symbol-to-string-registry"),se=(D=I("wks"),!(z=l.QObject)||!z[W]||!z[W].findChild),oe=h&&f((function(){return 7!=S(Q({},"a",{get:function(){return Q(this,"a",{value:7}).a}})).a}))?function(e,t,r){var n=K(Y,t);n&&delete Y[t],Q(e,t,r),n&&e!==Y&&Q(Y,t,n)}:Q,ae=p?function(e){return"symbol"==typeof e}:function(e){return Object(e)instanceof Z},le=function(e,t,r){return e===Y&&le(re,t,r),v(e),t=b(t,!0),v(r),(m(te,t)?(r.enumerable?(m(e,V)&&e[V][t]&&(e[V][t]=!1),r=S(r,{enumerable:w(0,!1)})):(m(e,V)||Q(e,V,w(1,{})),e[V][t]=!0),oe):Q)(e,t,r)},ce=function(e){e=b(e,!0);var t=ee.call(this,e);return!(this===Y&&m(te,e)&&!m(re,e))&&(!(t||!m(this,e)||!m(te,e)||m(this,V)&&this[V][e])||t)},ue=function(e){var t=e===Y,r=(e=$(t?re:x(e)),[]);return G(e,(function(e){!m(te,e)||t&&!m(Y,e)||r.push(te[e])})),r};d||(j((Z=function(){if(this instanceof Z)throw TypeError("Symbol is not a constructor");var e=arguments.length&&void 0!==arguments[0]?String(arguments[0]):void 0,t=N(e),r=function(e){this===Y&&r.call(re,e),m(this,V)&&m(this[V],t)&&(this[V][t]=!1),oe(this,t,w(1,e))};return h&&se&&oe(Y,t,{configurable:!0,set:r}),n(t,e)})[W],"toString",(function(){return q(this).tag})),j(Z,"withoutSetter",(function(e){return n(N(e),e)})),R.f=ce,L.f=le,C.f=s,T.f=E.f=o,A.f=ue,k.f=function(e){return n(U(e),e)},h&&(Q(Z[W],"description",{configurable:!0,get:function(){return q(this).description}}),u||j(Y,"propertyIsEnumerable",ce,{unsafe:!0}))),a({global:!0,wrap:!0,forced:!d,sham:!d},{Symbol:Z}),G(M(D),(function(e){F(e)})),a({target:H,stat:!0,forced:!d},{for:function(e){var t;e=String(e);return m(ne,e)?ne[e]:(t=Z(e),ne[e]=t,ie[t]=e,t)},keyFor:function(e){if(!ae(e))throw TypeError(e+" is not a symbol");if(m(ie,e))return ie[e]},useSetter:function(){se=!0},useSimple:function(){se=!1}}),a({target:"Object",stat:!0,forced:!d,sham:!h},{create:function(e,t){return void 0===t?S(e):i(S(e),t)},defineProperty:le,defineProperties:i,getOwnPropertyDescriptor:s}),a({target:"Object",stat:!0,forced:!d},{getOwnPropertyNames:o,getOwnPropertySymbols:ue}),a({target:"Object",stat:!0,forced:f((function(){A.f(1)}))},{getOwnPropertySymbols:function(e){return A.f(_(e))}}),J&&a({target:"JSON",stat:!0,forced:!d||f((function(){var e=Z();return"[null]"!=J([e])||"{}"!=J({a:e})||"{}"!=J(Object(e))}))},{stringify:function(e,t,r){for(var n,i=[e],s=1;s<arguments.length;)i.push(arguments[s++]);if((y(n=t)||void 0!==e)&&!ae(e))return g(t)||(t=function(e,t){if("function"==typeof n&&(t=n.call(this,e,t)),!ae(t))return t}),i[1]=t,J.apply(null,i)}}),Z[W][e]||P(Z[W],e,Z[W].valueOf),B(Z,H),O[V]=!0},{"../internals/an-object":10,"../internals/array-iteration":19,"../internals/create-non-enumerable-property":38,"../internals/create-property-descriptor":39,"../internals/define-well-known-symbol":42,"../internals/descriptors":43,"../internals/export":50,"../internals/fails":51,"../internals/get-built-in":56,"../internals/global":59,"../internals/has":60,"../internals/hidden-keys":61,"../internals/internal-state":70,"../internals/is-array":72,"../internals/is-object":74,"../internals/is-pure":75,"../internals/native-symbol":83,"../internals/object-create":90,"../internals/object-define-property":92,"../internals/object-get-own-property-descriptor":93,"../internals/object-get-own-property-names":95,"../internals/object-get-own-property-names-external":94,"../internals/object-get-own-property-symbols":96,"../internals/object-keys":99,"../internals/object-property-is-enumerable":100,"../internals/redefine":108,"../internals/set-to-string-tag":117,"../internals/shared":120,"../internals/shared-key":118,"../internals/to-indexed-object":132,"../internals/to-object":135,"../internals/to-primitive":138,"../internals/uid":143,"../internals/use-symbol-as-uid":144,"../internals/well-known-symbol":146,"../internals/well-known-symbol-wrapped":145}],197:[function(e,t,r){"use strict";var n=e("../internals/array-buffer-view-core"),i=e("../internals/array-copy-within"),s=n.aTypedArray;(0,n.exportTypedArrayMethod)("copyWithin",(function(e,t){return i.call(s(this),e,t,2<arguments.length?arguments[2]:void 0)}))},{"../internals/array-buffer-view-core":12,"../internals/array-copy-within":14}],198:[function(e,t,r){"use strict";var n=e("../internals/array-buffer-view-core"),i=e("../internals/array-iteration").every,s=n.aTypedArray;(0,n.exportTypedArrayMethod)("every",(function(e){return i(s(this),e,1<arguments.length?arguments[1]:void 0)}))},{"../internals/array-buffer-view-core":12,"../internals/array-iteration":19}],199:[function(e,t,r){"use strict";var n=e("../internals/array-buffer-view-core"),i=e("../internals/array-fill"),s=n.aTypedArray;(0,n.exportTypedArrayMethod)("fill",(function(e){return i.apply(s(this),arguments)}))},{"../internals/array-buffer-view-core":12,"../internals/array-fill":15}],200:[function(e,t,r){"use strict";var n=e("../internals/array-buffer-view-core"),i=e("../internals/array-iteration").filter,s=e("../internals/species-constructor"),o=n.aTypedArray,a=n.aTypedArrayConstructor;(0,n.exportTypedArrayMethod)("filter",(function(e){for(var t=i(o(this),e,1<arguments.length?arguments[1]:void 0),r=(e=s(this,this.constructor),0),n=t.length,l=new(a(e))(n);r<n;)l[r]=t[r++];return l}))},{"../internals/array-buffer-view-core":12,"../internals/array-iteration":19,"../internals/species-constructor":121}],201:[function(e,t,r){"use strict";var n=e("../internals/array-buffer-view-core"),i=e("../internals/array-iteration").findIndex,s=n.aTypedArray;(0,n.exportTypedArrayMethod)("findIndex",(function(e){return i(s(this),e,1<arguments.length?arguments[1]:void 0)}))},{"../internals/array-buffer-view-core":12,"../internals/array-iteration":19}],202:[function(e,t,r){"use strict";var n=e("../internals/array-buffer-view-core"),i=e("../internals/array-iteration").find,s=n.aTypedArray;(0,n.exportTypedArrayMethod)("find",(function(e){return i(s(this),e,1<arguments.length?arguments[1]:void 0)}))},{"../internals/array-buffer-view-core":12,"../internals/array-iteration":19}],203:[function(e,t,r){e("../internals/typed-array-constructor")("Float32",(function(e){return function(t,r,n){return e(this,t,r,n)}}))},{"../internals/typed-array-constructor":140}],204:[function(e,t,r){e("../internals/typed-array-constructor")("Float64",(function(e){return function(t,r,n){return e(this,t,r,n)}}))},{"../internals/typed-array-constructor":140}],205:[function(e,t,r){"use strict";var n=e("../internals/array-buffer-view-core"),i=e("../internals/array-iteration").forEach,s=n.aTypedArray;(0,n.exportTypedArrayMethod)("forEach",(function(e){i(s(this),e,1<arguments.length?arguments[1]:void 0)}))},{"../internals/array-buffer-view-core":12,"../internals/array-iteration":19}],206:[function(e,t,r){"use strict";var n=e("../internals/array-buffer-view-core"),i=e("../internals/array-includes").includes,s=n.aTypedArray;(0,n.exportTypedArrayMethod)("includes",(function(e){return i(s(this),e,1<arguments.length?arguments[1]:void 0)}))},{"../internals/array-buffer-view-core":12,"../internals/array-includes":18}],207:[function(e,t,r){"use strict";var n=e("../internals/array-buffer-view-core"),i=e("../internals/array-includes").indexOf,s=n.aTypedArray;(0,n.exportTypedArrayMethod)("indexOf",(function(e){return i(s(this),e,1<arguments.length?arguments[1]:void 0)}))},{"../internals/array-buffer-view-core":12,"../internals/array-includes":18}],208:[function(e,t,r){e("../internals/typed-array-constructor")("Int16",(function(e){return function(t,r,n){return e(this,t,r,n)}}))},{"../internals/typed-array-constructor":140}],209:[function(e,t,r){e("../internals/typed-array-constructor")("Int32",(function(e){return function(t,r,n){return e(this,t,r,n)}}))},{"../internals/typed-array-constructor":140}],210:[function(e,t,r){"use strict";function n(){return a.call(u(this))}var i=e("../internals/global"),s=e("../internals/array-buffer-view-core"),o=e("../modules/es.array.iterator"),a=(e=e("../internals/well-known-symbol")("iterator"),i=i.Uint8Array,o.values),l=o.keys,c=o.entries,u=s.aTypedArray;o=s.exportTypedArrayMethod,i=!!(s=i&&i.prototype[e])&&("values"==s.name||null==s.name);o("entries",(function(){return c.call(u(this))})),o("keys",(function(){return l.call(u(this))})),o("values",n,!i),o(e,n,!i)},{"../internals/array-buffer-view-core":12,"../internals/global":59,"../internals/well-known-symbol":146,"../modules/es.array.iterator":158}],211:[function(e,t,r){"use strict";var n=(e=e("../internals/array-buffer-view-core")).aTypedArray,i=(e=e.exportTypedArrayMethod,[].join);e("join",(function(e){return i.apply(n(this),arguments)}))},{"../internals/array-buffer-view-core":12}],212:[function(e,t,r){"use strict";var n=e("../internals/array-buffer-view-core"),i=e("../internals/array-last-index-of"),s=n.aTypedArray;(0,n.exportTypedArrayMethod)("lastIndexOf",(function(e){return i.apply(s(this),arguments)}))},{"../internals/array-buffer-view-core":12,"../internals/array-last-index-of":20}],213:[function(e,t,r){"use strict";var n=e("../internals/array-buffer-view-core"),i=e("../internals/array-iteration").map,s=e("../internals/species-constructor"),o=n.aTypedArray,a=n.aTypedArrayConstructor;(0,n.exportTypedArrayMethod)("map",(function(e){return i(o(this),e,1<arguments.length?arguments[1]:void 0,(function(e,t){return new(a(s(e,e.constructor)))(t)}))}))},{"../internals/array-buffer-view-core":12,"../internals/array-iteration":19,"../internals/species-constructor":121}],214:[function(e,t,r){"use strict";var n=e("../internals/array-buffer-view-core"),i=e("../internals/array-reduce").right,s=n.aTypedArray;(0,n.exportTypedArrayMethod)("reduceRight",(function(e){return i(s(this),e,arguments.length,1<arguments.length?arguments[1]:void 0)}))},{"../internals/array-buffer-view-core":12,"../internals/array-reduce":24}],215:[function(e,t,r){"use strict";var n=e("../internals/array-buffer-view-core"),i=e("../internals/array-reduce").left,s=n.aTypedArray;(0,n.exportTypedArrayMethod)("reduce",(function(e){return i(s(this),e,arguments.length,1<arguments.length?arguments[1]:void 0)}))},{"../internals/array-buffer-view-core":12,"../internals/array-reduce":24}],216:[function(e,t,r){"use strict";var n=(e=e("../internals/array-buffer-view-core")).aTypedArray,i=(e=e.exportTypedArrayMethod,Math.floor);e("reverse",(function(){for(var e,t=n(this).length,r=i(t/2),s=0;s<r;)e=this[s],this[s++]=this[--t],this[t]=e;return this}))},{"../internals/array-buffer-view-core":12}],217:[function(e,t,r){"use strict";var n=e("../internals/array-buffer-view-core"),i=e("../internals/to-length"),s=e("../internals/to-offset"),o=e("../internals/to-object"),a=(e=e("../internals/fails"),n.aTypedArray);(0,n.exportTypedArrayMethod)("set",(function(e){a(this);var t=s(1<arguments.length?arguments[1]:void 0,1),r=this.length,n=o(e),l=i(n.length),c=0;if(r<l+t)throw RangeError("Wrong length");for(;c<l;)this[t+c]=n[c++]}),e((function(){new Int8Array(1).set({})})))},{"../internals/array-buffer-view-core":12,"../internals/fails":51,"../internals/to-length":134,"../internals/to-object":135,"../internals/to-offset":136}],218:[function(e,t,r){"use strict";var n=e("../internals/array-buffer-view-core"),i=e("../internals/species-constructor"),s=(e=e("../internals/fails"),n.aTypedArray),o=n.aTypedArrayConstructor,a=(n=n.exportTypedArrayMethod,[].slice);n("slice",(function(e,t){for(var r=a.call(s(this),e,t),n=(e=i(this,this.constructor),0),l=r.length,c=new(o(e))(l);n<l;)c[n]=r[n++];return c}),e((function(){new Int8Array(1).slice()})))},{"../internals/array-buffer-view-core":12,"../internals/fails":51,"../internals/species-constructor":121}],219:[function(e,t,r){"use strict";var n=e("../internals/array-buffer-view-core"),i=e("../internals/array-iteration").some,s=n.aTypedArray;(0,n.exportTypedArrayMethod)("some",(function(e){return i(s(this),e,1<arguments.length?arguments[1]:void 0)}))},{"../internals/array-buffer-view-core":12,"../internals/array-iteration":19}],220:[function(e,t,r){"use strict";var n=(e=e("../internals/array-buffer-view-core")).aTypedArray,i=(e=e.exportTypedArrayMethod,[].sort);e("sort",(function(e){return i.call(n(this),e)}))},{"../internals/array-buffer-view-core":12}],221:[function(e,t,r){"use strict";var n=e("../internals/array-buffer-view-core"),i=e("../internals/to-length"),s=e("../internals/to-absolute-index"),o=e("../internals/species-constructor"),a=n.aTypedArray;(0,n.exportTypedArrayMethod)("subarray",(function(e,t){var r=a(this),n=r.length;e=s(e,n);return new(o(r,r.constructor))(r.buffer,r.byteOffset+e*r.BYTES_PER_ELEMENT,i((void 0===t?n:s(t,n))-e))}))},{"../internals/array-buffer-view-core":12,"../internals/species-constructor":121,"../internals/to-absolute-index":130,"../internals/to-length":134}],222:[function(e,t,r){"use strict";var n=e("../internals/global"),i=e("../internals/array-buffer-view-core"),s=(e=e("../internals/fails"),n.Int8Array),o=i.aTypedArray,a=(n=i.exportTypedArrayMethod,[].toLocaleString),l=[].slice,c=!!s&&e((function(){a.call(new s(1))}));n("toLocaleString",(function(){return a.apply(c?l.call(o(this)):o(this),arguments)}),e((function(){return[1,2].toLocaleString()!=new s([1,2]).toLocaleString()}))||!e((function(){s.prototype.toLocaleString.call([1,2])})))},{"../internals/array-buffer-view-core":12,"../internals/fails":51,"../internals/global":59}],223:[function(e,t,r){"use strict";var n=e("../internals/array-buffer-view-core").exportTypedArrayMethod,i=e("../internals/fails"),s=(e=(e=e("../internals/global").Uint8Array)&&e.prototype||{},[].toString),o=[].join;i((function(){s.call({})}))&&(s=function(){return o.call(this)}),i=e.toString!=s;n("toString",s,i)},{"../internals/array-buffer-view-core":12,"../internals/fails":51,"../internals/global":59}],224:[function(e,t,r){e("../internals/typed-array-constructor")("Uint16",(function(e){return function(t,r,n){return e(this,t,r,n)}}))},{"../internals/typed-array-constructor":140}],225:[function(e,t,r){e("../internals/typed-array-constructor")("Uint32",(function(e){return function(t,r,n){return e(this,t,r,n)}}))},{"../internals/typed-array-constructor":140}],226:[function(e,t,r){e("../internals/typed-array-constructor")("Uint8",(function(e){return function(t,r,n){return e(this,t,r,n)}}))},{"../internals/typed-array-constructor":140}],227:[function(e,t,r){e("../internals/typed-array-constructor")("Uint8",(function(e){return function(t,r,n){return e(this,t,r,n)}}),!0)},{"../internals/typed-array-constructor":140}],228:[function(e,t,r){"use strict";function n(e){return function(){return e(this,arguments.length?arguments[0]:void 0)}}var i,s,o,a,l,c=e("../internals/global"),u=e("../internals/redefine-all"),h=e("../internals/internal-metadata"),d=e("../internals/collection"),p=e("../internals/collection-weak"),f=e("../internals/is-object"),m=e("../internals/internal-state").enforce,g=(e=e("../internals/native-weak-map"),c=!c.ActiveXObject&&"ActiveXObject"in c,Object.isExtensible);t=t.exports=d("WeakMap",n,p);e&&c&&(i=p.getConstructor(n,"WeakMap",!0),h.REQUIRED=!0,d=t.prototype,s=d.delete,o=d.has,a=d.get,l=d.set,u(d,{delete:function(e){var t;return f(e)&&!g(e)?((t=m(this)).frozen||(t.frozen=new i),s.call(this,e)||t.frozen.delete(e)):s.call(this,e)},has:function(e){var t;return f(e)&&!g(e)?((t=m(this)).frozen||(t.frozen=new i),o.call(this,e)||t.frozen.has(e)):o.call(this,e)},get:function(e){var t;return!f(e)||g(e)||((t=m(this)).frozen||(t.frozen=new i),o.call(this,e))?a.call(this,e):t.frozen.get(e)},set:function(e,t){var r;return!f(e)||g(e)||((r=m(this)).frozen||(r.frozen=new i),o.call(this,e))?l.call(this,e,t):r.frozen.set(e,t),this}}))},{"../internals/collection":32,"../internals/collection-weak":31,"../internals/global":59,"../internals/internal-metadata":69,"../internals/internal-state":70,"../internals/is-object":74,"../internals/native-weak-map":85,"../internals/redefine-all":107}],229:[function(e,t,r){var n,i=e("../internals/global"),s=e("../internals/dom-iterables"),o=e("../internals/array-for-each"),a=e("../internals/create-non-enumerable-property");for(n in s){var l;if((l=(l=i[n])&&l.prototype)&&l.forEach!==o)try{a(l,"forEach",o)}catch(e){l.forEach=o}}},{"../internals/array-for-each":16,"../internals/create-non-enumerable-property":38,"../internals/dom-iterables":45,"../internals/global":59}],230:[function(e,t,r){var n,i=e("../internals/global"),s=e("../internals/dom-iterables"),o=e("../modules/es.array.iterator"),a=e("../internals/create-non-enumerable-property"),l=(e=e("../internals/well-known-symbol"))("iterator"),c=e("toStringTag"),u=o.values;for(n in s){var h=i[n],d=h&&h.prototype;if(d){if(d[l]!==u)try{a(d,l,u)}catch(e){d[l]=u}if(d[c]||a(d,c,n),s[n])for(var p in o)if(d[p]!==o[p])try{a(d,p,o[p])}catch(e){d[p]=o[p]}}}},{"../internals/create-non-enumerable-property":38,"../internals/dom-iterables":45,"../internals/global":59,"../internals/well-known-symbol":146,"../modules/es.array.iterator":158}],231:[function(e,t,r){"use strict";function n(e){try{return decodeURIComponent(e)}catch(t){return e}}function i(e){return k[e]}function s(e){return encodeURIComponent(e).replace(U,i)}function o(e){this.entries.length=0,F(this.entries,e)}function a(e,t){if(e<t)throw TypeError("Not enough arguments")}function l(){y(this,l,L);var e,t,r,n,i,s,a,c,u=0<arguments.length?arguments[0]:void 0,h=[];if(P(this,{type:L,entries:h,updateURL:function(){},updateSearchParams:o}),void 0!==u)if(w(u))if("function"==typeof(e=E(u)))for(r=(t=e.call(u)).next;!(n=r.call(t)).done;){if((s=(i=(n=T(b(n.value))).next).call(n)).done||(a=i.call(n)).done||!i.call(n).done)throw TypeError("Expected sequence with length 2");h.push({key:s.value+"",value:a.value+""})}else for(c in u)v(u,c)&&h.push({key:c,value:u[c]+""});else F(h,"string"==typeof u?"?"===u.charAt(0)?u.slice(1):u:u+"")}e("../modules/es.array.iterator");var c=e("../internals/export"),u=e("../internals/get-built-in"),h=e("../internals/native-url"),d=e("../internals/redefine"),p=e("../internals/redefine-all"),f=e("../internals/set-to-string-tag"),m=e("../internals/create-iterator-constructor"),g=e("../internals/internal-state"),y=e("../internals/an-instance"),v=e("../internals/has"),_=e("../internals/function-bind-context"),x=e("../internals/classof"),b=e("../internals/an-object"),w=e("../internals/is-object"),S=e("../internals/object-create"),M=e("../internals/create-property-descriptor"),T=e("../internals/get-iterator"),E=e("../internals/get-iterator-method"),A=(e=e("../internals/well-known-symbol"),u("fetch")),C=u("Headers"),L=(u=e("iterator"),"URLSearchParams"),R=L+"Iterator",P=g.set,j=g.getterFor(L),I=g.getterFor(R),D=/\+/g,O=Array(4),N=function(e){var t,r=e.replace(D," "),i=4;try{return decodeURIComponent(r)}catch(e){for(;i;)r=r.replace((t=i--,O[t-1]||(O[t-1]=RegExp("((?:%[\\da-f]{2}){"+t+"})","gi"))),n);return r}},U=/[!'()~]|%20/g,k={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+"},F=function(e,t){if(t)for(var r,n=t.split("&"),i=0;i<n.length;)(r=n[i++]).length&&(r=r.split("="),e.push({key:N(r.shift()),value:N(r.join("="))}))},B=m((function(e,t){P(this,{type:R,iterator:T(j(e).entries),kind:t})}),"Iterator",(function(){var e,t=(e=I(this)).kind,r=(e=e.iterator.next()).value;return e.done||(e.value="keys"===t?r.key:"values"===t?r.value:[r.key,r.value]),e}));p(e=l.prototype,{append:function(e,t){a(arguments.length,2);var r=j(this);r.entries.push({key:e+"",value:t+""}),r.updateURL()},delete:function(e){a(arguments.length,1);for(var t=j(this),r=t.entries,n=e+"",i=0;i<r.length;)r[i].key===n?r.splice(i,1):i++;t.updateURL()},get:function(e){a(arguments.length,1);for(var t=j(this).entries,r=e+"",n=0;n<t.length;n++)if(t[n].key===r)return t[n].value;return null},getAll:function(e){a(arguments.length,1);for(var t=j(this).entries,r=e+"",n=[],i=0;i<t.length;i++)t[i].key===r&&n.push(t[i].value);return n},has:function(e){a(arguments.length,1);for(var t=j(this).entries,r=e+"",n=0;n<t.length;)if(t[n++].key===r)return!0;return!1},set:function(e,t){a(arguments.length,1);for(var r,n=j(this),i=n.entries,s=!1,o=e+"",l=t+"",c=0;c<i.length;c++)(r=i[c]).key===o&&(s?i.splice(c--,1):(s=!0,r.value=l));s||i.push({key:o,value:l}),n.updateURL()},sort:function(){for(var e,t,r=j(this),n=r.entries,i=n.slice(),s=n.length=0;s<i.length;s++){for(e=i[s],t=0;t<s;t++)if(n[t].key>e.key){n.splice(t,0,e);break}t===s&&n.push(e)}r.updateURL()},forEach:function(e){for(var t,r=j(this).entries,n=_(e,1<arguments.length?arguments[1]:void 0,3),i=0;i<r.length;)n((t=r[i++]).value,t.key,this)},keys:function(){return new B(this,"keys")},values:function(){return new B(this,"values")},entries:function(){return new B(this,"entries")}},{enumerable:!0}),d(e,u,e.entries),d(e,"toString",(function(){for(var e,t=j(this).entries,r=[],n=0;n<t.length;)e=t[n++],r.push(s(e.key)+"="+s(e.value));return r.join("&")}),{enumerable:!0}),f(l,L),c({global:!0,forced:!h},{URLSearchParams:l}),h||"function"!=typeof A||"function"!=typeof C||c({global:!0,enumerable:!0,forced:!0},{fetch:function(e){var t,r,n;e=[e];return 1<arguments.length&&(w(t=arguments[1])&&(r=t.body,x(r)===L&&((n=t.headers?new C(t.headers):new C).has("content-type")||n.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"),t=S(t,{body:M(0,String(r)),headers:M(0,n)}))),e.push(t)),A.apply(this,e)}}),t.exports={URLSearchParams:l,getState:j}},{"../internals/an-instance":9,"../internals/an-object":10,"../internals/classof":29,"../internals/create-iterator-constructor":37,"../internals/create-property-descriptor":39,"../internals/export":50,"../internals/function-bind-context":54,"../internals/get-built-in":56,"../internals/get-iterator":58,"../internals/get-iterator-method":57,"../internals/has":60,"../internals/internal-state":70,"../internals/is-object":74,"../internals/native-url":84,"../internals/object-create":90,"../internals/redefine":108,"../internals/redefine-all":107,"../internals/set-to-string-tag":117,"../internals/well-known-symbol":146,"../modules/es.array.iterator":158}],232:[function(e,t,r){"use strict";function n(e){var t,r,n,i;if("number"==typeof e){for(t=[],r=0;r<4;r++)t.unshift(e%256),e=R(e/256);return t.join(".")}if("object"!=typeof e)return e;for(t="",n=Y(e),r=0;r<8;r++)i&&0===e[r]||(i=i&&!1,n===r?(t+=r?":":"::",i=!0):(t+=e[r].toString(16),r<7&&(t+=":")));return"["+t+"]"}function i(e){return!e.host||e.cannotBeABaseURL||"file"==e.scheme}function s(e,t,r,n){var i,s,o,a=r||le,c=0,u="",h=!1,d=!1,p=!1;for(r||(e.scheme="",e.username="",e.password="",e.host=null,e.port=null,e.path=[],e.query=null,e.fragment=null,e.cannotBeABaseURL=!1,t=t.replace(W,"")),t=t.replace(X,""),i=x(t);c<=i.length;){switch(s=i[c],a){case le:if(!s||!N.test(s)){if(r)return I;a=ue;continue}u+=s.toLowerCase(),a=ce;break;case ce:if(s&&(U.test(s)||"+"==s||"-"==s||"."==s))u+=s.toLowerCase();else{if(":"!=s){if(r)return I;u="",a=ue,c=0;continue}if(r&&(te(e)!=v(ee,u)||"file"==u&&(re(e)||null!==e.port)||"file"==e.scheme&&!e.host))return;if(e.scheme=u,r)return void(te(e)&&ee[e.scheme]==e.port&&(e.port=null));u="","file"==e.scheme?a=be:te(e)&&n&&n.scheme==e.scheme?a=he:te(e)?a=me:"/"==i[c+1]?(a=de,c++):(e.cannotBeABaseURL=!0,e.path.push(""),a=Ee)}break;case ue:if(!n||n.cannotBeABaseURL&&"#"!=s)return I;if(n.cannotBeABaseURL&&"#"==s){e.scheme=n.scheme,e.path=n.path.slice(),e.query=n.query,e.fragment="",e.cannotBeABaseURL=!0,a=Ce;break}a="file"==n.scheme?be:pe;continue;case he:if("/"!=s||"/"!=i[c+1]){a=pe;continue}a=ge,c++;break;case de:if("/"==s){a=ye;break}a=Te;continue;case pe:if(e.scheme=n.scheme,s==l)e.username=n.username,e.password=n.password,e.host=n.host,e.port=n.port,e.path=n.path.slice(),e.query=n.query;else if("/"==s||"\\"==s&&te(e))a=fe;else if("?"==s)e.username=n.username,e.password=n.password,e.host=n.host,e.port=n.port,e.path=n.path.slice(),e.query="",a=Ae;else{if("#"!=s){e.username=n.username,e.password=n.password,e.host=n.host,e.port=n.port,e.path=n.path.slice(),e.path.pop(),a=Te;continue}e.username=n.username,e.password=n.password,e.host=n.host,e.port=n.port,e.path=n.path.slice(),e.query=n.query,e.fragment="",a=Ce}break;case fe:if(!te(e)||"/"!=s&&"\\"!=s){if("/"!=s){e.username=n.username,e.password=n.password,e.host=n.host,e.port=n.port,a=Te;continue}a=ye}else a=ge;break;case me:if(a=ge,"/"!=s||"/"!=u.charAt(c+1))continue;c++;break;case ge:if("/"==s||"\\"==s)break;a=ye;continue;case ye:if("@"==s){h&&(u="%40"+u);h=!0;for(var f=x(u),m=0;m<f.length;m++){var g=f[m];":"!=g||p?(g=$(g,Q),p?e.password+=g:e.username+=g):p=!0}u=""}else if(s==l||"/"==s||"?"==s||"#"==s||"\\"==s&&te(e)){if(h&&""==u)return j;c-=x(u).length+1,u="",a=ve}else u+=s;break;case ve:case _e:if(r&&"file"==e.scheme){a=Se;continue}if(":"!=s||d){if(s==l||"/"==s||"?"==s||"#"==s||"\\"==s&&te(e)){if(te(e)&&""==u)return D;if(r&&""==u&&(re(e)||null!==e.port))return;if(o=q(e,u))return o;if(u="",a=Me,r)return;continue}"["==s?d=!0:"]"==s&&(d=!1),u+=s}else{if(""==u)return D;if(o=q(e,u))return o;if(u="",a=xe,r==_e)return}break;case xe:if(!k.test(s)){if(s==l||"/"==s||"?"==s||"#"==s||"\\"==s&&te(e)||r){if(""!=u){var y=parseInt(u,10);if(65535<y)return O;e.port=te(e)&&y===ee[e.scheme]?null:y,u=""}if(r)return;a=Me;continue}return O}u+=s;break;case be:if(e.scheme="file","/"==s||"\\"==s)a=we;else{if(!n||"file"!=n.scheme){a=Te;continue}if(s==l)e.host=n.host,e.path=n.path.slice(),e.query=n.query;else if("?"==s)e.host=n.host,e.path=n.path.slice(),e.query="",a=Ae;else{if("#"!=s){ie(i.slice(c).join(""))||(e.host=n.host,e.path=n.path.slice(),se(e)),a=Te;continue}e.host=n.host,e.path=n.path.slice(),e.query=n.query,e.fragment="",a=Ce}}break;case we:if("/"==s||"\\"==s){a=Se;break}n&&"file"==n.scheme&&!ie(i.slice(c).join(""))&&(ne(n.path[0],!0)?e.path.push(n.path[0]):e.host=n.host),a=Te;continue;case Se:if(s==l||"/"==s||"\\"==s||"?"==s||"#"==s){if(!r&&ne(u))a=Te;else{if(""==u){if(e.host="",r)return}else{if(o=q(e,u))return o;if("localhost"==e.host&&(e.host=""),r)return;u=""}a=Me}continue}u+=s;break;case Me:if(te(e)){if(a=Te,"/"!=s&&"\\"!=s)continue}else if(r||"?"!=s)if(r||"#"!=s){if(s!=l&&(a=Te,"/"!=s))continue}else e.fragment="",a=Ce;else e.query="",a=Ae;break;case Te:if(s==l||"/"==s||"\\"==s&&te(e)||!r&&("?"==s||"#"==s)){if(ae(u)?(se(e),"/"==s||"\\"==s&&te(e)||e.path.push("")):oe(u)?"/"==s||"\\"==s&&te(e)||e.path.push(""):("file"==e.scheme&&!e.path.length&&ne(u)&&(e.host&&(e.host=""),u=u.charAt(0)+":"),e.path.push(u)),u="","file"==e.scheme&&(s==l||"?"==s||"#"==s))for(;1<e.path.length&&""===e.path[0];)e.path.shift();"?"==s?(e.query="",a=Ae):"#"==s&&(e.fragment="",a=Ce)}else u+=$(s,K);break;case Ee:"?"==s?(e.query="",a=Ae):"#"==s?(e.fragment="",a=Ce):s!=l&&(e.path[0]+=$(s,Z));break;case Ae:r||"#"!=s?s!=l&&("'"==s&&te(e)?e.query+="%27":e.query+="#"==s?"%23":$(s,Z)):(e.fragment="",a=Ce);break;case Ce:s!=l&&(e.fragment+=$(s,J))}c++}}function o(e){var t,r,n=y(this,o,"URL"),i=1<arguments.length?arguments[1]:void 0,a=(e=String(e),C(n,{type:"URL"}));if(void 0!==i)if(i instanceof o)t=L(i);else if(r=s(t={},String(i)))throw TypeError(r);if(r=s(a,e,null,t))throw TypeError(r);var l=a.searchParams=new E;(i=A(l)).updateSearchParams(a.query),i.updateURL=function(){a.query=String(l)||null},d||(n.href=Le.call(n),n.origin=Re.call(n),n.protocol=Pe.call(n),n.username=je.call(n),n.password=Ie.call(n),n.host=De.call(n),n.hostname=Oe.call(n),n.port=Ne.call(n),n.pathname=Ue.call(n),n.search=ke.call(n),n.searchParams=Fe.call(n),n.hash=Be.call(n))}function a(e,t){return{get:e,set:t,configurable:!0,enumerable:!0}}e("../modules/es.string.iterator");var l,c,u,h=e("../internals/export"),d=e("../internals/descriptors"),p=e("../internals/native-url"),f=e("../internals/global"),m=e("../internals/object-define-properties"),g=e("../internals/redefine"),y=e("../internals/an-instance"),v=e("../internals/has"),_=e("../internals/object-assign"),x=e("../internals/array-from"),b=e("../internals/string-multibyte").codeAt,w=e("../internals/string-punycode-to-ascii"),S=e("../internals/set-to-string-tag"),M=e("../modules/web.url-search-params"),T=(e=e("../internals/internal-state"),f.URL),E=M.URLSearchParams,A=M.getState,C=e.set,L=e.getterFor("URL"),R=Math.floor,P=Math.pow,j="Invalid authority",I="Invalid scheme",D="Invalid host",O="Invalid port",N=/[A-Za-z]/,U=/[\d+-.A-Za-z]/,k=/\d/,F=/^(0x|0X)/,B=/^[0-7]+$/,z=/^\d+$/,G=/^[\dA-Fa-f]+$/,V=/[\u0000\u0009\u000A\u000D #%/:?@[\\]]/,H=/[\u0000\u0009\u000A\u000D #/:?@[\\]]/,W=/^[\u0000-\u001F ]+|[\u0000-\u001F ]+$/g,X=/[\u0009\u000A\u000D]/g,q=function(e,t){var r,n,i;if("["==t.charAt(0))return"]"==t.charAt(t.length-1)&&(r=function(e){var t,r,n,i,s,o,a,l=[0,0,0,0,0,0,0,0],c=0,u=null,h=0,d=function(){return e.charAt(h)};if(":"==d()){if(":"!=e.charAt(1))return;h+=2,u=++c}for(;d();){if(8==c)return;if(":"!=d()){for(t=r=0;r<4&&G.test(d());)t=16*t+parseInt(d(),16),h++,r++;if("."==d()){if(0==r)return;if(h-=r,c>6)return;for(n=0;d();){if(i=null,n>0){if(!("."==d()&&n<4))return;h++}if(!k.test(d()))return;for(;k.test(d());){if(s=parseInt(d(),10),null===i)i=s;else{if(0==i)return;i=10*i+s}if(i>255)return;h++}l[c]=256*l[c]+i,2!=++n&&4!=n||c++}if(4!=n)return;break}if(":"==d()){if(h++,!d())return}else if(d())return;l[c++]=t}else{if(null!==u)return;h++,u=++c}}if(null!==u)for(o=c-u,c=7;0!=c&&o>0;)a=l[c],l[c--]=l[u+o-1],l[u+--o]=a;else if(8!=c)return;return l}(t.slice(1,-1)))?void(e.host=r):D;if(te(e))return t=w(t),V.test(t)||null===(r=function(e){var t,r,n,i,s,o,a,l=e.split(".");if(l.length&&""==l[l.length-1]&&l.pop(),(t=l.length)>4)return e;for(r=[],n=0;n<t;n++){if(""==(i=l[n]))return e;if(s=10,i.length>1&&"0"==i.charAt(0)&&(s=F.test(i)?16:8,i=i.slice(8==s?1:2)),""===i)o=0;else{if(!(10==s?z:8==s?B:G).test(i))return e;o=parseInt(i,s)}r.push(o)}for(n=0;n<t;n++)if(o=r[n],n==t-1){if(o>=P(256,5-t))return null}else if(o>255)return null;for(a=r.pop(),n=0;n<r.length;n++)a+=r[n]*P(256,3-n);return a}(t))?D:void(e.host=r);if(H.test(t))return D;for(r="",n=x(t),i=0;i<n.length;i++)r+=$(n[i],Z);e.host=r},Y=function(e){for(var t=null,r=1,n=null,i=0,s=0;s<8;s++)0!==e[s]?(r<i&&(t=n,r=i),n=null,i=0):(null===n&&(n=s),++i);return r<i&&(t=n,r=i),t},Z={},J=_({},Z,{" ":1,'"':1,"<":1,">":1,"`":1}),K=_({},J,{"#":1,"?":1,"{":1,"}":1}),Q=_({},K,{"/":1,":":1,";":1,"=":1,"@":1,"[":1,"\\":1,"]":1,"^":1,"|":1}),$=function(e,t){var r=b(e,0);return 32<r&&r<127&&!v(t,e)?e:encodeURIComponent(e)},ee={ftp:21,file:null,http:80,https:443,ws:80,wss:443},te=function(e){return v(ee,e.scheme)},re=function(e){return""!=e.username||""!=e.password},ne=function(e,t){return 2==e.length&&N.test(e.charAt(0))&&(":"==(e=e.charAt(1))||!t&&"|"==e)},ie=function(e){return 1<e.length&&ne(e.slice(0,2))&&(2==e.length||"/"===(e=e.charAt(2))||"\\"===e||"?"===e||"#"===e)},se=function(e){var t=e.path,r=t.length;!r||"file"==e.scheme&&1==r&&ne(t[0],!0)||t.pop()},oe=function(e){return"."===e||"%2e"===e.toLowerCase()},ae=function(e){return".."===(e=e.toLowerCase())||"%2e."===e||".%2e"===e||"%2e%2e"===e},le={},ce={},ue={},he={},de={},pe={},fe={},me={},ge={},ye={},ve={},_e={},xe={},be={},we={},Se={},Me={},Te={},Ee={},Ae={},Ce={},Le=(f=o.prototype,function(){var e=L(this),t=e.scheme,r=e.username,i=e.password,s=e.host,o=e.port,a=e.path,l=e.query,c=e.fragment,u=t+":";return null!==s?(u+="//",re(e)&&(u+=r+(i?":"+i:"")+"@"),u+=n(s),null!==o&&(u+=":"+o)):"file"==t&&(u+="//"),u+=e.cannotBeABaseURL?a[0]:a.length?"/"+a.join("/"):"",null!==l&&(u+="?"+l),null!==c&&(u+="#"+c),u}),Re=function(){var e=L(this),t=e.scheme,r=e.port;if("blob"==t)try{return new URL(t.path[0]).origin}catch(e){return"null"}return"file"!=t&&te(e)?t+"://"+n(e.host)+(null!==r?":"+r:""):"null"},Pe=function(){return L(this).scheme+":"},je=function(){return L(this).username},Ie=function(){return L(this).password},De=function(){var e=(t=L(this)).host,t=t.port;return null===e?"":null===t?n(e):n(e)+":"+t},Oe=function(){var e=L(this).host;return null===e?"":n(e)},Ne=function(){var e=L(this).port;return null===e?"":String(e)},Ue=function(){var e=L(this),t=e.path;return e.cannotBeABaseURL?t[0]:t.length?"/"+t.join("/"):""},ke=function(){var e=L(this).query;return e?"?"+e:""},Fe=function(){return L(this).searchParams},Be=function(){var e=L(this).fragment;return e?"#"+e:""};d&&m(f,{href:a(Le,(function(e){var t=L(this);if(e=s(t,e=String(e)))throw TypeError(e);A(t.searchParams).updateSearchParams(t.query)})),origin:a(Re),protocol:a(Pe,(function(e){s(L(this),String(e)+":",le)})),username:a(je,(function(e){var t=L(this),r=x(String(e));if(!i(t)){t.username="";for(var n=0;n<r.length;n++)t.username+=$(r[n],Q)}})),password:a(Ie,(function(e){var t=L(this),r=x(String(e));if(!i(t)){t.password="";for(var n=0;n<r.length;n++)t.password+=$(r[n],Q)}})),host:a(De,(function(e){var t=L(this);t.cannotBeABaseURL||s(t,String(e),ve)})),hostname:a(Oe,(function(e){var t=L(this);t.cannotBeABaseURL||s(t,String(e),_e)})),port:a(Ne,(function(e){var t=L(this);i(t)||(""==(e=String(e))?t.port=null:s(t,e,xe))})),pathname:a(Ue,(function(e){var t=L(this);t.cannotBeABaseURL||(t.path=[],s(t,e+"",Me))})),search:a(ke,(function(e){var t=L(this);""==(e=String(e))?t.query=null:("?"==e.charAt(0)&&(e=e.slice(1)),t.query="",s(t,e,Ae)),A(t.searchParams).updateSearchParams(t.query)})),searchParams:a(Fe),hash:a(Be,(function(e){var t=L(this);""==(e=String(e))?t.fragment=null:("#"==e.charAt(0)&&(e=e.slice(1)),t.fragment="",s(t,e,Ce))}))}),g(f,"toJSON",(function(){return Le.call(this)}),{enumerable:!0}),g(f,"toString",(function(){return Le.call(this)}),{enumerable:!0}),T&&(c=T.createObjectURL,u=T.revokeObjectURL,c&&g(o,"createObjectURL",(function(e){return c.apply(T,arguments)})),u&&g(o,"revokeObjectURL",(function(e){return u.apply(T,arguments)}))),S(o,"URL"),h({global:!0,forced:!p,sham:!d},{URL:o})},{"../internals/an-instance":9,"../internals/array-from":17,"../internals/descriptors":43,"../internals/export":50,"../internals/global":59,"../internals/has":60,"../internals/internal-state":70,"../internals/native-url":84,"../internals/object-assign":89,"../internals/object-define-properties":91,"../internals/redefine":108,"../internals/set-to-string-tag":117,"../internals/string-multibyte":123,"../internals/string-punycode-to-ascii":124,"../modules/es.string.iterator":186,"../modules/web.url-search-params":231}],233:[function(e,t,r){"use strict";t.exports=e("./").polyfill()},{"./":234}],234:[function(e,t,n){(function(r,i){var s;s=function(){"use strict";function t(e){return"function"==typeof e}var n=Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)},s=0,o=void 0,a=void 0,l=function(e,t){f[s]=e,f[s+1]=t,2===(s+=2)&&(a?a(m):_())},c="undefined"!=typeof window?window:void 0,u=(u=c||{}).MutationObserver||u.WebKitMutationObserver,h="undefined"==typeof self&&void 0!==r&&"[object process]"==={}.toString.call(r),d="undefined"!=typeof Uint8ClampedArray&&"undefined"!=typeof importScripts&&"undefined"!=typeof MessageChannel;function p(){var e=setTimeout;return function(){return e(m,1)}}var f=new Array(1e3);function m(){for(var e=0;e<s;e+=2)(0,f[e])(f[e+1]),f[e]=void 0,f[e+1]=void 0;s=0}var g,y,v,_=void 0;function x(e,t){var r,n=this,i=new this.constructor(S),s=(void 0===i[w]&&N(i),n._state);return s?(r=arguments[s-1],l((function(){return D(s,i,r,n._result)}))):j(n,i,e,t),i}function b(e){var t;return e&&"object"==typeof e&&e.constructor===this?e:(C(t=new this(S),e),t)}_=h?function(){return r.nextTick(m)}:u?(y=0,h=new u(m),v=document.createTextNode(""),h.observe(v,{characterData:!0}),function(){v.data=y=++y%2}):d?((g=new MessageChannel).port1.onmessage=m,function(){return g.port2.postMessage(0)}):(void 0===c&&"function"==typeof e?function(){try{var e=Function("return this")().require("vertx");return void 0!==(o=e.runOnLoop||e.runOnContext)?function(){o(m)}:p()}catch(e){return p()}}:p)();var w=Math.random().toString(36).substring(2);function S(){}var M=void 0,T=1,E=2;function A(e,r,n){var i,s;r.constructor===e.constructor&&n===x&&r.constructor.resolve===b?(i=e,(s=r)._state===T?R(i,s._result):s._state===E?P(i,s._result):j(s,void 0,(function(e){return C(i,e)}),(function(e){return P(i,e)}))):void 0!==n&&t(n)?function(e,t,r){l((function(e){var n=!1,i=function(e,t,r,n){try{e.call(t,r,n)}catch(e){return e}}(r,t,(function(r){n||(n=!0,(t!==r?C:R)(e,r))}),(function(t){n||(n=!0,P(e,t))}),e._label);!n&&i&&(n=!0,P(e,i))}),e)}(e,r,n):R(e,r)}function C(e,t){if(e===t)P(e,new TypeError("You cannot resolve a promise with itself"));else if(r=typeof t,null===t||"object"!=r&&"function"!=r)R(e,t);else{r=void 0;try{r=t.then}catch(t){return void P(e,t)}A(e,t,r)}var r}function L(e){e._onerror&&e._onerror(e._result),I(e)}function R(e,t){e._state===M&&(e._result=t,e._state=T,0!==e._subscribers.length&&l(I,e))}function P(e,t){e._state===M&&(e._state=E,e._result=t,l(L,e))}function j(e,t,r,n){var i=e._subscribers,s=i.length;e._onerror=null,i[s]=t,i[s+T]=r,i[s+E]=n,0===s&&e._state&&l(I,e)}function I(e){var t=e._subscribers,r=e._state;if(0!==t.length){for(var n,i=void 0,s=e._result,o=0;o<t.length;o+=3)n=t[o],i=t[o+r],n?D(r,n,i,s):i(s);e._subscribers.length=0}}function D(e,r,n,i){var s=t(n),o=void 0,a=void 0,l=!0;if(s){try{o=n(i)}catch(e){l=!1,a=e}if(r===o)return void P(r,new TypeError("A promises callback cannot return that same promise."))}else o=i;r._state===M&&(s&&l?C(r,o):!1===l?P(r,a):e===T?R(r,o):e===E&&P(r,o))}var O=0;function N(e){e[w]=O++,e._state=void 0,e._result=void 0,e._subscribers=[]}k.prototype._enumerate=function(e){for(var t=0;this._state===M&&t<e.length;t++)this._eachEntry(e[t],t)},k.prototype._eachEntry=function(e,t){var r=this._instanceConstructor,n=r.resolve;if(n===b){var i,s=void 0,o=void 0,a=!1;try{s=e.then}catch(t){a=!0,o=t}s===x&&e._state!==M?this._settledAt(e._state,t,e._result):"function"!=typeof s?(this._remaining--,this._result[t]=e):r===F?(i=new r(S),a?P(i,o):A(i,e,s),this._willSettleAt(i,t)):this._willSettleAt(new r((function(t){return t(e)})),t)}else this._willSettleAt(n(e),t)},k.prototype._settledAt=function(e,t,r){var n=this.promise;n._state===M&&(this._remaining--,e===E?P(n,r):this._result[t]=r),0===this._remaining&&R(n,this._result)},k.prototype._willSettleAt=function(e,t){var r=this;j(e,void 0,(function(e){return r._settledAt(T,t,e)}),(function(e){return r._settledAt(E,t,e)}))};var U=k;function k(e,t){this._instanceConstructor=e,this.promise=new e(S),this.promise[w]||N(this.promise),n(t)?(this.length=t.length,this._remaining=t.length,this._result=new Array(this.length),0!==this.length&&(this.length=this.length||0,this._enumerate(t),0!==this._remaining)||R(this.promise,this._result)):P(this.promise,new Error("Array Methods must be provided an Array"))}B.prototype.catch=function(e){return this.then(null,e)},B.prototype.finally=function(e){var r=this.constructor;return t(e)?this.then((function(t){return r.resolve(e()).then((function(){return t}))}),(function(t){return r.resolve(e()).then((function(){throw t}))})):this.then(e,e)};var F=B;function B(e){if(this[w]=O++,this._result=this._state=void 0,this._subscribers=[],S!==e){if("function"!=typeof e)throw new TypeError("You must pass a resolver function as the first argument to the promise constructor");if(!(this instanceof B))throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.");var t=this;try{e((function(e){C(t,e)}),(function(e){P(t,e)}))}catch(e){P(t,e)}}}return F.prototype.then=x,F.all=function(e){return new U(this,e).promise},F.race=function(e){var t=this;return n(e)?new t((function(r,n){for(var i=e.length,s=0;s<i;s++)t.resolve(e[s]).then(r,n)})):new t((function(e,t){return t(new TypeError("You must pass an array to race."))}))},F.resolve=b,F.reject=function(e){var t=new this(S);return P(t,e),t},F._setScheduler=function(e){a=e},F._setAsap=function(e){l=e},F._asap=l,F.polyfill=function(){var e=void 0;if(void 0!==i)e=i;else if("undefined"!=typeof self)e=self;else try{e=Function("return this")()}catch(e){throw new Error("polyfill failed because global object is unavailable in this environment")}var t=e.Promise;if(t){var r=null;try{r=Object.prototype.toString.call(t.resolve())}catch(e){}if("[object Promise]"===r&&!t.cast)return}e.Promise=F},F.Promise=F},"object"==typeof n&&void 0!==t?t.exports=s():this.ES6Promise=s()}).call(this,e("_process"),void 0!==r.g?r.g:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{_process:243}],235:[function(e,t,r){var n;n=function(e,t){"use strict";var r=5e3,n="callback";function i(e){try{delete window[e]}catch(t){window[e]=void 0}}function s(e){(e=document.getElementById(e))&&document.getElementsByTagName("head")[0].removeChild(e)}t.exports=function(e){var t=arguments.length<=1||void 0===arguments[1]?{}:arguments[1],o=e,a=t.timeout||r,l=t.jsonpCallback||n,c=void 0;return new Promise((function(r,n){var u=t.jsonpCallbackFunction||"jsonp_"+Date.now()+"_"+Math.ceil(1e5*Math.random()),h=l+"_"+u,d=(window[u]=function(e){r({ok:!0,json:function(){return Promise.resolve(e)}}),c&&clearTimeout(c),s(h),i(u)},o+=-1===o.indexOf("?")?"?":"&",document.createElement("script"));d.setAttribute("src",""+o+l+"="+u),t.charset&&d.setAttribute("charset",t.charset),d.id=h,document.getElementsByTagName("head")[0].appendChild(d),c=setTimeout((function(){n(new Error("JSONP request to "+e+" timed out")),i(u),s(h),window[u]=function(){i(u)}}),a),d.onerror=function(){n(new Error("JSONP request to "+e+" failed")),i(u),s(h),c&&clearTimeout(c)}}))}},void 0!==r&&void 0!==t?n(0,t):(n(n={exports:{}},n),this.fetchJsonp=n.exports)},{}],236:[function(e,t,r){var n=function(e){"use strict";var t,r,n,i,s,o,a,l,c,u;if(!(void 0===e||"undefined"!=typeof navigator&&/MSIE [1-9]\./.test(navigator.userAgent)))return u=e.document,t=function(){return e.URL||e.webkitURL||e},r=u.createElementNS("http://www.w3.org/1999/xhtml","a"),n="download"in r,i=/constructor/i.test(e.HTMLElement)||e.safari,s=/CriOS\/[\d]+/.test(navigator.userAgent),o=function(t){(e.setImmediate||e.setTimeout)((function(){throw t}),0)},4e4,a=function(e){setTimeout((function(){"string"==typeof e?t().revokeObjectURL(e):e.remove()}),4e4)},l=function(e){return/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(e.type)?new Blob([String.fromCharCode(65279),e],{type:e.type}):e},u=(c=function(c,u,h){h||(c=l(c));var d,p,f=this,m=(h="application/octet-stream"===c.type,function(){for(var e=f,t="writestart progress write writeend".split(" "),r=(t=[].concat(t)).length;r--;){var n=e["on"+t[r]];if("function"==typeof n)try{n.call(e,e)}catch(e){o(e)}}});f.readyState=f.INIT,n?(d=t().createObjectURL(c),setTimeout((function(){var e,t;r.href=d,r.download=u,e=r,t=new MouseEvent("click"),e.dispatchEvent(t),m(),a(d),f.readyState=f.DONE}))):(s||h&&i)&&e.FileReader?((p=new FileReader).onloadend=function(){var t=s?p.result:p.result.replace(/^data:[^;]*;/,"data:attachment/file;");e.open(t,"_blank")||(e.location.href=t),t=void 0,f.readyState=f.DONE,m()},p.readAsDataURL(c),f.readyState=f.INIT):(d=d||t().createObjectURL(c),!h&&e.open(d,"_blank")||(e.location.href=d),f.readyState=f.DONE,m(),a(d))}).prototype,"undefined"!=typeof navigator&&navigator.msSaveOrOpenBlob?function(e,t,r){return t=t||e.name||"download",r||(e=l(e)),navigator.msSaveOrOpenBlob(e,t)}:(u.abort=function(){},u.readyState=u.INIT=0,u.WRITING=1,u.DONE=2,u.error=u.onwritestart=u.onprogress=u.onwrite=u.onabort=u.onerror=u.onwriteend=null,function(e,t,r){return new c(e,t||e.name||"download",r)})}("undefined"!=typeof self&&self||"undefined"!=typeof window&&window||this.content);void 0!==t&&t.exports&&(t.exports.saveAs=n)},{}],237:[function(e,t,r){var n,i=Object.defineProperty,s=(i(r,"__esModule",{value:!0}),r),o={GIFEncoder:()=>w,applyPalette:()=>function(e,t,r="rgb565"){if(!e||!e.buffer)throw new Error("quantize() expected RGBA Uint8Array data");if(!(e instanceof Uint8Array||e instanceof Uint8ClampedArray))throw new Error("quantize() expected RGBA Uint8Array data");if(256<t.length)throw new Error("applyPalette() only works with 256 colors or less");const n=new Uint32Array(e.buffer),i=n.length,s="rgb444"===r?4096:65536,o=new Uint8Array(i),a=new Array(s);if("rgba4444"===r)for(let e=0;e<i;e++){var l,c=(l=n[e])>>24&255,u=l>>16&255,f=l>>8&255,m=(m=d(l=255&l,f,u,c))in a?a[m]:a[m]=function(e,t,r,n,i){let s=0,o=1e100;for(let c=0;c<i.length;c++){var a=i[c],l=_(a[3]-n);l>o||((l+=_(a[0]-e))>o||((l+=_(a[1]-t))>o||((l+=_(a[2]-r))>o||(o=l,s=c))))}return s}(l,f,u,c,t);o[e]=m}else{const e="rgb444"===r?p:h;for(let r=0;r<i;r++){var g,y=(g=n[r])>>16&255,v=g>>8&255,x=(x=e(g=255&g,v,y))in a?a[x]:a[x]=function(e,t,r,n){let i=0,s=1e100;for(let l=0;l<n.length;l++){var o=n[l],a=_(o[0]-e);a>s||((a+=_(o[1]-t))>s||((a+=_(o[2]-r))>s||(s=a,i=l)))}return i}(g,v,y,t);o[r]=x}}return o},default:()=>A,nearestColor:()=>function(e,t,r=y){return e[x(e,t,r)]},nearestColorIndex:()=>x,nearestColorIndexWithDistance:()=>b,prequantize:()=>function(e,{roundRGB:t=5,roundAlpha:r=10,oneBitAlpha:n=null}={}){const i=new Uint32Array(e.buffer);for(let e=0;e<i.length;e++){let l=(a=i[e])>>24&255;var s=a>>16&255,o=a>>8&255,a=255&a;l=v(l,r),n&&(l=l<=("number"==typeof n?n:127)?0:255),a=v(a,t),o=v(o,t),s=v(s,t),i[e]=l<<24|s<<16|o<<8|a<<0}},quantize:()=>function(e,t,r={}){var{format:n="rgb565",clearAlpha:i=!0,clearAlphaColor:s=0,clearAlphaThreshold:o=0,oneBitAlpha:a=!1}=r;if(!e||!e.buffer)throw new Error("quantize() expected RGBA Uint8Array data");if(!(e instanceof Uint8Array||e instanceof Uint8ClampedArray))throw new Error("quantize() expected RGBA Uint8Array data");e=new Uint32Array(e.buffer);let l=!1!==r.useSqrt;const c="rgba4444"===n,u=function(e,t){const r=new Array("rgb444"===t?4096:65536),n=e.length;if("rgba4444"===t)for(let t=0;t<n;++t){var i,s=(i=e[t])>>24&255,o=i>>16&255,a=i>>8&255,l=d(i=255&i,a,o,s);let n=l in r?r[l]:r[l]={ac:0,rc:0,gc:0,bc:0,cnt:0,nn:0,fw:0,bk:0,tm:0,mtm:0,err:0};n.rc+=i,n.gc+=a,n.bc+=o,n.ac+=s,n.cnt++}else if("rgb444"===t)for(let t=0;t<n;++t){var c,u=(c=e[t])>>16&255,f=c>>8&255,m=p(c=255&c,f,u);let n=m in r?r[m]:r[m]={ac:0,rc:0,gc:0,bc:0,cnt:0,nn:0,fw:0,bk:0,tm:0,mtm:0,err:0};n.rc+=c,n.gc+=f,n.bc+=u,n.cnt++}else for(let t=0;t<n;++t){var g,y=(g=e[t])>>16&255,v=g>>8&255,_=h(g=255&g,v,y);let n=_ in r?r[_]:r[_]={ac:0,rc:0,gc:0,bc:0,cnt:0,nn:0,fw:0,bk:0,tm:0,mtm:0,err:0};n.rc+=g,n.gc+=v,n.bc+=y,n.cnt++}return r}(e,n),y=u.length,v=y-1,_=new Uint32Array(y+1);for(var x=0,b=0;b<y;++b){const e=u[b];null!=e&&(j=1/e.cnt,c&&(e.ac*=j),e.rc*=j,e.gc*=j,e.bc*=j,u[x++]=e)}m(t)/x<.022&&(l=!1);var w,S,M;for(b=0;b<x-1;++b)u[b].fw=b+1,u[b+1].bk=b,l&&(u[b].cnt=Math.sqrt(u[b].cnt));for(l&&(u[b].cnt=Math.sqrt(u[b].cnt)),b=0;b<x;++b){g(u,b,!1);var T=u[b].err;for(S=++_[0];1<S&&!(u[w=_[M=S>>1]].err<=T);S=M)_[S]=w;_[S]=b}var E,A=x-t;for(b=0;b<A;){for(;;){var C=_[1];if((E=u[C]).tm>=E.mtm&&u[E.nn].mtm<=E.tm)break;for(E.mtm==v?C=_[1]=_[_[0]--]:(g(u,C,!1),E.tm=b),T=u[C].err,S=1;(M=S+S)<=_[0]&&(M<_[0]&&u[_[M]].err>u[_[M+1]].err&&M++,!(T<=u[w=_[M]].err));S=M)_[S]=w;_[S]=C}var L=u[E.nn],R=E.cnt,P=L.cnt,j=1/(R+P);c&&(E.ac=j*(R*E.ac+P*L.ac)),E.rc=j*(R*E.rc+P*L.rc),E.gc=j*(R*E.gc+P*L.gc),E.bc=j*(R*E.bc+P*L.bc),E.cnt+=L.cnt,E.mtm=++b,u[L.bk].fw=L.fw,u[L.fw].bk=L.bk,L.mtm=v}let I=[];for(b=0;;0){let e=f(Math.round(u[b].rc),0,255),t=f(Math.round(u[b].gc),0,255),r=f(Math.round(u[b].bc),0,255),n=255;c&&(n=f(Math.round(u[b].ac),0,255),a&&(n=n<=(D="number"==typeof a?a:127)?0:255),i&&n<=o&&(e=t=r=s,n=0));var D=c?[e,t,r,n]:[e,t,r];if(function(e,t){for(let i=0;i<e.length;i++){var r=(n=e[i])[0]===t[0]&&n[1]===t[1]&&n[2]===t[2],n=!(4<=n.length&&4<=t.length)||n[3]===t[3];if(r&&n)return!0}return!1}(I,D)||I.push(D),0==(b=u[b].fw))break}return I},snapColorsToPalette:()=>function(e,t,r=5){if(e.length&&t.length){var n=e.map((e=>e.slice(0,3))),i=r*r,s=e[0].length;for(let r=0;r<t.length;r++){let l=t[r];l=l.length<s?[l[0],l[1],l[2],255]:l.length>s?l.slice(0,3):l.slice();var o,a=(o=b(n,l.slice(0,3),y))[0];0<(o=o[1])&&o<=i&&(e[a]=l)}}}};for(n in o)i(s,n,{get:o[n],enumerable:!0});var a={signature:"GIF",version:"89a",trailer:59,extensionIntroducer:33,applicationExtensionLabel:255,graphicControlExtensionLabel:249,imageSeparator:44,signatureSize:3,versionSize:3,globalColorTableFlagMask:128,colorResolutionMask:112,sortFlagMask:8,globalColorTableSizeMask:7,applicationIdentifierSize:8,applicationAuthCodeSize:3,disposalMethodMask:28,userInputFlagMask:2,transparentColorFlagMask:1,localColorTableFlagMask:128,interlaceFlagMask:64,idSortFlagMask:32,localColorTableSizeMask:7};function l(e=256){let t=0,r=new Uint8Array(e);return{get buffer(){return r.buffer},reset(){t=0},bytesView:()=>r.subarray(0,t),bytes:()=>r.slice(0,t),writeByte(e){n(t+1),r[t]=e,t++},writeBytes(e,i=0,s=e.length){n(t+s);for(let n=0;n<s;n++)r[t++]=e[n+i]},writeBytesView(e,i=0,s=e.byteLength){n(t+s),r.set(e.subarray(i,i+s),t),t+=s}};function n(e){var n=r.length;if(!(e<=n)){e=Math.max(e,n*(n<1048576?2:1.125)>>>0),0!=n&&(e=Math.max(e,256));const i=r;r=new Uint8Array(e),0<t&&r.set(i.subarray(0,t),0)}}}var c=[0,1,3,7,15,31,63,127,255,511,1023,2047,4095,8191,16383,32767,65535],u=function(e,t,r,n,i=l(512),s=new Uint8Array(256),o=new Int32Array(5003),a=new Int32Array(5003)){var u=o.length;n=Math.max(2,n);s.fill(0),a.fill(0),o.fill(-1);let h=0,d=0;var p=n+1;const f=p;let m=!1,g=f,y=(1<<g)-1;var v=1<<p-1;const _=1+v;let x=2+v,b=0,w=r[0],S=0;for(let e=u;e<65536;e*=2)++S;S=8-S,i.writeByte(n),C(v);var M=r.length;for(let e=1;e<M;e++)e:{var T=r[e],E=(T<<12)+w;let t=T<<S^w;if(o[t]===E)w=a[t];else{for(var A=0===t?1:u-t;0<=o[t];)if((t-=A)<0&&(t+=u),o[t]===E){w=a[t];break e}C(w),w=T,x<4096?(a[t]=x++,o[t]=E):(o.fill(-1),x=2+v,m=!0,C(v))}}return C(w),C(_),i.writeByte(0),i.bytesView();function C(e){for(h&=c[d],0<d?h|=e<<d:h=e,d+=g;8<=d;)s[b++]=255&h,254<=b&&(i.writeByte(b),i.writeBytesView(s,0,b),b=0),h>>=8,d-=8;if((x>y||m)&&(m?(g=f,y=(1<<g)-1,m=!1):(++g,y=12===g?1<<g:(1<<g)-1)),e==_){for(;0<d;)s[b++]=255&h,254<=b&&(i.writeByte(b),i.writeBytesView(s,0,b),b=0),h>>=8,d-=8;0<b&&(i.writeByte(b),i.writeBytesView(s,0,b),b=0)}}};function h(e,t,r){return e<<8&63488|t<<2&992|r>>3}function d(e,t,r,n){return e>>4|240&t|(240&r)<<4|(240&n)<<8}function p(e,t,r){return e>>4<<8|240&t|r>>4}function f(e,t,r){return e<t?t:r<e?r:e}function m(e){return e*e}function g(e,t,r){var n=0,i=1e100;const s=e[t];for(var o=s.cnt,a=s.ac,l=s.rc,c=s.gc,u=s.bc,h=s.fw;0!=h;h=e[h].fw){var d,p,f=e[h];i<=(p=o*(p=f.cnt)/(o+p))||(d=0,r&&i<=(d+=p*m(f.ac-a))||i<=(d+=p*m(f.rc-l))||i<=(d+=p*m(f.gc-c))||i<=(d+=p*m(f.bc-u))||(i=d,n=h))}s.err=i,s.nn=n}function y(e,t){for(var r=0,n=0;n<e.length;n++){var i=e[n]-t[n];r+=i*i}return r}function v(e,t){return 1<t?Math.round(e/t)*t:e}function _(e){return e*e}function x(e,t,r=y){let n=1/0,i=-1;for(let o=0;o<e.length;o++){var s=r(t,e[o]);s<n&&(n=s,i=o)}return i}function b(e,t,r=y){let n=1/0,i=-1;for(let o=0;o<e.length;o++){var s=r(t,e[o]);s<n&&(n=s,i=o)}return[i,n]}function w(e={}){const{initialCapacity:t=4096,auto:r=!0}=e,n=l(t),i=new Uint8Array(256),s=new Int32Array(5003),o=new Int32Array(5003);let c=!1;return{reset(){n.reset(),c=!1},finish(){n.writeByte(a.trailer)},bytes:()=>n.bytes(),bytesView:()=>n.bytesView(),get buffer(){return n.buffer},get stream(){return n},writeHeader:h,writeFrame(e,t,a,l={}){var{transparent:d=!1,transparentIndex:p=0,delay:f=0,palette:m=null,repeat:g=0,colorDepth:y=8,dispose:v=-1}=l;let _=!1;if(r?c||(_=!0,h(),c=!0):_=Boolean(l.first),t=Math.max(0,Math.floor(t)),a=Math.max(0,Math.floor(a)),_){if(!m)throw new Error("First frame must include a { palette } option");var[l,x,b,w,A=8]=[n,t,a,m,y];A=128|A-1<<4|(w=E(w.length)-1),M(l,x),M(l,b),l.writeBytes([A,0,0]),S(n,m),0<=g&&(x=g,(w=n).writeByte(33),w.writeByte(255),w.writeByte(11),T(w,"NETSCAPE2.0"),w.writeByte(3),w.writeByte(1),M(w,x),w.writeByte(0))}var C,b,A=v,g=b=Math.round(f/10),x=d,w=p,f=((l=n).writeByte(33),l.writeByte(249),l.writeByte(4),w<0&&(w=0,x=!1),x=x?(C=1,2):C=0,0<=A&&(x=7&A),x<<=2,l.writeByte(0|x|C),M(l,g),l.writeByte(w||0),l.writeByte(0),Boolean(m)&&!_);d=t,p=a,C=f?m:null,(v=n).writeByte(44),M(v,0),M(v,0),M(v,d),M(v,p),C?(d=E(C.length)-1,v.writeByte(128|d)):v.writeByte(0),f&&S(n,m),[g,l,p,d,v=8,f,m,e]=[n,e,t,a,y,i,s,o],u(p,d,l,v,g,f,m,e)}};function h(){T(n,"GIF89a")}}function S(e,t){var r=1<<E(t.length);for(let n=0;n<r;n++){let r=[0,0,0];n<t.length&&(r=t[n]),e.writeByte(r[0]),e.writeByte(r[1]),e.writeByte(r[2])}}function M(e,t){e.writeByte(255&t),e.writeByte(t>>8&255)}function T(e,t){for(var r=0;r<t.length;r++)e.writeByte(t.charCodeAt(r))}function E(e){return Math.max(Math.ceil(Math.log2(e)),1)}var A=w},{}],238:[function(e,t,r){r.read=function(e,t,r,n,i){var s,o,a=8*i-n-1,l=(1<<a)-1,c=l>>1,u=-7,h=r?i-1:0,d=r?-1:1;i=e[t+h];for(h+=d,s=i&(1<<-u)-1,i>>=-u,u+=a;0<u;s=256*s+e[t+h],h+=d,u-=8);for(o=s&(1<<-u)-1,s>>=-u,u+=n;0<u;o=256*o+e[t+h],h+=d,u-=8);if(0===s)s=1-c;else{if(s===l)return o?NaN:1/0*(i?-1:1);o+=Math.pow(2,n),s-=c}return(i?-1:1)*o*Math.pow(2,s-n)},r.write=function(e,t,r,n,i,s){var o,a,l=8*s-i-1,c=(1<<l)-1,u=c>>1,h=23===i?Math.pow(2,-24)-Math.pow(2,-77):0,d=n?0:s-1,p=n?1:-1;s=t<0||0===t&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(a=isNaN(t)?1:0,o=c):(o=Math.floor(Math.log(t)/Math.LN2),t*(n=Math.pow(2,-o))<1&&(o--,n*=2),2<=(t+=1<=o+u?h/n:h*Math.pow(2,1-u))*n&&(o++,n/=2),c<=o+u?(a=0,o=c):1<=o+u?(a=(t*n-1)*Math.pow(2,i),o+=u):(a=t*Math.pow(2,u-1)*Math.pow(2,i),o=0));8<=i;e[r+d]=255&a,d+=p,a/=256,i-=8);for(o=o<<i|a,l+=i;0<l;e[r+d]=255&o,d+=p,o/=256,l-=8);e[r+d-p]|=128*s}},{}],239:[function(e,t,r){"use strict";var n;function i(e,t){return e.b===t.b&&e.a===t.a}function s(e,t){return e.b<t.b||e.b===t.b&&e.a<=t.a}function o(e,t,r){var n=t.b-e.b,i=r.b-t.b;return 0<n+i?n<i?t.a-e.a+n/(n+i)*(e.a-r.a):t.a-r.a+i/(n+i)*(r.a-e.a):0}function a(e,t,r){var n=t.b-e.b,i=r.b-t.b;return 0<n+i?(t.a-r.a)*n+(t.a-e.a)*i:0}function l(e,t){return e.a<t.a||e.a===t.a&&e.b<=t.b}function c(e,t,r){var n=t.a-e.a,i=r.a-t.a;return 0<n+i?n<i?t.b-e.b+n/(n+i)*(e.b-r.b):t.b-r.b+i/(n+i)*(r.b-e.b):0}function u(e,t,r){var n=t.a-e.a,i=r.a-t.a;return 0<n+i?(t.b-r.b)*n+(t.b-e.b)*i:0}function h(e,t,r,n){return(e=e<0?0:e)<=(r=r<0?0:r)?0===r?(t+n)/2:t+e/(e+r)*(n-t):n+r/(e+r)*(t-n)}function d(e){var t=y(e.b);return _(t,e.c),_(t.b,e.c),x(t,e.a),t}function p(e,t){var r=!1,n=!1;e!==t&&(t.a!==e.a&&(n=!0,w(t.a,e.a)),t.d!==e.d&&(r=!0,S(t.d,e.d)),v(t,e),n||(_(t,e.a),e.a.c=e),r||(x(t,e.d),e.d.a=e))}function f(e){var t=e.b,r=!1;e.d!==e.b.d&&(r=!0,S(e.d,e.b.d)),e.c===e?w(e.a,null):(e.b.d.a=e.b.e,e.a.c=e.c,v(e,e.b.e),r||x(e,e.d)),t.c===t?(w(t.a,null),S(t.d,null)):(e.d.a=t.b.e,t.a.c=t.c,v(t,t.b.e)),b(e)}function m(e){var t=y(e),r=t.b;return v(t,e.e),t.a=e.b.a,_(r,t.a),t.d=r.d=e.d,t=t.b,v(e.b,e.b.b.e),v(e.b,t),e.b.a=t.a,t.b.a.c=t.b,t.b.d=e.b.d,t.f=e.f,t.b.f=e.b.f,t}function g(e,t){var r=!1,n=y(e),i=n.b;return t.d!==e.d&&(r=!0,S(t.d,e.d)),v(n,e.e),v(i,t),n.a=e.b.a,i.a=t.a,n.d=i.d=e.d,e.d.a=i,r||x(n,e.d),n}function y(e){var t=new Z,r=new Z,n=e.b.h;return(((r.h=n).b.h=t).h=e).b.h=r,t.b=r,((t.c=t).e=r).b=t,(r.c=r).e=t}function v(e,t){var r=e.c,n=t.c;r.b.e=t,(n.b.e=e).c=n,t.c=r}function _(e,t){var r=t.f,n=new K(t,r);for(r.e=n,r=(t.f=n).c=e;r.a=n,(r=r.c)!==e;);}function x(e,t){var r=t.d,n=new Y(t,r);for(r.b=n,(t.d=n).a=e,n.c=t.c,r=e;r.d=n,(r=r.e)!==e;);}function b(e){var t=e.h;e=e.b.h,(t.b.h=e).b.h=t}function w(e,t){for(var r=e.c,n=r;n.a=t,(n=n.c)!==r;);r=e.f,((n=e.e).f=r).e=n}function S(e,t){for(var r=e.a,n=r;n.d=t,(n=n.e)!==r;);r=e.d,((n=e.b).d=r).b=n}function M(e){var t=0;return Math.abs(e[1])>Math.abs(e[0])&&(t=1),Math.abs(e[2])>Math.abs(e[t])?2:t}function T(e,t){e.f+=t.f,e.b.f+=t.b.f}function E(e,t,r){return e=e.a,t=t.a,r=r.a,t.b.a===e?r.b.a===e?s(t.a,r.a)?a(r.b.a,t.a,r.a)<=0:0<=a(t.b.a,r.a,t.a):a(r.b.a,e,r.a)<=0:r.b.a===e?0<=a(t.b.a,e,t.a):(t=o(t.b.a,e,t.a),(e=o(r.b.a,e,r.a))<=t)}function A(e){e.a.i=null;var t=e.e;t.a.c=t.c,t.c.a=t.a,e.e=null}function C(e,t){f(e.a),e.c=!1,(e.a=t).i=e}function L(e){for(var t=e.a.a;(e=ce(e)).a.a===t;);return e.c&&(C(e,t=g(le(e).a.b,e.a.e)),e=ce(e)),e}function R(e,t,r){var n=new ae;return n.a=r,n.e=V(e.f,t.e,n),r.i=n}function P(e,t){switch(e.s){case 100130:return 0!=(1&t);case 100131:return 0!==t;case 100132:return 0<t;case 100133:return t<0;case 100134:return 2<=t||t<=-2}return!1}function j(e){var t=e.a,r=t.d;r.c=e.d,r.a=t,A(e)}function I(e,t,r){for(t=(e=t).a;e!==r;){e.c=!1;var n=le(e),i=n.a;if(i.a!==t.a){if(!n.c){j(e);break}C(n,i=g(t.c.b,i.b))}t.c!==i&&(p(i.b.e,i),p(t,i)),j(e),t=n.a,e=n}return t}function D(e,t,r,n,i,s){for(var o=!0;R(e,t,r.b),(r=r.c)!==n;);for(null===i&&(i=le(t).a.b.c);(r=(n=le(t)).a.b).a===i.a;)r.c!==i&&(p(r.b.e,r),p(i.b.e,r)),n.f=t.f-r.f,n.d=P(e,n.f),t.b=!0,!o&&k(e,t)&&(T(r,i),A(t),f(i)),o=!1,t=n,i=r;t.b=!0,s&&B(e,t)}function O(e,t,r,n,i){var s=[t.g[0],t.g[1],t.g[2]];t.d=null,t.d=e.o&&e.o(s,r,n,e.c)||null,null===t.d&&(i?e.n||(q(e,100156),e.n=!0):t.d=r[0])}function N(e,t,r){var n=[null,null,null,null];n[0]=t.a.d,n[1]=r.a.d,O(e,t.a,n,[.5,.5,0,0],!1),p(t,r)}function U(e,t,r,n,i){var s=Math.abs(t.b-e.b)+Math.abs(t.a-e.a),o=Math.abs(r.b-e.b)+Math.abs(r.a-e.a),a=i+1;n[i]=.5*o/(s+o),n[a]=.5*s/(s+o),e.g[0]+=n[i]*t.g[0]+n[a]*r.g[0],e.g[1]+=n[i]*t.g[1]+n[a]*r.g[1],e.g[2]+=n[i]*t.g[2]+n[a]*r.g[2]}function k(e,t){var r=le(t),n=t.a,o=r.a;if(s(n.a,o.a)){if(0<a(o.b.a,n.a,o.a))return;if(i(n.a,o.a)){if(n.a!==o.a){r=e.e;var l=n.a.h;if(0<=l){var c=(r=r.b).d,u=r.e,h=r.c,d=h[l];c[d]=c[r.a],(h[c[d]]=d)<=--r.a&&(d<=1||s(u[c[d>>1]],u[c[d]])?se:oe)(r,d),u[l]=null,h[l]=r.b,r.b=l}else for(r.c[-(l+1)]=null;0<r.a&&null===r.c[r.d[r.a-1]];)--r.a;N(e,o.b.e,n)}}else m(o.b),p(n,o.b.e),t.b=r.b=!0}else{if(a(n.b.a,o.a,n.a)<0)return;ce(t).b=t.b=!0,m(n.b),p(o.b.e,n)}return 1}function F(e,t){var r=le(t),n=t.a,d=r.a,f=n.a,g=d.a,y=n.b.a,v=d.b.a,_=new K;if(a(y,e.a,f),a(v,e.a,g),!(f===g||Math.min(f.a,y.a)>Math.max(g.a,v.a))){if(s(f,g)){if(0<a(v,f,g))return}else if(a(y,g,f)<0)return;var x,b,w=y,S=f,M=v,T=g;if(s(w,S)||(x=w,w=S,S=x),s(M,T)||(x=M,M=T,T=x),s(w,M)||(x=w,w=M,M=x,x=S,S=T,T=x),s(M,S)?s(S,T)?((x=o(w,M,S))+(b=o(M,S,T))<0&&(x=-x,b=-b),_.b=h(x,M.b,b,S.b)):((x=a(w,M,S))+(b=-a(w,T,S))<0&&(x=-x,b=-b),_.b=h(x,M.b,b,T.b)):_.b=(M.b+S.b)/2,l(w,S)||(x=w,w=S,S=x),l(M,T)||(x=M,M=T,T=x),l(w,M)||(x=w,w=M,M=x,x=S,S=T,T=x),l(M,S)?l(S,T)?((x=c(w,M,S))+(b=c(M,S,T))<0&&(x=-x,b=-b),_.a=h(x,M.a,b,S.a)):((x=u(w,M,S))+(b=-u(w,T,S))<0&&(x=-x,b=-b),_.a=h(x,M.a,b,T.a)):_.a=(M.a+S.a)/2,s(_,e.a)&&(_.b=e.a.b,_.a=e.a.a),w=s(f,g)?f:g,s(w,_)&&(_.b=w.b,_.a=w.a),i(_,f)||i(_,g))return k(e,t),0;if(!i(y,e.a)&&0<=a(y,e.a,_)||!i(v,e.a)&&a(v,e.a,_)<=0){if(v===e.a)m(n.b),p(d.b,n),n=le(t=L(t)).a,I(e,le(t),r),D(e,t,n.b.e,n,n,!0);else{if(y!==e.a)return 0<=a(y,e.a,_)&&(ce(t).b=t.b=!0,m(n.b),n.a.b=e.a.b,n.a.a=e.a.a),void(a(v,e.a,_)<=0&&(t.b=r.b=!0,m(d.b),d.a.b=e.a.b,d.a.a=e.a.a));for(m(d.b),p(n.e,d.b.e),g=(f=r=t).a.b.a;(f=ce(f)).a.b.a===g;);f=le(t=f).a.b.c,r.a=d.b.e,D(e,t,(d=I(e,r,null)).c,n.b.c,f,!0)}return 1}m(n.b),m(d.b),p(d.b.e,n),n.a.b=_.b,n.a.a=_.a,n.a.h=$(e.e,n.a),n=n.a,d=[0,0,0,0],_=[f.d,y.d,g.d,v.d],n.g[0]=n.g[1]=n.g[2]=0,U(n,f,y,d,0),U(n,g,v,d,2),O(e,n,_,d,!0),ce(t).b=t.b=r.b=!0}}function B(e,t){for(var r=le(t);;){for(;r.b;)r=le(t=r);if(!(t.b||null!==(t=ce(r=t))&&t.b))break;t.b=!1;var n=t.a,i=r.a;if(o=n.b.a!==i.b.a)e:{var o,l=le(o=t),c=o.a,u=l.a,h=void 0;if(s(c.b.a,u.b.a)){if(a(c.b.a,u.b.a,c.a)<0){o=!1;break e}ce(o).b=o.b=!0,h=m(c),p(u.b,h),h.d.c=o.d}else{if(0<a(u.b.a,c.b.a,u.a)){o=!1;break e}o.b=l.b=!0,h=m(u),p(c.e,u.b),h.b.d.c=o.d}o=!0}if(o&&(r.c?(A(r),f(i),i=(r=le(t)).a):t.c&&(A(t),f(n),n=(t=ce(r)).a)),n.a!==i.a)if(n.b.a===i.b.a||t.c||r.c||n.b.a!==e.a&&i.b.a!==e.a)k(e,t);else if(F(e,t))break;n.a===i.a&&n.b.a===i.b.a&&(T(i,n),A(t),f(n),t=ce(r))}}function z(e,t){var r=new ae,n=d(e.b);n.a.b=4e150,n.a.a=t,n.b.a.b=-4e150,n.b.a.a=t,e.a=n.b.a,r.a=n,r.f=0,r.d=!1,r.c=!1,r.h=!0,r.b=!1,n=V(n=e.f,n.a,r),r.e=n}function G(e){this.a=new H,this.b=e,this.c=E}function V(e,t,r){for(;null!==(t=t.c).b&&!e.c(e.b,t.b,r););return e=new H(r,t.a,t),t.a.c=e,t.a=e}function H(e,t,r){this.b=e||null,this.a=t||this,this.c=r||this}function W(){this.d=0,this.p=this.b=this.q=null,this.j=[0,0,0],this.s=100130,this.n=!1,this.o=this.a=this.e=this.f=null,this.m=!1,this.c=this.r=this.i=this.k=this.l=this.h=null}function X(e,t){if(e.d!==t)for(;e.d!==t;)if(e.d<t)switch(e.d){case 0:q(e,100151),e.u(null);break;case 1:q(e,100152),e.t()}else switch(e.d){case 2:q(e,100154),e.v();break;case 1:q(e,100153),e.w()}}function q(e,t){e.p&&e.p(t,e.c)}function Y(e,t){this.b=e||this,this.d=t||this,this.a=null,this.c=!1}function Z(){(this.h=this).i=this.d=this.a=this.e=this.c=this.b=null,this.f=0}function J(){this.c=new K,this.a=new Y,this.b=new Z,this.d=new Z,this.b.b=this.d,this.d.b=this.b}function K(e,t){this.e=e||this,this.f=t||this,this.d=this.c=null,this.g=[0,0,0],this.h=this.a=this.b=0}function Q(){this.c=[],this.d=null,this.a=0,this.e=!1,this.b=new te}function $(e,t){var r,n,i;return e.e?(2*(n=++(r=e.b).a)>r.f&&(r.f*=2,r.c=re(r.c,r.f+1)),0===r.b?i=n:(i=r.b,r.b=r.c[r.b]),r.e[i]=t,r.c[i]=n,r.d[n]=i,r.h&&oe(r,n),i):(r=e.a++,e.c[r]=t,-(r+1))}function ee(e){if(0===e.a)return ie(e.b);var t=e.c[e.d[e.a-1]];if(0!==e.b.a&&s(ne(e.b),t))return ie(e.b);for(;--e.a,0<e.a&&null===e.c[e.d[e.a-1]];);return t}function te(){this.d=re([0],33),this.e=[null,null],this.c=[0,0],this.a=0,this.f=32,this.b=0,this.h=!1,this.d[1]=1}function re(e,t){for(var r=Array(t),n=0;n<e.length;n++)r[n]=e[n];for(;n<t;n++)r[n]=0;return r}function ne(e){return e.e[e.d[1]]}function ie(e){var t=e.d,r=e.e,n=e.c,i=t[1],s=r[i];return 0<e.a&&(t[1]=t[e.a],n[t[1]]=1,r[i]=null,n[i]=e.b,e.b=i,0<--e.a&&se(e,1)),s}function se(e,t){for(var r=e.d,n=e.e,i=e.c,o=t,a=r[o];;){var l=o<<1,c=(l<e.a&&s(n[r[l+1]],n[r[l]])&&(l+=1),r[l]);if(l>e.a||s(n[a],n[c])){i[r[o]=a]=o;break}i[r[o]=c]=o,o=l}}function oe(e,t){for(var r=e.d,n=e.e,i=e.c,o=t,a=r[o];;){var l=o>>1,c=r[l];if(0==l||s(n[c],n[a])){i[r[o]=a]=o;break}i[r[o]=c]=o,o=l}}function ae(){this.e=this.a=null,this.f=0,this.c=this.b=this.h=this.d=!1}function le(e){return e.e.c.b}function ce(e){return e.e.a.b}(n=W.prototype).x=function(){X(this,0)},n.B=function(e,t){switch(e){case 100142:return;case 100140:switch(t){case 100130:case 100131:case 100132:case 100133:case 100134:return void(this.s=t)}break;case 100141:return void(this.m=!!t);default:return void q(this,100900)}q(this,100901)},n.y=function(e){switch(e){case 100142:return 0;case 100140:return this.s;case 100141:return this.m;default:q(this,100900)}return!1},n.A=function(e,t,r){this.j[0]=e,this.j[1]=t,this.j[2]=r},n.z=function(e,t){var r=t||null;switch(e){case 100100:case 100106:this.h=r;break;case 100104:case 100110:this.l=r;break;case 100101:case 100107:this.k=r;break;case 100102:case 100108:this.i=r;break;case 100103:case 100109:this.p=r;break;case 100105:case 100111:this.o=r;break;case 100112:this.r=r;break;default:q(this,100900)}},n.C=function(e,t){var r=!1,n=[0,0,0];X(this,2);for(var i=0;i<3;++i){var s=e[i];s<-1e150&&(s=-1e150,r=!0),1e150<s&&(s=1e150,r=!0),n[i]=s}r&&q(this,100155),null===(r=this.q)?p(r=d(this.b),r.b):(m(r),r=r.e),r.a.d=t,r.a.g[0]=n[0],r.a.g[1]=n[1],r.a.g[2]=n[2],r.f=1,r.b.f=-1,this.q=r},n.u=function(e){X(this,0),this.d=1,this.b=new J,this.c=e},n.t=function(){X(this,1),this.d=2,this.q=null},n.v=function(){X(this,2),this.d=1},n.w=function(){X(this,1),this.d=0;var e,t,r=!1,n=[h=this.j[0],o=this.j[1],c=this.j[2]];if(0===h&&0===o&&0===c){for(var o=[-2e150,-2e150,-2e150],l=[2e150,2e150,2e150],c=[],u=[],h=(r=this.b.c).e;h!==r;h=h.e)for(var d=0;d<3;++d){var y=h.g[d];y<l[d]&&(l[d]=y,u[d]=h),y>o[d]&&(o[d]=y,c[d]=h)}if(o[1]-l[1]>o[h=0]-l[0]&&(h=1),l[h=o[2]-l[2]>o[h]-l[h]?2:h]>=o[h])n[0]=0,n[1]=0,n[2]=1;else{for(l=u[h],c=c[h],u=[o=0,0,0],l=[l.g[0]-c.g[0],l.g[1]-c.g[1],l.g[2]-c.g[2]],d=[0,0,0],h=r.e;h!==r;h=h.e)d[0]=h.g[0]-c.g[0],d[1]=h.g[1]-c.g[1],d[2]=h.g[2]-c.g[2],u[0]=l[1]*d[2]-l[2]*d[1],u[1]=l[2]*d[0]-l[0]*d[2],u[2]=l[0]*d[1]-l[1]*d[0],o<(y=u[0]*u[0]+u[1]*u[1]+u[2]*u[2])&&(o=y,n[0]=u[0],n[1]=u[1],n[2]=u[2]);o<=0&&(n[0]=n[1]=n[2]=0,n[M(l)]=1)}r=!0}for(u=M(n),h=this.b.c,o=(u+1)%3,c=(u+2)%3,u=0<n[u]?1:-1,n=h.e;n!==h;n=n.e)n.b=n.g[o],n.a=u*n.g[c];if(r){for(n=0,h=(r=this.b.a).b;h!==r;h=h.b)if(!((o=h.a).f<=0))for(;n+=(o.a.b-o.b.a.b)*(o.a.a+o.b.a.a),(o=o.e)!==h.a;);if(n<0)for(r=(n=this.b.c).e;r!==n;r=r.e)r.a=-r.a}for(this.n=!1,h=(n=this.b.b).h;h!==n;h=r)r=h.h,o=h.e,i(h.a,h.b.a)&&h.e.e!==h&&(N(this,o,h),f(h),o=(h=o).e),o.e===h&&(o!==h&&(o!==r&&o!==r.b||(r=r.h),f(o)),h!==r&&h!==r.b||(r=r.h),f(h));for(this.e=n=new Q,h=(r=this.b.c).e;h!==r;h=h.e)h.h=$(n,h);var _=n;_.d=[];for(var x=0;x<_.a;x++)_.d[x]=x;_.d.sort(function(e){return function(t,r){return s(e[t],e[r])?1:-1}}(_.c)),_.e=!0;for(var S=_.b,E=S.a;1<=E;--E)se(S,E);for(S.h=!0,this.f=new G(this),z(this,-4e150),z(this,4e150);null!==(n=ee(this.e));){for(;;){e:if(0===(h=this.e).a)r=ne(h.b);else if(r=h.c[h.d[h.a-1]],0!==h.b.a&&s(h=ne(h.b),r)){r=h;break e}if(null===r||!i(r,n))break;r=ee(this.e),N(this,n.c,r.c)}!function e(t,r){for(var n,o=(t.a=r).c;null===o.i;)if((o=o.c)===r.c){o=t;var l=r;(y=new ae).a=l.c.b;for(var c=(u=o.f).a;null!==(c=c.a).b&&!u.c(u.b,y,c.b););var u,h,d=le(u=c.b),y=u.a;c=d.a;return void(0===a(y.b.a,l,y.a)?i((y=u.a).a,l)||i(y.b.a,l)||(m(y.b),u.c&&(f(y.c),u.c=!1),p(l.c,y),e(o,l)):(h=s(c.b.a,y.b.a)?u:d,d=void 0,u.d||h.c?(d=h===u?g(l.c.b,y.e):g(c.b.c.b,l.c).b,h.c?C(h,d):((u=R(y=o,u,d)).f=ce(u).f+u.a.f,u.d=P(y,u.f)),e(o,l)):D(o,u,l.c,l.c,null,!0)))}u=(y=le(o=L(o.i))).a,(y=I(t,y,null)).c===u?(y=(u=y).c,c=le(o),d=o.a,h=c.a,n=!1,d.b.a!==h.b.a&&F(t,o),i(d.a,t.a)&&(p(y.b.e,d),y=le(o=L(o)).a,I(t,le(o),c),n=!0),i(h.a,t.a)&&(p(u,h.b.e),u=I(t,c,null),n=!0),n?D(t,o,u.c,y,y,!0):(l=s(h.a,d.a)?h.b.e:d,D(t,o,l=g(u.c.b,l),l.c,l.c,!1),l.b.i.c=!0,B(t,o))):D(t,o,y.c,u,u,!0)}(this,n)}for(this.a=this.f.a.a.b.a.a,n=0;null!==(r=this.f.a.a.b);)r.h||++n,A(r);for(this.f=null,(n=this.e).b=null,n.d=null,this.e=n.c=null,h=(n=this.b).a.b;h!==n.a;h=r)r=h.b,(h=h.a).e.e===h&&(T(h.c,h),f(h));if(!this.n){if(n=this.b,this.m)for(h=n.b.h;h!==n.b;h=r)r=h.h,h.b.d.c!==h.d.c?h.f=h.d.c?1:-1:f(h);else for(h=n.a.b;h!==n.a;h=r)if(r=h.b,h.c){for(h=h.a;s(h.b.a,h.a);h=h.c.b);for(;s(h.a,h.b.a);h=h.e);for(o=h.c.b,c=void 0;h.e!==o;)if(s(h.b.a,o.a)){for(;o.e!==h&&(s((t=o.e).b.a,t.a)||a(o.a,o.b.a,o.e.b.a)<=0);)o=(c=g(o.e,o)).b;o=o.c.b}else{for(;o.e!==h&&(s((e=h.c.b).a,e.b.a)||0<=a(h.b.a,h.a,h.c.b.a));)h=(c=g(h,h.c.b)).b;h=h.e}for(;o.e.e!==h;)o=(c=g(o.e,o)).b}if(this.h||this.i||this.k||this.l)if(this.m){for(r=(n=this.b).a.b;r!==n.a;r=r.b)if(r.c){for(this.h&&this.h(2,this.c),h=r.a;this.k&&this.k(h.a.d,this.c),(h=h.e)!==r.a;);this.i&&this.i(this.c)}}else{for(n=this.b,r=!!this.l,h=!1,o=-1,c=n.a.d;c!==n.a;c=c.d)if(c.c)for(h||(this.h&&this.h(4,this.c),h=!0),u=c.a;r&&(o!==(l=u.b.d.c?0:1)&&(o=l,this.l&&this.l(!!o,this.c))),this.k&&this.k(u.a.d,this.c),(u=u.e)!==c.a;);h&&this.i&&this.i(this.c)}if(this.r){for(h=(n=this.b).a.b;h!==n.a;h=r)if(r=h.b,!h.c){for(c=(o=h.a).e,u=void 0;c=(u=c).e,(u.d=null)===u.b.d&&(u.c===u?w(u.a,null):(u.a.c=u.c,v(u,u.b.e)),(l=u.b).c===l?w(l.a,null):(l.a.c=l.c,v(l,l.b.e)),b(u)),u!==o;);o=h.d,((h=h.b).d=o).b=h}return this.r(this.b),void(this.c=this.b=null)}}this.b=this.c=null},this.libtess={GluTesselator:W,windingRule:{GLU_TESS_WINDING_ODD:100130,GLU_TESS_WINDING_NONZERO:100131,GLU_TESS_WINDING_POSITIVE:100132,GLU_TESS_WINDING_NEGATIVE:100133,GLU_TESS_WINDING_ABS_GEQ_TWO:100134},primitiveType:{GL_LINE_LOOP:2,GL_TRIANGLES:4,GL_TRIANGLE_STRIP:5,GL_TRIANGLE_FAN:6},errorType:{GLU_TESS_MISSING_BEGIN_POLYGON:100151,GLU_TESS_MISSING_END_POLYGON:100153,GLU_TESS_MISSING_BEGIN_CONTOUR:100152,GLU_TESS_MISSING_END_CONTOUR:100154,GLU_TESS_COORD_TOO_LARGE:100155,GLU_TESS_NEED_COMBINE_CALLBACK:100156},gluEnum:{GLU_TESS_MESH:100112,GLU_TESS_TOLERANCE:100142,GLU_TESS_WINDING_RULE:100140,GLU_TESS_BOUNDARY_ONLY:100141,GLU_INVALID_ENUM:100900,GLU_INVALID_VALUE:100901,GLU_TESS_BEGIN:100100,GLU_TESS_VERTEX:100101,GLU_TESS_END:100102,GLU_TESS_ERROR:100103,GLU_TESS_EDGE_FLAG:100104,GLU_TESS_COMBINE:100105,GLU_TESS_BEGIN_DATA:100106,GLU_TESS_VERTEX_DATA:100107,GLU_TESS_END_DATA:100108,GLU_TESS_ERROR_DATA:100109,GLU_TESS_EDGE_FLAG_DATA:100110,GLU_TESS_COMBINE_DATA:100111}},W.prototype.gluDeleteTess=W.prototype.x,W.prototype.gluTessProperty=W.prototype.B,W.prototype.gluGetTessProperty=W.prototype.y,W.prototype.gluTessNormal=W.prototype.A,W.prototype.gluTessCallback=W.prototype.z,W.prototype.gluTessVertex=W.prototype.C,W.prototype.gluTessBeginPolygon=W.prototype.u,W.prototype.gluTessBeginContour=W.prototype.t,W.prototype.gluTessEndContour=W.prototype.v,W.prototype.gluTessEndPolygon=W.prototype.w,void 0!==t&&(t.exports=this.libtess)},{}],240:[function(e,t,r){"use strict";function n(e,t,r,n){for(var i=e[t++],s=1<<i,o=1+s,a=1+o,l=i+1,c=(1<<l)-1,u=0,h=0,d=0,p=e[t++],f=new Int32Array(4096),m=null;;){for(;u<16&&0!==p;)h|=e[t++]<<u,u+=8,1===p?p=e[t++]:--p;if(u<l)break;var g=h&c;if(h>>=l,u-=l,g==s)a=1+o,c=(1<<(l=i+1))-1,m=null;else{if(g==o)break;for(var y=g<a?g:m,v=0,_=y;s<_;)_=f[_]>>8,++v;var x=_;if(n<d+v+(y!==g?1:0))return;r[d++]=x;var b=d+=v;for(y!==g&&(r[d++]=x),_=y;v--;)_=f[_],r[--b]=255&_,_>>=8;null!==m&&a<4096&&(f[a++]=m<<8|x,c+1<=a&&l<12&&(++l,c=c<<1|1)),m=g}}}try{r.GifWriter=function(e,t,r,n){var i=0,s=void 0===(n=void 0===n?{}:n).loop?null:n.loop,o=void 0===n.palette?null:n.palette;if(t<=0||r<=0||65535<t||65535<r)throw new Error("Width/Height invalid.");function a(e){if((e=e.length)<2||256<e||e&e-1)throw new Error("Invalid code/color length, must be power of 2 and 2 .. 256.");return e}e[i++]=71,e[i++]=73,e[i++]=70,e[i++]=56,e[i++]=57,e[i++]=97;var l=0,c=0;if(null!==o){for(var u=a(o);u>>=1;)++l;if(u=1<<l,--l,void 0!==n.background){if(u<=(c=n.background))throw new Error("Background index out of range.");if(0===c)throw new Error("Background index explicitly passed as 0.")}}if(e[i++]=255&t,e[i++]=t>>8&255,e[i++]=255&r,e[i++]=r>>8&255,e[i++]=(null!==o?128:0)|l,e[i++]=c,e[i++]=0,null!==o)for(var h=0,d=o.length;h<d;++h){var p=o[h];e[i++]=p>>16&255,e[i++]=p>>8&255,e[i++]=255&p}if(null!==s){if(s<0||65535<s)throw new Error("Loop count invalid.");e[i++]=33,e[i++]=255,e[i++]=11,e[i++]=78,e[i++]=69,e[i++]=84,e[i++]=83,e[i++]=67,e[i++]=65,e[i++]=80,e[i++]=69,e[i++]=50,e[i++]=46,e[i++]=48,e[i++]=3,e[i++]=1,e[i++]=255&s,e[i++]=s>>8&255,e[i++]=0}var f=!1;this.addFrame=function(t,r,n,s,l,c){if(!0===f&&(--i,f=!1),c=void 0===c?{}:c,t<0||r<0||65535<t||65535<r)throw new Error("x/y invalid.");if(n<=0||s<=0||65535<n||65535<s)throw new Error("Width/Height invalid.");if(l.length<n*s)throw new Error("Not enough pixels for the frame size.");var u=!0,h=c.palette;if(null==h&&(u=!1,h=o),null==h)throw new Error("Must supply either a local or global palette.");for(var d=a(h),p=0;d>>=1;)++p;d=1<<p;var m=void 0===c.delay?0:c.delay,g=void 0===c.disposal?0:c.disposal;if(g<0||3<g)throw new Error("Disposal out of range.");var y=!1,v=0;if(void 0!==c.transparent&&null!==c.transparent&&(y=!0,(v=c.transparent)<0||d<=v))throw new Error("Transparent color index.");if(0===g&&!y&&0===m||(e[i++]=33,e[i++]=249,e[i++]=4,e[i++]=g<<2|(!0===y?1:0),e[i++]=255&m,e[i++]=m>>8&255,e[i++]=v,e[i++]=0),e[i++]=44,e[i++]=255&t,e[i++]=t>>8&255,e[i++]=255&r,e[i++]=r>>8&255,e[i++]=255&n,e[i++]=n>>8&255,e[i++]=255&s,e[i++]=s>>8&255,e[i++]=!0===u?128|p-1:0,!0===u)for(var _=0,x=h.length;_<x;++_){var b=h[_];e[i++]=b>>16&255,e[i++]=b>>8&255,e[i++]=255&b}return i=function(e,t,r,n){e[t++]=r;var i=t++,s=1<<r,o=s-1,a=1+s,l=1+a,c=r+1,u=0,h=0;function d(r){for(;r<=u;)e[t++]=255&h,h>>=8,u-=8,t===i+256&&(e[i]=255,i=t++)}function p(e){h|=e<<u,u+=c,d(8)}var f=n[0]&o,m={};p(s);for(var g=1,y=n.length;g<y;++g){var v=n[g]&o,_=f<<8|v,x=m[_];if(void 0===x){for(h|=f<<u,u+=c;8<=u;)e[t++]=255&h,h>>=8,u-=8,t===i+256&&(e[i]=255,i=t++);4096===l?(p(s),l=1+a,c=r+1,m={}):(1<<c<=l&&++c,m[_]=l++),f=v}else f=x}return p(f),p(a),d(1),i+1===t?e[i]=0:(e[i]=t-i-1,e[t++]=0),t}(e,i,p<2?2:p,l)},this.end=function(){return!1===f&&(e[i++]=59,f=!0),i},this.getOutputBuffer=function(){return e},this.setOutputBuffer=function(t){e=t},this.getOutputBufferPosition=function(){return i},this.setOutputBufferPosition=function(e){i=e}},r.GifReader=function(e){var t=0;if(71!==e[t++]||73!==e[t++]||70!==e[t++]||56!==e[t++]||56!=(e[t++]+1&253)||97!==e[t++])throw new Error("Invalid GIF 87a/89a header.");var r=e[t++]|e[t++]<<8,i=e[t++]|e[t++]<<8,s=e[t++],o=1<<1+(7&s),a=(e[t++],e[t++],null),l=null,c=(s>>7&&(a=t,t+=3*(l=o)),!0),u=[],h=0,d=null,p=0,f=null;for(this.width=r,this.height=i;c&&t<e.length;)switch(e[t++]){case 33:switch(e[t++]){case 255:if(11!==e[t]||78==e[t+1]&&69==e[t+2]&&84==e[t+3]&&83==e[t+4]&&67==e[t+5]&&65==e[t+6]&&80==e[t+7]&&69==e[t+8]&&50==e[t+9]&&46==e[t+10]&&48==e[t+11]&&3==e[t+12]&&1==e[t+13]&&0==e[t+16])t+=14,f=e[t++]|e[t++]<<8,t++;else for(t+=12;;){if(!(0<=(g=e[t++])))throw Error("Invalid block size");if(0===g)break;t+=g}break;case 249:if(4!==e[t++]||0!==e[t+4])throw new Error("Invalid graphics extension block.");var m=e[t++];h=e[t++]|e[t++]<<8,d=e[t++];0==(1&m)&&(d=null),p=m>>2&7,t++;break;case 254:for(;;){if(!(0<=(g=e[t++])))throw Error("Invalid block size");if(0===g)break;t+=g}break;default:throw new Error("Unknown graphic control label: 0x"+e[t-1].toString(16))}break;case 44:var g,y=e[t++]|e[t++]<<8,v=e[t++]|e[t++]<<8,_=e[t++]|e[t++]<<8,x=e[t++]|e[t++]<<8,b=(T=e[t++])>>6&1,w=a,S=l,M=!1,T=(T>>7&&(M=!0,w=t,t+=3*(S=1<<1+(7&T))),t);for(t++;;){if(!(0<=(g=e[t++])))throw Error("Invalid block size");if(0===g)break;t+=g}u.push({x:y,y:v,width:_,height:x,has_local_palette:M,palette_offset:w,palette_size:S,data_offset:T,data_length:t-T,transparent_index:d,interlaced:!!b,delay:h,disposal:p});break;case 59:c=!1;break;default:throw new Error("Unknown gif block: 0x"+e[t-1].toString(16))}this.numFrames=function(){return u.length},this.loopCount=function(){return f},this.frameInfo=function(e){if(e<0||e>=u.length)throw new Error("Frame index out of range.");return u[e]},this.decodeAndBlitFrameBGRA=function(t,i){for(var s=(t=this.frameInfo(t)).width*t.height,o=new Uint8Array(s),a=(n(e,t.data_offset,o,s),t.palette_offset),l=t.transparent_index,c=(null===l&&(l=256),t.width),u=r-c,h=c,d=4*(t.y*r+t.x),p=4*((t.y+t.height)*r+t.x),f=d,m=4*u,g=(!0===t.interlaced&&(m+=4*r*7),8),y=0,v=o.length;y<v;++y){var _,x,b=o[y];0===h&&(h=c,p<=(f+=m)&&(m=4*u+4*r*(g-1),f=d+(c+u)*(g<<1),g>>=1)),b===l?f+=4:(_=e[a+3*b],x=e[a+3*b+1],b=e[a+3*b+2],i[f++]=b,i[f++]=x,i[f++]=_,i[f++]=255),--h}},this.decodeAndBlitFrameRGBA=function(t,i){for(var s=(t=this.frameInfo(t)).width*t.height,o=new Uint8Array(s),a=(n(e,t.data_offset,o,s),t.palette_offset),l=t.transparent_index,c=(null===l&&(l=256),t.width),u=r-c,h=c,d=4*(t.y*r+t.x),p=4*((t.y+t.height)*r+t.x),f=d,m=4*u,g=(!0===t.interlaced&&(m+=4*r*7),8),y=0,v=o.length;y<v;++y){var _,x,b=o[y];0===h&&(h=c,p<=(f+=m)&&(m=4*u+4*r*(g-1),f=d+(c+u)*(g<<1),g>>=1)),b===l?f+=4:(_=e[a+3*b],x=e[a+3*b+1],b=e[a+3*b+2],i[f++]=_,i[f++]=x,i[f++]=b,i[f++]=255),--h}}}}catch(e){}},{}],241:[function(e,t,r){(function(n){var i;i=function(t){"use strict";function r(e){if(null==this)throw TypeError();var t,r=String(this),n=r.length;if(!((e=(e=e?Number(e):0)!=e?0:e)<0||n<=e))return 55296<=(t=r.charCodeAt(e))&&t<=56319&&e+1<n&&56320<=(n=r.charCodeAt(e+1))&&n<=57343?1024*(t-55296)+n-56320+65536:t}String.prototype.codePointAt||((i=function(){try{var e={},t=Object.defineProperty,r=t(e,e,e)&&t}catch(e){}return r}())?i(String.prototype,"codePointAt",{value:r,configurable:!0,writable:!0}):String.prototype.codePointAt=r);var i,s=0;function o(){this.table=new Uint16Array(16),this.trans=new Uint16Array(288)}function a(e,t){this.source=e,this.sourceIndex=0,this.tag=0,this.bitcount=0,this.dest=t,this.destLen=0,this.ltree=new o,this.dtree=new o}var l=new o,c=new o,u=new Uint8Array(30),h=new Uint16Array(30),d=new Uint8Array(30),p=new Uint16Array(30),f=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),m=new o,g=new Uint8Array(320);function y(e,t,r,n){for(var i,s=0;s<r;++s)e[s]=0;for(s=0;s<30-r;++s)e[s+r]=s/r|0;for(i=n,s=0;s<30;++s)t[s]=i,i+=1<<e[s]}var v=new Uint16Array(16);function _(e,t,r,n){for(var i,s=0;s<16;++s)e.table[s]=0;for(s=0;s<n;++s)e.table[t[r+s]]++;for(s=i=e.table[0]=0;s<16;++s)v[s]=i,i+=e.table[s];for(s=0;s<n;++s)t[r+s]&&(e.trans[v[t[r+s]]++]=s)}function x(e,t,r){if(!t)return r;for(;e.bitcount<24;)e.tag|=e.source[e.sourceIndex++]<<e.bitcount,e.bitcount+=8;var n=e.tag&65535>>>16-t;return e.tag>>>=t,e.bitcount-=t,n+r}function b(e,t){for(;e.bitcount<24;)e.tag|=e.source[e.sourceIndex++]<<e.bitcount,e.bitcount+=8;for(var r=0,n=0,i=0,s=e.tag;n=2*n+(1&s),s>>>=1,r+=t.table[++i],0<=(n-=t.table[i]););return e.tag=s,e.bitcount-=i,t.trans[r+n]}function w(e,t,r){for(;;){if(256===(o=b(e,t)))return s;if(o<256)e.dest[e.destLen++]=o;else for(var n,i=x(e,u[o-=257],h[o]),o=b(e,r),a=n=e.destLen-x(e,d[o],p[o]);a<n+i;++a)e.dest[e.destLen++]=e.dest[a]}}for(var S=l,M=c,T=0;T<7;++T)S.table[T]=0;for(S.table[7]=24,S.table[8]=152,S.table[9]=112,T=0;T<24;++T)S.trans[T]=256+T;for(T=0;T<144;++T)S.trans[24+T]=T;for(T=0;T<8;++T)S.trans[168+T]=280+T;for(T=0;T<112;++T)S.trans[176+T]=144+T;for(T=0;T<5;++T)M.table[T]=0;for(M.table[5]=32,T=0;T<32;++T)M.trans[T]=T;y(u,h,4,3),y(d,p,2,1),u[28]=0,h[28]=258;var E=function(e,t){var r,n,i,o=new a(e,t);do{switch(void 0,(n=o).bitcount--||(n.tag=n.source[n.sourceIndex++],n.bitcount=7),i=1&n.tag,n.tag>>>=1,n=i,x(o,2,0)){case 0:r=function(e){for(var t,r;8<e.bitcount;)e.sourceIndex--,e.bitcount-=8;if((t=256*e.source[e.sourceIndex+1]+e.source[e.sourceIndex])!==(65535&~(256*e.source[e.sourceIndex+3]+e.source[e.sourceIndex+2])))return-3;for(e.sourceIndex+=4,r=t;r;--r)e.dest[e.destLen++]=e.source[e.sourceIndex++];return e.bitcount=0,s}(o);break;case 1:r=w(o,l,c);break;case 2:A=E=T=C=u=M=void 0;for(var u,h=o,d=o.ltree,p=o.dtree,y=x(h,5,257),v=x(h,5,1),S=x(h,4,4),M=0;M<19;++M)g[M]=0;for(M=0;M<S;++M){var T=x(h,3,0);g[f[M]]=T}for(_(m,g,0,19),u=0;u<y+v;){var E=b(h,m);switch(E){case 16:for(var A=g[u-1],C=x(h,2,3);C;--C)g[u++]=A;break;case 17:for(C=x(h,3,3);C;--C)g[u++]=0;break;case 18:for(C=x(h,7,11);C;--C)g[u++]=0;break;default:g[u++]=E}}_(d,g,0,y),_(p,g,y,v),r=w(o,o.ltree,o.dtree);break;default:r=-3}if(r!==s)throw new Error("Data error")}while(!n);return o.destLen<o.dest.length?"function"==typeof o.dest.slice?o.dest.slice(0,o.destLen):o.dest.subarray(0,o.destLen):o.dest};function A(e,t,r,n,i){return Math.pow(1-i,3)*e+3*Math.pow(1-i,2)*i*t+3*(1-i)*Math.pow(i,2)*r+Math.pow(i,3)*n}function C(){this.x1=Number.NaN,this.y1=Number.NaN,this.x2=Number.NaN,this.y2=Number.NaN}function L(){this.commands=[],this.fill="black",this.stroke=null,this.strokeWidth=1}function R(e){throw new Error(e)}function P(e,t){e||R(t)}C.prototype.isEmpty=function(){return isNaN(this.x1)||isNaN(this.y1)||isNaN(this.x2)||isNaN(this.y2)},C.prototype.addPoint=function(e,t){"number"==typeof e&&((isNaN(this.x1)||isNaN(this.x2))&&(this.x1=e,this.x2=e),e<this.x1&&(this.x1=e),e>this.x2&&(this.x2=e)),"number"==typeof t&&((isNaN(this.y1)||isNaN(this.y2))&&(this.y1=t,this.y2=t),t<this.y1&&(this.y1=t),t>this.y2&&(this.y2=t))},C.prototype.addX=function(e){this.addPoint(e,null)},C.prototype.addY=function(e){this.addPoint(null,e)},C.prototype.addBezier=function(e,t,r,n,i,s,o,a){var l=[e,t],c=[r,n],u=[i,s],h=[o,a];this.addPoint(e,t),this.addPoint(o,a);for(var d=0;d<=1;d++){var p,f=6*l[d]-12*c[d]+6*u[d],m=-3*l[d]+9*c[d]-9*u[d]+3*h[d],g=3*c[d]-3*l[d];0==m?0==f||0<(p=-g/f)&&p<1&&(0===d&&this.addX(A(l[d],c[d],u[d],h[d],p)),1===d&&this.addY(A(l[d],c[d],u[d],h[d],p))):(p=Math.pow(f,2)-4*g*m)<0||(0<(g=(-f+Math.sqrt(p))/(2*m))&&g<1&&(0===d&&this.addX(A(l[d],c[d],u[d],h[d],g)),1===d&&this.addY(A(l[d],c[d],u[d],h[d],g))),0<(g=(-f-Math.sqrt(p))/(2*m))&&g<1&&(0===d&&this.addX(A(l[d],c[d],u[d],h[d],g)),1===d&&this.addY(A(l[d],c[d],u[d],h[d],g))))}},C.prototype.addQuad=function(e,t,r,n,i,s){r=e+2/3*(r-e),n=t+2/3*(n-t),this.addBezier(e,t,r,n,r+1/3*(i-e),n+1/3*(s-t),i,s)},L.prototype.moveTo=function(e,t){this.commands.push({type:"M",x:e,y:t})},L.prototype.lineTo=function(e,t){this.commands.push({type:"L",x:e,y:t})},L.prototype.curveTo=L.prototype.bezierCurveTo=function(e,t,r,n,i,s){this.commands.push({type:"C",x1:e,y1:t,x2:r,y2:n,x:i,y:s})},L.prototype.quadTo=L.prototype.quadraticCurveTo=function(e,t,r,n){this.commands.push({type:"Q",x1:e,y1:t,x:r,y:n})},L.prototype.close=L.prototype.closePath=function(){this.commands.push({type:"Z"})},L.prototype.extend=function(e){var t;if(e.commands)e=e.commands;else if(e instanceof C)return t=e,this.moveTo(t.x1,t.y1),this.lineTo(t.x2,t.y1),this.lineTo(t.x2,t.y2),this.lineTo(t.x1,t.y2),void this.close();Array.prototype.push.apply(this.commands,e)},L.prototype.getBoundingBox=function(){for(var e=new C,t=0,r=0,n=0,i=0,s=0;s<this.commands.length;s++){var o=this.commands[s];switch(o.type){case"M":e.addPoint(o.x,o.y),t=n=o.x,r=i=o.y;break;case"L":e.addPoint(o.x,o.y),n=o.x,i=o.y;break;case"Q":e.addQuad(n,i,o.x1,o.y1,o.x,o.y),n=o.x,i=o.y;break;case"C":e.addBezier(n,i,o.x1,o.y1,o.x2,o.y2,o.x,o.y),n=o.x,i=o.y;break;case"Z":n=t,i=r;break;default:throw new Error("Unexpected path command "+o.type)}}return e.isEmpty()&&e.addPoint(0,0),e},L.prototype.draw=function(e){e.beginPath();for(var t=0;t<this.commands.length;t+=1){var r=this.commands[t];"M"===r.type?e.moveTo(r.x,r.y):"L"===r.type?e.lineTo(r.x,r.y):"C"===r.type?e.bezierCurveTo(r.x1,r.y1,r.x2,r.y2,r.x,r.y):"Q"===r.type?e.quadraticCurveTo(r.x1,r.y1,r.x,r.y):"Z"===r.type&&e.closePath()}this.fill&&(e.fillStyle=this.fill,e.fill()),this.stroke&&(e.strokeStyle=this.stroke,e.lineWidth=this.strokeWidth,e.stroke())},L.prototype.toPathData=function(e){function t(){for(var t=arguments,r="",n=0;n<arguments.length;n+=1){var i=t[n];0<=i&&0<n&&(r+=" "),r+=Math.round(i)===i?""+Math.round(i):i.toFixed(e)}return r}e=void 0!==e?e:2;for(var r="",n=0;n<this.commands.length;n+=1){var i=this.commands[n];"M"===i.type?r+="M"+t(i.x,i.y):"L"===i.type?r+="L"+t(i.x,i.y):"C"===i.type?r+="C"+t(i.x1,i.y1,i.x2,i.y2,i.x,i.y):"Q"===i.type?r+="Q"+t(i.x1,i.y1,i.x,i.y):"Z"===i.type&&(r+="Z")}return r},L.prototype.toSVG=function(e){var t=(t='<path d="')+this.toPathData(e)+'"';return this.fill&&"black"!==this.fill&&(null===this.fill?t+=' fill="none"':t+=' fill="'+this.fill+'"'),this.stroke&&(t+=' stroke="'+this.stroke+'" stroke-width="'+this.strokeWidth+'"'),t+"/>"},L.prototype.toDOMElement=function(e){e=this.toPathData(e);var t=document.createElementNS("http://www.w3.org/2000/svg","path");return t.setAttribute("d",e),t};var j={fail:R,argument:P,assert:P},I={},D={},O={};function N(e){return function(){return e}}D.BYTE=function(e){return j.argument(0<=e&&e<=255,"Byte value should be between 0 and 255."),[e]},O.BYTE=N(1),D.CHAR=function(e){return[e.charCodeAt(0)]},O.CHAR=N(1),D.CHARARRAY=function(e){for(var t=[],r=0;r<e.length;r+=1)t[r]=e.charCodeAt(r);return t},O.CHARARRAY=function(e){return e.length},D.USHORT=function(e){return[e>>8&255,255&e]},O.USHORT=N(2),D.SHORT=function(e){return[(e=32768<=e?-(65536-e):e)>>8&255,255&e]},O.SHORT=N(2),D.UINT24=function(e){return[e>>16&255,e>>8&255,255&e]},O.UINT24=N(3),D.ULONG=function(e){return[e>>24&255,e>>16&255,e>>8&255,255&e]},O.ULONG=N(4),D.LONG=function(e){return[(e=2147483648<=e?-(4294967296-e):e)>>24&255,e>>16&255,e>>8&255,255&e]},O.LONG=N(4),D.FIXED=D.ULONG,O.FIXED=O.ULONG,D.FWORD=D.SHORT,O.FWORD=O.SHORT,D.UFWORD=D.USHORT,O.UFWORD=O.USHORT,D.LONGDATETIME=function(e){return[0,0,0,0,e>>24&255,e>>16&255,e>>8&255,255&e]},O.LONGDATETIME=N(8),D.TAG=function(e){return j.argument(4===e.length,"Tag should be exactly 4 ASCII characters."),[e.charCodeAt(0),e.charCodeAt(1),e.charCodeAt(2),e.charCodeAt(3)]},O.TAG=N(4),D.Card8=D.BYTE,O.Card8=O.BYTE,D.Card16=D.USHORT,O.Card16=O.USHORT,D.OffSize=D.BYTE,O.OffSize=O.BYTE,D.SID=D.USHORT,O.SID=O.USHORT,D.NUMBER=function(e){return-107<=e&&e<=107?[e+139]:108<=e&&e<=1131?[247+((e-=108)>>8),255&e]:-1131<=e&&e<=-108?[251+((e=-e-108)>>8),255&e]:-32768<=e&&e<=32767?D.NUMBER16(e):D.NUMBER32(e)},O.NUMBER=function(e){return D.NUMBER(e).length},D.NUMBER16=function(e){return[28,e>>8&255,255&e]},O.NUMBER16=N(3),D.NUMBER32=function(e){return[29,e>>24&255,e>>16&255,e>>8&255,255&e]},O.NUMBER32=N(5),D.REAL=function(e){for(var t=e.toString(),r=/\.(\d*?)(?:9{5,20}|0{5,20})\d{0,2}(?:e(.+)|$)/.exec(t),n=(r&&(r=parseFloat("1e"+((r[2]?+r[2]:0)+r[1].length)),t=(Math.round(e*r)/r).toString()),""),i=0,s=t.length;i<s;i+=1){var o=t[i];n+="e"===o?"-"===t[++i]?"c":"b":"."===o?"a":"-"===o?"e":o}for(var a=[30],l=0,c=(n+=1&n.length?"f":"ff").length;l<c;l+=2)a.push(parseInt(n.substr(l,2),16));return a},O.REAL=function(e){return D.REAL(e).length},D.NAME=D.CHARARRAY,O.NAME=O.CHARARRAY,D.STRING=D.CHARARRAY,O.STRING=O.CHARARRAY,I.UTF8=function(e,t,r){for(var n=[],i=r,s=0;s<i;s++,t+=1)n[s]=e.getUint8(t);return String.fromCharCode.apply(null,n)},I.UTF16=function(e,t,r){for(var n=[],i=r/2,s=0;s<i;s++,t+=2)n[s]=e.getUint16(t);return String.fromCharCode.apply(null,n)},D.UTF16=function(e){for(var t=[],r=0;r<e.length;r+=1){var n=e.charCodeAt(r);t[t.length]=n>>8&255,t[t.length]=255&n}return t},O.UTF16=function(e){return 2*e.length};var U,k={"x-mac-croatian":"ÄÅÇÉÑÖÜáàâäãåçéèêëíìîïñóòôöõúùûü†°¢£§•¶ß®Š™´¨≠ŽØ∞±≤≥∆µ∂∑∏š∫ªºΩžø¿¡¬√ƒ≈Ć«Č… ÀÃÕŒœĐ—“”‘’÷◊©⁄€‹›Æ»–·‚„‰ÂćÁčÈÍÎÏÌÓÔđÒÚÛÙıˆ˜¯πË˚¸Êæˇ","x-mac-cyrillic":"АБВГДЕЖЗИЙКЛМНОПРСТУФХЦЧШЩЪЫЬЭЮЯ†°Ґ£§•¶І®©™Ђђ≠Ѓѓ∞±≤≥іµґЈЄєЇїЉљЊњјЅ¬√ƒ≈∆«»… ЋћЌќѕ–—“”‘’÷„ЎўЏџ№Ёёяабвгдежзийклмнопрстуфхцчшщъыьэю","x-mac-gaelic":"ÄÅÇÉÑÖÜáàâäãåçéèêëíìîïñóòôöõúùûü†°¢£§•¶ß®©™´¨≠ÆØḂ±≤≥ḃĊċḊḋḞḟĠġṀæøṁṖṗɼƒſṠ«»… ÀÃÕŒœ–—“”‘’ṡẛÿŸṪ€‹›Ŷŷṫ·Ỳỳ⁊ÂÊÁËÈÍÎÏÌÓÔ♣ÒÚÛÙıÝýŴŵẄẅẀẁẂẃ","x-mac-greek":"Ä¹²É³ÖÜ΅àâä΄¨çéèêë£™îï•½‰ôö¦€ùûü†ΓΔΘΛΞΠß®©ΣΪ§≠°·Α±≤≥¥ΒΕΖΗΙΚΜΦΫΨΩάΝ¬ΟΡ≈Τ«»… ΥΧΆΈœ–―“”‘’÷ΉΊΌΎέήίόΏύαβψδεφγηιξκλμνοπώρστθωςχυζϊϋΐΰ­","x-mac-icelandic":"ÄÅÇÉÑÖÜáàâäãåçéèêëíìîïñóòôöõúùûüÝ°¢£§•¶ß®©™´¨≠ÆØ∞±≤≥¥µ∂∑∏π∫ªºΩæø¿¡¬√ƒ≈∆«»… ÀÃÕŒœ–—“”‘’÷◊ÿŸ⁄€ÐðÞþý·‚„‰ÂÊÁËÈÍÎÏÌÓÔÒÚÛÙıˆ˜¯˘˙˚¸˝˛ˇ","x-mac-inuit":"ᐃᐄᐅᐆᐊᐋᐱᐲᐳᐴᐸᐹᑉᑎᑏᑐᑑᑕᑖᑦᑭᑮᑯᑰᑲᑳᒃᒋᒌᒍᒎᒐᒑ°ᒡᒥᒦ•¶ᒧ®©™ᒨᒪᒫᒻᓂᓃᓄᓅᓇᓈᓐᓯᓰᓱᓲᓴᓵᔅᓕᓖᓗᓘᓚᓛᓪᔨᔩᔪᔫᔭ… ᔮᔾᕕᕖᕗ–—“”‘’ᕘᕙᕚᕝᕆᕇᕈᕉᕋᕌᕐᕿᖀᖁᖂᖃᖄᖅᖏᖐᖑᖒᖓᖔᖕᙱᙲᙳᙴᙵᙶᖖᖠᖡᖢᖣᖤᖥᖦᕼŁł","x-mac-ce":"ÄĀāÉĄÖÜáąČäčĆćéŹźĎíďĒēĖóėôöõúĚěü†°Ę£§•¶ß®©™ę¨≠ģĮįĪ≤≥īĶ∂∑łĻļĽľĹĺŅņŃ¬√ńŇ∆«»… ňŐÕőŌ–—“”‘’÷◊ōŔŕŘ‹›řŖŗŠ‚„šŚśÁŤťÍŽžŪÓÔūŮÚůŰűŲųÝýķŻŁżĢˇ",macintosh:"ÄÅÇÉÑÖÜáàâäãåçéèêëíìîïñóòôöõúùûü†°¢£§•¶ß®©™´¨≠ÆØ∞±≤≥¥µ∂∑∏π∫ªºΩæø¿¡¬√ƒ≈∆«»… ÀÃÕŒœ–—“”‘’÷◊ÿŸ⁄€‹›ﬁﬂ‡·‚„‰ÂÊÁËÈÍÎÏÌÓÔÒÚÛÙıˆ˜¯˘˙˚¸˝˛ˇ","x-mac-romanian":"ÄÅÇÉÑÖÜáàâäãåçéèêëíìîïñóòôöõúùûü†°¢£§•¶ß®©™´¨≠ĂȘ∞±≤≥¥µ∂∑∏π∫ªºΩăș¿¡¬√ƒ≈∆«»… ÀÃÕŒœ–—“”‘’÷◊ÿŸ⁄€‹›Țț‡·‚„‰ÂÊÁËÈÍÎÏÌÓÔÒÚÛÙıˆ˜¯˘˙˚¸˝˛ˇ","x-mac-turkish":"ÄÅÇÉÑÖÜáàâäãåçéèêëíìîïñóòôöõúùûü†°¢£§•¶ß®©™´¨≠ÆØ∞±≤≥¥µ∂∑∏π∫ªºΩæø¿¡¬√ƒ≈∆«»… ÀÃÕŒœ–—“”‘’÷◊ÿŸĞğİıŞş‡·‚„‰ÂÊÁËÈÍÎÏÌÓÔÒÚÛÙˆ˜¯˘˙˚¸˝˛ˇ"},F=(I.MACSTRING=function(e,t,r,n){var i=k[n];if(void 0!==i){for(var s="",o=0;o<r;o++){var a=e.getUint8(t+o);s+=a<=127?String.fromCharCode(a):i[127&a]}return s}},"function"==typeof WeakMap&&new WeakMap);function B(e){return-128<=e&&e<=127}D.MACSTRING=function(e,t){var r=function(e){if(!U)for(var t in U={},k)U[t]=new String(t);var r=U[e];if(void 0!==r){if(F){var n=F.get(r);if(void 0!==n)return n}var i=k[e];if(void 0!==i){for(var s={},o=0;o<i.length;o++)s[i.charCodeAt(o)]=o+128;return F&&F.set(r,s),s}}}(t);if(void 0!==r){for(var n=[],i=0;i<e.length;i++){var s=e.charCodeAt(i);if(128<=s&&void 0===(s=r[s]))return;n[i]=s}return n}},O.MACSTRING=function(e,t){return void 0!==(e=D.MACSTRING(e,t))?e.length:0},D.VARDELTAS=function(e){for(var t=0,r=[];t<e.length;){var n=e[t];t=(0===n?function(e,t,r){for(var n=0,i=e.length;t<i&&n<64&&0===e[t];)++t,++n;return r.push(128|n-1),t}:-128<=n&&n<=127?function(e,t,r){for(var n=0,i=e.length,s=t;s<i&&n<64;){var o=e[s];if(!B(o))break;if(0===o&&s+1<i&&0===e[s+1])break;++s,++n}r.push(n-1);for(var a=t;a<s;++a)r.push(e[a]+256&255);return s}:function(e,t,r){for(var n=0,i=e.length,s=t;s<i&&n<64;){var o=e[s];if(0===o)break;if(B(o)&&s+1<i&&B(e[s+1]))break;++s,++n}r.push(64|n-1);for(var a=t;a<s;++a){var l=e[a];r.push(l+65536>>8&255,l+256&255)}return s})(e,t,r)}return r},D.INDEX=function(e){for(var t=1,r=[t],n=[],i=0;i<e.length;i+=1){var s=D.OBJECT(e[i]);Array.prototype.push.apply(n,s),t+=s.length,r.push(t)}if(0===n.length)return[0,0];for(var o=[],a=1+Math.floor(Math.log(t)/Math.log(2))/8|0,l=[void 0,D.BYTE,D.USHORT,D.UINT24,D.ULONG][a],c=0;c<r.length;c+=1){var u=l(r[c]);Array.prototype.push.apply(o,u)}return Array.prototype.concat(D.Card16(e.length),D.OffSize(a),o,n)},O.INDEX=function(e){return D.INDEX(e).length},D.DICT=function(e){for(var t=[],r=Object.keys(e),n=r.length,i=0;i<n;i+=1){var s=parseInt(r[i],0),o=e[s];t=(t=t.concat(D.OPERAND(o.value,o.type))).concat(D.OPERATOR(s))}return t},O.DICT=function(e){return D.DICT(e).length},D.OPERATOR=function(e){return e<1200?[e]:[12,e-1200]},D.OPERAND=function(e,t){var r=[];if(Array.isArray(t))for(var n=0;n<t.length;n+=1)j.argument(e.length===t.length,"Not enough arguments given for type"+t),r=r.concat(D.OPERAND(e[n],t[n]));else if("SID"===t)r=r.concat(D.NUMBER(e));else if("offset"===t)r=r.concat(D.NUMBER32(e));else if("number"===t)r=r.concat(D.NUMBER(e));else{if("real"!==t)throw new Error("Unknown operand type "+t);r=r.concat(D.REAL(e))}return r},D.OP=D.BYTE,O.OP=O.BYTE;var z="function"==typeof WeakMap&&new WeakMap;function G(e,t,r){for(var n=0;n<t.length;n+=1){var i=t[n];this[i.name]=i.value}if(this.tableName=e,this.fields=t,r)for(var s=Object.keys(r),o=0;o<s.length;o+=1){var a=s[o],l=r[a];void 0!==this[a]&&(this[a]=l)}}function V(e,t,r){void 0===r&&(r=t.length);var n=new Array(t.length+1);n[0]={name:e+"Count",type:"USHORT",value:r};for(var i=0;i<t.length;i++)n[i+1]={name:e+i,type:"USHORT",value:t[i]};return n}function H(e,t,r){var n=t.length,i=new Array(n+1);i[0]={name:e+"Count",type:"USHORT",value:n};for(var s=0;s<n;s++)i[s+1]={name:e+s,type:"TABLE",value:r(t[s],s)};return i}function W(e,t,r){var n=t.length,i=[];i[0]={name:e+"Count",type:"USHORT",value:n};for(var s=0;s<n;s++)i=i.concat(r(t[s],s));return i}function X(e){1===e.format?G.call(this,"coverageTable",[{name:"coverageFormat",type:"USHORT",value:1}].concat(V("glyph",e.glyphs))):j.assert(!1,"Can't create coverage table format 2 yet.")}function q(e){G.call(this,"scriptListTable",W("scriptRecord",e,(function(e,t){var r=e.script,n=r.defaultLangSys;return j.assert(!!n,"Unable to write GSUB: script "+e.tag+" has no default language system."),[{name:"scriptTag"+t,type:"TAG",value:e.tag},{name:"script"+t,type:"TABLE",value:new G("scriptTable",[{name:"defaultLangSys",type:"TABLE",value:new G("defaultLangSys",[{name:"lookupOrder",type:"USHORT",value:0},{name:"reqFeatureIndex",type:"USHORT",value:n.reqFeatureIndex}].concat(V("featureIndex",n.featureIndexes)))}].concat(W("langSys",r.langSysRecords,(function(e,t){var r=e.langSys;return[{name:"langSysTag"+t,type:"TAG",value:e.tag},{name:"langSys"+t,type:"TABLE",value:new G("langSys",[{name:"lookupOrder",type:"USHORT",value:0},{name:"reqFeatureIndex",type:"USHORT",value:r.reqFeatureIndex}].concat(V("featureIndex",r.featureIndexes)))}]}))))}]})))}function Y(e){G.call(this,"featureListTable",W("featureRecord",e,(function(e,t){var r=e.feature;return[{name:"featureTag"+t,type:"TAG",value:e.tag},{name:"feature"+t,type:"TABLE",value:new G("featureTable",[{name:"featureParams",type:"USHORT",value:r.featureParams}].concat(V("lookupListIndex",r.lookupListIndexes)))}]})))}function Z(e,t){G.call(this,"lookupListTable",H("lookup",e,(function(e){var r=t[e.lookupType];return j.assert(!!r,"Unable to write GSUB lookup type "+e.lookupType+" tables."),new G("lookupTable",[{name:"lookupType",type:"USHORT",value:e.lookupType},{name:"lookupFlag",type:"USHORT",value:e.lookupFlag}].concat(H("subtable",e.subtables,r)))})))}D.CHARSTRING=function(e){if(z){var t=z.get(e);if(void 0!==t)return t}for(var r=[],n=e.length,i=0;i<n;i+=1){var s=e[i];r=r.concat(D[s.type](s.value))}return z&&z.set(e,r),r},O.CHARSTRING=function(e){return D.CHARSTRING(e).length},D.OBJECT=function(e){var t=D[e.type];return j.argument(void 0!==t,"No encoding function for type "+e.type),t(e.value)},O.OBJECT=function(e){var t=O[e.type];return j.argument(void 0!==t,"No sizeOf function for type "+e.type),t(e.value)},D.TABLE=function(e){for(var t=[],r=e.fields.length,n=[],i=[],s=0;s<r;s+=1){var o=e.fields[s],a=D[o.type],l=(j.argument(void 0!==a,"No encoding function for field type "+o.type+" ("+o.name+")"),e[o.name]);a=a(l=void 0===l?o.value:l);"TABLE"===o.type?(i.push(t.length),t=t.concat([0,0]),n.push(a)):t=t.concat(a)}for(var c=0;c<n.length;c+=1){var u=i[c],h=t.length;j.argument(h<65536,"Table "+e.tableName+" too big."),t[u]=h>>8,t[u+1]=255&h,t=t.concat(n[c])}return t},O.TABLE=function(e){for(var t=0,r=e.fields.length,n=0;n<r;n+=1){var i=e.fields[n],s=O[i.type],o=(j.argument(void 0!==s,"No sizeOf function for field type "+i.type+" ("+i.name+")"),e[i.name]);t+=s(o=void 0===o?i.value:o),"TABLE"===i.type&&(t+=2)}return t},D.RECORD=D.TABLE,O.RECORD=O.TABLE,D.LITERAL=function(e){return e},O.LITERAL=function(e){return e.length},G.prototype.encode=function(){return D.TABLE(this)},G.prototype.sizeOf=function(){return O.TABLE(this)};var J={Table:G,Record:G,Coverage:(X.prototype=Object.create(G.prototype)).constructor=X,ScriptList:(q.prototype=Object.create(G.prototype)).constructor=q,FeatureList:(Y.prototype=Object.create(G.prototype)).constructor=Y,LookupList:(Z.prototype=Object.create(G.prototype)).constructor=Z,ushortList:V,tableList:H,recordList:W};function K(e,t){return e.getUint8(t)}function Q(e,t){return e.getUint16(t,!1)}function $(e,t){return e.getUint32(t,!1)}function ee(e,t){return e.getInt16(t,!1)+e.getUint16(t+2,!1)/65535}var te={byte:1,uShort:2,short:2,uLong:4,fixed:4,longDateTime:8,tag:4};function re(e,t){this.data=e,this.offset=t,this.relativeOffset=0}re.prototype.parseByte=function(){var e=this.data.getUint8(this.offset+this.relativeOffset);return this.relativeOffset+=1,e},re.prototype.parseChar=function(){var e=this.data.getInt8(this.offset+this.relativeOffset);return this.relativeOffset+=1,e},re.prototype.parseCard8=re.prototype.parseByte,re.prototype.parseCard16=re.prototype.parseUShort=function(){var e=this.data.getUint16(this.offset+this.relativeOffset);return this.relativeOffset+=2,e},re.prototype.parseSID=re.prototype.parseUShort,re.prototype.parseOffset16=re.prototype.parseUShort,re.prototype.parseShort=function(){var e=this.data.getInt16(this.offset+this.relativeOffset);return this.relativeOffset+=2,e},re.prototype.parseF2Dot14=function(){var e=this.data.getInt16(this.offset+this.relativeOffset)/16384;return this.relativeOffset+=2,e},re.prototype.parseOffset32=re.prototype.parseULong=function(){var e=$(this.data,this.offset+this.relativeOffset);return this.relativeOffset+=4,e},re.prototype.parseFixed=function(){var e=ee(this.data,this.offset+this.relativeOffset);return this.relativeOffset+=4,e},re.prototype.parseString=function(e){var t=this.data,r=this.offset+this.relativeOffset,n="";this.relativeOffset+=e;for(var i=0;i<e;i++)n+=String.fromCharCode(t.getUint8(r+i));return n},re.prototype.parseTag=function(){return this.parseString(4)},re.prototype.parseLongDateTime=function(){var e=$(this.data,this.offset+this.relativeOffset+4);return e-=2082844800,this.relativeOffset+=8,e},re.prototype.parseVersion=function(e){var t=Q(this.data,this.offset+this.relativeOffset),r=Q(this.data,this.offset+this.relativeOffset+2);return this.relativeOffset+=4,t+r/(e=void 0===e?4096:e)/10},re.prototype.skip=function(e,t){this.relativeOffset+=te[e]*(t=void 0===t?1:t)},re.prototype.parseULongList=function(e){void 0===e&&(e=this.parseULong());for(var t=new Array(e),r=this.data,n=this.offset+this.relativeOffset,i=0;i<e;i++)t[i]=r.getUint32(n),n+=4;return this.relativeOffset+=4*e,t},re.prototype.parseOffset16List=re.prototype.parseUShortList=function(e){void 0===e&&(e=this.parseUShort());for(var t=new Array(e),r=this.data,n=this.offset+this.relativeOffset,i=0;i<e;i++)t[i]=r.getUint16(n),n+=2;return this.relativeOffset+=2*e,t},re.prototype.parseShortList=function(e){for(var t=new Array(e),r=this.data,n=this.offset+this.relativeOffset,i=0;i<e;i++)t[i]=r.getInt16(n),n+=2;return this.relativeOffset+=2*e,t},re.prototype.parseByteList=function(e){for(var t=new Array(e),r=this.data,n=this.offset+this.relativeOffset,i=0;i<e;i++)t[i]=r.getUint8(n++);return this.relativeOffset+=e,t},re.prototype.parseList=function(e,t){t||(t=e,e=this.parseUShort());for(var r=new Array(e),n=0;n<e;n++)r[n]=t.call(this);return r},re.prototype.parseList32=function(e,t){t||(t=e,e=this.parseULong());for(var r=new Array(e),n=0;n<e;n++)r[n]=t.call(this);return r},re.prototype.parseRecordList=function(e,t){t||(t=e,e=this.parseUShort());for(var r=new Array(e),n=Object.keys(t),i=0;i<e;i++){for(var s={},o=0;o<n.length;o++){var a=n[o],l=t[a];s[a]=l.call(this)}r[i]=s}return r},re.prototype.parseRecordList32=function(e,t){t||(t=e,e=this.parseULong());for(var r=new Array(e),n=Object.keys(t),i=0;i<e;i++){for(var s={},o=0;o<n.length;o++){var a=n[o],l=t[a];s[a]=l.call(this)}r[i]=s}return r},re.prototype.parseStruct=function(e){if("function"==typeof e)return e.call(this);for(var t=Object.keys(e),r={},n=0;n<t.length;n++){var i=t[n],s=e[i];r[i]=s.call(this)}return r},re.prototype.parseValueRecord=function(e){var t;if(0!==(e=void 0===e?this.parseUShort():e))return t={},1&e&&(t.xPlacement=this.parseShort()),2&e&&(t.yPlacement=this.parseShort()),4&e&&(t.xAdvance=this.parseShort()),8&e&&(t.yAdvance=this.parseShort()),16&e&&(t.xPlaDevice=void 0,this.parseShort()),32&e&&(t.yPlaDevice=void 0,this.parseShort()),64&e&&(t.xAdvDevice=void 0,this.parseShort()),128&e&&(t.yAdvDevice=void 0,this.parseShort()),t},re.prototype.parseValueRecordList=function(){for(var e=this.parseUShort(),t=this.parseUShort(),r=new Array(t),n=0;n<t;n++)r[n]=this.parseValueRecord(e);return r},re.prototype.parsePointer=function(e){var t=this.parseOffset16();if(0<t)return new re(this.data,this.offset+t).parseStruct(e)},re.prototype.parsePointer32=function(e){var t=this.parseOffset32();if(0<t)return new re(this.data,this.offset+t).parseStruct(e)},re.prototype.parseListOfLists=function(e){for(var t=this.parseOffset16List(),r=t.length,n=this.relativeOffset,i=new Array(r),s=0;s<r;s++){var o=t[s];if(0===o)i[s]=void 0;else if(this.relativeOffset=o,e){for(var a=this.parseOffset16List(),l=new Array(a.length),c=0;c<a.length;c++)this.relativeOffset=o+a[c],l[c]=e.call(this);i[s]=l}else i[s]=this.parseUShortList()}return this.relativeOffset=n,i},re.prototype.parseCoverage=function(){var e=this.offset+this.relativeOffset,t=this.parseUShort(),r=this.parseUShort();if(1===t)return{format:1,glyphs:this.parseUShortList(r)};if(2!==t)throw new Error("0x"+e.toString(16)+": Coverage format must be 1 or 2.");for(var n=new Array(r),i=0;i<r;i++)n[i]={start:this.parseUShort(),end:this.parseUShort(),index:this.parseUShort()};return{format:2,ranges:n}},re.prototype.parseClassDef=function(){var e=this.offset+this.relativeOffset,t=this.parseUShort();if(1===t)return{format:1,startGlyph:this.parseUShort(),classes:this.parseUShortList()};if(2===t)return{format:2,ranges:this.parseRecordList({start:re.uShort,end:re.uShort,classId:re.uShort})};throw new Error("0x"+e.toString(16)+": ClassDef format must be 1 or 2.")},re.list=function(e,t){return function(){return this.parseList(e,t)}},re.list32=function(e,t){return function(){return this.parseList32(e,t)}},re.recordList=function(e,t){return function(){return this.parseRecordList(e,t)}},re.recordList32=function(e,t){return function(){return this.parseRecordList32(e,t)}},re.pointer=function(e){return function(){return this.parsePointer(e)}},re.pointer32=function(e){return function(){return this.parsePointer32(e)}},re.tag=re.prototype.parseTag,re.byte=re.prototype.parseByte,re.uShort=re.offset16=re.prototype.parseUShort,re.uShortList=re.prototype.parseUShortList,re.uLong=re.offset32=re.prototype.parseULong,re.uLongList=re.prototype.parseULongList,re.struct=re.prototype.parseStruct,re.coverage=re.prototype.parseCoverage,re.classDef=re.prototype.parseClassDef;var ne={reserved:re.uShort,reqFeatureIndex:re.uShort,featureIndexes:re.uShortList},ie=(re.prototype.parseScriptList=function(){return this.parsePointer(re.recordList({tag:re.tag,script:re.pointer({defaultLangSys:re.pointer(ne),langSysRecords:re.recordList({tag:re.tag,langSys:re.pointer(ne)})})}))||[]},re.prototype.parseFeatureList=function(){return this.parsePointer(re.recordList({tag:re.tag,feature:re.pointer({featureParams:re.offset16,lookupListIndexes:re.uShortList})}))||[]},re.prototype.parseLookupList=function(e){return this.parsePointer(re.list(re.pointer((function(){var t=this.parseUShort(),r=(j.argument(1<=t&&t<=9,"GPOS/GSUB lookup type "+t+" unknown."),this.parseUShort()),n=16&r;return{lookupType:t,lookupFlag:r,subtables:this.parseList(re.pointer(e[t])),markFilteringSet:n?this.parseUShort():void 0}}))))||[]},re.prototype.parseFeatureVariationsList=function(){return this.parsePointer32((function(){var e=this.parseUShort(),t=this.parseUShort();return j.argument(1===e&&t<1,"GPOS/GSUB feature variations table unknown."),this.parseRecordList32({conditionSetOffset:re.offset32,featureTableSubstitutionOffset:re.offset32})}))||[]},{getByte:K,getCard8:K,getUShort:Q,getCard16:Q,getShort:function(e,t){return e.getInt16(t,!1)},getULong:$,getFixed:ee,getTag:function(e,t){for(var r="",n=t;n<t+4;n+=1)r+=String.fromCharCode(e.getInt8(n));return r},getOffset:function(e,t,r){for(var n=0,i=0;i<r;i+=1)n=(n<<=8)+e.getUint8(t+i);return n},getBytes:function(e,t,r){for(var n=[],i=t;i<r;i+=1)n.push(e.getUint8(i));return n},bytesToString:function(e){for(var t="",r=0;r<e.length;r+=1)t+=String.fromCharCode(e[r]);return t},Parser:re}),se={parse:function(e,t){for(var r={},n=(r.version=ie.getUShort(e,t),j.argument(0===r.version,"cmap table version should be 0."),r.numTables=ie.getUShort(e,t+2),-1),i=r.numTables-1;0<=i;--i){var s=ie.getUShort(e,t+4+8*i),o=ie.getUShort(e,t+4+8*i+2);if(3===s&&(0===o||1===o||10===o)||0===s&&(0===o||1===o||2===o||3===o||4===o)){n=ie.getULong(e,t+4+8*i+4);break}}if(-1===n)throw new Error("No valid cmap sub-tables found.");var a=new ie.Parser(e,t+n);if(r.format=a.parseUShort(),12===r.format){var l,c=r,u=a;u.parseUShort(),c.length=u.parseULong(),c.language=u.parseULong(),c.groupCount=l=u.parseULong(),c.glyphIndexMap={};for(var h=0;h<l;h+=1)for(var d=u.parseULong(),p=u.parseULong(),f=u.parseULong(),m=d;m<=p;m+=1)c.glyphIndexMap[m]=f,f++}else{if(4!==r.format)throw new Error("Only format 4 and 12 cmap tables are supported (found format "+r.format+").");var g=r,y=e,v=t,_=n;g.length=a.parseUShort(),g.language=a.parseUShort(),g.segCount=x=a.parseUShort()>>1,a.skip("uShort",3),g.glyphIndexMap={};for(var x,b=new ie.Parser(y,v+_+14),w=new ie.Parser(y,v+_+16+2*x),S=new ie.Parser(y,v+_+16+4*x),M=new ie.Parser(y,v+_+16+6*x),T=v+_+16+8*x,E=0;E<x-1;E+=1)for(var A=void 0,C=b.parseUShort(),L=w.parseUShort(),R=S.parseShort(),P=M.parseUShort(),I=L;I<=C;I+=1)0!==P?(T=(T=M.offset+M.relativeOffset-2)+P+2*(I-L),0!==(A=ie.getUShort(y,T))&&(A=A+R&65535)):A=I+R&65535,g.glyphIndexMap[I]=A}return r},make:function(e){for(var t=!0,r=e.length-1;0<r;--r)if(65535<e.get(r).unicode){t=!1;break}var n,i,s=[{name:"version",type:"USHORT",value:0},{name:"numTables",type:"USHORT",value:t?1:2},{name:"platformID",type:"USHORT",value:3},{name:"encodingID",type:"USHORT",value:1},{name:"offset",type:"ULONG",value:t?12:20}],o=(s=(s=t?s:s.concat([{name:"cmap12PlatformID",type:"USHORT",value:3},{name:"cmap12EncodingID",type:"USHORT",value:10},{name:"cmap12Offset",type:"ULONG",value:0}])).concat([{name:"format",type:"USHORT",value:4},{name:"cmap4Length",type:"USHORT",value:0},{name:"language",type:"USHORT",value:0},{name:"segCountX2",type:"USHORT",value:0},{name:"searchRange",type:"USHORT",value:0},{name:"entrySelector",type:"USHORT",value:0},{name:"rangeShift",type:"USHORT",value:0}]),new J.Table("cmap",s));for(o.segments=[],r=0;r<e.length;r+=1){for(var a=e.get(r),l=0;l<a.unicodes.length;l+=1)n=a.unicodes[l],i=r,o.segments.push({end:n,start:n,delta:-(n-i),offset:0,glyphIndex:i});o.segments=o.segments.sort((function(e,t){return e.start-t.start}))}o.segments.push({end:65535,start:65535,delta:1,offset:0});var c=o.segments.length,u=0,h=[],d=[],p=[],f=[],m=[],g=[];for(r=0;r<c;r+=1){var y=o.segments[r];y.end<=65535&&y.start<=65535?(h=h.concat({name:"end_"+r,type:"USHORT",value:y.end}),d=d.concat({name:"start_"+r,type:"USHORT",value:y.start}),p=p.concat({name:"idDelta_"+r,type:"SHORT",value:y.delta}),f=f.concat({name:"idRangeOffset_"+r,type:"USHORT",value:y.offset}),void 0!==y.glyphId&&(m=m.concat({name:"glyph_"+r,type:"USHORT",value:y.glyphId}))):u+=1,t||void 0===y.glyphIndex||(g=(g=(g=g.concat({name:"cmap12Start_"+r,type:"ULONG",value:y.start})).concat({name:"cmap12End_"+r,type:"ULONG",value:y.end})).concat({name:"cmap12Glyph_"+r,type:"ULONG",value:y.glyphIndex}))}return o.segCountX2=2*(c-u),o.searchRange=2*Math.pow(2,Math.floor(Math.log(c-u)/Math.log(2))),o.entrySelector=Math.log(o.searchRange/2)/Math.log(2),o.rangeShift=o.segCountX2-o.searchRange,o.fields=o.fields.concat(h),o.fields.push({name:"reservedPad",type:"USHORT",value:0}),o.fields=o.fields.concat(d),o.fields=o.fields.concat(p),o.fields=o.fields.concat(f),o.fields=o.fields.concat(m),o.cmap4Length=14+2*h.length+2+2*d.length+2*p.length+2*f.length+2*m.length,t||(s=16+4*g.length,o.cmap12Offset=20+o.cmap4Length,o.fields=o.fields.concat([{name:"cmap12Format",type:"USHORT",value:12},{name:"cmap12Reserved",type:"USHORT",value:0},{name:"cmap12Length",type:"ULONG",value:s},{name:"cmap12Language",type:"ULONG",value:0},{name:"cmap12nGroups",type:"ULONG",value:g.length/3}]),o.fields=o.fields.concat(g)),o}},oe=[".notdef","space","exclam","quotedbl","numbersign","dollar","percent","ampersand","quoteright","parenleft","parenright","asterisk","plus","comma","hyphen","period","slash","zero","one","two","three","four","five","six","seven","eight","nine","colon","semicolon","less","equal","greater","question","at","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","bracketleft","backslash","bracketright","asciicircum","underscore","quoteleft","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","braceleft","bar","braceright","asciitilde","exclamdown","cent","sterling","fraction","yen","florin","section","currency","quotesingle","quotedblleft","guillemotleft","guilsinglleft","guilsinglright","fi","fl","endash","dagger","daggerdbl","periodcentered","paragraph","bullet","quotesinglbase","quotedblbase","quotedblright","guillemotright","ellipsis","perthousand","questiondown","grave","acute","circumflex","tilde","macron","breve","dotaccent","dieresis","ring","cedilla","hungarumlaut","ogonek","caron","emdash","AE","ordfeminine","Lslash","Oslash","OE","ordmasculine","ae","dotlessi","lslash","oslash","oe","germandbls","onesuperior","logicalnot","mu","trademark","Eth","onehalf","plusminus","Thorn","onequarter","divide","brokenbar","degree","thorn","threequarters","twosuperior","registered","minus","eth","multiply","threesuperior","copyright","Aacute","Acircumflex","Adieresis","Agrave","Aring","Atilde","Ccedilla","Eacute","Ecircumflex","Edieresis","Egrave","Iacute","Icircumflex","Idieresis","Igrave","Ntilde","Oacute","Ocircumflex","Odieresis","Ograve","Otilde","Scaron","Uacute","Ucircumflex","Udieresis","Ugrave","Yacute","Ydieresis","Zcaron","aacute","acircumflex","adieresis","agrave","aring","atilde","ccedilla","eacute","ecircumflex","edieresis","egrave","iacute","icircumflex","idieresis","igrave","ntilde","oacute","ocircumflex","odieresis","ograve","otilde","scaron","uacute","ucircumflex","udieresis","ugrave","yacute","ydieresis","zcaron","exclamsmall","Hungarumlautsmall","dollaroldstyle","dollarsuperior","ampersandsmall","Acutesmall","parenleftsuperior","parenrightsuperior","266 ff","onedotenleader","zerooldstyle","oneoldstyle","twooldstyle","threeoldstyle","fouroldstyle","fiveoldstyle","sixoldstyle","sevenoldstyle","eightoldstyle","nineoldstyle","commasuperior","threequartersemdash","periodsuperior","questionsmall","asuperior","bsuperior","centsuperior","dsuperior","esuperior","isuperior","lsuperior","msuperior","nsuperior","osuperior","rsuperior","ssuperior","tsuperior","ff","ffi","ffl","parenleftinferior","parenrightinferior","Circumflexsmall","hyphensuperior","Gravesmall","Asmall","Bsmall","Csmall","Dsmall","Esmall","Fsmall","Gsmall","Hsmall","Ismall","Jsmall","Ksmall","Lsmall","Msmall","Nsmall","Osmall","Psmall","Qsmall","Rsmall","Ssmall","Tsmall","Usmall","Vsmall","Wsmall","Xsmall","Ysmall","Zsmall","colonmonetary","onefitted","rupiah","Tildesmall","exclamdownsmall","centoldstyle","Lslashsmall","Scaronsmall","Zcaronsmall","Dieresissmall","Brevesmall","Caronsmall","Dotaccentsmall","Macronsmall","figuredash","hypheninferior","Ogoneksmall","Ringsmall","Cedillasmall","questiondownsmall","oneeighth","threeeighths","fiveeighths","seveneighths","onethird","twothirds","zerosuperior","foursuperior","fivesuperior","sixsuperior","sevensuperior","eightsuperior","ninesuperior","zeroinferior","oneinferior","twoinferior","threeinferior","fourinferior","fiveinferior","sixinferior","seveninferior","eightinferior","nineinferior","centinferior","dollarinferior","periodinferior","commainferior","Agravesmall","Aacutesmall","Acircumflexsmall","Atildesmall","Adieresissmall","Aringsmall","AEsmall","Ccedillasmall","Egravesmall","Eacutesmall","Ecircumflexsmall","Edieresissmall","Igravesmall","Iacutesmall","Icircumflexsmall","Idieresissmall","Ethsmall","Ntildesmall","Ogravesmall","Oacutesmall","Ocircumflexsmall","Otildesmall","Odieresissmall","OEsmall","Oslashsmall","Ugravesmall","Uacutesmall","Ucircumflexsmall","Udieresissmall","Yacutesmall","Thornsmall","Ydieresissmall","001.000","001.001","001.002","001.003","Black","Bold","Book","Light","Medium","Regular","Roman","Semibold"],ae=["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","space","exclam","quotedbl","numbersign","dollar","percent","ampersand","quoteright","parenleft","parenright","asterisk","plus","comma","hyphen","period","slash","zero","one","two","three","four","five","six","seven","eight","nine","colon","semicolon","less","equal","greater","question","at","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","bracketleft","backslash","bracketright","asciicircum","underscore","quoteleft","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","braceleft","bar","braceright","asciitilde","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","exclamdown","cent","sterling","fraction","yen","florin","section","currency","quotesingle","quotedblleft","guillemotleft","guilsinglleft","guilsinglright","fi","fl","","endash","dagger","daggerdbl","periodcentered","","paragraph","bullet","quotesinglbase","quotedblbase","quotedblright","guillemotright","ellipsis","perthousand","","questiondown","","grave","acute","circumflex","tilde","macron","breve","dotaccent","dieresis","","ring","cedilla","","hungarumlaut","ogonek","caron","emdash","","","","","","","","","","","","","","","","","AE","","ordfeminine","","","","","Lslash","Oslash","OE","ordmasculine","","","","","","ae","","","","dotlessi","","","lslash","oslash","oe","germandbls"],le=["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","space","exclamsmall","Hungarumlautsmall","","dollaroldstyle","dollarsuperior","ampersandsmall","Acutesmall","parenleftsuperior","parenrightsuperior","twodotenleader","onedotenleader","comma","hyphen","period","fraction","zerooldstyle","oneoldstyle","twooldstyle","threeoldstyle","fouroldstyle","fiveoldstyle","sixoldstyle","sevenoldstyle","eightoldstyle","nineoldstyle","colon","semicolon","commasuperior","threequartersemdash","periodsuperior","questionsmall","","asuperior","bsuperior","centsuperior","dsuperior","esuperior","","","isuperior","","","lsuperior","msuperior","nsuperior","osuperior","","","rsuperior","ssuperior","tsuperior","","ff","fi","fl","ffi","ffl","parenleftinferior","","parenrightinferior","Circumflexsmall","hyphensuperior","Gravesmall","Asmall","Bsmall","Csmall","Dsmall","Esmall","Fsmall","Gsmall","Hsmall","Ismall","Jsmall","Ksmall","Lsmall","Msmall","Nsmall","Osmall","Psmall","Qsmall","Rsmall","Ssmall","Tsmall","Usmall","Vsmall","Wsmall","Xsmall","Ysmall","Zsmall","colonmonetary","onefitted","rupiah","Tildesmall","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","exclamdownsmall","centoldstyle","Lslashsmall","","","Scaronsmall","Zcaronsmall","Dieresissmall","Brevesmall","Caronsmall","","Dotaccentsmall","","","Macronsmall","","","figuredash","hypheninferior","","","Ogoneksmall","Ringsmall","Cedillasmall","","","","onequarter","onehalf","threequarters","questiondownsmall","oneeighth","threeeighths","fiveeighths","seveneighths","onethird","twothirds","","","zerosuperior","onesuperior","twosuperior","threesuperior","foursuperior","fivesuperior","sixsuperior","sevensuperior","eightsuperior","ninesuperior","zeroinferior","oneinferior","twoinferior","threeinferior","fourinferior","fiveinferior","sixinferior","seveninferior","eightinferior","nineinferior","centinferior","dollarinferior","periodinferior","commainferior","Agravesmall","Aacutesmall","Acircumflexsmall","Atildesmall","Adieresissmall","Aringsmall","AEsmall","Ccedillasmall","Egravesmall","Eacutesmall","Ecircumflexsmall","Edieresissmall","Igravesmall","Iacutesmall","Icircumflexsmall","Idieresissmall","Ethsmall","Ntildesmall","Ogravesmall","Oacutesmall","Ocircumflexsmall","Otildesmall","Odieresissmall","OEsmall","Oslashsmall","Ugravesmall","Uacutesmall","Ucircumflexsmall","Udieresissmall","Yacutesmall","Thornsmall","Ydieresissmall"],ce=[".notdef",".null","nonmarkingreturn","space","exclam","quotedbl","numbersign","dollar","percent","ampersand","quotesingle","parenleft","parenright","asterisk","plus","comma","hyphen","period","slash","zero","one","two","three","four","five","six","seven","eight","nine","colon","semicolon","less","equal","greater","question","at","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","bracketleft","backslash","bracketright","asciicircum","underscore","grave","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","braceleft","bar","braceright","asciitilde","Adieresis","Aring","Ccedilla","Eacute","Ntilde","Odieresis","Udieresis","aacute","agrave","acircumflex","adieresis","atilde","aring","ccedilla","eacute","egrave","ecircumflex","edieresis","iacute","igrave","icircumflex","idieresis","ntilde","oacute","ograve","ocircumflex","odieresis","otilde","uacute","ugrave","ucircumflex","udieresis","dagger","degree","cent","sterling","section","bullet","paragraph","germandbls","registered","copyright","trademark","acute","dieresis","notequal","AE","Oslash","infinity","plusminus","lessequal","greaterequal","yen","mu","partialdiff","summation","product","pi","integral","ordfeminine","ordmasculine","Omega","ae","oslash","questiondown","exclamdown","logicalnot","radical","florin","approxequal","Delta","guillemotleft","guillemotright","ellipsis","nonbreakingspace","Agrave","Atilde","Otilde","OE","oe","endash","emdash","quotedblleft","quotedblright","quoteleft","quoteright","divide","lozenge","ydieresis","Ydieresis","fraction","currency","guilsinglleft","guilsinglright","fi","fl","daggerdbl","periodcentered","quotesinglbase","quotedblbase","perthousand","Acircumflex","Ecircumflex","Aacute","Edieresis","Egrave","Iacute","Icircumflex","Idieresis","Igrave","Oacute","Ocircumflex","apple","Ograve","Uacute","Ucircumflex","Ugrave","dotlessi","circumflex","tilde","macron","breve","dotaccent","ring","cedilla","hungarumlaut","ogonek","caron","Lslash","lslash","Scaron","scaron","Zcaron","zcaron","brokenbar","Eth","eth","Yacute","yacute","Thorn","thorn","minus","multiply","onesuperior","twosuperior","threesuperior","onehalf","onequarter","threequarters","franc","Gbreve","gbreve","Idotaccent","Scedilla","scedilla","Cacute","cacute","Ccaron","ccaron","dcroat"];function ue(e){this.font=e}function he(e){this.cmap=e}function de(e,t){this.encoding=e,this.charset=t}function pe(e){switch(e.version){case 1:this.names=ce.slice();break;case 2:this.names=new Array(e.numberOfGlyphs);for(var t=0;t<e.numberOfGlyphs;t++)e.glyphNameIndex[t]<ce.length?this.names[t]=ce[e.glyphNameIndex[t]]:this.names[t]=e.names[e.glyphNameIndex[t]-ce.length];break;case 2.5:this.names=new Array(e.numberOfGlyphs);for(var r=0;r<e.numberOfGlyphs;r++)this.names[r]=ce[r+e.glyphNameIndex[r]];break;default:this.names=[]}}ue.prototype.charToGlyphIndex=function(e){var t=e.codePointAt(0),r=this.font.glyphs;if(r)for(var n=0;n<r.length;n+=1)for(var i=r.get(n),s=0;s<i.unicodes.length;s+=1)if(i.unicodes[s]===t)return n;return null},he.prototype.charToGlyphIndex=function(e){return this.cmap.glyphIndexMap[e.codePointAt(0)]||0},de.prototype.charToGlyphIndex=function(e){return e=e.codePointAt(0),e=this.encoding[e],this.charset.indexOf(e)},pe.prototype.nameToGlyphIndex=function(e){return this.names.indexOf(e)},pe.prototype.glyphIndexToName=function(e){return this.names[e]};var fe=function(e,t,r,n,i){e.beginPath(),e.moveTo(t,r),e.lineTo(n,i),e.stroke()};function me(e){this.bindConstructorValues(e)}function ge(e,t,r){Object.defineProperty(e,t,{get:function(){return e.path,e[r]},set:function(t){e[r]=t},enumerable:!0,configurable:!0})}function ye(e,t){if(this.font=e,this.glyphs={},Array.isArray(t))for(var r=0;r<t.length;r++)this.glyphs[r]=t[r];this.length=t&&t.length||0}me.prototype.bindConstructorValues=function(e){var t;this.index=e.index||0,this.name=e.name||null,this.unicode=e.unicode||void 0,this.unicodes=e.unicodes||void 0!==e.unicode?[e.unicode]:[],e.xMin&&(this.xMin=e.xMin),e.yMin&&(this.yMin=e.yMin),e.xMax&&(this.xMax=e.xMax),e.yMax&&(this.yMax=e.yMax),e.advanceWidth&&(this.advanceWidth=e.advanceWidth),Object.defineProperty(this,"path",(e=e.path,t=e||new L,{configurable:!0,get:function(){return t="function"==typeof t?t():t},set:function(e){t=e}}))},me.prototype.addUnicode=function(e){0===this.unicodes.length&&(this.unicode=e),this.unicodes.push(e)},me.prototype.getBoundingBox=function(){return this.path.getBoundingBox()},me.prototype.getPath=function(e,t,r,n,i){e=void 0!==e?e:0,t=void 0!==t?t:0,r=void 0!==r?r:72;for(var s,o,a=(n=n||{}).xScale,l=n.yScale,c=((s=n.hinting&&i&&i.hinting?this.path&&i.hinting.exec(this,r):s)?(o=i.hinting.getCommands(s),e=Math.round(e),t=Math.round(t),a=l=1):(o=this.path.commands,n=1/this.path.unitsPerEm*r,void 0===a&&(a=n),void 0===l&&(l=n)),new L),u=0;u<o.length;u+=1){var h=o[u];"M"===h.type?c.moveTo(e+h.x*a,t+-h.y*l):"L"===h.type?c.lineTo(e+h.x*a,t+-h.y*l):"Q"===h.type?c.quadraticCurveTo(e+h.x1*a,t+-h.y1*l,e+h.x*a,t+-h.y*l):"C"===h.type?c.curveTo(e+h.x1*a,t+-h.y1*l,e+h.x2*a,t+-h.y2*l,e+h.x*a,t+-h.y*l):"Z"===h.type&&c.closePath()}return c},me.prototype.getContours=function(){if(void 0===this.points)return[];for(var e=[],t=[],r=0;r<this.points.length;r+=1){var n=this.points[r];t.push(n),n.lastPointOfContour&&(e.push(t),t=[])}return j.argument(0===t.length,"There are still points left in the current contour."),e},me.prototype.getMetrics=function(){for(var e=this.path.commands,t=[],r=[],n=0;n<e.length;n+=1){var i=e[n];"Z"!==i.type&&(t.push(i.x),r.push(i.y)),"Q"!==i.type&&"C"!==i.type||(t.push(i.x1),r.push(i.y1)),"C"===i.type&&(t.push(i.x2),r.push(i.y2))}var s={xMin:Math.min.apply(null,t),yMin:Math.min.apply(null,r),xMax:Math.max.apply(null,t),yMax:Math.max.apply(null,r),leftSideBearing:this.leftSideBearing};return isFinite(s.xMin)||(s.xMin=0),isFinite(s.xMax)||(s.xMax=this.advanceWidth),isFinite(s.yMin)||(s.yMin=0),isFinite(s.yMax)||(s.yMax=0),s.rightSideBearing=this.advanceWidth-s.leftSideBearing-(s.xMax-s.xMin),s},me.prototype.draw=function(e,t,r,n,i){this.getPath(t,r,n,i).draw(e)},me.prototype.drawPoints=function(e,t,r,n){function i(t,r,n,i){var s=2*Math.PI;e.beginPath();for(var o=0;o<t.length;o+=1)e.moveTo(r+t[o].x*i,n+t[o].y*i),e.arc(r+t[o].x*i,n+t[o].y*i,2,0,s,!1);e.closePath(),e.fill()}t=void 0!==t?t:0,r=void 0!==r?r:0;n=1/this.path.unitsPerEm*(n=void 0!==n?n:24);for(var s=[],o=[],a=this.path,l=0;l<a.commands.length;l+=1){var c=a.commands[l];void 0!==c.x&&s.push({x:c.x,y:-c.y}),void 0!==c.x1&&o.push({x:c.x1,y:-c.y1}),void 0!==c.x2&&o.push({x:c.x2,y:-c.y2})}e.fillStyle="blue",i(s,t,r,n),e.fillStyle="red",i(o,t,r,n)},me.prototype.drawMetrics=function(e,t,r,n){t=void 0!==t?t:0,r=void 0!==r?r:0,n=1/this.path.unitsPerEm*(n=void 0!==n?n:24),e.lineWidth=1,e.strokeStyle="black",fe(e,t,-1e4,t,1e4),fe(e,-1e4,r,1e4,r);var i=this.xMin||0,s=this.yMin||0,o=this.xMax||0,a=this.yMax||0,l=this.advanceWidth||0;e.strokeStyle="blue",fe(e,t+i*n,-1e4,t+i*n,1e4),fe(e,t+o*n,-1e4,t+o*n,1e4),fe(e,-1e4,r+-s*n,1e4,r+-s*n),fe(e,-1e4,r+-a*n,1e4,r+-a*n),e.strokeStyle="green",fe(e,t+l*n,-1e4,t+l*n,1e4)},ye.prototype.get=function(e){return"function"==typeof this.glyphs[e]&&(this.glyphs[e]=this.glyphs[e]()),this.glyphs[e]},ye.prototype.push=function(e,t){this.glyphs[e]=t,this.length++};var ve={GlyphSet:ye,glyphLoader:function(e,t){return new me({index:t,font:e})},ttfGlyphLoader:function(e,t,r,n,i,s){return function(){var o=new me({index:t,font:e});return o.path=function(){r(o,n,i);var t=s(e.glyphs,o);return t.unitsPerEm=e.unitsPerEm,t},ge(o,"xMin","_xMin"),ge(o,"xMax","_xMax"),ge(o,"yMin","_yMin"),ge(o,"yMax","_yMax"),o}},cffGlyphLoader:function(e,t,r,n){return function(){var i=new me({index:t,font:e});return i.path=function(){var t=r(e,i,n);return t.unitsPerEm=e.unitsPerEm,t},i}}};function _e(e){return e=e.length<1240?107:e.length<33900?1131:32768}function xe(e,t,r){var n,i=[],s=[],o=ie.getCard16(e,t);if(0!==o){for(var a=ie.getByte(e,t+2),l=t+(o+1)*a+2,c=t+3,u=0;u<o+1;u+=1)i.push(ie.getOffset(e,c,a)),c+=a;n=l+i[o]}else n=t+2;for(var h=0;h<i.length-1;h+=1){var d=ie.getBytes(e,l+i[h],l+i[h+1]);r&&(d=r(d)),s.push(d)}return{objects:s,startOffset:t,endOffset:n}}function be(e,t){if(28===t)return e.parseByte()<<8|e.parseByte();if(29===t)return e.parseByte()<<24|e.parseByte()<<16|e.parseByte()<<8|e.parseByte();if(30===t){for(var r=e,n="",i=["0","1","2","3","4","5","6","7","8","9",".","E","E-",null,"-"];;){var s=(o=r.parseByte())>>4,o=15&o;if(15==s)break;if(n+=i[s],15==o)break;n+=i[o]}return parseFloat(n)}if(32<=t&&t<=246)return t-139;if(247<=t&&t<=250)return 256*(t-247)+e.parseByte()+108;if(251<=t&&t<=254)return 256*-(t-251)-e.parseByte()-108;throw new Error("Invalid b0 "+t)}function we(e,t,r){var n=new ie.Parser(e,t=void 0!==t?t:0),i=[],s=[];for(r=void 0!==r?r:e.length;n.relativeOffset<r;){var o=n.parseByte();o<=21?(12===o&&(o=1200+n.parseByte()),i.push([o,s]),s=[]):s.push(be(n,o))}for(var a=i,l={},c=0;c<a.length;c+=1){var u=a[c][0],h=a[c][1],d=1===h.length?h[0]:h;if(l.hasOwnProperty(u)&&!isNaN(l[u]))throw new Error("Object "+l+" already has key "+u);l[u]=d}return l}function Se(e,t){return t<=390?oe[t]:e[t-391]}function Me(e,t,r){for(var n,i={},s=0;s<t.length;s+=1){var o=t[s];if(Array.isArray(o.type)){var a=[];a.length=o.type.length;for(var l=0;l<o.type.length;l++)void 0===(n=void 0!==e[o.op]?e[o.op][l]:void 0)&&(n=void 0!==o.value&&void 0!==o.value[l]?o.value[l]:null),"SID"===o.type[l]&&(n=Se(r,n)),a[l]=n;i[o.name]=a}else void 0===(n=e[o.op])&&(n=void 0!==o.value?o.value:null),"SID"===o.type&&(n=Se(r,n)),i[o.name]=n}return i}var Te=[{name:"version",op:0,type:"SID"},{name:"notice",op:1,type:"SID"},{name:"copyright",op:1200,type:"SID"},{name:"fullName",op:2,type:"SID"},{name:"familyName",op:3,type:"SID"},{name:"weight",op:4,type:"SID"},{name:"isFixedPitch",op:1201,type:"number",value:0},{name:"italicAngle",op:1202,type:"number",value:0},{name:"underlinePosition",op:1203,type:"number",value:-100},{name:"underlineThickness",op:1204,type:"number",value:50},{name:"paintType",op:1205,type:"number",value:0},{name:"charstringType",op:1206,type:"number",value:2},{name:"fontMatrix",op:1207,type:["real","real","real","real","real","real"],value:[.001,0,0,.001,0,0]},{name:"uniqueId",op:13,type:"number"},{name:"fontBBox",op:5,type:["number","number","number","number"],value:[0,0,0,0]},{name:"strokeWidth",op:1208,type:"number",value:0},{name:"xuid",op:14,type:[],value:null},{name:"charset",op:15,type:"offset",value:0},{name:"encoding",op:16,type:"offset",value:0},{name:"charStrings",op:17,type:"offset",value:0},{name:"private",op:18,type:["number","offset"],value:[0,0]},{name:"ros",op:1230,type:["SID","SID","number"]},{name:"cidFontVersion",op:1231,type:"number",value:0},{name:"cidFontRevision",op:1232,type:"number",value:0},{name:"cidFontType",op:1233,type:"number",value:0},{name:"cidCount",op:1234,type:"number",value:8720},{name:"uidBase",op:1235,type:"number"},{name:"fdArray",op:1236,type:"offset"},{name:"fdSelect",op:1237,type:"offset"},{name:"fontName",op:1238,type:"SID"}],Ee=[{name:"subrs",op:19,type:"offset",value:0},{name:"defaultWidthX",op:20,type:"number",value:0},{name:"nominalWidthX",op:21,type:"number",value:0}];function Ae(e,t,r,n){return Me(we(e,t,r),Ee,n)}function Ce(e,t,r,n){for(var i=[],s=0;s<r.length;s+=1){var o,a=((o=(a=n,Me(we(o=new DataView(new Uint8Array(r[s]).buffer),0,o.byteLength),Te,a)))._subrs=[],o._subrsBias=0,o.private[0]),l=o.private[1];0!==a&&0!==l&&(a=Ae(e,l+t,a,n),o._defaultWidthX=a.defaultWidthX,o._nominalWidthX=a.nominalWidthX,0!==a.subrs&&(l=xe(e,l+a.subrs+t),o._subrs=l.objects,o._subrsBias=_e(o._subrs)),o._privateDict=a),i.push(o)}return i}function Le(e,t,r){var n,i,s,o,a,l,c,u,h,d=new L,p=[],f=0,m=!1,g=!1,y=0,v=0,_=(h=(e.isCIDFont?(a=e.tables.cff.topDict._fdSelect[t.index],a=e.tables.cff.topDict._fdArray[a],l=a._subrs,c=a._subrsBias,u=a._defaultWidthX,a):(l=e.tables.cff.topDict._subrs,c=e.tables.cff.topDict._subrsBias,u=e.tables.cff.topDict._defaultWidthX,e.tables.cff.topDict))._nominalWidthX,u);function x(e,t){g&&d.closePath(),d.moveTo(e,t),g=!0}function b(){p.length%2==0||m||(_=p.shift()+h),f+=p.length>>1,p.length=0,m=!0}return function t(r){for(var a,u,w,S,M,T,E,A,C,L,R,P,j=0;j<r.length;){var I=r[j];switch(j+=1,I){case 1:case 3:case 18:case 23:b();break;case 4:1<p.length&&!m&&(_=p.shift()+h,m=!0),v+=p.pop(),x(y,v);break;case 5:for(;0<p.length;)y+=p.shift(),v+=p.shift(),d.lineTo(y,v);break;case 6:for(;0<p.length&&(y+=p.shift(),d.lineTo(y,v),0!==p.length);)v+=p.shift(),d.lineTo(y,v);break;case 7:for(;0<p.length&&(v+=p.shift(),d.lineTo(y,v),0!==p.length);)y+=p.shift(),d.lineTo(y,v);break;case 8:for(;0<p.length;)n=y+p.shift(),i=v+p.shift(),s=n+p.shift(),o=i+p.shift(),y=s+p.shift(),v=o+p.shift(),d.curveTo(n,i,s,o,y,v);break;case 10:M=p.pop()+c,(T=l[M])&&t(T);break;case 11:return;case 12:switch(I=r[j],j+=1,I){case 35:n=y+p.shift(),i=v+p.shift(),s=n+p.shift(),o=i+p.shift(),E=s+p.shift(),A=o+p.shift(),C=E+p.shift(),L=A+p.shift(),R=C+p.shift(),P=L+p.shift(),y=R+p.shift(),v=P+p.shift(),p.shift(),d.curveTo(n,i,s,o,E,A),d.curveTo(C,L,R,P,y,v);break;case 34:n=y+p.shift(),i=v,s=n+p.shift(),o=i+p.shift(),E=s+p.shift(),A=o,C=E+p.shift(),L=o,R=C+p.shift(),P=v,y=R+p.shift(),d.curveTo(n,i,s,o,E,A),d.curveTo(C,L,R,P,y,v);break;case 36:n=y+p.shift(),i=v+p.shift(),s=n+p.shift(),o=i+p.shift(),E=s+p.shift(),A=o,C=E+p.shift(),L=o,R=C+p.shift(),P=L+p.shift(),y=R+p.shift(),d.curveTo(n,i,s,o,E,A),d.curveTo(C,L,R,P,y,v);break;case 37:n=y+p.shift(),i=v+p.shift(),s=n+p.shift(),o=i+p.shift(),E=s+p.shift(),A=o+p.shift(),C=E+p.shift(),L=A+p.shift(),R=C+p.shift(),P=L+p.shift(),Math.abs(R-y)>Math.abs(P-v)?y=R+p.shift():v=P+p.shift(),d.curveTo(n,i,s,o,E,A),d.curveTo(C,L,R,P,y,v);break;default:p.length=0}break;case 14:0<p.length&&!m&&(_=p.shift()+h,m=!0),g&&(d.closePath(),g=!1);break;case 19:case 20:b(),j+=f+7>>3;break;case 21:2<p.length&&!m&&(_=p.shift()+h,m=!0),v+=p.pop(),x(y+=p.pop(),v);break;case 22:1<p.length&&!m&&(_=p.shift()+h,m=!0),x(y+=p.pop(),v);break;case 24:for(;2<p.length;)n=y+p.shift(),i=v+p.shift(),s=n+p.shift(),o=i+p.shift(),y=s+p.shift(),v=o+p.shift(),d.curveTo(n,i,s,o,y,v);y+=p.shift(),v+=p.shift(),d.lineTo(y,v);break;case 25:for(;6<p.length;)y+=p.shift(),v+=p.shift(),d.lineTo(y,v);n=y+p.shift(),i=v+p.shift(),s=n+p.shift(),o=i+p.shift(),y=s+p.shift(),v=o+p.shift(),d.curveTo(n,i,s,o,y,v);break;case 26:for(p.length%2&&(y+=p.shift());0<p.length;)n=y,i=v+p.shift(),s=n+p.shift(),o=i+p.shift(),y=s,v=o+p.shift(),d.curveTo(n,i,s,o,y,v);break;case 27:for(p.length%2&&(v+=p.shift());0<p.length;)n=y+p.shift(),i=v,s=n+p.shift(),o=i+p.shift(),y=s+p.shift(),v=o,d.curveTo(n,i,s,o,y,v);break;case 28:a=r[j],u=r[j+1],p.push((a<<24|u<<16)>>16),j+=2;break;case 29:M=p.pop()+e.gsubrsBias,(T=e.gsubrs[M])&&t(T);break;case 30:for(;0<p.length&&(n=y,i=v+p.shift(),s=n+p.shift(),o=i+p.shift(),y=s+p.shift(),v=o+(1===p.length?p.shift():0),d.curveTo(n,i,s,o,y,v),0!==p.length);)n=y+p.shift(),i=v,s=n+p.shift(),o=i+p.shift(),v=o+p.shift(),y=s+(1===p.length?p.shift():0),d.curveTo(n,i,s,o,y,v);break;case 31:for(;0<p.length&&(n=y+p.shift(),i=v,s=n+p.shift(),o=i+p.shift(),v=o+p.shift(),y=s+(1===p.length?p.shift():0),d.curveTo(n,i,s,o,y,v),0!==p.length);)n=y,i=v+p.shift(),s=n+p.shift(),o=i+p.shift(),y=s+p.shift(),v=o+(1===p.length?p.shift():0),d.curveTo(n,i,s,o,y,v);break;default:I<32||(I<247?p.push(I-139):I<251?(a=r[j],j+=1,p.push(256*(I-247)+a+108)):I<255?(a=r[j],j+=1,p.push(256*-(I-251)-a-108)):(a=r[j],u=r[j+1],w=r[j+2],S=r[j+3],j+=4,p.push((a<<24|u<<16|w<<8|S)/65536)))}}}(r),t.advanceWidth=_,d}function Re(e,t){var r,n=oe.indexOf(e);return 0<=n&&(r=n),0<=(n=t.indexOf(e))?r=n+oe.length:(r=oe.length+t.length,t.push(e)),r}function Pe(e,t,r){for(var n={},i=0;i<e.length;i+=1){var s=e[i],o=t[s.name];void 0===o||function e(t,r){if(t===r)return 1;if(Array.isArray(t)&&Array.isArray(r)&&t.length===r.length){for(var n=0;n<t.length;n+=1)if(!e(t[n],r[n]))return;return 1}}(o,s.value)||("SID"===s.type&&(o=Re(o,r)),n[s.op]={name:s.name,type:s.type,value:o})}return n}function je(e,t){var r=new J.Record("Top DICT",[{name:"dict",type:"DICT",value:{}}]);return r.dict=Pe(Te,e,t),r}function Ie(e){var t=new J.Record("Top DICT INDEX",[{name:"topDicts",type:"INDEX",value:[]}]);return t.topDicts=[{name:"topDict_0",type:"TABLE",value:e}],t}var De={parse:function(e,t,r){r.tables.cff={},n=e,i=t,(s={}).formatMajor=ie.getCard8(n,i),s.formatMinor=ie.getCard8(n,i+1),s.size=ie.getCard8(n,i+2),s.offsetSize=ie.getCard8(n,i+3),s.startOffset=i,s.endOffset=i+4;var n=xe(e,s.endOffset,ie.bytesToString),i=xe(e,n.endOffset),s=xe(e,i.endOffset,ie.bytesToString);n=xe(e,s.endOffset);if(r.gsubrs=n.objects,r.gsubrsBias=_e(r.gsubrs),1!==(n=Ce(e,t,i.objects,s.objects)).length)throw new Error("CFF table has too many fonts in 'FontSet' - count of fonts NameIndex.length = "+n.length);if(i=n[0],(r.tables.cff.topDict=i)._privateDict&&(r.defaultWidthX=i._privateDict.defaultWidthX,r.nominalWidthX=i._privateDict.nominalWidthX),void 0!==i.ros[0]&&void 0!==i.ros[1]&&(r.isCIDFont=!0),r.isCIDFont){n=i.fdArray;var o=i.fdSelect;if(0===n||0===o)throw new Error("Font is marked as a CID font, but FDArray and/or FDSelect information is missing");n=Ce(e,t,xe(e,n+=t).objects,s.objects),i._fdArray=n,i._fdSelect=function(e,t,r,n){var i,s=[],o=new ie.Parser(e,t);if(0===(e=o.parseCard8()))for(var a=0;a<r;a++){if(n<=(i=o.parseCard8()))throw new Error("CFF table CID Font FDSelect has bad FD index value "+i+" (FD count "+n+")");s.push(i)}else{if(3!==e)throw new Error("CFF Table CID Font FDSelect table has unsupported format "+e);var l,c=o.parseCard16(),u=o.parseCard16();if(0!==u)throw new Error("CFF Table CID Font FDSelect format 3 range has bad initial GID "+u);for(var h=0;h<c;h++){if(i=o.parseCard8(),l=o.parseCard16(),n<=i)throw new Error("CFF table CID Font FDSelect has bad FD index value "+i+" (FD count "+n+")");if(r<l)throw new Error("CFF Table CID Font FDSelect format 3 range has bad GID "+l);for(;u<l;u++)s.push(i);u=l}if(l!==r)throw new Error("CFF Table CID Font FDSelect format 3 range has bad final GID "+l)}return s}(e,o+=t,r.numGlyphs,n.length)}n=Ae(e,o=t+i.private[1],i.private[0],s.objects);var a=(r.defaultWidthX=n.defaultWidthX,r.nominalWidthX=n.nominalWidthX,0!==n.subrs?(o=xe(e,o+n.subrs),r.subrs=o.objects,r.subrsBias=_e(r.subrs)):(r.subrs=[],r.subrsBias=0),xe(e,t+i.charStrings));r.nGlyphs=a.objects.length,n=function(e,t,r,n){var i=new ie.Parser(e,t),s=(--r,[".notdef"]);if(0===(e=i.parseCard8()))for(var o=0;o<r;o+=1)a=i.parseSID(),s.push(Se(n,a));else if(1===e)for(;s.length<=r;)for(var a=i.parseSID(),l=i.parseCard8(),c=0;c<=l;c+=1)s.push(Se(n,a)),a+=1;else{if(2!==e)throw new Error("Unknown charset format "+e);for(;s.length<=r;){a=i.parseSID(),l=i.parseCard16();for(var u=0;u<=l;u+=1)s.push(Se(n,a)),a+=1}}return s}(e,t+i.charset,r.nGlyphs,s.objects);0===i.encoding?r.cffEncoding=new de(ae,n):1===i.encoding?r.cffEncoding=new de(le,n):r.cffEncoding=function(e,t,r){var n={},i=new ie.Parser(e,t);if(0===(e=i.parseCard8()))for(var s=i.parseCard8(),o=0;o<s;o+=1)n[l=i.parseCard8()]=o;else{if(1!==e)throw new Error("Unknown encoding format "+e);for(var a=i.parseCard8(),l=1,c=0;c<a;c+=1)for(var u=i.parseCard8(),h=i.parseCard8(),d=u;d<=u+h;d+=1)n[d]=l,l+=1}return new de(n,r)}(e,t+i.encoding,n),r.encoding=r.encoding||r.cffEncoding,r.glyphs=new ve.GlyphSet(r);for(var l=0;l<r.nGlyphs;l+=1){var c=a.objects[l];r.glyphs.push(l,ve.cffGlyphLoader(r,l,Le,c))}},make:function(e,t){for(var r,n=new J.Table("CFF ",[{name:"header",type:"RECORD"},{name:"nameIndex",type:"RECORD"},{name:"topDictIndex",type:"RECORD"},{name:"stringIndex",type:"RECORD"},{name:"globalSubrIndex",type:"RECORD"},{name:"charsets",type:"RECORD"},{name:"charStringsIndex",type:"RECORD"},{name:"privateDict",type:"RECORD"}]),i=1/t.unitsPerEm,s=(i={version:t.version,fullName:t.fullName,familyName:t.familyName,weight:t.weightName,fontBBox:t.fontBBox||[0,0,0,0],fontMatrix:[i,0,0,i,0,0],charset:999,encoding:0,charStrings:999,private:[0,999]},[]),o=1;o<e.length;o+=1)r=e.get(o),s.push(r.name);var a,l,c=[],u=(t=(n.header=new J.Record("Header",[{name:"major",type:"Card8",value:1},{name:"minor",type:"Card8",value:0},{name:"hdrSize",type:"Card8",value:4},{name:"major",type:"Card8",value:1}]),n.nameIndex=function(e){var t=new J.Record("Name INDEX",[{name:"names",type:"INDEX",value:[]}]);t.names=[];for(var r=0;r<e.length;r+=1)t.names.push({name:"name_"+r,type:"NAME",value:e[r]});return t}([t.postScriptName]),je(i,c)),n.topDictIndex=Ie(t),n.globalSubrIndex=new J.Record("Global Subr INDEX",[{name:"subrs",type:"INDEX",value:[]}]),n.charsets=function(e,t){for(var r=new J.Record("Charsets",[{name:"format",type:"Card8",value:0}]),n=0;n<e.length;n+=1){var i=Re(e[n],t);r.fields.push({name:"glyph_"+n,type:"SID",value:i})}return r}(s,c),n.charStringsIndex=function(e){for(var t=new J.Record("CharStrings INDEX",[{name:"charStrings",type:"INDEX",value:[]}]),r=0;r<e.length;r+=1){var n=e.get(r),i=function(e){for(var t=[],r=e.path,n=(t.push({name:"width",type:"NUMBER",value:e.advanceWidth}),0),i=0,s=0;s<r.commands.length;s+=1){var o,a,l,c,u=void 0,h=void 0,d=r.commands[s];"M"===(d="Q"===d.type?{type:"C",x:d.x,y:d.y,x1:1/3*n+2/3*d.x1,y1:1/3*i+2/3*d.y1,x2:1/3*d.x+2/3*d.x1,y2:1/3*d.y+2/3*d.y1}:d).type?(u=Math.round(d.x-n),h=Math.round(d.y-i),t.push({name:"dx",type:"NUMBER",value:u}),t.push({name:"dy",type:"NUMBER",value:h}),t.push({name:"rmoveto",type:"OP",value:21}),n=Math.round(d.x),i=Math.round(d.y)):"L"===d.type?(u=Math.round(d.x-n),h=Math.round(d.y-i),t.push({name:"dx",type:"NUMBER",value:u}),t.push({name:"dy",type:"NUMBER",value:h}),t.push({name:"rlineto",type:"OP",value:5}),n=Math.round(d.x),i=Math.round(d.y)):"C"===d.type&&(o=Math.round(d.x1-n),a=Math.round(d.y1-i),l=Math.round(d.x2-d.x1),c=Math.round(d.y2-d.y1),u=Math.round(d.x-d.x2),h=Math.round(d.y-d.y2),t.push({name:"dx1",type:"NUMBER",value:o}),t.push({name:"dy1",type:"NUMBER",value:a}),t.push({name:"dx2",type:"NUMBER",value:l}),t.push({name:"dy2",type:"NUMBER",value:c}),t.push({name:"dx",type:"NUMBER",value:u}),t.push({name:"dy",type:"NUMBER",value:h}),t.push({name:"rrcurveto",type:"OP",value:8}),n=Math.round(d.x),i=Math.round(d.y))}return t.push({name:"endchar",type:"OP",value:14}),t}(n);t.charStrings.push({name:n.name,type:"CHARSTRING",value:i})}return t}(e),n.privateDict=(u={},a=c,(l=new J.Record("Private DICT",[{name:"dict",type:"DICT",value:{}}])).dict=Pe(Ee,u,a),l),n.stringIndex=function(e){var t=new J.Record("String INDEX",[{name:"strings",type:"INDEX",value:[]}]);t.strings=[];for(var r=0;r<e.length;r+=1)t.strings.push({name:"string_"+r,type:"STRING",value:e[r]});return t}(c),n.header.sizeOf()+n.nameIndex.sizeOf()+n.topDictIndex.sizeOf()+n.stringIndex.sizeOf()+n.globalSubrIndex.sizeOf());return i.charset=u,i.encoding=0,i.charStrings=i.charset+n.charsets.sizeOf(),i.private[1]=i.charStrings+n.charStringsIndex.sizeOf(),t=je(i,c),n.topDictIndex=Ie(t),n}},Oe={parse:function(e,t){var r={};e=new ie.Parser(e,t);return r.version=e.parseVersion(),r.fontRevision=Math.round(1e3*e.parseFixed())/1e3,r.checkSumAdjustment=e.parseULong(),r.magicNumber=e.parseULong(),j.argument(1594834165===r.magicNumber,"Font header has wrong magic number."),r.flags=e.parseUShort(),r.unitsPerEm=e.parseUShort(),r.created=e.parseLongDateTime(),r.modified=e.parseLongDateTime(),r.xMin=e.parseShort(),r.yMin=e.parseShort(),r.xMax=e.parseShort(),r.yMax=e.parseShort(),r.macStyle=e.parseUShort(),r.lowestRecPPEM=e.parseUShort(),r.fontDirectionHint=e.parseShort(),r.indexToLocFormat=e.parseShort(),r.glyphDataFormat=e.parseShort(),r},make:function(e){var t=Math.round((new Date).getTime()/1e3)+2082844800,r=t;return e.createdTimestamp&&(r=e.createdTimestamp+2082844800),new J.Table("head",[{name:"version",type:"FIXED",value:65536},{name:"fontRevision",type:"FIXED",value:65536},{name:"checkSumAdjustment",type:"ULONG",value:0},{name:"magicNumber",type:"ULONG",value:1594834165},{name:"flags",type:"USHORT",value:0},{name:"unitsPerEm",type:"USHORT",value:1e3},{name:"created",type:"LONGDATETIME",value:r},{name:"modified",type:"LONGDATETIME",value:t},{name:"xMin",type:"SHORT",value:0},{name:"yMin",type:"SHORT",value:0},{name:"xMax",type:"SHORT",value:0},{name:"yMax",type:"SHORT",value:0},{name:"macStyle",type:"USHORT",value:0},{name:"lowestRecPPEM",type:"USHORT",value:0},{name:"fontDirectionHint",type:"SHORT",value:2},{name:"indexToLocFormat",type:"SHORT",value:0},{name:"glyphDataFormat",type:"SHORT",value:0}],e)}},Ne={parse:function(e,t){var r={};e=new ie.Parser(e,t);return r.version=e.parseVersion(),r.ascender=e.parseShort(),r.descender=e.parseShort(),r.lineGap=e.parseShort(),r.advanceWidthMax=e.parseUShort(),r.minLeftSideBearing=e.parseShort(),r.minRightSideBearing=e.parseShort(),r.xMaxExtent=e.parseShort(),r.caretSlopeRise=e.parseShort(),r.caretSlopeRun=e.parseShort(),r.caretOffset=e.parseShort(),e.relativeOffset+=8,r.metricDataFormat=e.parseShort(),r.numberOfHMetrics=e.parseUShort(),r},make:function(e){return new J.Table("hhea",[{name:"version",type:"FIXED",value:65536},{name:"ascender",type:"FWORD",value:0},{name:"descender",type:"FWORD",value:0},{name:"lineGap",type:"FWORD",value:0},{name:"advanceWidthMax",type:"UFWORD",value:0},{name:"minLeftSideBearing",type:"FWORD",value:0},{name:"minRightSideBearing",type:"FWORD",value:0},{name:"xMaxExtent",type:"FWORD",value:0},{name:"caretSlopeRise",type:"SHORT",value:1},{name:"caretSlopeRun",type:"SHORT",value:0},{name:"caretOffset",type:"SHORT",value:0},{name:"reserved1",type:"SHORT",value:0},{name:"reserved2",type:"SHORT",value:0},{name:"reserved3",type:"SHORT",value:0},{name:"reserved4",type:"SHORT",value:0},{name:"metricDataFormat",type:"SHORT",value:0},{name:"numberOfHMetrics",type:"USHORT",value:0}],e)}},Ue={parse:function(e,t,r,n,i){for(var s,o,a=new ie.Parser(e,t),l=0;l<n;l+=1){l<r&&(s=a.parseUShort(),o=a.parseShort());var c=i.get(l);c.advanceWidth=s,c.leftSideBearing=o}},make:function(e){for(var t=new J.Table("hmtx",[]),r=0;r<e.length;r+=1){var n=(i=e.get(r)).advanceWidth||0,i=i.leftSideBearing||0;t.fields.push({name:"advanceWidth_"+r,type:"USHORT",value:n}),t.fields.push({name:"leftSideBearing_"+r,type:"SHORT",value:i})}return t}},ke={make:function(e){for(var t=new J.Table("ltag",[{name:"version",type:"ULONG",value:1},{name:"flags",type:"ULONG",value:0},{name:"numTags",type:"ULONG",value:e.length}]),r="",n=12+4*e.length,i=0;i<e.length;++i){var s=r.indexOf(e[i]);s<0&&(s=r.length,r+=e[i]),t.fields.push({name:"offset "+i,type:"USHORT",value:n+s}),t.fields.push({name:"length "+i,type:"USHORT",value:e[i].length})}return t.fields.push({name:"stringPool",type:"CHARARRAY",value:r}),t},parse:function(e,t){for(var r=new ie.Parser(e,t),n=r.parseULong(),i=(j.argument(1===n,"Unsupported ltag table version."),r.skip("uLong",1),r.parseULong()),s=[],o=0;o<i;o++){for(var a="",l=t+r.parseUShort(),c=r.parseUShort(),u=l;u<l+c;++u)a+=String.fromCharCode(e.getInt8(u));s.push(a)}return s}},Fe={parse:function(e,t){var r={};e=new ie.Parser(e,t);return r.version=e.parseVersion(),r.numGlyphs=e.parseUShort(),1===r.version&&(r.maxPoints=e.parseUShort(),r.maxContours=e.parseUShort(),r.maxCompositePoints=e.parseUShort(),r.maxCompositeContours=e.parseUShort(),r.maxZones=e.parseUShort(),r.maxTwilightPoints=e.parseUShort(),r.maxStorage=e.parseUShort(),r.maxFunctionDefs=e.parseUShort(),r.maxInstructionDefs=e.parseUShort(),r.maxStackElements=e.parseUShort(),r.maxSizeOfInstructions=e.parseUShort(),r.maxComponentElements=e.parseUShort(),r.maxComponentDepth=e.parseUShort()),r},make:function(e){return new J.Table("maxp",[{name:"version",type:"FIXED",value:20480},{name:"numGlyphs",type:"USHORT",value:e}])}},Be=["copyright","fontFamily","fontSubfamily","uniqueID","fullName","version","postScriptName","trademark","manufacturer","designer","description","manufacturerURL","designerURL","license","licenseURL","reserved","preferredFamily","preferredSubfamily","compatibleFullName","sampleText","postScriptFindFontName","wwsFamily","wwsSubfamily"],ze={0:"en",1:"fr",2:"de",3:"it",4:"nl",5:"sv",6:"es",7:"da",8:"pt",9:"no",10:"he",11:"ja",12:"ar",13:"fi",14:"el",15:"is",16:"mt",17:"tr",18:"hr",19:"zh-Hant",20:"ur",21:"hi",22:"th",23:"ko",24:"lt",25:"pl",26:"hu",27:"es",28:"lv",29:"se",30:"fo",31:"fa",32:"ru",33:"zh",34:"nl-BE",35:"ga",36:"sq",37:"ro",38:"cz",39:"sk",40:"si",41:"yi",42:"sr",43:"mk",44:"bg",45:"uk",46:"be",47:"uz",48:"kk",49:"az-Cyrl",50:"az-Arab",51:"hy",52:"ka",53:"mo",54:"ky",55:"tg",56:"tk",57:"mn-CN",58:"mn",59:"ps",60:"ks",61:"ku",62:"sd",63:"bo",64:"ne",65:"sa",66:"mr",67:"bn",68:"as",69:"gu",70:"pa",71:"or",72:"ml",73:"kn",74:"ta",75:"te",76:"si",77:"my",78:"km",79:"lo",80:"vi",81:"id",82:"tl",83:"ms",84:"ms-Arab",85:"am",86:"ti",87:"om",88:"so",89:"sw",90:"rw",91:"rn",92:"ny",93:"mg",94:"eo",128:"cy",129:"eu",130:"ca",131:"la",132:"qu",133:"gn",134:"ay",135:"tt",136:"ug",137:"dz",138:"jv",139:"su",140:"gl",141:"af",142:"br",143:"iu",144:"gd",145:"gv",146:"ga",147:"to",148:"el-polyton",149:"kl",150:"az",151:"nn"},Ge={0:0,1:0,2:0,3:0,4:0,5:0,6:0,7:0,8:0,9:0,10:5,11:1,12:4,13:0,14:6,15:0,16:0,17:0,18:0,19:2,20:4,21:9,22:21,23:3,24:29,25:29,26:29,27:29,28:29,29:0,30:0,31:4,32:7,33:25,34:0,35:0,36:0,37:0,38:29,39:29,40:0,41:5,42:7,43:7,44:7,45:7,46:7,47:7,48:7,49:7,50:4,51:24,52:23,53:7,54:7,55:7,56:7,57:27,58:7,59:4,60:4,61:4,62:4,63:26,64:9,65:9,66:9,67:13,68:13,69:11,70:10,71:12,72:17,73:16,74:14,75:15,76:18,77:19,78:20,79:22,80:30,81:0,82:0,83:0,84:4,85:28,86:28,87:28,88:0,89:0,90:0,91:0,92:0,93:0,94:0,128:0,129:0,130:0,131:0,132:0,133:0,134:0,135:7,136:4,137:26,138:0,139:0,140:0,141:0,142:0,143:28,144:0,145:0,146:0,147:0,148:6,149:0,150:0,151:0},Ve={1078:"af",1052:"sq",1156:"gsw",1118:"am",5121:"ar-DZ",15361:"ar-BH",3073:"ar",2049:"ar-IQ",11265:"ar-JO",13313:"ar-KW",12289:"ar-LB",4097:"ar-LY",6145:"ary",8193:"ar-OM",16385:"ar-QA",1025:"ar-SA",10241:"ar-SY",7169:"aeb",14337:"ar-AE",9217:"ar-YE",1067:"hy",1101:"as",2092:"az-Cyrl",1068:"az",1133:"ba",1069:"eu",1059:"be",2117:"bn",1093:"bn-IN",8218:"bs-Cyrl",5146:"bs",1150:"br",1026:"bg",1027:"ca",3076:"zh-HK",5124:"zh-MO",2052:"zh",4100:"zh-SG",1028:"zh-TW",1155:"co",1050:"hr",4122:"hr-BA",1029:"cs",1030:"da",1164:"prs",1125:"dv",2067:"nl-BE",1043:"nl",3081:"en-AU",10249:"en-BZ",4105:"en-CA",9225:"en-029",16393:"en-IN",6153:"en-IE",8201:"en-JM",17417:"en-MY",5129:"en-NZ",13321:"en-PH",18441:"en-SG",7177:"en-ZA",11273:"en-TT",2057:"en-GB",1033:"en",12297:"en-ZW",1061:"et",1080:"fo",1124:"fil",1035:"fi",2060:"fr-BE",3084:"fr-CA",1036:"fr",5132:"fr-LU",6156:"fr-MC",4108:"fr-CH",1122:"fy",1110:"gl",1079:"ka",3079:"de-AT",1031:"de",5127:"de-LI",4103:"de-LU",2055:"de-CH",1032:"el",1135:"kl",1095:"gu",1128:"ha",1037:"he",1081:"hi",1038:"hu",1039:"is",1136:"ig",1057:"id",1117:"iu",2141:"iu-Latn",2108:"ga",1076:"xh",1077:"zu",1040:"it",2064:"it-CH",1041:"ja",1099:"kn",1087:"kk",1107:"km",1158:"quc",1159:"rw",1089:"sw",1111:"kok",1042:"ko",1088:"ky",1108:"lo",1062:"lv",1063:"lt",2094:"dsb",1134:"lb",1071:"mk",2110:"ms-BN",1086:"ms",1100:"ml",1082:"mt",1153:"mi",1146:"arn",1102:"mr",1148:"moh",1104:"mn",2128:"mn-CN",1121:"ne",1044:"nb",2068:"nn",1154:"oc",1096:"or",1123:"ps",1045:"pl",1046:"pt",2070:"pt-PT",1094:"pa",1131:"qu-BO",2155:"qu-EC",3179:"qu",1048:"ro",1047:"rm",1049:"ru",9275:"smn",4155:"smj-NO",5179:"smj",3131:"se-FI",1083:"se",2107:"se-SE",8251:"sms",6203:"sma-NO",7227:"sms",1103:"sa",7194:"sr-Cyrl-BA",3098:"sr",6170:"sr-Latn-BA",2074:"sr-Latn",1132:"nso",1074:"tn",1115:"si",1051:"sk",1060:"sl",11274:"es-AR",16394:"es-BO",13322:"es-CL",9226:"es-CO",5130:"es-CR",7178:"es-DO",12298:"es-EC",17418:"es-SV",4106:"es-GT",18442:"es-HN",2058:"es-MX",19466:"es-NI",6154:"es-PA",15370:"es-PY",10250:"es-PE",20490:"es-PR",3082:"es",1034:"es",21514:"es-US",14346:"es-UY",8202:"es-VE",2077:"sv-FI",1053:"sv",1114:"syr",1064:"tg",2143:"tzm",1097:"ta",1092:"tt",1098:"te",1054:"th",1105:"bo",1055:"tr",1090:"tk",1152:"ug",1058:"uk",1070:"hsb",1056:"ur",2115:"uz-Cyrl",1091:"uz",1066:"vi",1106:"cy",1160:"wo",1157:"sah",1144:"ii",1130:"yo"},He="utf-16",We={0:"macintosh",1:"x-mac-japanese",2:"x-mac-chinesetrad",3:"x-mac-korean",6:"x-mac-greek",7:"x-mac-cyrillic",9:"x-mac-devanagai",10:"x-mac-gurmukhi",11:"x-mac-gujarati",12:"x-mac-oriya",13:"x-mac-bengali",14:"x-mac-tamil",15:"x-mac-telugu",16:"x-mac-kannada",17:"x-mac-malayalam",18:"x-mac-sinhalese",19:"x-mac-burmese",20:"x-mac-khmer",21:"x-mac-thai",22:"x-mac-lao",23:"x-mac-georgian",24:"x-mac-armenian",25:"x-mac-chinesesimp",26:"x-mac-tibetan",27:"x-mac-mongolian",28:"x-mac-ethiopic",29:"x-mac-ce",30:"x-mac-vietnamese",31:"x-mac-extarabic"},Xe={15:"x-mac-icelandic",17:"x-mac-turkish",18:"x-mac-croatian",24:"x-mac-ce",25:"x-mac-ce",26:"x-mac-ce",27:"x-mac-ce",28:"x-mac-ce",30:"x-mac-icelandic",37:"x-mac-romanian",38:"x-mac-ce",39:"x-mac-ce",40:"x-mac-ce",143:"x-mac-inuit",146:"x-mac-gaelic"};function qe(e,t,r){switch(e){case 0:return He;case 1:return Xe[r]||We[t];case 3:if(1===t||10===t)return He}}function Ye(e){var t,r={};for(t in e)r[e[t]]=parseInt(t);return r}function Ze(e,t,r,n,i,s){return new J.Record("NameRecord",[{name:"platformID",type:"USHORT",value:e},{name:"encodingID",type:"USHORT",value:t},{name:"languageID",type:"USHORT",value:r},{name:"nameID",type:"USHORT",value:n},{name:"length",type:"USHORT",value:i},{name:"offset",type:"USHORT",value:s}])}function Je(e,t){if((r=function(e,t){var r=e.length,n=t.length-r+1;e:for(var i=0;i<n;i++)for(;i<n;i++){for(var s=0;s<r;s++)if(t[i+s]!==e[s])continue e;return i}return-1}(e,t))<0)for(var r=t.length,n=0,i=e.length;n<i;++n)t.push(e[n]);return r}var Ke={parse:function(e,t,r){for(var n={},i=new ie.Parser(e,t),s=(t=i.parseUShort(),i.parseUShort()),o=i.offset+i.parseUShort(),a=0;a<s;a++){var l=i.parseUShort(),c=i.parseUShort(),u=i.parseUShort(),h=i.parseUShort(),d=(h=Be[h]||h,i.parseUShort()),p=i.parseUShort(),f=function(e,t,r){switch(e){case 0:if(65535===t)return"und";if(r)return r[t];break;case 1:return ze[t];case 3:return Ve[t]}}(l,u,r);void 0!==(l=qe(l,c,u))&&void 0!==f&&(c=void 0,(c=l===He?I.UTF16(e,o+p,d):I.MACSTRING(e,o+p,d,l))&&((u=void 0===(u=n[h])?n[h]={}:u)[f]=c))}return 1===t&&i.parseUShort(),n},make:function(e,t){var r,n=[],i={},s=Ye(Be);for(r in e){var o=s[r];if(void 0===o&&(o=r),d=parseInt(o),isNaN(d))throw new Error('Name table entry "'+r+'" does not exist, see nameTableNames for complete list.');i[d]=e[r],n.push(d)}for(var a=Ye(ze),l=Ye(Ve),c=[],u=[],h=0;h<n.length;h++){var d,p,f=i[d=n[h]];for(p in f){var m=f[p],g=1,y=a[p],v=Ge[y],_=qe(g,v,y),x=(void 0===(_=D.MACSTRING(m,_))&&(g=0,(y=t.indexOf(p))<0&&(y=t.length,t.push(p)),v=4,_=D.UTF16(m)),Je(_,u));void 0!==(g=(c.push(Ze(g,v,y,d,_.length,x)),l[p]))&&(y=Je(v=D.UTF16(m),u),c.push(Ze(3,1,g,d,v.length,y)))}}c.sort((function(e,t){return e.platformID-t.platformID||e.encodingID-t.encodingID||e.languageID-t.languageID||e.nameID-t.nameID}));for(var b=new J.Table("name",[{name:"format",type:"USHORT",value:0},{name:"count",type:"USHORT",value:c.length},{name:"stringOffset",type:"USHORT",value:6+12*c.length}]),w=0;w<c.length;w++)b.fields.push({name:"record_"+w,type:"RECORD",value:c[w]});return b.fields.push({name:"strings",type:"LITERAL",value:u}),b}},Qe=[{begin:0,end:127},{begin:128,end:255},{begin:256,end:383},{begin:384,end:591},{begin:592,end:687},{begin:688,end:767},{begin:768,end:879},{begin:880,end:1023},{begin:11392,end:11519},{begin:1024,end:1279},{begin:1328,end:1423},{begin:1424,end:1535},{begin:42240,end:42559},{begin:1536,end:1791},{begin:1984,end:2047},{begin:2304,end:2431},{begin:2432,end:2559},{begin:2560,end:2687},{begin:2688,end:2815},{begin:2816,end:2943},{begin:2944,end:3071},{begin:3072,end:3199},{begin:3200,end:3327},{begin:3328,end:3455},{begin:3584,end:3711},{begin:3712,end:3839},{begin:4256,end:4351},{begin:6912,end:7039},{begin:4352,end:4607},{begin:7680,end:7935},{begin:7936,end:8191},{begin:8192,end:8303},{begin:8304,end:8351},{begin:8352,end:8399},{begin:8400,end:8447},{begin:8448,end:8527},{begin:8528,end:8591},{begin:8592,end:8703},{begin:8704,end:8959},{begin:8960,end:9215},{begin:9216,end:9279},{begin:9280,end:9311},{begin:9312,end:9471},{begin:9472,end:9599},{begin:9600,end:9631},{begin:9632,end:9727},{begin:9728,end:9983},{begin:9984,end:10175},{begin:12288,end:12351},{begin:12352,end:12447},{begin:12448,end:12543},{begin:12544,end:12591},{begin:12592,end:12687},{begin:43072,end:43135},{begin:12800,end:13055},{begin:13056,end:13311},{begin:44032,end:55215},{begin:55296,end:57343},{begin:67840,end:67871},{begin:19968,end:40959},{begin:57344,end:63743},{begin:12736,end:12783},{begin:64256,end:64335},{begin:64336,end:65023},{begin:65056,end:65071},{begin:65040,end:65055},{begin:65104,end:65135},{begin:65136,end:65279},{begin:65280,end:65519},{begin:65520,end:65535},{begin:3840,end:4095},{begin:1792,end:1871},{begin:1920,end:1983},{begin:3456,end:3583},{begin:4096,end:4255},{begin:4608,end:4991},{begin:5024,end:5119},{begin:5120,end:5759},{begin:5760,end:5791},{begin:5792,end:5887},{begin:6016,end:6143},{begin:6144,end:6319},{begin:10240,end:10495},{begin:40960,end:42127},{begin:5888,end:5919},{begin:66304,end:66351},{begin:66352,end:66383},{begin:66560,end:66639},{begin:118784,end:119039},{begin:119808,end:120831},{begin:1044480,end:1048573},{begin:65024,end:65039},{begin:917504,end:917631},{begin:6400,end:6479},{begin:6480,end:6527},{begin:6528,end:6623},{begin:6656,end:6687},{begin:11264,end:11359},{begin:11568,end:11647},{begin:19904,end:19967},{begin:43008,end:43055},{begin:65536,end:65663},{begin:65856,end:65935},{begin:66432,end:66463},{begin:66464,end:66527},{begin:66640,end:66687},{begin:66688,end:66735},{begin:67584,end:67647},{begin:68096,end:68191},{begin:119552,end:119647},{begin:73728,end:74751},{begin:119648,end:119679},{begin:7040,end:7103},{begin:7168,end:7247},{begin:7248,end:7295},{begin:43136,end:43231},{begin:43264,end:43311},{begin:43312,end:43359},{begin:43520,end:43615},{begin:65936,end:65999},{begin:66e3,end:66047},{begin:66208,end:66271},{begin:127024,end:127135}],$e={parse:function(e,t){var r={},n=new ie.Parser(e,t);r.version=n.parseUShort(),r.xAvgCharWidth=n.parseShort(),r.usWeightClass=n.parseUShort(),r.usWidthClass=n.parseUShort(),r.fsType=n.parseUShort(),r.ySubscriptXSize=n.parseShort(),r.ySubscriptYSize=n.parseShort(),r.ySubscriptXOffset=n.parseShort(),r.ySubscriptYOffset=n.parseShort(),r.ySuperscriptXSize=n.parseShort(),r.ySuperscriptYSize=n.parseShort(),r.ySuperscriptXOffset=n.parseShort(),r.ySuperscriptYOffset=n.parseShort(),r.yStrikeoutSize=n.parseShort(),r.yStrikeoutPosition=n.parseShort(),r.sFamilyClass=n.parseShort(),r.panose=[];for(var i=0;i<10;i++)r.panose[i]=n.parseByte();return r.ulUnicodeRange1=n.parseULong(),r.ulUnicodeRange2=n.parseULong(),r.ulUnicodeRange3=n.parseULong(),r.ulUnicodeRange4=n.parseULong(),r.achVendID=String.fromCharCode(n.parseByte(),n.parseByte(),n.parseByte(),n.parseByte()),r.fsSelection=n.parseUShort(),r.usFirstCharIndex=n.parseUShort(),r.usLastCharIndex=n.parseUShort(),r.sTypoAscender=n.parseShort(),r.sTypoDescender=n.parseShort(),r.sTypoLineGap=n.parseShort(),r.usWinAscent=n.parseUShort(),r.usWinDescent=n.parseUShort(),1<=r.version&&(r.ulCodePageRange1=n.parseULong(),r.ulCodePageRange2=n.parseULong()),2<=r.version&&(r.sxHeight=n.parseShort(),r.sCapHeight=n.parseShort(),r.usDefaultChar=n.parseUShort(),r.usBreakChar=n.parseUShort(),r.usMaxContent=n.parseUShort()),r},make:function(e){return new J.Table("OS/2",[{name:"version",type:"USHORT",value:3},{name:"xAvgCharWidth",type:"SHORT",value:0},{name:"usWeightClass",type:"USHORT",value:0},{name:"usWidthClass",type:"USHORT",value:0},{name:"fsType",type:"USHORT",value:0},{name:"ySubscriptXSize",type:"SHORT",value:650},{name:"ySubscriptYSize",type:"SHORT",value:699},{name:"ySubscriptXOffset",type:"SHORT",value:0},{name:"ySubscriptYOffset",type:"SHORT",value:140},{name:"ySuperscriptXSize",type:"SHORT",value:650},{name:"ySuperscriptYSize",type:"SHORT",value:699},{name:"ySuperscriptXOffset",type:"SHORT",value:0},{name:"ySuperscriptYOffset",type:"SHORT",value:479},{name:"yStrikeoutSize",type:"SHORT",value:49},{name:"yStrikeoutPosition",type:"SHORT",value:258},{name:"sFamilyClass",type:"SHORT",value:0},{name:"bFamilyType",type:"BYTE",value:0},{name:"bSerifStyle",type:"BYTE",value:0},{name:"bWeight",type:"BYTE",value:0},{name:"bProportion",type:"BYTE",value:0},{name:"bContrast",type:"BYTE",value:0},{name:"bStrokeVariation",type:"BYTE",value:0},{name:"bArmStyle",type:"BYTE",value:0},{name:"bLetterform",type:"BYTE",value:0},{name:"bMidline",type:"BYTE",value:0},{name:"bXHeight",type:"BYTE",value:0},{name:"ulUnicodeRange1",type:"ULONG",value:0},{name:"ulUnicodeRange2",type:"ULONG",value:0},{name:"ulUnicodeRange3",type:"ULONG",value:0},{name:"ulUnicodeRange4",type:"ULONG",value:0},{name:"achVendID",type:"CHARARRAY",value:"XXXX"},{name:"fsSelection",type:"USHORT",value:0},{name:"usFirstCharIndex",type:"USHORT",value:0},{name:"usLastCharIndex",type:"USHORT",value:0},{name:"sTypoAscender",type:"SHORT",value:0},{name:"sTypoDescender",type:"SHORT",value:0},{name:"sTypoLineGap",type:"SHORT",value:0},{name:"usWinAscent",type:"USHORT",value:0},{name:"usWinDescent",type:"USHORT",value:0},{name:"ulCodePageRange1",type:"ULONG",value:0},{name:"ulCodePageRange2",type:"ULONG",value:0},{name:"sxHeight",type:"SHORT",value:0},{name:"sCapHeight",type:"SHORT",value:0},{name:"usDefaultChar",type:"USHORT",value:0},{name:"usBreakChar",type:"USHORT",value:0},{name:"usMaxContext",type:"USHORT",value:0}],e)},unicodeRanges:Qe,getUnicodeRange:function(e){for(var t=0;t<Qe.length;t+=1){var r=Qe[t];if(e>=r.begin&&e<r.end)return t}return-1}},et={parse:function(e,t){var r={},n=new ie.Parser(e,t);switch(r.version=n.parseVersion(),r.italicAngle=n.parseFixed(),r.underlinePosition=n.parseShort(),r.underlineThickness=n.parseShort(),r.isFixedPitch=n.parseULong(),r.minMemType42=n.parseULong(),r.maxMemType42=n.parseULong(),r.minMemType1=n.parseULong(),r.maxMemType1=n.parseULong(),r.version){case 1:r.names=ce.slice();break;case 2:r.numberOfGlyphs=n.parseUShort(),r.glyphNameIndex=new Array(r.numberOfGlyphs);for(var i=0;i<r.numberOfGlyphs;i++)r.glyphNameIndex[i]=n.parseUShort();r.names=[];for(var s,o=0;o<r.numberOfGlyphs;o++)r.glyphNameIndex[o]>=ce.length&&(s=n.parseChar(),r.names.push(n.parseString(s)));break;case 2.5:r.numberOfGlyphs=n.parseUShort(),r.offset=new Array(r.numberOfGlyphs);for(var a=0;a<r.numberOfGlyphs;a++)r.offset[a]=n.parseChar()}return r},make:function(){return new J.Table("post",[{name:"version",type:"FIXED",value:196608},{name:"italicAngle",type:"FIXED",value:0},{name:"underlinePosition",type:"FWORD",value:0},{name:"underlineThickness",type:"FWORD",value:0},{name:"isFixedPitch",type:"ULONG",value:0},{name:"minMemType42",type:"ULONG",value:0},{name:"maxMemType42",type:"ULONG",value:0},{name:"minMemType1",type:"ULONG",value:0},{name:"maxMemType1",type:"ULONG",value:0}])}},tt=new Array(9),rt=(tt[1]=function(){var e=this.offset+this.relativeOffset,t=this.parseUShort();return 1===t?{substFormat:1,coverage:this.parsePointer(re.coverage),deltaGlyphId:this.parseUShort()}:2===t?{substFormat:2,coverage:this.parsePointer(re.coverage),substitute:this.parseOffset16List()}:void j.assert(!1,"0x"+e.toString(16)+": lookup type 1 format must be 1 or 2.")},tt[2]=function(){var e=this.parseUShort();return j.argument(1===e,"GSUB Multiple Substitution Subtable identifier-format must be 1"),{substFormat:e,coverage:this.parsePointer(re.coverage),sequences:this.parseListOfLists()}},tt[3]=function(){var e=this.parseUShort();return j.argument(1===e,"GSUB Alternate Substitution Subtable identifier-format must be 1"),{substFormat:e,coverage:this.parsePointer(re.coverage),alternateSets:this.parseListOfLists()}},tt[4]=function(){var e=this.parseUShort();return j.argument(1===e,"GSUB ligature table identifier-format must be 1"),{substFormat:e,coverage:this.parsePointer(re.coverage),ligatureSets:this.parseListOfLists((function(){return{ligGlyph:this.parseUShort(),components:this.parseUShortList(this.parseUShort()-1)}}))}},{sequenceIndex:re.uShort,lookupListIndex:re.uShort});tt[5]=function(){var e,t,r=this.offset+this.relativeOffset,n=this.parseUShort();return 1===n?{substFormat:n,coverage:this.parsePointer(re.coverage),ruleSets:this.parseListOfLists((function(){var e=this.parseUShort(),t=this.parseUShort();return{input:this.parseUShortList(e-1),lookupRecords:this.parseRecordList(t,rt)}}))}:2===n?{substFormat:n,coverage:this.parsePointer(re.coverage),classDef:this.parsePointer(re.classDef),classSets:this.parseListOfLists((function(){var e=this.parseUShort(),t=this.parseUShort();return{classes:this.parseUShortList(e-1),lookupRecords:this.parseRecordList(t,rt)}}))}:3===n?(e=this.parseUShort(),t=this.parseUShort(),{substFormat:n,coverages:this.parseList(e,re.pointer(re.coverage)),lookupRecords:this.parseRecordList(t,rt)}):void j.assert(!1,"0x"+r.toString(16)+": lookup type 5 format must be 1, 2 or 3.")},tt[6]=function(){var e=this.offset+this.relativeOffset,t=this.parseUShort();return 1===t?{substFormat:1,coverage:this.parsePointer(re.coverage),chainRuleSets:this.parseListOfLists((function(){return{backtrack:this.parseUShortList(),input:this.parseUShortList(this.parseShort()-1),lookahead:this.parseUShortList(),lookupRecords:this.parseRecordList(rt)}}))}:2===t?{substFormat:2,coverage:this.parsePointer(re.coverage),backtrackClassDef:this.parsePointer(re.classDef),inputClassDef:this.parsePointer(re.classDef),lookaheadClassDef:this.parsePointer(re.classDef),chainClassSet:this.parseListOfLists((function(){return{backtrack:this.parseUShortList(),input:this.parseUShortList(this.parseShort()-1),lookahead:this.parseUShortList(),lookupRecords:this.parseRecordList(rt)}}))}:3===t?{substFormat:3,backtrackCoverage:this.parseList(re.pointer(re.coverage)),inputCoverage:this.parseList(re.pointer(re.coverage)),lookaheadCoverage:this.parseList(re.pointer(re.coverage)),lookupRecords:this.parseRecordList(rt)}:void j.assert(!1,"0x"+e.toString(16)+": lookup type 6 format must be 1, 2 or 3.")},tt[7]=function(){var e=this.parseUShort(),t=(e=(j.argument(1===e,"GSUB Extension Substitution subtable identifier-format must be 1"),this.parseUShort()),new re(this.data,this.offset+this.parseULong()));return{substFormat:1,lookupType:e,extension:tt[e].call(t)}},tt[8]=function(){var e=this.parseUShort();return j.argument(1===e,"GSUB Reverse Chaining Contextual Single Substitution Subtable identifier-format must be 1"),{substFormat:e,coverage:this.parsePointer(re.coverage),backtrackCoverage:this.parseList(re.pointer(re.coverage)),lookaheadCoverage:this.parseList(re.pointer(re.coverage)),substitutes:this.parseUShortList()}};var nt=new Array(9);nt[1]=function(e){return 1===e.substFormat?new J.Table("substitutionTable",[{name:"substFormat",type:"USHORT",value:1},{name:"coverage",type:"TABLE",value:new J.Coverage(e.coverage)},{name:"deltaGlyphID",type:"USHORT",value:e.deltaGlyphId}]):new J.Table("substitutionTable",[{name:"substFormat",type:"USHORT",value:2},{name:"coverage",type:"TABLE",value:new J.Coverage(e.coverage)}].concat(J.ushortList("substitute",e.substitute)))},nt[3]=function(e){return j.assert(1===e.substFormat,"Lookup type 3 substFormat must be 1."),new J.Table("substitutionTable",[{name:"substFormat",type:"USHORT",value:1},{name:"coverage",type:"TABLE",value:new J.Coverage(e.coverage)}].concat(J.tableList("altSet",e.alternateSets,(function(e){return new J.Table("alternateSetTable",J.ushortList("alternate",e))}))))},nt[4]=function(e){return j.assert(1===e.substFormat,"Lookup type 4 substFormat must be 1."),new J.Table("substitutionTable",[{name:"substFormat",type:"USHORT",value:1},{name:"coverage",type:"TABLE",value:new J.Coverage(e.coverage)}].concat(J.tableList("ligSet",e.ligatureSets,(function(e){return new J.Table("ligatureSetTable",J.tableList("ligature",e,(function(e){return new J.Table("ligatureTable",[{name:"ligGlyph",type:"USHORT",value:e.ligGlyph}].concat(J.ushortList("component",e.components,e.components.length+1)))})))}))))};var it={parse:function(e,t){return t=(e=new re(e,t=t||0)).parseVersion(1),j.argument(1===t||1.1===t,"Unsupported GSUB table version."),1===t?{version:t,scripts:e.parseScriptList(),features:e.parseFeatureList(),lookups:e.parseLookupList(tt)}:{version:t,scripts:e.parseScriptList(),features:e.parseFeatureList(),lookups:e.parseLookupList(tt),variations:e.parseFeatureVariationsList()}},make:function(e){return new J.Table("GSUB",[{name:"version",type:"ULONG",value:65536},{name:"scripts",type:"TABLE",value:new J.ScriptList(e.scripts)},{name:"features",type:"TABLE",value:new J.FeatureList(e.features)},{name:"lookups",type:"TABLE",value:new J.LookupList(e.lookups,nt)}])}},st={parse:function(e,t){for(var r=new ie.Parser(e,t),n=r.parseULong(),i=(j.argument(1===n,"Unsupported META table version."),r.parseULong(),r.parseULong(),r.parseULong()),s={},o=0;o<i;o++){var a=r.parseTag(),l=r.parseULong(),c=r.parseULong();l=I.UTF8(e,t+l,c);s[a]=l}return s},make:function(e){var t,r=Object.keys(e).length,n="",i=16+12*r,s=new J.Table("meta",[{name:"version",type:"ULONG",value:1},{name:"flags",type:"ULONG",value:0},{name:"offset",type:"ULONG",value:i},{name:"numTags",type:"ULONG",value:r}]);for(t in e){var o=n.length;n+=e[t],s.fields.push({name:"tag "+t,type:"TAG",value:t}),s.fields.push({name:"offset "+t,type:"ULONG",value:i+o}),s.fields.push({name:"length "+t,type:"ULONG",value:e[t].length})}return s.fields.push({name:"stringPool",type:"CHARARRAY",value:n}),s}};function ot(e){return Math.log(e)/Math.log(2)|0}function at(e){for(;e.length%4!=0;)e.push(0);for(var t=0,r=0;r<e.length;r+=4)t+=(e[r]<<24)+(e[r+1]<<16)+(e[r+2]<<8)+e[r+3];return t%Math.pow(2,32)}function lt(e,t,r,n){return new J.Record("Table Record",[{name:"tag",type:"TAG",value:void 0!==e?e:""},{name:"checkSum",type:"ULONG",value:void 0!==t?t:0},{name:"offset",type:"ULONG",value:void 0!==r?r:0},{name:"length",type:"ULONG",value:void 0!==n?n:0}])}function ct(e){for(var t=new J.Table("sfnt",[{name:"version",type:"TAG",value:"OTTO"},{name:"numTables",type:"USHORT",value:0},{name:"searchRange",type:"USHORT",value:0},{name:"entrySelector",type:"USHORT",value:0},{name:"rangeShift",type:"USHORT",value:0}]),r=(t.tables=e,t.numTables=e.length,Math.pow(2,ot(t.numTables))),n=(t.searchRange=16*r,t.entrySelector=ot(r),t.rangeShift=16*t.numTables-t.searchRange,[]),i=[],s=t.sizeOf()+lt().sizeOf()*t.numTables;s%4!=0;)s+=1,i.push({name:"padding",type:"BYTE",value:0});for(var o=0;o<e.length;o+=1){var a=e[o],l=(j.argument(4===a.tableName.length,"Table name"+a.tableName+" is invalid."),a.sizeOf()),c=lt(a.tableName,at(a.encode()),s,l);for(n.push({name:c.tag+" Table Record",type:"RECORD",value:c}),i.push({name:a.tableName+" table",type:"RECORD",value:a}),s+=l,j.argument(!isNaN(s),"Something went wrong calculating the offset.");s%4!=0;)s+=1,i.push({name:"padding",type:"BYTE",value:0})}return n.sort((function(e,t){return e.value.tag>t.value.tag?1:-1})),t.fields=t.fields.concat(n),t.fields=t.fields.concat(i),t}function ut(e,t,r){for(var n=0;n<t.length;n+=1){var i=e.charToGlyphIndex(t[n]);if(0<i)return e.glyphs.get(i).getMetrics()}return r}var ht=function(e){for(var t,r=[],n=[],i=[],s=[],o=[],a=[],l=[],c=0,u=0,h=0,d=0,p=0,f=0;f<e.glyphs.length;f+=1){var m=e.glyphs.get(f),g=0|m.unicode;if(isNaN(m.advanceWidth))throw new Error("Glyph "+m.name+" ("+f+"): advanceWidth is not a number.");if((g<t||void 0===t)&&0<g&&(t=g),c<g&&(c=g),(g=$e.getUnicodeRange(g))<32)u|=1<<g;else if(g<64)h|=1<<g-32;else if(g<96)d|=1<<g-64;else{if(!(g<123))throw new Error("Unicode ranges bits > 123 are reserved for internal usage");p|=1<<g-96}".notdef"!==m.name&&(g=m.getMetrics(),r.push(g.xMin),n.push(g.yMin),i.push(g.xMax),s.push(g.yMax),a.push(g.leftSideBearing),l.push(g.rightSideBearing),o.push(m.advanceWidth))}var y,v={xMin:Math.min.apply(null,r),yMin:Math.min.apply(null,n),xMax:Math.max.apply(null,i),yMax:Math.max.apply(null,s),advanceWidthMax:Math.max.apply(null,o),advanceWidthAvg:function(e){for(var t=0,r=0;r<e.length;r+=1)t+=e[r];return t/e.length}(o),minLeftSideBearing:Math.min.apply(null,a),maxLeftSideBearing:Math.max.apply(null,a),minRightSideBearing:Math.min.apply(null,l)},_=(v.ascender=e.ascender,v.descender=e.descender,Oe.make({flags:3,unitsPerEm:e.unitsPerEm,xMin:v.xMin,yMin:v.yMin,xMax:v.xMax,yMax:v.yMax,lowestRecPPEM:3,createdTimestamp:e.createdTimestamp})),x=Ne.make({ascender:v.ascender,descender:v.descender,advanceWidthMax:v.advanceWidthMax,minLeftSideBearing:v.minLeftSideBearing,minRightSideBearing:v.minRightSideBearing,xMaxExtent:v.maxLeftSideBearing+(v.xMax-v.xMin),numberOfHMetrics:e.glyphs.length}),b=Fe.make(e.glyphs.length),w=$e.make({xAvgCharWidth:Math.round(v.advanceWidthAvg),usWeightClass:e.tables.os2.usWeightClass,usWidthClass:e.tables.os2.usWidthClass,usFirstCharIndex:t,usLastCharIndex:c,ulUnicodeRange1:u,ulUnicodeRange2:h,ulUnicodeRange3:d,ulUnicodeRange4:p,fsSelection:e.tables.os2.fsSelection,sTypoAscender:v.ascender,sTypoDescender:v.descender,sTypoLineGap:0,usWinAscent:v.yMax,usWinDescent:Math.abs(v.yMin),ulCodePageRange1:1,sxHeight:ut(e,"xyvw",{yMax:Math.round(v.ascender/2)}).yMax,sCapHeight:ut(e,"HIKLEFJMNTZBDPRAGOQSUVWXY",v).yMax,usDefaultChar:e.hasChar(" ")?32:0,usBreakChar:e.hasChar(" ")?32:0}),S=Ue.make(e.glyphs),M=se.make(e.glyphs),T=(P=e.getEnglishName("fontFamily"))+" "+(j=e.getEnglishName("fontSubfamily")),E=(E=e.getEnglishName("postScriptName"))||P.replace(/\s/g,"")+"-"+j,A={};for(y in e.names)A[y]=e.names[y];A.uniqueID||(A.uniqueID={en:e.getEnglishName("manufacturer")+":"+T}),A.postScriptName||(A.postScriptName={en:E}),A.preferredFamily||(A.preferredFamily=e.names.fontFamily),A.preferredSubfamily||(A.preferredSubfamily=e.names.fontSubfamily);var C=[],L=Ke.make(A,C),R=(C=0<C.length?ke.make(C):void 0,et.make()),P=(T=De.make(e.glyphs,{version:e.getEnglishName("version"),fullName:T,familyName:P,weightName:j,postScriptName:E,unitsPerEm:e.unitsPerEm,fontBBox:[0,v.yMin,v.ascender,v.advanceWidthMax]}),e.metas&&0<Object.keys(e.metas).length?st.make(e.metas):void 0),j=[_,x,b,w,L,M,R,T,S];C&&j.push(C),e.tables.gsub&&j.push(it.make(e.tables.gsub)),P&&j.push(P);for(var I=at((E=ct(j)).encode()),D=E.fields,O=!1,N=0;N<D.length;N+=1)if("head table"===D[N].name){D[N].value.checkSumAdjustment=2981146554-I,O=!0;break}if(O)return E;throw new Error("Could not find head table with checkSum to adjust.")};function dt(e,t){for(var r=0,n=e.length-1;r<=n;){var i=r+n>>>1,s=e[i].tag;if(s===t)return i;s<t?r=1+i:n=i-1}return-r-1}function pt(e,t){for(var r=0,n=e.length-1;r<=n;){var i=r+n>>>1,s=e[i];if(s===t)return i;s<t?r=1+i:n=i-1}return-r-1}function ft(e,t){for(var r=0,n=e.length-1;r<=n;){var i,s=r+n>>>1,o=(i=e[s]).start;if(o===t)return i;o<t?r=1+s:n=s-1}if(0<r)return t>(i=e[r-1]).end?0:i}function mt(e,t){this.font=e,this.tableName=t}function gt(e){mt.call(this,e,"gpos")}function yt(e){mt.call(this,e,"gsub")}function vt(e,t,r){for(var n=e.subtables,i=0;i<n.length;i++){var s=n[i];if(s.substFormat===t)return s}if(r)return n.push(r),r}function _t(e){for(var t=new ArrayBuffer(e.length),r=new Uint8Array(t),n=0;n<e.length;++n)r[n]=e[n];return t}function xt(e,t){if(!e)throw t}function bt(e,t,r,n,i){var s=0<(t&n)?(s=e.parseByte(),r+(s=0==(t&i)?-s:s)):0<(t&i)?r:r+e.parseShort();return s}function wt(e,t,r){var n,i=new ie.Parser(t,r);if(e.numberOfContours=i.parseShort(),e._xMin=i.parseShort(),e._yMin=i.parseShort(),e._xMax=i.parseShort(),e._yMax=i.parseShort(),0<e.numberOfContours){for(var s=e.endPointIndices=[],o=0;o<e.numberOfContours;o+=1)s.push(i.parseUShort());e.instructionLength=i.parseUShort(),e.instructions=[];for(var a=0;a<e.instructionLength;a+=1)e.instructions.push(i.parseByte());for(var l=s[s.length-1]+1,c=[],u=0;u<l;u+=1)if(n=i.parseByte(),c.push(n),0<(8&n))for(var h=i.parseByte(),d=0;d<h;d+=1)c.push(n),u+=1;if(j.argument(c.length===l,"Bad flags."),0<s.length){var p,f=[];if(0<l){for(var m=0;m<l;m+=1)n=c[m],(p={}).onCurve=!!(1&n),p.lastPointOfContour=0<=s.indexOf(m),f.push(p);for(var g=0,y=0;y<l;y+=1)n=c[y],(p=f[y]).x=bt(i,n,g,2,16),g=p.x;for(var v=0,_=0;_<l;_+=1)n=c[_],(p=f[_]).y=bt(i,n,v,4,32),v=p.y}e.points=f}else e.points=[]}else if(0===e.numberOfContours)e.points=[];else{e.isComposite=!0,e.points=[],e.components=[];for(var x=!0;x;){c=i.parseUShort();var b={glyphIndex:i.parseUShort(),xScale:1,scale01:0,scale10:0,yScale:1,dx:0,dy:0};0<(1&c)?0<(2&c)?(b.dx=i.parseShort(),b.dy=i.parseShort()):b.matchedPoints=[i.parseUShort(),i.parseUShort()]:0<(2&c)?(b.dx=i.parseChar(),b.dy=i.parseChar()):b.matchedPoints=[i.parseByte(),i.parseByte()],0<(8&c)?b.xScale=b.yScale=i.parseF2Dot14():0<(64&c)?(b.xScale=i.parseF2Dot14(),b.yScale=i.parseF2Dot14()):0<(128&c)&&(b.xScale=i.parseF2Dot14(),b.scale01=i.parseF2Dot14(),b.scale10=i.parseF2Dot14(),b.yScale=i.parseF2Dot14()),e.components.push(b),x=!!(32&c)}if(256&c){e.instructionLength=i.parseUShort(),e.instructions=[];for(var w=0;w<e.instructionLength;w+=1)e.instructions.push(i.parseByte())}}}function St(e,t){for(var r=[],n=0;n<e.length;n+=1){var i=e[n];i={x:t.xScale*i.x+t.scale01*i.y+t.dx,y:t.scale10*i.x+t.yScale*i.y+t.dy,onCurve:i.onCurve,lastPointOfContour:i.lastPointOfContour};r.push(i)}return r}function Mt(e){var t=new L;if(e)for(var r=function(e){for(var t=[],r=[],n=0;n<e.length;n+=1){var i=e[n];r.push(i),i.lastPointOfContour&&(t.push(r),r=[])}return j.argument(0===r.length,"There are still points left in the current contour."),t}(e),n=0;n<r.length;++n){var i,s=r[n],o=s[s.length-1],a=s[0];o.onCurve?t.moveTo(o.x,o.y):a.onCurve?t.moveTo(a.x,a.y):(i={x:.5*(o.x+a.x),y:.5*(o.y+a.y)},t.moveTo(i.x,i.y));for(var l=0;l<s.length;++l){var c,u=o;o=a,a=s[(l+1)%s.length];o.onCurve?t.lineTo(o.x,o.y):(c=a,u.onCurve||(o.x,u.x,o.y,u.y),a.onCurve||(c={x:.5*(o.x+a.x),y:.5*(o.y+a.y)}),t.quadraticCurveTo(o.x,o.y,c.x,c.y))}t.closePath()}return t}function Tt(e,t){if(t.isComposite)for(var r=0;r<t.components.length;r+=1){var n=t.components[r],i=e.get(n.glyphIndex);if(i.getPath(),i.points){var s=void 0;if(void 0===n.matchedPoints)s=St(i.points,n);else{if(n.matchedPoints[0]>t.points.length-1||n.matchedPoints[1]>i.points.length-1)throw Error("Matched points out of range in "+t.name);var o=t.points[n.matchedPoints[0]],a=St([a=i.points[n.matchedPoints[1]]],n={xScale:n.xScale,scale01:n.scale01,scale10:n.scale10,yScale:n.yScale,dx:0,dy:0})[0];n.dx=o.x-a.x,n.dy=o.y-a.y,s=St(i.points,n)}t.points=t.points.concat(s)}}return Mt(t.points)}(gt.prototype=mt.prototype={searchTag:dt,binSearch:pt,getTable:function(e){var t=this.font.tables[this.tableName];return!t&&e?this.font.tables[this.tableName]=this.createDefaultTable():t},getScriptNames:function(){var e=this.getTable();return e?e.scripts.map((function(e){return e.tag})):[]},getDefaultScriptName:function(){var e=this.getTable();if(e){for(var t=!1,r=0;r<e.scripts.length;r++){var n=e.scripts[r].tag;if("DFLT"===n)return n;"latn"===n&&(t=!0)}return t?"latn":void 0}},getScriptTable:function(e,t){var r,n=this.getTable(t);if(n)return r=n.scripts,0<=(n=dt(n.scripts,e=e||"DFLT"))?r[n].script:t?(r.splice(-1-n,0,t={tag:e,script:{defaultLangSys:{reserved:0,reqFeatureIndex:65535,featureIndexes:[]},langSysRecords:[]}}),t.script):void 0},getLangSysTable:function(e,t,r){var n;if(e=this.getScriptTable(e,r))return t&&"dflt"!==t&&"DFLT"!==t?0<=(n=dt(e.langSysRecords,t))?e.langSysRecords[n].langSys:r?(e.langSysRecords.splice(-1-n,0,r={tag:t,langSys:{reserved:0,reqFeatureIndex:65535,featureIndexes:[]}}),r.langSys):void 0:e.defaultLangSys},getFeatureTable:function(e,t,r,n){if(e=this.getLangSysTable(e,t,n)){for(var i,s=e.featureIndexes,o=this.font.tables[this.tableName].features,a=0;a<s.length;a++)if((i=o[s[a]]).tag===r)return i.feature;if(n)return t=o.length,j.assert(0===t||r>=o[t-1].tag,"Features must be added in alphabetical order."),o.push(i={tag:r,feature:{params:0,lookupListIndexes:[]}}),s.push(t),i.feature}},getLookupTables:function(e,t,r,n,i){var s=[];if(e=this.getFeatureTable(e,t,r,i)){for(var o,a=e.lookupListIndexes,l=this.font.tables[this.tableName].lookups,c=0;c<a.length;c++)(o=l[a[c]]).lookupType===n&&s.push(o);if(0===s.length&&i)return t=l.length,l.push(o={lookupType:n,lookupFlag:0,subtables:[],markFilteringSet:void 0}),a.push(t),[o]}return s},getGlyphClass:function(e,t){switch(e.format){case 1:return e.startGlyph<=t&&t<e.startGlyph+e.classes.length?e.classes[t-e.startGlyph]:0;case 2:var r=ft(e.ranges,t);return r?r.classId:0}},getCoverageIndex:function(e,t){switch(e.format){case 1:var r=pt(e.glyphs,t);return 0<=r?r:-1;case 2:return(r=ft(e.ranges,t))?r.index+t-r.start:-1}},expandCoverage:function(e){if(1===e.format)return e.glyphs;for(var t=[],r=e.ranges,n=0;n<r.length;n++)for(var i=r[n],s=i.start,o=i.end,a=s;a<=o;a++)t.push(a);return t}}).init=function(){var e=this.getDefaultScriptName();this.defaultKerningTables=this.getKerningTables(e)},gt.prototype.getKerningValue=function(e,t,r){for(var n=0;n<e.length;n++)for(var i=e[n].subtables,s=0;s<i.length;s++){var o=i[s],a=this.getCoverageIndex(o.coverage,t);if(!(a<0))switch(o.posFormat){case 1:for(var l=o.pairSets[a],c=0;c<l.length;c++){var u=l[c];if(u.secondGlyph===r)return u.value1&&u.value1.xAdvance||0}break;case 2:var h=this.getGlyphClass(o.classDef1,t),d=this.getGlyphClass(o.classDef2,r);return(h=o.classRecords[h][d]).value1&&h.value1.xAdvance||0}}return 0},gt.prototype.getKerningTables=function(e,t){if(this.font.tables.gpos)return this.getLookupTables(e,t,"kern",2)},(yt.prototype=mt.prototype).createDefaultTable=function(){return{version:1,scripts:[{tag:"DFLT",script:{defaultLangSys:{reserved:0,reqFeatureIndex:65535,featureIndexes:[]},langSysRecords:[]}}],features:[],lookups:[]}},yt.prototype.getSingle=function(e,t,r){for(var n=[],i=this.getLookupTables(t,r,e,1),s=0;s<i.length;s++)for(var o=i[s].subtables,a=0;a<o.length;a++){var l=o[a],c=this.expandCoverage(l.coverage),u=void 0;if(1===l.substFormat){var h=l.deltaGlyphId;for(u=0;u<c.length;u++){var d=c[u];n.push({sub:d,by:d+h})}}else{var p=l.substitute;for(u=0;u<c.length;u++)n.push({sub:c[u],by:p[u]})}}return n},yt.prototype.getAlternates=function(e,t,r){for(var n=[],i=this.getLookupTables(t,r,e,3),s=0;s<i.length;s++)for(var o=i[s].subtables,a=0;a<o.length;a++)for(var l=o[a],c=this.expandCoverage(l.coverage),u=l.alternateSets,h=0;h<c.length;h++)n.push({sub:c[h],by:u[h]});return n},yt.prototype.getLigatures=function(e,t,r){for(var n=[],i=this.getLookupTables(t,r,e,4),s=0;s<i.length;s++)for(var o=i[s].subtables,a=0;a<o.length;a++)for(var l=o[a],c=this.expandCoverage(l.coverage),u=l.ligatureSets,h=0;h<c.length;h++)for(var d=c[h],p=u[h],f=0;f<p.length;f++){var m=p[f];n.push({sub:[d].concat(m.components),by:m.ligGlyph})}return n},yt.prototype.addSingle=function(e,t,r,n){r=vt(this.getLookupTables(r,n,e,1,!0)[0],2,{substFormat:2,coverage:{format:1,glyphs:[]},substitute:[]}),j.assert(1===r.coverage.format,"Ligature: unable to modify coverage table format "+r.coverage.format),n=t.sub,(e=this.binSearch(r.coverage.glyphs,n))<0&&(r.coverage.glyphs.splice(e=-1-e,0,n),r.substitute.splice(e,0,0)),r.substitute[e]=t.by},yt.prototype.addAlternate=function(e,t,r,n){r=vt(this.getLookupTables(r,n,e,3,!0)[0],1,{substFormat:1,coverage:{format:1,glyphs:[]},alternateSets:[]}),j.assert(1===r.coverage.format,"Ligature: unable to modify coverage table format "+r.coverage.format),n=t.sub,(e=this.binSearch(r.coverage.glyphs,n))<0&&(r.coverage.glyphs.splice(e=-1-e,0,n),r.alternateSets.splice(e,0,0)),r.alternateSets[e]=t.by},yt.prototype.addLigature=function(e,t,r,n){(n=(r=this.getLookupTables(r,n,e,4,!0)[0]).subtables[0])||(r.subtables[0]=n={substFormat:1,coverage:{format:1,glyphs:[]},ligatureSets:[]}),j.assert(1===n.coverage.format,"Ligature: unable to modify coverage table format "+n.coverage.format),e=t.sub[0];var i=t.sub.slice(1);r={ligGlyph:t.by,components:i};if(0<=(t=this.binSearch(n.coverage.glyphs,e))){for(var s=n.ligatureSets[t],o=0;o<s.length;o++)if(function(e,t){var r=e.length;if(r===t.length){for(var n=0;n<r;n++)if(e[n]!==t[n])return;return 1}}(s[o].components,i))return;s.push(r)}else n.coverage.glyphs.splice(t=-1-t,0,e),n.ligatureSets.splice(t,0,[r])},yt.prototype.getFeature=function(e,t,r){if(/ss\d\d/.test(e))return this.getSingle(e,t,r);switch(e){case"aalt":case"salt":return this.getSingle(e,t,r).concat(this.getAlternates(e,t,r));case"dlig":case"liga":case"rlig":return this.getLigatures(e,t,r)}},yt.prototype.add=function(e,t,r,n){if(/ss\d\d/.test(e))return this.addSingle(e,t,r,n);switch(e){case"aalt":case"salt":return"number"==typeof t.by?this.addSingle(e,t,r,n):this.addAlternate(e,t,r,n);case"dlig":case"liga":case"rlig":return this.addLigature(e,t,r,n)}};var Et={getPath:Mt,parse:function(e,t,r,n){for(var i=new ve.GlyphSet(n),s=0;s<r.length-1;s+=1){var o=r[s];o!==r[s+1]?i.push(s,ve.ttfGlyphLoader(n,s,wt,e,t+o,Tt)):i.push(s,ve.glyphLoader(n,s))}return i}};function At(e){this.font=e,this.getCommands=function(e){return Et.getPath(e).commands},this._fpgmState=this._prepState=void 0,this._errorState=0}function Ct(e){return e}function Lt(e){return Math.sign(e)*Math.round(Math.abs(e))}function Rt(e){return Math.sign(e)*Math.round(Math.abs(2*e))/2}function Pt(e){return Math.sign(e)*(Math.round(Math.abs(e)+.5)-.5)}function jt(e){return Math.sign(e)*Math.ceil(Math.abs(e))}function It(e){return Math.sign(e)*Math.floor(Math.abs(e))}function Dt(e){var t=this.srPeriod,r=this.srPhase,n=1;return e<0&&(e=-e,n=-1),e+=this.srThreshold-r,e=Math.trunc(e/t)*t,(e+=r)<0?r*n:e*n}var Ot={x:1,y:0,axis:"x",distance:function(e,t,r,n){return(r?e.xo:e.x)-(n?t.xo:t.x)},interpolate:function(e,t,r,n){var i,s,o,a,l,c,u;if(!n||n===this)return i=e.xo-t.xo,s=e.xo-r.xo,l=t.x-t.xo,c=r.x-r.xo,0===(u=(o=Math.abs(i))+(a=Math.abs(s)))?void(e.x=e.xo+(l+c)/2):void(e.x=e.xo+(l*a+c*o)/u);i=n.distance(e,t,!0,!0),s=n.distance(e,r,!0,!0),l=n.distance(t,t,!1,!0),c=n.distance(r,r,!1,!0),0===(u=(o=Math.abs(i))+(a=Math.abs(s)))?Ot.setRelative(e,e,(l+c)/2,n,!0):Ot.setRelative(e,e,(l*a+c*o)/u,n,!0)},normalSlope:Number.NEGATIVE_INFINITY,setRelative:function(e,t,r,n,i){var s,o;n&&n!==this?(s=i?t.xo:t.x,o=i?t.yo:t.y,s+=r*n.x,o+=r*n.y,e.x=s+(e.y-o)/n.normalSlope):e.x=(i?t.xo:t.x)+r},slope:0,touch:function(e){e.xTouched=!0},touched:function(e){return e.xTouched},untouch:function(e){e.xTouched=!1}},Nt={x:0,y:1,axis:"y",distance:function(e,t,r,n){return(r?e.yo:e.y)-(n?t.yo:t.y)},interpolate:function(e,t,r,n){var i,s,o,a,l,c,u;if(!n||n===this)return i=e.yo-t.yo,s=e.yo-r.yo,l=t.y-t.yo,c=r.y-r.yo,0===(u=(o=Math.abs(i))+(a=Math.abs(s)))?void(e.y=e.yo+(l+c)/2):void(e.y=e.yo+(l*a+c*o)/u);i=n.distance(e,t,!0,!0),s=n.distance(e,r,!0,!0),l=n.distance(t,t,!1,!0),c=n.distance(r,r,!1,!0),0===(u=(o=Math.abs(i))+(a=Math.abs(s)))?Nt.setRelative(e,e,(l+c)/2,n,!0):Nt.setRelative(e,e,(l*a+c*o)/u,n,!0)},normalSlope:0,setRelative:function(e,t,r,n,i){var s,o;n&&n!==this?(s=i?t.xo:t.x,o=i?t.yo:t.y,s+=r*n.x,o+=r*n.y,e.y=o+n.normalSlope*(e.x-s)):e.y=(i?t.yo:t.y)+r},slope:Number.POSITIVE_INFINITY,touch:function(e){e.yTouched=!0},touched:function(e){return e.yTouched},untouch:function(e){e.yTouched=!1}};function Ut(e,t){this.x=e,this.y=t,this.axis=void 0,this.slope=t/e,this.normalSlope=-e/t,Object.freeze(this)}function kt(e,t){var r=Math.sqrt(e*e+t*t);return t/=r,1==(e/=r)&&0===t?Ot:0===e&&1===t?Nt:new Ut(e,t)}function Ft(e,t,r,n){this.x=this.xo=Math.round(64*e)/64,this.y=this.yo=Math.round(64*t)/64,this.lastPointOfContour=r,this.onCurve=n,this.prevPointOnContour=void 0,this.nextPointOnContour=void 0,this.xTouched=!1,this.yTouched=!1,Object.preventExtensions(this)}Object.freeze(Ot),Object.freeze(Nt),Ut.prototype.distance=function(e,t,r,n){return this.x*Ot.distance(e,t,r,n)+this.y*Nt.distance(e,t,r,n)},Ut.prototype.interpolate=function(e,t,r,n){var i=n.distance(e,t,!0,!0),s=n.distance(e,r,!0,!0),o=(t=n.distance(t,t,!1,!0),r=n.distance(r,r,!1,!0),(i=Math.abs(i))+(s=Math.abs(s)));0===o?this.setRelative(e,e,(t+r)/2,n,!0):this.setRelative(e,e,(t*s+r*i)/o,n,!0)},Ut.prototype.setRelative=function(e,t,r,n,i){var s=i?t.xo:t.x,o=(i=i?t.yo:t.y,t=s+r*(n=n||this).x,s=i+r*n.y,i=n.normalSlope,r=this.slope,n=e.x,e.y);e.x=(r*n-i*t+s-o)/(r-i),e.y=r*(e.x-n)+o},Ut.prototype.touch=function(e){e.xTouched=!0,e.yTouched=!0},Ft.prototype.nextTouched=function(e){for(var t=this.nextPointOnContour;!e.touched(t)&&t!==this;)t=t.nextPointOnContour;return t},Ft.prototype.prevTouched=function(e){for(var t=this.prevPointOnContour;!e.touched(t)&&t!==this;)t=t.prevPointOnContour;return t};var Bt=Object.freeze(new Ft(0,0)),zt={cvCutIn:17/16,deltaBase:9,deltaShift:.125,loop:1,minDis:1,autoFlip:!0};function Gt(e,t){switch(this.env=e,this.stack=[],this.prog=t,e){case"glyf":this.zp0=this.zp1=this.zp2=1,this.rp0=this.rp1=this.rp2=0;case"prep":this.fv=this.pv=this.dpv=Ot,this.round=Lt}}function Vt(e){for(var t=e.tZone=new Array(e.gZone.length),r=0;r<t.length;r++)t[r]=new Ft(0,0)}function Ht(e,t){var r,n=e.prog,i=e.ip,s=1;do{if(88===(r=n[++i]))s++;else if(89===r)s--;else if(64===r)i+=n[i+1]+1;else if(65===r)i+=2*n[i+1]+1;else if(176<=r&&r<=183)i+=r-176+1;else if(184<=r&&r<=191)i+=2*(r-184+1);else if(t&&1===s&&27===r)break}while(0<s);e.ip=i}function Wt(e,r){t.DEBUG,r.fv=r.pv=r.dpv=e}function Xt(e,r){t.DEBUG,r.pv=r.dpv=e}function qt(e,r){t.DEBUG,r.fv=e}function Yt(e,r){var n,i=(s=r.stack).pop(),s=s.pop(),o=r.z2[i],a=r.z1[s];t.DEBUG,i=e?(n=o.y-a.y,a.x-o.x):(n=a.x-o.x,a.y-o.y),r.pv=r.dpv=kt(n,i)}function Zt(e,r){var n,i=(s=r.stack).pop(),s=s.pop(),o=r.z2[i],a=r.z1[s];t.DEBUG,i=e?(n=o.y-a.y,a.x-o.x):(n=a.x-o.x,a.y-o.y),r.fv=kt(n,i)}function Jt(e){t.DEBUG,e.stack.pop()}function Kt(e,r){var n=r.stack.pop(),i=r.z0[n],s=r.fv,o=r.pv,a=(t.DEBUG,o.distance(i,Bt));e&&(a=r.round(a)),s.setRelative(i,Bt,a,o),s.touch(i),r.rp0=r.rp1=n}function Qt(e,r){var n,i,s,o=r.z2,a=o.length-2;t.DEBUG;for(var l=0;l<a;l++)n=o[l],e.touched(n)||(i=n.prevTouched(e))!==n&&(i===(s=n.nextTouched(e))&&e.setRelative(n,n,e.distance(i,i,!1,!0),e,!0),e.interpolate(n,i,s,e))}function $t(e,r){for(var n=r.stack,i=e?r.rp1:r.rp2,s=(e?r.z0:r.z1)[i],o=r.fv,a=r.pv,l=r.loop,c=r.z2;l--;){var u=c[n.pop()],h=a.distance(s,s,!1,!0);o.setRelative(u,u,h,a),o.touch(u),t.DEBUG}r.loop=1}function er(e,r){for(var n=r.stack,i=e?r.rp1:r.rp2,s=(e?r.z0:r.z1)[i],o=r.fv,a=r.pv,l=(i=n.pop(),r.z2[r.contours[i]]),c=l,u=(t.DEBUG,a.distance(s,s,!1,!0));c!==s&&o.setRelative(c,c,u,a),(c=c.nextPointOnContour)!==l;);}function tr(e,r){var n,i,s=r.stack,o=e?r.rp1:r.rp2,a=(o=(e?r.z0:r.z1)[o],r.fv),l=r.pv;s=s.pop();switch(t.DEBUG,s){case 0:n=r.tZone;break;case 1:n=r.gZone;break;default:throw new Error("Invalid zone")}for(var c=l.distance(o,o,!1,!0),u=n.length-2,h=0;h<u;h++)i=n[h],a.setRelative(i,i,c,l)}function rr(e,r){var n=(i=r.stack).pop()/64,i=i.pop(),s=r.z1[i],o=r.z0[r.rp0],a=r.fv,l=r.pv;a.setRelative(s,o,n,l),a.touch(s),t.DEBUG,r.rp1=r.rp0,r.rp2=i,e&&(r.rp0=i)}function nr(e,r){var n=(i=r.stack).pop(),i=i.pop(),s=r.z0[i],o=r.fv,a=r.pv,l=r.cvt[n];t.DEBUG,n=a.distance(s,Bt);e&&(Math.abs(n-l)<r.cvCutIn&&(n=l),n=r.round(n)),o.setRelative(s,Bt,n,a),0===r.zp0&&(s.xo=s.x,s.yo=s.y),o.touch(s),r.rp0=r.rp1=i}function ir(e,r){var n=r.stack,i=n.pop(),s=r.z2[i];t.DEBUG,n.push(64*r.dpv.distance(s,Bt,e,!1))}function sr(e,r){var n=(i=r.stack).pop(),i=i.pop(),s=r.z1[n],o=r.z0[i];o=r.dpv.distance(o,s,e,e);t.DEBUG,r.stack.push(Math.round(64*o))}function or(e,r){var n=r.stack,i=n.pop(),s=r.fv,o=r.pv,a=r.ppem,l=r.deltaBase+16*(e-1),c=r.deltaShift,u=r.z0;t.DEBUG;for(var h=0;h<i;h++){var d=n.pop(),p=n.pop();l+((240&p)>>4)===a&&(0<=(p=(15&p)-8)&&p++,t.DEBUG,d=u[d],s.setRelative(d,d,p*c,o))}}function ar(e,r){var n=r.stack,i=n.pop();t.DEBUG,n.push(64*r.round(i/64))}function lr(e,r){var n=r.stack,i=n.pop(),s=r.ppem,o=r.deltaBase+16*(e-1),a=r.deltaShift;t.DEBUG;for(var l=0;l<i;l++){var c=n.pop(),u=n.pop();o+((240&u)>>4)===s&&(0<=(u=(15&u)-8)&&u++,u*=a,t.DEBUG,r.cvt[c]+=u)}}function cr(e,r){var n,i=(s=r.stack).pop(),s=s.pop(),o=r.z2[i],a=r.z1[s];t.DEBUG,i=e?(n=o.y-a.y,a.x-o.x):(n=a.x-o.x,a.y-o.y),r.dpv=kt(n,i)}function ur(e,r){var n=r.stack,i=r.prog,s=r.ip;t.DEBUG;for(var o=0;o<e;o++)n.push(i[++s]);r.ip=s}function hr(e,r){var n=r.ip,i=r.prog,s=r.stack;t.DEBUG;for(var o=0;o<e;o++){var a=i[++n]<<8|i[++n];32768&a&&(a=-(1+(65535^a))),s.push(a)}r.ip=n}function dr(e,r,n,i,s,o){var a,l=o.stack,c=e&&l.pop(),u=(l=l.pop(),o.rp0),h=(u=o.z0[u],o.z1[l]),d=o.minDis,p=o.fv,f=o.dpv,m=f.distance(h,u,!0,!0),g=0<=m?1:-1;m=Math.abs(m),e&&(a=o.cvt[c],i&&Math.abs(m-a)<o.cvCutIn&&(m=a)),n&&m<d&&(m=d),i&&(m=o.round(m)),p.setRelative(h,u,g*m,f),p.touch(h),t.DEBUG,o.rp1=o.rp0,o.rp2=l,r&&(o.rp0=l)}At.prototype.exec=function(e,r){if("number"!=typeof r)throw new Error("Point size is not a number!");if(!(2<this._errorState)){var n=this.font,i=this._prepState;if(!i||i.ppem!==r){var s=this._fpgmState;if(!s){Gt.prototype=zt,(s=this._fpgmState=new Gt("fpgm",n.tables.fpgm)).funcs=[],s.font=n,t.DEBUG&&(s.step=-1);try{mr(s)}catch(e){return void(this._errorState=3)}}Gt.prototype=s,(i=this._prepState=new Gt("prep",n.tables.prep)).ppem=r;var o=n.tables.cvt;if(o)for(var a=i.cvt=new Array(o.length),l=r/n.unitsPerEm,c=0;c<o.length;c++)a[c]=o[c]*l;else i.cvt=[];t.DEBUG&&(i.step=-1);try{mr(i)}catch(e){this._errorState,this._errorState=2}}if(!(1<this._errorState))try{return pr(e,i)}catch(e){this._errorState,this._errorState=1}}};var pr=function(e,r){var n=r.ppem/r.font.unitsPerEm,i=n,s=e.components;if(Gt.prototype=r,s){for(var o=r.font,a=[],l=[],c=0;c<s.length;c++){var u=s[c],h=o.glyphs.get(u.glyphIndex),d=new Gt("glyf",h.instructions);t.DEBUG&&(d.step=-1),fr(h,d,n,i);for(var p=Math.round(u.dx*n),f=Math.round(u.dy*i),m=d.gZone,g=d.contours,y=0;y<m.length;y++){var v=m[y];v.xTouched=v.yTouched=!1,v.xo=v.x=v.x+p,v.yo=v.y=v.y+f}var _=a.length;a.push.apply(a,m);for(var x=0;x<g.length;x++)l.push(g[x]+_)}e.instructions&&!d.inhibitGridFit&&((d=new Gt("glyf",e.instructions)).gZone=d.z0=d.z1=d.z2=a,d.contours=l,a.push(new Ft(0,0),new Ft(Math.round(e.advanceWidth*n),0)),t.DEBUG&&(d.step=-1),mr(d),a.length-=2)}else d=new Gt("glyf",e.instructions),t.DEBUG&&(d.step=-1),fr(e,d,n,i),a=d.gZone;return a},fr=function(e,r,n,i){for(var s,o,a,l=e.points||[],c=l.length,u=r.gZone=r.z0=r.z1=r.z2=[],h=r.contours=[],d=0;d<c;d++)s=l[d],u[d]=new Ft(s.x*n,s.y*i,s.lastPointOfContour,s.onCurve);for(var p=0;p<c;p++)s=u[p],o||(o=s,h.push(p)),s.lastPointOfContour?((s.nextPointOnContour=o).prevPointOnContour=s,o=void 0):(a=u[p+1],(s.nextPointOnContour=a).prevPointOnContour=s);if(!r.inhibitGridFit){if(t.DEBUG)for(var f=0;f<c;f++);if(u.push(new Ft(0,0),new Ft(Math.round(e.advanceWidth*n),0)),mr(r),u.length-=2,t.DEBUG)for(var m=0;m<c;m++);}},mr=function(e){var r=e.prog;if(r){var n,i=r.length;for(e.ip=0;e.ip<i;e.ip++){if(t.DEBUG&&e.step++,!(n=gr[r[e.ip]]))throw new Error("unknown instruction: 0x"+Number(r[e.ip]).toString(16));n(e)}}},gr=[Wt.bind(void 0,Nt),Wt.bind(void 0,Ot),Xt.bind(void 0,Nt),Xt.bind(void 0,Ot),qt.bind(void 0,Nt),qt.bind(void 0,Ot),Yt.bind(void 0,0),Yt.bind(void 0,1),Zt.bind(void 0,0),Zt.bind(void 0,1),function(e){var r=(n=e.stack).pop(),n=n.pop();t.DEBUG,e.pv=e.dpv=kt(n,r)},function(e){var r=(n=e.stack).pop(),n=n.pop();t.DEBUG,e.fv=kt(n,r)},function(e){var r=e.stack,n=e.pv;t.DEBUG,r.push(16384*n.x),r.push(16384*n.y)},function(e){var r=e.stack,n=e.fv;t.DEBUG,r.push(16384*n.x),r.push(16384*n.y)},function(e){e.fv=e.pv,t.DEBUG},function(e){var r=(o=e.stack).pop(),n=o.pop(),i=o.pop(),s=o.pop(),o=o.pop(),a=e.z0,l=e.z1,c=a[r],u=(a=a[n],l[i]),h=(l=l[s],e=e.z2[o],r=(t.DEBUG,c.x),n=c.y,i=a.x,s=a.y,o=u.x,c=u.y,a=l.x,l=(r-i)*(c-(u=l.y))-(n-s)*(o-a),r*s-n*i),d=o*u-c*a;e.x=(h*(o-a)-d*(r-i))/l,e.y=(h*(c-u)-d*(n-s))/l},function(e){e.rp0=e.stack.pop(),t.DEBUG},function(e){e.rp1=e.stack.pop(),t.DEBUG},function(e){e.rp2=e.stack.pop(),t.DEBUG},function(e){var r=e.stack.pop();switch(t.DEBUG,e.zp0=r){case 0:e.tZone||Vt(e),e.z0=e.tZone;break;case 1:e.z0=e.gZone;break;default:throw new Error("Invalid zone pointer")}},function(e){var r=e.stack.pop();switch(t.DEBUG,e.zp1=r){case 0:e.tZone||Vt(e),e.z1=e.tZone;break;case 1:e.z1=e.gZone;break;default:throw new Error("Invalid zone pointer")}},function(e){var r=e.stack.pop();switch(t.DEBUG,e.zp2=r){case 0:e.tZone||Vt(e),e.z2=e.tZone;break;case 1:e.z2=e.gZone;break;default:throw new Error("Invalid zone pointer")}},function(e){var r=e.stack.pop();switch(t.DEBUG,e.zp0=e.zp1=e.zp2=r){case 0:e.tZone||Vt(e),e.z0=e.z1=e.z2=e.tZone;break;case 1:e.z0=e.z1=e.z2=e.gZone;break;default:throw new Error("Invalid zone pointer")}},function(e){e.loop=e.stack.pop(),t.DEBUG},function(e){t.DEBUG,e.round=Lt},function(e){t.DEBUG,e.round=Pt},function(e){var r=e.stack.pop();t.DEBUG,e.minDis=r/64},function(e){t.DEBUG,Ht(e,!1)},function(e){var r=e.stack.pop();t.DEBUG,e.ip+=r-1},function(e){var r=e.stack.pop();t.DEBUG,e.cvCutIn=r/64},void 0,void 0,function(e){var r=e.stack;t.DEBUG,r.push(r[r.length-1])},Jt,function(e){t.DEBUG,e.stack.length=0},function(e){var r=e.stack,n=r.pop(),i=r.pop();t.DEBUG,r.push(n),r.push(i)},function(e){var r=e.stack;t.DEBUG,r.push(r.length)},function(e){var r=e.stack,n=r.pop();t.DEBUG,r.push(r[r.length-n])},function(e){var r=e.stack,n=r.pop();t.DEBUG,r.push(r.splice(r.length-n,1)[0])},void 0,void 0,void 0,function(e){var r=(i=e.stack).pop(),n=i.pop(),i=(t.DEBUG,e.ip),s=e.prog;e.prog=e.funcs[r];for(var o=0;o<n;o++)mr(e),t.DEBUG;e.ip=i,e.prog=s},function(e){var r=e.stack.pop(),n=(t.DEBUG,e.ip),i=e.prog;e.prog=e.funcs[r],mr(e),e.ip=n,e.prog=i,t.DEBUG},function(e){if("fpgm"!==e.env)throw new Error("FDEF not allowed here");var r=e.stack,n=e.prog,i=e.ip,s=(r=r.pop(),i);for(t.DEBUG;45!==n[++i];);e.ip=i,e.funcs[r]=n.slice(s+1,i)},void 0,Kt.bind(void 0,0),Kt.bind(void 0,1),Qt.bind(void 0,Nt),Qt.bind(void 0,Ot),$t.bind(void 0,0),$t.bind(void 0,1),er.bind(void 0,0),er.bind(void 0,1),tr.bind(void 0,0),tr.bind(void 0,1),function(e){for(var r=e.stack,n=e.loop,i=e.fv,s=r.pop()/64,o=e.z2;n--;){var a=o[r.pop()];t.DEBUG,i.setRelative(a,a,s),i.touch(a)}e.loop=1},function(e){for(var r=e.stack,n=e.rp1,i=e.rp2,s=e.loop,o=e.z0[n],a=e.z1[i],l=e.fv,c=e.dpv,u=e.z2;s--;){var h=u[r.pop()];t.DEBUG,l.interpolate(h,o,a,c),l.touch(h)}e.loop=1},rr.bind(void 0,0),rr.bind(void 0,1),function(e){for(var r=e.stack,n=e.rp0,i=e.z0[n],s=e.loop,o=e.fv,a=e.pv,l=e.z1;s--;){var c=l[r.pop()];t.DEBUG,o.setRelative(c,i,0,a),o.touch(c)}e.loop=1},function(e){t.DEBUG,e.round=Rt},nr.bind(void 0,0),nr.bind(void 0,1),function(e){var r=e.prog,n=e.ip,i=e.stack,s=r[++n];t.DEBUG;for(var o=0;o<s;o++)i.push(r[++n]);e.ip=n},function(e){var r=e.ip,n=e.prog,i=e.stack,s=n[++r];t.DEBUG;for(var o=0;o<s;o++){var a=n[++r]<<8|n[++r];32768&a&&(a=-(1+(65535^a))),i.push(a)}e.ip=r},function(e){var r=e.stack,n=(n=e.store)||(e.store=[]),i=r.pop();r=r.pop();t.DEBUG,n[r]=i},function(e){var r=e.stack,n=e.store,i=r.pop();t.DEBUG,e=n&&n[i]||0;r.push(e)},function(e){var r=(n=e.stack).pop(),n=n.pop();t.DEBUG,e.cvt[n]=r/64},function(e){var r=e.stack,n=r.pop();t.DEBUG,r.push(64*e.cvt[n])},ir.bind(void 0,0),ir.bind(void 0,1),void 0,sr.bind(void 0,0),sr.bind(void 0,1),function(e){t.DEBUG,e.stack.push(e.ppem)},void 0,function(e){t.DEBUG,e.autoFlip=!0},void 0,void 0,function(e){var r=e.stack,n=r.pop(),i=r.pop();t.DEBUG,r.push(i<n?1:0)},function(e){var r=e.stack,n=r.pop(),i=r.pop();t.DEBUG,r.push(i<=n?1:0)},function(e){var r=e.stack,n=r.pop(),i=r.pop();t.DEBUG,r.push(n<i?1:0)},function(e){var r=e.stack,n=r.pop(),i=r.pop();t.DEBUG,r.push(n<=i?1:0)},function(e){var r=e.stack,n=r.pop(),i=r.pop();t.DEBUG,r.push(n===i?1:0)},function(e){var r=e.stack,n=r.pop(),i=r.pop();t.DEBUG,r.push(n!==i?1:0)},function(e){var r=e.stack,n=r.pop();t.DEBUG,r.push(Math.trunc(n)%2?1:0)},function(e){var r=e.stack,n=r.pop();t.DEBUG,r.push(Math.trunc(n)%2?0:1)},function(e){var r=e.stack.pop();t.DEBUG,r||(Ht(e,!0),t.DEBUG)},function(e){t.DEBUG},function(e){var r=e.stack,n=r.pop(),i=r.pop();t.DEBUG,r.push(n&&i?1:0)},function(e){var r=e.stack,n=r.pop(),i=r.pop();t.DEBUG,r.push(n||i?1:0)},function(e){var r=e.stack,n=r.pop();t.DEBUG,r.push(n?0:1)},or.bind(void 0,1),function(e){var r=e.stack.pop();t.DEBUG,e.deltaBase=r},function(e){var r=e.stack.pop();t.DEBUG,e.deltaShift=Math.pow(.5,r)},function(e){var r=e.stack,n=r.pop(),i=r.pop();t.DEBUG,r.push(i+n)},function(e){var r=e.stack,n=r.pop(),i=r.pop();t.DEBUG,r.push(i-n)},function(e){var r=e.stack,n=r.pop(),i=r.pop();t.DEBUG,r.push(64*i/n)},function(e){var r=e.stack,n=r.pop(),i=r.pop();t.DEBUG,r.push(i*n/64)},function(e){var r=e.stack,n=r.pop();t.DEBUG,r.push(Math.abs(n))},function(e){var r=e.stack,n=r.pop();t.DEBUG,r.push(-n)},function(e){var r=e.stack,n=r.pop();t.DEBUG,r.push(64*Math.floor(n/64))},function(e){var r=e.stack,n=r.pop();t.DEBUG,r.push(64*Math.ceil(n/64))},ar.bind(void 0,0),ar.bind(void 0,1),ar.bind(void 0,2),ar.bind(void 0,3),void 0,void 0,void 0,void 0,function(e){var r=(n=e.stack).pop(),n=n.pop();t.DEBUG,e.cvt[n]=r*e.ppem/e.font.unitsPerEm},or.bind(void 0,2),or.bind(void 0,3),lr.bind(void 0,1),lr.bind(void 0,2),lr.bind(void 0,3),function(e){var r,n=e.stack.pop();switch(t.DEBUG,e.round=Dt,192&n){case 0:r=.5;break;case 64:r=1;break;case 128:r=2;break;default:throw new Error("invalid SROUND value")}switch(e.srPeriod=r,48&n){case 0:e.srPhase=0;break;case 16:e.srPhase=.25*r;break;case 32:e.srPhase=.5*r;break;case 48:e.srPhase=.75*r;break;default:throw new Error("invalid SROUND value")}e.srThreshold=0==(n&=15)?0:(n/8-.5)*r},function(e){var r,n=e.stack.pop();switch(t.DEBUG,e.round=Dt,192&n){case 0:r=Math.sqrt(2)/2;break;case 64:r=Math.sqrt(2);break;case 128:r=2*Math.sqrt(2);break;default:throw new Error("invalid S45ROUND value")}switch(e.srPeriod=r,48&n){case 0:e.srPhase=0;break;case 16:e.srPhase=.25*r;break;case 32:e.srPhase=.5*r;break;case 48:e.srPhase=.75*r;break;default:throw new Error("invalid S45ROUND value")}e.srThreshold=0==(n&=15)?0:(n/8-.5)*r},void 0,void 0,function(e){t.DEBUG,e.round=Ct},void 0,function(e){t.DEBUG,e.round=jt},function(e){t.DEBUG,e.round=It},Jt,Jt,void 0,void 0,void 0,void 0,void 0,function(e){e.stack.pop();t.DEBUG},cr.bind(void 0,0),cr.bind(void 0,1),function(e){var r=e.stack,n=r.pop(),i=0;t.DEBUG,1&n&&(i=35),32&n&&(i|=4096),r.push(i)},void 0,function(e){var r=e.stack,n=r.pop(),i=r.pop(),s=r.pop();t.DEBUG,r.push(i),r.push(n),r.push(s)},function(e){var r=e.stack,n=r.pop(),i=r.pop();t.DEBUG,r.push(Math.max(i,n))},function(e){var r=e.stack,n=r.pop(),i=r.pop();t.DEBUG,r.push(Math.min(i,n))},function(e){e.stack.pop();t.DEBUG},function(e){var r=e.stack.pop(),n=e.stack.pop();switch(t.DEBUG,r){case 1:return void(e.inhibitGridFit=!!n);case 2:return void(e.ignoreCvt=!!n);default:throw new Error("invalid INSTCTRL[] selector")}},void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,ur.bind(void 0,1),ur.bind(void 0,2),ur.bind(void 0,3),ur.bind(void 0,4),ur.bind(void 0,5),ur.bind(void 0,6),ur.bind(void 0,7),ur.bind(void 0,8),hr.bind(void 0,1),hr.bind(void 0,2),hr.bind(void 0,3),hr.bind(void 0,4),hr.bind(void 0,5),hr.bind(void 0,6),hr.bind(void 0,7),hr.bind(void 0,8),dr.bind(void 0,0,0,0,0,0),dr.bind(void 0,0,0,0,0,1),dr.bind(void 0,0,0,0,0,2),dr.bind(void 0,0,0,0,0,3),dr.bind(void 0,0,0,0,1,0),dr.bind(void 0,0,0,0,1,1),dr.bind(void 0,0,0,0,1,2),dr.bind(void 0,0,0,0,1,3),dr.bind(void 0,0,0,1,0,0),dr.bind(void 0,0,0,1,0,1),dr.bind(void 0,0,0,1,0,2),dr.bind(void 0,0,0,1,0,3),dr.bind(void 0,0,0,1,1,0),dr.bind(void 0,0,0,1,1,1),dr.bind(void 0,0,0,1,1,2),dr.bind(void 0,0,0,1,1,3),dr.bind(void 0,0,1,0,0,0),dr.bind(void 0,0,1,0,0,1),dr.bind(void 0,0,1,0,0,2),dr.bind(void 0,0,1,0,0,3),dr.bind(void 0,0,1,0,1,0),dr.bind(void 0,0,1,0,1,1),dr.bind(void 0,0,1,0,1,2),dr.bind(void 0,0,1,0,1,3),dr.bind(void 0,0,1,1,0,0),dr.bind(void 0,0,1,1,0,1),dr.bind(void 0,0,1,1,0,2),dr.bind(void 0,0,1,1,0,3),dr.bind(void 0,0,1,1,1,0),dr.bind(void 0,0,1,1,1,1),dr.bind(void 0,0,1,1,1,2),dr.bind(void 0,0,1,1,1,3),dr.bind(void 0,1,0,0,0,0),dr.bind(void 0,1,0,0,0,1),dr.bind(void 0,1,0,0,0,2),dr.bind(void 0,1,0,0,0,3),dr.bind(void 0,1,0,0,1,0),dr.bind(void 0,1,0,0,1,1),dr.bind(void 0,1,0,0,1,2),dr.bind(void 0,1,0,0,1,3),dr.bind(void 0,1,0,1,0,0),dr.bind(void 0,1,0,1,0,1),dr.bind(void 0,1,0,1,0,2),dr.bind(void 0,1,0,1,0,3),dr.bind(void 0,1,0,1,1,0),dr.bind(void 0,1,0,1,1,1),dr.bind(void 0,1,0,1,1,2),dr.bind(void 0,1,0,1,1,3),dr.bind(void 0,1,1,0,0,0),dr.bind(void 0,1,1,0,0,1),dr.bind(void 0,1,1,0,0,2),dr.bind(void 0,1,1,0,0,3),dr.bind(void 0,1,1,0,1,0),dr.bind(void 0,1,1,0,1,1),dr.bind(void 0,1,1,0,1,2),dr.bind(void 0,1,1,0,1,3),dr.bind(void 0,1,1,1,0,0),dr.bind(void 0,1,1,1,0,1),dr.bind(void 0,1,1,1,0,2),dr.bind(void 0,1,1,1,0,3),dr.bind(void 0,1,1,1,1,0),dr.bind(void 0,1,1,1,1,1),dr.bind(void 0,1,1,1,1,2),dr.bind(void 0,1,1,1,1,3)],yr=Array.from||function(e){return e.match(/[\uD800-\uDBFF][\uDC00-\uDFFF]?|[^\uD800-\uDFFF]|./g)||[]};function vr(e){(e=e||{}).empty||(xt(e.familyName,"When creating a new Font object, familyName is required."),xt(e.styleName,"When creating a new Font object, styleName is required."),xt(e.unitsPerEm,"When creating a new Font object, unitsPerEm is required."),xt(e.ascender,"When creating a new Font object, ascender is required."),xt(e.descender,"When creating a new Font object, descender is required."),xt(e.descender<0,"Descender should be negative (e.g. -512)."),this.names={fontFamily:{en:e.familyName||" "},fontSubfamily:{en:e.styleName||" "},fullName:{en:e.fullName||e.familyName+" "+e.styleName},postScriptName:{en:e.postScriptName||(e.familyName+e.styleName).replace(/\s/g,"")},designer:{en:e.designer||" "},designerURL:{en:e.designerURL||" "},manufacturer:{en:e.manufacturer||" "},manufacturerURL:{en:e.manufacturerURL||" "},license:{en:e.license||" "},licenseURL:{en:e.licenseURL||" "},version:{en:e.version||"Version 0.1"},description:{en:e.description||" "},copyright:{en:e.copyright||" "},trademark:{en:e.trademark||" "}},this.unitsPerEm=e.unitsPerEm||1e3,this.ascender=e.ascender,this.descender=e.descender,this.createdTimestamp=e.createdTimestamp,this.tables={os2:{usWeightClass:e.weightClass||this.usWeightClasses.MEDIUM,usWidthClass:e.widthClass||this.usWidthClasses.MEDIUM,fsSelection:e.fsSelection||this.fsSelectionValues.REGULAR}}),this.supported=!0,this.glyphs=new ve.GlyphSet(this,e.glyphs||[]),this.encoding=new ue(this),this.position=new gt(this),this.substitution=new yt(this),this.tables=this.tables||{},Object.defineProperty(this,"hinting",{get:function(){return this._hinting||("truetype"===this.outlinesFormat?this._hinting=new At(this):void 0)}})}function _r(e,t){var r,n=JSON.stringify(e),i=256;for(r in t){var s=parseInt(r);if(s&&!(s<256)){if(JSON.stringify(t[r])===n)return s;i<=s&&(i=s+1)}}return t[i]=e,i}vr.prototype.hasChar=function(e){return null!==this.encoding.charToGlyphIndex(e)},vr.prototype.charToGlyphIndex=function(e){return this.encoding.charToGlyphIndex(e)},vr.prototype.charToGlyph=function(e){return e=this.charToGlyphIndex(e),this.glyphs.get(e)||this.glyphs.get(0)},vr.prototype.stringToGlyphs=function(e,t){t=t||this.defaultRenderOptions;for(var r=yr(e),n=[],i=0;i<r.length;i+=1){var s=r[i];n.push(this.charToGlyphIndex(s))}var o=n.length;if(t.features){e=t.script||this.substitution.getDefaultScriptName();var a=[];t.features.liga&&(a=a.concat(this.substitution.getFeature("liga",e,t.language))),t.features.rlig&&(a=a.concat(this.substitution.getFeature("rlig",e,t.language)));for(var l=0;l<o;l+=1)for(var c=0;c<a.length;c++){for(var u=a[c],h=u.sub,d=h.length,p=0;p<d&&h[p]===n[l+p];)p++;p===d&&(n.splice(l,d,u.by),o=o-d+1)}}for(var f=new Array(o),m=this.glyphs.get(0),g=0;g<o;g+=1)f[g]=this.glyphs.get(n[g])||m;return f},vr.prototype.nameToGlyphIndex=function(e){return this.glyphNames.nameToGlyphIndex(e)},vr.prototype.nameToGlyph=function(e){return e=this.nameToGlyphIndex(e),this.glyphs.get(e)||this.glyphs.get(0)},vr.prototype.glyphIndexToName=function(e){return this.glyphNames.glyphIndexToName?this.glyphNames.glyphIndexToName(e):""},vr.prototype.getKerningValue=function(e,t){e=e.index||e,t=t.index||t;var r=this.position.defaultKerningTables;return r?this.position.getKerningValue(r,e,t):this.kerningPairs[e+","+t]||0},vr.prototype.defaultRenderOptions={kerning:!0,features:{liga:!0,rlig:!0}},vr.prototype.forEachGlyph=function(e,t,r,n,i,s){t=void 0!==t?t:0,r=void 0!==r?r:0,i=i||this.defaultRenderOptions;var o,a=1/this.unitsPerEm*(n=void 0!==n?n:72),l=this.stringToGlyphs(e,i);i.kerning&&(e=i.script||this.position.getDefaultScriptName(),o=this.position.getKerningTables(e,i.language));for(var c=0;c<l.length;c+=1){var u=l[c];s.call(this,u,t,r,n,i),u.advanceWidth&&(t+=u.advanceWidth*a),i.kerning&&c<l.length-1&&(t+=(o?this.position.getKerningValue(o,u.index,l[c+1].index):this.getKerningValue(u,l[c+1]))*a),i.letterSpacing?t+=i.letterSpacing*n:i.tracking&&(t+=i.tracking/1e3*n)}return t},vr.prototype.getPath=function(e,t,r,n,i){var s=new L;return this.forEachGlyph(e,t,r,n,i,(function(e,t,r,n){e=e.getPath(t,r,n,i,this),s.extend(e)})),s},vr.prototype.getPaths=function(e,t,r,n,i){var s=[];return this.forEachGlyph(e,t,r,n,i,(function(e,t,r,n){e=e.getPath(t,r,n,i,this),s.push(e)})),s},vr.prototype.getAdvanceWidth=function(e,t,r){return this.forEachGlyph(e,0,0,t,r,(function(){}))},vr.prototype.draw=function(e,t,r,n,i,s){this.getPath(t,r,n,i,s).draw(e)},vr.prototype.drawPoints=function(e,t,r,n,i,s){this.forEachGlyph(t,r,n,i,s,(function(t,r,n,i){t.drawPoints(e,r,n,i)}))},vr.prototype.drawMetrics=function(e,t,r,n,i,s){this.forEachGlyph(t,r,n,i,s,(function(t,r,n,i){t.drawMetrics(e,r,n,i)}))},vr.prototype.getEnglishName=function(e){if(e=this.names[e])return e.en},vr.prototype.validate=function(){var e=this;function t(t){(t=e.getEnglishName(t))&&t.trim().length}t("fontFamily"),t("weightName"),t("manufacturer"),t("copyright"),t("version"),this.unitsPerEm},vr.prototype.toTables=function(){return ht(this)},vr.prototype.toBuffer=function(){return this.toArrayBuffer()},vr.prototype.toArrayBuffer=function(){for(var e=this.toTables().encode(),t=new ArrayBuffer(e.length),r=new Uint8Array(t),n=0;n<e.length;n++)r[n]=e[n];return t},vr.prototype.download=function(t){var r=this.getEnglishName("fontFamily"),i=this.getEnglishName("fontSubfamily"),s=(t=t||r.replace(/\s/g,"")+"-"+i+".otf",this.toArrayBuffer());"undefined"!=typeof window?(window.requestFileSystem=window.requestFileSystem||window.webkitRequestFileSystem,window.requestFileSystem(window.TEMPORARY,s.byteLength,(function(e){e.root.getFile(t,{create:!0},(function(e){e.createWriter((function(t){var r=new DataView(s);r=new Blob([r],{type:"font/opentype"});t.write(r),t.addEventListener("writeend",(function(){location.href=e.toURL()}),!1)}))}))}),(function(e){throw new Error(e.name+": "+e.message)}))):(r=e("fs"),i=function(e){for(var t=new n(e.byteLength),r=new Uint8Array(e),i=0;i<t.length;++i)t[i]=r[i];return t}(s),r.writeFileSync(t,i))},vr.prototype.fsSelectionValues={ITALIC:1,UNDERSCORE:2,NEGATIVE:4,OUTLINED:8,STRIKEOUT:16,BOLD:32,REGULAR:64,USER_TYPO_METRICS:128,WWS:256,OBLIQUE:512},vr.prototype.usWidthClasses={ULTRA_CONDENSED:1,EXTRA_CONDENSED:2,CONDENSED:3,SEMI_CONDENSED:4,MEDIUM:5,SEMI_EXPANDED:6,EXPANDED:7,EXTRA_EXPANDED:8,ULTRA_EXPANDED:9},vr.prototype.usWeightClasses={THIN:100,EXTRA_LIGHT:200,LIGHT:300,NORMAL:400,MEDIUM:500,SEMI_BOLD:600,BOLD:700,EXTRA_BOLD:800,BLACK:900};var xr={make:function(e,t){var r=new J.Table("fvar",[{name:"version",type:"ULONG",value:65536},{name:"offsetToData",type:"USHORT",value:0},{name:"countSizePairs",type:"USHORT",value:2},{name:"axisCount",type:"USHORT",value:e.axes.length},{name:"axisSize",type:"USHORT",value:20},{name:"instanceCount",type:"USHORT",value:e.instances.length},{name:"instanceSize",type:"USHORT",value:4+4*e.axes.length}]);r.offsetToData=r.sizeOf();for(var n,i,s,o=0;o<e.axes.length;o++)r.fields=r.fields.concat((n=o,t,s=_r((i=e.axes[o]).name,t),[{name:"tag_"+n,type:"TAG",value:i.tag},{name:"minValue_"+n,type:"FIXED",value:i.minValue<<16},{name:"defaultValue_"+n,type:"FIXED",value:i.defaultValue<<16},{name:"maxValue_"+n,type:"FIXED",value:i.maxValue<<16},{name:"flags_"+n,type:"USHORT",value:0},{name:"nameID_"+n,type:"USHORT",value:s}]));for(var a=0;a<e.instances.length;a++)r.fields=r.fields.concat(function(e,t,r,n){for(var i=[{name:"nameID_"+e,type:"USHORT",value:_r(t.name,n)},{name:"flags_"+e,type:"USHORT",value:0}],s=0;s<r.length;++s){var o=r[s].tag;i.push({name:"axis_"+e+" "+o,type:"FIXED",value:t.coordinates[o]<<16})}return i}(a,e.instances[a],e.axes,t));return r},parse:function(e,t,r){for(var n,i,s,o,a=new ie.Parser(e,t),l=a.parseULong(),c=(j.argument(65536===l,"Unsupported fvar table version."),a.parseOffset16()),u=(a.skip("uShort",1),a.parseUShort()),h=a.parseUShort(),d=a.parseUShort(),p=a.parseUShort(),f=[],m=0;m<u;m++)f.push((n=e,i=t+c+m*h,s=r,o={},n=new ie.Parser(n,i),o.tag=n.parseTag(),o.minValue=n.parseFixed(),o.defaultValue=n.parseFixed(),o.maxValue=n.parseFixed(),n.skip("uShort",1),o.name=s[n.parseUShort()]||{},o));for(var g=[],y=t+c+u*h,v=0;v<d;v++)g.push(function(e,t,r,n){var i={},s=new ie.Parser(e,t);i.name=n[s.parseUShort()]||{},s.skip("uShort",1),i.coordinates={};for(var o=0;o<r.length;++o)i.coordinates[r[o].tag]=s.parseFixed();return i}(e,y+v*p,f,r));return{axes:f,instances:g}}},br=new Array(10);br[1]=function(){var e=this.offset+this.relativeOffset,t=this.parseUShort();return 1===t?{posFormat:1,coverage:this.parsePointer(re.coverage),value:this.parseValueRecord()}:2===t?{posFormat:2,coverage:this.parsePointer(re.coverage),values:this.parseValueRecordList()}:void j.assert(!1,"0x"+e.toString(16)+": GPOS lookup type 1 format must be 1 or 2.")},br[2]=function(){var e,t,r,n,i=this.offset+this.relativeOffset,s=this.parseUShort(),o=(i=(j.assert(1===s||2===s,"0x"+i.toString(16)+": GPOS lookup type 2 format must be 1 or 2."),this.parsePointer(re.coverage)),this.parseUShort()),a=this.parseUShort();return 1===s?{posFormat:s,coverage:i,valueFormat1:o,valueFormat2:a,pairSets:this.parseList(re.pointer(re.list((function(){return{secondGlyph:this.parseUShort(),value1:this.parseValueRecord(o),value2:this.parseValueRecord(a)}}))))}:2===s?(e=this.parsePointer(re.classDef),t=this.parsePointer(re.classDef),r=this.parseUShort(),n=this.parseUShort(),{posFormat:s,coverage:i,valueFormat1:o,valueFormat2:a,classDef1:e,classDef2:t,class1Count:r,class2Count:n,classRecords:this.parseList(r,re.list(n,(function(){return{value1:this.parseValueRecord(o),value2:this.parseValueRecord(a)}})))}):void 0},br[3]=function(){return{error:"GPOS Lookup 3 not supported"}},br[4]=function(){return{error:"GPOS Lookup 4 not supported"}},br[5]=function(){return{error:"GPOS Lookup 5 not supported"}},br[6]=function(){return{error:"GPOS Lookup 6 not supported"}},br[7]=function(){return{error:"GPOS Lookup 7 not supported"}},br[8]=function(){return{error:"GPOS Lookup 8 not supported"}},br[9]=function(){return{error:"GPOS Lookup 9 not supported"}};var wr=new Array(10),Sr={parse:function(e,t){return t=(e=new re(e,t=t||0)).parseVersion(1),j.argument(1===t||1.1===t,"Unsupported GPOS table version "+t),1===t?{version:t,scripts:e.parseScriptList(),features:e.parseFeatureList(),lookups:e.parseLookupList(br)}:{version:t,scripts:e.parseScriptList(),features:e.parseFeatureList(),lookups:e.parseLookupList(br),variations:e.parseFeatureVariationsList()}},make:function(e){return new J.Table("GPOS",[{name:"version",type:"ULONG",value:65536},{name:"scripts",type:"TABLE",value:new J.ScriptList(e.scripts)},{name:"features",type:"TABLE",value:new J.FeatureList(e.features)},{name:"lookups",type:"TABLE",value:new J.LookupList(e.lookups,wr)}])}},Mr={parse:function(e,t){if(0===(t=(e=new ie.Parser(e,t)).parseUShort())){var r=e,n={},i=(r.skip("uShort"),r.parseUShort()),s=(j.argument(0===i,"Unsupported kern sub-table version."),r.skip("uShort",2),r.parseUShort());r.skip("uShort",3);for(var o=0;o<s;o+=1){var a=r.parseUShort(),l=r.parseUShort(),c=r.parseShort();n[a+","+l]=c}return n}if(1!==t)throw new Error("Unsupported kern table version ("+t+").");var u=e,h={};u.skip("uShort"),u.parseULong(),u.skip("uLong"),i=255&u.parseUShort();if(u.skip("uShort"),0==i){var d=u.parseUShort();u.skip("uShort",3);for(var p=0;p<d;p+=1){var f=u.parseUShort(),m=u.parseUShort(),g=u.parseShort();h[f+","+m]=g}}return h}},Tr={parse:function(e,t,r,n){for(var i=new ie.Parser(e,t),s=n?i.parseUShort:i.parseULong,o=[],a=0;a<r+1;a+=1){var l=s.call(i);n&&(l*=2),o.push(l)}return o}};function Er(t,r){e("fs").readFile(t,(function(e,t){if(e)return r(e.message);r(null,_t(t))}))}function Ar(e,t){var r=new XMLHttpRequest;r.open("get",e,!0),r.responseType="arraybuffer",r.onload=function(){return r.response?t(null,r.response):t("Font could not be loaded: "+r.statusText)},r.onerror=function(){t("Font could not be loaded")},r.send()}function Cr(e,t){for(var r=[],n=12,i=0;i<t;i+=1){var s=ie.getTag(e,n),o=ie.getULong(e,n+4),a=ie.getULong(e,n+8),l=ie.getULong(e,n+12);r.push({tag:s,checksum:o,offset:a,length:l,compression:!1}),n+=16}return r}function Lr(e,t){if("WOFF"!==t.compression)return{data:e,offset:t.offset};e=new Uint8Array(e.buffer,t.offset+2,t.compressedLength-2);var r=new Uint8Array(t.length);if(E(e,r),r.byteLength!==t.length)throw new Error("Decompression error: "+t.tag+" decompressed length doesn't match recorded length");return{data:new DataView(r.buffer,0),offset:0}}function Rr(e){var t,r,n,i,s,o,a,l,c,u,h,d,p,f,m=new vr({empty:!0}),g=new DataView(e,0),y=[];if((e=ie.getTag(g,0))===String.fromCharCode(0,1,0,0)||"true"===e||"typ1"===e)m.outlinesFormat="truetype",y=Cr(g,n=ie.getUShort(g,4));else if("OTTO"===e)m.outlinesFormat="cff",y=Cr(g,n=ie.getUShort(g,4));else{if("wOFF"!==e)throw new Error("Unsupported OpenType signature "+e);if((b=ie.getTag(g,4))===String.fromCharCode(0,1,0,0))m.outlinesFormat="truetype";else{if("OTTO"!==b)throw new Error("Unsupported OpenType flavor "+e);m.outlinesFormat="cff"}y=function(e,t){for(var r=[],n=44,i=0;i<t;i+=1){var s=ie.getTag(e,n),o=ie.getULong(e,n+4),a=ie.getULong(e,n+8),l=ie.getULong(e,n+12),c=a<l&&"WOFF";r.push({tag:s,offset:o,compression:c,compressedLength:a,length:l}),n+=20}return r}(g,n=ie.getUShort(g,12))}for(var v=0;v<n;v+=1){var _=y[v],x=void 0;switch(_.tag){case"cmap":x=Lr(g,_),m.tables.cmap=se.parse(x.data,x.offset),m.encoding=new he(m.tables.cmap);break;case"cvt ":x=Lr(g,_),f=new ie.Parser(x.data,x.offset),m.tables.cvt=f.parseShortList(_.length/2);break;case"fvar":s=_;break;case"fpgm":x=Lr(g,_),f=new ie.Parser(x.data,x.offset),m.tables.fpgm=f.parseByteList(_.length);break;case"head":x=Lr(g,_),m.tables.head=Oe.parse(x.data,x.offset),m.unitsPerEm=m.tables.head.unitsPerEm,t=m.tables.head.indexToLocFormat;break;case"hhea":x=Lr(g,_),m.tables.hhea=Ne.parse(x.data,x.offset),m.ascender=m.tables.hhea.ascender,m.descender=m.tables.hhea.descender,m.numberOfHMetrics=m.tables.hhea.numberOfHMetrics;break;case"hmtx":c=_;break;case"ltag":x=Lr(g,_),r=ke.parse(x.data,x.offset);break;case"maxp":x=Lr(g,_),m.tables.maxp=Fe.parse(x.data,x.offset),m.numGlyphs=m.tables.maxp.numGlyphs;break;case"name":d=_;break;case"OS/2":x=Lr(g,_),m.tables.os2=$e.parse(x.data,x.offset);break;case"post":x=Lr(g,_),m.tables.post=et.parse(x.data,x.offset),m.glyphNames=new pe(m.tables.post);break;case"prep":x=Lr(g,_),f=new ie.Parser(x.data,x.offset),m.tables.prep=f.parseByteList(_.length);break;case"glyf":o=_;break;case"loca":h=_;break;case"CFF ":i=_;break;case"kern":u=_;break;case"GPOS":a=_;break;case"GSUB":l=_;break;case"meta":p=_}}if(b=Lr(g,d),m.tables.name=Ke.parse(b.data,b.offset,r),m.names=m.tables.name,o&&h)e=0===t,b=Lr(g,h),b=Tr.parse(b.data,b.offset,m.numGlyphs,e),e=Lr(g,o),m.glyphs=Et.parse(e.data,e.offset,b,m);else{if(!i)throw new Error("Font doesn't contain TrueType or CFF outlines.");e=Lr(g,i),De.parse(e.data,e.offset,m)}for(var b=Lr(g,c),w=(Ue.parse(b.data,b.offset,m.numberOfHMetrics,m.numGlyphs,m.glyphs),m),S=w.tables.cmap.glyphIndexMap,M=Object.keys(S),T=0;T<M.length;T+=1){var E,A=M[T],C=S[A];(E=w.glyphs.get(C)).addUnicode(parseInt(A))}for(var L=0;L<w.glyphs.length;L+=1)E=w.glyphs.get(L),w.cffEncoding?w.isCIDFont?E.name="gid"+L:E.name=w.cffEncoding.charset[L]:w.glyphNames.names&&(E.name=w.glyphNames.glyphIndexToName(L));return u?(e=Lr(g,u),m.kerningPairs=Mr.parse(e.data,e.offset)):m.kerningPairs={},a&&(b=Lr(g,a),m.tables.gpos=Sr.parse(b.data,b.offset),m.position.init()),l&&(e=Lr(g,l),m.tables.gsub=it.parse(e.data,e.offset)),s&&(b=Lr(g,s),m.tables.fvar=xr.parse(b.data,b.offset,m.names)),p&&(e=Lr(g,p),m.tables.meta=st.parse(e.data,e.offset),m.metas=m.tables.meta),m}t.Font=vr,t.Glyph=me,t.Path=L,t.BoundingBox=C,t._parse=ie,t.parse=Rr,t.load=function(e,t){("undefined"==typeof window?Er:Ar)(e,(function(e,r){if(e)return t(e);var n;try{n=Rr(r)}catch(e){return t(e,null)}return t(null,n)}))},t.loadSync=function(t){return Rr(_t(e("fs").readFileSync(t)))},Object.defineProperty(t,"__esModule",{value:!0})},i("object"==typeof r&&void 0!==t?r:this.opentype={})}).call(this,e("buffer").Buffer)},{buffer:4,fs:2}],242:[function(e,t,r){(function(e){function t(e,t){for(var r=0,n=e.length-1;0<=n;n--){var i=e[n];"."===i?e.splice(n,1):".."===i?(e.splice(n,1),r++):r&&(e.splice(n,1),r--)}if(t)for(;r--;)e.unshift("..");return e}function n(e,t){if(e.filter)return e.filter(t);for(var r=[],n=0;n<e.length;n++)t(e[n],n,e)&&r.push(e[n]);return r}r.resolve=function(){for(var r="",i=!1,s=arguments.length-1;-1<=s&&!i;s--){var o=0<=s?arguments[s]:e.cwd();if("string"!=typeof o)throw new TypeError("Arguments to path.resolve must be strings");o&&(r=o+"/"+r,i="/"===o.charAt(0))}return(i?"/":"")+(r=t(n(r.split("/"),(function(e){return!!e})),!i).join("/"))||"."},r.normalize=function(e){var s=r.isAbsolute(e),o="/"===i(e,-1);return(e=(e=t(n(e.split("/"),(function(e){return!!e})),!s).join("/"))||s?e:".")&&o&&(e+="/"),(s?"/":"")+e},r.isAbsolute=function(e){return"/"===e.charAt(0)},r.join=function(){var e=Array.prototype.slice.call(arguments,0);return r.normalize(n(e,(function(e,t){if("string"!=typeof e)throw new TypeError("Arguments to path.join must be strings");return e})).join("/"))},r.relative=function(e,t){function n(e){for(var t=0;t<e.length&&""===e[t];t++);for(var r=e.length-1;0<=r&&""===e[r];r--);return r<t?[]:e.slice(t,r-t+1)}e=r.resolve(e).substr(1),t=r.resolve(t).substr(1);for(var i=n(e.split("/")),s=n(t.split("/")),o=Math.min(i.length,s.length),a=o,l=0;l<o;l++)if(i[l]!==s[l]){a=l;break}var c=[];for(l=a;l<i.length;l++)c.push("..");return(c=c.concat(s.slice(a))).join("/")},r.sep="/",r.delimiter=":",r.dirname=function(e){if("string"!=typeof e&&(e+=""),0===e.length)return".";for(var t=47===e.charCodeAt(0),r=-1,n=!0,i=e.length-1;1<=i;--i)if(47===e.charCodeAt(i)){if(!n){r=i;break}}else n=!1;return-1===r?t?"/":".":t&&1===r?"/":e.slice(0,r)},r.basename=function(e,t){return e=function(e){"string"!=typeof e&&(e+="");for(var t=0,r=-1,n=!0,i=e.length-1;0<=i;--i)if(47===e.charCodeAt(i)){if(!n){t=i+1;break}}else-1===r&&(n=!1,r=i+1);return-1===r?"":e.slice(t,r)}(e),t&&e.substr(-1*t.length)===t?e.substr(0,e.length-t.length):e},r.extname=function(e){"string"!=typeof e&&(e+="");for(var t=-1,r=0,n=-1,i=!0,s=0,o=e.length-1;0<=o;--o){var a=e.charCodeAt(o);if(47===a){if(i)continue;r=o+1;break}-1===n&&(i=!1,n=o+1),46===a?-1===t?t=o:1!==s&&(s=1):-1!==t&&(s=-1)}return-1===t||-1===n||0===s||1===s&&t===n-1&&t===r+1?"":e.slice(t,n)};var i=function(e,t,r){return e.substr(t,r)}}).call(this,e("_process"))},{_process:243}],243:[function(e,t,r){var n,i;t=t.exports={};function s(){throw new Error("setTimeout has not been defined")}function o(){throw new Error("clearTimeout has not been defined")}try{n="function"==typeof setTimeout?setTimeout:s}catch(e){n=s}try{i="function"==typeof clearTimeout?clearTimeout:o}catch(e){i=o}function a(e){if(n===setTimeout)return setTimeout(e,0);if((n===s||!n)&&setTimeout)return(n=setTimeout)(e,0);try{return n(e,0)}catch(t){try{return n.call(null,e,0)}catch(t){return n.call(this,e,0)}}}var l,c=[],u=!1,h=-1;function d(){u&&l&&(u=!1,l.length?c=l.concat(c):h=-1,c.length&&p())}function p(){if(!u){for(var e=a(d),t=(u=!0,c.length);t;){for(l=c,c=[];++h<t;)l&&l[h].run();h=-1,t=c.length}l=null,u=!1,function(e){if(i===clearTimeout)return clearTimeout(e);if((i===o||!i)&&clearTimeout)return(i=clearTimeout)(e);try{i(e)}catch(t){try{return i.call(null,e)}catch(t){return i.call(this,e)}}}(e)}}function f(e,t){this.fun=e,this.array=t}function m(){}t.nextTick=function(e){var t=new Array(arguments.length-1);if(1<arguments.length)for(var r=1;r<arguments.length;r++)t[r-1]=arguments[r];c.push(new f(e,t)),1!==c.length||u||a(p)},f.prototype.run=function(){this.fun.apply(null,this.array)},t.title="browser",t.browser=!0,t.env={},t.argv=[],t.version="",t.versions={},t.on=m,t.addListener=m,t.once=m,t.off=m,t.removeListener=m,t.removeAllListeners=m,t.emit=m,t.prependListener=m,t.prependOnceListener=m,t.listeners=function(e){return[]},t.binding=function(e){throw new Error("process.binding is not supported")},t.cwd=function(){return"/"},t.chdir=function(e){throw new Error("process.chdir is not supported")},t.umask=function(){return 0}},{}],244:[function(e,t,r){t=function(e){"use strict";var t,r=Object.prototype,n=r.hasOwnProperty,i=(y="function"==typeof Symbol?Symbol:{}).iterator||"@@iterator",s=y.asyncIterator||"@@asyncIterator",o=y.toStringTag||"@@toStringTag";function a(e,r,n,i){var s,o,a,m;r=r&&r.prototype instanceof f?r:f,r=Object.create(r.prototype),i=new M(i||[]);return r._invoke=(s=e,o=n,a=i,m=c,function(e,r){if(m===h)throw new Error("Generator is already running");if(m===d){if("throw"===e)throw r;return E()}for(a.method=e,a.arg=r;;){var n=a.delegate;if(n&&(n=function e(r,n){var i=r.iterator[n.method];if(i===t){if(n.delegate=null,"throw"===n.method){if(r.iterator.return&&(n.method="return",n.arg=t,e(r,n),"throw"===n.method))return p;n.method="throw",n.arg=new TypeError("The iterator does not provide a 'throw' method")}return p}return"throw"===(i=l(i,r.iterator,n.arg)).type?(n.method="throw",n.arg=i.arg,n.delegate=null,p):(i=i.arg)?i.done?(n[r.resultName]=i.value,n.next=r.nextLoc,"return"!==n.method&&(n.method="next",n.arg=t),n.delegate=null,p):i:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,p)}(n,a),n)){if(n===p)continue;return n}if("next"===a.method)a.sent=a._sent=a.arg;else if("throw"===a.method){if(m===c)throw m=d,a.arg;a.dispatchException(a.arg)}else"return"===a.method&&a.abrupt("return",a.arg);if(m=h,"normal"===(n=l(s,o,a)).type){if(m=a.done?d:u,n.arg!==p)return{value:n.arg,done:a.done}}else"throw"===n.type&&(m=d,a.method="throw",a.arg=n.arg)}}),r}function l(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}e.wrap=a;var c="suspendedStart",u="suspendedYield",h="executing",d="completed",p={};function f(){}function m(){}function g(){}var y,v,_=((v=(v=((y={})[i]=function(){return this},Object.getPrototypeOf))&&v(v(T([]))))&&v!==r&&n.call(v,i)&&(y=v),g.prototype=f.prototype=Object.create(y));function x(e){["next","throw","return"].forEach((function(t){e[t]=function(e){return this._invoke(t,e)}}))}function b(e){var t;this._invoke=function(r,i){function s(){return new Promise((function(t,s){!function t(r,i,s,o){var a;if("throw"!==(r=l(e[r],e,i)).type)return(i=(a=r.arg).value)&&"object"==typeof i&&n.call(i,"__await")?Promise.resolve(i.__await).then((function(e){t("next",e,s,o)}),(function(e){t("throw",e,s,o)})):Promise.resolve(i).then((function(e){a.value=e,s(a)}),(function(e){return t("throw",e,s,o)}));o(r.arg)}(r,i,t,s)}))}return t=t?t.then(s,s):s()}}function w(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function S(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function M(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(w,this),this.reset(!0)}function T(e){if(e){var r,s=e[i];if(s)return s.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length))return r=-1,(s=function i(){for(;++r<e.length;)if(n.call(e,r))return i.value=e[r],i.done=!1,i;return i.value=t,i.done=!0,i}).next=s}return{next:E}}function E(){return{value:t,done:!0}}return(m.prototype=_.constructor=g).constructor=m,g[o]=m.displayName="GeneratorFunction",e.isGeneratorFunction=function(e){return!!(e="function"==typeof e&&e.constructor)&&(e===m||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,g):(e.__proto__=g,o in e||(e[o]="GeneratorFunction")),e.prototype=Object.create(_),e},e.awrap=function(e){return{__await:e}},x(b.prototype),b.prototype[s]=function(){return this},e.AsyncIterator=b,e.async=function(t,r,n,i){var s=new b(a(t,r,n,i));return e.isGeneratorFunction(r)?s:s.next().then((function(e){return e.done?e.value:s.next()}))},x(_),_[o]="Generator",_[i]=function(){return this},_.toString=function(){return"[object Generator]"},e.keys=function(e){var t,r=[];for(t in e)r.push(t);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},e.values=T,M.prototype={constructor:M,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(S),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function i(n,i){return a.type="throw",a.arg=e,r.next=n,i&&(r.method="next",r.arg=t),!!i}for(var s=this.tryEntries.length-1;0<=s;--s){var o=this.tryEntries[s],a=o.completion;if("root"===o.tryLoc)return i("end");if(o.tryLoc<=this.prev){var l=n.call(o,"catchLoc"),c=n.call(o,"finallyLoc");if(l&&c){if(this.prev<o.catchLoc)return i(o.catchLoc,!0);if(this.prev<o.finallyLoc)return i(o.finallyLoc)}else if(l){if(this.prev<o.catchLoc)return i(o.catchLoc,!0)}else{if(!c)throw new Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return i(o.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;0<=r;--r){var i=this.tryEntries[r];if(i.tryLoc<=this.prev&&n.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var s=i;break}}var o=(s=s&&("break"===e||"continue"===e)&&s.tryLoc<=t&&t<=s.finallyLoc?null:s)?s.completion:{};return o.type=e,o.arg=t,s?(this.method="next",this.next=s.finallyLoc,p):this.complete(o)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),p},finish:function(e){for(var t=this.tryEntries.length-1;0<=t;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),S(r),p}},catch:function(e){for(var t=this.tryEntries.length-1;0<=t;--t){var r,n,i=this.tryEntries[t];if(i.tryLoc===e)return"throw"===(r=i.completion).type&&(n=r.arg,S(i)),n}throw new Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={iterator:T(e),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=t),p}},e}("object"==typeof t?t.exports:{});try{regeneratorRuntime=t}catch(e){Function("r","regeneratorRuntime = r")(t)}},{}],245:[function(e,t,r){!function(e){"use strict";var t,r,n,i,s,o,a,l,c,u;function h(e){if("string"!=typeof e&&(e=String(e)),/[^a-z0-9\-#$%&'*+.\^_`|~]/i.test(e))throw new TypeError("Invalid character in header field name");return e.toLowerCase()}function d(e){return"string"!=typeof e?String(e):e}function p(e){var t={next:function(){var t=e.shift();return{done:void 0===t,value:t}}};return r&&(t[Symbol.iterator]=function(){return t}),t}function f(e){this.map={},e instanceof f?e.forEach((function(e,t){this.append(t,e)}),this):Array.isArray(e)?e.forEach((function(e){this.append(e[0],e[1])}),this):e&&Object.getOwnPropertyNames(e).forEach((function(t){this.append(t,e[t])}),this)}function m(e){if(e.bodyUsed)return Promise.reject(new TypeError("Already read"));e.bodyUsed=!0}function g(e){return new Promise((function(t,r){e.onload=function(){t(e.result)},e.onerror=function(){r(e.error)}}))}function y(e){var t=new FileReader,r=g(t);return t.readAsArrayBuffer(e),r}function v(e){var t;return e.slice?e.slice(0):((t=new Uint8Array(e.byteLength)).set(new Uint8Array(e)),t.buffer)}function _(){return this.bodyUsed=!1,this._initBody=function(e){if(this._bodyInit=e)if("string"==typeof e)this._bodyText=e;else if(n&&Blob.prototype.isPrototypeOf(e))this._bodyBlob=e;else if(i&&FormData.prototype.isPrototypeOf(e))this._bodyFormData=e;else if(t&&URLSearchParams.prototype.isPrototypeOf(e))this._bodyText=e.toString();else if(s&&n&&a(e))this._bodyArrayBuffer=v(e.buffer),this._bodyInit=new Blob([this._bodyArrayBuffer]);else{if(!s||!ArrayBuffer.prototype.isPrototypeOf(e)&&!l(e))throw new Error("unsupported BodyInit type");this._bodyArrayBuffer=v(e)}else this._bodyText="";this.headers.get("content-type")||("string"==typeof e?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):t&&URLSearchParams.prototype.isPrototypeOf(e)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},n&&(this.blob=function(){var e=m(this);if(e)return e;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(new Blob([this._bodyArrayBuffer]));if(this._bodyFormData)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this._bodyText]))},this.arrayBuffer=function(){return this._bodyArrayBuffer?m(this)||Promise.resolve(this._bodyArrayBuffer):this.blob().then(y)}),this.text=function(){var e,t,r=m(this);if(r)return r;if(this._bodyBlob)return r=this._bodyBlob,t=g(e=new FileReader),e.readAsText(r),t;if(this._bodyArrayBuffer)return Promise.resolve(function(e){for(var t=new Uint8Array(e),r=new Array(t.length),n=0;n<t.length;n++)r[n]=String.fromCharCode(t[n]);return r.join("")}(this._bodyArrayBuffer));if(this._bodyFormData)throw new Error("could not read FormData body as text");return Promise.resolve(this._bodyText)},i&&(this.formData=function(){return this.text().then(b)}),this.json=function(){return this.text().then(JSON.parse)},this}function x(e,t){var r,n=(t=t||{}).body;if(e instanceof x){if(e.bodyUsed)throw new TypeError("Already read");this.url=e.url,this.credentials=e.credentials,t.headers||(this.headers=new f(e.headers)),this.method=e.method,this.mode=e.mode,n||null==e._bodyInit||(n=e._bodyInit,e.bodyUsed=!0)}else this.url=String(e);if(this.credentials=t.credentials||this.credentials||"omit",!t.headers&&this.headers||(this.headers=new f(t.headers)),this.method=(r=(e=t.method||this.method||"GET").toUpperCase(),-1<c.indexOf(r)?r:e),this.mode=t.mode||this.mode||null,this.referrer=null,("GET"===this.method||"HEAD"===this.method)&&n)throw new TypeError("Body not allowed for GET or HEAD requests");this._initBody(n)}function b(e){var t=new FormData;return e.trim().split("&").forEach((function(e){var r;e&&(r=(e=e.split("=")).shift().replace(/\+/g," "),e=e.join("=").replace(/\+/g," "),t.append(decodeURIComponent(r),decodeURIComponent(e)))})),t}function w(e,t){t=t||{},this.type="default",this.status=void 0===t.status?200:t.status,this.ok=200<=this.status&&this.status<300,this.statusText="statusText"in t?t.statusText:"OK",this.headers=new f(t.headers),this.url=t.url||"",this._initBody(e)}e.fetch||(t="URLSearchParams"in e,r="Symbol"in e&&"iterator"in Symbol,n="FileReader"in e&&"Blob"in e&&function(){try{return new Blob,!0}catch(e){return!1}}(),i="FormData"in e,(s="ArrayBuffer"in e)&&(o=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],a=function(e){return e&&DataView.prototype.isPrototypeOf(e)},l=ArrayBuffer.isView||function(e){return e&&-1<o.indexOf(Object.prototype.toString.call(e))}),f.prototype.append=function(e,t){e=h(e),t=d(t);var r=this.map[e];this.map[e]=r?r+","+t:t},f.prototype.delete=function(e){delete this.map[h(e)]},f.prototype.get=function(e){return e=h(e),this.has(e)?this.map[e]:null},f.prototype.has=function(e){return this.map.hasOwnProperty(h(e))},f.prototype.set=function(e,t){this.map[h(e)]=d(t)},f.prototype.forEach=function(e,t){for(var r in this.map)this.map.hasOwnProperty(r)&&e.call(t,this.map[r],r,this)},f.prototype.keys=function(){var e=[];return this.forEach((function(t,r){e.push(r)})),p(e)},f.prototype.values=function(){var e=[];return this.forEach((function(t){e.push(t)})),p(e)},f.prototype.entries=function(){var e=[];return this.forEach((function(t,r){e.push([r,t])})),p(e)},r&&(f.prototype[Symbol.iterator]=f.prototype.entries),c=["DELETE","GET","HEAD","OPTIONS","POST","PUT"],x.prototype.clone=function(){return new x(this,{body:this._bodyInit})},_.call(x.prototype),_.call(w.prototype),w.prototype.clone=function(){return new w(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new f(this.headers),url:this.url})},w.error=function(){var e=new w(null,{status:0,statusText:""});return e.type="error",e},u=[301,302,303,307,308],w.redirect=function(e,t){if(-1===u.indexOf(t))throw new RangeError("Invalid status code");return new w(null,{status:t,headers:{location:e}})},e.Headers=f,e.Request=x,e.Response=w,e.fetch=function(e,t){return new Promise((function(r,i){var s=new x(e,t),o=new XMLHttpRequest;o.onload=function(){var e,t={status:o.status,statusText:o.statusText,headers:(t=o.getAllResponseHeaders()||"",e=new f,t.replace(/\r?\n[\t ]+/g," ").split(/\r?\n/).forEach((function(t){var r=(t=t.split(":")).shift().trim();r&&(t=t.join(":").trim(),e.append(r,t))})),e)},n=(t.url="responseURL"in o?o.responseURL:t.headers.get("X-Request-URL"),"response"in o?o.response:o.responseText);r(new w(n,t))},o.onerror=function(){i(new TypeError("Network request failed"))},o.ontimeout=function(){i(new TypeError("Network request failed"))},o.open(s.method,s.url,!0),"include"===s.credentials?o.withCredentials=!0:"omit"===s.credentials&&(o.withCredentials=!1),"responseType"in o&&n&&(o.responseType="blob"),s.headers.forEach((function(e,t){o.setRequestHeader(t,e)})),o.send(void 0===s._bodyInit?null:s._bodyInit)}))},e.fetch.polyfill=!0)}("undefined"!=typeof self?self:this)},{}],246:[function(e,t,r){"use strict";e("core-js/modules/es.function.name"),e("core-js/modules/es.object.to-string"),e("core-js/modules/es.regexp.exec"),e("core-js/modules/es.regexp.to-string"),e("core-js/modules/es.string.split"),e("core-js/modules/es.function.name"),e("core-js/modules/es.object.to-string"),e("core-js/modules/es.regexp.exec"),e("core-js/modules/es.regexp.to-string"),e("core-js/modules/es.string.split"),Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n,i=o(e("../core/main")),s=o(e("../color/color_conversion"));function o(e){return e&&e.__esModule?e:{default:e}}var a=[{h:0,s:0,b:.8275,name:"gray"},{h:0,s:0,b:.8627,name:"gray"},{h:0,s:0,b:.7529,name:"gray"},{h:.0167,s:.1176,b:1,name:"light pink"}],l=[{h:0,s:0,b:0,name:"black"},{h:0,s:0,b:.5,name:"gray"},{h:0,s:0,b:1,name:"white"},{h:0,s:.5,b:.5,name:"dark maroon"},{h:0,s:.5,b:1,name:"salmon pink"},{h:0,s:1,b:0,name:"black"},{h:0,s:1,b:.5,name:"dark red"},{h:0,s:1,b:1,name:"red"},{h:5,s:0,b:1,name:"very light peach"},{h:5,s:.5,b:.5,name:"brown"},{h:5,s:.5,b:1,name:"peach"},{h:5,s:1,b:.5,name:"brick red"},{h:5,s:1,b:1,name:"crimson"},{h:10,s:0,b:1,name:"light peach"},{h:10,s:.5,b:.5,name:"brown"},{h:10,s:.5,b:1,name:"light orange"},{h:10,s:1,b:.5,name:"brown"},{h:10,s:1,b:1,name:"orange"},{h:15,s:0,b:1,name:"very light yellow"},{h:15,s:.5,b:.5,name:"olive green"},{h:15,s:.5,b:1,name:"light yellow"},{h:15,s:1,b:0,name:"dark olive green"},{h:15,s:1,b:.5,name:"olive green"},{h:15,s:1,b:1,name:"yellow"},{h:20,s:0,b:1,name:"very light yellow"},{h:20,s:.5,b:.5,name:"olive green"},{h:20,s:.5,b:1,name:"light yellow green"},{h:20,s:1,b:0,name:"dark olive green"},{h:20,s:1,b:.5,name:"dark yellow green"},{h:20,s:1,b:1,name:"yellow green"},{h:25,s:.5,b:.5,name:"dark yellow green"},{h:25,s:.5,b:1,name:"light green"},{h:25,s:1,b:.5,name:"dark green"},{h:25,s:1,b:1,name:"green"},{h:30,s:.5,b:1,name:"light green"},{h:30,s:1,b:.5,name:"dark green"},{h:30,s:1,b:1,name:"green"},{h:35,s:0,b:.5,name:"light green"},{h:35,s:0,b:1,name:"very light green"},{h:35,s:.5,b:.5,name:"dark green"},{h:35,s:.5,b:1,name:"light green"},{h:35,s:1,b:0,name:"very dark green"},{h:35,s:1,b:.5,name:"dark green"},{h:35,s:1,b:1,name:"green"},{h:40,s:0,b:1,name:"very light green"},{h:40,s:.5,b:.5,name:"dark green"},{h:40,s:.5,b:1,name:"light green"},{h:40,s:1,b:.5,name:"dark green"},{h:40,s:1,b:1,name:"green"},{h:45,s:.5,b:1,name:"light turquoise"},{h:45,s:1,b:.5,name:"dark turquoise"},{h:45,s:1,b:1,name:"turquoise"},{h:50,s:0,b:1,name:"light sky blue"},{h:50,s:.5,b:.5,name:"dark cyan"},{h:50,s:.5,b:1,name:"light cyan"},{h:50,s:1,b:.5,name:"dark cyan"},{h:50,s:1,b:1,name:"cyan"},{h:55,s:0,b:1,name:"light sky blue"},{h:55,s:.5,b:1,name:"light sky blue"},{h:55,s:1,b:.5,name:"dark blue"},{h:55,s:1,b:1,name:"sky blue"},{h:60,s:0,b:.5,name:"gray"},{h:60,s:0,b:1,name:"very light blue"},{h:60,s:.5,b:.5,name:"blue"},{h:60,s:.5,b:1,name:"light blue"},{h:60,s:1,b:.5,name:"navy blue"},{h:60,s:1,b:1,name:"blue"},{h:65,s:0,b:1,name:"lavender"},{h:65,s:.5,b:.5,name:"navy blue"},{h:65,s:.5,b:1,name:"light purple"},{h:65,s:1,b:.5,name:"dark navy blue"},{h:65,s:1,b:1,name:"blue"},{h:70,s:0,b:1,name:"lavender"},{h:70,s:.5,b:.5,name:"navy blue"},{h:70,s:.5,b:1,name:"lavender blue"},{h:70,s:1,b:.5,name:"dark navy blue"},{h:70,s:1,b:1,name:"blue"},{h:75,s:.5,b:1,name:"lavender"},{h:75,s:1,b:.5,name:"dark purple"},{h:75,s:1,b:1,name:"purple"},{h:80,s:.5,b:1,name:"pinkish purple"},{h:80,s:1,b:.5,name:"dark purple"},{h:80,s:1,b:1,name:"purple"},{h:85,s:0,b:1,name:"light pink"},{h:85,s:.5,b:.5,name:"purple"},{h:85,s:.5,b:1,name:"light fuchsia"},{h:85,s:1,b:.5,name:"dark fuchsia"},{h:85,s:1,b:1,name:"fuchsia"},{h:90,s:.5,b:.5,name:"dark fuchsia"},{h:90,s:.5,b:1,name:"hot pink"},{h:90,s:1,b:.5,name:"dark fuchsia"},{h:90,s:1,b:1,name:"fuchsia"},{h:95,s:0,b:1,name:"pink"},{h:95,s:.5,b:1,name:"light pink"},{h:95,s:1,b:.5,name:"dark magenta"},{h:95,s:1,b:1,name:"magenta"}];i.default.prototype._rgbColorName=function(e){e=s.default._rgbaToHSBA(e);var t,r,i=[(n=e)[0],e[1],e[2]];0!==i[0]&&(i[0]=Math.round(100*i[0]),(e=i[0].toString().split(""))[r=e.length-1]=parseInt(e[r]),e[r]<2.5?e[r]=0:2.5<=e[r]&&e[r]<7.5&&(e[r]=5),2===e.length?(e[0]=parseInt(e[0]),7.5<=e[r]&&(e[r]=0,e[0]=e[0]+1),i[0]=10*e[0]+e[1]):7.5<=e[r]?i[0]=10:i[0]=e[r]),i[2]=i[2]/255;for(var o=i.length-1;1<=o;o--)i[o]<=.25?i[o]=0:.25<i[o]&&i[o]<.75?i[o]=.5:i[o]=1;if(0===i[0]&&0===i[1]&&1===i[2]){for(var c=2;0<=c;c--)n[c]=Math.round(1e4*n[c])/1e4;for(var u=0;u<a.length;u++){if(a[u].h===n[0]&&a[u].s===n[1]&&a[u].b===n[2]){t=a[u].name;break}t="white"}}else for(var h=0;h<l.length;h++)if(l[h].h===i[0]&&l[h].s===i[1]&&l[h].b===i[2]){t=l[h].name;break}return t},e=i.default,r.default=e},{"../color/color_conversion":252,"../core/main":267,"core-js/modules/es.function.name":165,"core-js/modules/es.object.to-string":177,"core-js/modules/es.regexp.exec":181,"core-js/modules/es.regexp.to-string":182,"core-js/modules/es.string.split":191}],247:[function(e,t,r){"use strict";e("core-js/modules/es.array.concat"),e("core-js/modules/es.regexp.exec"),e("core-js/modules/es.string.ends-with"),e("core-js/modules/es.string.replace"),e("core-js/modules/es.array.concat"),e("core-js/modules/es.regexp.exec"),e("core-js/modules/es.string.ends-with"),e("core-js/modules/es.string.replace"),Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n=(e=e("../core/main"))&&e.__esModule?e:{default:e},i="_Description",s="_fallbackDesc",o="_fallbackTable",a="_Label",l="_labelDesc",c="_labelTable";function u(e){if("label"===e||"fallback"===e)throw new Error("description should not be LABEL or FALLBACK");return e.endsWith(".")||e.endsWith(";")||e.endsWith(",")||e.endsWith("?")||e.endsWith("!")||(e+="."),e}n.default.prototype.describe=function(e,t){var r;n.default._validateParameters("describe",arguments),"string"==typeof e&&(r=this.canvas.id,e=u(e),this.dummyDOM||(this.dummyDOM=document.getElementById(r).parentNode),this.descriptions||(this.descriptions={}),this.descriptions.fallback?this.descriptions.fallback.innerHTML!==e&&(this.descriptions.fallback.innerHTML=e):this._describeHTML("fallback",e),t===this.LABEL&&(this.descriptions.label?this.descriptions.label.innerHTML!==e&&(this.descriptions.label.innerHTML=e):this._describeHTML("label",e)))},n.default.prototype.describeElement=function(e,t,r){var i,s;n.default._validateParameters("describeElement",arguments),"string"==typeof t&&"string"==typeof e&&(i=this.canvas.id,t=u(t),s=function(e){if("label"===e||"fallback"===e)throw new Error("element name should not be LABEL or FALLBACK");return e.endsWith(".")||e.endsWith(";")||e.endsWith(",")?e=e.replace(/.$/,":"):e.endsWith(":")||(e+=":"),e}(e),e=e.replace(/[^a-zA-Z0-9]/g,""),s='<th scope="row">'.concat(s,"</th><td>").concat(t,"</td>"),this.dummyDOM||(this.dummyDOM=document.getElementById(i).parentNode),this.descriptions?this.descriptions.fallbackElements||(this.descriptions.fallbackElements={}):this.descriptions={fallbackElements:{}},this.descriptions.fallbackElements[e]?this.descriptions.fallbackElements[e].innerHTML!==s&&(this.descriptions.fallbackElements[e].innerHTML=s):this._describeElementHTML("fallback",e,s),r===this.LABEL&&(this.descriptions.labelElements||(this.descriptions.labelElements={}),this.descriptions.labelElements[e]?this.descriptions.labelElements[e].innerHTML!==s&&(this.descriptions.labelElements[e].innerHTML=s):this._describeElementHTML("label",e,s)))},n.default.prototype._describeHTML=function(e,t){var r,n=this.canvas.id;"fallback"===e?(this.dummyDOM.querySelector("#".concat(n+i))?this.dummyDOM.querySelector("#"+n+o).insertAdjacentHTML("beforebegin",'<p id="'.concat(n+s,'"></p>')):(r='<div id="'.concat(n).concat(i,'" role="region" aria-label="Canvas Description"><p id="').concat(n).concat(s,'"></p></div>'),this.dummyDOM.querySelector("#".concat(n,"accessibleOutput"))?this.dummyDOM.querySelector("#".concat(n,"accessibleOutput")).insertAdjacentHTML("beforebegin",r):this.dummyDOM.querySelector("#".concat(n)).innerHTML=r),this.descriptions.fallback=this.dummyDOM.querySelector("#".concat(n).concat(s)),this.descriptions.fallback.innerHTML=t):"label"===e&&(this.dummyDOM.querySelector("#".concat(n+a))?this.dummyDOM.querySelector("#".concat(n+c))&&this.dummyDOM.querySelector("#".concat(n+c)).insertAdjacentHTML("beforebegin",'<p id="'.concat(n).concat(l,'"></p>')):(r='<div id="'.concat(n).concat(a,'" class="p5Label"><p id="').concat(n).concat(l,'"></p></div>'),this.dummyDOM.querySelector("#".concat(n,"accessibleOutputLabel"))?this.dummyDOM.querySelector("#".concat(n,"accessibleOutputLabel")).insertAdjacentHTML("beforebegin",r):this.dummyDOM.querySelector("#"+n).insertAdjacentHTML("afterend",r)),this.descriptions.label=this.dummyDOM.querySelector("#"+n+l),this.descriptions.label.innerHTML=t)},n.default.prototype._describeElementHTML=function(e,t,r){var n,u=this.canvas.id;"fallback"===e?(this.dummyDOM.querySelector("#".concat(u+i))?this.dummyDOM.querySelector("#"+u+o)||this.dummyDOM.querySelector("#"+u+s).insertAdjacentHTML("afterend",'<table id="'.concat(u).concat(o,'"><caption>Canvas elements and their descriptions</caption></table>')):(n='<div id="'.concat(u).concat(i,'" role="region" aria-label="Canvas Description"><table id="').concat(u).concat(o,'"><caption>Canvas elements and their descriptions</caption></table></div>'),this.dummyDOM.querySelector("#".concat(u,"accessibleOutput"))?this.dummyDOM.querySelector("#".concat(u,"accessibleOutput")).insertAdjacentHTML("beforebegin",n):this.dummyDOM.querySelector("#"+u).innerHTML=n),(n=document.createElement("tr")).id=u+"_fte_"+t,this.dummyDOM.querySelector("#"+u+o).appendChild(n),this.descriptions.fallbackElements[t]=this.dummyDOM.querySelector("#".concat(u).concat("_fte_").concat(t)),this.descriptions.fallbackElements[t].innerHTML=r):"label"===e&&(this.dummyDOM.querySelector("#".concat(u+a))?this.dummyDOM.querySelector("#".concat(u+c))||this.dummyDOM.querySelector("#"+u+l).insertAdjacentHTML("afterend",'<table id="'.concat(u+c,'"></table>')):(n='<div id="'.concat(u).concat(a,'" class="p5Label"><table id="').concat(u).concat(c,'"></table></div>'),this.dummyDOM.querySelector("#".concat(u,"accessibleOutputLabel"))?this.dummyDOM.querySelector("#".concat(u,"accessibleOutputLabel")).insertAdjacentHTML("beforebegin",n):this.dummyDOM.querySelector("#"+u).insertAdjacentHTML("afterend",n)),(e=document.createElement("tr")).id=u+"_lte_"+t,this.dummyDOM.querySelector("#"+u+c).appendChild(e),this.descriptions.labelElements[t]=this.dummyDOM.querySelector("#".concat(u).concat("_lte_").concat(t)),this.descriptions.labelElements[t].innerHTML=r)},e=n.default,r.default=e},{"../core/main":267,"core-js/modules/es.array.concat":149,"core-js/modules/es.regexp.exec":181,"core-js/modules/es.string.ends-with":184,"core-js/modules/es.string.replace":189}],248:[function(e,t,r){"use strict";e("core-js/modules/es.array.concat"),e("core-js/modules/es.array.map"),e("core-js/modules/es.array.concat"),e("core-js/modules/es.array.map"),Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0,(e=(e=e("../core/main"))&&e.__esModule?e:{default:e}).default.prototype._updateGridOutput=function(e){var t,r,n,i;this.dummyDOM.querySelector("#".concat(e,"_summary"))&&(t=this._accessibleOutputs[e],n=function(e,t,r,n){return t="".concat(t," canvas, ").concat(r," by ").concat(n," pixels, contains ").concat(e[0]),t=(1===e[0]?"".concat(t," shape: "):"".concat(t," shapes: ")).concat(e[1])}((r=function(e,t){var r,n="",i="",s=0;for(r in t){var o,a=0;for(o in t[r]){var l='<li id="'.concat(e,"shape").concat(s,'">').concat(t[r][o].color," ").concat(r,",");"line"===r?l+=" location = ".concat(t[r][o].pos,", length = ").concat(t[r][o].length," pixels"):(l+=" location = ".concat(t[r][o].pos),"point"!==r&&(l+=", area = ".concat(t[r][o].area," %")),l+="</li>"),n+=l,a++,s++}i=1<a?"".concat(i," ").concat(a," ").concat(r,"s"):"".concat(i," ").concat(a," ").concat(r)}return{numShapes:[s,i],details:n}}(e,this.ingredients.shapes)).numShapes,this.ingredients.colors.background,this.width,this.height),i=function(e,t){var r,n,i,s=0,o="",a=Array.apply(null,Array(10)).map((function(){}));for(r in a)a[r]=Array.apply(null,Array(10)).map((function(){}));for(n in t)for(var l in t[n]){var c;c="line"!==n?'<a href="#'.concat(e,"shape").concat(s,'">').concat(t[n][l].color," ").concat(n,"</a>"):'<a href="#'.concat(e,"shape").concat(s,'">').concat(t[n][l].color," ").concat(n," midpoint</a>"),a[t[n][l].loc.locY][t[n][l].loc.locX]?a[t[n][l].loc.locY][t[n][l].loc.locX]=a[t[n][l].loc.locY][t[n][l].loc.locX]+"  "+c:a[t[n][l].loc.locY][t[n][l].loc.locX]=c,s++}for(i in a){var u,h="<tr>";for(u in a[i])h+="<td>",void 0!==a[i][u]&&(h+=a[i][u]),h+="</td>";o=o+h+"</tr>"}return o}(e,this.ingredients.shapes),n!==t.summary.innerHTML&&(t.summary.innerHTML=n),i!==t.map.innerHTML&&(t.map.innerHTML=i),r.details!==t.shapeDetails.innerHTML&&(t.shapeDetails.innerHTML=r.details),this._accessibleOutputs[e]=t)},e=e.default,r.default=e},{"../core/main":267,"core-js/modules/es.array.concat":149,"core-js/modules/es.array.map":161}],249:[function(e,t,r){"use strict";e("core-js/modules/es.array.concat"),e("core-js/modules/es.array.fill"),e("core-js/modules/es.array.map"),e("core-js/modules/es.number.to-fixed"),e("core-js/modules/es.array.concat"),e("core-js/modules/es.array.fill"),e("core-js/modules/es.array.map"),e("core-js/modules/es.number.to-fixed"),Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n=(e=e("../core/main"))&&e.__esModule?e:{default:e};function i(e,t,r){return e[0]<.4*t?e[1]<.4*r?"top left":e[1]>.6*r?"bottom left":"mid left":e[0]>.6*t?e[1]<.4*r?"top right":e[1]>.6*r?"bottom right":"mid right":e[1]<.4*r?"top middle":e[1]>.6*r?"bottom middle":"middle"}function s(e,t,r){return 10===(t=Math.floor(e[0]/t*10))&&(t-=1),10===(e=Math.floor(e[1]/r*10))&&(e-=1),{locX:t,locY:e}}n.default.prototype.textOutput=function(e){n.default._validateParameters("textOutput",arguments),this._accessibleOutputs.text||(this._accessibleOutputs.text=!0,this._createOutput("textOutput","Fallback"),e===this.LABEL&&(this._accessibleOutputs.textLabel=!0,this._createOutput("textOutput","Label")))},n.default.prototype.gridOutput=function(e){n.default._validateParameters("gridOutput",arguments),this._accessibleOutputs.grid||(this._accessibleOutputs.grid=!0,this._createOutput("gridOutput","Fallback"),e===this.LABEL&&(this._accessibleOutputs.gridLabel=!0,this._createOutput("gridOutput","Label")))},n.default.prototype._addAccsOutput=function(){return this._accessibleOutputs||(this._accessibleOutputs={text:!1,grid:!1,textLabel:!1,gridLabel:!1}),this._accessibleOutputs.grid||this._accessibleOutputs.text},n.default.prototype._createOutput=function(e,t){var r,n,i,s=this.canvas.id,o=(this.ingredients||(this.ingredients={shapes:{},colors:{background:"white",fill:"white",stroke:"black"},pShapes:""}),this.dummyDOM||(this.dummyDOM=document.getElementById(s).parentNode),"");"Fallback"===t?(r=s+e,this.dummyDOM.querySelector("#".concat(n=s+"accessibleOutput"))||(this.dummyDOM.querySelector("#".concat(s,"_Description"))?this.dummyDOM.querySelector("#".concat(s,"_Description")).insertAdjacentHTML("afterend",'<div id="'.concat(n,'" role="region" aria-label="Canvas Outputs"></div>')):this.dummyDOM.querySelector("#".concat(s)).innerHTML='<div id="'.concat(n,'" role="region" aria-label="Canvas Outputs"></div>'))):"Label"===t&&(r=s+e+(o=t),this.dummyDOM.querySelector("#".concat(n=s+"accessibleOutput"+t))||(this.dummyDOM.querySelector("#".concat(s,"_Label"))?this.dummyDOM.querySelector("#".concat(s,"_Label")):this.dummyDOM.querySelector("#".concat(s))).insertAdjacentHTML("afterend",'<div id="'.concat(n,'"></div>'))),this._accessibleOutputs[r]={},"textOutput"===e?(o="#".concat(s,"gridOutput").concat(o),i='<div id="'.concat(r,'">Text Output<div id="').concat(r,'Summary" aria-label="text output summary"><p id="').concat(r,'_summary"></p><ul id="').concat(r,'_list"></ul></div><table id="').concat(r,'_shapeDetails" summary="text output shape details"></table></div>'),this.dummyDOM.querySelector(o)?this.dummyDOM.querySelector(o).insertAdjacentHTML("beforebegin",i):this.dummyDOM.querySelector("#".concat(n)).innerHTML=i,this._accessibleOutputs[r].list=this.dummyDOM.querySelector("#".concat(r,"_list"))):"gridOutput"===e&&(o="#".concat(s,"textOutput").concat(o),i='<div id="'.concat(r,'">Grid Output<p id="').concat(r,'_summary" aria-label="grid output summary"><table id="').concat(r,'_map" summary="grid output content"></table><ul id="').concat(r,'_shapeDetails" aria-label="grid output shape details"></ul></div>'),this.dummyDOM.querySelector(o)?this.dummyDOM.querySelector(o).insertAdjacentHTML("afterend",i):this.dummyDOM.querySelector("#".concat(n)).innerHTML=i,this._accessibleOutputs[r].map=this.dummyDOM.querySelector("#".concat(r,"_map"))),this._accessibleOutputs[r].shapeDetails=this.dummyDOM.querySelector("#".concat(r,"_shapeDetails")),this._accessibleOutputs[r].summary=this.dummyDOM.querySelector("#".concat(r,"_summary"))},n.default.prototype._updateAccsOutput=function(){var e=this.canvas.id;JSON.stringify(this.ingredients.shapes)!==this.ingredients.pShapes&&(this.ingredients.pShapes=JSON.stringify(this.ingredients.shapes),this._accessibleOutputs.text&&this._updateTextOutput(e+"textOutput"),this._accessibleOutputs.grid&&this._updateGridOutput(e+"gridOutput"),this._accessibleOutputs.textLabel&&this._updateTextOutput(e+"textOutputLabel"),this._accessibleOutputs.gridLabel&&this._updateGridOutput(e+"gridOutputLabel"))},n.default.prototype._accsBackground=function(e){this.ingredients.pShapes=JSON.stringify(this.ingredients.shapes),this.ingredients.shapes={},this.ingredients.colors.backgroundRGBA!==e&&(this.ingredients.colors.backgroundRGBA=e,this.ingredients.colors.background=this._rgbColorName(e))},n.default.prototype._accsCanvasColors=function(e,t){"fill"===e?this.ingredients.colors.fillRGBA!==t&&(this.ingredients.colors.fillRGBA=t,this.ingredients.colors.fill=this._rgbColorName(t)):"stroke"===e&&this.ingredients.colors.strokeRGBA!==t&&(this.ingredients.colors.strokeRGBA=t,this.ingredients.colors.stroke=this._rgbColorName(t))},n.default.prototype._accsOutput=function(e,t){"ellipse"===e&&t[2]===t[3]?e="circle":"rectangle"===e&&t[2]===t[3]&&(e="square");var r,n,o={},a=!0,l=function(e,t){var r;return e="rectangle"===e||"ellipse"===e||"arc"===e||"circle"===e||"square"===e?(r=Math.round(t[0]+t[2]/2),Math.round(t[1]+t[3]/2)):"triangle"===e?(r=(t[0]+t[2]+t[4])/3,(t[1]+t[3]+t[5])/3):"quadrilateral"===e?(r=(t[0]+t[2]+t[4]+t[6])/4,(t[1]+t[3]+t[5]+t[7])/4):"line"===e?(r=(t[0]+t[2])/2,(t[1]+t[3])/2):(r=t[0],t[1]),[r,e]}(e,t);if("line"===e?(o.color=this.ingredients.colors.stroke,o.length=Math.round(this.dist(t[0],t[1],t[2],t[3])),r=i([t[0],[1]],this.width,this.height),n=i([t[2],[3]],this.width,this.height),o.loc=s(l,this.width,this.height),o.pos=r===n?"at ".concat(r):"from ".concat(r," to ").concat(n)):("point"===e?o.color=this.ingredients.colors.stroke:(o.color=this.ingredients.colors.fill,o.area=function(e,t,r,n){var i,s,o,a,l,c,u,h=0;return"arc"===e?(h=(i=((t[5]-t[4])%(2*Math.PI)+2*Math.PI)%(2*Math.PI))*t[2]*t[3]/8,"open"!==t[6]&&"chord"!==t[6]||(u=t[0],s=t[1],o=t[0]+t[2]/2*Math.cos(t[4]).toFixed(2),a=t[1]+t[3]/2*Math.sin(t[4]).toFixed(2),l=t[0]+t[2]/2*Math.cos(t[5]).toFixed(2),c=t[1]+t[3]/2*Math.sin(t[5]).toFixed(2),u=Math.abs(u*(a-c)+o*(c-s)+l*(s-a))/2,i>Math.PI?h+=u:h-=u)):"ellipse"===e||"circle"===e?h=3.14*t[2]/2*t[3]/2:"line"===e||"point"===e?h=0:"quadrilateral"===e?h=Math.abs((t[6]+t[0])*(t[7]-t[1])+(t[0]+t[2])*(t[1]-t[3])+(t[2]+t[4])*(t[3]-t[5])+(t[4]+t[6])*(t[5]-t[7]))/2:"rectangle"===e||"square"===e?h=t[2]*t[3]:"triangle"===e&&(h=Math.abs(t[0]*(t[3]-t[5])+t[2]*(t[5]-t[1])+t[4]*(t[1]-t[3]))/2),Math.round(100*h/(r*n))}(e,t,this.width,this.height)),o.pos=i(l,this.width,this.height),o.loc=s(l,this.width,this.height)),this.ingredients.shapes[e]){if(this.ingredients.shapes[e]!==[o]){for(var c in this.ingredients.shapes[e])JSON.stringify(this.ingredients.shapes[e][c])===JSON.stringify(o)&&(a=!1);!0===a&&this.ingredients.shapes[e].push(o)}}else this.ingredients.shapes[e]=[o]},e=n.default,r.default=e},{"../core/main":267,"core-js/modules/es.array.concat":149,"core-js/modules/es.array.fill":152,"core-js/modules/es.array.map":161,"core-js/modules/es.number.to-fixed":171}],250:[function(e,t,r){"use strict";e("core-js/modules/es.array.concat"),e("core-js/modules/es.array.concat"),Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0,(e=(e=e("../core/main"))&&e.__esModule?e:{default:e}).default.prototype._updateTextOutput=function(e){var t,r,n,i;this.dummyDOM.querySelector("#".concat(e,"_summary"))&&(t=this._accessibleOutputs[e],n=function(e,t,r,n){return r="Your output is a, ".concat(r," by ").concat(n," pixels, ").concat(t," canvas containing the following"),r=1===e?"".concat(r," shape:"):"".concat(r," ").concat(e," shapes:")}((r=function(e,t){var r,n="",i=0;for(r in t)for(var s in t[r]){var o='<li><a href="#'.concat(e,"shape").concat(i,'">').concat(t[r][s].color," ").concat(r,"</a>");"line"===r?o+=", ".concat(t[r][s].pos,", ").concat(t[r][s].length," pixels long.</li>"):(o+=", at ".concat(t[r][s].pos),"point"!==r&&(o+=", covering ".concat(t[r][s].area,"% of the canvas")),o+=".</li>"),n+=o,i++}return{numShapes:i,listShapes:n}}(e,this.ingredients.shapes)).numShapes,this.ingredients.colors.background,this.width,this.height),i=function(e,t){var r,n="",i=0;for(r in t)for(var s in t[r]){var o='<tr id="'.concat(e,"shape").concat(i,'"><th>').concat(t[r][s].color," ").concat(r,"</th>");"line"===r?o+="<td>location = ".concat(t[r][s].pos,"</td><td>length = ").concat(t[r][s].length," pixels</td></tr>"):(o+="<td>location = ".concat(t[r][s].pos,"</td>"),"point"!==r&&(o+="<td> area = ".concat(t[r][s].area,"%</td>")),o+="</tr>"),n+=o,i++}return n}(e,this.ingredients.shapes),n!==t.summary.innerHTML&&(t.summary.innerHTML=n),r.listShapes!==t.list.innerHTML&&(t.list.innerHTML=r.listShapes),i!==t.shapeDetails.innerHTML&&(t.shapeDetails.innerHTML=i),this._accessibleOutputs[e]=t)},e=e.default,r.default=e},{"../core/main":267,"core-js/modules/es.array.concat":149}],251:[function(e,t,r){"use strict";var n=(n=e("./core/main"))&&n.__esModule?n:{default:n};e("./core/constants"),e("./core/environment"),e("./core/friendly_errors/stacktrace"),e("./core/friendly_errors/validate_params"),e("./core/friendly_errors/file_errors"),e("./core/friendly_errors/fes_core"),e("./core/friendly_errors/sketch_reader"),e("./core/helpers"),e("./core/legacy"),e("./core/preload"),e("./core/p5.Element"),e("./core/p5.Graphics"),e("./core/p5.Renderer"),e("./core/p5.Renderer2D"),e("./core/rendering"),e("./core/shim"),e("./core/structure"),e("./core/transform"),e("./core/shape/2d_primitives"),e("./core/shape/attributes"),e("./core/shape/curves"),e("./core/shape/vertex"),e("./accessibility/outputs"),e("./accessibility/textOutput"),e("./accessibility/gridOutput"),e("./accessibility/color_namer"),e("./color/color_conversion"),e("./color/creating_reading"),e("./color/p5.Color"),e("./color/setting"),e("./data/p5.TypedDict"),e("./data/local_storage.js"),e("./dom/dom"),e("./accessibility/describe"),e("./events/acceleration"),e("./events/keyboard"),e("./events/mouse"),e("./events/touch"),e("./image/filters"),e("./image/image"),e("./image/loading_displaying"),e("./image/p5.Image"),e("./image/pixels"),e("./io/files"),e("./io/p5.Table"),e("./io/p5.TableRow"),e("./io/p5.XML"),e("./math/calculation"),e("./math/math"),e("./math/noise"),e("./math/p5.Vector"),e("./math/random"),e("./math/trigonometry"),e("./typography/attributes"),e("./typography/loading_displaying"),e("./typography/p5.Font"),e("./utilities/array_functions"),e("./utilities/conversion"),e("./utilities/string_functions"),e("./utilities/time_date"),e("./webgl/3d_primitives"),e("./webgl/interaction"),e("./webgl/light"),e("./webgl/loading"),e("./webgl/material"),e("./webgl/p5.Camera"),e("./webgl/p5.Geometry"),e("./webgl/p5.Matrix"),e("./webgl/p5.RendererGL.Immediate"),e("./webgl/p5.RendererGL"),e("./webgl/p5.RendererGL.Retained"),e("./webgl/p5.Shader"),e("./webgl/p5.RenderBuffer"),e("./webgl/p5.Texture"),e("./webgl/text"),e("./core/init"),t.exports=n.default},{"./accessibility/color_namer":246,"./accessibility/describe":247,"./accessibility/gridOutput":248,"./accessibility/outputs":249,"./accessibility/textOutput":250,"./color/color_conversion":252,"./color/creating_reading":253,"./color/p5.Color":254,"./color/setting":255,"./core/constants":256,"./core/environment":257,"./core/friendly_errors/fes_core":258,"./core/friendly_errors/file_errors":259,"./core/friendly_errors/sketch_reader":260,"./core/friendly_errors/stacktrace":261,"./core/friendly_errors/validate_params":262,"./core/helpers":263,"./core/init":264,"./core/legacy":266,"./core/main":267,"./core/p5.Element":268,"./core/p5.Graphics":269,"./core/p5.Renderer":270,"./core/p5.Renderer2D":271,"./core/preload":272,"./core/rendering":273,"./core/shape/2d_primitives":274,"./core/shape/attributes":275,"./core/shape/curves":276,"./core/shape/vertex":277,"./core/shim":278,"./core/structure":279,"./core/transform":280,"./data/local_storage.js":281,"./data/p5.TypedDict":282,"./dom/dom":283,"./events/acceleration":284,"./events/keyboard":285,"./events/mouse":286,"./events/touch":287,"./image/filters":288,"./image/image":289,"./image/loading_displaying":290,"./image/p5.Image":291,"./image/pixels":292,"./io/files":293,"./io/p5.Table":294,"./io/p5.TableRow":295,"./io/p5.XML":296,"./math/calculation":297,"./math/math":298,"./math/noise":299,"./math/p5.Vector":300,"./math/random":301,"./math/trigonometry":302,"./typography/attributes":303,"./typography/loading_displaying":304,"./typography/p5.Font":305,"./utilities/array_functions":306,"./utilities/conversion":307,"./utilities/string_functions":308,"./utilities/time_date":309,"./webgl/3d_primitives":310,"./webgl/interaction":311,"./webgl/light":312,"./webgl/loading":313,"./webgl/material":314,"./webgl/p5.Camera":315,"./webgl/p5.Geometry":316,"./webgl/p5.Matrix":317,"./webgl/p5.RenderBuffer":318,"./webgl/p5.RendererGL":321,"./webgl/p5.RendererGL.Immediate":319,"./webgl/p5.RendererGL.Retained":320,"./webgl/p5.Shader":322,"./webgl/p5.Texture":323,"./webgl/text":324}],252:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0,(e=(e=e("../core/main"))&&e.__esModule?e:{default:e}).default.ColorConversion={},e.default.ColorConversion._hsbaToHSLA=function(e){var t=e[0],r=e[1],n=e[2],i=(2-r)*n/2;return 0!=i&&(1==i?r=0:i<.5?r/=2-r:r=r*n/(2-2*i)),[t,r,i,e[3]]},e.default.ColorConversion._hsbaToRGBA=function(e){var t,r,n,i,s,o=6*e[0],a=e[1],l=e[2];return 0===a?[l,l,l,e[3]]:(r=l*(1-a),n=l*(1-a*(o-(t=Math.floor(o)))),a=l*(1-a*(1+t-o)),o=1===t?(i=n,s=l,r):2===t?(i=r,s=l,a):3===t?(i=r,s=n,l):4===t?(i=a,s=r,l):5===t?(i=l,s=r,n):(i=l,s=a,r),[i,s,o,e[3]])},e.default.ColorConversion._hslaToHSBA=function(e){var t=e[0],r=e[1],n=e[2],i=n<.5?(1+r)*n:n+r-n*r;return[t,r=2*(i-n)/i,i,e[3]]},e.default.ColorConversion._hslaToRGBA=function(e){var t,r=6*e[0],n=e[1],i=e[2];return 0===n?[i,i,i,e[3]]:[(t=function(e,t,r){return e<0?e+=6:6<=e&&(e-=6),e<1?t+(r-t)*e:e<3?r:e<4?t+(r-t)*(4-e):t})(2+r,n=2*i-(i=i<.5?(1+n)*i:i+n-i*n),i),t(r,n,i),t(r-2,n,i),e[3]]},e.default.ColorConversion._rgbaToHSBA=function(e){var t,r,n=e[0],i=e[1],s=e[2],o=Math.max(n,i,s),a=o-Math.min(n,i,s);return 0==a?r=t=0:(r=a/o,n===o?t=(i-s)/a:i===o?t=2+(s-n)/a:s===o&&(t=4+(n-i)/a),t<0?t+=6:6<=t&&(t-=6)),[t/6,r,o,e[3]]},e.default.ColorConversion._rgbaToHSLA=function(e){var t,r,n,i=e[0],s=e[1],o=e[2],a=Math.max(i,s,o),l=a+(n=Math.min(i,s,o));return 0==(n=a-n)?r=t=0:(r=l<1?n/l:n/(2-l),i===a?t=(s-o)/n:s===a?t=2+(o-i)/n:o===a&&(t=4+(i-s)/n),t<0?t+=6:6<=t&&(t-=6)),[t/6,r,l/2,e[3]]},e=e.default.ColorConversion,r.default=e},{"../core/main":267}],253:[function(e,t,r){"use strict";function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function i(e){return(i="function"==typeof Symbol&&"symbol"===n(Symbol.iterator)?function(e){return n(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":n(e)})(e)}e("core-js/modules/es.symbol"),e("core-js/modules/es.symbol.description"),e("core-js/modules/es.symbol.iterator"),e("core-js/modules/es.array.iterator"),e("core-js/modules/es.array.map"),e("core-js/modules/es.object.get-own-property-descriptor"),e("core-js/modules/es.object.to-string"),e("core-js/modules/es.string.iterator"),e("core-js/modules/es.weak-map"),e("core-js/modules/web.dom-collections.iterator"),e("core-js/modules/es.array.map"),Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var s=(l=e("../core/main"))&&l.__esModule?l:{default:l},o=function(e){if(e&&e.__esModule)return e;if(null===e||"object"!==i(e)&&"function"!=typeof e)return{default:e};var t=a();if(t&&t.has(e))return t.get(e);var r,n={},s=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(r in e){var o;Object.prototype.hasOwnProperty.call(e,r)&&((o=s?Object.getOwnPropertyDescriptor(e,r):null)&&(o.get||o.set)?Object.defineProperty(n,r,o):n[r]=e[r])}return n.default=e,t&&t.set(e,n),n}(e("../core/constants"));function a(){var e;return"function"!=typeof WeakMap?null:(e=new WeakMap,a=function(){return e},e)}e("./p5.Color"),e("../core/friendly_errors/validate_params"),e("../core/friendly_errors/file_errors"),e("../core/friendly_errors/fes_core"),s.default.prototype.alpha=function(e){return s.default._validateParameters("alpha",arguments),this.color(e)._getAlpha()},s.default.prototype.blue=function(e){return s.default._validateParameters("blue",arguments),this.color(e)._getBlue()},s.default.prototype.brightness=function(e){return s.default._validateParameters("brightness",arguments),this.color(e)._getBrightness()},s.default.prototype.color=function(){var e;return s.default._validateParameters("color",arguments),arguments[0]instanceof s.default.Color?arguments[0]:(e=arguments[0]instanceof Array?arguments[0]:arguments,new s.default.Color(this,e))},s.default.prototype.green=function(e){return s.default._validateParameters("green",arguments),this.color(e)._getGreen()},s.default.prototype.hue=function(e){return s.default._validateParameters("hue",arguments),this.color(e)._getHue()},s.default.prototype.lerpColor=function(e,t,r){s.default._validateParameters("lerpColor",arguments);var n,i,a,l=this._colorMode,c=this._colorMaxes;if(l===o.RGB)i=e.levels.map((function(e){return e/255})),a=t.levels.map((function(e){return e/255}));else if(l===o.HSB)e._getBrightness(),t._getBrightness(),i=e.hsba,a=t.hsba;else{if(l!==o.HSL)throw new Error("".concat(l,"cannot be used for interpolation."));e._getLightness(),t._getLightness(),i=e.hsla,a=t.hsla}return r=Math.max(Math.min(r,1),0),void 0===this.lerp&&(this.lerp=function(e,t,r){return r*(t-e)+e}),e=this.lerp(i[0],a[0],r),t=this.lerp(i[1],a[1],r),n=this.lerp(i[2],a[2],r),i=this.lerp(i[3],a[3],r),e*=c[l][0],t*=c[l][1],n*=c[l][2],i*=c[l][3],this.color(e,t,n,i)},s.default.prototype.lightness=function(e){return s.default._validateParameters("lightness",arguments),this.color(e)._getLightness()},s.default.prototype.red=function(e){return s.default._validateParameters("red",arguments),this.color(e)._getRed()},s.default.prototype.saturation=function(e){return s.default._validateParameters("saturation",arguments),this.color(e)._getSaturation()};var l=s.default;r.default=l},{"../core/constants":256,"../core/friendly_errors/fes_core":258,"../core/friendly_errors/file_errors":259,"../core/friendly_errors/validate_params":262,"../core/main":267,"./p5.Color":254,"core-js/modules/es.array.iterator":158,"core-js/modules/es.array.map":161,"core-js/modules/es.object.get-own-property-descriptor":173,"core-js/modules/es.object.to-string":177,"core-js/modules/es.string.iterator":186,"core-js/modules/es.symbol":196,"core-js/modules/es.symbol.description":194,"core-js/modules/es.symbol.iterator":195,"core-js/modules/es.weak-map":228,"core-js/modules/web.dom-collections.iterator":230}],254:[function(e,t,r){"use strict";function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function i(e){return(i="function"==typeof Symbol&&"symbol"===n(Symbol.iterator)?function(e){return n(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":n(e)})(e)}e("core-js/modules/es.symbol"),e("core-js/modules/es.symbol.description"),e("core-js/modules/es.symbol.iterator"),e("core-js/modules/es.array.iterator"),e("core-js/modules/es.array.join"),e("core-js/modules/es.array.map"),e("core-js/modules/es.array.slice"),e("core-js/modules/es.object.get-own-property-descriptor"),e("core-js/modules/es.object.to-string"),e("core-js/modules/es.regexp.constructor"),e("core-js/modules/es.regexp.exec"),e("core-js/modules/es.regexp.to-string"),e("core-js/modules/es.string.iterator"),e("core-js/modules/es.string.trim"),e("core-js/modules/es.weak-map"),e("core-js/modules/web.dom-collections.iterator"),e("core-js/modules/es.array.join"),e("core-js/modules/es.array.map"),e("core-js/modules/es.array.slice"),e("core-js/modules/es.object.to-string"),e("core-js/modules/es.regexp.constructor"),e("core-js/modules/es.regexp.exec"),e("core-js/modules/es.regexp.to-string"),e("core-js/modules/es.string.trim"),Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var s=c(e("../core/main")),o=function(e){if(e&&e.__esModule)return e;if(null===e||"object"!==i(e)&&"function"!=typeof e)return{default:e};var t=l();if(t&&t.has(e))return t.get(e);var r,n={},s=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(r in e){var o;Object.prototype.hasOwnProperty.call(e,r)&&((o=s?Object.getOwnPropertyDescriptor(e,r):null)&&(o.get||o.set)?Object.defineProperty(n,r,o):n[r]=e[r])}return n.default=e,t&&t.set(e,n),n}(e("../core/constants")),a=c(e("./color_conversion"));function l(){var e;return"function"!=typeof WeakMap?null:(e=new WeakMap,l=function(){return e},e)}function c(e){return e&&e.__esModule?e:{default:e}}s.default.Color=function(e,t){if(this._storeModeAndMaxes(e._colorMode,e._colorMaxes),this.mode!==o.RGB&&this.mode!==o.HSL&&this.mode!==o.HSB)throw new Error("".concat(this.mode," is an invalid colorMode."));return this._array=s.default.Color._parseInputs.apply(this,t),this._calculateLevels(),this},s.default.Color.prototype.toString=function(e){var t=this.levels,r=this._array,n=r[3];switch(e){case"#rrggbb":return"#".concat(t[0]<16?"0".concat(t[0].toString(16)):t[0].toString(16),t[1]<16?"0".concat(t[1].toString(16)):t[1].toString(16),t[2]<16?"0".concat(t[2].toString(16)):t[2].toString(16));case"#rrggbbaa":return"#".concat(t[0]<16?"0".concat(t[0].toString(16)):t[0].toString(16),t[1]<16?"0".concat(t[1].toString(16)):t[1].toString(16),t[2]<16?"0".concat(t[2].toString(16)):t[2].toString(16),t[3]<16?"0".concat(t[3].toString(16)):t[3].toString(16));case"#rgb":return"#".concat(Math.round(15*r[0]).toString(16),Math.round(15*r[1]).toString(16),Math.round(15*r[2]).toString(16));case"#rgba":return"#".concat(Math.round(15*r[0]).toString(16),Math.round(15*r[1]).toString(16),Math.round(15*r[2]).toString(16),Math.round(15*r[3]).toString(16));case"rgb":return"rgb(".concat(t[0],", ",t[1],", ",t[2],")");case"rgb%":return"rgb(".concat((100*r[0]).toPrecision(3),"%, ",(100*r[1]).toPrecision(3),"%, ",(100*r[2]).toPrecision(3),"%)");case"rgba%":return"rgba(".concat((100*r[0]).toPrecision(3),"%, ",(100*r[1]).toPrecision(3),"%, ",(100*r[2]).toPrecision(3),"%, ",(100*r[3]).toPrecision(3),"%)");case"hsb":case"hsv":return this.hsba||(this.hsba=a.default._rgbaToHSBA(this._array)),"hsb(".concat(this.hsba[0]*this.maxes[o.HSB][0],", ",this.hsba[1]*this.maxes[o.HSB][1],", ",this.hsba[2]*this.maxes[o.HSB][2],")");case"hsb%":case"hsv%":return this.hsba||(this.hsba=a.default._rgbaToHSBA(this._array)),"hsb(".concat((100*this.hsba[0]).toPrecision(3),"%, ",(100*this.hsba[1]).toPrecision(3),"%, ",(100*this.hsba[2]).toPrecision(3),"%)");case"hsba":case"hsva":return this.hsba||(this.hsba=a.default._rgbaToHSBA(this._array)),"hsba(".concat(this.hsba[0]*this.maxes[o.HSB][0],", ",this.hsba[1]*this.maxes[o.HSB][1],", ",this.hsba[2]*this.maxes[o.HSB][2],", ",n,")");case"hsba%":case"hsva%":return this.hsba||(this.hsba=a.default._rgbaToHSBA(this._array)),"hsba(".concat((100*this.hsba[0]).toPrecision(3),"%, ",(100*this.hsba[1]).toPrecision(3),"%, ",(100*this.hsba[2]).toPrecision(3),"%, ",(100*n).toPrecision(3),"%)");case"hsl":return this.hsla||(this.hsla=a.default._rgbaToHSLA(this._array)),"hsl(".concat(this.hsla[0]*this.maxes[o.HSL][0],", ",this.hsla[1]*this.maxes[o.HSL][1],", ",this.hsla[2]*this.maxes[o.HSL][2],")");case"hsl%":return this.hsla||(this.hsla=a.default._rgbaToHSLA(this._array)),"hsl(".concat((100*this.hsla[0]).toPrecision(3),"%, ",(100*this.hsla[1]).toPrecision(3),"%, ",(100*this.hsla[2]).toPrecision(3),"%)");case"hsla":return this.hsla||(this.hsla=a.default._rgbaToHSLA(this._array)),"hsla(".concat(this.hsla[0]*this.maxes[o.HSL][0],", ",this.hsla[1]*this.maxes[o.HSL][1],", ",this.hsla[2]*this.maxes[o.HSL][2],", ",n,")");case"hsla%":return this.hsla||(this.hsla=a.default._rgbaToHSLA(this._array)),"hsl(".concat((100*this.hsla[0]).toPrecision(3),"%, ",(100*this.hsla[1]).toPrecision(3),"%, ",(100*this.hsla[2]).toPrecision(3),"%, ",(100*n).toPrecision(3),"%)");default:return"rgba(".concat(t[0],",",t[1],",",t[2],",",n,")")}},s.default.Color.prototype.setRed=function(e){this._array[0]=e/this.maxes[o.RGB][0],this._calculateLevels()},s.default.Color.prototype.setGreen=function(e){this._array[1]=e/this.maxes[o.RGB][1],this._calculateLevels()},s.default.Color.prototype.setBlue=function(e){this._array[2]=e/this.maxes[o.RGB][2],this._calculateLevels()},s.default.Color.prototype.setAlpha=function(e){this._array[3]=e/this.maxes[this.mode][3],this._calculateLevels()},s.default.Color.prototype._calculateLevels=function(){for(var e=this._array,t=this.levels=new Array(e.length),r=e.length-1;0<=r;--r)t[r]=Math.round(255*e[r]);this.hsla=null,this.hsba=null},s.default.Color.prototype._getAlpha=function(){return this._array[3]*this.maxes[this.mode][3]},s.default.Color.prototype._storeModeAndMaxes=function(e,t){this.mode=e,this.maxes=t},s.default.Color.prototype._getMode=function(){return this.mode},s.default.Color.prototype._getMaxes=function(){return this.maxes},s.default.Color.prototype._getBlue=function(){return this._array[2]*this.maxes[o.RGB][2]},s.default.Color.prototype._getBrightness=function(){return this.hsba||(this.hsba=a.default._rgbaToHSBA(this._array)),this.hsba[2]*this.maxes[o.HSB][2]},s.default.Color.prototype._getGreen=function(){return this._array[1]*this.maxes[o.RGB][1]},s.default.Color.prototype._getHue=function(){return this.mode===o.HSB?(this.hsba||(this.hsba=a.default._rgbaToHSBA(this._array)),this.hsba[0]*this.maxes[o.HSB][0]):(this.hsla||(this.hsla=a.default._rgbaToHSLA(this._array)),this.hsla[0]*this.maxes[o.HSL][0])},s.default.Color.prototype._getLightness=function(){return this.hsla||(this.hsla=a.default._rgbaToHSLA(this._array)),this.hsla[2]*this.maxes[o.HSL][2]},s.default.Color.prototype._getRed=function(){return this._array[0]*this.maxes[o.RGB][0]},s.default.Color.prototype._getSaturation=function(){return this.mode===o.HSB?(this.hsba||(this.hsba=a.default._rgbaToHSBA(this._array)),this.hsba[1]*this.maxes[o.HSB][1]):(this.hsla||(this.hsla=a.default._rgbaToHSLA(this._array)),this.hsla[1]*this.maxes[o.HSL][1])};var u={aliceblue:"#f0f8ff",antiquewhite:"#faebd7",aqua:"#00ffff",aquamarine:"#7fffd4",azure:"#f0ffff",beige:"#f5f5dc",bisque:"#ffe4c4",black:"#000000",blanchedalmond:"#ffebcd",blue:"#0000ff",blueviolet:"#8a2be2",brown:"#a52a2a",burlywood:"#deb887",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",cornflowerblue:"#6495ed",cornsilk:"#fff8dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkgray:"#a9a9a9",darkgreen:"#006400",darkgrey:"#a9a9a9",darkkhaki:"#bdb76b",darkmagenta:"#8b008b",darkolivegreen:"#556b2f",darkorange:"#ff8c00",darkorchid:"#9932cc",darkred:"#8b0000",darksalmon:"#e9967a",darkseagreen:"#8fbc8f",darkslateblue:"#483d8b",darkslategray:"#2f4f4f",darkslategrey:"#2f4f4f",darkturquoise:"#00ced1",darkviolet:"#9400d3",deeppink:"#ff1493",deepskyblue:"#00bfff",dimgray:"#696969",dimgrey:"#696969",dodgerblue:"#1e90ff",firebrick:"#b22222",floralwhite:"#fffaf0",forestgreen:"#228b22",fuchsia:"#ff00ff",gainsboro:"#dcdcdc",ghostwhite:"#f8f8ff",gold:"#ffd700",goldenrod:"#daa520",gray:"#808080",green:"#008000",greenyellow:"#adff2f",grey:"#808080",honeydew:"#f0fff0",hotpink:"#ff69b4",indianred:"#cd5c5c",indigo:"#4b0082",ivory:"#fffff0",khaki:"#f0e68c",lavender:"#e6e6fa",lavenderblush:"#fff0f5",lawngreen:"#7cfc00",lemonchiffon:"#fffacd",lightblue:"#add8e6",lightcoral:"#f08080",lightcyan:"#e0ffff",lightgoldenrodyellow:"#fafad2",lightgray:"#d3d3d3",lightgreen:"#90ee90",lightgrey:"#d3d3d3",lightpink:"#ffb6c1",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",lightskyblue:"#87cefa",lightslategray:"#778899",lightslategrey:"#778899",lightsteelblue:"#b0c4de",lightyellow:"#ffffe0",lime:"#00ff00",limegreen:"#32cd32",linen:"#faf0e6",magenta:"#ff00ff",maroon:"#800000",mediumaquamarine:"#66cdaa",mediumblue:"#0000cd",mediumorchid:"#ba55d3",mediumpurple:"#9370db",mediumseagreen:"#3cb371",mediumslateblue:"#7b68ee",mediumspringgreen:"#00fa9a",mediumturquoise:"#48d1cc",mediumvioletred:"#c71585",midnightblue:"#191970",mintcream:"#f5fffa",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",navajowhite:"#ffdead",navy:"#000080",oldlace:"#fdf5e6",olive:"#808000",olivedrab:"#6b8e23",orange:"#ffa500",orangered:"#ff4500",orchid:"#da70d6",palegoldenrod:"#eee8aa",palegreen:"#98fb98",paleturquoise:"#afeeee",palevioletred:"#db7093",papayawhip:"#ffefd5",peachpuff:"#ffdab9",peru:"#cd853f",pink:"#ffc0cb",plum:"#dda0dd",powderblue:"#b0e0e6",purple:"#800080",rebeccapurple:"#663399",red:"#ff0000",rosybrown:"#bc8f8f",royalblue:"#4169e1",saddlebrown:"#8b4513",salmon:"#fa8072",sandybrown:"#f4a460",seagreen:"#2e8b57",seashell:"#fff5ee",sienna:"#a0522d",silver:"#c0c0c0",skyblue:"#87ceeb",slateblue:"#6a5acd",slategray:"#708090",slategrey:"#708090",snow:"#fffafa",springgreen:"#00ff7f",steelblue:"#4682b4",tan:"#d2b48c",teal:"#008080",thistle:"#d8bfd8",tomato:"#ff6347",turquoise:"#40e0d0",violet:"#ee82ee",wheat:"#f5deb3",white:"#ffffff",whitesmoke:"#f5f5f5",yellow:"#ffff00",yellowgreen:"#9acd32"},h=(e=/\s*/,/(\d{1,3})/),d=/((?:\d+(?:\.\d+)?)|(?:\.\d+))/,p=new RegExp("".concat(d.source,"%")),f={HEX3:/^#([a-f0-9])([a-f0-9])([a-f0-9])$/i,HEX4:/^#([a-f0-9])([a-f0-9])([a-f0-9])([a-f0-9])$/i,HEX6:/^#([a-f0-9]{2})([a-f0-9]{2})([a-f0-9]{2})$/i,HEX8:/^#([a-f0-9]{2})([a-f0-9]{2})([a-f0-9]{2})([a-f0-9]{2})$/i,RGB:new RegExp(["^rgb\\(",h.source,",",h.source,",",h.source,"\\)$"].join(e.source),"i"),RGB_PERCENT:new RegExp(["^rgb\\(",p.source,",",p.source,",",p.source,"\\)$"].join(e.source),"i"),RGBA:new RegExp(["^rgba\\(",h.source,",",h.source,",",h.source,",",d.source,"\\)$"].join(e.source),"i"),RGBA_PERCENT:new RegExp(["^rgba\\(",p.source,",",p.source,",",p.source,",",d.source,"\\)$"].join(e.source),"i"),HSL:new RegExp(["^hsl\\(",h.source,",",p.source,",",p.source,"\\)$"].join(e.source),"i"),HSLA:new RegExp(["^hsla\\(",h.source,",",p.source,",",p.source,",",d.source,"\\)$"].join(e.source),"i"),HSB:new RegExp(["^hsb\\(",h.source,",",p.source,",",p.source,"\\)$"].join(e.source),"i"),HSBA:new RegExp(["^hsba\\(",h.source,",",p.source,",",p.source,",",d.source,"\\)$"].join(e.source),"i")};s.default.Color._parseInputs=function(e,t,r,n){var i,l=arguments.length,c=this.mode,h=this.maxes[c],d=[];if(3<=l){for(d[0]=e/h[0],d[1]=t/h[1],d[2]=r/h[2],d[3]="number"==typeof n?n/h[3]:1,i=d.length-1;0<=i;--i){var p=d[i];p<0?d[i]=0:1<p&&(d[i]=1)}return c===o.HSL?a.default._hslaToRGBA(d):c===o.HSB?a.default._hsbaToRGBA(d):d}if(1===l&&"string"==typeof e){if(r=e.trim().toLowerCase(),u[r])return s.default.Color._parseInputs.call(this,u[r]);if(f.HEX3.test(r))return(d=f.HEX3.exec(r).slice(1).map((function(e){return parseInt(e+e,16)/255})))[3]=1,d;if(f.HEX6.test(r))return(d=f.HEX6.exec(r).slice(1).map((function(e){return parseInt(e,16)/255})))[3]=1,d;if(f.HEX4.test(r))return f.HEX4.exec(r).slice(1).map((function(e){return parseInt(e+e,16)/255}));if(f.HEX8.test(r))return f.HEX8.exec(r).slice(1).map((function(e){return parseInt(e,16)/255}));if(f.RGB.test(r))return(d=f.RGB.exec(r).slice(1).map((function(e){return e/255})))[3]=1,d;if(f.RGB_PERCENT.test(r))return(d=f.RGB_PERCENT.exec(r).slice(1).map((function(e){return parseFloat(e)/100})))[3]=1,d;if(f.RGBA.test(r))return f.RGBA.exec(r).slice(1).map((function(e,t){return 3===t?parseFloat(e):e/255}));if(f.RGBA_PERCENT.test(r))return f.RGBA_PERCENT.exec(r).slice(1).map((function(e,t){return 3===t?parseFloat(e):parseFloat(e)/100}));if(f.HSL.test(r)?(d=f.HSL.exec(r).slice(1).map((function(e,t){return 0===t?parseInt(e,10)/360:parseInt(e,10)/100})))[3]=1:f.HSLA.test(r)&&(d=f.HSLA.exec(r).slice(1).map((function(e,t){return 0===t?parseInt(e,10)/360:3===t?parseFloat(e):parseInt(e,10)/100}))),(d=d.map((function(e){return Math.max(Math.min(e,1),0)}))).length)return a.default._hslaToRGBA(d);if(f.HSB.test(r)?(d=f.HSB.exec(r).slice(1).map((function(e,t){return 0===t?parseInt(e,10)/360:parseInt(e,10)/100})))[3]=1:f.HSBA.test(r)&&(d=f.HSBA.exec(r).slice(1).map((function(e,t){return 0===t?parseInt(e,10)/360:3===t?parseFloat(e):parseInt(e,10)/100}))),d.length){for(i=d.length-1;0<=i;--i)d[i]=Math.max(Math.min(d[i],1),0);return a.default._hsbaToRGBA(d)}d=[1,1,1,1]}else{if(1!==l&&2!==l||"number"!=typeof e)throw new Error("".concat(arguments,"is not a valid color representation."));d[0]=e/h[2],d[1]=e/h[2],d[2]=e/h[2],d[3]="number"==typeof t?t/h[3]:1,d=d.map((function(e){return Math.max(Math.min(e,1),0)}))}return d},h=s.default.Color;r.default=h},{"../core/constants":256,"../core/main":267,"./color_conversion":252,"core-js/modules/es.array.iterator":158,"core-js/modules/es.array.join":159,"core-js/modules/es.array.map":161,"core-js/modules/es.array.slice":162,"core-js/modules/es.object.get-own-property-descriptor":173,"core-js/modules/es.object.to-string":177,"core-js/modules/es.regexp.constructor":180,"core-js/modules/es.regexp.exec":181,"core-js/modules/es.regexp.to-string":182,"core-js/modules/es.string.iterator":186,"core-js/modules/es.string.trim":193,"core-js/modules/es.symbol":196,"core-js/modules/es.symbol.description":194,"core-js/modules/es.symbol.iterator":195,"core-js/modules/es.weak-map":228,"core-js/modules/web.dom-collections.iterator":230}],255:[function(e,t,r){"use strict";function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function i(e){return(i="function"==typeof Symbol&&"symbol"===n(Symbol.iterator)?function(e){return n(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":n(e)})(e)}e("core-js/modules/es.symbol"),e("core-js/modules/es.symbol.description"),e("core-js/modules/es.symbol.iterator"),e("core-js/modules/es.array.fill"),e("core-js/modules/es.array.iterator"),e("core-js/modules/es.object.get-own-property-descriptor"),e("core-js/modules/es.object.to-string"),e("core-js/modules/es.string.iterator"),e("core-js/modules/es.weak-map"),e("core-js/modules/web.dom-collections.iterator"),e("core-js/modules/es.array.fill"),Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var s=(l=e("../core/main"))&&l.__esModule?l:{default:l},o=function(e){if(e&&e.__esModule)return e;if(null===e||"object"!==i(e)&&"function"!=typeof e)return{default:e};var t=a();if(t&&t.has(e))return t.get(e);var r,n={},s=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(r in e){var o;Object.prototype.hasOwnProperty.call(e,r)&&((o=s?Object.getOwnPropertyDescriptor(e,r):null)&&(o.get||o.set)?Object.defineProperty(n,r,o):n[r]=e[r])}return n.default=e,t&&t.set(e,n),n}(e("../core/constants"));function a(){var e;return"function"!=typeof WeakMap?null:(e=new WeakMap,a=function(){return e},e)}e("./p5.Color"),s.default.prototype.background=function(){var e;return(e=this._renderer).background.apply(e,arguments),this},s.default.prototype.clear=function(){return this._renderer.clear((arguments.length<=0?void 0:arguments[0])||0,(arguments.length<=1?void 0:arguments[1])||0,(arguments.length<=2?void 0:arguments[2])||0,(arguments.length<=3?void 0:arguments[3])||0),this},s.default.prototype.colorMode=function(e,t,r,n,i){return s.default._validateParameters("colorMode",arguments),e!==o.RGB&&e!==o.HSB&&e!==o.HSL||(this._colorMode=e,e=this._colorMaxes[e],2===arguments.length?(e[0]=t,e[1]=t,e[2]=t,e[3]=t):4===arguments.length?(e[0]=t,e[1]=r,e[2]=n):5===arguments.length&&(e[0]=t,e[1]=r,e[2]=n,e[3]=i)),this},s.default.prototype.fill=function(){var e;return this._renderer._setProperty("_fillSet",!0),this._renderer._setProperty("_doFill",!0),(e=this._renderer).fill.apply(e,arguments),this},s.default.prototype.noFill=function(){return this._renderer._setProperty("_doFill",!1),this},s.default.prototype.noStroke=function(){return this._renderer._setProperty("_doStroke",!1),this},s.default.prototype.stroke=function(){var e;return this._renderer._setProperty("_strokeSet",!0),this._renderer._setProperty("_doStroke",!0),(e=this._renderer).stroke.apply(e,arguments),this},s.default.prototype.erase=function(){return this._renderer.erase(0<arguments.length&&void 0!==arguments[0]?arguments[0]:255,1<arguments.length&&void 0!==arguments[1]?arguments[1]:255),this},s.default.prototype.noErase=function(){return this._renderer.noErase(),this};var l=s.default;r.default=l},{"../core/constants":256,"../core/main":267,"./p5.Color":254,"core-js/modules/es.array.fill":152,"core-js/modules/es.array.iterator":158,"core-js/modules/es.object.get-own-property-descriptor":173,"core-js/modules/es.object.to-string":177,"core-js/modules/es.string.iterator":186,"core-js/modules/es.symbol":196,"core-js/modules/es.symbol.description":194,"core-js/modules/es.symbol.iterator":195,"core-js/modules/es.weak-map":228,"core-js/modules/web.dom-collections.iterator":230}],256:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.BEZIER=r.QUADRATIC=r.LINEAR=r._CTX_MIDDLE=r._DEFAULT_LEADMULT=r._DEFAULT_TEXT_FILL=r.WORD=r.CHAR=r.BOLDITALIC=r.BOLD=r.ITALIC=r.NORMAL=r.BLUR=r.ERODE=r.DILATE=r.POSTERIZE=r.INVERT=r.OPAQUE=r.GRAY=r.THRESHOLD=r.BURN=r.DODGE=r.SOFT_LIGHT=r.HARD_LIGHT=r.OVERLAY=r.REPLACE=r.SCREEN=r.MULTIPLY=r.EXCLUSION=r.SUBTRACT=r.DIFFERENCE=r.LIGHTEST=r.DARKEST=r.ADD=r.REMOVE=r.BLEND=r.UP_ARROW=r.TAB=r.SHIFT=r.RIGHT_ARROW=r.RETURN=r.OPTION=r.LEFT_ARROW=r.ESCAPE=r.ENTER=r.DOWN_ARROW=r.DELETE=r.CONTROL=r.BACKSPACE=r.ALT=r.AUTO=r.HSL=r.HSB=r.RGB=r.MITER=r.BEVEL=r.ROUND=r.SQUARE=r.PROJECT=r.PIE=r.CHORD=r.OPEN=r.CLOSE=r.TESS=r.QUAD_STRIP=r.QUADS=r.TRIANGLE_STRIP=r.TRIANGLE_FAN=r.TRIANGLES=r.LINE_LOOP=r.LINE_STRIP=r.LINES=r.POINTS=r.BASELINE=r.BOTTOM=r.TOP=r.CENTER=r.LEFT=r.RIGHT=r.RADIUS=r.CORNERS=r.CORNER=r.RAD_TO_DEG=r.DEG_TO_RAD=r.RADIANS=r.DEGREES=r.TWO_PI=r.TAU=r.QUARTER_PI=r.PI=r.HALF_PI=r.WAIT=r.TEXT=r.MOVE=r.HAND=r.CROSS=r.ARROW=r.WEBGL=r.P2D=r.VERSION=void 0,r.COVER=r.CONTAIN=r.FALLBACK=r.LABEL=r.AXES=r.GRID=r._DEFAULT_FILL=r._DEFAULT_STROKE=r.PORTRAIT=r.LANDSCAPE=r.MIRROR=r.CLAMP=r.REPEAT=r.NEAREST=r.IMAGE=r.IMMEDIATE=r.TEXTURE=r.FILL=r.STROKE=r.CURVE=void 0;var n=Math.PI,i=(r.VERSION="1.6.0",r.P2D="p2d",r.WEBGL="webgl",r.ARROW="default",r.CROSS="crosshair",r.HAND="pointer",r.MOVE="move",r.TEXT="text",r.WAIT="wait",n/2);r.HALF_PI=i,i=n,r.PI=i,i=n/4,r.QUARTER_PI=i,i=2*n,r.TAU=i,i=2*n,r.TWO_PI=i,r.DEGREES="degrees",r.RADIANS="radians",i=n/180,r.DEG_TO_RAD=i,i=180/n;r.RAD_TO_DEG=i,r.CORNER="corner",r.CORNERS="corners",r.RADIUS="radius",r.RIGHT="right",r.LEFT="left",r.CENTER="center",r.TOP="top",r.BOTTOM="bottom",r.BASELINE="alphabetic",r.POINTS=0,r.LINES=1,r.LINE_STRIP=3,r.LINE_LOOP=2,r.TRIANGLES=4,r.TRIANGLE_FAN=6,r.TRIANGLE_STRIP=5,r.QUADS="quads",r.QUAD_STRIP="quad_strip",r.TESS="tess",r.CLOSE="close",r.OPEN="open",r.CHORD="chord",r.PIE="pie",r.PROJECT="square",r.SQUARE="butt",r.ROUND="round",r.BEVEL="bevel",r.MITER="miter",r.RGB="rgb",r.HSB="hsb",r.HSL="hsl",r.AUTO="auto",r.ALT=18,r.BACKSPACE=8,r.CONTROL=17,r.DELETE=46,r.DOWN_ARROW=40,r.ENTER=13,r.ESCAPE=27,r.LEFT_ARROW=37,r.OPTION=18,r.RETURN=13,r.RIGHT_ARROW=39,r.SHIFT=16,r.TAB=9,r.UP_ARROW=38,r.BLEND="source-over",r.REMOVE="destination-out",r.ADD="lighter",r.DARKEST="darken",r.LIGHTEST="lighten",r.DIFFERENCE="difference",r.SUBTRACT="subtract",r.EXCLUSION="exclusion",r.MULTIPLY="multiply",r.SCREEN="screen",r.REPLACE="copy",r.OVERLAY="overlay",r.HARD_LIGHT="hard-light",r.SOFT_LIGHT="soft-light",r.DODGE="color-dodge",r.BURN="color-burn",r.THRESHOLD="threshold",r.GRAY="gray",r.OPAQUE="opaque",r.INVERT="invert",r.POSTERIZE="posterize",r.DILATE="dilate",r.ERODE="erode",r.BLUR="blur",r.NORMAL="normal",r.ITALIC="italic",r.BOLD="bold",r.BOLDITALIC="bold italic",r.CHAR="CHAR",r.WORD="WORD",r._DEFAULT_TEXT_FILL="#000000",r._DEFAULT_LEADMULT=1.25,r._CTX_MIDDLE="middle",r.LINEAR="linear",r.QUADRATIC="quadratic",r.BEZIER="bezier",r.CURVE="curve",r.STROKE="stroke",r.FILL="fill",r.TEXTURE="texture",r.IMMEDIATE="immediate",r.IMAGE="image",r.NEAREST="nearest",r.REPEAT="repeat",r.CLAMP="clamp",r.MIRROR="mirror",r.LANDSCAPE="landscape",r.PORTRAIT="portrait",r._DEFAULT_STROKE="#000000",r._DEFAULT_FILL="#FFFFFF",r.GRID="grid",r.AXES="axes",r.LABEL="label",r.FALLBACK="fallback",r.CONTAIN="contain",r.COVER="cover"},{}],257:[function(e,t,r){"use strict";function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function i(e){return(i="function"==typeof Symbol&&"symbol"===n(Symbol.iterator)?function(e){return n(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":n(e)})(e)}e("core-js/modules/es.symbol"),e("core-js/modules/es.symbol.description"),e("core-js/modules/es.symbol.iterator"),e("core-js/modules/es.array.concat"),e("core-js/modules/es.array.filter"),e("core-js/modules/es.array.includes"),e("core-js/modules/es.array.iterator"),e("core-js/modules/es.object.get-own-property-descriptor"),e("core-js/modules/es.object.to-string"),e("core-js/modules/es.regexp.exec"),e("core-js/modules/es.string.includes"),e("core-js/modules/es.string.iterator"),e("core-js/modules/es.string.search"),e("core-js/modules/es.string.split"),e("core-js/modules/es.weak-map"),e("core-js/modules/web.dom-collections.iterator"),e("core-js/modules/es.array.concat"),e("core-js/modules/es.array.filter"),e("core-js/modules/es.array.includes"),e("core-js/modules/es.regexp.exec"),e("core-js/modules/es.string.includes"),e("core-js/modules/es.string.search"),e("core-js/modules/es.string.split"),Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var s=(o=e("./main"))&&o.__esModule?o:{default:o},o=function(e){if(e&&e.__esModule)return e;if(null===e||"object"!==i(e)&&"function"!=typeof e)return{default:e};var t=a();if(t&&t.has(e))return t.get(e);var r,n={},s=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(r in e){var o;Object.prototype.hasOwnProperty.call(e,r)&&((o=s?Object.getOwnPropertyDescriptor(e,r):null)&&(o.get||o.set)?Object.defineProperty(n,r,o):n[r]=e[r])}return n.default=e,t&&t.set(e,n),n}(e("./constants"));function a(){var e;return"function"!=typeof WeakMap?null:(e=new WeakMap,a=function(){return e},e)}var l=[o.ARROW,o.CROSS,o.HAND,o.MOVE,o.TEXT,o.WAIT],c=(s.default.prototype._frameRate=0,s.default.prototype._lastFrameTime=window.performance.now(),s.default.prototype._targetFrameRate=60,window.print);function u(){return window.innerWidth||document.documentElement&&document.documentElement.clientWidth||document.body&&document.body.clientWidth||0}function h(){return window.innerHeight||document.documentElement&&document.documentElement.clientHeight||document.body&&document.body.clientHeight||0}s.default.prototype.print=function(){var e;arguments.length?(e=console).log.apply(e,arguments):c()},s.default.prototype.frameCount=0,s.default.prototype.deltaTime=0,s.default.prototype.focused=document.hasFocus(),s.default.prototype.cursor=function(e,t,r){var n,i="auto",s=this._curElement.elt;l.includes(e)?i=e:"string"==typeof e&&(n="",t&&r&&"number"==typeof t&&"number"==typeof r&&(n="".concat(t," ").concat(r)),i="http://"===e.substring(0,7)||"https://"===e.substring(0,8)||/\.(cur|jpg|jpeg|gif|png|CUR|JPG|JPEG|GIF|PNG)$/.test(e)?"url(".concat(e,") ").concat(n,", auto"):e),s.style.cursor=i},s.default.prototype.frameRate=function(e){return s.default._validateParameters("frameRate",arguments),"number"!=typeof e||e<0?this._frameRate:(this._setProperty("_targetFrameRate",e),0===e&&this._setProperty("_frameRate",e),this)},s.default.prototype.getFrameRate=function(){return this.frameRate()},s.default.prototype.setFrameRate=function(e){return this.frameRate(e)},s.default.prototype.getTargetFrameRate=function(){return this._targetFrameRate},s.default.prototype.noCursor=function(){this._curElement.elt.style.cursor="none"},s.default.prototype.displayWidth=screen.width,s.default.prototype.displayHeight=screen.height,s.default.prototype.windowWidth=u(),s.default.prototype.windowHeight=h(),s.default.prototype._onresize=function(e){this._setProperty("windowWidth",u()),this._setProperty("windowHeight",h());var t=this._isGlobal?window:this;"function"!=typeof t.windowResized||void 0===(t=t.windowResized(e))||t||e.preventDefault()},s.default.prototype.width=0,s.default.prototype.height=0,s.default.prototype.fullscreen=function(e){if(s.default._validateParameters("fullscreen",arguments),void 0===e)return document.fullscreenElement||document.webkitFullscreenElement||document.mozFullScreenElement||document.msFullscreenElement;if(e){if(e=document.documentElement,!(document.fullscreenEnabled||document.webkitFullscreenEnabled||document.mozFullScreenEnabled||document.msFullscreenEnabled))throw new Error("Fullscreen not enabled in this browser.");e.requestFullscreen?e.requestFullscreen():e.mozRequestFullScreen?e.mozRequestFullScreen():e.webkitRequestFullscreen?e.webkitRequestFullscreen():e.msRequestFullscreen&&e.msRequestFullscreen()}else document.exitFullscreen?document.exitFullscreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.webkitExitFullscreen?document.webkitExitFullscreen():document.msExitFullscreen&&document.msExitFullscreen()},s.default.prototype.pixelDensity=function(e){var t;return s.default._validateParameters("pixelDensity",arguments),"number"==typeof e?(e!==this._pixelDensity&&(this._pixelDensity=e),(t=this).resizeCanvas(this.width,this.height,!0)):t=this._pixelDensity,t},s.default.prototype.displayDensity=function(){return window.devicePixelRatio},s.default.prototype.getURL=function(){return location.href},s.default.prototype.getURLPath=function(){return location.pathname.split("/").filter((function(e){return""!==e}))},s.default.prototype.getURLParams=function(){for(var e,t=/[?&]([^&=]+)(?:[&=])([^&=]+)/gim,r={};null!=(e=t.exec(location.search));)e.index===t.lastIndex&&t.lastIndex++,r[e[1]]=e[2];return r},e=s.default,r.default=e},{"./constants":256,"./main":267,"core-js/modules/es.array.concat":149,"core-js/modules/es.array.filter":153,"core-js/modules/es.array.includes":156,"core-js/modules/es.array.iterator":158,"core-js/modules/es.object.get-own-property-descriptor":173,"core-js/modules/es.object.to-string":177,"core-js/modules/es.regexp.exec":181,"core-js/modules/es.string.includes":185,"core-js/modules/es.string.iterator":186,"core-js/modules/es.string.search":190,"core-js/modules/es.string.split":191,"core-js/modules/es.symbol":196,"core-js/modules/es.symbol.description":194,"core-js/modules/es.symbol.iterator":195,"core-js/modules/es.weak-map":228,"core-js/modules/web.dom-collections.iterator":230}],258:[function(e,t,r){"use strict";e("core-js/modules/es.symbol"),e("core-js/modules/es.symbol.description"),e("core-js/modules/es.symbol.iterator"),e("core-js/modules/es.array.concat"),e("core-js/modules/es.array.filter"),e("core-js/modules/es.array.for-each"),e("core-js/modules/es.array.includes"),e("core-js/modules/es.array.iterator"),e("core-js/modules/es.array.join"),e("core-js/modules/es.array.map"),e("core-js/modules/es.array.slice"),e("core-js/modules/es.array.some"),e("core-js/modules/es.function.name"),e("core-js/modules/es.object.assign"),e("core-js/modules/es.object.get-own-property-names"),e("core-js/modules/es.object.keys"),e("core-js/modules/es.object.to-string"),e("core-js/modules/es.regexp.constructor"),e("core-js/modules/es.regexp.exec"),e("core-js/modules/es.regexp.to-string"),e("core-js/modules/es.string.iterator"),e("core-js/modules/es.string.match"),e("core-js/modules/es.string.replace"),e("core-js/modules/es.string.search"),e("core-js/modules/es.string.split"),e("core-js/modules/web.dom-collections.for-each"),e("core-js/modules/web.dom-collections.iterator"),e("core-js/modules/es.symbol"),e("core-js/modules/es.symbol.description"),e("core-js/modules/es.symbol.iterator"),e("core-js/modules/es.array.concat"),e("core-js/modules/es.array.filter"),e("core-js/modules/es.array.for-each"),e("core-js/modules/es.array.includes"),e("core-js/modules/es.array.iterator"),e("core-js/modules/es.array.join"),e("core-js/modules/es.array.map"),e("core-js/modules/es.array.slice"),e("core-js/modules/es.array.some"),e("core-js/modules/es.function.name"),e("core-js/modules/es.object.assign"),e("core-js/modules/es.object.get-own-property-names"),e("core-js/modules/es.object.keys"),e("core-js/modules/es.object.to-string"),e("core-js/modules/es.regexp.constructor"),e("core-js/modules/es.regexp.exec"),e("core-js/modules/es.regexp.to-string"),e("core-js/modules/es.string.iterator"),e("core-js/modules/es.string.match"),e("core-js/modules/es.string.replace"),e("core-js/modules/es.string.search"),e("core-js/modules/es.string.split"),e("core-js/modules/web.dom-collections.for-each"),e("core-js/modules/web.dom-collections.iterator"),Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n=(l=e("../main"))&&l.__esModule?l:{default:l};function i(e,t){t=t||void 0,s||o(),s.some((function(r){var n;if(e.message&&null!==e.message.match("\\W?".concat(r.name,"\\W")))return n="function"===r.type?"".concat(r.name,"()"):r.name,t("Did you just try to use p5.js's ".concat(n," ").concat(r.type,"? If so, you may want to move it into your sketch's setup() function.\n\nFor more details, see: ").concat(a)),!0}))}e("../internationalization");var s=null,o=null,a=(n.default._friendlyError=n.default._checkForUserDefinedFunctions=n.default._fesErrorMonitor=function(){},s=null,"https://github.com/processing/p5.js/wiki/p5.js-overview#why-cant-i-assign-variables-using-p5-functions-and-variables-before-setup"),l=(o=function(){function t(e){return Object.getOwnPropertyNames(e).filter((function(e){return"_"!==e[0]&&!(e in r)&&(r[e]=!0)})).map((function(t){var r="function"==typeof e[t]?"function":t===t.toUpperCase()?"constant":"variable";return{name:t,type:r}}))}var r={};(s=[].concat(t(n.default.prototype),t(e("../constants")))).sort((function(e,t){return t.name.length-e.name.length}))},n.default.prototype._helpForMisusedAtTopLevelCode=i,"complete"!==document.readyState&&(window.addEventListener("error",i,!1),window.addEventListener("load",(function(){window.removeEventListener("error",i,!1)}))),n.default);r.default=l},{"../constants":256,"../internationalization":265,"../main":267,"./browser_errors":void 0,"core-js/modules/es.array.concat":149,"core-js/modules/es.array.filter":153,"core-js/modules/es.array.for-each":154,"core-js/modules/es.array.includes":156,"core-js/modules/es.array.iterator":158,"core-js/modules/es.array.join":159,"core-js/modules/es.array.map":161,"core-js/modules/es.array.slice":162,"core-js/modules/es.array.some":163,"core-js/modules/es.function.name":165,"core-js/modules/es.object.assign":172,"core-js/modules/es.object.get-own-property-names":174,"core-js/modules/es.object.keys":176,"core-js/modules/es.object.to-string":177,"core-js/modules/es.regexp.constructor":180,"core-js/modules/es.regexp.exec":181,"core-js/modules/es.regexp.to-string":182,"core-js/modules/es.string.iterator":186,"core-js/modules/es.string.match":187,"core-js/modules/es.string.replace":189,"core-js/modules/es.string.search":190,"core-js/modules/es.string.split":191,"core-js/modules/es.symbol":196,"core-js/modules/es.symbol.description":194,"core-js/modules/es.symbol.iterator":195,"core-js/modules/web.dom-collections.for-each":229,"core-js/modules/web.dom-collections.iterator":230}],259:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n=(n=e("../main"))&&n.__esModule?n:{default:n};e("../internationalization"),n.default._friendlyFileLoadError=function(){},e=n.default,r.default=e},{"../internationalization":265,"../main":267}],260:[function(e,t,r){"use strict";function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function i(e){return(i="function"==typeof Symbol&&"symbol"===n(Symbol.iterator)?function(e){return n(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":n(e)})(e)}e("core-js/modules/es.symbol"),e("core-js/modules/es.symbol.description"),e("core-js/modules/es.symbol.iterator"),e("core-js/modules/es.array.filter"),e("core-js/modules/es.array.for-each"),e("core-js/modules/es.array.from"),e("core-js/modules/es.array.includes"),e("core-js/modules/es.array.index-of"),e("core-js/modules/es.array.iterator"),e("core-js/modules/es.array.join"),e("core-js/modules/es.array.map"),e("core-js/modules/es.array.slice"),e("core-js/modules/es.object.get-own-property-descriptor"),e("core-js/modules/es.object.keys"),e("core-js/modules/es.object.to-string"),e("core-js/modules/es.regexp.constructor"),e("core-js/modules/es.regexp.exec"),e("core-js/modules/es.regexp.to-string"),e("core-js/modules/es.string.includes"),e("core-js/modules/es.string.iterator"),e("core-js/modules/es.string.match"),e("core-js/modules/es.string.split"),e("core-js/modules/es.string.trim"),e("core-js/modules/es.weak-map"),e("core-js/modules/web.dom-collections.for-each"),e("core-js/modules/web.dom-collections.iterator"),e("core-js/modules/es.symbol"),e("core-js/modules/es.symbol.description"),e("core-js/modules/es.symbol.iterator"),e("core-js/modules/es.array.filter"),e("core-js/modules/es.array.for-each"),e("core-js/modules/es.array.from"),e("core-js/modules/es.array.includes"),e("core-js/modules/es.array.index-of"),e("core-js/modules/es.array.iterator"),e("core-js/modules/es.array.join"),e("core-js/modules/es.array.map"),e("core-js/modules/es.array.slice"),e("core-js/modules/es.object.keys"),e("core-js/modules/es.object.to-string"),e("core-js/modules/es.regexp.constructor"),e("core-js/modules/es.regexp.exec"),e("core-js/modules/es.regexp.to-string"),e("core-js/modules/es.string.includes"),e("core-js/modules/es.string.iterator"),e("core-js/modules/es.string.match"),e("core-js/modules/es.string.split"),e("core-js/modules/es.string.trim"),e("core-js/modules/web.dom-collections.for-each"),e("core-js/modules/web.dom-collections.iterator"),Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var s=function(e){return e&&e.__esModule?e:{default:e}}(e("../main"));e("../internationalization"),function(e){if(e&&e.__esModule)return e;if(null===e||"object"!==i(e)&&"function"!=typeof e)return{default:e};var t=o();if(t&&t.has(e))return t.get(e);var r,n,s={},a=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(r in e)Object.prototype.hasOwnProperty.call(e,r)&&((n=a?Object.getOwnPropertyDescriptor(e,r):null)&&(n.get||n.set)?Object.defineProperty(s,r,n):s[r]=e[r]);s.default=e,t&&t.set(e,s)}(e("../constants"));function o(){var e;return"function"!=typeof WeakMap?null:(e=new WeakMap,o=function(){return e},e)}s.default._fesCodeReader=function(){};var a=s.default;r.default=a},{"../constants":256,"../internationalization":265,"../main":267,"core-js/modules/es.array.filter":153,"core-js/modules/es.array.for-each":154,"core-js/modules/es.array.from":155,"core-js/modules/es.array.includes":156,"core-js/modules/es.array.index-of":157,"core-js/modules/es.array.iterator":158,"core-js/modules/es.array.join":159,"core-js/modules/es.array.map":161,"core-js/modules/es.array.slice":162,"core-js/modules/es.object.get-own-property-descriptor":173,"core-js/modules/es.object.keys":176,"core-js/modules/es.object.to-string":177,"core-js/modules/es.regexp.constructor":180,"core-js/modules/es.regexp.exec":181,"core-js/modules/es.regexp.to-string":182,"core-js/modules/es.string.includes":185,"core-js/modules/es.string.iterator":186,"core-js/modules/es.string.match":187,"core-js/modules/es.string.split":191,"core-js/modules/es.string.trim":193,"core-js/modules/es.symbol":196,"core-js/modules/es.symbol.description":194,"core-js/modules/es.symbol.iterator":195,"core-js/modules/es.weak-map":228,"core-js/modules/web.dom-collections.for-each":229,"core-js/modules/web.dom-collections.iterator":230}],261:[function(e,t,r){"use strict";function n(){var e=/(^|@)\S+:\d+/,t=/^\s*at .*(\S+:\d+|\(native\))/m,r=/^(eval@)?(\[native code])?$/;return{parse:function(e){return void 0!==e.stacktrace||void 0!==e["opera#sourceloc"]?this.parseOpera(e):e.stack&&e.stack.match(t)?this.parseV8OrIE(e):e.stack?this.parseFFOrSafari(e):void 0},extractLocation:function(e){return-1===e.indexOf(":")?[e]:[(e=/(.+?)(?::(\d+))?(?::(\d+))?$/.exec(e.replace(/[()]/g,"")))[1],e[2]||void 0,e[3]||void 0]},parseV8OrIE:function(e){return e.stack.split("\n").filter((function(e){return!!e.match(t)}),this).map((function(e){var t=(r=(e=-1<e.indexOf("(eval ")?e.replace(/eval code/g,"eval").replace(/(\(eval at [^()]*)|(\),.*$)/g,""):e).replace(/^\s+/,"").replace(/\(eval code/g,"(")).match(/ (\((.+):(\d+):(\d+)\)$)/),r=(r=t?r.replace(t[0],""):r).split(/\s+/).slice(1);t=this.extractLocation(t?t[1]:r.pop());return{functionName:r.join(" ")||void 0,fileName:-1<["eval","<anonymous>"].indexOf(t[0])?void 0:t[0],lineNumber:t[1],columnNumber:t[2],source:e}}),this)},parseFFOrSafari:function(e){return e.stack.split("\n").filter((function(e){return!e.match(r)}),this).map((function(e){var t,r;return-1===(e=-1<e.indexOf(" > eval")?e.replace(/ line (\d+)(?: > eval line \d+)* > eval:\d+:\d+/g,":$1"):e).indexOf("@")&&-1===e.indexOf(":")?{functionName:e}:{functionName:(r=e.match(t=/((.*".+"[^@]*)?[^@]*)(?:@)/))&&r[1]?r[1]:void 0,fileName:(r=this.extractLocation(e.replace(t,"")))[0],lineNumber:r[1],columnNumber:r[2],source:e}}),this)},parseOpera:function(e){return!e.stacktrace||-1<e.message.indexOf("\n")&&e.message.split("\n").length>e.stacktrace.split("\n").length?this.parseOpera9(e):e.stack?this.parseOpera11(e):this.parseOpera10(e)},parseOpera9:function(e){for(var t=/Line (\d+).*script (?:in )?(\S+)/i,r=e.message.split("\n"),n=[],i=2,s=r.length;i<s;i+=2){var o=t.exec(r[i]);o&&n.push({fileName:o[2],lineNumber:o[1],source:r[i]})}return n},parseOpera10:function(e){for(var t=/Line (\d+).*script (?:in )?(\S+)(?:: In function (\S+))?$/i,r=e.stacktrace.split("\n"),n=[],i=0,s=r.length;i<s;i+=2){var o=t.exec(r[i]);o&&n.push({functionName:o[3]||void 0,fileName:o[2],lineNumber:o[1],source:r[i]})}return n},parseOpera11:function(t){return t.stack.split("\n").filter((function(t){return!!t.match(e)&&!t.match(/^Error created at/)}),this).map((function(e){var t,r=e.split("@"),n=this.extractLocation(r.pop());return{functionName:(r=r.shift()||"").replace(/<anonymous function(: (\w+))?>/,"$2").replace(/\([^)]*\)/g,"")||void 0,args:void 0===(t=r.match(/\(([^)]*)\)/)?r.replace(/^[^(]+\(([^)]*)\)$/,"$1"):t)||"[arguments not available]"===t?void 0:t.split(","),fileName:n[0],lineNumber:n[1],columnNumber:n[2],source:e}}),this)}}}e("core-js/modules/es.array.filter"),e("core-js/modules/es.array.index-of"),e("core-js/modules/es.array.join"),e("core-js/modules/es.array.map"),e("core-js/modules/es.array.slice"),e("core-js/modules/es.regexp.exec"),e("core-js/modules/es.string.match"),e("core-js/modules/es.string.replace"),e("core-js/modules/es.string.split"),e("core-js/modules/es.array.filter"),e("core-js/modules/es.array.index-of"),e("core-js/modules/es.array.join"),e("core-js/modules/es.array.map"),e("core-js/modules/es.array.slice"),e("core-js/modules/es.regexp.exec"),e("core-js/modules/es.string.match"),e("core-js/modules/es.string.replace"),e("core-js/modules/es.string.split"),Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0,(e=(e=e("../main"))&&e.__esModule?e:{default:e}).default._getErrorStackParser=function(){return new n},e=e.default,r.default=e},{"../main":267,"core-js/modules/es.array.filter":153,"core-js/modules/es.array.index-of":157,"core-js/modules/es.array.join":159,"core-js/modules/es.array.map":161,"core-js/modules/es.array.slice":162,"core-js/modules/es.regexp.exec":181,"core-js/modules/es.string.match":187,"core-js/modules/es.string.replace":189,"core-js/modules/es.string.split":191}],262:[function(e,t,r){"use strict";function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}e("core-js/modules/es.symbol"),e("core-js/modules/es.symbol.description"),e("core-js/modules/es.symbol.iterator"),e("core-js/modules/es.array.concat"),e("core-js/modules/es.array.for-each"),e("core-js/modules/es.array.includes"),e("core-js/modules/es.array.index-of"),e("core-js/modules/es.array.iterator"),e("core-js/modules/es.array.join"),e("core-js/modules/es.array.last-index-of"),e("core-js/modules/es.array.map"),e("core-js/modules/es.array.slice"),e("core-js/modules/es.function.name"),e("core-js/modules/es.map"),e("core-js/modules/es.number.constructor"),e("core-js/modules/es.object.get-own-property-descriptor"),e("core-js/modules/es.object.get-prototype-of"),e("core-js/modules/es.object.keys"),e("core-js/modules/es.object.to-string"),e("core-js/modules/es.reflect.construct"),e("core-js/modules/es.regexp.exec"),e("core-js/modules/es.regexp.to-string"),e("core-js/modules/es.set"),e("core-js/modules/es.string.includes"),e("core-js/modules/es.string.iterator"),e("core-js/modules/es.string.split"),e("core-js/modules/es.weak-map"),e("core-js/modules/web.dom-collections.for-each"),e("core-js/modules/web.dom-collections.iterator"),e("core-js/modules/es.symbol"),e("core-js/modules/es.symbol.description"),e("core-js/modules/es.symbol.iterator"),e("core-js/modules/es.array.concat"),e("core-js/modules/es.array.for-each"),e("core-js/modules/es.array.includes"),e("core-js/modules/es.array.index-of"),e("core-js/modules/es.array.iterator"),e("core-js/modules/es.array.join"),e("core-js/modules/es.array.last-index-of"),e("core-js/modules/es.array.map"),e("core-js/modules/es.array.slice"),e("core-js/modules/es.function.name"),e("core-js/modules/es.map"),e("core-js/modules/es.number.constructor"),e("core-js/modules/es.object.get-prototype-of"),e("core-js/modules/es.object.keys"),e("core-js/modules/es.object.to-string"),e("core-js/modules/es.reflect.construct"),e("core-js/modules/es.regexp.exec"),e("core-js/modules/es.regexp.to-string"),e("core-js/modules/es.set"),e("core-js/modules/es.string.includes"),e("core-js/modules/es.string.iterator"),e("core-js/modules/es.string.split"),e("core-js/modules/web.dom-collections.for-each"),e("core-js/modules/web.dom-collections.iterator"),Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var i=(i=e("../main"))&&i.__esModule?i:{default:i};function s(){var e;return"function"!=typeof WeakMap?null:(e=new WeakMap,s=function(){return e},e)}function o(e){return(o="function"==typeof Symbol&&"symbol"===n(Symbol.iterator)?function(e){return n(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":n(e)})(e)}(function(e){if(!(e&&e.__esModule||null===e||"object"!==o(e)&&"function"!=typeof e)){var t=s();if(t&&t.has(e))return t.get(e);var r,n={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(r in e){var a;Object.prototype.hasOwnProperty.call(e,r)&&((a=i?Object.getOwnPropertyDescriptor(e,r):null)&&(a.get||a.set)?Object.defineProperty(n,r,a):n[r]=e[r])}n.default=e,t&&t.set(e,n)}})(e("../constants")),e("../internationalization"),i.default._validateParameters=i.default._clearValidateParamsCache=function(){},e=i.default,r.default=e},{"../../../docs/parameterData.json":void 0,"../constants":256,"../internationalization":265,"../main":267,"core-js/modules/es.array.concat":149,"core-js/modules/es.array.for-each":154,"core-js/modules/es.array.includes":156,"core-js/modules/es.array.index-of":157,"core-js/modules/es.array.iterator":158,"core-js/modules/es.array.join":159,"core-js/modules/es.array.last-index-of":160,"core-js/modules/es.array.map":161,"core-js/modules/es.array.slice":162,"core-js/modules/es.function.name":165,"core-js/modules/es.map":166,"core-js/modules/es.number.constructor":169,"core-js/modules/es.object.get-own-property-descriptor":173,"core-js/modules/es.object.get-prototype-of":175,"core-js/modules/es.object.keys":176,"core-js/modules/es.object.to-string":177,"core-js/modules/es.reflect.construct":179,"core-js/modules/es.regexp.exec":181,"core-js/modules/es.regexp.to-string":182,"core-js/modules/es.set":183,"core-js/modules/es.string.includes":185,"core-js/modules/es.string.iterator":186,"core-js/modules/es.string.split":191,"core-js/modules/es.symbol":196,"core-js/modules/es.symbol.description":194,"core-js/modules/es.symbol.iterator":195,"core-js/modules/es.weak-map":228,"core-js/modules/web.dom-collections.for-each":229,"core-js/modules/web.dom-collections.iterator":230}],263:[function(e,t,r){"use strict";function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function i(e){return(i="function"==typeof Symbol&&"symbol"===n(Symbol.iterator)?function(e){return n(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":n(e)})(e)}e("core-js/modules/es.symbol"),e("core-js/modules/es.symbol.description"),e("core-js/modules/es.symbol.iterator"),e("core-js/modules/es.array.iterator"),e("core-js/modules/es.object.get-own-property-descriptor"),e("core-js/modules/es.object.to-string"),e("core-js/modules/es.string.iterator"),e("core-js/modules/es.weak-map"),e("core-js/modules/web.dom-collections.iterator"),Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var s=function(e){if(e&&e.__esModule)return e;if(null===e||"object"!==i(e)&&"function"!=typeof e)return{default:e};var t=o();if(t&&t.has(e))return t.get(e);var r,n={},s=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(r in e){var a;Object.prototype.hasOwnProperty.call(e,r)&&((a=s?Object.getOwnPropertyDescriptor(e,r):null)&&(a.get||a.set)?Object.defineProperty(n,r,a):n[r]=e[r])}return n.default=e,t&&t.set(e,n),n}(e("./constants"));function o(){var e;return"function"!=typeof WeakMap?null:(e=new WeakMap,o=function(){return e},e)}r.default={modeAdjust:function(e,t,r,n,i){return i===s.CORNER?{x:e,y:t,w:r,h:n}:i===s.CORNERS?{x:e,y:t,w:r-e,h:n-t}:i===s.RADIUS?{x:e-r,y:t-n,w:2*r,h:2*n}:i===s.CENTER?{x:e-.5*r,y:t-.5*n,w:r,h:n}:void 0}}},{"./constants":256,"core-js/modules/es.array.iterator":158,"core-js/modules/es.object.get-own-property-descriptor":173,"core-js/modules/es.object.to-string":177,"core-js/modules/es.string.iterator":186,"core-js/modules/es.symbol":196,"core-js/modules/es.symbol.description":194,"core-js/modules/es.symbol.iterator":195,"core-js/modules/es.weak-map":228,"core-js/modules/web.dom-collections.iterator":230}],264:[function(e,t,r){"use strict";e("core-js/modules/es.array.iterator"),e("core-js/modules/es.object.to-string"),e("core-js/modules/es.promise"),e("core-js/modules/es.string.iterator"),e("core-js/modules/web.dom-collections.iterator"),e("core-js/modules/es.array.iterator"),e("core-js/modules/es.object.to-string"),e("core-js/modules/es.promise"),e("core-js/modules/es.string.iterator"),e("core-js/modules/web.dom-collections.iterator");var n=(i=e("../core/main"))&&i.__esModule?i:{default:i};e("./internationalization");var i=Promise.resolve();Promise.all([new Promise((function(e,t){"complete"===document.readyState?e():window.addEventListener("load",e,!1)})),i]).then((function(){void 0!==window._setupDone||window.mocha||(window.setup&&"function"==typeof window.setup||window.draw&&"function"==typeof window.draw)&&!n.default.instance&&new n.default}))},{"../core/main":267,"./internationalization":265,"core-js/modules/es.array.iterator":158,"core-js/modules/es.object.to-string":177,"core-js/modules/es.promise":178,"core-js/modules/es.string.iterator":186,"core-js/modules/web.dom-collections.iterator":230}],265:[function(e,t,r){"use strict";e("core-js/modules/es.array.includes"),e("core-js/modules/es.array.iterator"),e("core-js/modules/es.array.join"),e("core-js/modules/es.array.slice"),e("core-js/modules/es.object.keys"),e("core-js/modules/es.object.to-string"),e("core-js/modules/es.promise"),e("core-js/modules/es.regexp.exec"),e("core-js/modules/es.string.includes"),e("core-js/modules/es.string.iterator"),e("core-js/modules/es.string.split"),e("core-js/modules/web.dom-collections.iterator"),e("core-js/modules/es.array.includes"),e("core-js/modules/es.array.iterator"),e("core-js/modules/es.array.join"),e("core-js/modules/es.array.slice"),e("core-js/modules/es.object.keys"),e("core-js/modules/es.object.to-string"),e("core-js/modules/es.promise"),e("core-js/modules/es.regexp.exec"),e("core-js/modules/es.string.includes"),e("core-js/modules/es.string.iterator"),e("core-js/modules/es.string.split"),e("core-js/modules/web.dom-collections.iterator"),Object.defineProperty(r,"__esModule",{value:!0}),r.setTranslatorLanguage=r.currentTranslatorLanguage=r.availableTranslatorLanguages=r.initialize=r.translator=void 0;var n,i=o(e("i18next")),s=o(e("i18next-browser-languagedetector"));function o(e){return e&&e.__esModule?e:{default:e}}function a(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var l=function(){function e(t,r){if(!(this instanceof e))throw new TypeError("Cannot call a class as a function");this.init(t,r)}var t,r;return t=e,(r=[{key:"fetchWithTimeout",value:function(e,t){var r=2<arguments.length&&void 0!==arguments[2]?arguments[2]:2e3;return Promise.race([fetch(e,t),new Promise((function(e,t){return setTimeout((function(){return t(new Error("timeout"))}),r)}))])}},{key:"init",value:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};this.services=e,this.options=t}},{key:"read",value:function(e,t,r){var i=this.options.loadPath;e===this.options.fallback?r(null,n[e][t]):undefined.includes(e)?(i=this.services.interpolator.interpolate(i,{lng:e,ns:t}),this.loadUrl(i,r)):r("Not found",!1)}},{key:"loadUrl",value:function(e,t){this.fetchWithTimeout(e).then((function(t){if(t.ok)return t.json();throw new Error("failed loading ".concat(e))}),(function(){throw new Error("failed loading ".concat(e))})).then((function(e){return t(null,e)})).catch(t)}}])&&a(t.prototype,r),e}();l.type="backend",r.translator=function(e,t){i.default.t(e,t)},r.initialize=function(){return i.default.use(s.default).use(l).init({fallbackLng:"en",nestingPrefix:"$tr(",nestingSuffix:")",defaultNS:"translation",returnEmptyString:!1,interpolation:{escapeValue:!1},detection:{checkWhitelist:!1,order:["querystring","navigator","htmlTag","path","subdomain"],caches:[]},backend:{fallback:"en",loadPath:"https://cdn.jsdelivr.net/npm/p5/translations/{{lng}}/{{ns}}.json"},partialBundledLanguages:!0,resources:n}).then((function(e){r.translator=e}),(function(e){}))},r.availableTranslatorLanguages=function(){return i.default.languages},r.currentTranslatorLanguage=function(e){return i.default.language},r.setTranslatorLanguage=function(e){return i.default.changeLanguage(e||void 0,(function(e){}))}},{"../../translations":void 0,"../../translations/dev":void 0,"core-js/modules/es.array.includes":156,"core-js/modules/es.array.iterator":158,"core-js/modules/es.array.join":159,"core-js/modules/es.array.slice":162,"core-js/modules/es.object.keys":176,"core-js/modules/es.object.to-string":177,"core-js/modules/es.promise":178,"core-js/modules/es.regexp.exec":181,"core-js/modules/es.string.includes":185,"core-js/modules/es.string.iterator":186,"core-js/modules/es.string.split":191,"core-js/modules/web.dom-collections.iterator":230,i18next:3,"i18next-browser-languagedetector":3}],266:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0,(e=(e=e("./main"))&&e.__esModule?e:{default:e}).default.prototype.pushStyle=function(){throw new Error("pushStyle() not used, see push()")},e.default.prototype.popStyle=function(){throw new Error("popStyle() not used, see pop()")},e.default.prototype.popMatrix=function(){throw new Error("popMatrix() not used, see pop()")},e.default.prototype.pushMatrix=function(){throw new Error("pushMatrix() not used, see push()")},e=e.default,r.default=e},{"./main":267}],267:[function(e,t,r){"use strict";function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function i(e){return(i="function"==typeof Symbol&&"symbol"===n(Symbol.iterator)?function(e){return n(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":n(e)})(e)}e("core-js/modules/es.symbol"),e("core-js/modules/es.symbol.description"),e("core-js/modules/es.symbol.iterator"),e("core-js/modules/es.array.for-each"),e("core-js/modules/es.array.iterator"),e("core-js/modules/es.array.slice"),e("core-js/modules/es.object.get-own-property-descriptor"),e("core-js/modules/es.object.get-own-property-names"),e("core-js/modules/es.object.to-string"),e("core-js/modules/es.string.iterator"),e("core-js/modules/es.weak-map"),e("core-js/modules/web.dom-collections.for-each"),e("core-js/modules/web.dom-collections.iterator"),e("core-js/modules/es.symbol"),e("core-js/modules/es.symbol.description"),e("core-js/modules/es.symbol.iterator"),e("core-js/modules/es.array.for-each"),e("core-js/modules/es.array.iterator"),e("core-js/modules/es.array.slice"),e("core-js/modules/es.object.get-own-property-names"),e("core-js/modules/es.object.to-string"),e("core-js/modules/es.string.iterator"),e("core-js/modules/web.dom-collections.for-each"),e("core-js/modules/web.dom-collections.iterator"),Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0,e("./shim");var s=function(e){if(e&&e.__esModule)return e;if(null===e||"object"!==i(e)&&"function"!=typeof e)return{default:e};var t=o();if(t&&t.has(e))return t.get(e);var r,n={},s=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(r in e){var a;Object.prototype.hasOwnProperty.call(e,r)&&((a=s?Object.getOwnPropertyDescriptor(e,r):null)&&(a.get||a.set)?Object.defineProperty(n,r,a):n[r]=e[r])}return n.default=e,t&&t.set(e,n),n}(e("./constants"));function o(){var e;return"function"!=typeof WeakMap?null:(e=new WeakMap,o=function(){return e},e)}function a(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var l,c=function(){function e(t,r,n){var i=this;if(!(this instanceof e))throw new TypeError("Cannot call a class as a function");this._setupDone=!1,this._preloadDone=!1,this._pixelDensity=Math.ceil(window.devicePixelRatio)||1,this._userNode=r,this._curElement=null,this._elements=[],this._glAttributes=null,this._requestAnimId=0,this._preloadCount=0,this._isGlobal=!1,this._loop=!0,this._initializeInstanceVariables(),this._defaultCanvasSize={width:100,height:100},this._events={mousemove:null,mousedown:null,mouseup:null,dragend:null,dragover:null,click:null,dblclick:null,mouseover:null,mouseout:null,keydown:null,keyup:null,keypress:null,touchstart:null,touchmove:null,touchend:null,resize:null,blur:null},this._millisStart=-1,this._recording=!1,this._lcg_random_state=null,this._gaussian_previous=!1,this._events.wheel=null,this._loadingScreenId="p5_loading",this._registeredMethods={};r=Object.getOwnPropertyNames(e.prototype._registeredMethods);var s=!0,o=!1,a=void 0;try{for(var l,c=r[Symbol.iterator]();!(s=(l=c.next()).done);s=!0){var u=l.value;this._registeredMethods[u]=e.prototype._registeredMethods[u].slice()}}catch(t){o=!0,a=t}finally{try{s||null==c.return||c.return()}finally{if(o)throw a}}window.DeviceOrientationEvent&&(this._events.deviceorientation=null),window.DeviceMotionEvent&&!window._isNodeWebkit&&(this._events.devicemotion=null),this._start=function(){i._userNode&&"string"==typeof i._userNode&&(i._userNode=document.getElementById(i._userNode));var t=i._isGlobal?window:i;if(t.preload){var r,n=document.getElementById(i._loadingScreenId),s=(n||((n=document.createElement("div")).innerHTML="Loading...",n.style.position="absolute",n.id=i._loadingScreenId,(i._userNode||document.body).appendChild(n)),i._preloadMethods);for(r in s){s[r]=s[r]||e;var o=s[r];o!==e.prototype&&o!==e||(i._isGlobal&&(window[r]=i._wrapPreload(i,r)),o=i),i._registeredPreloadMethods[r]=o[r],o[r]=i._wrapPreload(o,r)}t.preload(),i._runIfPreloadsAreDone()}else i._setup(),i._recording||i._draw()},this._runIfPreloadsAreDone=function(){var e,t=this._isGlobal?window:this;0===t._preloadCount&&((e=document.getElementById(t._loadingScreenId))&&e.parentNode.removeChild(e),this._setupDone||(this._lastTargetFrameTime=window.performance.now(),this._lastRealFrameTime=window.performance.now(),t._setup(),this._recording||t._draw()))},this._decrementPreload=function(){var e=this._isGlobal?window:this;e._preloadDone||"function"!=typeof e.preload||(e._setProperty("_preloadCount",e._preloadCount-1),e._runIfPreloadsAreDone())},this._wrapPreload=function(e,t){var r=this;return function(){r._incrementPreload();for(var n=arguments.length,i=new Array(n),s=0;s<n;s++)i[s]=arguments[s];return r._registeredPreloadMethods[t].apply(e,i)}},this._incrementPreload=function(){var e=this._isGlobal?window:this;e._preloadDone||e._setProperty("_preloadCount",e._preloadCount+1)},this._setup=function(){i.createCanvas(i._defaultCanvasSize.width,i._defaultCanvasSize.height,"p2d");var e=i._isGlobal?window:i;if("function"==typeof e.preload)for(var t in i._preloadMethods)e[t]=i._preloadMethods[t][t],e[t]&&i&&(e[t]=e[t].bind(i));i._millisStart=window.performance.now(),e._preloadDone=!0,"function"==typeof e.setup&&e.setup();var r=document.getElementsByTagName("canvas"),n=!0,s=!1,o=void 0;try{for(var a,l=r[Symbol.iterator]();!(n=(a=l.next()).done);n=!0){var c=a.value;"true"===c.dataset.hidden&&(c.style.visibility="",delete c.dataset.hidden)}}catch(e){s=!0,o=e}finally{try{n||null==l.return||l.return()}finally{if(s)throw o}}i._lastTargetFrameTime=window.performance.now(),i._lastRealFrameTime=window.performance.now(),i._setupDone=!0,(i._accessibleOutputs.grid||i._accessibleOutputs.text)&&i._updateAccsOutput()},this._draw=function(){var e=window.performance.now(),t=e-i._lastTargetFrameTime,r=1e3/i._targetFrameRate;(!i._loop||r-5<=t)&&(i.redraw(),i._frameRate=1e3/(e-i._lastRealFrameTime),i.deltaTime=e-i._lastRealFrameTime,i._setProperty("deltaTime",i.deltaTime),i._lastTargetFrameTime=Math.max(i._lastTargetFrameTime+r,e),i._lastRealFrameTime=e,void 0!==i._updateMouseCoords&&(i._updateMouseCoords(),i._setProperty("movedX",0),i._setProperty("movedY",0))),i._loop&&(i._requestAnimId=window.requestAnimationFrame(i._draw))},this._setProperty=function(e,t){i[e]=t,i._isGlobal&&(window[e]=t)},this.remove=function(){if((n=document.getElementById(i._loadingScreenId))&&(n.parentNode.removeChild(n),i._incrementPreload()),i._curElement){for(var t in i._loop=!1,i._requestAnimId&&window.cancelAnimationFrame(i._requestAnimId),i._events)window.removeEventListener(t,i._events[t]);var r=!0,n=!1,s=void 0;try{for(var o,a=i._elements[Symbol.iterator]();!(r=(o=a.next()).done);r=!0){var l,c=o.value;for(l in c.elt&&c.elt.parentNode&&c.elt.parentNode.removeChild(c.elt),c._events)c.elt.removeEventListener(l,c._events[l])}}catch(t){n=!0,s=t}finally{try{r||null==a.return||a.return()}finally{if(n)throw s}}var u=i;i._registeredMethods.remove.forEach((function(e){void 0!==e&&e.call(u)}))}if(i._isGlobal){for(var h in e.prototype)try{delete window[h]}catch(t){window[h]=void 0}for(var d in i)if(i.hasOwnProperty(d))try{delete window[d]}catch(t){window[d]=void 0}e.instance=null}},this._registeredMethods.init.forEach((function(e){void 0!==e&&e.call(this)}),this),this._setupPromisePreloads();var h,d,p=this._createFriendlyGlobalFunctionBinder();if(t)t(this),e._checkForUserDefinedFunctions(this);else{for(var f in this._isGlobal=!0,e.instance=this,e.prototype)"function"==typeof e.prototype[f]?(h=f.substring(2),this._events.hasOwnProperty(h)||(Math.hasOwnProperty(f)&&Math[f]===e.prototype[f]?p(f,e.prototype[f]):p(f,e.prototype[f].bind(this)))):p(f,e.prototype[f]);for(var m in this)this.hasOwnProperty(m)&&p(m,this[m])}for(d in this._events){var g=this["_on".concat(d)];g&&(g=g.bind(this),window.addEventListener(d,g,{passive:!1}),this._events[d]=g)}function y(){i._setProperty("focused",!0)}function v(){i._setProperty("focused",!1)}window.addEventListener("focus",y),window.addEventListener("blur",v),this.registerMethod("remove",(function(){window.removeEventListener("focus",y),window.removeEventListener("blur",v)})),"complete"===document.readyState?this._start():window.addEventListener("load",this._start.bind(this),!1)}var t,r;return t=e,(r=[{key:"_initializeInstanceVariables",value:function(){this._accessibleOutputs={text:!1,grid:!1,textLabel:!1,gridLabel:!1},this._styles=[],this._bezierDetail=20,this._curveDetail=20,this._colorMode=s.RGB,this._colorMaxes={rgb:[255,255,255,255],hsb:[360,100,100,1],hsl:[360,100,100,1]},this._downKeys={}}},{key:"registerPreloadMethod",value:function(t,r){e.prototype._preloadMethods.hasOwnProperty(t)||(e.prototype._preloadMethods[t]=r)}},{key:"registerMethod",value:function(t,r){var n=this||e.prototype;n._registeredMethods.hasOwnProperty(t)||(n._registeredMethods[t]=[]),n._registeredMethods[t].push(r)}},{key:"_createFriendlyGlobalFunctionBinder",value:function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},r=t.globalObject||window;return t.log,function(t,n){e.disableFriendlyErrors,r[t]=n}}}])&&a(t.prototype,r),e}();for(l in c.instance=null,c.disableFriendlyErrors=!1,s)c.prototype[l]=s[l];c.VERSION=s.VERSION,c.prototype._preloadMethods={loadJSON:c.prototype,loadImage:c.prototype,loadStrings:c.prototype,loadXML:c.prototype,loadBytes:c.prototype,loadTable:c.prototype,loadFont:c.prototype,loadModel:c.prototype,loadShader:c.prototype},c.prototype._registeredMethods={init:[],pre:[],post:[],remove:[]},c.prototype._registeredPreloadMethods={},r.default=c},{"./constants":256,"./shim":278,"core-js/modules/es.array.for-each":154,"core-js/modules/es.array.iterator":158,"core-js/modules/es.array.slice":162,"core-js/modules/es.object.get-own-property-descriptor":173,"core-js/modules/es.object.get-own-property-names":174,"core-js/modules/es.object.to-string":177,"core-js/modules/es.string.iterator":186,"core-js/modules/es.symbol":196,"core-js/modules/es.symbol.description":194,"core-js/modules/es.symbol.iterator":195,"core-js/modules/es.weak-map":228,"core-js/modules/web.dom-collections.for-each":229,"core-js/modules/web.dom-collections.iterator":230}],268:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n=(e=e("./main"))&&e.__esModule?e:{default:e};n.default.Element=function(e,t){this.elt=e,this._pInst=this._pixelsState=t,this._events={},this.width=this.elt.offsetWidth,this.height=this.elt.offsetHeight},n.default.Element.prototype.parent=function(e){return void 0===e?this.elt.parentNode:("string"==typeof e?("#"===e[0]&&(e=e.substring(1)),e=document.getElementById(e)):e instanceof n.default.Element&&(e=e.elt),e.appendChild(this.elt),this)},n.default.Element.prototype.id=function(e){return void 0===e?this.elt.id:(this.elt.id=e,this.width=this.elt.offsetWidth,this.height=this.elt.offsetHeight,this)},n.default.Element.prototype.class=function(e){return void 0===e?this.elt.className:(this.elt.className=e,this)},n.default.Element.prototype.mousePressed=function(e){return n.default.Element._adjustListener("mousedown",(function(t){return this._pInst._setProperty("mouseIsPressed",!0),this._pInst._setMouseButton(t),e.call(this,t)}),this),this},n.default.Element.prototype.doubleClicked=function(e){return n.default.Element._adjustListener("dblclick",e,this),this},n.default.Element.prototype.mouseWheel=function(e){return n.default.Element._adjustListener("wheel",e,this),this},n.default.Element.prototype.mouseReleased=function(e){return n.default.Element._adjustListener("mouseup",e,this),this},n.default.Element.prototype.mouseClicked=function(e){return n.default.Element._adjustListener("click",e,this),this},n.default.Element.prototype.mouseMoved=function(e){return n.default.Element._adjustListener("mousemove",e,this),this},n.default.Element.prototype.mouseOver=function(e){return n.default.Element._adjustListener("mouseover",e,this),this},n.default.Element.prototype.mouseOut=function(e){return n.default.Element._adjustListener("mouseout",e,this),this},n.default.Element.prototype.touchStarted=function(e){return n.default.Element._adjustListener("touchstart",e,this),this},n.default.Element.prototype.touchMoved=function(e){return n.default.Element._adjustListener("touchmove",e,this),this},n.default.Element.prototype.touchEnded=function(e){return n.default.Element._adjustListener("touchend",e,this),this},n.default.Element.prototype.dragOver=function(e){return n.default.Element._adjustListener("dragover",e,this),this},n.default.Element.prototype.dragLeave=function(e){return n.default.Element._adjustListener("dragleave",e,this),this},n.default.Element._adjustListener=function(e,t,r){return!1===t?n.default.Element._detachListener(e,r):n.default.Element._attachListener(e,t,r),this},n.default.Element._attachListener=function(e,t,r){r._events[e]&&n.default.Element._detachListener(e,r),t=t.bind(r),r.elt.addEventListener(e,t,!1),r._events[e]=t},n.default.Element._detachListener=function(e,t){var r=t._events[e];t.elt.removeEventListener(e,r,!1),t._events[e]=null},n.default.Element.prototype._setProperty=function(e,t){this[e]=t},e=n.default.Element,r.default=e},{"./main":267}],269:[function(e,t,r){"use strict";function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function i(e){return(i="function"==typeof Symbol&&"symbol"===n(Symbol.iterator)?function(e){return n(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":n(e)})(e)}e("core-js/modules/es.symbol"),e("core-js/modules/es.symbol.description"),e("core-js/modules/es.symbol.iterator"),e("core-js/modules/es.array.index-of"),e("core-js/modules/es.array.iterator"),e("core-js/modules/es.array.splice"),e("core-js/modules/es.object.get-own-property-descriptor"),e("core-js/modules/es.object.to-string"),e("core-js/modules/es.string.iterator"),e("core-js/modules/es.weak-map"),e("core-js/modules/web.dom-collections.iterator"),e("core-js/modules/es.array.index-of"),e("core-js/modules/es.array.splice"),Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var s=(l=e("./main"))&&l.__esModule?l:{default:l},o=function(e){if(e&&e.__esModule)return e;if(null===e||"object"!==i(e)&&"function"!=typeof e)return{default:e};var t=a();if(t&&t.has(e))return t.get(e);var r,n={},s=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(r in e){var o;Object.prototype.hasOwnProperty.call(e,r)&&((o=s?Object.getOwnPropertyDescriptor(e,r):null)&&(o.get||o.set)?Object.defineProperty(n,r,o):n[r]=e[r])}return n.default=e,t&&t.set(e,n),n}(e("./constants"));function a(){var e;return"function"!=typeof WeakMap?null:(e=new WeakMap,a=function(){return e},e)}s.default.Graphics=function(e,t,r,n){var i;r=r||o.P2D;for(i in this.canvas=document.createElement("canvas"),(n._userNode||document.body).appendChild(this.canvas),s.default.Element.call(this,this.canvas,n),s.default.prototype)this[i]||("function"==typeof s.default.prototype[i]?this[i]=s.default.prototype[i].bind(this):this[i]=s.default.prototype[i]);return s.default.prototype._initializeInstanceVariables.apply(this),this.width=e,this.height=t,this._pixelDensity=n._pixelDensity,r===o.WEBGL?this._renderer=new s.default.RendererGL(this.canvas,this,!1):this._renderer=new s.default.Renderer2D(this.canvas,this,!1),n._elements.push(this),Object.defineProperty(this,"deltaTime",{get:function(){return this._pInst.deltaTime}}),this._renderer.resize(e,t),this._renderer._applyDefaults(),this},s.default.Graphics.prototype=Object.create(s.default.Element.prototype),s.default.Graphics.prototype.reset=function(){this._renderer.resetMatrix(),this._renderer.isP3D&&this._renderer._update()},s.default.Graphics.prototype.remove=function(){this.elt.parentNode&&this.elt.parentNode.removeChild(this.elt);var e,t=this._pInst._elements.indexOf(this);for(e in-1!==t&&this._pInst._elements.splice(t,1),this._events)this.elt.removeEventListener(e,this._events[e])};var l=s.default.Graphics;r.default=l},{"./constants":256,"./main":267,"core-js/modules/es.array.index-of":157,"core-js/modules/es.array.iterator":158,"core-js/modules/es.array.splice":164,"core-js/modules/es.object.get-own-property-descriptor":173,"core-js/modules/es.object.to-string":177,"core-js/modules/es.string.iterator":186,"core-js/modules/es.symbol":196,"core-js/modules/es.symbol.description":194,"core-js/modules/es.symbol.iterator":195,"core-js/modules/es.weak-map":228,"core-js/modules/web.dom-collections.iterator":230}],270:[function(e,t,r){"use strict";function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}e("core-js/modules/es.symbol"),e("core-js/modules/es.symbol.description"),e("core-js/modules/es.symbol.iterator"),e("core-js/modules/es.array.iterator"),e("core-js/modules/es.number.constructor"),e("core-js/modules/es.object.assign"),e("core-js/modules/es.object.get-own-property-descriptor"),e("core-js/modules/es.object.to-string"),e("core-js/modules/es.regexp.exec"),e("core-js/modules/es.regexp.to-string"),e("core-js/modules/es.string.iterator"),e("core-js/modules/es.string.replace"),e("core-js/modules/es.string.split"),e("core-js/modules/es.string.trim"),e("core-js/modules/es.weak-map"),e("core-js/modules/web.dom-collections.iterator"),e("core-js/modules/es.symbol"),e("core-js/modules/es.symbol.description"),e("core-js/modules/es.symbol.iterator"),e("core-js/modules/es.array.iterator"),e("core-js/modules/es.number.constructor"),e("core-js/modules/es.object.assign"),e("core-js/modules/es.object.to-string"),e("core-js/modules/es.regexp.exec"),e("core-js/modules/es.regexp.to-string"),e("core-js/modules/es.string.iterator"),e("core-js/modules/es.string.replace"),e("core-js/modules/es.string.split"),e("core-js/modules/es.string.trim"),e("core-js/modules/web.dom-collections.iterator"),Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var i=(c=e("./main"))&&c.__esModule?c:{default:c},s=function(e){if(e&&e.__esModule)return e;if(null===e||"object"!==a(e)&&"function"!=typeof e)return{default:e};var t=o();if(t&&t.has(e))return t.get(e);var r,n={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(r in e){var s;Object.prototype.hasOwnProperty.call(e,r)&&((s=i?Object.getOwnPropertyDescriptor(e,r):null)&&(s.get||s.set)?Object.defineProperty(n,r,s):n[r]=e[r])}return n.default=e,t&&t.set(e,n),n}(e("../core/constants"));function o(){var e;return"function"!=typeof WeakMap?null:(e=new WeakMap,o=function(){return e},e)}function a(e){return(a="function"==typeof Symbol&&"symbol"===n(Symbol.iterator)?function(e){return n(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":n(e)})(e)}function l(e){var t=0,r=0;if(e.offsetParent)for(;t+=e.offsetLeft,r+=e.offsetTop,e=e.offsetParent;);else t+=e.offsetLeft,r+=e.offsetTop;return[t,r]}i.default.Renderer=function(e,t,r){i.default.Element.call(this,e,t),this.canvas=e,this._pixelsState=t,r?(this._isMainCanvas=!0,this._pInst._setProperty("_curElement",this),this._pInst._setProperty("canvas",this.canvas),this._pInst._setProperty("width",this.width),this._pInst._setProperty("height",this.height)):(this.canvas.style.display="none",this._styles=[]),this._textSize=12,this._textLeading=15,this._textFont="sans-serif",this._textStyle=s.NORMAL,this._textAscent=null,this._textDescent=null,this._textAlign=s.LEFT,this._textBaseline=s.BASELINE,this._textWrap=s.WORD,this._rectMode=s.CORNER,this._ellipseMode=s.CENTER,this._curveTightness=0,this._imageMode=s.CORNER,this._tint=null,this._doStroke=!0,this._doFill=!0,this._strokeSet=!1,this._fillSet=!1,this._leadingSet=!1},i.default.Renderer.prototype=Object.create(i.default.Element.prototype),i.default.Renderer.prototype.push=function(){return{properties:{_doStroke:this._doStroke,_strokeSet:this._strokeSet,_doFill:this._doFill,_fillSet:this._fillSet,_tint:this._tint,_imageMode:this._imageMode,_rectMode:this._rectMode,_ellipseMode:this._ellipseMode,_textFont:this._textFont,_textLeading:this._textLeading,_leadingSet:this._leadingSet,_textSize:this._textSize,_textAlign:this._textAlign,_textBaseline:this._textBaseline,_textStyle:this._textStyle,_textWrap:this._textWrap}}},i.default.Renderer.prototype.pop=function(e){e.properties&&Object.assign(this,e.properties)},i.default.Renderer.prototype.resize=function(e,t){this.width=e,this.height=t,this.elt.width=e*this._pInst._pixelDensity,this.elt.height=t*this._pInst._pixelDensity,this.elt.style.width="".concat(e,"px"),this.elt.style.height="".concat(t,"px"),this._isMainCanvas&&(this._pInst._setProperty("width",this.width),this._pInst._setProperty("height",this.height))},i.default.Renderer.prototype.get=function(e,t,r,n){var s=this._pixelsState,o=s._pixelDensity,a=this.canvas;if(void 0===e&&void 0===t)e=t=0,r=s.width,n=s.height;else if(e*=o,t*=o,void 0===r&&void 0===n)return e<0||t<0||e>=a.width||t>=a.height?[0,0,0,0]:this._getPixel(e,t);return(s=new i.default.Image(r,n)).canvas.getContext("2d").drawImage(a,e,t,r*o,n*o,0,0,r,n),s},i.default.Renderer.prototype.textLeading=function(e){return"number"==typeof e?(this._setProperty("_leadingSet",!0),this._setProperty("_textLeading",e),this._pInst):this._textLeading},i.default.Renderer.prototype.textSize=function(e){return"number"==typeof e?(this._setProperty("_textSize",e),this._leadingSet||this._setProperty("_textLeading",e*s._DEFAULT_LEADMULT),this._applyTextProperties()):this._textSize},i.default.Renderer.prototype.textStyle=function(e){return e?(e!==s.NORMAL&&e!==s.ITALIC&&e!==s.BOLD&&e!==s.BOLDITALIC||this._setProperty("_textStyle",e),this._applyTextProperties()):this._textStyle},i.default.Renderer.prototype.textAscent=function(){return null===this._textAscent&&this._updateTextMetrics(),this._textAscent},i.default.Renderer.prototype.textDescent=function(){return null===this._textDescent&&this._updateTextMetrics(),this._textDescent},i.default.Renderer.prototype.textAlign=function(e,t){return void 0!==e?(this._setProperty("_textAlign",e),void 0!==t&&this._setProperty("_textBaseline",t),this._applyTextProperties()):{horizontal:this._textAlign,vertical:this._textBaseline}},i.default.Renderer.prototype.textWrap=function(e){return this._setProperty("_textWrap",e),this._textWrap},i.default.Renderer.prototype.text=function(e,t,r,n,i){var o,a,l,c,u=this._pInst,h=this._textWrap,d=Number.MAX_VALUE,p=r;if((this._doFill||this._doStroke)&&void 0!==e){if(o=(e=(e="string"!=typeof e?e.toString():e).replace(/(\t)/g,"  ")).split("\n"),void 0!==n){switch(this._rectMode===s.CENTER&&(t-=n/2),this._textAlign){case s.CENTER:t+=n/2;break;case s.RIGHT:t+=n}if(void 0!==i){this._rectMode===s.CENTER&&(r-=i/2,p-=i/2);e=r;var f=u.textAscent();switch(this._textBaseline){case s.BOTTOM:c=r+i,r=Math.max(c,r),p+=f;break;case s.CENTER:c=r+i/2,r=Math.max(c,r),p+=f/2}d=r+i-f,this._textBaseline===s.CENTER&&(d=e+i-f/2)}else{if(this._textBaseline===s.BOTTOM)return;if(this._textBaseline===s.CENTER)return}if(h===s.WORD){for(var m=[],g=0;g<o.length;g++){for(var y="",v=o[g].split(" "),_=0;_<v.length;_++)a="".concat(y+v[_])+" ",y=n<(l=this.textWidth(a))&&0<y.length?(m.push(y),"".concat(v[_])+" "):a;m.push(y)}var x=0;this._textBaseline===s.CENTER?x=(m.length-1)*u.textLeading()/2:this._textBaseline===s.BOTTOM&&(x=(m.length-1)*u.textLeading());for(var b=0;b<o.length;b++){y="",v=o[b].split(" ");for(var w=0;w<v.length;w++)a="".concat(y+v[w])+" ",n<(l=this.textWidth(a))&&0<y.length?(this._renderText(u,y.trim(),t,r-x,d,p),y="".concat(v[w])+" ",r+=u.textLeading()):y=a;this._renderText(u,y.trim(),t,r-x,d,p),r+=u.textLeading()}}else{for(var S=[],M=0;M<o.length;M++)for(var T=o[M].split(y=""),E=0;E<T.length;E++)a="".concat(y+T[E]),(l=this.textWidth(a))<=n?y+=T[E]:n<l&&0<y.length&&(S.push(y),y="".concat(T[E]));S.push(y);var A=0;this._textBaseline===s.CENTER?A=(S.length-1)*u.textLeading()/2:this._textBaseline===s.BOTTOM&&(A=(S.length-1)*u.textLeading());for(var C=0;C<o.length;C++){T=o[C].split(y="");for(var L=0;L<T.length;L++)a="".concat(y+T[L]),(l=this.textWidth(a))<=n?y+=T[L]:n<l&&0<y.length&&(this._renderText(u,y.trim(),t,r-A,d,p),r+=u.textLeading(),y="".concat(T[L]))}this._renderText(u,y.trim(),t,r-A,d,p),r+=u.textLeading()}}else{var R=0;this._textBaseline===s.CENTER?R=(o.length-1)*u.textLeading()/2:this._textBaseline===s.BOTTOM&&(R=(o.length-1)*u.textLeading());for(var P=0;P<o.length;P++)this._renderText(u,o[P],t,r-R,d,p-R),r+=u.textLeading()}return u}},i.default.Renderer.prototype._applyDefaults=function(){return this},i.default.Renderer.prototype._isOpenType=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:this._textFont;return"object"===a(e)&&e.font&&e.font.supported},i.default.Renderer.prototype._updateTextMetrics=function(){var e,t,r,n,i,s;return this._isOpenType()?(this._setProperty("_textAscent",this._textFont._textAscent()),this._setProperty("_textDescent",this._textFont._textDescent())):((e=document.createElement("span")).style.fontFamily=this._textFont,e.style.fontSize="".concat(this._textSize,"px"),e.innerHTML="ABCjgq|",(s=document.createElement("div")).style.display="inline-block",s.style.width="1px",s.style.height="0px",(t=document.createElement("div")).appendChild(e),t.appendChild(s),t.style.height="0px",t.style.overflow="hidden",document.body.appendChild(t),s.style.verticalAlign="baseline",n=l(s),i=l(e),r=n[1]-i[1],s.style.verticalAlign="bottom",n=l(s),i=l(e),s=n[1]-i[1]-r,document.body.removeChild(t),this._setProperty("_textAscent",r),this._setProperty("_textDescent",s)),this};var c=i.default.Renderer;r.default=c},{"../core/constants":256,"./main":267,"core-js/modules/es.array.iterator":158,"core-js/modules/es.number.constructor":169,"core-js/modules/es.object.assign":172,"core-js/modules/es.object.get-own-property-descriptor":173,"core-js/modules/es.object.to-string":177,"core-js/modules/es.regexp.exec":181,"core-js/modules/es.regexp.to-string":182,"core-js/modules/es.string.iterator":186,"core-js/modules/es.string.replace":189,"core-js/modules/es.string.split":191,"core-js/modules/es.string.trim":193,"core-js/modules/es.symbol":196,"core-js/modules/es.symbol.description":194,"core-js/modules/es.symbol.iterator":195,"core-js/modules/es.weak-map":228,"core-js/modules/web.dom-collections.iterator":230}],271:[function(e,t,r){"use strict";function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function i(e){return(i="function"==typeof Symbol&&"symbol"===n(Symbol.iterator)?function(e){return n(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":n(e)})(e)}e("core-js/modules/es.symbol"),e("core-js/modules/es.symbol.description"),e("core-js/modules/es.symbol.iterator"),e("core-js/modules/es.array.concat"),e("core-js/modules/es.array.fill"),e("core-js/modules/es.array.for-each"),e("core-js/modules/es.array.iterator"),e("core-js/modules/es.array.join"),e("core-js/modules/es.array.slice"),e("core-js/modules/es.function.name"),e("core-js/modules/es.number.to-fixed"),e("core-js/modules/es.object.get-own-property-descriptor"),e("core-js/modules/es.object.to-string"),e("core-js/modules/es.regexp.to-string"),e("core-js/modules/es.string.iterator"),e("core-js/modules/es.weak-map"),e("core-js/modules/web.dom-collections.iterator"),e("core-js/modules/es.array.concat"),e("core-js/modules/es.array.fill"),e("core-js/modules/es.array.for-each"),e("core-js/modules/es.array.join"),e("core-js/modules/es.array.slice"),e("core-js/modules/es.function.name"),e("core-js/modules/es.number.to-fixed"),e("core-js/modules/es.object.to-string"),e("core-js/modules/es.regexp.to-string"),Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var s=(c=e("./main"))&&c.__esModule?c:{default:c},o=function(e){if(e&&e.__esModule)return e;if(null===e||"object"!==i(e)&&"function"!=typeof e)return{default:e};var t=a();if(t&&t.has(e))return t.get(e);var r,n={},s=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(r in e){var o;Object.prototype.hasOwnProperty.call(e,r)&&((o=s?Object.getOwnPropertyDescriptor(e,r):null)&&(o.get||o.set)?Object.defineProperty(n,r,o):n[r]=e[r])}return n.default=e,t&&t.set(e,n),n}(e("./constants"));function a(){var e;return"function"!=typeof WeakMap?null:(e=new WeakMap,a=function(){return e},e)}e("./p5.Renderer");var l="rgba(0,0,0,0)",c=(s.default.Renderer2D=function(e,t,r){return s.default.Renderer.call(this,e,t,r),this.drawingContext=this.canvas.getContext("2d"),this._pInst._setProperty("drawingContext",this.drawingContext),this},s.default.Renderer2D.prototype=Object.create(s.default.Renderer.prototype),s.default.Renderer2D.prototype._applyDefaults=function(){this._cachedFillStyle=this._cachedStrokeStyle=void 0,this._cachedBlendMode=o.BLEND,this._setFill(o._DEFAULT_FILL),this._setStroke(o._DEFAULT_STROKE),this.drawingContext.lineCap=o.ROUND,this.drawingContext.font="normal 12px sans-serif"},s.default.Renderer2D.prototype.resize=function(e,t){s.default.Renderer.prototype.resize.call(this,e,t),this.drawingContext.scale(this._pInst._pixelDensity,this._pInst._pixelDensity)},s.default.Renderer2D.prototype.background=function(){var e,t;this.drawingContext.save(),this.resetMatrix(),(arguments.length<=0?void 0:arguments[0])instanceof s.default.Image?0<=(arguments.length<=1?void 0:arguments[1])?(e=arguments.length<=0?void 0:arguments[0],this.drawingContext.globalAlpha=(arguments.length<=1?void 0:arguments[1])/255,this._pInst.image(e,0,0,this.width,this.height)):this._pInst.image(arguments.length<=0?void 0:arguments[0],0,0,this.width,this.height):(e=this._getFill(),t=(t=this._pInst).color.apply(t,arguments),this._pInst._addAccsOutput()&&this._pInst._accsBackground(t.levels),t=t.toString(),this._setFill(t),this._isErasing&&this.blendMode(this._cachedBlendMode),this.drawingContext.fillRect(0,0,this.width,this.height),this._setFill(e),this._isErasing&&this._pInst.erase()),this.drawingContext.restore()},s.default.Renderer2D.prototype.clear=function(){this.drawingContext.save(),this.resetMatrix(),this.drawingContext.clearRect(0,0,this.width,this.height),this.drawingContext.restore()},s.default.Renderer2D.prototype.fill=function(){var e=(e=this._pInst).color.apply(e,arguments);this._setFill(e.toString()),this._pInst._addAccsOutput()&&this._pInst._accsCanvasColors("fill",e.levels)},s.default.Renderer2D.prototype.stroke=function(){var e=(e=this._pInst).color.apply(e,arguments);this._setStroke(e.toString()),this._pInst._addAccsOutput()&&this._pInst._accsCanvasColors("stroke",e.levels)},s.default.Renderer2D.prototype.erase=function(e,t){this._isErasing||(this._cachedFillStyle=this.drawingContext.fillStyle,e=this._pInst.color(255,e).toString(),this.drawingContext.fillStyle=e,this._cachedStrokeStyle=this.drawingContext.strokeStyle,e=this._pInst.color(255,t).toString(),this.drawingContext.strokeStyle=e,t=this._cachedBlendMode,this.blendMode(o.REMOVE),this._cachedBlendMode=t,this._isErasing=!0)},s.default.Renderer2D.prototype.noErase=function(){this._isErasing&&(this.drawingContext.fillStyle=this._cachedFillStyle,this.drawingContext.strokeStyle=this._cachedStrokeStyle,this.blendMode(this._cachedBlendMode),this._isErasing=!1)},s.default.Renderer2D.prototype.image=function(e,t,r,n,i,o,a,l,c){e.gifProperties&&e._animateGif(this._pInst);try{s.default.MediaElement&&e instanceof s.default.MediaElement&&e._ensureCanvas();var u=(u=this._tint&&e.canvas?this._getTintedImageCanvas(e):u)||e.canvas||e.elt,h=1;e.width&&0<e.width&&(h=u.width/e.width),this._isErasing&&this.blendMode(this._cachedBlendMode),this.drawingContext.drawImage(u,h*t,h*r,h*n,h*i,o,a,l,c),this._isErasing&&this._pInst.erase()}catch(e){if("NS_ERROR_NOT_AVAILABLE"!==e.name)throw e}},s.default.Renderer2D.prototype._getTintedImageCanvas=function(e){if(!e.canvas)return e;e.tintCanvas||(e.tintCanvas=document.createElement("canvas")),e.tintCanvas.width!==e.canvas.width&&(e.tintCanvas.width=e.canvas.width),e.tintCanvas.height!==e.canvas.height&&(e.tintCanvas.height=e.canvas.height);var t=e.tintCanvas.getContext("2d");return t.save(),t.clearRect(0,0,e.canvas.width,e.canvas.height),(this._tint[0]<255||this._tint[1]<255||this._tint[2]<255)&&(t.drawImage(e.canvas,0,0),t.globalCompositeOperation="luminosity",t.drawImage(e.canvas,0,0),t.globalCompositeOperation="color",t.drawImage(e.canvas,0,0),t.globalCompositeOperation="multiply",t.fillStyle="rgb(".concat(this._tint.slice(0,3).join(", "),")"),t.fillRect(0,0,e.canvas.width,e.canvas.height),t.globalCompositeOperation="destination-in"),t.globalAlpha=this._tint[3]/255,t.drawImage(e.canvas,0,0),t.restore(),e.tintCanvas},s.default.Renderer2D.prototype.blendMode=function(e){if(e===o.SUBTRACT);else{if(e!==o.BLEND&&e!==o.REMOVE&&e!==o.DARKEST&&e!==o.LIGHTEST&&e!==o.DIFFERENCE&&e!==o.MULTIPLY&&e!==o.EXCLUSION&&e!==o.SCREEN&&e!==o.REPLACE&&e!==o.OVERLAY&&e!==o.HARD_LIGHT&&e!==o.SOFT_LIGHT&&e!==o.DODGE&&e!==o.BURN&&e!==o.ADD)throw new Error("Mode ".concat(e," not recognized."));this._cachedBlendMode=e,this.drawingContext.globalCompositeOperation=e}},s.default.Renderer2D.prototype.blend=function(){for(var e=this.drawingContext.globalCompositeOperation,t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];var i=r[r.length-1],o=Array.prototype.slice.call(r,0,r.length-1);this.drawingContext.globalCompositeOperation=i,s.default.prototype.copy.apply(this,o),this.drawingContext.globalCompositeOperation=e},s.default.Renderer2D.prototype._getPixel=function(e,t){return[(e=this.drawingContext.getImageData(e,t,1,1).data)[0],e[1],e[2],e[3]]},s.default.Renderer2D.prototype.loadPixels=function(){var e=this._pixelsState,t=e._pixelDensity,r=this.width*t;t=this.height*t,r=this.drawingContext.getImageData(0,0,r,t);e._setProperty("imageData",r),e._setProperty("pixels",r.data)},s.default.Renderer2D.prototype.set=function(e,t,r){e=Math.floor(e),t=Math.floor(t);var n=this._pixelsState;if(r instanceof s.default.Image)this.drawingContext.save(),this.drawingContext.setTransform(1,0,0,1,0,0),this.drawingContext.scale(n._pixelDensity,n._pixelDensity),this.drawingContext.clearRect(e,t,r.width,r.height),this.drawingContext.drawImage(r.canvas,e,t),this.drawingContext.restore();else{var i=0,o=0,a=0,l=0,c=4*(t*n._pixelDensity*(this.width*n._pixelDensity)+e*n._pixelDensity);if(n.imageData||n.loadPixels.call(n),"number"==typeof r)c<n.pixels.length&&(a=o=i=r,l=255);else if(r instanceof Array){if(r.length<4)throw new Error("pixel array must be of the form [R, G, B, A]");c<n.pixels.length&&(i=r[0],o=r[1],a=r[2],l=r[3])}else r instanceof s.default.Color&&c<n.pixels.length&&(i=r.levels[0],o=r.levels[1],a=r.levels[2],l=r.levels[3]);for(var u=0;u<n._pixelDensity;u++)for(var h=0;h<n._pixelDensity;h++)c=4*((t*n._pixelDensity+h)*this.width*n._pixelDensity+(e*n._pixelDensity+u)),n.pixels[c]=i,n.pixels[c+1]=o,n.pixels[c+2]=a,n.pixels[c+3]=l}},s.default.Renderer2D.prototype.updatePixels=function(e,t,r,n){var i=this._pixelsState,s=i._pixelDensity;void 0===e&&void 0===t&&void 0===r&&void 0===n&&(t=e=0,r=this.width,n=this.height),e*=s,t*=s,r*=s,n*=s,this.gifProperties&&(this.gifProperties.frames[this.gifProperties.displayIndex].image=i.imageData),this.drawingContext.putImageData(i.imageData,e,t,0,0,r,n)},s.default.Renderer2D.prototype._acuteArcToBezier=function(e,t){var r=t/2,n=Math.cos(r),i=Math.sin(r),s=1/Math.tan(r),o=(r=e+r,Math.cos(r)),a=(r=Math.sin(r),(4-n)/3);i+=(n-a)*s;return{ax:Math.cos(e).toFixed(7),ay:Math.sin(e).toFixed(7),bx:(a*o+i*r).toFixed(7),by:(a*r-i*o).toFixed(7),cx:(a*o-i*r).toFixed(7),cy:(a*r+i*o).toFixed(7),dx:Math.cos(e+t).toFixed(7),dy:Math.sin(e+t).toFixed(7)}},s.default.Renderer2D.prototype.arc=function(e,t,r,n,i,s,a){var l,c=this.drawingContext,u=r/2,h=n/2,d=[];for(e+=u,t+=h;1e-5<=s-i;)l=Math.min(s-i,o.HALF_PI),d.push(this._acuteArcToBezier(i,l)),i+=l;return this._doFill&&(c.beginPath(),d.forEach((function(r,n){0===n&&c.moveTo(e+r.ax*u,t+r.ay*h),c.bezierCurveTo(e+r.bx*u,t+r.by*h,e+r.cx*u,t+r.cy*h,e+r.dx*u,t+r.dy*h)})),a!==o.PIE&&null!=a||c.lineTo(e,t),c.closePath(),c.fill()),this._doStroke&&(c.beginPath(),d.forEach((function(r,n){0===n&&c.moveTo(e+r.ax*u,t+r.ay*h),c.bezierCurveTo(e+r.bx*u,t+r.by*h,e+r.cx*u,t+r.cy*h,e+r.dx*u,t+r.dy*h)})),a===o.PIE?(c.lineTo(e,t),c.closePath()):a===o.CHORD&&c.closePath(),c.stroke()),this},s.default.Renderer2D.prototype.ellipse=function(e){var t=this.drawingContext,r=this._doFill,n=this._doStroke,i=parseFloat(e[0]),s=parseFloat(e[1]),o=parseFloat(e[2]);e=parseFloat(e[3]);if(r&&!n){if(this._getFill()===l)return this}else if(!r&&n&&this._getStroke()===l)return this;var a=o/2*.5522847498,c=e/2*.5522847498,u=i+o,h=s+e;o=i+o/2,e=s+e/2;t.beginPath(),t.moveTo(i,e),t.bezierCurveTo(i,e-c,o-a,s,o,s),t.bezierCurveTo(o+a,s,u,e-c,u,e),t.bezierCurveTo(u,e+c,o+a,h,o,h),t.bezierCurveTo(o-a,h,i,e+c,i,e),r&&t.fill(),n&&t.stroke()},s.default.Renderer2D.prototype.line=function(e,t,r,n){var i=this.drawingContext;return this._doStroke&&this._getStroke()!==l&&(i.beginPath(),i.moveTo(e,t),i.lineTo(r,n),i.stroke()),this},s.default.Renderer2D.prototype.point=function(e,t){var r,n,i=this.drawingContext;return this._doStroke&&this._getStroke()!==l?(r=this._getStroke(),n=this._getFill(),this._setFill(r),i.beginPath(),i.arc(e,t,i.lineWidth/2,0,o.TWO_PI,!1),i.fill(),void this._setFill(n)):this},s.default.Renderer2D.prototype.quad=function(e,t,r,n,i,s,o,a){var c=this.drawingContext,u=this._doFill,h=this._doStroke;if(u&&!h){if(this._getFill()===l)return this}else if(!u&&h&&this._getStroke()===l)return this;return c.beginPath(),c.moveTo(e,t),c.lineTo(r,n),c.lineTo(i,s),c.lineTo(o,a),c.closePath(),u&&c.fill(),h&&c.stroke(),this},s.default.Renderer2D.prototype.rect=function(e){var t,r,n=e[0],i=e[1],s=e[2],o=e[3],a=e[4],c=e[5],u=e[6],h=(e=e[7],this.drawingContext),d=this._doFill,p=this._doStroke;if(d&&!p){if(this._getFill()===l)return this}else if(!d&&p&&this._getStroke()===l)return this;return h.beginPath(),void 0===a?h.rect(n,i,s,o):(void 0===c&&(c=a),void 0===u&&(u=c),void 0===e&&(e=u),p=(d=Math.abs(s))/2,r=(t=Math.abs(o))/2,t<2*(a=d<2*a?p:a)&&(a=r),t<2*(c=d<2*c?p:c)&&(c=r),t<2*(u=d<2*u?p:u)&&(u=r),t<2*(e=d<2*e?p:e)&&(e=r),h.beginPath(),h.moveTo(n+a,i),h.arcTo(n+s,i,n+s,i+o,c),h.arcTo(n+s,i+o,n,i+o,u),h.arcTo(n,i+o,n,i,e),h.arcTo(n,i,n+s,i,a),h.closePath()),this._doFill&&h.fill(),this._doStroke&&h.stroke(),this},s.default.Renderer2D.prototype.triangle=function(e){var t=this.drawingContext,r=this._doFill,n=this._doStroke,i=e[0],s=e[1],o=e[2],a=e[3],c=e[4];e=e[5];if(r&&!n){if(this._getFill()===l)return this}else if(!r&&n&&this._getStroke()===l)return this;t.beginPath(),t.moveTo(i,s),t.lineTo(o,a),t.lineTo(c,e),t.closePath(),r&&t.fill(),n&&t.stroke()},s.default.Renderer2D.prototype.endShape=function(e,t,r,n,i,s,a){if(0!==t.length&&(this._doStroke||this._doFill)){var l,c,u,h=e===o.CLOSE,d=(h&&!s&&t.push(t[0]),t.length);if(!r||a!==o.POLYGON&&null!==a)if(!n||a!==o.POLYGON&&null!==a)if(!i||a!==o.POLYGON&&null!==a)if(a===o.POINTS)for(c=0;c<d;c++)l=t[c],this._doStroke&&this._pInst.stroke(l[6]),this._pInst.point(l[0],l[1]);else if(a===o.LINES)for(c=0;c+1<d;c+=2)l=t[c],this._doStroke&&this._pInst.stroke(t[c+1][6]),this._pInst.line(l[0],l[1],t[c+1][0],t[c+1][1]);else if(a===o.TRIANGLES)for(c=0;c+2<d;c+=3)l=t[c],this.drawingContext.beginPath(),this.drawingContext.moveTo(l[0],l[1]),this.drawingContext.lineTo(t[c+1][0],t[c+1][1]),this.drawingContext.lineTo(t[c+2][0],t[c+2][1]),this.drawingContext.closePath(),this._doFill&&(this._pInst.fill(t[c+2][5]),this.drawingContext.fill()),this._doStroke&&(this._pInst.stroke(t[c+2][6]),this.drawingContext.stroke());else if(a===o.TRIANGLE_STRIP)for(c=0;c+1<d;c++)l=t[c],this.drawingContext.beginPath(),this.drawingContext.moveTo(t[c+1][0],t[c+1][1]),this.drawingContext.lineTo(l[0],l[1]),this._doStroke&&this._pInst.stroke(t[c+1][6]),this._doFill&&this._pInst.fill(t[c+1][5]),c+2<d&&(this.drawingContext.lineTo(t[c+2][0],t[c+2][1]),this._doStroke&&this._pInst.stroke(t[c+2][6]),this._doFill&&this._pInst.fill(t[c+2][5])),this._doFillStrokeClose(h);else if(a===o.TRIANGLE_FAN){if(2<d){for(this.drawingContext.beginPath(),c=2;c<d;c++)l=t[c],this.drawingContext.moveTo(t[0][0],t[0][1]),this.drawingContext.lineTo(t[c-1][0],t[c-1][1]),this.drawingContext.lineTo(l[0],l[1]),this.drawingContext.lineTo(t[0][0],t[0][1]),c<d-1&&(this._doFill&&l[5]!==t[c+1][5]||this._doStroke&&l[6]!==t[c+1][6])&&(this._doFill&&(this._pInst.fill(l[5]),this.drawingContext.fill(),this._pInst.fill(t[c+1][5])),this._doStroke&&(this._pInst.stroke(l[6]),this.drawingContext.stroke(),this._pInst.stroke(t[c+1][6])),this.drawingContext.closePath(),this.drawingContext.beginPath());this._doFillStrokeClose(h)}}else if(a===o.QUADS)for(c=0;c+3<d;c+=4){for(l=t[c],this.drawingContext.beginPath(),this.drawingContext.moveTo(l[0],l[1]),u=1;u<4;u++)this.drawingContext.lineTo(t[c+u][0],t[c+u][1]);this.drawingContext.lineTo(l[0],l[1]),this._doFill&&this._pInst.fill(t[c+3][5]),this._doStroke&&this._pInst.stroke(t[c+3][6]),this._doFillStrokeClose(h)}else if(a===o.QUAD_STRIP){if(3<d)for(c=0;c+1<d;c+=2)l=t[c],this.drawingContext.beginPath(),c+3<d?(this.drawingContext.moveTo(t[c+2][0],t[c+2][1]),this.drawingContext.lineTo(l[0],l[1]),this.drawingContext.lineTo(t[c+1][0],t[c+1][1]),this.drawingContext.lineTo(t[c+3][0],t[c+3][1]),this._doFill&&this._pInst.fill(t[c+3][5]),this._doStroke&&this._pInst.stroke(t[c+3][6])):(this.drawingContext.moveTo(l[0],l[1]),this.drawingContext.lineTo(t[c+1][0],t[c+1][1])),this._doFillStrokeClose(h)}else{for(this.drawingContext.beginPath(),this.drawingContext.moveTo(t[0][0],t[0][1]),c=1;c<d;c++)(l=t[c]).isVert&&(l.moveTo?this.drawingContext.moveTo(l[0],l[1]):this.drawingContext.lineTo(l[0],l[1]));this._doFillStrokeClose(h)}else{for(this.drawingContext.beginPath(),c=0;c<d;c++)t[c].isVert?t[c].moveTo?this.drawingContext.moveTo(t[c][0],t[c][1]):this.drawingContext.lineTo(t[c][0],t[c][1]):this.drawingContext.quadraticCurveTo(t[c][0],t[c][1],t[c][2],t[c][3]);this._doFillStrokeClose(h)}else{for(this.drawingContext.beginPath(),c=0;c<d;c++)t[c].isVert?t[c].moveTo?this.drawingContext.moveTo(t[c][0],t[c][1]):this.drawingContext.lineTo(t[c][0],t[c][1]):this.drawingContext.bezierCurveTo(t[c][0],t[c][1],t[c][2],t[c][3],t[c][4],t[c][5]);this._doFillStrokeClose(h)}else if(3<d){var p=[],f=1-this._curveTightness;for(this.drawingContext.beginPath(),this.drawingContext.moveTo(t[1][0],t[1][1]),c=1;c+2<d;c++)l=t[c],p[0]=[l[0],l[1]],p[1]=[l[0]+(f*t[c+1][0]-f*t[c-1][0])/6,l[1]+(f*t[c+1][1]-f*t[c-1][1])/6],p[2]=[t[c+1][0]+(f*t[c][0]-f*t[c+2][0])/6,t[c+1][1]+(f*t[c][1]-f*t[c+2][1])/6],p[3]=[t[c+1][0],t[c+1][1]],this.drawingContext.bezierCurveTo(p[1][0],p[1][1],p[2][0],p[2][1],p[3][0],p[3][1]);h&&this.drawingContext.lineTo(t[c+1][0],t[c+1][1]),this._doFillStrokeClose(h)}s=i=n=r=!1,h&&t.pop()}return this},s.default.Renderer2D.prototype.strokeCap=function(e){return e!==o.ROUND&&e!==o.SQUARE&&e!==o.PROJECT||(this.drawingContext.lineCap=e),this},s.default.Renderer2D.prototype.strokeJoin=function(e){return e!==o.ROUND&&e!==o.BEVEL&&e!==o.MITER||(this.drawingContext.lineJoin=e),this},s.default.Renderer2D.prototype.strokeWeight=function(e){return this.drawingContext.lineWidth=void 0===e||0===e?1e-4:e,this},s.default.Renderer2D.prototype._getFill=function(){return this._cachedFillStyle||(this._cachedFillStyle=this.drawingContext.fillStyle),this._cachedFillStyle},s.default.Renderer2D.prototype._setFill=function(e){e!==this._cachedFillStyle&&(this.drawingContext.fillStyle=e,this._cachedFillStyle=e)},s.default.Renderer2D.prototype._getStroke=function(){return this._cachedStrokeStyle||(this._cachedStrokeStyle=this.drawingContext.strokeStyle),this._cachedStrokeStyle},s.default.Renderer2D.prototype._setStroke=function(e){e!==this._cachedStrokeStyle&&(this.drawingContext.strokeStyle=e,this._cachedStrokeStyle=e)},s.default.Renderer2D.prototype.bezier=function(e,t,r,n,i,s,o,a){return this._pInst.beginShape(),this._pInst.vertex(e,t),this._pInst.bezierVertex(r,n,i,s,o,a),this._pInst.endShape(),this},s.default.Renderer2D.prototype.curve=function(e,t,r,n,i,s,o,a){return this._pInst.beginShape(),this._pInst.curveVertex(e,t),this._pInst.curveVertex(r,n),this._pInst.curveVertex(i,s),this._pInst.curveVertex(o,a),this._pInst.endShape(),this},s.default.Renderer2D.prototype._doFillStrokeClose=function(e){e&&this.drawingContext.closePath(),this._doFill&&this.drawingContext.fill(),this._doStroke&&this.drawingContext.stroke()},s.default.Renderer2D.prototype.applyMatrix=function(e,t,r,n,i,s){this.drawingContext.transform(e,t,r,n,i,s)},s.default.Renderer2D.prototype.resetMatrix=function(){return this.drawingContext.setTransform(1,0,0,1,0,0),this.drawingContext.scale(this._pInst._pixelDensity,this._pInst._pixelDensity),this},s.default.Renderer2D.prototype.rotate=function(e){this.drawingContext.rotate(e)},s.default.Renderer2D.prototype.scale=function(e,t){return this.drawingContext.scale(e,t),this},s.default.Renderer2D.prototype.translate=function(e,t){return e instanceof s.default.Vector&&(t=e.y,e=e.x),this.drawingContext.translate(e,t),this},s.default.Renderer2D.prototype.text=function(e,t,r,n,i){void 0!==n&&this.drawingContext.textBaseline===o.BASELINE&&(a=!0,this.drawingContext.textBaseline=o.TOP);var a;n=s.default.Renderer.prototype.text.apply(this,arguments);return a&&(this.drawingContext.textBaseline=o.BASELINE),n},s.default.Renderer2D.prototype._renderText=function(e,t,r,n,i,s){if(!(n<s||i<=n))return e.push(),this._isOpenType()?this._textFont._renderPath(t,r,n,{renderer:this}):(this._doStroke&&this._strokeSet&&this.drawingContext.strokeText(t,r,n),this._doFill&&(this._fillSet||this._setFill(o._DEFAULT_TEXT_FILL),this.drawingContext.fillText(t,r,n))),e.pop(),e},s.default.Renderer2D.prototype.textWidth=function(e){return this._isOpenType()?this._textFont._textWidth(e,this._textSize):this.drawingContext.measureText(e).width},s.default.Renderer2D.prototype._applyTextProperties=function(){var e,t=this._pInst;return this._setProperty("_textAscent",null),this._setProperty("_textDescent",null),e=this._textFont,this._isOpenType()&&(e=this._textFont.font.familyName,this._setProperty("_textStyle",this._textFont.font.styleName)),this.drawingContext.font="".concat(this._textStyle||"normal"," ").concat(this._textSize||12,"px ").concat(e||"sans-serif"),this.drawingContext.textAlign=this._textAlign,this._textBaseline===o.CENTER?this.drawingContext.textBaseline=o._CTX_MIDDLE:this.drawingContext.textBaseline=this._textBaseline,t},s.default.Renderer2D.prototype.push=function(){return this.drawingContext.save(),s.default.Renderer.prototype.push.apply(this)},s.default.Renderer2D.prototype.pop=function(e){this.drawingContext.restore(),this._cachedFillStyle=this.drawingContext.fillStyle,this._cachedStrokeStyle=this.drawingContext.strokeStyle,s.default.Renderer.prototype.pop.call(this,e)},s.default.Renderer2D);r.default=c},{"./constants":256,"./main":267,"./p5.Renderer":270,"core-js/modules/es.array.concat":149,"core-js/modules/es.array.fill":152,"core-js/modules/es.array.for-each":154,"core-js/modules/es.array.iterator":158,"core-js/modules/es.array.join":159,"core-js/modules/es.array.slice":162,"core-js/modules/es.function.name":165,"core-js/modules/es.number.to-fixed":171,"core-js/modules/es.object.get-own-property-descriptor":173,"core-js/modules/es.object.to-string":177,"core-js/modules/es.regexp.to-string":182,"core-js/modules/es.string.iterator":186,"core-js/modules/es.symbol":196,"core-js/modules/es.symbol.description":194,"core-js/modules/es.symbol.iterator":195,"core-js/modules/es.weak-map":228,"core-js/modules/web.dom-collections.iterator":230}],272:[function(e,t,r){"use strict";e("core-js/modules/es.symbol"),e("core-js/modules/es.symbol.description"),e("core-js/modules/es.symbol.iterator"),e("core-js/modules/es.array.iterator"),e("core-js/modules/es.object.assign"),e("core-js/modules/es.object.to-string"),e("core-js/modules/es.promise"),e("core-js/modules/es.string.iterator"),e("core-js/modules/web.dom-collections.iterator"),e("core-js/modules/es.symbol"),e("core-js/modules/es.symbol.description"),e("core-js/modules/es.symbol.iterator"),e("core-js/modules/es.array.iterator"),e("core-js/modules/es.object.assign"),e("core-js/modules/es.object.to-string"),e("core-js/modules/es.promise"),e("core-js/modules/es.string.iterator"),e("core-js/modules/web.dom-collections.iterator");var n=(e=e("./main"))&&e.__esModule?e:{default:e};function i(){return{}}n.default.prototype._promisePreloads=[];var s=!(n.default.prototype.registerPromisePreload=function(e){n.default.prototype._promisePreloads.push(e)});n.default.prototype._setupPromisePreloads=function(){var e=!0,t=!1,r=void 0;try{for(var i,o=this._promisePreloads[Symbol.iterator]();!(e=(i=o.next()).done);e=!0){var a=i.value,l=this,c=a.method,u=a.addCallbacks,h=a.legacyPreloadSetup,d=a.target||this,p=d[c].bind(d);if(d===n.default.prototype){if(s)continue;l=null,p=d[c]}d[c]=this._wrapPromisePreload(l,p,u),h&&(d[h.method]=this._legacyPreloadGenerator(l,h,d[c]))}}catch(e){t=!0,r=e}finally{try{e||null==o.return||o.return()}finally{if(t)throw r}}s=!0},n.default.prototype._wrapPromisePreload=function(e,t,r){var n=function(){for(var e=this,n=(this._incrementPreload(),null),i=null,s=arguments.length,o=new Array(s),a=0;a<s;a++)o[a]=arguments[a];if(r)for(var l=o.length-1;0<=l&&!i&&"function"==typeof o[l];l--)i=n,n=o.pop();var c=Promise.resolve(t.apply(this,o));return n&&c.then(n),i&&c.catch(i),c.then((function(){return e._decrementPreload()})),c};return e?n.bind(e):n},n.default.prototype._legacyPreloadGenerator=function(e,t,r){var n=t.createBaseObject||i;t=function(){var e=this,t=(this._incrementPreload(),n.apply(this,arguments));return r.apply(this,arguments).then((function(r){Object.assign(t,r),e._decrementPreload()})),t};return e?t.bind(e):t}},{"./main":267,"core-js/modules/es.array.iterator":158,"core-js/modules/es.object.assign":172,"core-js/modules/es.object.to-string":177,"core-js/modules/es.promise":178,"core-js/modules/es.string.iterator":186,"core-js/modules/es.symbol":196,"core-js/modules/es.symbol.description":194,"core-js/modules/es.symbol.iterator":195,"core-js/modules/web.dom-collections.iterator":230}],273:[function(e,t,r){"use strict";function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}e("core-js/modules/es.symbol"),e("core-js/modules/es.symbol.description"),e("core-js/modules/es.symbol.iterator"),e("core-js/modules/es.array.filter"),e("core-js/modules/es.array.iterator"),e("core-js/modules/es.object.get-own-property-descriptor"),e("core-js/modules/es.object.to-string"),e("core-js/modules/es.string.iterator"),e("core-js/modules/es.weak-map"),e("core-js/modules/web.dom-collections.iterator"),e("core-js/modules/es.symbol"),e("core-js/modules/es.symbol.description"),e("core-js/modules/es.symbol.iterator"),e("core-js/modules/es.array.filter"),e("core-js/modules/es.array.iterator"),e("core-js/modules/es.object.to-string"),e("core-js/modules/es.string.iterator"),e("core-js/modules/web.dom-collections.iterator"),Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var i=(c=e("./main"))&&c.__esModule?c:{default:c},s=function(e){if(e&&e.__esModule)return e;if(null===e||"object"!==a(e)&&"function"!=typeof e)return{default:e};var t=o();if(t&&t.has(e))return t.get(e);var r,n={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(r in e){var s;Object.prototype.hasOwnProperty.call(e,r)&&((s=i?Object.getOwnPropertyDescriptor(e,r):null)&&(s.get||s.set)?Object.defineProperty(n,r,s):n[r]=e[r])}return n.default=e,t&&t.set(e,n),n}(e("./constants"));function o(){var e;return"function"!=typeof WeakMap?null:(e=new WeakMap,o=function(){return e},e)}function a(e){return(a="function"==typeof Symbol&&"symbol"===n(Symbol.iterator)?function(e){return n(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":n(e)})(e)}e("./p5.Graphics"),e("./p5.Renderer2D"),e("../webgl/p5.RendererGL");var l="defaultCanvas0",c=(i.default.prototype.createCanvas=function(e,t,r){var n,o,a;if(i.default._validateParameters("createCanvas",arguments),(r=r||s.P2D)===s.WEBGL)(o=document.getElementById(l))&&(o.parentNode.removeChild(o),n=this._renderer,this._elements=this._elements.filter((function(e){return e!==n}))),(o=document.createElement("canvas")).id=l,o.classList.add("p5Canvas");else if(this._defaultGraphicsCreated)o=this.canvas;else{o=document.createElement("canvas");for(var c=0;document.getElementById("defaultCanvas".concat(c));)c++;l="defaultCanvas".concat(c),o.id=l,o.classList.add("p5Canvas")}return this._setupDone||(o.dataset.hidden=!0,o.style.visibility="hidden"),(this._userNode||(0===document.getElementsByTagName("main").length&&(a=document.createElement("main"),document.body.appendChild(a)),document.getElementsByTagName("main")[0])).appendChild(o),r===s.WEBGL?(this._setProperty("_renderer",new i.default.RendererGL(o,this,!0)),this._elements.push(this._renderer)):this._defaultGraphicsCreated||(this._setProperty("_renderer",new i.default.Renderer2D(o,this,!0)),this._defaultGraphicsCreated=!0,this._elements.push(this._renderer)),this._renderer.resize(e,t),this._renderer._applyDefaults(),this._renderer},i.default.prototype.resizeCanvas=function(e,t,r){if(i.default._validateParameters("resizeCanvas",arguments),this._renderer){var n,s,o={};for(n in this.drawingContext){var l=this.drawingContext[n];"object"!==a(l)&&"function"!=typeof l&&(o[n]=l)}for(s in this._renderer.resize(e,t),this.width=e,this.height=t,o)try{this.drawingContext[s]=o[s]}catch(e){}r||this.redraw()}this._addAccsOutput()&&this._updateAccsOutput()},i.default.prototype.noCanvas=function(){this.canvas&&this.canvas.parentNode.removeChild(this.canvas)},i.default.prototype.createGraphics=function(e,t,r){return i.default._validateParameters("createGraphics",arguments),new i.default.Graphics(e,t,r,this)},i.default.prototype.blendMode=function(e){i.default._validateParameters("blendMode",arguments),e===s.NORMAL&&(e=s.BLEND),this._renderer.blendMode(e)},i.default);r.default=c},{"../webgl/p5.RendererGL":321,"./constants":256,"./main":267,"./p5.Graphics":269,"./p5.Renderer2D":271,"core-js/modules/es.array.filter":153,"core-js/modules/es.array.iterator":158,"core-js/modules/es.object.get-own-property-descriptor":173,"core-js/modules/es.object.to-string":177,"core-js/modules/es.string.iterator":186,"core-js/modules/es.symbol":196,"core-js/modules/es.symbol.description":194,"core-js/modules/es.symbol.iterator":195,"core-js/modules/es.weak-map":228,"core-js/modules/web.dom-collections.iterator":230}],274:[function(e,t,r){"use strict";function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function i(e){return(i="function"==typeof Symbol&&"symbol"===n(Symbol.iterator)?function(e){return n(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":n(e)})(e)}e("core-js/modules/es.symbol"),e("core-js/modules/es.symbol.description"),e("core-js/modules/es.symbol.iterator"),e("core-js/modules/es.array.iterator"),e("core-js/modules/es.array.slice"),e("core-js/modules/es.object.get-own-property-descriptor"),e("core-js/modules/es.object.to-string"),e("core-js/modules/es.string.iterator"),e("core-js/modules/es.weak-map"),e("core-js/modules/web.dom-collections.iterator"),e("core-js/modules/es.array.slice"),Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var s=c(e("../main")),o=function(e){if(e&&e.__esModule)return e;if(null===e||"object"!==i(e)&&"function"!=typeof e)return{default:e};var t=l();if(t&&t.has(e))return t.get(e);var r,n={},s=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(r in e){var o;Object.prototype.hasOwnProperty.call(e,r)&&((o=s?Object.getOwnPropertyDescriptor(e,r):null)&&(o.get||o.set)?Object.defineProperty(n,r,o):n[r]=e[r])}return n.default=e,t&&t.set(e,n),n}(e("../constants")),a=c(e("../helpers"));function l(){var e;return"function"!=typeof WeakMap?null:(e=new WeakMap,l=function(){return e},e)}function c(e){return e&&e.__esModule?e:{default:e}}e("../friendly_errors/fes_core"),e("../friendly_errors/file_errors"),e("../friendly_errors/validate_params"),s.default.prototype._normalizeArcAngles=function(e,t,r,n,i){var s;return e-=o.TWO_PI*Math.floor(e/o.TWO_PI),t-=o.TWO_PI*Math.floor(t/o.TWO_PI),s=Math.min(Math.abs(e-t),o.TWO_PI-Math.abs(e-t)),i&&(e=e<=o.HALF_PI?Math.atan(r/n*Math.tan(e)):e>o.HALF_PI&&e<=3*o.HALF_PI?Math.atan(r/n*Math.tan(e))+o.PI:Math.atan(r/n*Math.tan(e))+o.TWO_PI,t=t<=o.HALF_PI?Math.atan(r/n*Math.tan(t)):t>o.HALF_PI&&t<=3*o.HALF_PI?Math.atan(r/n*Math.tan(t))+o.PI:Math.atan(r/n*Math.tan(t))+o.TWO_PI),t<e&&(t+=o.TWO_PI),{start:e,stop:t,correspondToSamePoint:s<1e-5}},s.default.prototype.arc=function(e,t,r,n,i,o,l,c){return s.default._validateParameters("arc",arguments),(this._renderer._doStroke||this._renderer._doFill)&&i!==o&&(i=this._toRadians(i),o=this._toRadians(o),r=Math.abs(r),n=Math.abs(n),e=a.default.modeAdjust(e,t,r,n,this._renderer._ellipseMode),(t=this._normalizeArcAngles(i,o,e.w,e.h,!0)).correspondToSamePoint?this._renderer.ellipse([e.x,e.y,e.w,e.h,c]):(this._renderer.arc(e.x,e.y,e.w,e.h,t.start,t.stop,l,c),(this._accessibleOutputs.grid||this._accessibleOutputs.text)&&this._accsOutput("arc",[e.x,e.y,e.w,e.h,t.start,t.stop,l]))),this},s.default.prototype.ellipse=function(e,t,r,n,i){return s.default._validateParameters("ellipse",arguments),this._renderEllipse.apply(this,arguments)},s.default.prototype.circle=function(){s.default._validateParameters("circle",arguments);var e=Array.prototype.slice.call(arguments,0,2);return e.push(arguments[2]),e.push(arguments[2]),this._renderEllipse.apply(this,e)},s.default.prototype._renderEllipse=function(e,t,r,n,i){return(this._renderer._doStroke||this._renderer._doFill)&&(r<0&&(r=Math.abs(r)),void 0===n?n=r:n<0&&(n=Math.abs(n)),e=a.default.modeAdjust(e,t,r,n,this._renderer._ellipseMode),this._renderer.ellipse([e.x,e.y,e.w,e.h,i]),(this._accessibleOutputs.grid||this._accessibleOutputs.text)&&this._accsOutput("ellipse",[e.x,e.y,e.w,e.h])),this},s.default.prototype.line=function(){for(var e,t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return s.default._validateParameters("line",r),this._renderer._doStroke&&(e=this._renderer).line.apply(e,r),(this._accessibleOutputs.grid||this._accessibleOutputs.text)&&this._accsOutput("line",r),this},s.default.prototype.point=function(){for(var e,t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return s.default._validateParameters("point",r),this._renderer._doStroke&&(1===r.length&&r[0]instanceof s.default.Vector?this._renderer.point.call(this._renderer,r[0].x,r[0].y,r[0].z):((e=this._renderer).point.apply(e,r),(this._accessibleOutputs.grid||this._accessibleOutputs.text)&&this._accsOutput("point",r))),this},s.default.prototype.quad=function(){for(var e,t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return s.default._validateParameters("quad",r),(this._renderer._doStroke||this._renderer._doFill)&&(this._renderer.isP3D&&r.length<12?this._renderer.quad.call(this._renderer,r[0],r[1],0,r[2],r[3],0,r[4],r[5],0,r[6],r[7],0,r[8],r[9]):((e=this._renderer).quad.apply(e,r),(this._accessibleOutputs.grid||this._accessibleOutputs.text)&&this._accsOutput("quadrilateral",r))),this},s.default.prototype.rect=function(){return s.default._validateParameters("rect",arguments),this._renderRect.apply(this,arguments)},s.default.prototype.square=function(e,t,r,n,i,o,a){return s.default._validateParameters("square",arguments),this._renderRect.call(this,e,t,r,r,n,i,o,a)},s.default.prototype._renderRect=function(){if(this._renderer._doStroke||this._renderer._doFill){3===arguments.length&&(arguments[3]=arguments[2]);for(var e=a.default.modeAdjust(arguments[0],arguments[1],arguments[2],arguments[3],this._renderer._rectMode),t=[e.x,e.y,e.w,e.h],r=4;r<arguments.length;r++)t[r]=arguments[r];this._renderer.rect(t),(this._accessibleOutputs.grid||this._accessibleOutputs.text)&&this._accsOutput("rectangle",[e.x,e.y,e.w,e.h])}return this},s.default.prototype.triangle=function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return s.default._validateParameters("triangle",t),(this._renderer._doStroke||this._renderer._doFill)&&this._renderer.triangle(t),(this._accessibleOutputs.grid||this._accessibleOutputs.text)&&this._accsOutput("triangle",t),this},e=s.default,r.default=e},{"../constants":256,"../friendly_errors/fes_core":258,"../friendly_errors/file_errors":259,"../friendly_errors/validate_params":262,"../helpers":263,"../main":267,"core-js/modules/es.array.iterator":158,"core-js/modules/es.array.slice":162,"core-js/modules/es.object.get-own-property-descriptor":173,"core-js/modules/es.object.to-string":177,"core-js/modules/es.string.iterator":186,"core-js/modules/es.symbol":196,"core-js/modules/es.symbol.description":194,"core-js/modules/es.symbol.iterator":195,"core-js/modules/es.weak-map":228,"core-js/modules/web.dom-collections.iterator":230}],275:[function(e,t,r){"use strict";function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function i(e){return(i="function"==typeof Symbol&&"symbol"===n(Symbol.iterator)?function(e){return n(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":n(e)})(e)}e("core-js/modules/es.symbol"),e("core-js/modules/es.symbol.description"),e("core-js/modules/es.symbol.iterator"),e("core-js/modules/es.array.iterator"),e("core-js/modules/es.object.get-own-property-descriptor"),e("core-js/modules/es.object.to-string"),e("core-js/modules/es.string.iterator"),e("core-js/modules/es.weak-map"),e("core-js/modules/web.dom-collections.iterator"),Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var s=(l=e("../main"))&&l.__esModule?l:{default:l},o=function(e){if(e&&e.__esModule)return e;if(null===e||"object"!==i(e)&&"function"!=typeof e)return{default:e};var t=a();if(t&&t.has(e))return t.get(e);var r,n={},s=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(r in e){var o;Object.prototype.hasOwnProperty.call(e,r)&&((o=s?Object.getOwnPropertyDescriptor(e,r):null)&&(o.get||o.set)?Object.defineProperty(n,r,o):n[r]=e[r])}return n.default=e,t&&t.set(e,n),n}(e("../constants"));function a(){var e;return"function"!=typeof WeakMap?null:(e=new WeakMap,a=function(){return e},e)}s.default.prototype.ellipseMode=function(e){return s.default._validateParameters("ellipseMode",arguments),e!==o.CORNER&&e!==o.CORNERS&&e!==o.RADIUS&&e!==o.CENTER||(this._renderer._ellipseMode=e),this},s.default.prototype.noSmooth=function(){return this._renderer.isP3D?this.setAttributes("antialias",!1):"imageSmoothingEnabled"in this.drawingContext&&(this.drawingContext.imageSmoothingEnabled=!1),this},s.default.prototype.rectMode=function(e){return s.default._validateParameters("rectMode",arguments),e!==o.CORNER&&e!==o.CORNERS&&e!==o.RADIUS&&e!==o.CENTER||(this._renderer._rectMode=e),this},s.default.prototype.smooth=function(){return this.setAttributes("antialias",!0),this._renderer.isP3D||"imageSmoothingEnabled"in this.drawingContext&&(this.drawingContext.imageSmoothingEnabled=!0),this},s.default.prototype.strokeCap=function(e){return s.default._validateParameters("strokeCap",arguments),e!==o.ROUND&&e!==o.SQUARE&&e!==o.PROJECT||this._renderer.strokeCap(e),this},s.default.prototype.strokeJoin=function(e){return s.default._validateParameters("strokeJoin",arguments),e!==o.ROUND&&e!==o.BEVEL&&e!==o.MITER||this._renderer.strokeJoin(e),this},s.default.prototype.strokeWeight=function(e){return s.default._validateParameters("strokeWeight",arguments),this._renderer.strokeWeight(e),this};var l=s.default;r.default=l},{"../constants":256,"../main":267,"core-js/modules/es.array.iterator":158,"core-js/modules/es.object.get-own-property-descriptor":173,"core-js/modules/es.object.to-string":177,"core-js/modules/es.string.iterator":186,"core-js/modules/es.symbol":196,"core-js/modules/es.symbol.description":194,"core-js/modules/es.symbol.iterator":195,"core-js/modules/es.weak-map":228,"core-js/modules/web.dom-collections.iterator":230}],276:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n=(i=e("../main"))&&i.__esModule?i:{default:i};e("../friendly_errors/fes_core"),e("../friendly_errors/file_errors"),e("../friendly_errors/validate_params"),n.default.prototype.bezier=function(){for(var e,t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];return n.default._validateParameters("bezier",r),(this._renderer._doStroke||this._renderer._doFill)&&(e=this._renderer).bezier.apply(e,r),this},n.default.prototype.bezierDetail=function(e){return n.default._validateParameters("bezierDetail",arguments),this._bezierDetail=e,this},n.default.prototype.bezierPoint=function(e,t,r,i,s){n.default._validateParameters("bezierPoint",arguments);var o=1-s;return Math.pow(o,3)*e+3*Math.pow(o,2)*s*t+3*o*Math.pow(s,2)*r+Math.pow(s,3)*i},n.default.prototype.bezierTangent=function(e,t,r,i,s){n.default._validateParameters("bezierTangent",arguments);var o=1-s;return 3*i*Math.pow(s,2)-3*r*Math.pow(s,2)+6*r*o*s-6*t*o*s+3*t*Math.pow(o,2)-3*e*Math.pow(o,2)},n.default.prototype.curve=function(){for(var e,t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];return n.default._validateParameters("curve",r),this._renderer._doStroke&&(e=this._renderer).curve.apply(e,r),this},n.default.prototype.curveDetail=function(e){return n.default._validateParameters("curveDetail",arguments),this._curveDetail=e<3?3:e,this},n.default.prototype.curveTightness=function(e){return n.default._validateParameters("curveTightness",arguments),this._renderer._curveTightness=e,this},n.default.prototype.curvePoint=function(e,t,r,i,s){n.default._validateParameters("curvePoint",arguments);var o=this._renderer._curveTightness,a=s*s*s,l=s*s;return e*((o-1)/2*a+(1-o)*l+(o-1)/2*s)+t*((o+3)/2*a+(-5-o)/2*l+1)+r*((-3-o)/2*a+(o+2)*l+(1-o)/2*s)+i*((1-o)/2*a+(o-1)/2*l)},n.default.prototype.curveTangent=function(e,t,r,i,s){n.default._validateParameters("curveTangent",arguments);var o=this._renderer._curveTightness,a=s*s*3;return e*((o-1)/2*a+(1-o)*(s=2*s)+(o-1)/2)+t*((o+3)/2*a+(-5-o)/2*s)+r*((-3-o)/2*a+(o+2)*s+(1-o)/2)+i*((1-o)/2*a+(o-1)/2*s)};var i=n.default;r.default=i},{"../friendly_errors/fes_core":258,"../friendly_errors/file_errors":259,"../friendly_errors/validate_params":262,"../main":267}],277:[function(e,t,r){"use strict";function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function i(e){return(i="function"==typeof Symbol&&"symbol"===n(Symbol.iterator)?function(e){return n(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":n(e)})(e)}e("core-js/modules/es.symbol"),e("core-js/modules/es.symbol.description"),e("core-js/modules/es.symbol.iterator"),e("core-js/modules/es.array.iterator"),e("core-js/modules/es.array.slice"),e("core-js/modules/es.object.get-own-property-descriptor"),e("core-js/modules/es.object.to-string"),e("core-js/modules/es.string.iterator"),e("core-js/modules/es.weak-map"),e("core-js/modules/web.dom-collections.iterator"),e("core-js/modules/es.array.slice"),Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var s=(g=e("../main"))&&g.__esModule?g:{default:g},o=function(e){if(e&&e.__esModule)return e;if(null===e||"object"!==i(e)&&"function"!=typeof e)return{default:e};var t=a();if(t&&t.has(e))return t.get(e);var r,n={},s=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(r in e){var o;Object.prototype.hasOwnProperty.call(e,r)&&((o=s?Object.getOwnPropertyDescriptor(e,r):null)&&(o.get||o.set)?Object.defineProperty(n,r,o):n[r]=e[r])}return n.default=e,t&&t.set(e,n),n}(e("../constants"));function a(){var e;return"function"!=typeof WeakMap?null:(e=new WeakMap,a=function(){return e},e)}var l=null,c=[],u=[],h=!1,d=!1,p=!1,f=!1,m=!0,g=(s.default.prototype.beginContour=function(){return u=[],f=!0,this},s.default.prototype.beginShape=function(e){var t;return s.default._validateParameters("beginShape",arguments),this._renderer.isP3D?(t=this._renderer).beginShape.apply(t,arguments):(l=e===o.POINTS||e===o.LINES||e===o.TRIANGLES||e===o.TRIANGLE_FAN||e===o.TRIANGLE_STRIP||e===o.QUADS||e===o.QUAD_STRIP?e:null,c=[],u=[]),this},s.default.prototype.bezierVertex=function(){for(var e,t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];if(s.default._validateParameters("bezierVertex",r),this._renderer.isP3D)(e=this._renderer).bezierVertex.apply(e,r);else if(0===c.length)s.default._friendlyError("vertex() must be used once before calling bezierVertex()","bezierVertex");else{h=!0;for(var i=[],o=0;o<r.length;o++)i[o]=r[o];i.isVert=!1,(f?u:c).push(i)}return this},s.default.prototype.curveVertex=function(){for(var e,t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return s.default._validateParameters("curveVertex",r),this._renderer.isP3D?(e=this._renderer).curveVertex.apply(e,r):(d=!0,this.vertex(r[0],r[1])),this},s.default.prototype.endContour=function(){var e=u[0].slice();e.isVert=u[0].isVert,e.moveTo=!1,u.push(e),m&&(c.push(c[0]),m=!1);for(var t=0;t<u.length;t++)c.push(u[t]);return this},s.default.prototype.endShape=function(e){if(s.default._validateParameters("endShape",arguments),this._renderer.isP3D)this._renderer.endShape(e,d,h,p,f,l);else{if(0===c.length)return this;if(!this._renderer._doStroke&&!this._renderer._doFill)return this;var t=e===o.CLOSE;t&&!f&&c.push(c[0]),this._renderer.endShape(e,c,d,h,p,f,l),m=!(f=p=h=d=!1),t&&c.pop()}return this},s.default.prototype.quadraticVertex=function(){for(var e,t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];if(s.default._validateParameters("quadraticVertex",r),this._renderer.isP3D)(e=this._renderer).quadraticVertex.apply(e,r);else{if(this._contourInited)return(e={}).x=r[0],e.y=r[1],e.x3=r[2],e.y3=r[3],e.type=o.QUADRATIC,this._contourVertices.push(e),this;if(0<c.length){p=!0;for(var i=[],a=0;a<r.length;a++)i[a]=r[a];i.isVert=!1,(f?u:c).push(i)}else s.default._friendlyError("vertex() must be used once before calling quadraticVertex()","quadraticVertex")}return this},s.default.prototype.vertex=function(e,t,r,n,i){var s;return this._renderer.isP3D?(s=this._renderer).vertex.apply(s,arguments):((s=[]).isVert=!0,s[0]=e,s[1]=t,s[2]=0,s[3]=0,s[4]=0,s[5]=this._renderer._getFill(),s[6]=this._renderer._getStroke(),r&&(s.moveTo=r),(f?(0===u.length&&(s.moveTo=!0),u):c).push(s)),this},s.default.prototype.normal=function(e,t,r){var n;return this._assert3d("normal"),s.default._validateParameters("normal",arguments),(n=this._renderer).normal.apply(n,arguments),this},s.default);r.default=g},{"../constants":256,"../main":267,"core-js/modules/es.array.iterator":158,"core-js/modules/es.array.slice":162,"core-js/modules/es.object.get-own-property-descriptor":173,"core-js/modules/es.object.to-string":177,"core-js/modules/es.string.iterator":186,"core-js/modules/es.symbol":196,"core-js/modules/es.symbol.description":194,"core-js/modules/es.symbol.iterator":195,"core-js/modules/es.weak-map":228,"core-js/modules/web.dom-collections.iterator":230}],278:[function(e,t,r){"use strict";function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function i(e){return(i="function"==typeof Symbol&&"symbol"===n(Symbol.iterator)?function(e){return n(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":n(e)})(e)}var s,o,a;e("core-js/modules/es.symbol"),e("core-js/modules/es.symbol.description"),e("core-js/modules/es.symbol.iterator"),e("core-js/modules/es.array.filter"),e("core-js/modules/es.array.iterator"),e("core-js/modules/es.array.slice"),e("core-js/modules/es.object.assign"),e("core-js/modules/es.object.keys"),e("core-js/modules/es.object.to-string"),e("core-js/modules/es.string.iterator"),e("core-js/modules/es.typed-array.uint8-clamped-array"),e("core-js/modules/es.typed-array.copy-within"),e("core-js/modules/es.typed-array.every"),e("core-js/modules/es.typed-array.fill"),e("core-js/modules/es.typed-array.filter"),e("core-js/modules/es.typed-array.find"),e("core-js/modules/es.typed-array.find-index"),e("core-js/modules/es.typed-array.for-each"),e("core-js/modules/es.typed-array.includes"),e("core-js/modules/es.typed-array.index-of"),e("core-js/modules/es.typed-array.iterator"),e("core-js/modules/es.typed-array.join"),e("core-js/modules/es.typed-array.last-index-of"),e("core-js/modules/es.typed-array.map"),e("core-js/modules/es.typed-array.reduce"),e("core-js/modules/es.typed-array.reduce-right"),e("core-js/modules/es.typed-array.reverse"),e("core-js/modules/es.typed-array.set"),e("core-js/modules/es.typed-array.slice"),e("core-js/modules/es.typed-array.some"),e("core-js/modules/es.typed-array.sort"),e("core-js/modules/es.typed-array.subarray"),e("core-js/modules/es.typed-array.to-locale-string"),e("core-js/modules/es.typed-array.to-string"),e("core-js/modules/web.dom-collections.iterator"),e("core-js/modules/es.symbol"),e("core-js/modules/es.symbol.description"),e("core-js/modules/es.symbol.iterator"),e("core-js/modules/es.array.filter"),e("core-js/modules/es.array.iterator"),e("core-js/modules/es.array.slice"),e("core-js/modules/es.object.assign"),e("core-js/modules/es.object.keys"),e("core-js/modules/es.object.to-string"),e("core-js/modules/es.string.iterator"),e("core-js/modules/es.typed-array.uint8-clamped-array"),e("core-js/modules/es.typed-array.copy-within"),e("core-js/modules/es.typed-array.every"),e("core-js/modules/es.typed-array.fill"),e("core-js/modules/es.typed-array.filter"),e("core-js/modules/es.typed-array.find"),e("core-js/modules/es.typed-array.find-index"),e("core-js/modules/es.typed-array.for-each"),e("core-js/modules/es.typed-array.includes"),e("core-js/modules/es.typed-array.index-of"),e("core-js/modules/es.typed-array.iterator"),e("core-js/modules/es.typed-array.join"),e("core-js/modules/es.typed-array.last-index-of"),e("core-js/modules/es.typed-array.map"),e("core-js/modules/es.typed-array.reduce"),e("core-js/modules/es.typed-array.reduce-right"),e("core-js/modules/es.typed-array.reverse"),e("core-js/modules/es.typed-array.set"),e("core-js/modules/es.typed-array.slice"),e("core-js/modules/es.typed-array.some"),e("core-js/modules/es.typed-array.sort"),e("core-js/modules/es.typed-array.subarray"),e("core-js/modules/es.typed-array.to-locale-string"),e("core-js/modules/es.typed-array.to-string"),e("core-js/modules/web.dom-collections.iterator"),window.requestAnimationFrame=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(e,t){window.setTimeout(e,1e3/60)},"undefined"==typeof Uint8ClampedArray||Uint8ClampedArray.prototype.slice||Object.defineProperty(Uint8ClampedArray.prototype,"slice",{value:Array.prototype.slice,writable:!0,configurable:!0,enumerable:!1}),Object.assign||(s=Object.keys,e=Object.defineProperty,o="function"==typeof Symbol&&"symbol"===i(Symbol()),a=Object.prototype.propertyIsEnumerable,e(Object,"assign",{value:function(e,t){if(null==e)throw new TypeError("target must be an object");for(var r,n,i,l=Object(e),c=1;c<arguments.length;++c)for(r=Object(arguments[c]),i=s(r),o&&Object.getOwnPropertySymbols&&i.push.apply(i,Object.getOwnPropertySymbols(r).filter(function(e){return function(t){return a.call(e,t)}}(r))),n=0;n<i.length;++n)l[i[n]]=r[i[n]];return l},configurable:!0,enumerable:!1,writable:!0}))},{"core-js/modules/es.array.filter":153,"core-js/modules/es.array.iterator":158,"core-js/modules/es.array.slice":162,"core-js/modules/es.object.assign":172,"core-js/modules/es.object.keys":176,"core-js/modules/es.object.to-string":177,"core-js/modules/es.string.iterator":186,"core-js/modules/es.symbol":196,"core-js/modules/es.symbol.description":194,"core-js/modules/es.symbol.iterator":195,"core-js/modules/es.typed-array.copy-within":197,"core-js/modules/es.typed-array.every":198,"core-js/modules/es.typed-array.fill":199,"core-js/modules/es.typed-array.filter":200,"core-js/modules/es.typed-array.find":202,"core-js/modules/es.typed-array.find-index":201,"core-js/modules/es.typed-array.for-each":205,"core-js/modules/es.typed-array.includes":206,"core-js/modules/es.typed-array.index-of":207,"core-js/modules/es.typed-array.iterator":210,"core-js/modules/es.typed-array.join":211,"core-js/modules/es.typed-array.last-index-of":212,"core-js/modules/es.typed-array.map":213,"core-js/modules/es.typed-array.reduce":215,"core-js/modules/es.typed-array.reduce-right":214,"core-js/modules/es.typed-array.reverse":216,"core-js/modules/es.typed-array.set":217,"core-js/modules/es.typed-array.slice":218,"core-js/modules/es.typed-array.some":219,"core-js/modules/es.typed-array.sort":220,"core-js/modules/es.typed-array.subarray":221,"core-js/modules/es.typed-array.to-locale-string":222,"core-js/modules/es.typed-array.to-string":223,"core-js/modules/es.typed-array.uint8-clamped-array":227,"core-js/modules/web.dom-collections.iterator":230}],279:[function(e,t,r){"use strict";e("core-js/modules/es.array.for-each"),e("core-js/modules/es.object.assign"),e("core-js/modules/web.dom-collections.for-each"),e("core-js/modules/es.array.for-each"),e("core-js/modules/es.object.assign"),e("core-js/modules/web.dom-collections.for-each"),Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0,(e=(e=e("./main"))&&e.__esModule?e:{default:e}).default.prototype.noLoop=function(){this._loop=!1},e.default.prototype.loop=function(){this._loop||(this._loop=!0,this._setupDone&&this._draw())},e.default.prototype.isLooping=function(){return this._loop},e.default.prototype.push=function(){this._styles.push({props:{_colorMode:this._colorMode},renderer:this._renderer.push()})},e.default.prototype.pop=function(){var e=this._styles.pop();e&&(this._renderer.pop(e.renderer),Object.assign(this,e.props))},e.default.prototype.redraw=function(e){if(!this._inUserDraw&&this._setupDone){var t=parseInt(e),r=((isNaN(t)||t<1)&&(t=1),this._isGlobal?window:this);if("function"==typeof r.draw){void 0===r.setup&&r.scale(r._pixelDensity,r._pixelDensity);for(var n=function(e){e.call(r)},i=0;i<t;i++){r.resetMatrix(),(this._accessibleOutputs.grid||this._accessibleOutputs.text)&&this._updateAccsOutput(),r._renderer.isP3D&&r._renderer._update(),r._setProperty("frameCount",r.frameCount+1),r._registeredMethods.pre.forEach(n),this._inUserDraw=!0;try{r.draw()}finally{this._inUserDraw=!1}r._registeredMethods.post.forEach(n)}}}},e=e.default,r.default=e},{"./main":267,"core-js/modules/es.array.for-each":154,"core-js/modules/es.object.assign":172,"core-js/modules/web.dom-collections.for-each":229}],280:[function(e,t,r){"use strict";e("core-js/modules/es.symbol"),e("core-js/modules/es.symbol.description"),e("core-js/modules/es.symbol.iterator"),e("core-js/modules/es.array.from"),e("core-js/modules/es.array.iterator"),e("core-js/modules/es.object.get-prototype-of"),e("core-js/modules/es.object.to-string"),e("core-js/modules/es.regexp.to-string"),e("core-js/modules/es.string.iterator"),e("core-js/modules/es.typed-array.uint8-array"),e("core-js/modules/es.typed-array.copy-within"),e("core-js/modules/es.typed-array.every"),e("core-js/modules/es.typed-array.fill"),e("core-js/modules/es.typed-array.filter"),e("core-js/modules/es.typed-array.find"),e("core-js/modules/es.typed-array.find-index"),e("core-js/modules/es.typed-array.for-each"),e("core-js/modules/es.typed-array.includes"),e("core-js/modules/es.typed-array.index-of"),e("core-js/modules/es.typed-array.iterator"),e("core-js/modules/es.typed-array.join"),e("core-js/modules/es.typed-array.last-index-of"),e("core-js/modules/es.typed-array.map"),e("core-js/modules/es.typed-array.reduce"),e("core-js/modules/es.typed-array.reduce-right"),e("core-js/modules/es.typed-array.reverse"),e("core-js/modules/es.typed-array.set"),e("core-js/modules/es.typed-array.slice"),e("core-js/modules/es.typed-array.some"),e("core-js/modules/es.typed-array.sort"),e("core-js/modules/es.typed-array.subarray"),e("core-js/modules/es.typed-array.to-locale-string"),e("core-js/modules/es.typed-array.to-string"),e("core-js/modules/web.dom-collections.iterator"),e("core-js/modules/es.symbol"),e("core-js/modules/es.symbol.description"),e("core-js/modules/es.symbol.iterator"),e("core-js/modules/es.array.from"),e("core-js/modules/es.array.iterator"),e("core-js/modules/es.object.get-prototype-of"),e("core-js/modules/es.object.to-string"),e("core-js/modules/es.regexp.to-string"),e("core-js/modules/es.string.iterator"),e("core-js/modules/es.typed-array.uint8-array"),e("core-js/modules/es.typed-array.copy-within"),e("core-js/modules/es.typed-array.every"),e("core-js/modules/es.typed-array.fill"),e("core-js/modules/es.typed-array.filter"),e("core-js/modules/es.typed-array.find"),e("core-js/modules/es.typed-array.find-index"),e("core-js/modules/es.typed-array.for-each"),e("core-js/modules/es.typed-array.includes"),e("core-js/modules/es.typed-array.index-of"),e("core-js/modules/es.typed-array.iterator"),e("core-js/modules/es.typed-array.join"),e("core-js/modules/es.typed-array.last-index-of"),e("core-js/modules/es.typed-array.map"),e("core-js/modules/es.typed-array.reduce"),e("core-js/modules/es.typed-array.reduce-right"),e("core-js/modules/es.typed-array.reverse"),e("core-js/modules/es.typed-array.set"),e("core-js/modules/es.typed-array.slice"),e("core-js/modules/es.typed-array.some"),e("core-js/modules/es.typed-array.sort"),e("core-js/modules/es.typed-array.subarray"),e("core-js/modules/es.typed-array.to-locale-string"),e("core-js/modules/es.typed-array.to-string"),e("core-js/modules/web.dom-collections.iterator"),Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n=(e=e("./main"))&&e.__esModule?e:{default:e};n.default.prototype.applyMatrix=function(){var e=arguments[0]instanceof Object.getPrototypeOf(Uint8Array);return Array.isArray(arguments[0])||e?(e=this._renderer).applyMatrix.apply(e,function(e){return function(e){if(Array.isArray(e)){for(var t=0,r=new Array(e.length);t<e.length;t++)r[t]=e[t];return r}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}(arguments[0])):(e=this._renderer).applyMatrix.apply(e,arguments),this},n.default.prototype.resetMatrix=function(){return this._renderer.resetMatrix(),this},n.default.prototype.rotate=function(e,t){return n.default._validateParameters("rotate",arguments),this._renderer.rotate(this._toRadians(e),t),this},n.default.prototype.rotateX=function(e){return this._assert3d("rotateX"),n.default._validateParameters("rotateX",arguments),this._renderer.rotateX(this._toRadians(e)),this},n.default.prototype.rotateY=function(e){return this._assert3d("rotateY"),n.default._validateParameters("rotateY",arguments),this._renderer.rotateY(this._toRadians(e)),this},n.default.prototype.rotateZ=function(e){return this._assert3d("rotateZ"),n.default._validateParameters("rotateZ",arguments),this._renderer.rotateZ(this._toRadians(e)),this},n.default.prototype.scale=function(e,t,r){var i;return n.default._validateParameters("scale",arguments),e instanceof n.default.Vector?(e=(i=e).x,t=i.y,r=i.z):e instanceof Array&&(e=(i=e)[0],t=i[1],r=i[2]||1),isNaN(t)?t=r=e:isNaN(r)&&(r=1),this._renderer.scale.call(this._renderer,e,t,r),this},n.default.prototype.shearX=function(e){return n.default._validateParameters("shearX",arguments),e=this._toRadians(e),this._renderer.applyMatrix(1,0,Math.tan(e),1,0,0),this},n.default.prototype.shearY=function(e){return n.default._validateParameters("shearY",arguments),e=this._toRadians(e),this._renderer.applyMatrix(1,Math.tan(e),0,1,0,0),this},n.default.prototype.translate=function(e,t,r){return n.default._validateParameters("translate",arguments),this._renderer.isP3D?this._renderer.translate(e,t,r):this._renderer.translate(e,t),this},e=n.default,r.default=e},{"./main":267,"core-js/modules/es.array.from":155,"core-js/modules/es.array.iterator":158,"core-js/modules/es.object.get-prototype-of":175,"core-js/modules/es.object.to-string":177,"core-js/modules/es.regexp.to-string":182,"core-js/modules/es.string.iterator":186,"core-js/modules/es.symbol":196,"core-js/modules/es.symbol.description":194,"core-js/modules/es.symbol.iterator":195,"core-js/modules/es.typed-array.copy-within":197,"core-js/modules/es.typed-array.every":198,"core-js/modules/es.typed-array.fill":199,"core-js/modules/es.typed-array.filter":200,"core-js/modules/es.typed-array.find":202,"core-js/modules/es.typed-array.find-index":201,"core-js/modules/es.typed-array.for-each":205,"core-js/modules/es.typed-array.includes":206,"core-js/modules/es.typed-array.index-of":207,"core-js/modules/es.typed-array.iterator":210,"core-js/modules/es.typed-array.join":211,"core-js/modules/es.typed-array.last-index-of":212,"core-js/modules/es.typed-array.map":213,"core-js/modules/es.typed-array.reduce":215,"core-js/modules/es.typed-array.reduce-right":214,"core-js/modules/es.typed-array.reverse":216,"core-js/modules/es.typed-array.set":217,"core-js/modules/es.typed-array.slice":218,"core-js/modules/es.typed-array.some":219,"core-js/modules/es.typed-array.sort":220,"core-js/modules/es.typed-array.subarray":221,"core-js/modules/es.typed-array.to-locale-string":222,"core-js/modules/es.typed-array.to-string":223,"core-js/modules/es.typed-array.uint8-array":226,"core-js/modules/web.dom-collections.iterator":230}],281:[function(e,t,r){"use strict";function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}e("core-js/modules/es.symbol"),e("core-js/modules/es.symbol.description"),e("core-js/modules/es.symbol.iterator"),e("core-js/modules/es.array.from"),e("core-js/modules/es.array.iterator"),e("core-js/modules/es.object.to-string"),e("core-js/modules/es.regexp.to-string"),e("core-js/modules/es.string.ends-with"),e("core-js/modules/es.string.iterator"),e("core-js/modules/web.dom-collections.iterator"),e("core-js/modules/es.symbol"),e("core-js/modules/es.symbol.description"),e("core-js/modules/es.symbol.iterator"),e("core-js/modules/es.array.from"),e("core-js/modules/es.array.iterator"),e("core-js/modules/es.object.to-string"),e("core-js/modules/es.regexp.to-string"),e("core-js/modules/es.string.ends-with"),e("core-js/modules/es.string.iterator"),e("core-js/modules/web.dom-collections.iterator");var i=(e=e("../core/main"))&&e.__esModule?e:{default:e};function s(e){return function(e){if(Array.isArray(e)){for(var t=0,r=new Array(e.length);t<e.length;t++)r[t]=e[t];return r}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function o(e){return(o="function"==typeof Symbol&&"symbol"===n(Symbol.iterator)?function(e){return n(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":n(e)})(e)}i.default.prototype.storeItem=function(e,t){e.endsWith("p5TypeID");var r=o(t);switch(r){case"number":case"boolean":t=t.toString();break;case"object":t instanceof i.default.Color?r="p5.Color":t instanceof i.default.Vector&&(r="p5.Vector",t=[t.x,t.y,t.z]),t=JSON.stringify(t)}localStorage.setItem(e,t),e="".concat(e,"p5TypeID"),localStorage.setItem(e,r)},i.default.prototype.getItem=function(e){var t=localStorage.getItem(e),r=localStorage.getItem("".concat(e,"p5TypeID"));if(void 0===r);else if(null!==t)switch(r){case"number":t=parseFloat(t);break;case"boolean":t="true"===t;break;case"object":t=JSON.parse(t);break;case"p5.Color":t=JSON.parse(t),t=this.color.apply(this,s(t.levels));break;case"p5.Vector":t=JSON.parse(t),t=this.createVector.apply(this,s(t))}return t},i.default.prototype.clearStorage=function(){localStorage.clear()},i.default.prototype.removeItem=function(e){localStorage.removeItem(e),localStorage.removeItem("".concat(e,"p5TypeID"))}},{"../core/main":267,"core-js/modules/es.array.from":155,"core-js/modules/es.array.iterator":158,"core-js/modules/es.object.to-string":177,"core-js/modules/es.regexp.to-string":182,"core-js/modules/es.string.ends-with":184,"core-js/modules/es.string.iterator":186,"core-js/modules/es.symbol":196,"core-js/modules/es.symbol.description":194,"core-js/modules/es.symbol.iterator":195,"core-js/modules/web.dom-collections.iterator":230}],282:[function(e,t,r){"use strict";e("core-js/modules/es.array.concat"),e("core-js/modules/es.object.keys"),e("core-js/modules/es.string.sub"),e("core-js/modules/es.array.concat"),e("core-js/modules/es.object.keys"),e("core-js/modules/es.string.sub"),Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n=(e=e("../core/main"))&&e.__esModule?e:{default:e};n.default.prototype.createStringDict=function(e,t){return n.default._validateParameters("createStringDict",arguments),new n.default.StringDict(e,t)},n.default.prototype.createNumberDict=function(e,t){return n.default._validateParameters("createNumberDict",arguments),new n.default.NumberDict(e,t)},n.default.TypedDict=function(e,t){return e instanceof Object?this.data=e:(this.data={},this.data[e]=t),this},n.default.TypedDict.prototype.size=function(){return Object.keys(this.data).length},n.default.TypedDict.prototype.hasKey=function(e){return this.data.hasOwnProperty(e)},n.default.TypedDict.prototype.get=function(e){if(this.data.hasOwnProperty(e))return this.data[e]},n.default.TypedDict.prototype.set=function(e,t){this._validate(t)&&(this.data[e]=t)},n.default.TypedDict.prototype._addObj=function(e){for(var t in e)this.set(t,e[t])},n.default.TypedDict.prototype.create=function(e,t){e instanceof Object&&void 0===t?this._addObj(e):void 0!==e&&this.set(e,t)},n.default.TypedDict.prototype.clear=function(){this.data={}},n.default.TypedDict.prototype.remove=function(e){if(!this.data.hasOwnProperty(e))throw new Error("".concat(e," does not exist in this Dictionary"));delete this.data[e]},n.default.TypedDict.prototype.print=function(){for(var e in this.data);},n.default.TypedDict.prototype.saveTable=function(e){var t,r="";for(t in this.data)r+="".concat(t,",").concat(this.data[t],"\n");var i=new Blob([r],{type:"text/csv"});n.default.prototype.downloadFile(i,e||"mycsv","csv")},n.default.TypedDict.prototype.saveJSON=function(e,t){n.default.prototype.saveJSON(this.data,e,t)},n.default.TypedDict.prototype._validate=function(e){return!0},n.default.StringDict=function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];n.default.TypedDict.apply(this,t)},n.default.StringDict.prototype=Object.create(n.default.TypedDict.prototype),n.default.StringDict.prototype._validate=function(e){return"string"==typeof e},n.default.NumberDict=function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];n.default.TypedDict.apply(this,t)},n.default.NumberDict.prototype=Object.create(n.default.TypedDict.prototype),n.default.NumberDict.prototype._validate=function(e){return"number"==typeof e},n.default.NumberDict.prototype.add=function(e,t){this.data.hasOwnProperty(e)&&(this.data[e]+=t)},n.default.NumberDict.prototype.sub=function(e,t){this.add(e,-t)},n.default.NumberDict.prototype.mult=function(e,t){this.data.hasOwnProperty(e)&&(this.data[e]*=t)},n.default.NumberDict.prototype.div=function(e,t){this.data.hasOwnProperty(e)&&(this.data[e]/=t)},n.default.NumberDict.prototype._valueTest=function(e){if(0===Object.keys(this.data).length)throw new Error("Unable to search for a minimum or maximum value on an empty NumberDict");if(1===Object.keys(this.data).length)return this.data[Object.keys(this.data)[0]];var t,r=this.data[Object.keys(this.data)[0]];for(t in this.data)this.data[t]*e<r*e&&(r=this.data[t]);return r},n.default.NumberDict.prototype.minValue=function(){return this._valueTest(1)},n.default.NumberDict.prototype.maxValue=function(){return this._valueTest(-1)},n.default.NumberDict.prototype._keyTest=function(e){if(0===Object.keys(this.data).length)throw new Error("Unable to use minValue on an empty NumberDict");if(1===Object.keys(this.data).length)return Object.keys(this.data)[0];for(var t=Object.keys(this.data)[0],r=1;r<Object.keys(this.data).length;r++)Object.keys(this.data)[r]*e<t*e&&(t=Object.keys(this.data)[r]);return t},n.default.NumberDict.prototype.minKey=function(){return this._keyTest(1)},n.default.NumberDict.prototype.maxKey=function(){return this._keyTest(-1)},e=n.default.TypedDict,r.default=e},{"../core/main":267,"core-js/modules/es.array.concat":149,"core-js/modules/es.object.keys":176,"core-js/modules/es.string.sub":192}],283:[function(e,t,r){"use strict";function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}e("core-js/modules/es.symbol"),e("core-js/modules/es.symbol.description"),e("core-js/modules/es.symbol.iterator"),e("core-js/modules/es.array.every"),e("core-js/modules/es.array.filter"),e("core-js/modules/es.array.for-each"),e("core-js/modules/es.array.from"),e("core-js/modules/es.array.index-of"),e("core-js/modules/es.array.iterator"),e("core-js/modules/es.array.map"),e("core-js/modules/es.array.slice"),e("core-js/modules/es.array.splice"),e("core-js/modules/es.function.name"),e("core-js/modules/es.object.to-string"),e("core-js/modules/es.promise"),e("core-js/modules/es.regexp.exec"),e("core-js/modules/es.regexp.to-string"),e("core-js/modules/es.string.iterator"),e("core-js/modules/es.string.replace"),e("core-js/modules/es.string.split"),e("core-js/modules/es.string.trim"),e("core-js/modules/web.dom-collections.for-each"),e("core-js/modules/web.dom-collections.iterator"),e("core-js/modules/web.url"),e("core-js/modules/es.symbol"),e("core-js/modules/es.symbol.description"),e("core-js/modules/es.symbol.iterator"),e("core-js/modules/es.array.every"),e("core-js/modules/es.array.filter"),e("core-js/modules/es.array.for-each"),e("core-js/modules/es.array.from"),e("core-js/modules/es.array.index-of"),e("core-js/modules/es.array.iterator"),e("core-js/modules/es.array.map"),e("core-js/modules/es.array.slice"),e("core-js/modules/es.array.splice"),e("core-js/modules/es.function.name"),e("core-js/modules/es.object.to-string"),e("core-js/modules/es.promise"),e("core-js/modules/es.regexp.exec"),e("core-js/modules/es.regexp.to-string"),e("core-js/modules/es.string.iterator"),e("core-js/modules/es.string.replace"),e("core-js/modules/es.string.split"),e("core-js/modules/es.string.trim"),e("core-js/modules/web.dom-collections.for-each"),e("core-js/modules/web.dom-collections.iterator"),e("core-js/modules/web.url"),Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var i=(e=e("../core/main"))&&e.__esModule?e:{default:e};function s(e){return(s="function"==typeof Symbol&&"symbol"===n(Symbol.iterator)?function(e){return n(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":n(e)})(e)}function o(e,t,r){return(t._userNode||document.body).appendChild(e),r=new(r?i.default.MediaElement:i.default.Element)(e,t),t._elements.push(r),r}function a(e,t,r,n){var i=document.createElement(t),s=("string"==typeof(r=r||"")&&(r=[r]),!0),a=(t=!1,void 0);try{for(var l,c=r[Symbol.iterator]();!(s=(l=c.next()).done);s=!0){var u=l.value,h=document.createElement("source");h.setAttribute("src",u),i.appendChild(h)}}catch(e){t=!0,a=e}finally{try{s||null==c.return||c.return()}finally{if(t)throw a}}"function"==typeof n&&i.addEventListener("canplaythrough",(function e(){n(),i.removeEventListener("canplaythrough",e)}));var d=o(i,e,!0);return d.loadedmetadata=!1,i.addEventListener("loadedmetadata",(function(){d.width=i.videoWidth,d.height=i.videoHeight,0===d.elt.width&&(d.elt.width=i.videoWidth),0===d.elt.height&&(d.elt.height=i.videoHeight),d.presetPlaybackRate&&(d.elt.playbackRate=d.presetPlaybackRate,delete d.presetPlaybackRate),d.loadedmetadata=!0})),d}function l(e,t,r,n){this.callback=e,this.time=t,this.id=r,this.val=n}i.default.prototype.select=function(e,t){return i.default._validateParameters("select",arguments),(t=this._getContainer(t).querySelector(e))?this._wrapElement(t):null},i.default.prototype.selectAll=function(e,t){i.default._validateParameters("selectAll",arguments);var r=[],n=this._getContainer(t).querySelectorAll(e);if(n)for(var s=0;s<n.length;s++){var o=this._wrapElement(n[s]);r.push(o)}return r},i.default.prototype._getContainer=function(e){var t=document;return"string"==typeof e?t=document.querySelector(e)||document:e instanceof i.default.Element?t=e.elt:e instanceof HTMLElement&&(t=e),t},i.default.prototype._wrapElement=function(e){var t,r=Array.prototype.slice.call(e.children);return"INPUT"===e.tagName&&"checkbox"===e.type?((t=new i.default.Element(e,this)).checked=function(){return 0===arguments.length?this.elt.checked:(this.elt.checked=!!arguments[0],this)},t):"VIDEO"===e.tagName||"AUDIO"===e.tagName?new i.default.MediaElement(e,this):"SELECT"===e.tagName?this.createSelect(new i.default.Element(e,this)):0<r.length&&r.every((function(e){return"INPUT"===e.tagName||"LABEL"===e.tagName}))?this.createRadio(new i.default.Element(e,this)):new i.default.Element(e,this)},i.default.prototype.removeElements=function(e){i.default._validateParameters("removeElements",arguments),this._elements.filter((function(e){return!(e.elt instanceof HTMLCanvasElement)})).map((function(e){return e.remove()}))},i.default.Element.prototype.changed=function(e){return i.default.Element._adjustListener("change",e,this),this},i.default.Element.prototype.input=function(e){return i.default.Element._adjustListener("input",e,this),this},i.default.prototype.createDiv=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:"",t=document.createElement("div");return t.innerHTML=e,o(t,this)},i.default.prototype.createP=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:"",t=document.createElement("p");return t.innerHTML=e,o(t,this)},i.default.prototype.createSpan=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:"",t=document.createElement("span");return t.innerHTML=e,o(t,this)},i.default.prototype.createImg=function(){i.default._validateParameters("createImg",arguments);var e,t=document.createElement("img"),r=arguments;return 1<r.length&&"string"==typeof r[1]&&(t.alt=r[1]),2<r.length&&"string"==typeof r[2]&&(t.crossOrigin=r[2]),t.src=r[0],e=o(t,this),t.addEventListener("load",(function(){e.width=t.offsetWidth||t.width,e.height=t.offsetHeight||t.height;var n=r[r.length-1];"function"==typeof n&&n(e)})),e},i.default.prototype.createA=function(e,t,r){i.default._validateParameters("createA",arguments);var n=document.createElement("a");return n.href=e,n.innerHTML=t,r&&(n.target=r),o(n,this)},i.default.prototype.createSlider=function(e,t,r,n){i.default._validateParameters("createSlider",arguments);var s=document.createElement("input");return s.type="range",s.min=e,s.max=t,0===n?s.step=1e-18:n&&(s.step=n),"number"==typeof r&&(s.value=r),o(s,this)},i.default.prototype.createButton=function(e,t){i.default._validateParameters("createButton",arguments);var r=document.createElement("button");return r.innerHTML=e,t&&(r.value=t),o(r,this)},i.default.prototype.createCheckbox=function(){i.default._validateParameters("createCheckbox",arguments);var e=document.createElement("div"),t=document.createElement("input"),r=(t.type="checkbox",document.createElement("label")),n=(r.appendChild(t),e.appendChild(r),o(e,this));return n.checked=function(){var e=n.elt.firstElementChild.getElementsByTagName("input")[0];if(e){if(0===arguments.length)return e.checked;e.checked=!!arguments[0]}return n},this.value=function(e){return n.value=e,this},arguments[0]&&(n.value(arguments[0]),(e=document.createElement("span")).innerHTML=arguments[0],r.appendChild(e)),arguments[1]&&(t.checked=!0),n},i.default.prototype.createSelect=function(){i.default._validateParameters("createSelect",arguments);var e,t,r=arguments[0];return r instanceof i.default.Element&&r.elt instanceof HTMLSelectElement?this.elt=(e=r).elt:r instanceof HTMLSelectElement?(e=o(r,this),this.elt=r):(t=document.createElement("select"),r&&"boolean"==typeof r&&t.setAttribute("multiple","true"),e=o(t,this),this.elt=t),e.option=function(e,t){var r;if(void 0!==e){for(var n,i=0;i<this.elt.length;i+=1)if(this.elt[i].textContent===e){r=i;break}void 0!==r?!1===t?this.elt.remove(r):this.elt[r].value=t:((n=document.createElement("option")).textContent=e,n.value=void 0===t?e:t,this.elt.appendChild(n),this._pInst._elements.push(n))}},e.selected=function(e){if(void 0!==e){for(var t=0;t<this.elt.length;t+=1)this.elt[t].value.toString()===e.toString()&&(this.elt.selectedIndex=t);return this}if(this.elt.getAttribute("multiple")){var r=[],n=!0,i=!1,s=void 0;try{for(var o,a=this.elt.selectedOptions[Symbol.iterator]();!(n=(o=a.next()).done);n=!0){var l=o.value;r.push(l.value)}}catch(e){i=!0,s=e}finally{try{n||null==a.return||a.return()}finally{if(i)throw s}}return r}return this.elt.value},e.disable=function(e){if("string"==typeof e)for(var t=0;t<this.elt.length;t++)this.elt[t].value.toString()===e&&(this.elt[t].disabled=!0,this.elt[t].selected=!1);else this.elt.disabled=!0;return this},e},i.default.prototype.createRadio=function(){function e(e){return e instanceof HTMLInputElement&&"radio"===e.type}function t(e){return e instanceof HTMLLabelElement}var r,n,s,a=arguments[0];return a instanceof i.default.Element&&(a.elt instanceof HTMLDivElement||a.elt instanceof HTMLSpanElement)?(r=a,this.elt=a.elt):a instanceof HTMLDivElement||a instanceof HTMLSpanElement?(r=o(a,this),n=this.elt=a,"string"==typeof arguments[1]&&(s=arguments[1])):("string"==typeof a&&(s=a),n=document.createElement("div"),r=o(n,this),this.elt=n),r._name=s||"radioOption",r._getOptionsArray=function(){return Array.from(this.elt.children).filter((function(r){return e(r)||t(r)&&e(r.firstElementChild)})).map((function(t){return e(t)?t:t.firstElementChild}))},r.option=function(e,n){var i,s,o,a=!0,l=!1,c=void 0;try{for(var u,h=r._getOptionsArray()[Symbol.iterator]();!(a=(u=h.next()).done);a=!0){var d=u.value;if(d.value===e){i=d;break}}}catch(e){l=!0,c=e}finally{try{a||null==h.return||h.return()}finally{if(l)throw c}}return void 0===i&&((i=document.createElement("input")).setAttribute("type","radio"),i.setAttribute("value",e)),i.setAttribute("name",r._name),t(i.parentElement)?s=i.parentElement:(s=document.createElement("label")).insertAdjacentElement("afterbegin",i),s.lastElementChild instanceof HTMLSpanElement?o=s.lastElementChild:(o=document.createElement("span"),i.insertAdjacentElement("afterend",o)),o.innerHTML=void 0===n?e:n,this.elt.appendChild(s),i},r.remove=function(e){var n=!0,i=!1,s=void 0;try{for(var o,a=r._getOptionsArray()[Symbol.iterator]();!(n=(o=a.next()).done);n=!0){var l=o.value;if(l.value===e)return void(t(l.parentElement)?l.parentElement:l).remove()}}catch(e){i=!0,s=e}finally{try{n||null==a.return||a.return()}finally{if(i)throw s}}},r.value=function(){var e="",t=!0,n=!1,i=void 0;try{for(var s,o=r._getOptionsArray()[Symbol.iterator]();!(t=(s=o.next()).done);t=!0){var a=s.value;if(a.checked){e=a.value;break}}}catch(e){n=!0,i=e}finally{try{t||null==o.return||o.return()}finally{if(n)throw i}}return e},r.selected=function(e){var t=null;if(void 0===e){var n=!0,i=!1,s=void 0;try{for(var o,a=r._getOptionsArray()[Symbol.iterator]();!(n=(o=a.next()).done);n=!0){var l=o.value;if(l.checked){t=l;break}}}catch(e){i=!0,s=e}finally{try{n||null==a.return||a.return()}finally{if(i)throw s}}}else{r._getOptionsArray().forEach((function(e){e.checked=!1,e.removeAttribute("checked")}));var c=!0;i=!1,s=void 0;try{for(var u,h=r._getOptionsArray()[Symbol.iterator]();!(c=(u=h.next()).done);c=!0){var d=u.value;d.value===e&&(d.setAttribute("checked",!0),d.checked=!0,t=d)}}catch(e){i=!0,s=e}finally{try{c||null==h.return||h.return()}finally{if(i)throw s}}}return t},r.disable=function(){var e=!(0<arguments.length&&void 0!==arguments[0])||arguments[0],t=!0,n=!1,i=void 0;try{for(var s,o=r._getOptionsArray()[Symbol.iterator]();!(t=(s=o.next()).done);t=!0)s.value.setAttribute("disabled",e)}catch(e){n=!0,i=e}finally{try{t||null==o.return||o.return()}finally{if(n)throw i}}},r},i.default.prototype.createColorPicker=function(e){i.default._validateParameters("createColorPicker",arguments);var t=document.createElement("input");return t.type="color",e?e instanceof i.default.Color?t.value=e.toString("#rrggbb"):(i.default.prototype._colorMode="rgb",i.default.prototype._colorMaxes={rgb:[255,255,255,255],hsb:[360,100,100,1],hsl:[360,100,100,1]},t.value=i.default.prototype.color(e).toString("#rrggbb")):t.value="#000000",(t=o(t,this)).color=function(){return e&&(e.mode&&(i.default.prototype._colorMode=e.mode),e.maxes&&(i.default.prototype._colorMaxes=e.maxes)),i.default.prototype.color(this.elt.value)},t},i.default.prototype.createInput=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:"",t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:"text",r=(i.default._validateParameters("createInput",arguments),document.createElement("input"));return r.setAttribute("value",e),r.setAttribute("type",t),o(r,this)},i.default.prototype.createFileInput=function(e){var t,r=1<arguments.length&&void 0!==arguments[1]&&arguments[1];if(i.default._validateParameters("createFileInput",arguments),window.File&&window.FileReader&&window.FileList&&window.Blob)return(t=document.createElement("input")).setAttribute("type","file"),r&&t.setAttribute("multiple",!0),t.addEventListener("change",(function(t){var r=!0,n=!1,s=void 0;try{for(var o,a=t.target.files[Symbol.iterator]();!(r=(o=a.next()).done);r=!0){var l=o.value;i.default.File._load(l,e)}}catch(t){n=!0,s=t}finally{try{r||null==a.return||a.return()}finally{if(n)throw s}}}),!1),o(t,this)},i.default.prototype.createVideo=function(e,t){return i.default._validateParameters("createVideo",arguments),a(this,"video",e,t)},i.default.prototype.createAudio=function(e,t){return i.default._validateParameters("createAudio",arguments),a(this,"audio",e,t)},i.default.prototype.VIDEO="video",i.default.prototype.AUDIO="audio",void 0===navigator.mediaDevices&&(navigator.mediaDevices={}),void 0===navigator.mediaDevices.getUserMedia&&(navigator.mediaDevices.getUserMedia=function(e){var t=navigator.webkitGetUserMedia||navigator.mozGetUserMedia;return t?new Promise((function(r,n){t.call(navigator,e,r,n)})):Promise.reject(new Error("getUserMedia is not implemented in this browser"))}),i.default.prototype.createCapture=function(){if(i.default._validateParameters("createCapture",arguments),!navigator.mediaDevices||!navigator.mediaDevices.getUserMedia)throw new DOMException("getUserMedia not supported in this browser");var e,t=!0,r=!0,n=!0,a=!1,l=void 0;try{for(var c,u=arguments[Symbol.iterator]();!(n=(c=u.next()).done);n=!0){var h=c.value;h===i.default.prototype.VIDEO?r=!1:h===i.default.prototype.AUDIO?t=!1:"object"===s(h)?d=h:"function"==typeof h&&(e=h)}}catch(e){a=!0,l=e}finally{try{n||null==u.return||u.return()}finally{if(a)throw l}}var d=d||{video:t,audio:r},p=document.createElement("video"),f=(p.setAttribute("playsinline",""),navigator.mediaDevices.getUserMedia(d).then((function(e){try{"srcObject"in p?p.srcObject=e:p.src=window.URL.createObjectURL(e)}catch(t){p.src=e}}),console.log),o(p,this,!0));return f.loadedmetadata=!1,p.addEventListener("loadedmetadata",(function(){p.play(),p.width?(f.width=p.width,f.height=p.height):(f.width=f.elt.width=p.videoWidth,f.height=f.elt.height=p.videoHeight),f.loadedmetadata=!0,e&&e(p.srcObject)})),f},i.default.prototype.createElement=function(e,t){return i.default._validateParameters("createElement",arguments),e=document.createElement(e),void 0!==t&&(e.innerHTML=t),o(e,this)},i.default.Element.prototype.addClass=function(e){return this.elt.className?this.hasClass(e)||(this.elt.className=this.elt.className+" "+e):this.elt.className=e,this},i.default.Element.prototype.removeClass=function(e){return this.elt.classList.remove(e),this},i.default.Element.prototype.hasClass=function(e){return this.elt.classList.contains(e)},i.default.Element.prototype.toggleClass=function(e){return this.elt.classList.contains(e)?this.elt.classList.remove(e):this.elt.classList.add(e),this},i.default.Element.prototype.child=function(e){return void 0===e?this.elt.childNodes:("string"==typeof e?("#"===e[0]&&(e=e.substring(1)),e=document.getElementById(e)):e instanceof i.default.Element&&(e=e.elt),e instanceof HTMLElement&&this.elt.appendChild(e),this)},i.default.Element.prototype.center=function(e){var t=this.elt.style.display,r="none"===this.elt.style.display,n="none"===this.parent().style.display,i={x:this.elt.offsetLeft,y:this.elt.offsetTop},s=(r&&this.show(),n&&this.parent().show(),this.elt.style.display="block",this.position(0,0),Math.abs(this.parent().offsetWidth-this.elt.offsetWidth)),o=Math.abs(this.parent().offsetHeight-this.elt.offsetHeight);return"both"===e||void 0===e?this.position(s/2+this.parent().offsetLeft,o/2+this.parent().offsetTop):"horizontal"===e?this.position(s/2+this.parent().offsetLeft,i.y):"vertical"===e&&this.position(i.x,o/2+this.parent().offsetTop),this.style("display",t),r&&this.hide(),n&&this.parent().hide(),this},i.default.Element.prototype.html=function(){return 0===arguments.length?this.elt.innerHTML:(arguments[1]?this.elt.insertAdjacentHTML("beforeend",arguments[0]):this.elt.innerHTML=arguments[0],this)},i.default.Element.prototype.position=function(){return 0===arguments.length?{x:this.elt.offsetLeft,y:this.elt.offsetTop}:(this.elt.style.position="static"!==arguments[2]&&"fixed"!==arguments[2]&&"relative"!==arguments[2]&&"sticky"!==arguments[2]&&"initial"!==arguments[2]&&"inherit"!==arguments[2]?"absolute":arguments[2],this.elt.style.left=arguments[0]+"px",this.elt.style.top=arguments[1]+"px",this.x=arguments[0],this.y=arguments[1],this)},i.default.Element.prototype._translate=function(){this.elt.style.position="absolute";var e="";return this.elt.style.transform&&(e=(e=this.elt.style.transform.replace(/translate3d\(.*\)/g,"")).replace(/translate[X-Z]?\(.*\)/g,"")),2===arguments.length?this.elt.style.transform="translate("+arguments[0]+"px, "+arguments[1]+"px)":2<arguments.length&&(this.elt.style.transform="translate3d("+arguments[0]+"px,"+arguments[1]+"px,"+arguments[2]+"px)",this.elt.parentElement.style.perspective=3===arguments.length?"1000px":arguments[3]+"px"),this.elt.style.transform+=e,this},i.default.Element.prototype._rotate=function(){var e="";return this.elt.style.transform&&(e=(e=this.elt.style.transform.replace(/rotate3d\(.*\)/g,"")).replace(/rotate[X-Z]?\(.*\)/g,"")),1===arguments.length?this.elt.style.transform="rotate("+arguments[0]+"deg)":2===arguments.length?this.elt.style.transform="rotate("+arguments[0]+"deg, "+arguments[1]+"deg)":3===arguments.length&&(this.elt.style.transform="rotateX("+arguments[0]+"deg)",this.elt.style.transform+="rotateY("+arguments[1]+"deg)",this.elt.style.transform+="rotateZ("+arguments[2]+"deg)"),this.elt.style.transform+=e,this},i.default.Element.prototype.style=function(e,t){if(void 0===(t=t instanceof i.default.Color?"rgba("+t.levels[0]+","+t.levels[1]+","+t.levels[2]+","+t.levels[3]/255+")":t)){if(-1===e.indexOf(":"))return window.getComputedStyle(this.elt).getPropertyValue(e);for(var r=e.split(";"),n=0;n<r.length;n++){var s=r[n].split(":");s[0]&&s[1]&&(this.elt.style[s[0].trim()]=s[1].trim())}}else this.elt.style[e]=t,"width"!==e&&"height"!==e&&"left"!==e&&"top"!==e||(t=window.getComputedStyle(this.elt).getPropertyValue(e).replace(/[^\d.]/g,""),this[e]=Math.round(parseFloat(t,10)));return this},i.default.Element.prototype.attribute=function(e,t){if(null==this.elt.firstChild||"checkbox"!==this.elt.firstChild.type&&"radio"!==this.elt.firstChild.type)return void 0===t?this.elt.getAttribute(e):(this.elt.setAttribute(e,t),this);if(void 0===t)return this.elt.firstChild.getAttribute(e);for(var r=0;r<this.elt.childNodes.length;r++)this.elt.childNodes[r].setAttribute(e,t)},i.default.Element.prototype.removeAttribute=function(e){if(null!=this.elt.firstChild&&("checkbox"===this.elt.firstChild.type||"radio"===this.elt.firstChild.type))for(var t=0;t<this.elt.childNodes.length;t++)this.elt.childNodes[t].removeAttribute(e);return this.elt.removeAttribute(e),this},i.default.Element.prototype.value=function(){return 0<arguments.length?(this.elt.value=arguments[0],this):"range"===this.elt.type?parseFloat(this.elt.value):this.elt.value},i.default.Element.prototype.show=function(){return this.elt.style.display="block",this},i.default.Element.prototype.hide=function(){return this.elt.style.display="none",this},i.default.Element.prototype.size=function(e,t){if(0===arguments.length)return{width:this.elt.offsetWidth,height:this.elt.offsetHeight};var r=e,n=t,s=i.default.prototype.AUTO;if(r!==s||n!==s){if(r===s?r=t*this.width/this.height:n===s&&(n=e*this.height/this.width),this.elt instanceof HTMLCanvasElement){var o,a={},l=this.elt.getContext("2d");for(o in l)a[o]=l[o];for(o in this.elt.setAttribute("width",r*this._pInst._pixelDensity),this.elt.setAttribute("height",n*this._pInst._pixelDensity),this.elt.style.width=r+"px",this.elt.style.height=n+"px",this._pInst.scale(this._pInst._pixelDensity,this._pInst._pixelDensity),a)this.elt.getContext("2d")[o]=a[o]}else this.elt.style.width=r+"px",this.elt.style.height=n+"px",this.elt.width=r,this.elt.height=n;this.width=this.elt.offsetWidth,this.height=this.elt.offsetHeight,this._pInst&&this._pInst._curElement&&this._pInst._curElement.elt===this.elt&&(this._pInst._setProperty("width",this.elt.offsetWidth),this._pInst._setProperty("height",this.elt.offsetHeight))}return this},i.default.Element.prototype.remove=function(){this instanceof i.default.MediaElement&&(this.stop(),null!==(t=this.elt.srcObject)&&t.getTracks().forEach((function(e){e.stop()})));var e,t=this._pInst._elements.indexOf(this);for(e in-1!==t&&this._pInst._elements.splice(t,1),this._events)this.elt.removeEventListener(e,this._events[e]);this.elt&&this.elt.parentNode&&this.elt.parentNode.removeChild(this.elt)},i.default.Element.prototype.drop=function(e,t){var r;return window.File&&window.FileReader&&window.FileList&&window.Blob&&(this._dragDisabled||(this._dragDisabled=!0,this.elt.addEventListener("dragover",r=function(e){e.preventDefault()}),this.elt.addEventListener("dragleave",r)),i.default.Element._attachListener("drop",(function(r){r.preventDefault(),"function"==typeof t&&t.call(this,r);for(var n=r.dataTransfer.files,s=0;s<n.length;s++){var o=n[s];i.default.File._load(o,e)}}),this)),this},i.default.MediaElement=function(e,t){i.default.Element.call(this,e,t);var r=this;this.elt.crossOrigin="anonymous",this._prevTime=0,this._cueIDCounter=0,this._cues=[],(this._pixelsState=this)._pixelDensity=1,this._modified=!1,Object.defineProperty(r,"src",{get:function(){var e=r.elt.children[0].src,t=r.elt.src===window.location.href?"":r.elt.src;return e===window.location.href?t:e},set:function(t){for(var n=0;n<r.elt.children.length;n++)r.elt.removeChild(r.elt.children[n]);var i=document.createElement("source");i.src=t,e.appendChild(i),r.elt.src=t,r.modified=!0}}),r._onended=function(){},r.elt.onended=function(){r._onended(r)}},i.default.MediaElement.prototype=Object.create(i.default.Element.prototype),i.default.MediaElement.prototype.play=function(){var e;return this.elt.currentTime===this.elt.duration&&(this.elt.currentTime=0),1<this.elt.readyState||this.elt.load(),(e=this.elt.play())&&e.catch&&e.catch((function(e){e.name})),this},i.default.MediaElement.prototype.stop=function(){return this.elt.pause(),this.elt.currentTime=0,this},i.default.MediaElement.prototype.pause=function(){return this.elt.pause(),this},i.default.MediaElement.prototype.loop=function(){return this.elt.setAttribute("loop",!0),this.play(),this},i.default.MediaElement.prototype.noLoop=function(){return this.elt.removeAttribute("loop"),this},i.default.MediaElement.prototype._setupAutoplayFailDetection=function(){var e=setTimeout((function(){}),500);this.elt.addEventListener("play",(function(){return clearTimeout(e)}),{passive:!0,once:!0})},i.default.MediaElement.prototype.autoplay=function(e){var t=this,r=this.elt.getAttribute("autoplay");return this.elt.setAttribute("autoplay",e),e&&!r&&(e=function(){return t._setupAutoplayFailDetection()},4===this.elt.readyState?e():this.elt.addEventListener("canplay",e,{passive:!0,once:!0})),this},i.default.MediaElement.prototype.volume=function(e){if(void 0===e)return this.elt.volume;this.elt.volume=e},i.default.MediaElement.prototype.speed=function(e){if(void 0===e)return this.presetPlaybackRate||this.elt.playbackRate;this.loadedmetadata?this.elt.playbackRate=e:this.presetPlaybackRate=e},i.default.MediaElement.prototype.time=function(e){return void 0===e?this.elt.currentTime:(this.elt.currentTime=e,this)},i.default.MediaElement.prototype.duration=function(){return this.elt.duration},i.default.MediaElement.prototype.pixels=[],i.default.MediaElement.prototype._ensureCanvas=function(){this.canvas||(this.canvas=document.createElement("canvas"),this.drawingContext=this.canvas.getContext("2d"),this.setModified(!0)),this.loadedmetadata&&(this.canvas.width!==this.elt.width&&(this.canvas.width=this.elt.width,this.canvas.height=this.elt.height,this.width=this.canvas.width,this.height=this.canvas.height),this.drawingContext.drawImage(this.elt,0,0,this.canvas.width,this.canvas.height),this.setModified(!0))},i.default.MediaElement.prototype.loadPixels=function(){return this._ensureCanvas(),i.default.Renderer2D.prototype.loadPixels.apply(this,arguments)},i.default.MediaElement.prototype.updatePixels=function(e,t,r,n){return this.loadedmetadata&&(this._ensureCanvas(),i.default.Renderer2D.prototype.updatePixels.call(this,e,t,r,n)),this.setModified(!0),this},i.default.MediaElement.prototype.get=function(){return this._ensureCanvas(),i.default.Renderer2D.prototype.get.apply(this,arguments)},i.default.MediaElement.prototype._getPixel=function(){return this.loadPixels(),i.default.Renderer2D.prototype._getPixel.apply(this,arguments)},i.default.MediaElement.prototype.set=function(e,t,r){this.loadedmetadata&&(this._ensureCanvas(),i.default.Renderer2D.prototype.set.call(this,e,t,r),this.setModified(!0))},i.default.MediaElement.prototype.copy=function(){this._ensureCanvas(),i.default.prototype.copy.apply(this,arguments)},i.default.MediaElement.prototype.mask=function(){this.loadPixels(),this.setModified(!0),i.default.Image.prototype.mask.apply(this,arguments)},i.default.MediaElement.prototype.isModified=function(){return this._modified},i.default.MediaElement.prototype.setModified=function(e){this._modified=e},i.default.MediaElement.prototype.onended=function(e){return this._onended=e,this},i.default.MediaElement.prototype.connect=function(e){var t,r;if("function"==typeof i.default.prototype.getAudioContext)t=i.default.prototype.getAudioContext(),r=i.default.soundOut.input;else try{r=(t=e.context).destination}catch(e){throw"connect() is meant to be used with Web Audio API or p5.sound.js"}this.audioSourceNode||(this.audioSourceNode=t.createMediaElementSource(this.elt),this.audioSourceNode.connect(r)),e?e.input?this.audioSourceNode.connect(e.input):this.audioSourceNode.connect(e):this.audioSourceNode.connect(r)},i.default.MediaElement.prototype.disconnect=function(){if(!this.audioSourceNode)throw"nothing to disconnect";this.audioSourceNode.disconnect()},i.default.MediaElement.prototype.showControls=function(){this.elt.style["text-align"]="inherit",this.elt.controls=!0},i.default.MediaElement.prototype.hideControls=function(){this.elt.controls=!1},i.default.MediaElement.prototype.addCue=function(e,t,r){var n=this._cueIDCounter++;t=new l(t,e,n,r);return this._cues.push(t),this.elt.ontimeupdate||(this.elt.ontimeupdate=this._onTimeUpdate.bind(this)),n},i.default.MediaElement.prototype.removeCue=function(e){for(var t=0;t<this._cues.length;t++)this._cues[t].id===e&&this._cues.splice(t,1);0===this._cues.length&&(this.elt.ontimeupdate=null)},i.default.MediaElement.prototype.clearCues=function(){this._cues=[],this.elt.ontimeupdate=null},i.default.MediaElement.prototype._onTimeUpdate=function(){for(var e=this.time(),t=0;t<this._cues.length;t++){var r=this._cues[t].time,n=this._cues[t].val;this._prevTime<r&&r<=e&&this._cues[t].callback(n)}this._prevTime=e},i.default.File=function(e,t){this.file=e,this._pInst=t,t=e.type.split("/"),this.type=t[0],this.subtype=t[1],this.name=e.name,this.size=e.size,this.data=void 0},i.default.File._createLoader=function(e,t){var r=new FileReader;return r.onload=function(r){var n,s=new i.default.File(e);"application/json"===s.file.type?s.data=JSON.parse(r.target.result):"text/xml"===s.file.type?(n=(new DOMParser).parseFromString(r.target.result,"text/xml"),s.data=new i.default.XML(n.documentElement)):s.data=r.target.result,t(s)},r},i.default.File._load=function(e,t){var r;/^text\//.test(e.type)||"application/json"===e.type?i.default.File._createLoader(e,t).readAsText(e):/^(video|audio)\//.test(e.type)?((r=new i.default.File(e)).data=URL.createObjectURL(e),t(r)):i.default.File._createLoader(e,t).readAsDataURL(e)},e=i.default,r.default=e},{"../core/main":267,"core-js/modules/es.array.every":151,"core-js/modules/es.array.filter":153,"core-js/modules/es.array.for-each":154,"core-js/modules/es.array.from":155,"core-js/modules/es.array.index-of":157,"core-js/modules/es.array.iterator":158,"core-js/modules/es.array.map":161,"core-js/modules/es.array.slice":162,"core-js/modules/es.array.splice":164,"core-js/modules/es.function.name":165,"core-js/modules/es.object.to-string":177,"core-js/modules/es.promise":178,"core-js/modules/es.regexp.exec":181,"core-js/modules/es.regexp.to-string":182,"core-js/modules/es.string.iterator":186,"core-js/modules/es.string.replace":189,"core-js/modules/es.string.split":191,"core-js/modules/es.string.trim":193,"core-js/modules/es.symbol":196,"core-js/modules/es.symbol.description":194,"core-js/modules/es.symbol.iterator":195,"core-js/modules/web.dom-collections.for-each":229,"core-js/modules/web.dom-collections.iterator":230,"core-js/modules/web.url":232}],284:[function(e,t,r){"use strict";function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function i(e){return(i="function"==typeof Symbol&&"symbol"===n(Symbol.iterator)?function(e){return n(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":n(e)})(e)}e("core-js/modules/es.symbol"),e("core-js/modules/es.symbol.description"),e("core-js/modules/es.symbol.iterator"),e("core-js/modules/es.array.iterator"),e("core-js/modules/es.object.get-own-property-descriptor"),e("core-js/modules/es.object.to-string"),e("core-js/modules/es.string.iterator"),e("core-js/modules/es.weak-map"),e("core-js/modules/web.dom-collections.iterator"),Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var s=(g=e("../core/main"))&&g.__esModule?g:{default:g},o=function(e){if(e&&e.__esModule)return e;if(null===e||"object"!==i(e)&&"function"!=typeof e)return{default:e};var t=a();if(t&&t.has(e))return t.get(e);var r,n={},s=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(r in e){var o;Object.prototype.hasOwnProperty.call(e,r)&&((o=s?Object.getOwnPropertyDescriptor(e,r):null)&&(o.get||o.set)?Object.defineProperty(n,r,o):n[r]=e[r])}return n.default=e,t&&t.set(e,n),n}(e("../core/constants"));function a(){var e;return"function"!=typeof WeakMap?null:(e=new WeakMap,a=function(){return e},e)}s.default.prototype.deviceOrientation=1<window.innerWidth/window.innerHeight?"landscape":"portrait",s.default.prototype.accelerationX=0,s.default.prototype.accelerationY=0,s.default.prototype.accelerationZ=0,s.default.prototype.pAccelerationX=0,s.default.prototype.pAccelerationY=0,s.default.prototype.pAccelerationZ=0,s.default.prototype._updatePAccelerations=function(){this._setProperty("pAccelerationX",this.accelerationX),this._setProperty("pAccelerationY",this.accelerationY),this._setProperty("pAccelerationZ",this.accelerationZ)},s.default.prototype.rotationX=0,s.default.prototype.rotationY=0,s.default.prototype.rotationZ=0,s.default.prototype.pRotationX=0,s.default.prototype.pRotationY=0;var l=s.default.prototype.pRotationZ=0,c=0,u=0,h="clockwise",d="clockwise",p="clockwise",f=(s.default.prototype.pRotateDirectionX=void 0,s.default.prototype.pRotateDirectionY=void 0,s.default.prototype.pRotateDirectionZ=void 0,s.default.prototype._updatePRotations=function(){this._setProperty("pRotationX",this.rotationX),this._setProperty("pRotationY",this.rotationY),this._setProperty("pRotationZ",this.rotationZ)},s.default.prototype.turnAxis=void 0,.5),m=30,g=(s.default.prototype.setMoveThreshold=function(e){s.default._validateParameters("setMoveThreshold",arguments),f=e},s.default.prototype.setShakeThreshold=function(e){s.default._validateParameters("setShakeThreshold",arguments),m=e},s.default.prototype._ondeviceorientation=function(e){this._updatePRotations(),this._angleMode===o.radians&&(e.beta=e.beta*(_PI/180),e.gamma=e.gamma*(_PI/180),e.alpha=e.alpha*(_PI/180)),this._setProperty("rotationX",e.beta),this._setProperty("rotationY",e.gamma),this._setProperty("rotationZ",e.alpha),this._handleMotion()},s.default.prototype._ondevicemotion=function(e){this._updatePAccelerations(),this._setProperty("accelerationX",2*e.acceleration.x),this._setProperty("accelerationY",2*e.acceleration.y),this._setProperty("accelerationZ",2*e.acceleration.z),this._handleMotion()},s.default.prototype._handleMotion=function(){90===window.orientation||-90===window.orientation?this._setProperty("deviceOrientation","landscape"):0===window.orientation?this._setProperty("deviceOrientation","portrait"):void 0===window.orientation&&this._setProperty("deviceOrientation","undefined");var e,t,r,n,i,s=this._isGlobal?window:this;"function"==typeof s.deviceMoved&&(Math.abs(this.accelerationX-this.pAccelerationX)>f||Math.abs(this.accelerationY-this.pAccelerationY)>f||Math.abs(this.accelerationZ-this.pAccelerationZ)>f)&&s.deviceMoved(),"function"==typeof s.deviceTurned&&(t=this.rotationX+180,e=this.pRotationX+180,r=l+180,0<t-e&&t-e<270||t-e<-270?h="clockwise":(t-e<0||270<t-e)&&(h="counter-clockwise"),h!==this.pRotateDirectionX&&(r=t),90<Math.abs(t-r)&&Math.abs(t-r)<270&&(r=t,this._setProperty("turnAxis","X"),s.deviceTurned()),this.pRotateDirectionX=h,l=r-180,e=this.rotationY+180,t=this.pRotationY+180,r=c+180,0<e-t&&e-t<270||e-t<-270?d="clockwise":(e-t<0||270<e-this.pRotationY)&&(d="counter-clockwise"),d!==this.pRotateDirectionY&&(r=e),90<Math.abs(e-r)&&Math.abs(e-r)<270&&(r=e,this._setProperty("turnAxis","Y"),s.deviceTurned()),this.pRotateDirectionY=d,c=r-180,0<this.rotationZ-this.pRotationZ&&this.rotationZ-this.pRotationZ<270||this.rotationZ-this.pRotationZ<-270?p="clockwise":(this.rotationZ-this.pRotationZ<0||270<this.rotationZ-this.pRotationZ)&&(p="counter-clockwise"),p!==this.pRotateDirectionZ&&(u=this.rotationZ),90<Math.abs(this.rotationZ-u)&&Math.abs(this.rotationZ-u)<270&&(u=this.rotationZ,this._setProperty("turnAxis","Z"),s.deviceTurned()),this.pRotateDirectionZ=p,this._setProperty("turnAxis",void 0)),"function"==typeof s.deviceShaken&&(null!==this.pAccelerationX&&(n=Math.abs(this.accelerationX-this.pAccelerationX),i=Math.abs(this.accelerationY-this.pAccelerationY)),m<n+i&&s.deviceShaken())},s.default);r.default=g},{"../core/constants":256,"../core/main":267,"core-js/modules/es.array.iterator":158,"core-js/modules/es.object.get-own-property-descriptor":173,"core-js/modules/es.object.to-string":177,"core-js/modules/es.string.iterator":186,"core-js/modules/es.symbol":196,"core-js/modules/es.symbol.description":194,"core-js/modules/es.symbol.iterator":195,"core-js/modules/es.weak-map":228,"core-js/modules/web.dom-collections.iterator":230}],285:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n=(e=e("../core/main"))&&e.__esModule?e:{default:e};n.default.prototype.isKeyPressed=!1,n.default.prototype.keyIsPressed=!1,n.default.prototype.key="",n.default.prototype.keyCode=0,n.default.prototype._onkeydown=function(e){var t;this._downKeys[e.which]||(this._setProperty("isKeyPressed",!0),this._setProperty("keyIsPressed",!0),this._setProperty("keyCode",e.which),this._downKeys[e.which]=!0,this._setProperty("key",e.key||String.fromCharCode(e.which)||e.which),"function"!=typeof(t=this._isGlobal?window:this).keyPressed||e.charCode||!1===t.keyPressed(e)&&e.preventDefault())},n.default.prototype._onkeyup=function(e){this._downKeys[e.which]=!1,this._areDownKeys()||(this._setProperty("isKeyPressed",!1),this._setProperty("keyIsPressed",!1)),this._setProperty("_lastKeyCodeTyped",null),this._setProperty("key",e.key||String.fromCharCode(e.which)||e.which),this._setProperty("keyCode",e.which);var t=this._isGlobal?window:this;"function"==typeof t.keyReleased&&!1===t.keyReleased(e)&&e.preventDefault()},n.default.prototype._onkeypress=function(e){var t;e.which!==this._lastKeyCodeTyped&&(this._setProperty("_lastKeyCodeTyped",e.which),this._setProperty("key",e.key||String.fromCharCode(e.which)||e.which),"function"==typeof(t=this._isGlobal?window:this).keyTyped&&!1===t.keyTyped(e)&&e.preventDefault())},n.default.prototype._onblur=function(e){this._downKeys={}},n.default.prototype.keyIsDown=function(e){return n.default._validateParameters("keyIsDown",arguments),this._downKeys[e]||!1},n.default.prototype._areDownKeys=function(){for(var e in this._downKeys)if(this._downKeys.hasOwnProperty(e)&&!0===this._downKeys[e])return!0;return!1},e=n.default,r.default=e},{"../core/main":267}],286:[function(e,t,r){"use strict";function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function i(e){return(i="function"==typeof Symbol&&"symbol"===n(Symbol.iterator)?function(e){return n(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":n(e)})(e)}e("core-js/modules/es.symbol"),e("core-js/modules/es.symbol.description"),e("core-js/modules/es.symbol.iterator"),e("core-js/modules/es.array.includes"),e("core-js/modules/es.array.iterator"),e("core-js/modules/es.object.get-own-property-descriptor"),e("core-js/modules/es.object.to-string"),e("core-js/modules/es.string.includes"),e("core-js/modules/es.string.iterator"),e("core-js/modules/es.weak-map"),e("core-js/modules/web.dom-collections.iterator"),e("core-js/modules/es.array.includes"),e("core-js/modules/es.string.includes"),Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var s=(s=e("../core/main"))&&s.__esModule?s:{default:s},o=function(e){if(e&&e.__esModule)return e;if(null===e||"object"!==i(e)&&"function"!=typeof e)return{default:e};var t=a();if(t&&t.has(e))return t.get(e);var r,n={},s=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(r in e){var o;Object.prototype.hasOwnProperty.call(e,r)&&((o=s?Object.getOwnPropertyDescriptor(e,r):null)&&(o.get||o.set)?Object.defineProperty(n,r,o):n[r]=e[r])}return n.default=e,t&&t.set(e,n),n}(e("../core/constants"));function a(){var e;return"function"!=typeof WeakMap?null:(e=new WeakMap,a=function(){return e},e)}s.default.prototype.movedX=0,s.default.prototype.movedY=0,s.default.prototype._hasMouseInteracted=!1,s.default.prototype.mouseX=0,s.default.prototype.mouseY=0,s.default.prototype.pmouseX=0,s.default.prototype.pmouseY=0,s.default.prototype.winMouseX=0,s.default.prototype.winMouseY=0,s.default.prototype.pwinMouseX=0,s.default.prototype.pwinMouseY=0,s.default.prototype.mouseButton=0,s.default.prototype.mouseIsPressed=!1,s.default.prototype._updateNextMouseCoords=function(e){var t,r,n,i,s;null!==this._curElement&&(!e.touches||0<e.touches.length)&&(t=this._curElement.elt,r=this.width,n=this.height,(i=e)&&!i.clientX&&(i.touches?i=i.touches[0]:i.changedTouches&&(i=i.changedTouches[0])),s=t.getBoundingClientRect(),r=t.scrollWidth/r||1,t=t.scrollHeight/n||1,n={x:(i.clientX-s.left)/r,y:(i.clientY-s.top)/t,winX:i.clientX,winY:i.clientY,id:i.identifier},this._setProperty("movedX",e.movementX),this._setProperty("movedY",e.movementY),this._setProperty("mouseX",n.x),this._setProperty("mouseY",n.y),this._setProperty("winMouseX",n.winX),this._setProperty("winMouseY",n.winY)),this._hasMouseInteracted||(this._updateMouseCoords(),this._setProperty("_hasMouseInteracted",!0))},s.default.prototype._updateMouseCoords=function(){this._setProperty("pmouseX",this.mouseX),this._setProperty("pmouseY",this.mouseY),this._setProperty("pwinMouseX",this.winMouseX),this._setProperty("pwinMouseY",this.winMouseY),this._setProperty("_pmouseWheelDeltaY",this._mouseWheelDeltaY)},s.default.prototype._setMouseButton=function(e){1===e.button?this._setProperty("mouseButton",o.CENTER):2===e.button?this._setProperty("mouseButton",o.RIGHT):this._setProperty("mouseButton",o.LEFT)},s.default.prototype._onmousemove=function(e){var t=this._isGlobal?window:this;this._updateNextMouseCoords(e),this.mouseIsPressed?"function"==typeof t.mouseDragged?!1===t.mouseDragged(e)&&e.preventDefault():"function"==typeof t.touchMoved&&!1===t.touchMoved(e)&&e.preventDefault():"function"==typeof t.mouseMoved&&!1===t.mouseMoved(e)&&e.preventDefault()},s.default.prototype._onmousedown=function(e){var t=this._isGlobal?window:this;this._setProperty("mouseIsPressed",!0),this._setMouseButton(e),this._updateNextMouseCoords(e),"function"==typeof t.mousePressed?!1===t.mousePressed(e)&&e.preventDefault():navigator.userAgent.toLowerCase().includes("safari")&&"function"==typeof t.touchStarted&&!1===t.touchStarted(e)&&e.preventDefault()},s.default.prototype._onmouseup=function(e){var t=this._isGlobal?window:this;this._setProperty("mouseIsPressed",!1),"function"==typeof t.mouseReleased?!1===t.mouseReleased(e)&&e.preventDefault():"function"==typeof t.touchEnded&&!1===t.touchEnded(e)&&e.preventDefault()},s.default.prototype._ondragend=s.default.prototype._onmouseup,s.default.prototype._ondragover=s.default.prototype._onmousemove,s.default.prototype._onclick=function(e){var t=this._isGlobal?window:this;"function"==typeof t.mouseClicked&&!1===t.mouseClicked(e)&&e.preventDefault()},s.default.prototype._ondblclick=function(e){var t=this._isGlobal?window:this;"function"==typeof t.doubleClicked&&!1===t.doubleClicked(e)&&e.preventDefault()},s.default.prototype._mouseWheelDeltaY=0,s.default.prototype._pmouseWheelDeltaY=0,s.default.prototype._onwheel=function(e){var t=this._isGlobal?window:this;this._setProperty("_mouseWheelDeltaY",e.deltaY),"function"==typeof t.mouseWheel&&(e.delta=e.deltaY,!1===t.mouseWheel(e)&&e.preventDefault())},s.default.prototype.requestPointerLock=function(){var e=this._curElement.elt;return e.requestPointerLock=e.requestPointerLock||e.mozRequestPointerLock,!!e.requestPointerLock&&(e.requestPointerLock(),!0)},s.default.prototype.exitPointerLock=function(){document.exitPointerLock()},e=s.default,r.default=e},{"../core/constants":256,"../core/main":267,"core-js/modules/es.array.includes":156,"core-js/modules/es.array.iterator":158,"core-js/modules/es.object.get-own-property-descriptor":173,"core-js/modules/es.object.to-string":177,"core-js/modules/es.string.includes":185,"core-js/modules/es.string.iterator":186,"core-js/modules/es.symbol":196,"core-js/modules/es.symbol.description":194,"core-js/modules/es.symbol.iterator":195,"core-js/modules/es.weak-map":228,"core-js/modules/web.dom-collections.iterator":230}],287:[function(e,t,r){"use strict";e("core-js/modules/es.array.includes"),e("core-js/modules/es.string.includes"),e("core-js/modules/es.array.includes"),e("core-js/modules/es.string.includes"),Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0,(e=(e=e("../core/main"))&&e.__esModule?e:{default:e}).default.prototype.touches=[],e.default.prototype._updateTouchCoords=function(e){if(null!==this._curElement){for(var t=[],r=0;r<e.touches.length;r++)t[r]=function(e,t,r,n){var i=4<arguments.length&&void 0!==arguments[4]?arguments[4]:0,s=e.getBoundingClientRect();t=e.scrollWidth/t||1,e=e.scrollHeight/r||1;return{x:((r=n.touches[i]||n.changedTouches[i]).clientX-s.left)/t,y:(r.clientY-s.top)/e,winX:r.clientX,winY:r.clientY,id:r.identifier}}(this._curElement.elt,this.width,this.height,e,r);this._setProperty("touches",t)}},e.default.prototype._ontouchstart=function(e){var t=this._isGlobal?window:this;this._setProperty("mouseIsPressed",!0),this._updateTouchCoords(e),this._updateNextMouseCoords(e),this._updateMouseCoords(),"function"==typeof t.touchStarted?!1===t.touchStarted(e)&&e.preventDefault():navigator.userAgent.toLowerCase().includes("safari")&&"function"==typeof t.mousePressed&&!1===t.mousePressed(e)&&e.preventDefault()},e.default.prototype._ontouchmove=function(e){var t=this._isGlobal?window:this;this._updateTouchCoords(e),this._updateNextMouseCoords(e),"function"==typeof t.touchMoved?!1===t.touchMoved(e)&&e.preventDefault():"function"==typeof t.mouseDragged&&!1===t.mouseDragged(e)&&e.preventDefault()},e.default.prototype._ontouchend=function(e){this._setProperty("mouseIsPressed",!1),this._updateTouchCoords(e),this._updateNextMouseCoords(e);var t=this._isGlobal?window:this;"function"==typeof t.touchEnded?!1===t.touchEnded(e)&&e.preventDefault():"function"==typeof t.mouseReleased&&!1===t.mouseReleased(e)&&e.preventDefault()},e=e.default,r.default=e},{"../core/main":267,"core-js/modules/es.array.includes":156,"core-js/modules/es.string.includes":185}],288:[function(e,t,r){"use strict";e("core-js/modules/es.array.iterator"),e("core-js/modules/es.object.to-string"),e("core-js/modules/es.typed-array.int32-array"),e("core-js/modules/es.typed-array.uint8-array"),e("core-js/modules/es.typed-array.copy-within"),e("core-js/modules/es.typed-array.every"),e("core-js/modules/es.typed-array.fill"),e("core-js/modules/es.typed-array.filter"),e("core-js/modules/es.typed-array.find"),e("core-js/modules/es.typed-array.find-index"),e("core-js/modules/es.typed-array.for-each"),e("core-js/modules/es.typed-array.includes"),e("core-js/modules/es.typed-array.index-of"),e("core-js/modules/es.typed-array.iterator"),e("core-js/modules/es.typed-array.join"),e("core-js/modules/es.typed-array.last-index-of"),e("core-js/modules/es.typed-array.map"),e("core-js/modules/es.typed-array.reduce"),e("core-js/modules/es.typed-array.reduce-right"),e("core-js/modules/es.typed-array.reverse"),e("core-js/modules/es.typed-array.set"),e("core-js/modules/es.typed-array.slice"),e("core-js/modules/es.typed-array.some"),e("core-js/modules/es.typed-array.sort"),e("core-js/modules/es.typed-array.subarray"),e("core-js/modules/es.typed-array.to-locale-string"),e("core-js/modules/es.typed-array.to-string"),e("core-js/modules/es.array.iterator"),e("core-js/modules/es.object.to-string"),e("core-js/modules/es.typed-array.int32-array"),e("core-js/modules/es.typed-array.uint8-array"),e("core-js/modules/es.typed-array.copy-within"),e("core-js/modules/es.typed-array.every"),e("core-js/modules/es.typed-array.fill"),e("core-js/modules/es.typed-array.filter"),e("core-js/modules/es.typed-array.find"),e("core-js/modules/es.typed-array.find-index"),e("core-js/modules/es.typed-array.for-each"),e("core-js/modules/es.typed-array.includes"),e("core-js/modules/es.typed-array.index-of"),e("core-js/modules/es.typed-array.iterator"),e("core-js/modules/es.typed-array.join"),e("core-js/modules/es.typed-array.last-index-of"),e("core-js/modules/es.typed-array.map"),e("core-js/modules/es.typed-array.reduce"),e("core-js/modules/es.typed-array.reduce-right"),e("core-js/modules/es.typed-array.reverse"),e("core-js/modules/es.typed-array.set"),e("core-js/modules/es.typed-array.slice"),e("core-js/modules/es.typed-array.some"),e("core-js/modules/es.typed-array.sort"),e("core-js/modules/es.typed-array.subarray"),e("core-js/modules/es.typed-array.to-locale-string"),e("core-js/modules/es.typed-array.to-string"),Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n,i,s,o,a={};a._toPixels=function(e){var t,r;return e instanceof ImageData?e.data:e.getContext("2d")?e.getContext("2d").getImageData(0,0,e.width,e.height).data:e.getContext("webgl")?(r=(t=e.getContext("webgl")).drawingBufferWidth*t.drawingBufferHeight*4,r=new Uint8Array(r),t.readPixels(0,0,e.width,e.height,t.RGBA,t.UNSIGNED_BYTE,r),r):void 0},a._getARGB=function(e,t){return e[3+(t*=4)]<<24&4278190080|e[t]<<16&16711680|e[1+t]<<8&65280|255&e[2+t]},a._setPixels=function(e,t){for(var r,n=0,i=e.length;n<i;n++)e[0+(r=4*n)]=(16711680&t[n])>>>16,e[1+r]=(65280&t[n])>>>8,e[2+r]=255&t[n],e[3+r]=(4278190080&t[n])>>>24},a._toImageData=function(e){return e instanceof ImageData?e:e.getContext("2d").getImageData(0,0,e.width,e.height)},a._createImageData=function(e,t){return a._tmpCanvas=document.createElement("canvas"),a._tmpCtx=a._tmpCanvas.getContext("2d"),this._tmpCtx.createImageData(e,t)},a.apply=function(e,t,r){var n=e.getContext("2d"),i=n.getImageData(0,0,e.width,e.height);(t=t(i,r))instanceof ImageData?n.putImageData(t,0,0,0,0,e.width,e.height):n.putImageData(i,0,0,0,0,e.width,e.height)},a.threshold=function(e,t){for(var r=a._toPixels(e),n=(void 0===t&&(t=.5),Math.floor(255*t)),i=0;i<r.length;i+=4){var s=n<=.2126*r[i]+.7152*r[i+1]+.0722*r[i+2]?255:0;r[i]=r[i+1]=r[i+2]=s}},a.gray=function(e){for(var t=a._toPixels(e),r=0;r<t.length;r+=4){var n=t[r],i=t[r+1],s=t[r+2];t[r]=t[r+1]=t[r+2]=.2126*n+.7152*i+.0722*s}},a.opaque=function(e){for(var t=a._toPixels(e),r=0;r<t.length;r+=4)t[r+3]=255;return t},a.invert=function(e){for(var t=a._toPixels(e),r=0;r<t.length;r+=4)t[r]=255-t[r],t[r+1]=255-t[r+1],t[r+2]=255-t[r+2]},a.posterize=function(e,t){var r=a._toPixels(e);if(t<2||255<t)throw new Error("Level must be greater than 2 and less than 255 for posterize");for(var n=t-1,i=0;i<r.length;i+=4){var s=r[i],o=r[i+1],l=r[i+2];r[i]=255*(s*t>>8)/n,r[i+1]=255*(o*t>>8)/n,r[i+2]=255*(l*t>>8)/n}},a.dilate=function(e){for(var t,r,n,i,s,o,l,c,u,h=a._toPixels(e),d=0,p=h.length?h.length/4:0,f=new Int32Array(p);d<p;)for(r=(t=d)+e.width;d<r;)i=n=a._getARGB(h,d),(u=d-1)<t&&(u=d),r<=(c=d+1)&&(c=d),(s=d-e.width)<0&&(s=0),p<=(o=d+e.width)&&(o=d),s=a._getARGB(h,s),u=a._getARGB(h,u),o=a._getARGB(h,o),(i=77*(i>>16&255)+151*(i>>8&255)+28*(255&i))<(l=77*(u>>16&255)+151*(u>>8&255)+28*(255&u))&&(n=u,i=l),i<(l=77*((u=a._getARGB(h,c))>>16&255)+151*(u>>8&255)+28*(255&u))&&(n=u,i=l),i<(c=77*(s>>16&255)+151*(s>>8&255)+28*(255&s))&&(n=s,i=c),i<(u=77*(o>>16&255)+151*(o>>8&255)+28*(255&o))&&(n=o,i=u),f[d++]=n;a._setPixels(h,f)},a.erode=function(e){for(var t,r,n,i,s,o,l,c,u,h=a._toPixels(e),d=0,p=h.length?h.length/4:0,f=new Int32Array(p);d<p;)for(r=(t=d)+e.width;d<r;)i=n=a._getARGB(h,d),(u=d-1)<t&&(u=d),r<=(c=d+1)&&(c=d),(s=d-e.width)<0&&(s=0),p<=(o=d+e.width)&&(o=d),s=a._getARGB(h,s),u=a._getARGB(h,u),o=a._getARGB(h,o),(l=77*(u>>16&255)+151*(u>>8&255)+28*(255&u))<(i=77*(i>>16&255)+151*(i>>8&255)+28*(255&i))&&(n=u,i=l),(l=77*((u=a._getARGB(h,c))>>16&255)+151*(u>>8&255)+28*(255&u))<i&&(n=u,i=l),(c=77*(s>>16&255)+151*(s>>8&255)+28*(255&s))<i&&(n=s,i=c),(u=77*(o>>16&255)+151*(o>>8&255)+28*(255&o))<i&&(n=o,i=u),f[d++]=n;a._setPixels(h,f)},a.blur=function(e,t){!function(e,t){for(var r,l,c,u,h,d,p,f,m,g,y=a._toPixels(e),v=e.width,_=e.height,x=v*_,b=new Int32Array(x),w=0;w<x;w++)b[w]=a._getARGB(y,w);var S,M,T,E=new Int32Array(x),A=new Int32Array(x),C=new Int32Array(x),L=new Int32Array(x),R=0,P=3.5*t|0;if(n!==(P=P<1?1:P<248?P:248)){i=1+(n=P)<<1,s=new Int32Array(i),o=new Array(i);for(var j,I,D=0;D<i;D++)o[D]=new Int32Array(256);for(var O=1,N=P-1;O<P;O++){s[P+O]=s[N]=I=N*N;for(var U=o[P+O],k=o[N--],F=0;F<256;F++)U[F]=k[F]=I*F}j=s[P]=P*P,U=o[P];for(var B=0;B<256;B++)U[B]=j*B}for(M=0;M<_;M++){for(S=0;S<v;S++){if(u=c=l=h=r=0,(d=S-n)<0)g=-d,d=0;else{if(v<=d)break;g=0}for(T=g;T<i&&!(v<=d);T++){var z,G=b[d+R];h+=(z=o[T])[(-16777216&G)>>>24],l+=z[(16711680&G)>>16],c+=z[(65280&G)>>8],u+=z[255&G],r+=s[T],d++}E[p=R+S]=h/r,A[p]=l/r,C[p]=c/r,L[p]=u/r}R+=v}for(m=(f=-n)*v,M=R=0;M<_;M++){for(S=0;S<v;S++){if(f<(u=c=l=h=r=0))g=p=-f,d=S;else{if(_<=f)break;g=0,p=f,d=S+m}for(T=g;T<i&&!(_<=p);T++)h+=(z=o[T])[E[d]],l+=z[A[d]],c+=z[C[d]],u+=z[L[d]],r+=s[T],p++,d+=v;b[S+R]=h/r<<24|l/r<<16|c/r<<8|u/r}R+=v,m+=v,f++}a._setPixels(y,b)}(e,t)},r.default=a},{"core-js/modules/es.array.iterator":158,"core-js/modules/es.object.to-string":177,"core-js/modules/es.typed-array.copy-within":197,"core-js/modules/es.typed-array.every":198,"core-js/modules/es.typed-array.fill":199,"core-js/modules/es.typed-array.filter":200,"core-js/modules/es.typed-array.find":202,"core-js/modules/es.typed-array.find-index":201,"core-js/modules/es.typed-array.for-each":205,"core-js/modules/es.typed-array.includes":206,"core-js/modules/es.typed-array.index-of":207,"core-js/modules/es.typed-array.int32-array":209,"core-js/modules/es.typed-array.iterator":210,"core-js/modules/es.typed-array.join":211,"core-js/modules/es.typed-array.last-index-of":212,"core-js/modules/es.typed-array.map":213,"core-js/modules/es.typed-array.reduce":215,"core-js/modules/es.typed-array.reduce-right":214,"core-js/modules/es.typed-array.reverse":216,"core-js/modules/es.typed-array.set":217,"core-js/modules/es.typed-array.slice":218,"core-js/modules/es.typed-array.some":219,"core-js/modules/es.typed-array.sort":220,"core-js/modules/es.typed-array.subarray":221,"core-js/modules/es.typed-array.to-locale-string":222,"core-js/modules/es.typed-array.to-string":223,"core-js/modules/es.typed-array.uint8-array":226}],289:[function(e,t,r){"use strict";e("core-js/modules/es.symbol"),e("core-js/modules/es.symbol.description"),e("core-js/modules/es.symbol.iterator"),e("core-js/modules/es.array.concat"),e("core-js/modules/es.array.filter"),e("core-js/modules/es.array.from"),e("core-js/modules/es.array.iterator"),e("core-js/modules/es.array.map"),e("core-js/modules/es.array.slice"),e("core-js/modules/es.object.keys"),e("core-js/modules/es.object.to-string"),e("core-js/modules/es.regexp.exec"),e("core-js/modules/es.regexp.to-string"),e("core-js/modules/es.set"),e("core-js/modules/es.string.iterator"),e("core-js/modules/es.string.replace"),e("core-js/modules/es.string.split"),e("core-js/modules/es.typed-array.uint8-array"),e("core-js/modules/es.typed-array.uint32-array"),e("core-js/modules/es.typed-array.copy-within"),e("core-js/modules/es.typed-array.every"),e("core-js/modules/es.typed-array.fill"),e("core-js/modules/es.typed-array.filter"),e("core-js/modules/es.typed-array.find"),e("core-js/modules/es.typed-array.find-index"),e("core-js/modules/es.typed-array.for-each"),e("core-js/modules/es.typed-array.includes"),e("core-js/modules/es.typed-array.index-of"),e("core-js/modules/es.typed-array.iterator"),e("core-js/modules/es.typed-array.join"),e("core-js/modules/es.typed-array.last-index-of"),e("core-js/modules/es.typed-array.map"),e("core-js/modules/es.typed-array.reduce"),e("core-js/modules/es.typed-array.reduce-right"),e("core-js/modules/es.typed-array.reverse"),e("core-js/modules/es.typed-array.set"),e("core-js/modules/es.typed-array.slice"),e("core-js/modules/es.typed-array.some"),e("core-js/modules/es.typed-array.sort"),e("core-js/modules/es.typed-array.subarray"),e("core-js/modules/es.typed-array.to-locale-string"),e("core-js/modules/es.typed-array.to-string"),e("core-js/modules/web.dom-collections.iterator"),e("core-js/modules/es.symbol"),e("core-js/modules/es.symbol.description"),e("core-js/modules/es.symbol.iterator"),e("core-js/modules/es.array.concat"),e("core-js/modules/es.array.filter"),e("core-js/modules/es.array.from"),e("core-js/modules/es.array.iterator"),e("core-js/modules/es.array.map"),e("core-js/modules/es.array.slice"),e("core-js/modules/es.object.keys"),e("core-js/modules/es.object.to-string"),e("core-js/modules/es.regexp.exec"),e("core-js/modules/es.regexp.to-string"),e("core-js/modules/es.set"),e("core-js/modules/es.string.iterator"),e("core-js/modules/es.string.replace"),e("core-js/modules/es.string.split"),e("core-js/modules/es.typed-array.uint8-array"),e("core-js/modules/es.typed-array.uint32-array"),e("core-js/modules/es.typed-array.copy-within"),e("core-js/modules/es.typed-array.every"),e("core-js/modules/es.typed-array.fill"),e("core-js/modules/es.typed-array.filter"),e("core-js/modules/es.typed-array.find"),e("core-js/modules/es.typed-array.find-index"),e("core-js/modules/es.typed-array.for-each"),e("core-js/modules/es.typed-array.includes"),e("core-js/modules/es.typed-array.index-of"),e("core-js/modules/es.typed-array.iterator"),e("core-js/modules/es.typed-array.join"),e("core-js/modules/es.typed-array.last-index-of"),e("core-js/modules/es.typed-array.map"),e("core-js/modules/es.typed-array.reduce"),e("core-js/modules/es.typed-array.reduce-right"),e("core-js/modules/es.typed-array.reverse"),e("core-js/modules/es.typed-array.set"),e("core-js/modules/es.typed-array.slice"),e("core-js/modules/es.typed-array.some"),e("core-js/modules/es.typed-array.sort"),e("core-js/modules/es.typed-array.subarray"),e("core-js/modules/es.typed-array.to-locale-string"),e("core-js/modules/es.typed-array.to-string"),e("core-js/modules/web.dom-collections.iterator"),Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n=s(e("../core/main")),i=s(e("omggif"));function s(e){return e&&e.__esModule?e:{default:e}}function o(e){return function(e){if(Array.isArray(e)){for(var t=0,r=new Array(e.length);t<e.length;t++)r[t]=e[t];return r}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}n.default.prototype.createImage=function(e,t){return n.default._validateParameters("createImage",arguments),new n.default.Image(e,t)},n.default.prototype.saveCanvas=function(){n.default._validateParameters("saveCanvas",arguments);var e,t,r,i,s=[].slice.call(arguments);switch(arguments[0]instanceof HTMLCanvasElement?(e=arguments[0],s.shift()):arguments[0]instanceof n.default.Element?(e=arguments[0].elt,s.shift()):e=this._curElement&&this._curElement.elt,1<=s.length&&(t=s[0]),r=(r=2<=s.length?s[1]:r)||n.default.prototype._checkFileExtension(t,r)[1]||"png"){default:i="image/png";break;case"jpeg":case"jpg":i="image/jpeg"}e.toBlob((function(e){n.default.prototype.downloadFile(e,t,r)}),i)},n.default.prototype.encodeAndDownloadGif=function(e,t){for(var r=e.gifProperties,s=(1===(C=r.loopLimit)?C=null:null===C&&(C=0),new Uint8Array(e.width*e.height*r.numFrames)),a=[],l={},c=0;c<r.numFrames;c++){for(var u=new Set,h=r.frames[c].image.data,d=h.length,p=new Uint32Array(e.width*e.height),f=0,m=0;f<d;f+=4,m++){var g=h[f+0]<<16|h[f+1]<<8|h[f+2]<<0;u.add(g),p[m]=g}var y=o(u).sort().toString();void 0===l[y]?l[y]={freq:1,frames:[c]}:(l[y].freq+=1,l[y].frames.push(c)),a.push(p)}for(var v=[],_=Object.keys(l).sort((function(e,t){return l[t].freq-l[e].freq})),x=_[0].split(",").map((function(e){return parseInt(e)})),b=(v=v.concat(l[x].frames),new Set(x)),w=1;w<_.length;w++){var S=_[w].split(",").map((function(e){return parseInt(e)})).filter((function(e){return!b.has(e)}));if(x.length+S.length<=256){for(var M=0;M<S.length;M++)x.push(S[M]),b.add(S[M]);v=v.concat(l[_[w]].frames)}}v=new Set(v);for(var T={},E=0;E<x.length;E++)T[x[E]]||(T[x[E]]=E);for(var A=1;A<x.length;)A<<=1;x.length=A;for(var C={loop:C,palette:new Uint32Array(x)},L=new i.default.GifWriter(s,e.width,e.height,C),R={},P=0;P<r.numFrames;P++)!function(t){for(var n=!v.has(t),i=n?[]:x,s=new Uint8Array(e.width*e.height),o={},l=new Set,c=0;c<a[t].length;c++){var u=a[t][c];n?(void 0===o[u]&&(o[u]=i.length,i.push(u)),s[c]=o[u]):s[c]=T[u],0<t&&a[t-1][c]!==u&&l.add(u)}var h={},d=i.filter((function(e){return!l.has(e)}));if(0<d.length){d=d[0];var p=(n?o:T)[d];if(0<t){for(var f=0;f<a[t].length;f++)a[t-1][f]===a[t][f]&&(s[f]=p);h.transparent=p,R.frameOpts.disposal=1}}if(h.delay=r.frames[t].delay/10,n){for(var m=1;m<i.length;)m<<=1;i.length=m,h.palette=new Uint32Array(i)}0<t&&L.addFrame(0,0,e.width,e.height,R.pixelPaletteIndex,R.frameOpts),R={pixelPaletteIndex:s,frameOpts:h}}(P);R.frameOpts.disposal=1,L.addFrame(0,0,e.width,e.height,R.pixelPaletteIndex,R.frameOpts),C=new Blob([s.slice(0,L.end())],{type:"image/gif"}),n.default.prototype.downloadFile(C,t,"gif")},n.default.prototype.saveFrames=function(e,t,r,i,s){n.default._validateParameters("saveFrames",arguments),r=n.default.prototype.constrain(r=r||3,0,15),r*=1e3;i=n.default.prototype.constrain(i||15,0,22);var o=0,a=n.default.prototype._makeFrame,l=this._curElement.elt,c=[],u=setInterval((function(){c.push(a(e+o,t,l)),o++}),1e3/i);setTimeout((function(){if(clearInterval(u),s)s(c);else{var e=!0,t=!1,r=void 0;try{for(var i,o=c[Symbol.iterator]();!(e=(i=o.next()).done);e=!0){var a=i.value;n.default.prototype.downloadFile(a.imageData,a.filename,a.ext)}}catch(e){t=!0,r=e}finally{try{e||null==o.return||o.return()}finally{if(t)throw r}}}c=[]}),.01+r)},n.default.prototype._makeFrame=function(e,t,r){var n;r=this?this._curElement.elt:r;if(t)switch(t.toLowerCase()){case"png":default:n="image/png";break;case"jpeg":case"jpg":n="image/jpeg"}else t="png",n="image/png";r=(r=r.toDataURL(n)).replace(n,"image/octet-stream");var i={};return i.imageData=r,i.filename=e,i.ext=t,i},e=n.default,r.default=e},{"../core/main":267,"core-js/modules/es.array.concat":149,"core-js/modules/es.array.filter":153,"core-js/modules/es.array.from":155,"core-js/modules/es.array.iterator":158,"core-js/modules/es.array.map":161,"core-js/modules/es.array.slice":162,"core-js/modules/es.object.keys":176,"core-js/modules/es.object.to-string":177,"core-js/modules/es.regexp.exec":181,"core-js/modules/es.regexp.to-string":182,"core-js/modules/es.set":183,"core-js/modules/es.string.iterator":186,"core-js/modules/es.string.replace":189,"core-js/modules/es.string.split":191,"core-js/modules/es.symbol":196,"core-js/modules/es.symbol.description":194,"core-js/modules/es.symbol.iterator":195,"core-js/modules/es.typed-array.copy-within":197,"core-js/modules/es.typed-array.every":198,"core-js/modules/es.typed-array.fill":199,"core-js/modules/es.typed-array.filter":200,"core-js/modules/es.typed-array.find":202,"core-js/modules/es.typed-array.find-index":201,"core-js/modules/es.typed-array.for-each":205,"core-js/modules/es.typed-array.includes":206,"core-js/modules/es.typed-array.index-of":207,"core-js/modules/es.typed-array.iterator":210,"core-js/modules/es.typed-array.join":211,"core-js/modules/es.typed-array.last-index-of":212,"core-js/modules/es.typed-array.map":213,"core-js/modules/es.typed-array.reduce":215,"core-js/modules/es.typed-array.reduce-right":214,"core-js/modules/es.typed-array.reverse":216,"core-js/modules/es.typed-array.set":217,"core-js/modules/es.typed-array.slice":218,"core-js/modules/es.typed-array.some":219,"core-js/modules/es.typed-array.sort":220,"core-js/modules/es.typed-array.subarray":221,"core-js/modules/es.typed-array.to-locale-string":222,"core-js/modules/es.typed-array.to-string":223,"core-js/modules/es.typed-array.uint32-array":225,"core-js/modules/es.typed-array.uint8-array":226,"core-js/modules/web.dom-collections.iterator":230,omggif:240}],290:[function(e,t,r){"use strict";function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function i(e){return(i="function"==typeof Symbol&&"symbol"===n(Symbol.iterator)?function(e){return n(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":n(e)})(e)}e("core-js/modules/es.symbol"),e("core-js/modules/es.symbol.description"),e("core-js/modules/es.symbol.iterator"),e("core-js/modules/es.array.copy-within"),e("core-js/modules/es.array.includes"),e("core-js/modules/es.array.index-of"),e("core-js/modules/es.array.iterator"),e("core-js/modules/es.array.slice"),e("core-js/modules/es.object.get-own-property-descriptor"),e("core-js/modules/es.object.to-string"),e("core-js/modules/es.promise"),e("core-js/modules/es.regexp.to-string"),e("core-js/modules/es.string.includes"),e("core-js/modules/es.string.iterator"),e("core-js/modules/es.typed-array.uint8-array"),e("core-js/modules/es.typed-array.uint8-clamped-array"),e("core-js/modules/es.typed-array.copy-within"),e("core-js/modules/es.typed-array.every"),e("core-js/modules/es.typed-array.fill"),e("core-js/modules/es.typed-array.filter"),e("core-js/modules/es.typed-array.find"),e("core-js/modules/es.typed-array.find-index"),e("core-js/modules/es.typed-array.for-each"),e("core-js/modules/es.typed-array.includes"),e("core-js/modules/es.typed-array.index-of"),e("core-js/modules/es.typed-array.iterator"),e("core-js/modules/es.typed-array.join"),e("core-js/modules/es.typed-array.last-index-of"),e("core-js/modules/es.typed-array.map"),e("core-js/modules/es.typed-array.reduce"),e("core-js/modules/es.typed-array.reduce-right"),e("core-js/modules/es.typed-array.reverse"),e("core-js/modules/es.typed-array.set"),e("core-js/modules/es.typed-array.slice"),e("core-js/modules/es.typed-array.some"),e("core-js/modules/es.typed-array.sort"),e("core-js/modules/es.typed-array.subarray"),e("core-js/modules/es.typed-array.to-locale-string"),e("core-js/modules/es.typed-array.to-string"),e("core-js/modules/es.weak-map"),e("core-js/modules/web.dom-collections.iterator"),e("core-js/modules/es.array.copy-within"),e("core-js/modules/es.array.includes"),e("core-js/modules/es.array.index-of"),e("core-js/modules/es.array.iterator"),e("core-js/modules/es.array.slice"),e("core-js/modules/es.object.to-string"),e("core-js/modules/es.promise"),e("core-js/modules/es.regexp.to-string"),e("core-js/modules/es.string.includes"),e("core-js/modules/es.typed-array.uint8-array"),e("core-js/modules/es.typed-array.uint8-clamped-array"),e("core-js/modules/es.typed-array.copy-within"),e("core-js/modules/es.typed-array.every"),e("core-js/modules/es.typed-array.fill"),e("core-js/modules/es.typed-array.filter"),e("core-js/modules/es.typed-array.find"),e("core-js/modules/es.typed-array.find-index"),e("core-js/modules/es.typed-array.for-each"),e("core-js/modules/es.typed-array.includes"),e("core-js/modules/es.typed-array.index-of"),e("core-js/modules/es.typed-array.iterator"),e("core-js/modules/es.typed-array.join"),e("core-js/modules/es.typed-array.last-index-of"),e("core-js/modules/es.typed-array.map"),e("core-js/modules/es.typed-array.reduce"),e("core-js/modules/es.typed-array.reduce-right"),e("core-js/modules/es.typed-array.reverse"),e("core-js/modules/es.typed-array.set"),e("core-js/modules/es.typed-array.slice"),e("core-js/modules/es.typed-array.some"),e("core-js/modules/es.typed-array.sort"),e("core-js/modules/es.typed-array.subarray"),e("core-js/modules/es.typed-array.to-locale-string"),e("core-js/modules/es.typed-array.to-string"),Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0,e("regenerator-runtime/runtime");var s=h(e("../core/main")),o=h(e("../core/helpers")),a=function(e){if(e&&e.__esModule)return e;if(null===e||"object"!==i(e)&&"function"!=typeof e)return{default:e};var t=u();if(t&&t.has(e))return t.get(e);var r,n={},s=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(r in e){var o;Object.prototype.hasOwnProperty.call(e,r)&&((o=s?Object.getOwnPropertyDescriptor(e,r):null)&&(o.get||o.set)?Object.defineProperty(n,r,o):n[r]=e[r])}return n.default=e,t&&t.set(e,n),n}(e("../core/constants")),l=h(e("omggif")),c=e("gifenc");function u(){var e;return"function"!=typeof WeakMap?null:(e=new WeakMap,u=function(){return e},e)}function h(e){return e&&e.__esModule?e:{default:e}}function d(e,t,r,n,i,s,o){try{var a=e[s](o),l=a.value}catch(e){return void r(e)}a.done?t(l):Promise.resolve(l).then(n,i)}function p(e,t){return 0<e&&e<t?e:t}e("../core/friendly_errors/validate_params"),e("../core/friendly_errors/file_errors"),e("../core/friendly_errors/fes_core"),s.default.prototype.loadImage=function(e,t,r){s.default._validateParameters("loadImage",arguments);var n=new s.default.Image(1,1,this),i=this,o=new Request(e,{method:"GET",mode:"cors"});return fetch(e,o).then((function(o){var a,c=o.headers.get("content-type");c&&c.includes("image/gif")?o.arrayBuffer().then((function(e){if(e){e=new Uint8Array(e);var o=n,a=t,c=r,u=function(e){i._decrementPreload()}.bind(i),h=new l.default.GifReader(e),d=(o.width=o.canvas.width=h.width,o.height=o.canvas.height=h.height,[]),p=h.numFrames(),f=new Uint8ClampedArray(o.width*o.height*4);if(1<p){for(var m=0;m<p;m++){var g=h.frameInfo(m),y=o.drawingContext.getImageData(0,0,o.width,o.height),v=(f=y.data.slice(),function(e,t){try{t.decodeAndBlitFrameRGBA(e,f)}catch(e){s.default._friendlyFileLoadError(8,o.src),"function"==typeof c&&c(e)}}(m,h),new ImageData(f,o.width,o.height));0===(v=(o.drawingContext.putImageData(v,0,0),g.delay))&&(v=10),d.push({image:o.drawingContext.getImageData(0,0,o.width,o.height),delay:10*v}),2===g.disposal?o.drawingContext.clearRect(g.x,g.y,g.width,g.height):3===g.disposal&&o.drawingContext.putImageData(y,0,0,g.x,g.y,g.width,g.height)}null===(e=h.loopCount())?e=1:0===e&&(e=null),o.drawingContext.putImageData(d[0].image,0,0),o.gifProperties={displayIndex:0,loopLimit:e,loopCount:0,frames:d,numFrames:p,playing:!0,timeDisplayed:0,lastChangeTime:0}}"function"==typeof a&&a(o),u()}}),(function(e){"function"==typeof r&&(r(e),i._decrementPreload())})):((a=new Image).onload=function(){n.width=n.canvas.width=a.width,n.height=n.canvas.height=a.height,n.drawingContext.drawImage(a,0,0),n.modified=!0,"function"==typeof t&&t(n),i._decrementPreload()},a.onerror=function(e){s.default._friendlyFileLoadError(0,a.src),"function"==typeof r&&(r(e),i._decrementPreload())},0!==e.indexOf("data:image/")&&(a.crossOrigin="Anonymous"),a.src=e),n.modified=!0})).catch((function(t){s.default._friendlyFileLoadError(0,e),"function"==typeof r&&(r(t),i._decrementPreload())})),n},s.default.prototype.saveGif=function(){e=regeneratorRuntime.mark((function e(t,r){var n,i,o,a,l,u,h,d,p,f,m,g,y,v,_,x,b,w,S,M,T,E,A,C=arguments;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=2<C.length&&void 0!==C[2]?C[2]:{delay:0,units:"seconds"},"string"!=typeof t)throw TypeError("fileName parameter must be a string");e.next=3;break;case 3:if("number"!=typeof r)throw TypeError("Duration parameter must be a number");e.next=5;break;case 5:if(i=n&&n.delay||0,o=n&&n.units||"seconds","number"!=typeof i)throw TypeError("Delay parameter must be a number");e.next=9;break;case 9:if("seconds"!==o&&"frames"!==o)throw TypeError('Units parameter must be either "frames" or "seconds"');e.next=11;break;case 11:this._recording=!0,h=this._targetFrameRate,a=(a=1/(h=h!==1/0&&void 0!==h&&0!==h?h:60)*1e3)<20?20:a,u=(l="seconds"===o?r*h:r)+(h="seconds"===o?i*h:i),this.frameCount=h,d=this._pixelDensity,this.pixelDensity(1),p=[],f="p5.gif.progressBar",null!==document.getElementById(f)&&document.getElementById(f).remove(),(f=this.createP("")).id("progressBar"),f.style("font-size","16px"),f.style("font-family","Montserrat"),f.style("background-color","#ffffffa0"),f.style("padding","8px"),f.style("border-radius","10px"),f.position(0,0),this.drawingContext instanceof WebGLRenderingContext&&(g=document.getElementById("defaultCanvas0").getContext("webgl"),m=new Uint8Array(g.drawingBufferWidth*g.drawingBufferHeight*4)),this.noLoop();case 36:if(h<u)return this.redraw(),T=void 0,T=this.drawingContext instanceof WebGLRenderingContext?(m=new Uint8Array(g.drawingBufferWidth*g.drawingBufferHeight*4),g.readPixels(0,0,g.drawingBufferWidth,g.drawingBufferHeight,g.RGBA,g.UNSIGNED_BYTE,m),function(e){for(var t=parseInt(height/2),r=4*width,n=new Uint8Array(4*width),i=0;i<t;++i){var s=i*r,o=(height-i-1)*r;n.set(e.subarray(s,s+r)),e.copyWithin(s,o,o+r),e.set(n,o)}return e}(m)):this.drawingContext.getImageData(0,0,this.width,this.height).data,p.push(T),h++,f.html("Saved frame <b>"+p.length.toString()+"</b> out of "+l.toString()),e.next=45,new Promise((function(e){return setTimeout(e,0)}));e.next=47;break;case 45:e.next=36;break;case 47:f.html("Frames processed, generating color palette..."),this.loop(),this.pixelDensity(d),y=(0,c.GIFEncoder)(),v=function(e){for(var t=new Uint8Array(e.length*e[0].length),r=0;r<e.length;r++)t.set(e[r],r*e[0].length);var n=(0,c.quantize)(t,256,{format:"rgba4444",oneBitAlpha:!0});return 256===n.length?n[n.length-1]=[255*Math.random(),255*Math.random(),255*Math.random(),0]:n.push([255*Math.random(),255*Math.random(),255*Math.random(),0]),n}(p),_={},x=function(e){for(var t=e.length/4,r=new Uint8Array(t),n=0;n<t;n++){var i=e[4*n]<<24|e[4*n+1]<<16|e[4*n+2]<<8|e[4*n+3];void 0===_[i]&&(_[i]=(0,c.nearestColorIndex)(v,e.slice(4*n,4*(n+1)))),r[n]=_[i]}return r},b=v.length-1,w=[],S=0;case 57:if(!(S<p.length)){e.next=68;break}if(M=x(p[S]),T=M.slice(),0===S)y.writeFrame(M,this.width,this.height,{palette:v,delay:a,dispose:1});else{for(E=0;E<M.length;E++)M[E]===w[E]&&(M[E]=b);y.writeFrame(M,this.width,this.height,{delay:a,transparent:!0,transparentIndex:b,dispose:1})}return w=T,f.html("Rendered frame <b>"+S.toString()+"</b> out of "+l.toString()),e.next=65,new Promise((function(e){return setTimeout(e,0)}));case 65:S++,e.next=57;break;case 68:y.finish(),A=y.bytesView(),A=new Blob([A],{type:"image/gif"}),p=[],this._recording=!1,this.loop(),f.html("Done. Downloading your gif!🌸"),s.default.prototype.downloadFile(A,t,"gif");case 77:case"end":return e.stop()}}),e,this)}));var e,t=function(){var t=this,r=arguments;return new Promise((function(n,i){var s=e.apply(t,r);function o(e){d(s,n,i,o,a,"next",e)}function a(e){d(s,n,i,o,a,"throw",e)}o(void 0)}))};return function(e,r){return t.apply(this,arguments)}}(),s.default.prototype.image=function(e,t,r,n,i,l,c,u,h,d,f,m){s.default._validateParameters("image",arguments);var g=e.width,y=e.height,v=(m=m||a.CENTER,f=f||a.CENTER,e.elt&&e.elt.videoWidth&&!e.canvas&&(g=e.elt.videoWidth,y=e.elt.videoHeight),n||g);i=i||y,l=l||0,c=c||0,u=p(u||g,g),g=p(h||y,y),h=1;e.elt&&!e.canvas&&e.elt.style.width&&(h=e.elt.videoWidth&&!n?e.elt.videoWidth:e.elt.width,h/=parseInt(e.elt.style.width,10)),l*=h,c*=h,g*=h,u*=h,y=function(e,t,r,n,i,s,o,l,c,u,h){var d,p,f,m,g,y,v,_,x;return e===a.COVER&&(d=t,f=r,v=s,_=o,y=l,x=c,p=u,m=h,v/=g=Math.max(v/p,_/m),_/=g,g=y,y=x,d===a.CENTER?g+=(p-v)/2:d===a.RIGHT&&(g+=p-v),f===a.CENTER?y+=(m-_)/2:f===a.BOTTOM&&(y+=m-_),l=(x={x:g,y,w:v,h:_}).x,c=x.y,u=x.w,h=x.h),e===a.CONTAIN&&(d=t,p=r,f=n,m=i,g=s,y=o,v=u,_=h,v/=x=Math.max(v/g,_/y),_/=x,x=f,f=m,d===a.CENTER?x+=(g-v)/2:d===a.RIGHT&&(x+=g-v),p===a.CENTER?f+=(y-_)/2:p===a.BOTTOM&&(f+=y-_),n=(e={x,y:f,w:v,h:_}).x,i=e.y,s=e.w,o=e.h),{sx:l,sy:c,sw:u,sh:h,dx:n,dy:i,dw:s,dh:o}}(d,f,m,(y=o.default.modeAdjust(t,r,v,i,this._renderer._imageMode)).x,y.y,y.w,y.h,l,c,u,g),this._renderer.image(e,y.sx,y.sy,y.sw,y.sh,y.dx,y.dy,y.dw,y.dh)},s.default.prototype.tint=function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];s.default._validateParameters("tint",t);var n=this.color.apply(this,t);this._renderer._tint=n.levels},s.default.prototype.noTint=function(){this._renderer._tint=null},s.default.prototype._getTintedImageCanvas=s.default.Renderer2D.prototype._getTintedImageCanvas,s.default.prototype.imageMode=function(e){s.default._validateParameters("imageMode",arguments),e!==a.CORNER&&e!==a.CORNERS&&e!==a.CENTER||(this._renderer._imageMode=e)},e=s.default,r.default=e},{"../core/constants":256,"../core/friendly_errors/fes_core":258,"../core/friendly_errors/file_errors":259,"../core/friendly_errors/validate_params":262,"../core/helpers":263,"../core/main":267,"core-js/modules/es.array.copy-within":150,"core-js/modules/es.array.includes":156,"core-js/modules/es.array.index-of":157,"core-js/modules/es.array.iterator":158,"core-js/modules/es.array.slice":162,"core-js/modules/es.object.get-own-property-descriptor":173,"core-js/modules/es.object.to-string":177,"core-js/modules/es.promise":178,"core-js/modules/es.regexp.to-string":182,"core-js/modules/es.string.includes":185,"core-js/modules/es.string.iterator":186,"core-js/modules/es.symbol":196,"core-js/modules/es.symbol.description":194,"core-js/modules/es.symbol.iterator":195,"core-js/modules/es.typed-array.copy-within":197,"core-js/modules/es.typed-array.every":198,"core-js/modules/es.typed-array.fill":199,"core-js/modules/es.typed-array.filter":200,"core-js/modules/es.typed-array.find":202,"core-js/modules/es.typed-array.find-index":201,"core-js/modules/es.typed-array.for-each":205,"core-js/modules/es.typed-array.includes":206,"core-js/modules/es.typed-array.index-of":207,"core-js/modules/es.typed-array.iterator":210,"core-js/modules/es.typed-array.join":211,"core-js/modules/es.typed-array.last-index-of":212,"core-js/modules/es.typed-array.map":213,"core-js/modules/es.typed-array.reduce":215,"core-js/modules/es.typed-array.reduce-right":214,"core-js/modules/es.typed-array.reverse":216,"core-js/modules/es.typed-array.set":217,"core-js/modules/es.typed-array.slice":218,"core-js/modules/es.typed-array.some":219,"core-js/modules/es.typed-array.sort":220,"core-js/modules/es.typed-array.subarray":221,"core-js/modules/es.typed-array.to-locale-string":222,"core-js/modules/es.typed-array.to-string":223,"core-js/modules/es.typed-array.uint8-array":226,"core-js/modules/es.typed-array.uint8-clamped-array":227,"core-js/modules/es.weak-map":228,"core-js/modules/web.dom-collections.iterator":230,gifenc:237,omggif:240,"regenerator-runtime/runtime":244}],291:[function(e,t,r){"use strict";e("core-js/modules/es.symbol"),e("core-js/modules/es.symbol.description"),e("core-js/modules/es.symbol.iterator"),e("core-js/modules/es.array.filter"),e("core-js/modules/es.array.iterator"),e("core-js/modules/es.object.to-string"),e("core-js/modules/es.string.iterator"),e("core-js/modules/web.dom-collections.iterator"),e("core-js/modules/es.symbol"),e("core-js/modules/es.symbol.description"),e("core-js/modules/es.symbol.iterator"),e("core-js/modules/es.array.filter"),e("core-js/modules/es.array.iterator"),e("core-js/modules/es.object.to-string"),e("core-js/modules/es.string.iterator"),e("core-js/modules/web.dom-collections.iterator"),Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n=s(e("../core/main")),i=s(e("./filters"));function s(e){return e&&e.__esModule?e:{default:e}}n.default.Image=function(e,t){this.width=e,this.height=t,this.canvas=document.createElement("canvas"),this.canvas.width=this.width,this.canvas.height=this.height,this.drawingContext=this.canvas.getContext("2d"),(this._pixelsState=this)._pixelDensity=1,this.gifProperties=null,this._modified=!1,this.pixels=[]},n.default.Image.prototype._animateGif=function(e){var t,r=this.gifProperties;e=e._lastFrameTime;0===r.lastChangeTime&&(r.lastChangeTime=e),r.playing&&(r.timeDisplayed=e-r.lastChangeTime,t=r.frames[r.displayIndex].delay,r.timeDisplayed>=t&&(t=Math.floor(r.timeDisplayed/t),r.timeDisplayed=0,r.lastChangeTime=e,r.displayIndex+=t,r.loopCount=Math.floor(r.displayIndex/r.numFrames),null!==r.loopLimit&&r.loopCount>=r.loopLimit?r.playing=!1:(e=r.displayIndex%r.numFrames,this.drawingContext.putImageData(r.frames[e].image,0,0),r.displayIndex=e,this.setModified(!0))))},n.default.Image.prototype._setProperty=function(e,t){this[e]=t,this.setModified(!0)},n.default.Image.prototype.loadPixels=function(){n.default.Renderer2D.prototype.loadPixels.call(this),this.setModified(!0)},n.default.Image.prototype.updatePixels=function(e,t,r,i){n.default.Renderer2D.prototype.updatePixels.call(this,e,t,r,i),this.setModified(!0)},n.default.Image.prototype.get=function(e,t,r,i){return n.default._validateParameters("p5.Image.get",arguments),n.default.Renderer2D.prototype.get.apply(this,arguments)},n.default.Image.prototype._getPixel=n.default.Renderer2D.prototype._getPixel,n.default.Image.prototype.set=function(e,t,r){n.default.Renderer2D.prototype.set.call(this,e,t,r),this.setModified(!0)},n.default.Image.prototype.resize=function(e,t){0===e&&0===t?(e=this.canvas.width,t=this.canvas.height):0===e?e=this.canvas.width*t/this.canvas.height:0===t&&(t=this.canvas.height*e/this.canvas.width),e=Math.floor(e),t=Math.floor(t);var r=document.createElement("canvas");if(r.width=e,r.height=t,this.gifProperties)for(var n=this.gifProperties,i=0;i<n.numFrames;i++){for(var s=this.drawingContext.createImageData(e,t),o=(h=h=u=c=l=void 0,n.frames[i].image),a=s,l=0,c=0;c<a.height;c++)for(var u=0;u<a.width;u++){var h=Math.floor(u*o.width/a.width);h=4*(Math.floor(c*o.height/a.height)*o.width+h);a.data[l++]=o.data[h++],a.data[l++]=o.data[h++],a.data[l++]=o.data[h++],a.data[l++]=o.data[+h]}n.frames[i].image=s}r.getContext("2d").drawImage(this.canvas,0,0,this.canvas.width,this.canvas.height,0,0,r.width,r.height),this.canvas.width=this.width=e,this.canvas.height=this.height=t,this.drawingContext.drawImage(r,0,0,e,t,0,0,e,t),0<this.pixels.length&&this.loadPixels(),this.setModified(!0)},n.default.Image.prototype.copy=function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];n.default.prototype.copy.apply(this,t)},n.default.Image.prototype.mask=function(e){var t=this.drawingContext.globalCompositeOperation,r=1,i=[e=void 0===e?this:e,0,0,(r=e instanceof n.default.Renderer?e._pInst._pixelDensity:r)*e.width,r*e.height,0,0,this.width,this.height];if(this.drawingContext.globalCompositeOperation="destination-in",this.gifProperties){for(var s=0;s<this.gifProperties.frames.length;s++)this.drawingContext.putImageData(this.gifProperties.frames[s].image,0,0),n.default.Image.prototype.copy.apply(this,i),this.gifProperties.frames[s].image=this.drawingContext.getImageData(0,0,this.width,this.height);this.drawingContext.putImageData(this.gifProperties.frames[this.gifProperties.displayIndex].image,0,0)}else n.default.Image.prototype.copy.apply(this,i);this.drawingContext.globalCompositeOperation=t,this.setModified(!0)},n.default.Image.prototype.filter=function(e,t){i.default.apply(this.canvas,i.default[e],t),this.setModified(!0)},n.default.Image.prototype.blend=function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];n.default._validateParameters("p5.Image.blend",arguments),n.default.prototype.blend.apply(this,t),this.setModified(!0)},n.default.Image.prototype.setModified=function(e){this._modified=e},n.default.Image.prototype.isModified=function(){return this._modified},n.default.Image.prototype.save=function(e,t){this.gifProperties?n.default.prototype.encodeAndDownloadGif(this,e):n.default.prototype.saveCanvas(this.canvas,e,t)},n.default.Image.prototype.reset=function(){var e;this.gifProperties&&((e=this.gifProperties).playing=!0,e.timeSinceStart=0,e.timeDisplayed=0,e.lastChangeTime=0,e.loopCount=0,e.displayIndex=0,this.drawingContext.putImageData(e.frames[0].image,0,0))},n.default.Image.prototype.getCurrentFrame=function(){var e;if(this.gifProperties)return(e=this.gifProperties).displayIndex%e.numFrames},n.default.Image.prototype.setFrame=function(e){var t;this.gifProperties&&e<(t=this.gifProperties).numFrames&&0<=e&&(t.timeDisplayed=0,t.lastChangeTime=0,t.displayIndex=e,this.drawingContext.putImageData(t.frames[e].image,0,0))},n.default.Image.prototype.numFrames=function(){if(this.gifProperties)return this.gifProperties.numFrames},n.default.Image.prototype.play=function(){this.gifProperties&&(this.gifProperties.playing=!0)},n.default.Image.prototype.pause=function(){this.gifProperties&&(this.gifProperties.playing=!1)},n.default.Image.prototype.delay=function(e,t){if(this.gifProperties){var r=this.gifProperties;if(t<r.numFrames&&0<=t)r.frames[t].delay=e;else{var n=!0,i=(t=!1,void 0);try{for(var s,o=r.frames[Symbol.iterator]();!(n=(s=o.next()).done);n=!0)s.value.delay=e}catch(e){t=!0,i=e}finally{try{n||null==o.return||o.return()}finally{if(t)throw i}}}}},e=n.default.Image,r.default=e},{"../core/main":267,"./filters":288,"core-js/modules/es.array.filter":153,"core-js/modules/es.array.iterator":158,"core-js/modules/es.object.to-string":177,"core-js/modules/es.string.iterator":186,"core-js/modules/es.symbol":196,"core-js/modules/es.symbol.description":194,"core-js/modules/es.symbol.iterator":195,"core-js/modules/web.dom-collections.iterator":230}],292:[function(e,t,r){"use strict";e("core-js/modules/es.array.filter"),e("core-js/modules/es.array.filter"),Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n=s(e("../core/main")),i=s(e("./filters"));function s(e){return e&&e.__esModule?e:{default:e}}e("../color/p5.Color"),n.default.prototype.pixels=[],n.default.prototype.blend=function(){for(var e,t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];n.default._validateParameters("blend",r),this._renderer?(e=this._renderer).blend.apply(e,r):n.default.Renderer2D.prototype.blend.apply(this,r)},n.default.prototype.copy=function(){for(var e,t,r,i,s,o,a,l,c,u=arguments.length,h=new Array(u),d=0;d<u;d++)h[d]=arguments[d];if(n.default._validateParameters("copy",h),9===h.length)e=h[0],t=h[1],r=h[2],i=h[3],s=h[4],o=h[5],a=h[6],l=h[7],c=h[8];else{if(8!==h.length)throw new Error("Signature not supported");e=this,t=h[0],r=h[1],i=h[2],s=h[3],o=h[4],a=h[5],l=h[6],c=h[7]}n.default.prototype._copyHelper(this,e,t,r,i,s,o,a,l,c)},n.default.prototype._copyHelper=function(e,t,r,i,s,o,a,l,c,u){t.loadPixels();var h=t.canvas.width/t.width,d=0,p=0;t._renderer&&t._renderer.isP3D&&(d=t.width/2,p=t.height/2),e._renderer&&e._renderer.isP3D?n.default.RendererGL.prototype.image.call(e._renderer,t,r+d,i+p,s,o,a,l,c,u):e.drawingContext.drawImage(t.canvas,h*(r+d),h*(i+p),h*s,h*o,a,l,c,u)},n.default.prototype.filter=function(e,t){n.default._validateParameters("filter",arguments),void 0!==this.canvas?i.default.apply(this.canvas,i.default[e],t):i.default.apply(this.elt,i.default[e],t)},n.default.prototype.get=function(e,t,r,i){var s;return n.default._validateParameters("get",arguments),(s=this._renderer).get.apply(s,arguments)},n.default.prototype.loadPixels=function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];n.default._validateParameters("loadPixels",t),this._renderer.loadPixels()},n.default.prototype.set=function(e,t,r){this._renderer.set(e,t,r)},n.default.prototype.updatePixels=function(e,t,r,i){n.default._validateParameters("updatePixels",arguments),0!==this.pixels.length&&this._renderer.updatePixels(e,t,r,i)},e=n.default,r.default=e},{"../color/p5.Color":254,"../core/main":267,"./filters":288,"core-js/modules/es.array.filter":153}],293:[function(e,t,r){"use strict";function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}e("core-js/modules/es.symbol"),e("core-js/modules/es.symbol.description"),e("core-js/modules/es.symbol.iterator"),e("core-js/modules/es.array.concat"),e("core-js/modules/es.array.includes"),e("core-js/modules/es.array.index-of"),e("core-js/modules/es.array.iterator"),e("core-js/modules/es.array.last-index-of"),e("core-js/modules/es.array.slice"),e("core-js/modules/es.array.splice"),e("core-js/modules/es.function.name"),e("core-js/modules/es.object.to-string"),e("core-js/modules/es.promise"),e("core-js/modules/es.regexp.exec"),e("core-js/modules/es.regexp.to-string"),e("core-js/modules/es.string.includes"),e("core-js/modules/es.string.iterator"),e("core-js/modules/es.string.replace"),e("core-js/modules/es.string.split"),e("core-js/modules/es.typed-array.uint8-array"),e("core-js/modules/es.typed-array.copy-within"),e("core-js/modules/es.typed-array.every"),e("core-js/modules/es.typed-array.fill"),e("core-js/modules/es.typed-array.filter"),e("core-js/modules/es.typed-array.find"),e("core-js/modules/es.typed-array.find-index"),e("core-js/modules/es.typed-array.for-each"),e("core-js/modules/es.typed-array.includes"),e("core-js/modules/es.typed-array.index-of"),e("core-js/modules/es.typed-array.iterator"),e("core-js/modules/es.typed-array.join"),e("core-js/modules/es.typed-array.last-index-of"),e("core-js/modules/es.typed-array.map"),e("core-js/modules/es.typed-array.reduce"),e("core-js/modules/es.typed-array.reduce-right"),e("core-js/modules/es.typed-array.reverse"),e("core-js/modules/es.typed-array.set"),e("core-js/modules/es.typed-array.slice"),e("core-js/modules/es.typed-array.some"),e("core-js/modules/es.typed-array.sort"),e("core-js/modules/es.typed-array.subarray"),e("core-js/modules/es.typed-array.to-locale-string"),e("core-js/modules/es.typed-array.to-string"),e("core-js/modules/web.dom-collections.iterator"),e("core-js/modules/web.url"),e("core-js/modules/es.symbol"),e("core-js/modules/es.symbol.description"),e("core-js/modules/es.symbol.iterator"),e("core-js/modules/es.array.concat"),e("core-js/modules/es.array.includes"),e("core-js/modules/es.array.index-of"),e("core-js/modules/es.array.iterator"),e("core-js/modules/es.array.last-index-of"),e("core-js/modules/es.array.slice"),e("core-js/modules/es.array.splice"),e("core-js/modules/es.function.name"),e("core-js/modules/es.object.to-string"),e("core-js/modules/es.promise"),e("core-js/modules/es.regexp.exec"),e("core-js/modules/es.regexp.to-string"),e("core-js/modules/es.string.includes"),e("core-js/modules/es.string.iterator"),e("core-js/modules/es.string.replace"),e("core-js/modules/es.string.split"),e("core-js/modules/es.typed-array.uint8-array"),e("core-js/modules/es.typed-array.copy-within"),e("core-js/modules/es.typed-array.every"),e("core-js/modules/es.typed-array.fill"),e("core-js/modules/es.typed-array.filter"),e("core-js/modules/es.typed-array.find"),e("core-js/modules/es.typed-array.find-index"),e("core-js/modules/es.typed-array.for-each"),e("core-js/modules/es.typed-array.includes"),e("core-js/modules/es.typed-array.index-of"),e("core-js/modules/es.typed-array.iterator"),e("core-js/modules/es.typed-array.join"),e("core-js/modules/es.typed-array.last-index-of"),e("core-js/modules/es.typed-array.map"),e("core-js/modules/es.typed-array.reduce"),e("core-js/modules/es.typed-array.reduce-right"),e("core-js/modules/es.typed-array.reverse"),e("core-js/modules/es.typed-array.set"),e("core-js/modules/es.typed-array.slice"),e("core-js/modules/es.typed-array.some"),e("core-js/modules/es.typed-array.sort"),e("core-js/modules/es.typed-array.subarray"),e("core-js/modules/es.typed-array.to-locale-string"),e("core-js/modules/es.typed-array.to-string"),e("core-js/modules/web.dom-collections.iterator"),e("core-js/modules/web.url"),Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var i=a(e("../core/main")),s=(e("whatwg-fetch"),e("es6-promise/auto"),a(e("fetch-jsonp"))),o=a(e("file-saver"));function a(e){return e&&e.__esModule?e:{default:e}}function l(e){return(l="function"==typeof Symbol&&"symbol"===n(Symbol.iterator)?function(e){return n(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":n(e)})(e)}function c(e){return e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;")}function u(e,t){t&&!0!==t&&"true"!==t||(t="");var r="";return(e=e||"untitled")&&e.includes(".")&&(r=e.split(".").pop()),t&&r!==t&&(r=t,e="".concat(e,".").concat(r)),[e,r]}e("../core/friendly_errors/validate_params"),e("../core/friendly_errors/file_errors"),e("../core/friendly_errors/fes_core"),i.default.prototype.loadJSON=function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];i.default._validateParameters("loadJSON",t);for(var n,s,o,a=t[0],c={},u="json",h=1;h<t.length;h++){var d=t[h];"string"==typeof d?"jsonp"!==d&&"json"!==d||(u=d):"function"==typeof d?n?s=d:n=d:"object"===l(d)&&(d.hasOwnProperty("jsonpCallback")||d.hasOwnProperty("jsonpCallbackFunction"))&&(u="jsonp",o=d)}var p=this;return this.httpDo(a,"GET",o,u,(function(e){for(var t in e)c[t]=e[t];void 0!==n&&n(e),p._decrementPreload()}),(function(e){if(i.default._friendlyFileLoadError(5,a),!s)throw e;s(e)})),c},i.default.prototype.loadStrings=function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];i.default._validateParameters("loadStrings",t);for(var n,s,o=[],a=1;a<t.length;a++){var l=t[a];"function"==typeof l&&(void 0===n?n=l:void 0===s&&(s=l))}var c=this;return i.default.prototype.httpDo.call(this,t[0],"GET","text",(function(e){for(var t=e.replace(/\r\n/g,"\r").replace(/\n/g,"\r").split(/\r/),r=0,i=t.length;r<i;r+=32768)Array.prototype.push.apply(o,t.slice(r,Math.min(r+32768,i)));void 0!==n&&n(o),c._decrementPreload()}),(function(e){if(i.default._friendlyFileLoadError(3,e),!s)throw e;s(e)})),o},i.default.prototype.loadTable=function(e){var t,r,n,s=[],o=!1,a=e.substring(e.lastIndexOf(".")+1,e.length);"csv"===a?n=",":"ssv"===a?n=";":"tsv"===a&&(n="\t");for(var l=1;l<arguments.length;l++)"function"==typeof arguments[l]?void 0===t?t=arguments[l]:void 0===r&&(r=arguments[l]):"string"==typeof arguments[l]&&(s.push(arguments[l]),"header"===arguments[l]&&(o=!0),"csv"===arguments[l]?n=",":"ssv"===arguments[l]?n=";":"tsv"===arguments[l]&&(n="\t"));var c=new i.default.Table,u=this;return this.httpDo(e,"GET","table",(function(e){for(var r,s,a={},l=[],h=0,d=null,p=function(){a.currentState=0,a.token=""},f=function(){d.push(a.token),p()},m=function(){a.currentState=4,l.push(d),d=null};;){if(null==(r=e[h++])){if(a.escaped)throw new Error("Unclosed quote in file.");if(d){f(),m();break}}if(null===d&&(a.escaped=!1,d=[],p()),0===a.currentState){if('"'===r){a.escaped=!0,a.currentState=1;continue}a.currentState=1}if(1===a.currentState&&a.escaped)if('"'===r)'"'===e[h]?(a.token+='"',h++):(a.escaped=!1,a.currentState=2);else{if("\r"===r)continue;a.token+=r}else"\r"===r?("\n"===e[h]&&h++,f(),m()):"\n"===r?(f(),m()):r===n?f():1===a.currentState&&(a.token+=r)}if(o)c.columns=l.shift();else for(var g=0;g<l[0].length;g++)c.columns[g]="null";for(var y=0;y<l.length;y++)(1!==l[y].length||"undefined"!==l[y][0]&&""!==l[y][0])&&((s=new i.default.TableRow).arr=l[y],s.obj=function(e,t){var r={};if(void 0===(t=t||[]))for(var n=0;n<e.length;n++)t[n.toString()]=n;for(var i=0;i<t.length;i++){var s=t[i],o=e[i];r[s]=o}return r}(l[y],c.columns),c.addRow(s));"function"==typeof t&&t(c),u._decrementPreload()}),(function(t){i.default._friendlyFileLoadError(2,e),r&&r(t)})),c},i.default.prototype.loadXML=function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];for(var n,s,o=new i.default.XML,a=1;a<t.length;a++){var l=t[a];"function"==typeof l&&(void 0===n?n=l:void 0===s&&(s=l))}var c=this;return this.httpDo(t[0],"GET","xml",(function(e){for(var t in e)o[t]=e[t];void 0!==n&&n(o),c._decrementPreload()}),(function(e){if(i.default._friendlyFileLoadError(1,e),!s)throw e;s(e)})),o},i.default.prototype.loadBytes=function(e,t,r){var n={},s=this;return this.httpDo(e,"GET","arrayBuffer",(function(e){n.bytes=new Uint8Array(e),"function"==typeof t&&t(n),s._decrementPreload()}),(function(t){if(i.default._friendlyFileLoadError(6,e),!r)throw t;r(t)})),n},i.default.prototype.httpGet=function(){i.default._validateParameters("httpGet",arguments);var e=Array.prototype.slice.call(arguments);return e.splice(1,0,"GET"),i.default.prototype.httpDo.apply(this,e)},i.default.prototype.httpPost=function(){i.default._validateParameters("httpPost",arguments);var e=Array.prototype.slice.call(arguments);return e.splice(1,0,"POST"),i.default.prototype.httpDo.apply(this,e)},i.default.prototype.httpDo=function(){for(var e,t,r,n={},o=0,a="text/plain",c=arguments.length-1;0<c&&"function"==typeof(c<0||arguments.length<=c?void 0:arguments[c]);c--)o++;var u=arguments.length<=0?void 0:arguments[0];if(2==(g=arguments.length-o)&&"string"==typeof u&&"object"===l(arguments.length<=1?void 0:arguments[1]))y=new Request(u,arguments.length<=1?void 0:arguments[1]),t=arguments.length<=2?void 0:arguments[2],r=arguments.length<=3?void 0:arguments[3];else{for(var h,d="GET",p=1;p<arguments.length;p++){var f=p<0||arguments.length<=p?void 0:arguments[p];if("string"==typeof f)"GET"===f||"POST"===f||"PUT"===f||"DELETE"===f?d=f:"json"===f||"jsonp"===f||"binary"===f||"arrayBuffer"===f||"xml"===f||"text"===f||"table"===f?e=f:h=f;else if("number"==typeof f)h=f.toString();else if("object"===l(f))if(f.hasOwnProperty("jsonpCallback")||f.hasOwnProperty("jsonpCallbackFunction"))for(var m in f)n[m]=f[m];else a=f instanceof i.default.XML?(h=f.serialize(),"application/xml"):(h=JSON.stringify(f),"application/json");else"function"==typeof f&&(t?r=f:t=f)}var g="GET"===d?new Headers:new Headers({"Content-Type":a}),y=new Request(u,{method:d,mode:"cors",body:h,headers:g})}return(g=(g="jsonp"===(e=e||(u.includes("json")?"json":u.includes("xml")?"xml":"text"))?(0,s.default)(u,n):fetch(y)).then((function(t){if(!t.ok)throw(r=new Error(t.body)).status=t.status,r.ok=!1,r;var r=0;switch((r="jsonp"!==e?t.headers.get("content-length"):r)&&64e6<r&&i.default._friendlyFileLoadError(7,u),e){case"json":case"jsonp":return t.json();case"binary":return t.blob();case"arrayBuffer":return t.arrayBuffer();case"xml":return t.text().then((function(e){return e=(new DOMParser).parseFromString(e,"text/xml"),new i.default.XML(e.documentElement)}));default:return t.text()}}))).then(t||function(){}),g.catch(r||console.error),g},window.URL=window.URL||window.webkitURL,i.default.prototype._pWriters=[],i.default.prototype.createWriter=function(e,t){var r,n;for(n in i.default.prototype._pWriters)if(i.default.prototype._pWriters[n].name===e)return r=new i.default.PrintWriter(e+this.millis(),t),i.default.prototype._pWriters.push(r),r;return r=new i.default.PrintWriter(e,t),i.default.prototype._pWriters.push(r),r},i.default.PrintWriter=function(e,t){var r=this;this.name=e,this.content="",this.write=function(e){this.content+=e},this.print=function(e){this.content+="".concat(e,"\n")},this.clear=function(){this.content=""},this.close=function(){var n,s=[];for(n in s.push(this.content),i.default.prototype.writeFile(s,e,t),i.default.prototype._pWriters)i.default.prototype._pWriters[n].name===this.name&&i.default.prototype._pWriters.splice(n,1);r.clear(),r={}}},i.default.prototype.save=function(e,t,r){var n=arguments,s=(this._curElement||this).elt;if(0===n.length)i.default.prototype.saveCanvas(s);else if(n[0]instanceof i.default.Renderer||n[0]instanceof i.default.Graphics)i.default.prototype.saveCanvas(n[0].elt,n[1],n[2]);else if(1===n.length&&"string"==typeof n[0])i.default.prototype.saveCanvas(s,n[0]);else switch(u(n[1],n[2])[1]){case"json":return void i.default.prototype.saveJSON(n[0],n[1],n[2]);case"txt":return void i.default.prototype.saveStrings(n[0],n[1],n[2]);default:n[0]instanceof Array?i.default.prototype.saveStrings(n[0],n[1],n[2]):n[0]instanceof i.default.Table?i.default.prototype.saveTable(n[0],n[1],n[2]):n[0]instanceof i.default.Image?i.default.prototype.saveCanvas(n[0].canvas,n[1]):n[0]instanceof i.default.SoundFile&&i.default.prototype.saveSound(n[0],n[1],n[2],n[3])}},i.default.prototype.saveJSON=function(e,t,r){i.default._validateParameters("saveJSON",arguments),r=r?JSON.stringify(e):JSON.stringify(e,void 0,2),this.saveStrings(r.split("\n"),t,"json")},i.default.prototype.saveJSONObject=i.default.prototype.saveJSON,i.default.prototype.saveJSONArray=i.default.prototype.saveJSON,i.default.prototype.saveStrings=function(e,t,r,n){i.default._validateParameters("saveStrings",arguments);for(var s=this.createWriter(t,r||"txt"),o=0;o<e.length;o++)n?s.write(e[o]+"\r\n"):s.write(e[o]+"\n");s.close(),s.clear()},i.default.prototype.saveTable=function(e,t,r){i.default._validateParameters("saveTable",arguments),n=void 0===r?t.substring(t.lastIndexOf(".")+1,t.length):r;var n,s=this.createWriter(t,n),o=e.columns,a="tsv"===n?"\t":",";if("html"!==n){if("0"!==o[0]){for(var l=0;l<o.length;l++)l<o.length-1?s.write(o[l]+a):s.write(o[l]);s.write("\n")}for(var u=0;u<e.rows.length;u++){var h=void 0;for(h=0;h<e.rows[u].arr.length;h++)h<e.rows[u].arr.length-1?"csv"===n&&String(e.rows[u].arr[h]).includes(",")?s.write('"'+e.rows[u].arr[h]+'"'+a):s.write(e.rows[u].arr[h]+a):"csv"===n&&String(e.rows[u].arr[h]).includes(",")?s.write('"'+e.rows[u].arr[h]+'"'):s.write(e.rows[u].arr[h]);s.write("\n")}}else{if(s.print("<html>"),s.print("<head>"),s.print('  <meta http-equiv="content-type" content="text/html;charset=utf-8" />'),s.print("</head>"),s.print("<body>"),s.print("  <table>"),"0"!==o[0]){s.print("    <tr>");for(var d=0;d<o.length;d++){var p=c(o[d]);s.print("      <td>".concat(p)),s.print("      </td>")}s.print("    </tr>")}for(var f=0;f<e.rows.length;f++){s.print("    <tr>");for(var m=0;m<e.columns.length;m++){var g=c(e.rows[f].getString(m));s.print("      <td>".concat(g)),s.print("      </td>")}s.print("    </tr>")}s.print("  </table>"),s.print("</body>"),s.print("</html>")}s.close(),s.clear()},i.default.prototype.writeFile=function(e,t,r){var n="application/octet-stream";i.default.prototype._isSafari()&&(n="text/plain"),e=new Blob(e,{type:n});i.default.prototype.downloadFile(e,t,r)},i.default.prototype.downloadFile=function(e,t,r){var n;r=(t=u(t,r))[0];e instanceof Blob?o.default.saveAs(e,r):((n=document.createElement("a")).href=e,n.download=r,n.onclick=function(e){document.body.removeChild(e.target),e.stopPropagation()},n.style.display="none",document.body.appendChild(n),i.default.prototype._isSafari()&&(e=(e='Hello, Safari user! To download this file...\n1. Go to File --\x3e Save As.\n2. Choose "Page Source" as the Format.\n')+'3. Name it with this extension: ."'.concat(t[1],'"'),alert(e)),n.click())},i.default.prototype._checkFileExtension=u,i.default.prototype._isSafari=function(){return 0<Object.prototype.toString.call(window.HTMLElement).indexOf("Constructor")},e=i.default,r.default=e},{"../core/friendly_errors/fes_core":258,"../core/friendly_errors/file_errors":259,"../core/friendly_errors/validate_params":262,"../core/main":267,"core-js/modules/es.array.concat":149,"core-js/modules/es.array.includes":156,"core-js/modules/es.array.index-of":157,"core-js/modules/es.array.iterator":158,"core-js/modules/es.array.last-index-of":160,"core-js/modules/es.array.slice":162,"core-js/modules/es.array.splice":164,"core-js/modules/es.function.name":165,"core-js/modules/es.object.to-string":177,"core-js/modules/es.promise":178,"core-js/modules/es.regexp.exec":181,"core-js/modules/es.regexp.to-string":182,"core-js/modules/es.string.includes":185,"core-js/modules/es.string.iterator":186,"core-js/modules/es.string.replace":189,"core-js/modules/es.string.split":191,"core-js/modules/es.symbol":196,"core-js/modules/es.symbol.description":194,"core-js/modules/es.symbol.iterator":195,"core-js/modules/es.typed-array.copy-within":197,"core-js/modules/es.typed-array.every":198,"core-js/modules/es.typed-array.fill":199,"core-js/modules/es.typed-array.filter":200,"core-js/modules/es.typed-array.find":202,"core-js/modules/es.typed-array.find-index":201,"core-js/modules/es.typed-array.for-each":205,"core-js/modules/es.typed-array.includes":206,"core-js/modules/es.typed-array.index-of":207,"core-js/modules/es.typed-array.iterator":210,"core-js/modules/es.typed-array.join":211,"core-js/modules/es.typed-array.last-index-of":212,"core-js/modules/es.typed-array.map":213,"core-js/modules/es.typed-array.reduce":215,"core-js/modules/es.typed-array.reduce-right":214,"core-js/modules/es.typed-array.reverse":216,"core-js/modules/es.typed-array.set":217,"core-js/modules/es.typed-array.slice":218,"core-js/modules/es.typed-array.some":219,"core-js/modules/es.typed-array.sort":220,"core-js/modules/es.typed-array.subarray":221,"core-js/modules/es.typed-array.to-locale-string":222,"core-js/modules/es.typed-array.to-string":223,"core-js/modules/es.typed-array.uint8-array":226,"core-js/modules/web.dom-collections.iterator":230,"core-js/modules/web.url":232,"es6-promise/auto":233,"fetch-jsonp":235,"file-saver":236,"whatwg-fetch":245}],294:[function(e,t,r){"use strict";e("core-js/modules/es.array.concat"),e("core-js/modules/es.array.index-of"),e("core-js/modules/es.array.join"),e("core-js/modules/es.array.splice"),e("core-js/modules/es.regexp.constructor"),e("core-js/modules/es.regexp.exec"),e("core-js/modules/es.regexp.to-string"),e("core-js/modules/es.string.match"),e("core-js/modules/es.string.replace"),e("core-js/modules/es.string.trim"),e("core-js/modules/es.array.concat"),e("core-js/modules/es.array.index-of"),e("core-js/modules/es.array.join"),e("core-js/modules/es.array.splice"),e("core-js/modules/es.regexp.constructor"),e("core-js/modules/es.regexp.exec"),e("core-js/modules/es.regexp.to-string"),e("core-js/modules/es.string.match"),e("core-js/modules/es.string.replace"),e("core-js/modules/es.string.trim"),Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n=(e=e("../core/main"))&&e.__esModule?e:{default:e};n.default.Table=function(e){this.columns=[],this.rows=[]},n.default.Table.prototype.addRow=function(e){if(void 0===(e=e||new n.default.TableRow).arr||void 0===e.obj)throw new Error("invalid TableRow: ".concat(e));return(e.table=this).rows.push(e),e},n.default.Table.prototype.removeRow=function(e){this.rows[e].table=null,e=this.rows.splice(e+1,this.rows.length),this.rows.pop(),this.rows=this.rows.concat(e)},n.default.Table.prototype.getRow=function(e){return this.rows[e]},n.default.Table.prototype.getRows=function(){return this.rows},n.default.Table.prototype.findRow=function(e,t){if("string"==typeof t){for(var r=0;r<this.rows.length;r++)if(this.rows[r].obj[t]===e)return this.rows[r]}else for(var n=0;n<this.rows.length;n++)if(this.rows[n].arr[t]===e)return this.rows[n];return null},n.default.Table.prototype.findRows=function(e,t){var r=[];if("string"==typeof t)for(var n=0;n<this.rows.length;n++)this.rows[n].obj[t]===e&&r.push(this.rows[n]);else for(var i=0;i<this.rows.length;i++)this.rows[i].arr[t]===e&&r.push(this.rows[i]);return r},n.default.Table.prototype.matchRow=function(e,t){if("number"==typeof t){for(var r=0;r<this.rows.length;r++)if(this.rows[r].arr[t].match(e))return this.rows[r]}else for(var n=0;n<this.rows.length;n++)if(this.rows[n].obj[t].match(e))return this.rows[n];return null},n.default.Table.prototype.matchRows=function(e,t){var r=[];if("number"==typeof t)for(var n=0;n<this.rows.length;n++)this.rows[n].arr[t].match(e)&&r.push(this.rows[n]);else for(var i=0;i<this.rows.length;i++)this.rows[i].obj[t].match(e)&&r.push(this.rows[i]);return r},n.default.Table.prototype.getColumn=function(e){var t=[];if("string"==typeof e)for(var r=0;r<this.rows.length;r++)t.push(this.rows[r].obj[e]);else for(var n=0;n<this.rows.length;n++)t.push(this.rows[n].arr[e]);return t},n.default.Table.prototype.clearRows=function(){delete this.rows,this.rows=[]},n.default.Table.prototype.addColumn=function(e){this.columns.push(e||null)},n.default.Table.prototype.getColumnCount=function(){return this.columns.length},n.default.Table.prototype.getRowCount=function(){return this.rows.length},n.default.Table.prototype.removeTokens=function(e,t){for(var r=[],n=0;n<e.length;n++)r.push(e.charAt(n).replace(/[-/\\^$*+?.()|[\]{}]/g,"\\$&"));var i=new RegExp(r.join("|"),"g");if(void 0===t)for(var s=0;s<this.columns.length;s++)for(var o=0;o<this.rows.length;o++){var a=(a=this.rows[o].arr[s]).replace(i,"");this.rows[o].arr[s]=a,this.rows[o].obj[this.columns[s]]=a}else if("string"==typeof t)for(var l=0;l<this.rows.length;l++){var c=(c=this.rows[l].obj[t]).replace(i,""),u=(this.rows[l].obj[t]=c,this.columns.indexOf(t));this.rows[l].arr[u]=c}else for(var h=0;h<this.rows.length;h++){var d=(d=this.rows[h].arr[t]).replace(i,"");this.rows[h].arr[t]=d,this.rows[h].obj[this.columns[t]]=d}},n.default.Table.prototype.trim=function(e){var t=new RegExp(" ","g");if(void 0===e)for(var r=0;r<this.columns.length;r++)for(var n=0;n<this.rows.length;n++){var i=(i=this.rows[n].arr[r]).replace(t,"");this.rows[n].arr[r]=i,this.rows[n].obj[this.columns[r]]=i}else if("string"==typeof e)for(var s=0;s<this.rows.length;s++){var o=(o=this.rows[s].obj[e]).replace(t,""),a=(this.rows[s].obj[e]=o,this.columns.indexOf(e));this.rows[s].arr[a]=o}else for(var l=0;l<this.rows.length;l++){var c=(c=this.rows[l].arr[e]).replace(t,"");this.rows[l].arr[e]=c,this.rows[l].obj[this.columns[e]]=c}},n.default.Table.prototype.removeColumn=function(e){"string"==typeof e?r=this.columns.indexOf(t=e):t=this.columns[r=e];var t,r;e=this.columns.splice(r+1,this.columns.length);this.columns.pop(),this.columns=this.columns.concat(e);for(var n=0;n<this.rows.length;n++){var i=this.rows[n].arr,s=i.splice(r+1,i.length);i.pop(),this.rows[n].arr=i.concat(s),delete this.rows[n].obj[t]}},n.default.Table.prototype.set=function(e,t,r){this.rows[e].set(t,r)},n.default.Table.prototype.setNum=function(e,t,r){this.rows[e].setNum(t,r)},n.default.Table.prototype.setString=function(e,t,r){this.rows[e].setString(t,r)},n.default.Table.prototype.get=function(e,t){return this.rows[e].get(t)},n.default.Table.prototype.getNum=function(e,t){return this.rows[e].getNum(t)},n.default.Table.prototype.getString=function(e,t){return this.rows[e].getString(t)},n.default.Table.prototype.getObject=function(e){for(var t,r={},n=0;n<this.rows.length;n++)if(t=this.rows[n].obj,"string"==typeof e){if(!(0<=this.columns.indexOf(e)))throw new Error('This table has no column named "'.concat(e,'"'));r[t[e]]=t}else r[n]=this.rows[n].obj;return r},n.default.Table.prototype.getArray=function(){for(var e=[],t=0;t<this.rows.length;t++)e.push(this.rows[t].arr);return e},e=n.default,r.default=e},{"../core/main":267,"core-js/modules/es.array.concat":149,"core-js/modules/es.array.index-of":157,"core-js/modules/es.array.join":159,"core-js/modules/es.array.splice":164,"core-js/modules/es.regexp.constructor":180,"core-js/modules/es.regexp.exec":181,"core-js/modules/es.regexp.to-string":182,"core-js/modules/es.string.match":187,"core-js/modules/es.string.replace":189,"core-js/modules/es.string.trim":193}],295:[function(e,t,r){"use strict";e("core-js/modules/es.array.index-of"),e("core-js/modules/es.object.to-string"),e("core-js/modules/es.regexp.exec"),e("core-js/modules/es.regexp.to-string"),e("core-js/modules/es.string.split"),e("core-js/modules/es.array.index-of"),e("core-js/modules/es.object.to-string"),e("core-js/modules/es.regexp.exec"),e("core-js/modules/es.regexp.to-string"),e("core-js/modules/es.string.split"),Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0,(e=(e=e("../core/main"))&&e.__esModule?e:{default:e}).default.TableRow=function(e,t){var r=[],n={};e&&(r=e.split(t=t||","));for(var i=0;i<r.length;i++){var s=i,o=r[i];n[s]=o}this.arr=r,this.obj=n,this.table=null},e.default.TableRow.prototype.set=function(e,t){if("string"==typeof e){var r=this.table.columns.indexOf(e);if(!(0<=r))throw new Error('This table has no column named "'.concat(e,'"'));this.obj[e]=t,this.arr[r]=t}else{if(!(e<this.table.columns.length))throw new Error("Column #".concat(e," is out of the range of this table"));this.arr[e]=t,r=this.table.columns[e],this.obj[r]=t}},e.default.TableRow.prototype.setNum=function(e,t){t=parseFloat(t),this.set(e,t)},e.default.TableRow.prototype.setString=function(e,t){t=t.toString(),this.set(e,t)},e.default.TableRow.prototype.get=function(e){return("string"==typeof e?this.obj:this.arr)[e]},e.default.TableRow.prototype.getNum=function(e){var t="string"==typeof e?parseFloat(this.obj[e]):parseFloat(this.arr[e]);if("NaN"===t.toString())throw"Error: ".concat(this.obj[e]," is NaN (Not a Number)");return t},e.default.TableRow.prototype.getString=function(e){return("string"==typeof e?this.obj:this.arr)[e].toString()},e=e.default,r.default=e},{"../core/main":267,"core-js/modules/es.array.index-of":157,"core-js/modules/es.object.to-string":177,"core-js/modules/es.regexp.exec":181,"core-js/modules/es.regexp.to-string":182,"core-js/modules/es.string.split":191}],296:[function(e,t,r){"use strict";e("core-js/modules/es.symbol"),e("core-js/modules/es.symbol.description"),e("core-js/modules/es.symbol.iterator"),e("core-js/modules/es.array.iterator"),e("core-js/modules/es.number.constructor"),e("core-js/modules/es.object.to-string"),e("core-js/modules/es.regexp.exec"),e("core-js/modules/es.string.iterator"),e("core-js/modules/es.string.replace"),e("core-js/modules/web.dom-collections.iterator"),e("core-js/modules/es.symbol"),e("core-js/modules/es.symbol.description"),e("core-js/modules/es.symbol.iterator"),e("core-js/modules/es.array.iterator"),e("core-js/modules/es.number.constructor"),e("core-js/modules/es.object.to-string"),e("core-js/modules/es.regexp.exec"),e("core-js/modules/es.string.iterator"),e("core-js/modules/es.string.replace"),e("core-js/modules/web.dom-collections.iterator"),Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n=(e=e("../core/main"))&&e.__esModule?e:{default:e};n.default.XML=function(e){e?this.DOM=e:(e=document.implementation.createDocument(null,"doc"),this.DOM=e.createElement("root"))},n.default.XML.prototype.getParent=function(){return new n.default.XML(this.DOM.parentElement)},n.default.XML.prototype.getName=function(){return this.DOM.tagName},n.default.XML.prototype.setName=function(e){var t=this.DOM.innerHTML,r=this.DOM.attributes,n=document.implementation.createDocument(null,"default").createElement(e);n.innerHTML=t;for(var i=0;i<r.length;i++)n.setAttribute(r[i].nodeName,r.nodeValue);this.DOM=n},n.default.XML.prototype.hasChildren=function(){return 0<this.DOM.children.length},n.default.XML.prototype.listChildren=function(){for(var e=[],t=0;t<this.DOM.childNodes.length;t++)e.push(this.DOM.childNodes[t].nodeName);return e},n.default.XML.prototype.getChildren=function(e){return function(e){for(var t=[],r=0;r<e.length;r++)t.push(new n.default.XML(e[r]));return t}(e?this.DOM.getElementsByTagName(e):this.DOM.children)},n.default.XML.prototype.getChild=function(e){if("string"!=typeof e)return new n.default.XML(this.DOM.children[e]);var t=!0,r=!1,i=void 0;try{for(var s,o=this.DOM.children[Symbol.iterator]();!(t=(s=o.next()).done);t=!0){var a=s.value;if(a.tagName===e)return new n.default.XML(a)}}catch(e){r=!0,i=e}finally{try{t||null==o.return||o.return()}finally{if(r)throw i}}},n.default.XML.prototype.addChild=function(e){e instanceof n.default.XML&&this.DOM.appendChild(e.DOM)},n.default.XML.prototype.removeChild=function(e){var t=-1;if("string"==typeof e){for(var r=0;r<this.DOM.children.length;r++)if(this.DOM.children[r].tagName===e){t=r;break}}else t=e;-1!==t&&this.DOM.removeChild(this.DOM.children[t])},n.default.XML.prototype.getAttributeCount=function(){return this.DOM.attributes.length},n.default.XML.prototype.listAttributes=function(){var e=[],t=!0,r=!1,n=void 0;try{for(var i,s=this.DOM.attributes[Symbol.iterator]();!(t=(i=s.next()).done);t=!0){var o=i.value;e.push(o.nodeName)}}catch(e){r=!0,n=e}finally{try{t||null==s.return||s.return()}finally{if(r)throw n}}return e},n.default.XML.prototype.hasAttribute=function(e){var t={},r=!0,n=!1,i=void 0;try{for(var s,o=this.DOM.attributes[Symbol.iterator]();!(r=(s=o.next()).done);r=!0){var a=s.value;t[a.nodeName]=a.nodeValue}}catch(e){n=!0,i=e}finally{try{r||null==o.return||o.return()}finally{if(n)throw i}}return!!t[e]},n.default.XML.prototype.getNum=function(e,t){var r={},n=!0,i=!1,s=void 0;try{for(var o,a=this.DOM.attributes[Symbol.iterator]();!(n=(o=a.next()).done);n=!0){var l=o.value;r[l.nodeName]=l.nodeValue}}catch(e){i=!0,s=e}finally{try{n||null==a.return||a.return()}finally{if(i)throw s}}return Number(r[e])||t||0},n.default.XML.prototype.getString=function(e,t){var r={},n=!0,i=!1,s=void 0;try{for(var o,a=this.DOM.attributes[Symbol.iterator]();!(n=(o=a.next()).done);n=!0){var l=o.value;r[l.nodeName]=l.nodeValue}}catch(e){i=!0,s=e}finally{try{n||null==a.return||a.return()}finally{if(i)throw s}}return r[e]?String(r[e]):t||null},n.default.XML.prototype.setAttribute=function(e,t){this.DOM.setAttribute(e,t)},n.default.XML.prototype.getContent=function(e){var t=this.DOM.textContent;return(t=t.replace(/\s\s+/g,","))||e||null},n.default.XML.prototype.setContent=function(e){this.DOM.children.length||(this.DOM.textContent=e)},n.default.XML.prototype.serialize=function(){return(new XMLSerializer).serializeToString(this.DOM)},e=n.default,r.default=e},{"../core/main":267,"core-js/modules/es.array.iterator":158,"core-js/modules/es.number.constructor":169,"core-js/modules/es.object.to-string":177,"core-js/modules/es.regexp.exec":181,"core-js/modules/es.string.iterator":186,"core-js/modules/es.string.replace":189,"core-js/modules/es.symbol":196,"core-js/modules/es.symbol.description":194,"core-js/modules/es.symbol.iterator":195,"core-js/modules/web.dom-collections.iterator":230}],297:[function(e,t,r){"use strict";e("core-js/modules/es.array.includes"),e("core-js/modules/es.array.index-of"),e("core-js/modules/es.array.map"),e("core-js/modules/es.array.slice"),e("core-js/modules/es.math.hypot"),e("core-js/modules/es.number.constructor"),e("core-js/modules/es.string.includes"),e("core-js/modules/es.array.includes"),e("core-js/modules/es.array.index-of"),e("core-js/modules/es.array.map"),e("core-js/modules/es.array.slice"),e("core-js/modules/es.math.hypot"),e("core-js/modules/es.number.constructor"),e("core-js/modules/es.string.includes"),Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n=(e=e("../core/main"))&&e.__esModule?e:{default:e};function i(){if("function"==typeof Math.hypot)return Math.hypot.apply(null,arguments);for(var e=arguments.length,t=[],r=0,n=0;n<e;n++){var i=arguments[n];if((i=+i)==1/0||i===-1/0)return 1/0;r<(i=Math.abs(i))&&(r=i),t[n]=i}0===r&&(r=1);for(var s=0,o=0,a=0;a<e;a++){var l,c=s+(l=(l=t[a]/r)*l-o);o=c-s-l,s=c}return Math.sqrt(s)*r}n.default.prototype.abs=Math.abs,n.default.prototype.ceil=Math.ceil,n.default.prototype.constrain=function(e,t,r){return n.default._validateParameters("constrain",arguments),Math.max(Math.min(e,r),t)},n.default.prototype.dist=function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return n.default._validateParameters("dist",t),4===t.length?i(t[2]-t[0],t[3]-t[1]):6===t.length?i(t[3]-t[0],t[4]-t[1],t[5]-t[2]):void 0},n.default.prototype.exp=Math.exp,n.default.prototype.floor=Math.floor,n.default.prototype.lerp=function(e,t,r){return n.default._validateParameters("lerp",arguments),r*(t-e)+e},n.default.prototype.log=Math.log,n.default.prototype.mag=function(e,t){return n.default._validateParameters("mag",arguments),i(e,t)},n.default.prototype.map=function(e,t,r,i,s,o){return n.default._validateParameters("map",arguments),e=(e-t)/(r-t)*(s-i)+i,o?i<s?this.constrain(e,i,s):this.constrain(e,s,i):e},n.default.prototype.max=function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return t[0]instanceof Array?Math.max.apply(null,t[0]):Math.max.apply(null,t)},n.default.prototype.min=function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return t[0]instanceof Array?Math.min.apply(null,t[0]):Math.min.apply(null,t)},n.default.prototype.norm=function(e,t,r){return n.default._validateParameters("norm",arguments),this.map(e,t,r,0,1)},n.default.prototype.pow=Math.pow,n.default.prototype.round=function(e,t){return t?(t=Math.pow(10,t),Math.round(e*t)/t):Math.round(e)},n.default.prototype.sq=function(e){return e*e},n.default.prototype.sqrt=Math.sqrt,n.default.prototype.fract=function(e){n.default._validateParameters("fract",arguments);var t,r=0;e=Number(e);return isNaN(e)||Math.abs(e)===1/0?e:(e<0&&(e=-e,r=1),String(e).includes(".")&&!String(e).includes("e")?(t=String(e),t=Number("0"+t.slice(t.indexOf("."))),Math.abs(r-t)):e<1?Math.abs(r-e):0)},e=n.default,r.default=e},{"../core/main":267,"core-js/modules/es.array.includes":156,"core-js/modules/es.array.index-of":157,"core-js/modules/es.array.map":161,"core-js/modules/es.array.slice":162,"core-js/modules/es.math.hypot":167,"core-js/modules/es.number.constructor":169,"core-js/modules/es.string.includes":185}],298:[function(e,t,r){"use strict";e("core-js/modules/es.array.concat"),e("core-js/modules/es.array.slice"),e("core-js/modules/es.object.to-string"),e("core-js/modules/es.reflect.construct"),e("core-js/modules/es.regexp.to-string"),e("core-js/modules/es.array.concat"),e("core-js/modules/es.array.slice"),e("core-js/modules/es.object.to-string"),e("core-js/modules/es.reflect.construct"),e("core-js/modules/es.regexp.to-string"),Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n=(e=e("../core/main"))&&e.__esModule?e:{default:e};function i(e,t,r){return(i=function(){if("undefined"!=typeof Reflect&&Reflect.construct&&!Reflect.construct.sham){if("function"==typeof Proxy)return 1;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),1}catch(e){}}}()?Reflect.construct:function(e,t,r){var n=[null];return n.push.apply(n,t),t=new(Function.bind.apply(e,n)),r&&s(t,r.prototype),t}).apply(null,arguments)}function s(e,t){return(s=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}n.default.prototype.createVector=function(e,t,r){return this instanceof n.default?i(n.default.Vector,[this._fromRadians.bind(this),this._toRadians.bind(this)].concat(Array.prototype.slice.call(arguments))):new n.default.Vector(e,t,r)},e=n.default,r.default=e},{"../core/main":267,"core-js/modules/es.array.concat":149,"core-js/modules/es.array.slice":162,"core-js/modules/es.object.to-string":177,"core-js/modules/es.reflect.construct":179,"core-js/modules/es.regexp.to-string":182}],299:[function(e,t,r){"use strict";function n(e){return.5*(1-Math.cos(e*Math.PI))}Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0,e=(e=e("../core/main"))&&e.__esModule?e:{default:e};var i,s=4095,o=4,a=.5;e.default.prototype.noise=function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0,r=2<arguments.length&&void 0!==arguments[2]?arguments[2]:0;if(null==i){i=new Array(4096);for(var l=0;l<4096;l++)i[l]=Math.random()}e<0&&(e=-e),t<0&&(t=-t),r<0&&(r=-r);for(var c,u,h=Math.floor(e),d=Math.floor(t),p=Math.floor(r),f=e-h,m=t-d,g=r-p,y=0,v=.5,_=0;_<o;_++){var x=h+(d<<4)+(p<<8),b=n(f),w=n(m),S=i[x&s];S+=b*(i[x+1&s]-S),c=i[x+16&s],S+=w*((c+=b*(i[x+16+1&s]-c))-S),c=i[(x+=256)&s],c+=b*(i[x+1&s]-c),u=i[x+16&s],c+=w*((u+=b*(i[x+16+1&s]-u))-c),y+=(S+=n(g)*(c-S))*v,v*=a,h<<=1,d<<=1,p<<=1,1<=(f*=2)&&(h++,f--),1<=(m*=2)&&(d++,m--),1<=(g*=2)&&(p++,g--)}return y},e.default.prototype.noiseDetail=function(e,t){0<e&&(o=e),0<t&&(a=t)},e.default.prototype.noiseSeed=function(e){r=4294967296;var t,r,n=function(e){t=(null==e?Math.random()*r:e)>>>0},s=function(){return(t=(1664525*t+1013904223)%r)/r};n(e),i=new Array(4096);for(var o=0;o<4096;o++)i[o]=s()},e=e.default;r.default=e},{"../core/main":267}],300:[function(e,t,r){"use strict";function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function i(e){return(i="function"==typeof Symbol&&"symbol"===n(Symbol.iterator)?function(e){return n(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":n(e)})(e)}e("core-js/modules/es.symbol"),e("core-js/modules/es.symbol.description"),e("core-js/modules/es.symbol.iterator"),e("core-js/modules/es.array.concat"),e("core-js/modules/es.array.every"),e("core-js/modules/es.array.iterator"),e("core-js/modules/es.array.slice"),e("core-js/modules/es.array.some"),e("core-js/modules/es.math.sign"),e("core-js/modules/es.number.constructor"),e("core-js/modules/es.number.is-finite"),e("core-js/modules/es.object.get-own-property-descriptor"),e("core-js/modules/es.object.to-string"),e("core-js/modules/es.regexp.to-string"),e("core-js/modules/es.string.iterator"),e("core-js/modules/es.string.sub"),e("core-js/modules/es.weak-map"),e("core-js/modules/web.dom-collections.iterator"),e("core-js/modules/es.array.concat"),e("core-js/modules/es.array.every"),e("core-js/modules/es.array.slice"),e("core-js/modules/es.array.some"),e("core-js/modules/es.math.sign"),e("core-js/modules/es.number.constructor"),e("core-js/modules/es.number.is-finite"),e("core-js/modules/es.object.to-string"),e("core-js/modules/es.regexp.to-string"),e("core-js/modules/es.string.sub"),Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var s=(u=e("../core/main"))&&u.__esModule?u:{default:u},o=function(e){if(e&&e.__esModule)return e;if(null===e||"object"!==i(e)&&"function"!=typeof e)return{default:e};var t=a();if(t&&t.has(e))return t.get(e);var r,n={},s=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(r in e){var o;Object.prototype.hasOwnProperty.call(e,r)&&((o=s?Object.getOwnPropertyDescriptor(e,r):null)&&(o.get||o.set)?Object.defineProperty(n,r,o):n[r]=e[r])}return n.default=e,t&&t.set(e,n),n}(e("../core/constants"));function a(){var e;return"function"!=typeof WeakMap?null:(e=new WeakMap,a=function(){return e},e)}function l(e,t){return 0!==e&&(this.x=this.x%e),0!==t&&(this.y=this.y%t),this}function c(e,t,r){return 0!==e&&(this.x=this.x%e),0!==t&&(this.y=this.y%t),0!==r&&(this.z=this.z%r),this}s.default.Vector=function(){var e,t,r="[object Function]"==={}.toString.call(arguments[0])?(this.isPInst=!0,this._fromRadians=arguments[0],this._toRadians=arguments[1],e=arguments[2]||0,t=arguments[3]||0,arguments[4]||0):(e=arguments[0]||0,t=arguments[1]||0,arguments[2]||0);this.x=e,this.y=t,this.z=r},s.default.Vector.prototype.toString=function(){return"p5.Vector Object : [".concat(this.x,", ").concat(this.y,", ").concat(this.z,"]")},s.default.Vector.prototype.set=function(e,t,r){return e instanceof s.default.Vector?(this.x=e.x||0,this.y=e.y||0,this.z=e.z||0):e instanceof Array?(this.x=e[0]||0,this.y=e[1]||0,this.z=e[2]||0):(this.x=e||0,this.y=t||0,this.z=r||0),this},s.default.Vector.prototype.copy=function(){return this.isPInst?new s.default.Vector(this._fromRadians,this._toRadians,this.x,this.y,this.z):new s.default.Vector(this.x,this.y,this.z)},s.default.Vector.prototype.add=function(e,t,r){return e instanceof s.default.Vector?(this.x+=e.x||0,this.y+=e.y||0,this.z+=e.z||0):e instanceof Array?(this.x+=e[0]||0,this.y+=e[1]||0,this.z+=e[2]||0):(this.x+=e||0,this.y+=t||0,this.z+=r||0),this},s.default.Vector.prototype.rem=function(e,t,r){var n;if(e instanceof s.default.Vector){if(Number.isFinite(e.x)&&Number.isFinite(e.y)&&Number.isFinite(e.z))return i=parseFloat(e.x),o=parseFloat(e.y),n=parseFloat(e.z),c.call(this,i,o,n)}else if(e instanceof Array){if(e.every((function(e){return Number.isFinite(e)})))return 2===e.length?l.call(this,e[0],e[1]):3===e.length?c.call(this,e[0],e[1],e[2]):void 0}else if(1===arguments.length){if(Number.isFinite(e)&&0!==e)return this.x=this.x%e,this.y=this.y%e,this.z=this.z%e,this}else if(2===arguments.length){var i=Array.prototype.slice.call(arguments);if(i.every((function(e){return Number.isFinite(e)}))&&2===i.length)return l.call(this,i[0],i[1])}else if(3===arguments.length){var o=Array.prototype.slice.call(arguments);if(o.every((function(e){return Number.isFinite(e)}))&&3===o.length)return c.call(this,o[0],o[1],o[2])}},s.default.Vector.prototype.sub=function(e,t,r){return e instanceof s.default.Vector?(this.x-=e.x||0,this.y-=e.y||0,this.z-=e.z||0):e instanceof Array?(this.x-=e[0]||0,this.y-=e[1]||0,this.z-=e[2]||0):(this.x-=e||0,this.y-=t||0,this.z-=r||0),this},s.default.Vector.prototype.mult=function(e,t,r){var n;return e instanceof s.default.Vector?Number.isFinite(e.x)&&Number.isFinite(e.y)&&Number.isFinite(e.z)&&"number"==typeof e.x&&"number"==typeof e.y&&"number"==typeof e.z&&(this.x*=e.x,this.y*=e.y,this.z*=e.z):e instanceof Array?e.every((function(e){return Number.isFinite(e)}))&&e.every((function(e){return"number"==typeof e}))&&(1===e.length?(this.x*=e[0],this.y*=e[0],this.z*=e[0]):2===e.length?(this.x*=e[0],this.y*=e[1]):3===e.length&&(this.x*=e[0],this.y*=e[1],this.z*=e[2])):(n=Array.prototype.slice.call(arguments)).every((function(e){return Number.isFinite(e)}))&&n.every((function(e){return"number"==typeof e}))&&(1===arguments.length&&(this.x*=e,this.y*=e,this.z*=e),2===arguments.length&&(this.x*=e,this.y*=t),3===arguments.length&&(this.x*=e,this.y*=t,this.z*=r)),this},s.default.Vector.prototype.div=function(e,t,r){if(e instanceof s.default.Vector){if(Number.isFinite(e.x)&&Number.isFinite(e.y)&&Number.isFinite(e.z)&&"number"==typeof e.x&&"number"==typeof e.y&&"number"==typeof e.z){var n=0===e.z&&0===this.z;if(0===e.x||0===e.y||!n&&0===e.z)return this;this.x/=e.x,this.y/=e.y,n||(this.z/=e.z)}}else if(e instanceof Array){if(e.every((function(e){return Number.isFinite(e)}))&&e.every((function(e){return"number"==typeof e}))){if(e.some((function(e){return 0===e})))return this;1===e.length?(this.x/=e[0],this.y/=e[0],this.z/=e[0]):2===e.length?(this.x/=e[0],this.y/=e[1]):3===e.length&&(this.x/=e[0],this.y/=e[1],this.z/=e[2])}}else if((n=Array.prototype.slice.call(arguments)).every((function(e){return Number.isFinite(e)}))&&n.every((function(e){return"number"==typeof e}))){if(n.some((function(e){return 0===e})))return this;1===arguments.length&&(this.x/=e,this.y/=e,this.z/=e),2===arguments.length&&(this.x/=e,this.y/=t),3===arguments.length&&(this.x/=e,this.y/=t,this.z/=r)}return this},s.default.Vector.prototype.mag=function(){return Math.sqrt(this.magSq())},s.default.Vector.prototype.magSq=function(){var e=this.x,t=this.y,r=this.z;return e*e+t*t+r*r},s.default.Vector.prototype.dot=function(e,t,r){return e instanceof s.default.Vector?this.dot(e.x,e.y,e.z):this.x*(e||0)+this.y*(t||0)+this.z*(r||0)},s.default.Vector.prototype.cross=function(e){var t=this.y*e.z-this.z*e.y,r=this.z*e.x-this.x*e.z;e=this.x*e.y-this.y*e.x;return this.isPInst?new s.default.Vector(this._fromRadians,this._toRadians,t,r,e):new s.default.Vector(t,r,e)},s.default.Vector.prototype.dist=function(e){return e.copy().sub(this).mag()},s.default.Vector.prototype.normalize=function(){var e=this.mag();return 0!==e&&this.mult(1/e),this},s.default.Vector.prototype.limit=function(e){var t=this.magSq();return e*e<t&&this.div(Math.sqrt(t)).mult(e),this},s.default.Vector.prototype.setMag=function(e){return this.normalize().mult(e)},s.default.Vector.prototype.heading=function(){var e=Math.atan2(this.y,this.x);return this.isPInst?this._fromRadians(e):e},s.default.Vector.prototype.setHeading=function(e){this.isPInst&&(e=this._toRadians(e));var t=this.mag();return this.x=t*Math.cos(e),this.y=t*Math.sin(e),this},s.default.Vector.prototype.rotate=function(e){e=this.heading()+e;var t=(this.isPInst&&(e=this._toRadians(e)),this.mag());return this.x=Math.cos(e)*t,this.y=Math.sin(e)*t,this},s.default.Vector.prototype.angleBetween=function(e){var t=this.dot(e)/(this.mag()*e.mag());t=Math.acos(Math.min(1,Math.max(-1,t)));return t*=Math.sign(this.cross(e).z||1),this.isPInst?this._fromRadians(t):t},s.default.Vector.prototype.lerp=function(e,t,r,n){return e instanceof s.default.Vector?this.lerp(e.x,e.y,e.z,t):(this.x+=(e-this.x)*n||0,this.y+=(t-this.y)*n||0,this.z+=(r-this.z)*n||0,this)},s.default.Vector.prototype.reflect=function(e){return e.normalize(),this.sub(e.mult(2*this.dot(e)))},s.default.Vector.prototype.array=function(){return[this.x||0,this.y||0,this.z||0]},s.default.Vector.prototype.equals=function(e,t,r){var n,i;e=e instanceof s.default.Vector?(n=e.x||0,i=e.y||0,e.z||0):e instanceof Array?(n=e[0]||0,i=e[1]||0,e[2]||0):(n=e||0,i=t||0,r||0);return this.x===n&&this.y===i&&this.z===e},s.default.Vector.fromAngle=function(e,t){return new s.default.Vector((t=void 0===t?1:t)*Math.cos(e),t*Math.sin(e),0)},s.default.Vector.fromAngles=function(e,t,r){void 0===r&&(r=1);var n=Math.cos(t),i=(t=Math.sin(t),Math.cos(e));e=Math.sin(e);return new s.default.Vector(r*e*t,-r*i,r*e*n)},s.default.Vector.random2D=function(){return this.fromAngle(Math.random()*o.TWO_PI)},s.default.Vector.random3D=function(){var e=Math.random()*o.TWO_PI,t=2*Math.random()-1,r=(n=Math.sqrt(1-t*t))*Math.cos(e),n=n*Math.sin(e);return new s.default.Vector(r,n,t)},s.default.Vector.copy=function(e){return e.copy(e)},s.default.Vector.add=function(e,t,r){return r?r.set(e):(r=e.copy(),3===arguments.length&&s.default._friendlyError("The target parameter is undefined, it should be of type p5.Vector","p5.Vector.add")),r.add(t),r},s.default.Vector.rem=function(e,t){if(e instanceof s.default.Vector&&t instanceof s.default.Vector)return(e=e.copy()).rem(t),e},s.default.Vector.sub=function(e,t,r){return r?r.set(e):(r=e.copy(),3===arguments.length&&s.default._friendlyError("The target parameter is undefined, it should be of type p5.Vector","p5.Vector.sub")),r.sub(t),r},s.default.Vector.mult=function(e,t,r){return r?r.set(e):(r=e.copy(),3===arguments.length&&s.default._friendlyError("The target parameter is undefined, it should be of type p5.Vector","p5.Vector.mult")),r.mult(t),r},s.default.Vector.rotate=function(e,t,r){return 2===arguments.length?r=e.copy():(r instanceof s.default.Vector||s.default._friendlyError("The target parameter should be of type p5.Vector","p5.Vector.rotate"),r.set(e)),r.rotate(t),r},s.default.Vector.div=function(e,t,r){return r?r.set(e):(r=e.copy(),3===arguments.length&&s.default._friendlyError("The target parameter is undefined, it should be of type p5.Vector","p5.Vector.div")),r.div(t),r},s.default.Vector.dot=function(e,t){return e.dot(t)},s.default.Vector.cross=function(e,t){return e.cross(t)},s.default.Vector.dist=function(e,t){return e.dist(t)},s.default.Vector.lerp=function(e,t,r,n){return n?n.set(e):(n=e.copy(),4===arguments.length&&s.default._friendlyError("The target parameter is undefined, it should be of type p5.Vector","p5.Vector.lerp")),n.lerp(t,r),n},s.default.Vector.mag=function(e){return e.mag()},s.default.Vector.magSq=function(e){return e.magSq()},s.default.Vector.normalize=function(e,t){return arguments.length<2?t=e.copy():(t instanceof s.default.Vector||s.default._friendlyError("The target parameter should be of type p5.Vector","p5.Vector.normalize"),t.set(e)),t.normalize()},s.default.Vector.limit=function(e,t,r){return arguments.length<3?r=e.copy():(r instanceof s.default.Vector||s.default._friendlyError("The target parameter should be of type p5.Vector","p5.Vector.limit"),r.set(e)),r.limit(t)},s.default.Vector.setMag=function(e,t,r){return arguments.length<3?r=e.copy():(r instanceof s.default.Vector||s.default._friendlyError("The target parameter should be of type p5.Vector","p5.Vector.setMag"),r.set(e)),r.setMag(t)},s.default.Vector.heading=function(e){return e.heading()},s.default.Vector.angleBetween=function(e,t){return e.angleBetween(t)},s.default.Vector.reflect=function(e,t,r){return arguments.length<3?r=e.copy():(r instanceof s.default.Vector||s.default._friendlyError("The target parameter should be of type p5.Vector","p5.Vector.reflect"),r.set(e)),r.reflect(t)},s.default.Vector.array=function(e){return e.array()},s.default.Vector.equals=function(e,t){var r;return e instanceof s.default.Vector?r=e:e instanceof Array?r=(new s.default.Vector).set(e):s.default._friendlyError("The v1 parameter should be of type Array or p5.Vector","p5.Vector.equals"),r.equals(t)};var u=s.default.Vector;r.default=u},{"../core/constants":256,"../core/main":267,"core-js/modules/es.array.concat":149,"core-js/modules/es.array.every":151,"core-js/modules/es.array.iterator":158,"core-js/modules/es.array.slice":162,"core-js/modules/es.array.some":163,"core-js/modules/es.math.sign":168,"core-js/modules/es.number.constructor":169,"core-js/modules/es.number.is-finite":170,"core-js/modules/es.object.get-own-property-descriptor":173,"core-js/modules/es.object.to-string":177,"core-js/modules/es.regexp.to-string":182,"core-js/modules/es.string.iterator":186,"core-js/modules/es.string.sub":192,"core-js/modules/es.symbol":196,"core-js/modules/es.symbol.description":194,"core-js/modules/es.symbol.iterator":195,"core-js/modules/es.weak-map":228,"core-js/modules/web.dom-collections.iterator":230}],301:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n=(e=e("../core/main"))&&e.__esModule?e:{default:e},i="_lcg_random_state",s=4294967296,o=0;n.default.prototype._lcg=function(e){return this[e]=(1664525*this[e]+1013904223)%s,this[e]/s},n.default.prototype._lcgSetSeed=function(e,t){this[e]=(null==t?Math.random()*s:t)>>>0},n.default.prototype.randomSeed=function(e){this._lcgSetSeed(i,e),this._gaussian_previous=!1},n.default.prototype.random=function(e,t){var r,s;return n.default._validateParameters("random",arguments),r=null!=this[i]?this._lcg(i):Math.random(),void 0===e?r:void 0===t?e instanceof Array?e[Math.floor(r*e.length)]:r*e:(t<e&&(s=e,e=t,t=s),r*(t-e)+e)},n.default.prototype.randomGaussian=function(e){var t,r,n,i,s=1<arguments.length&&void 0!==arguments[1]?arguments[1]:1;if(this._gaussian_previous)t=o,this._gaussian_previous=!1;else{for(;1<=(i=(r=this.random(2)-1)*r+(n=this.random(2)-1)*n););t=r*(i=Math.sqrt(-2*Math.log(i)/i)),o=n*i,this._gaussian_previous=!0}return t*s+(e||0)},e=n.default;r.default=e},{"../core/main":267}],302:[function(e,t,r){"use strict";function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function i(e){return(i="function"==typeof Symbol&&"symbol"===n(Symbol.iterator)?function(e){return n(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":n(e)})(e)}e("core-js/modules/es.symbol"),e("core-js/modules/es.symbol.description"),e("core-js/modules/es.symbol.iterator"),e("core-js/modules/es.array.iterator"),e("core-js/modules/es.object.get-own-property-descriptor"),e("core-js/modules/es.object.to-string"),e("core-js/modules/es.string.iterator"),e("core-js/modules/es.weak-map"),e("core-js/modules/web.dom-collections.iterator"),Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var s=(l=e("../core/main"))&&l.__esModule?l:{default:l},o=function(e){if(e&&e.__esModule)return e;if(null===e||"object"!==i(e)&&"function"!=typeof e)return{default:e};var t=a();if(t&&t.has(e))return t.get(e);var r,n={},s=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(r in e){var o;Object.prototype.hasOwnProperty.call(e,r)&&((o=s?Object.getOwnPropertyDescriptor(e,r):null)&&(o.get||o.set)?Object.defineProperty(n,r,o):n[r]=e[r])}return n.default=e,t&&t.set(e,n),n}(e("../core/constants"));function a(){var e;return"function"!=typeof WeakMap?null:(e=new WeakMap,a=function(){return e},e)}s.default.prototype._angleMode=o.RADIANS,s.default.prototype.acos=function(e){return this._fromRadians(Math.acos(e))},s.default.prototype.asin=function(e){return this._fromRadians(Math.asin(e))},s.default.prototype.atan=function(e){return this._fromRadians(Math.atan(e))},s.default.prototype.atan2=function(e,t){return this._fromRadians(Math.atan2(e,t))},s.default.prototype.cos=function(e){return Math.cos(this._toRadians(e))},s.default.prototype.sin=function(e){return Math.sin(this._toRadians(e))},s.default.prototype.tan=function(e){return Math.tan(this._toRadians(e))},s.default.prototype.degrees=function(e){return e*o.RAD_TO_DEG},s.default.prototype.radians=function(e){return e*o.DEG_TO_RAD},s.default.prototype.angleMode=function(e){if(s.default._validateParameters("angleMode",arguments),void 0===e)return this._angleMode;e!==o.DEGREES&&e!==o.RADIANS||(this._angleMode=e)},s.default.prototype._toRadians=function(e){return this._angleMode===o.DEGREES?e*o.DEG_TO_RAD:e},s.default.prototype._toDegrees=function(e){return this._angleMode===o.RADIANS?e*o.RAD_TO_DEG:e},s.default.prototype._fromRadians=function(e){return this._angleMode===o.DEGREES?e*o.RAD_TO_DEG:e};var l=s.default;r.default=l},{"../core/constants":256,"../core/main":267,"core-js/modules/es.array.iterator":158,"core-js/modules/es.object.get-own-property-descriptor":173,"core-js/modules/es.object.to-string":177,"core-js/modules/es.string.iterator":186,"core-js/modules/es.symbol":196,"core-js/modules/es.symbol.description":194,"core-js/modules/es.symbol.iterator":195,"core-js/modules/es.weak-map":228,"core-js/modules/web.dom-collections.iterator":230}],303:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n=(e=e("../core/main"))&&e.__esModule?e:{default:e};n.default.prototype.textAlign=function(e,t){var r;return n.default._validateParameters("textAlign",arguments),(r=this._renderer).textAlign.apply(r,arguments)},n.default.prototype.textLeading=function(e){var t;return n.default._validateParameters("textLeading",arguments),(t=this._renderer).textLeading.apply(t,arguments)},n.default.prototype.textSize=function(e){var t;return n.default._validateParameters("textSize",arguments),(t=this._renderer).textSize.apply(t,arguments)},n.default.prototype.textStyle=function(e){var t;return n.default._validateParameters("textStyle",arguments),(t=this._renderer).textStyle.apply(t,arguments)},n.default.prototype.textWidth=function(){for(var e,t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];return r[0]+="",n.default._validateParameters("textWidth",r),0===r[0].length?0:(e=this._renderer).textWidth.apply(e,r)},n.default.prototype.textAscent=function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return n.default._validateParameters("textAscent",t),this._renderer.textAscent()},n.default.prototype.textDescent=function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return n.default._validateParameters("textDescent",t),this._renderer.textDescent()},n.default.prototype._updateTextMetrics=function(){return this._renderer._updateTextMetrics()},n.default.prototype.textWrap=function(e){if("WORD"!==e&&"CHAR"!==e)throw"Error: textWrap accepts only WORD or CHAR";return this._renderer.textWrap(e)},e=n.default,r.default=e},{"../core/main":267}],304:[function(e,t,r){"use strict";function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function i(e){return(i="function"==typeof Symbol&&"symbol"===n(Symbol.iterator)?function(e){return n(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":n(e)})(e)}e("core-js/modules/es.symbol"),e("core-js/modules/es.symbol.description"),e("core-js/modules/es.symbol.iterator"),e("core-js/modules/es.array.concat"),e("core-js/modules/es.array.includes"),e("core-js/modules/es.array.iterator"),e("core-js/modules/es.array.last-index-of"),e("core-js/modules/es.array.slice"),e("core-js/modules/es.object.get-own-property-descriptor"),e("core-js/modules/es.object.to-string"),e("core-js/modules/es.regexp.exec"),e("core-js/modules/es.string.iterator"),e("core-js/modules/es.string.split"),e("core-js/modules/es.weak-map"),e("core-js/modules/web.dom-collections.iterator"),e("core-js/modules/es.array.concat"),e("core-js/modules/es.array.includes"),e("core-js/modules/es.array.last-index-of"),e("core-js/modules/es.array.slice"),e("core-js/modules/es.regexp.exec"),e("core-js/modules/es.string.split"),Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var s=(u=e("../core/main"))&&u.__esModule?u:{default:u},o=c(e("../core/constants")),a=c(e("opentype.js"));function l(){var e;return"function"!=typeof WeakMap?null:(e=new WeakMap,l=function(){return e},e)}function c(e){if(e&&e.__esModule)return e;if(null===e||"object"!==i(e)&&"function"!=typeof e)return{default:e};var t=l();if(t&&t.has(e))return t.get(e);var r,n,s={},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(r in e)Object.prototype.hasOwnProperty.call(e,r)&&((n=o?Object.getOwnPropertyDescriptor(e,r):null)&&(n.get||n.set)?Object.defineProperty(s,r,n):s[r]=e[r]);return s.default=e,t&&t.set(e,s),s}e("../core/friendly_errors/validate_params"),e("../core/friendly_errors/file_errors"),e("../core/friendly_errors/fes_core"),s.default.prototype.loadFont=function(e,t,r){s.default._validateParameters("loadFont",arguments);var n=new s.default.Font(this),i=this;return a.load(e,(function(o,a){if(o)return s.default._friendlyFileLoadError(4,e),void 0!==r?r(o):void 0;n.font=a,void 0!==t&&t(n),i._decrementPreload();var l=(a=(o=e.split("\\").pop().split("/").pop()).lastIndexOf("."))<1?null:o.slice(a+1);["ttf","otf","woff","woff2"].includes(l)&&(l=o.slice(0,-1!==a?a:0),(o=document.createElement("style")).appendChild(document.createTextNode("\n@font-face {\nfont-family: ".concat(l,";\nsrc: url(").concat(e,");\n}\n"))),document.head.appendChild(o))})),n},s.default.prototype.text=function(e,t,r,n,i){var o;return s.default._validateParameters("text",arguments),this._renderer._doFill||this._renderer._doStroke?(o=this._renderer).text.apply(o,arguments):this},s.default.prototype.textFont=function(e,t){if(s.default._validateParameters("textFont",arguments),arguments.length){if(e)return this._renderer._setProperty("_textFont",e),t&&(this._renderer._setProperty("_textSize",t),this._renderer._leadingSet||this._renderer._setProperty("_textLeading",t*o._DEFAULT_LEADMULT)),this._renderer._applyTextProperties();throw new Error("null font passed to textFont")}return this._renderer._textFont};var u=s.default;r.default=u},{"../core/constants":256,"../core/friendly_errors/fes_core":258,"../core/friendly_errors/file_errors":259,"../core/friendly_errors/validate_params":262,"../core/main":267,"core-js/modules/es.array.concat":149,"core-js/modules/es.array.includes":156,"core-js/modules/es.array.iterator":158,"core-js/modules/es.array.last-index-of":160,"core-js/modules/es.array.slice":162,"core-js/modules/es.object.get-own-property-descriptor":173,"core-js/modules/es.object.to-string":177,"core-js/modules/es.regexp.exec":181,"core-js/modules/es.string.iterator":186,"core-js/modules/es.string.split":191,"core-js/modules/es.symbol":196,"core-js/modules/es.symbol.description":194,"core-js/modules/es.symbol.iterator":195,"core-js/modules/es.weak-map":228,"core-js/modules/web.dom-collections.iterator":230,"opentype.js":241}],305:[function(e,t,r){"use strict";function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}e("core-js/modules/es.symbol"),e("core-js/modules/es.symbol.description"),e("core-js/modules/es.symbol.iterator"),e("core-js/modules/es.array.concat"),e("core-js/modules/es.array.fill"),e("core-js/modules/es.array.iterator"),e("core-js/modules/es.array.join"),e("core-js/modules/es.array.slice"),e("core-js/modules/es.array.splice"),e("core-js/modules/es.function.name"),e("core-js/modules/es.number.to-fixed"),e("core-js/modules/es.object.get-own-property-descriptor"),e("core-js/modules/es.object.to-string"),e("core-js/modules/es.regexp.exec"),e("core-js/modules/es.string.iterator"),e("core-js/modules/es.string.split"),e("core-js/modules/es.weak-map"),e("core-js/modules/web.dom-collections.iterator"),e("core-js/modules/es.symbol"),e("core-js/modules/es.symbol.description"),e("core-js/modules/es.symbol.iterator"),e("core-js/modules/es.array.concat"),e("core-js/modules/es.array.fill"),e("core-js/modules/es.array.iterator"),e("core-js/modules/es.array.join"),e("core-js/modules/es.array.slice"),e("core-js/modules/es.array.splice"),e("core-js/modules/es.function.name"),e("core-js/modules/es.number.to-fixed"),e("core-js/modules/es.object.to-string"),e("core-js/modules/es.regexp.exec"),e("core-js/modules/es.string.iterator"),e("core-js/modules/es.string.split"),e("core-js/modules/web.dom-collections.iterator"),Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var i=(i=e("../core/main"))&&i.__esModule?i:{default:i},s=function(e){if(e&&e.__esModule)return e;if(null===e||"object"!==a(e)&&"function"!=typeof e)return{default:e};var t=o();if(t&&t.has(e))return t.get(e);var r,n={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(r in e){var s;Object.prototype.hasOwnProperty.call(e,r)&&((s=i?Object.getOwnPropertyDescriptor(e,r):null)&&(s.get||s.set)?Object.defineProperty(n,r,s):n[r]=e[r])}return n.default=e,t&&t.set(e,n),n}(e("../core/constants"));function o(){var e;return"function"!=typeof WeakMap?null:(e=new WeakMap,o=function(){return e},e)}function a(e){return(a="function"==typeof Symbol&&"symbol"===n(Symbol.iterator)?function(e){return n(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":n(e)})(e)}function l(e,t){var r=e.length;return e[t<0?t%r+r:t%r]}function c(e,t,r,n){var i,s,o;return n?(void 0===c.tmpPoint1&&(c.tmpPoint1=[],c.tmpPoint2=[]),s=c.tmpPoint1,o=c.tmpPoint2,s.x=t.x-e.x,s.y=t.y-e.y,o.x=r.x-t.x,o.y=r.y-t.y,i=s.x*o.x+s.y*o.y,s=Math.sqrt(s.x*s.x+s.y*s.y),o=Math.sqrt(o.x*o.x+o.y*o.y),Math.acos(i/(s*o))<n):0==(t[0]-e[0])*(r[1]-e[1])-(r[0]-e[0])*(t[1]-e[1])}function u(e,t,r,n,i,s,o,a,l){var c=1-l,u=(h=Math.pow(c,3))*e+3*(d=Math.pow(c,2))*l*r+3*c*l*l*i+(p=(m=l*l)*l)*o,h=h*t+3*d*l*n+3*c*l*l*s+p*a,d=e+2*l*(r-e)+m*(i-2*r+e),p=t+2*l*(n-t)+m*(s-2*n+t),f=r+2*l*(i-r)+m*(o-2*i+r),m=n+2*l*(s-n)+m*(a-2*s+n);e=c*e+l*r,r=c*t+l*n,t=c*i+l*o,n=c*s+l*a,i=90-180*Math.atan2(d-f,p-m)/Math.PI;return(f<d||p<m)&&(i+=180),{x:u,y:h,m:{x:d,y:p},n:{x:f,y:m},start:{x:e,y:r},end:{x:t,y:n},alpha:i}}function h(e,t,r,n,i,s,o,a,l){return null==l?v(e,t,r,n,i,s,o,a):u(e,t,r,n,i,s,o,a,function(e,t,r,n,i,s,o,a,l){if(!(l<0||v(e,t,r,n,i,s,o,a)<l)){var c,u=.5,h=1-u;for(c=v(e,t,r,n,i,s,o,a,h);.01<Math.abs(c-l);)c=v(e,t,r,n,i,s,o,a,h+=(c<l?1:-1)*(u/=2));return h}}(e,t,r,n,i,s,o,a,l))}function d(e,t,r){for(var n,i,s,o,a,l=0,c=0,d=(e=function(e,t){function r(e,t,r){var n,i;if(!e)return["C",t.x,t.y,t.x,t.y,t.x,t.y];switch(e[0]in{T:1,Q:1}||(t.qx=t.qy=null),e[0]){case"M":t.X=e[1],t.Y=e[2];break;case"A":e=["C"].concat(f.apply(0,[t.x,t.y].concat(e.slice(1))));break;case"S":i="C"===r||"S"===r?(n=2*t.x-t.bx,2*t.y-t.by):(n=t.x,t.y),e=["C",n,i].concat(e.slice(1));break;case"T":"Q"===r||"T"===r?(t.qx=2*t.x-t.qx,t.qy=2*t.y-t.qy):(t.qx=t.x,t.qy=t.y),e=["C"].concat(y(t.x,t.y,t.qx,t.qy,e[1],e[2]));break;case"Q":t.qx=e[1],t.qy=e[2],e=["C"].concat(y(t.x,t.y,e[1],e[2],e[3],e[4]));break;case"L":e=["C"].concat(g(t.x,t.y,e[1],e[2]));break;case"H":e=["C"].concat(g(t.x,t.y,e[1],t.y));break;case"V":e=["C"].concat(g(t.x,t.y,t.x,e[1]));break;case"Z":e=["C"].concat(g(t.x,t.y,t.X,t.Y))}return e}function n(e,t){if(7<e[t].length){e[t].shift();for(var r=e[t];r.length;)u[t]="A",a&&(h[t]="A"),e.splice(t++,0,["C"].concat(r.splice(0,6)));e.splice(t,1),s=Math.max(o.length,a&&a.length||0)}}function i(e,t,r,n,i){e&&t&&"M"===e[i][0]&&"M"!==t[i][0]&&(t.splice(i,0,["M",n.x,n.y]),r.bx=0,r.by=0,r.x=e[i][1],r.y=e[i][2],s=Math.max(o.length,a&&a.length||0))}var s,o=p(e),a=t,l={x:0,y:0,bx:0,by:0,X:0,Y:0,qx:null,qy:null},c={x:0,y:0,bx:0,by:0,X:0,Y:0,qx:null,qy:null},u=[],h=[],d="",m="";s=Math.max(o.length,a&&a.length||0);for(var v=0;v<s;v++){"C"!==(d=o[v]?o[v][0]:d)&&(u[v]=d,v&&(m=u[v-1])),o[v]=r(o[v],l,m),"A"!==u[v]&&"C"===d&&(u[v]="C"),n(o,v),a&&("C"!==(d=a[v]?a[v][0]:d)&&(h[v]=d,v&&(m=h[v-1])),a[v]=r(a[v],c,m),"A"!==h[v]&&"C"===d&&(h[v]="C"),n(a,v)),i(o,a,l,c,v),i(a,o,c,l,v);var _=o[v],x=a&&a[v],b=_.length,w=a&&x.length;l.x=_[b-2],l.y=_[b-1],l.bx=parseFloat(_[b-4])||l.x,l.by=parseFloat(_[b-3])||l.y,c.bx=a&&(parseFloat(x[w-4])||c.x),c.by=a&&(parseFloat(x[w-3])||c.y),c.x=a&&x[w-2],c.y=a&&x[w-1]}return a?[o,a]:o}(e)).length;c<d;c++){if("M"===(s=e[c])[0])n=+s[1],i=+s[2];else{if(t<l+(o=h(n,i,s[1],s[2],s[3],s[4],s[5],s[6]))&&!r)return{x:(a=h(n,i,s[1],s[2],s[3],s[4],s[5],s[6],t-l)).x,y:a.y,alpha:a.alpha};l+=o,n=+s[5],i=+s[6]}s.shift()}return(a=r?l:u(n,i,s[0],s[1],s[2],s[3],s[4],s[5],1)).alpha?{x:a.x,y:a.y,alpha:a.alpha}:a}function p(e){var t=[],r=0,n=0,i=0,s=0,o=0;if(e){"M"===e[0][0]&&(i=r=+e[0][1],s=n=+e[0][2],o++,t[0]=["M",r,n]);for(var a,l,c=3===e.length&&"M"===e[0][0]&&"R"===e[1][0].toUpperCase()&&"Z"===e[2][0].toUpperCase(),u=o,h=e.length;u<h;u++){if(t.push(a=[]),(l=e[u])[0]!==String.prototype.toUpperCase.call(l[0]))switch(a[0]=String.prototype.toUpperCase.call(l[0]),a[0]){case"A":a[1]=l[1],a[2]=l[2],a[3]=l[3],a[4]=l[4],a[5]=l[5],a[6]=+(l[6]+r),a[7]=+(l[7]+n);break;case"V":a[1]=+l[1]+n;break;case"H":a[1]=+l[1]+r;break;case"R":for(var d,p=2,f=(d=[r,n].concat(l.slice(1))).length;p<f;p++)d[p]=+d[p]+r,d[++p]=+d[p]+n;t.pop(),t=t.concat(m(d,c));break;case"M":i=+l[1]+r,s=+l[2]+n;break;default:for(var g=1,y=l.length;g<y;g++)a[g]=+l[g]+(g%2?r:n)}else if("R"===l[0])d=[r,n].concat(l.slice(1)),t.pop(),t=t.concat(m(d,c)),a=["R"].concat(l.slice(-2));else for(var v=0,_=l.length;v<_;v++)a[v]=l[v];switch(a[0]){case"Z":r=i,n=s;break;case"H":r=a[1];break;case"V":n=a[1];break;case"M":i=a[a.length-2],s=a[a.length-1];break;default:r=a[a.length-2],n=a[a.length-1]}}}return t}function f(e,t,r,n,i,s,o,a,l,c){function u(e,t,r){return{x:e*Math.cos(r)-t*Math.sin(r),y:e*Math.sin(r)+t*Math.cos(r)}}var h,d=120*(v=Math.PI)/180,p=v/180*(+i||0),m=[],g=(c?(S=c[0],h=c[1],b=c[2],w=c[3]):(e=(_=u(e,t,-p)).x,t=_.y,1<(g=(y=(e-(a=(_=u(a,l,-p)).x))/2)*y/(r*r)+(_=(t-(l=_.y))/2)*_/(n*n))&&(r*=g=Math.sqrt(g),n*=g),g=r*r,x=n*n,b=(s=(s===o?-1:1)*Math.sqrt(Math.abs((g*x-g*_*_-x*y*y)/(g*_*_+x*y*y))))*r*_/n+(e+a)/2,w=s*-n*y/r+(t+l)/2,S=Math.asin(((t-w)/n).toFixed(9)),h=Math.asin(((l-w)/n).toFixed(9)),(S=e<b?v-S:S)<0&&(S=2*v+S),(h=a<b?v-h:h)<0&&(h=2*v+h),o&&h<S&&(S-=2*v),!o&&S<h&&(h-=2*v)),h-S),y=(Math.abs(g)>d&&(x=h,_=a,s=l,h=S+d*(o&&S<h?1:-1),m=f(a=b+r*Math.cos(h),l=w+n*Math.sin(h),r,n,i,0,o,_,s,[h,x,b,w])),g=h-S,Math.cos(S)),v=Math.sin(S),_=(d=Math.cos(h),i=Math.sin(h),4/3*r*(o=Math.tan(g/4))),x=[e,t],b=[e+_*v,t-(s=4/3*n*o)*y],w=[a+_*i,l-s*d],S=[a,l];if(b[0]=2*x[0]-b[0],b[1]=2*x[1]-b[1],c)return[b,w,S].concat(m);for(var M=[],T=0,E=(m=[b,w,S].concat(m).join().split(",")).length;T<E;T++)M[T]=T%2?u(m[T-1],m[T],p).y:u(m[T],m[T+1],p).x;return M}function m(e,t){for(var r=[],n=0,i=e.length;n<i-2*!t;n+=2){var s=[{x:+e[n-2],y:+e[n-1]},{x:+e[n],y:+e[n+1]},{x:+e[n+2],y:+e[n+3]},{x:+e[n+4],y:+e[n+5]}];t?n?i-4===n?s[3]={x:+e[0],y:+e[1]}:i-2===n&&(s[2]={x:+e[0],y:+e[1]},s[3]={x:+e[2],y:+e[3]}):s[0]={x:+e[i-2],y:+e[i-1]}:i-4===n?s[3]=s[2]:n||(s[0]={x:+e[n],y:+e[n+1]}),r.push(["C",(-s[0].x+6*s[1].x+s[2].x)/6,(-s[0].y+6*s[1].y+s[2].y)/6,(s[1].x+6*s[2].x-s[3].x)/6,(s[1].y+6*s[2].y-s[3].y)/6,s[2].x,s[2].y])}return r}function g(e,t,r,n){return[e,t,r,n,r,n]}function y(e,t,r,n,i,s){return[1/3*e+2/3*r,1/3*t+2/3*n,1/3*i+2/3*r,1/3*s+2/3*n,i,s]}function v(e,t,r,n,i,s,o,a,l){for(var c=(l=1<(l=null==l?1:l)?1:l<0?0:l)/2,u=[-.1252,.1252,-.3678,.3678,-.5873,.5873,-.7699,.7699,-.9041,.9041,-.9816,.9816],h=0,d=[.2491,.2491,.2335,.2335,.2032,.2032,.1601,.1601,.1069,.1069,.0472,.0472],p=0;p<12;p++){var f=_(m=c*u[p]+c,e,r,i,o),m=_(m,t,n,s,a);h+=d[p]*Math.sqrt(f*f+m*m)}return c*h}function _(e,t,r,n,i){return e*(e*(-3*t+9*r-9*n+3*i)+6*t-12*r+6*n)-3*t+3*r}i.default.Font=function(e){this.parent=e,this.cache={},this.font=void 0},i.default.Font.prototype.textBounds=function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0,r=2<arguments.length&&void 0!==arguments[2]?arguments[2]:0,n=3<arguments.length?arguments[3]:void 0,i=4<arguments.length?arguments[4]:void 0,o=i&&i.renderer&&i.renderer._pInst||this.parent;(y=o._renderer.drawingContext).textAlign||s.LEFT,y.textBaseline||s.BASELINE,n=n||o._renderer._textSize;if(!v){for(var a=[],l=[],c=[],u=(c[0]=[],[]),h=this._scale(n),d=o._renderer.textLeading(),p=0,f=(this.font.forEachGlyph(e,t,r,n,i,(function(e,t,r,n){var i=e.getMetrics();0===e.index||10===e.index?c[p+=1]=[]:(c[p].push(t+i.xMin*h),c[p].push(t+i.xMax*h),u.push(r+p*d+-i.yMin*h),u.push(r+p*d+-i.yMax*h))})),0<c[p].length&&(a[p]=Math.min.apply(null,c[p]),l[p]=Math.max.apply(null,c[p])),0),m=0;m<=p;m++){a[m]=Math.min.apply(null,c[m]),l[m]=Math.max.apply(null,c[m]);var g=l[m]-a[m];f<g&&(f=g)}var y,v={x:y=Math.min.apply(null,a),y:r=Math.min.apply(null,u),h:Math.max.apply(null,u)-r,w:f,advance:y-t};n=this._handleAlignment(o._renderer,e,v.x,v.y,v.w+v.advance);v.x=n.x,v.y=n.y}return v},i.default.Font.prototype.textToPoints=function(e,t,r,n,i){var s=0,o=[],u=this._getGlyphs(e);n=n||this.parent._renderer._textSize;for(var h,p=0;p<u.length;p++){if(!(u[h=p].name&&"space"===u[h].name||e.length===u.length&&" "===e[h]))for(var f=function(e){for(var t,r=[],n=0;n<e.length;n++)"M"===e[n].type&&(t&&r.push(t),t=[]),t.push(function(e){var t=[e.type];return"M"===e.type||"L"===e.type?t.push(e.x,e.y):"C"===e.type?t.push(e.x1,e.y1,e.x2,e.y2,e.x,e.y):"Q"===e.type&&t.push(e.x1,e.y1,e.x,e.y),t}(e[n]));return r.push(t),r}(u[p].getPath(t,r,n).commands),m=0;m<f.length;m++)for(var g=function(e,t){t=function(e,t){if("object"!==a(e))e=t;else for(var r in t)void 0===e[r]&&(e[r]=t[r]);return e}(t,{sampleFactor:.1,simplifyThreshold:0});for(var r=d(e,0,1),n=r/(r*t.sampleFactor),i=[],s=0;s<r;s+=n)i.push(d(e,s));return t.simplifyThreshold&&function(e){for(var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0,r=e.length-1;3<e.length&&0<=r;--r)c(l(e,r-1),l(e,r),l(e,r+1),t)&&(e.splice(r%e.length,1))}(i,t.simplifyThreshold),i}(f[m],i),y=0;y<g.length;y++)g[y].x+=s,o.push(g[y]);s+=u[p].advanceWidth*this._scale(n)}return o},i.default.Font.prototype._getGlyphs=function(e){return this.font.stringToGlyphs(e)},i.default.Font.prototype._getPath=function(e,t,r,n){var i=(n&&n.renderer&&n.renderer._pInst||this.parent)._renderer;t=this._handleAlignment(i,e,t,r);return this.font.getPath(e,t.x,t.y,i._textSize,n)},i.default.Font.prototype._getPathData=function(e,t,r,n){var i=3;return"string"==typeof e&&2<arguments.length?e=this._getPath(e,t,r,n):"object"===a(t)&&(n=t),n&&"number"==typeof n.decimals&&(i=n.decimals),e.toPathData(i)},i.default.Font.prototype._getSVG=function(e,t,r,n){var i=3;return"string"==typeof e&&2<arguments.length?e=this._getPath(e,t,r,n):"object"===a(t)&&(n=t),n&&("number"==typeof n.decimals&&(i=n.decimals),"number"==typeof n.strokeWidth&&(e.strokeWidth=n.strokeWidth),void 0!==n.fill&&(e.fill=n.fill),void 0!==n.stroke&&(e.stroke=n.stroke)),e.toSVG(i)},i.default.Font.prototype._renderPath=function(e,t,r,n){var i=n&&n.renderer||this.parent._renderer,o=i.drawingContext,l=(e=("object"===a(e)&&e.commands?e:this._getPath(e,t,r,n)).commands,o.beginPath(),!0);t=!1,r=void 0;try{for(var c,u=e[Symbol.iterator]();!(l=(c=u.next()).done);l=!0){var h=c.value;"M"===h.type?o.moveTo(h.x,h.y):"L"===h.type?o.lineTo(h.x,h.y):"C"===h.type?o.bezierCurveTo(h.x1,h.y1,h.x2,h.y2,h.x,h.y):"Q"===h.type?o.quadraticCurveTo(h.x1,h.y1,h.x,h.y):"Z"===h.type&&o.closePath()}}catch(e){t=!0,r=e}finally{try{l||null==u.return||u.return()}finally{if(t)throw r}}return i._doStroke&&i._strokeSet&&o.stroke(),i._doFill&&(i._fillSet||i._setFill(s._DEFAULT_TEXT_FILL),o.fill()),this},i.default.Font.prototype._textWidth=function(e,t){return this.font.getAdvanceWidth(e,t)},i.default.Font.prototype._textAscent=function(e){return this.font.ascender*this._scale(e)},i.default.Font.prototype._textDescent=function(e){return-this.font.descender*this._scale(e)},i.default.Font.prototype._scale=function(e){return 1/this.font.unitsPerEm*(e||this.parent._renderer._textSize)},i.default.Font.prototype._handleAlignment=function(e,t,r,n,i){var o=e._textSize;switch(void 0===i&&(i=this._textWidth(t,o)),e._textAlign){case s.CENTER:r-=i/2;break;case s.RIGHT:r-=i}switch(e._textBaseline){case s.TOP:n+=this._textAscent(o);break;case s.CENTER:n+=this._textAscent(o)/2;break;case s.BOTTOM:n-=this._textDescent(o)}return{x:r,y:n}},e=i.default,r.default=e},{"../core/constants":256,"../core/main":267,"core-js/modules/es.array.concat":149,"core-js/modules/es.array.fill":152,"core-js/modules/es.array.iterator":158,"core-js/modules/es.array.join":159,"core-js/modules/es.array.slice":162,"core-js/modules/es.array.splice":164,"core-js/modules/es.function.name":165,"core-js/modules/es.number.to-fixed":171,"core-js/modules/es.object.get-own-property-descriptor":173,"core-js/modules/es.object.to-string":177,"core-js/modules/es.regexp.exec":181,"core-js/modules/es.string.iterator":186,"core-js/modules/es.string.split":191,"core-js/modules/es.symbol":196,"core-js/modules/es.symbol.description":194,"core-js/modules/es.symbol.iterator":195,"core-js/modules/es.weak-map":228,"core-js/modules/web.dom-collections.iterator":230}],306:[function(e,t,r){"use strict";e("core-js/modules/es.array.concat"),e("core-js/modules/es.array.slice"),e("core-js/modules/es.array.splice"),e("core-js/modules/es.array-buffer.constructor"),e("core-js/modules/es.object.to-string"),e("core-js/modules/es.array.concat"),e("core-js/modules/es.array.slice"),e("core-js/modules/es.array.splice"),e("core-js/modules/es.array-buffer.constructor"),e("core-js/modules/es.object.to-string"),Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0,(e=(e=e("../core/main"))&&e.__esModule?e:{default:e}).default.prototype.append=function(e,t){return e.push(t),e},e.default.prototype.arrayCopy=function(e,t,r,n,i){var s,o;e=void 0!==i?(o=Math.min(i,e.length),s=n,e.slice(t,o+t)):(o=void 0!==r?(o=r,Math.min(o,e.length)):e.length,r=t,e.slice(s=0,o)),Array.prototype.splice.apply(r,[s,o].concat(e))},e.default.prototype.concat=function(e,t){return e.concat(t)},e.default.prototype.reverse=function(e){return e.reverse()},e.default.prototype.shorten=function(e){return e.pop(),e},e.default.prototype.shuffle=function(e,t){for(var r,n,i=ArrayBuffer&&ArrayBuffer.isView&&ArrayBuffer.isView(e),s=(e=t||i?e:e.slice()).length;1<s;)r=this.random(0,1)*s|0,n=e[--s],e[s]=e[r],e[r]=n;return e},e.default.prototype.sort=function(e,t){var r=t?e.slice(0,Math.min(t,e.length)):e;t=t?e.slice(Math.min(t,e.length)):[];return(r="string"==typeof r[0]?r.sort():r.sort((function(e,t){return e-t}))).concat(t)},e.default.prototype.splice=function(e,t,r){return Array.prototype.splice.apply(e,[r,0].concat(t)),e},e.default.prototype.subset=function(e,t,r){return void 0!==r?e.slice(t,t+r):e.slice(t,e.length)},e=e.default,r.default=e},{"../core/main":267,"core-js/modules/es.array-buffer.constructor":148,"core-js/modules/es.array.concat":149,"core-js/modules/es.array.slice":162,"core-js/modules/es.array.splice":164,"core-js/modules/es.object.to-string":177}],307:[function(e,t,r){"use strict";e("core-js/modules/es.array.map"),e("core-js/modules/es.number.constructor"),e("core-js/modules/es.object.to-string"),e("core-js/modules/es.regexp.to-string"),e("core-js/modules/es.string.repeat"),e("core-js/modules/es.array.map"),e("core-js/modules/es.number.constructor"),e("core-js/modules/es.object.to-string"),e("core-js/modules/es.regexp.to-string"),e("core-js/modules/es.string.repeat"),Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n=(e=e("../core/main"))&&e.__esModule?e:{default:e};n.default.prototype.float=function(e){return e instanceof Array?e.map(parseFloat):parseFloat(e)},n.default.prototype.int=function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:10;return e===1/0||"Infinity"===e?1/0:e===-1/0||"-Infinity"===e?-1/0:"string"==typeof e?parseInt(e,t):"number"==typeof e?0|e:"boolean"==typeof e?e?1:0:e instanceof Array?e.map((function(e){return n.default.prototype.int(e,t)})):void 0},n.default.prototype.str=function(e){return e instanceof Array?e.map(n.default.prototype.str):String(e)},n.default.prototype.boolean=function(e){return"number"==typeof e?0!==e:"string"==typeof e?"true"===e.toLowerCase():"boolean"==typeof e?e:e instanceof Array?e.map(n.default.prototype.boolean):void 0},n.default.prototype.byte=function(e){return"number"==typeof(e=n.default.prototype.int(e,10))?(e+128)%256-128:e instanceof Array?e.map(n.default.prototype.byte):void 0},n.default.prototype.char=function(e){return"number"!=typeof e||isNaN(e)?e instanceof Array?e.map(n.default.prototype.char):"string"==typeof e?n.default.prototype.char(parseInt(e,10)):void 0:String.fromCharCode(e)},n.default.prototype.unchar=function(e){return"string"==typeof e&&1===e.length?e.charCodeAt(0):e instanceof Array?e.map(n.default.prototype.unchar):void 0},n.default.prototype.hex=function(e,t){if(t=null==t?8:t,e instanceof Array)return e.map((function(e){return n.default.prototype.hex(e,t)}));if(e===1/0||e===-1/0)return(e===1/0?"F":"0").repeat(t);if("number"==typeof e){e<0&&(e=4294967295+e+1);for(var r=Number(e).toString(16).toUpperCase();r.length<t;)r="0".concat(r);return r.length>=t?r.substring(r.length-t,r.length):r}},n.default.prototype.unhex=function(e){return e instanceof Array?e.map(n.default.prototype.unhex):parseInt("0x".concat(e),16)},e=n.default,r.default=e},{"../core/main":267,"core-js/modules/es.array.map":161,"core-js/modules/es.number.constructor":169,"core-js/modules/es.object.to-string":177,"core-js/modules/es.regexp.to-string":182,"core-js/modules/es.string.repeat":188}],308:[function(e,t,r){"use strict";e("core-js/modules/es.array.filter"),e("core-js/modules/es.array.index-of"),e("core-js/modules/es.array.join"),e("core-js/modules/es.array.map"),e("core-js/modules/es.array.slice"),e("core-js/modules/es.object.to-string"),e("core-js/modules/es.regexp.constructor"),e("core-js/modules/es.regexp.exec"),e("core-js/modules/es.regexp.to-string"),e("core-js/modules/es.string.match"),e("core-js/modules/es.string.replace"),e("core-js/modules/es.string.split"),e("core-js/modules/es.string.trim"),e("core-js/modules/es.array.filter"),e("core-js/modules/es.array.index-of"),e("core-js/modules/es.array.join"),e("core-js/modules/es.array.map"),e("core-js/modules/es.array.slice"),e("core-js/modules/es.object.to-string"),e("core-js/modules/es.regexp.constructor"),e("core-js/modules/es.regexp.exec"),e("core-js/modules/es.regexp.to-string"),e("core-js/modules/es.string.match"),e("core-js/modules/es.string.replace"),e("core-js/modules/es.string.split"),e("core-js/modules/es.string.trim"),Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n=(l=e("../core/main"))&&l.__esModule?l:{default:l};function i(e,t,r){var n=e<0,i=(e=n?e.toString().substring(1):e.toString()).indexOf("."),s=-1!==i?e.substring(0,i):e,o=-1!==i?e.substring(i+1):"",a=n?"-":"";if(void 0!==r){n="",(-1!==i||0<r-o.length)&&(n="."),o.length>r&&(o=o.substring(0,r));for(var l=0;l<t-s.length;l++)a+="0";a=(a+=s)+n+o;for(var c=0;c<r-o.length;c++)a+="0";return a}for(var u=0;u<Math.max(t-s.length,0);u++)a+="0";return a+e}function s(e,t){var r=(e=e.toString()).indexOf("."),n=-1!==r?e.substring(r):"";e=(e=-1!==r?e.substring(0,r):e).toString().replace(/\B(?=(\d{3})+(?!\d))/g,",");if(0===t)n="";else if(void 0!==t)if(t>n.length)for(var i=t-(n+=-1===r?".":"").length+1,s=0;s<i;s++)n+="0";else n=n.substring(0,t+1);return e+n}function o(e){return 0<parseFloat(e)?"+".concat(e.toString()):e.toString()}function a(e){return 0<=parseFloat(e)?" ".concat(e.toString()):e.toString()}e("../core/friendly_errors/validate_params"),e("../core/friendly_errors/file_errors"),e("../core/friendly_errors/fes_core"),n.default.prototype.join=function(e,t){return n.default._validateParameters("join",arguments),e.join(t)},n.default.prototype.match=function(e,t){return n.default._validateParameters("match",arguments),e.match(t)},n.default.prototype.matchAll=function(e,t){n.default._validateParameters("matchAll",arguments);for(var r=new RegExp(t,"g"),i=r.exec(e),s=[];null!==i;)s.push(i),i=r.exec(e);return s},n.default.prototype.nf=function(e,t,r){return n.default._validateParameters("nf",arguments),e instanceof Array?e.map((function(e){return i(e,t,r)})):"[object Arguments]"===Object.prototype.toString.call(e)?3===e.length?this.nf(e[0],e[1],e[2]):2===e.length?this.nf(e[0],e[1]):this.nf(e[0]):i(e,t,r)},n.default.prototype.nfc=function(e,t){return n.default._validateParameters("nfc",arguments),e instanceof Array?e.map((function(e){return s(e,t)})):s(e,t)},n.default.prototype.nfp=function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];n.default._validateParameters("nfp",t);var i=n.default.prototype.nf.apply(this,t);return i instanceof Array?i.map(o):o(i)},n.default.prototype.nfs=function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];n.default._validateParameters("nfs",t);var i=n.default.prototype.nf.apply(this,t);return i instanceof Array?i.map(a):a(i)},n.default.prototype.split=function(e,t){return n.default._validateParameters("split",arguments),e.split(t)},n.default.prototype.splitTokens=function(e,t){var r,i;return n.default._validateParameters("splitTokens",arguments),i=void 0!==t?(i=/\]/g.exec(t),(r=/\[/g.exec(t))&&i?(t=t.slice(0,i.index)+t.slice(i.index+1),r=/\[/g.exec(t),t=t.slice(0,r.index)+t.slice(r.index+1),new RegExp("[\\[".concat(t,"\\]]"),"g")):i?(t=t.slice(0,i.index)+t.slice(i.index+1),new RegExp("[".concat(t,"\\]]"),"g")):r?(t=t.slice(0,r.index)+t.slice(r.index+1),new RegExp("[".concat(t,"\\[]"),"g")):new RegExp("[".concat(t,"]"),"g")):/\s/g,e.split(i).filter((function(e){return e}))},n.default.prototype.trim=function(e){return n.default._validateParameters("trim",arguments),e instanceof Array?e.map(this.trim):e.trim()};var l=n.default;r.default=l},{"../core/friendly_errors/fes_core":258,"../core/friendly_errors/file_errors":259,"../core/friendly_errors/validate_params":262,"../core/main":267,"core-js/modules/es.array.filter":153,"core-js/modules/es.array.index-of":157,"core-js/modules/es.array.join":159,"core-js/modules/es.array.map":161,"core-js/modules/es.array.slice":162,"core-js/modules/es.object.to-string":177,"core-js/modules/es.regexp.constructor":180,"core-js/modules/es.regexp.exec":181,"core-js/modules/es.regexp.to-string":182,"core-js/modules/es.string.match":187,"core-js/modules/es.string.replace":189,"core-js/modules/es.string.split":191,"core-js/modules/es.string.trim":193}],309:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0,(e=(e=e("../core/main"))&&e.__esModule?e:{default:e}).default.prototype.day=function(){return(new Date).getDate()},e.default.prototype.hour=function(){return(new Date).getHours()},e.default.prototype.minute=function(){return(new Date).getMinutes()},e.default.prototype.millis=function(){return-1===this._millisStart?0:window.performance.now()-this._millisStart},e.default.prototype.month=function(){return(new Date).getMonth()+1},e.default.prototype.second=function(){return(new Date).getSeconds()},e.default.prototype.year=function(){return(new Date).getFullYear()},e=e.default,r.default=e},{"../core/main":267}],310:[function(e,t,r){"use strict";function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function i(e){return(i="function"==typeof Symbol&&"symbol"===n(Symbol.iterator)?function(e){return n(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":n(e)})(e)}e("core-js/modules/es.symbol"),e("core-js/modules/es.symbol.description"),e("core-js/modules/es.symbol.iterator"),e("core-js/modules/es.array.concat"),e("core-js/modules/es.array.iterator"),e("core-js/modules/es.array.slice"),e("core-js/modules/es.math.hypot"),e("core-js/modules/es.number.to-fixed"),e("core-js/modules/es.object.get-own-property-descriptor"),e("core-js/modules/es.object.to-string"),e("core-js/modules/es.string.iterator"),e("core-js/modules/es.weak-map"),e("core-js/modules/web.dom-collections.iterator"),e("core-js/modules/es.symbol"),e("core-js/modules/es.symbol.description"),e("core-js/modules/es.symbol.iterator"),e("core-js/modules/es.array.concat"),e("core-js/modules/es.array.iterator"),e("core-js/modules/es.array.slice"),e("core-js/modules/es.math.hypot"),e("core-js/modules/es.number.to-fixed"),e("core-js/modules/es.object.to-string"),e("core-js/modules/es.string.iterator"),e("core-js/modules/web.dom-collections.iterator"),Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var s=(c=e("../core/main"))&&c.__esModule?c:{default:c},o=(e("./p5.Geometry"),function(e){if(e&&e.__esModule)return e;if(null===e||"object"!==i(e)&&"function"!=typeof e)return{default:e};var t=a();if(t&&t.has(e))return t.get(e);var r,n={},s=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(r in e){var o;Object.prototype.hasOwnProperty.call(e,r)&&((o=s?Object.getOwnPropertyDescriptor(e,r):null)&&(o.get||o.set)?Object.defineProperty(n,r,o):n[r]=e[r])}return n.default=e,t&&t.set(e,n),n}(e("../core/constants")));function a(){var e;return"function"!=typeof WeakMap?null:(e=new WeakMap,a=function(){return e},e)}function l(e,t,r,n,i,o,a){e=e<=0?1:e,t=t<0?0:t,r=r<=0?e:r,n=n<3?3:n;for(var l,c,u=(o=void 0===o||o)?-2:0,h=(i=i<1?1:i)+((a=void 0===a?0!==t:a)?2:0),d=Math.atan2(e-t,r),p=Math.sin(d),f=Math.cos(d),m=u;m<=h;++m){var g=m/i,y=r*g,v=void 0;v=m<0?(g=y=0,e):i<m?(y=r,g=1,t):e+(t-e)*g;for(-2!==m&&m!==i+2||(v=0),y-=r/2,l=0;l<n;++l){var _=l/(n-1),x=2*Math.PI*_,b=Math.sin(x),w=(x=Math.cos(x),this.vertices.push(new s.default.Vector(b*v,y,x*v)));w=m<0?new s.default.Vector(0,-1,0):i<m&&t?new s.default.Vector(0,1,0):new s.default.Vector(b*f,p,x*f);this.vertexNormals.push(w),this.uvs.push(_,g)}}var S=0;if(o){for(c=0;c<n;++c)this.faces.push([S+c,S+n+(c+1)%n,S+n+c]);S+=2*n}for(m=0;m<i;++m){for(l=0;l<n;++l){var M=(l+1)%n;this.faces.push([S+l,S+M,S+n+M]),this.faces.push([S+l,S+n+M,S+n+l])}S+=n}if(a)for(S+=n,l=0;l<n;++l)this.faces.push([S+l,S+(l+1)%n,S+n])}s.default.prototype.plane=function(e,t,r,n){this._assert3d("plane"),s.default._validateParameters("plane",arguments),void 0===e&&(e=50),void 0===t&&(t=e),void 0===n&&(n=1);var i,o="plane|".concat(r=void 0===r?1:r,"|").concat(n);return this._renderer.geometryInHash(o)||((i=new s.default.Geometry(r,n,(function(){for(var e,t,r=0;r<=this.detailY;r++)for(var n=r/this.detailY,i=0;i<=this.detailX;i++)e=i/this.detailX,t=new s.default.Vector(e-.5,n-.5,0),this.vertices.push(t),this.uvs.push(e,n)}))).computeFaces().computeNormals(),r<=1&&n<=1?i._makeTriangleEdges()._edgesToVertices():this._renderer._doStroke,this._renderer.createBuffers(o,i)),this._renderer.drawBuffersScaled(o,e,t,1),this},s.default.prototype.box=function(e,t,r,n,i){this._assert3d("box"),s.default._validateParameters("box",arguments),void 0===e&&(e=50),void 0===t&&(t=e),void 0===r&&(r=t);var o,a=this._renderer.attributes&&this._renderer.attributes.perPixelLighting;void 0===i&&(i=a?1:4),a="box|".concat(n=void 0===n?a?1:4:n,"|").concat(i);return this._renderer.geometryInHash(a)||((o=new s.default.Geometry(n,i,(function(){var e=[[0,4,2,6],[1,3,5,7],[0,1,4,5],[2,6,3,7],[0,2,1,3],[4,5,6,7]];this.strokeIndices=[[0,1],[1,3],[3,2],[6,7],[8,9],[9,11],[14,15],[16,17],[17,19],[18,19],[20,21],[22,23]];for(var t=0;t<e.length;t++){for(var r=e[t],n=4*t,i=0;i<4;i++){var o=r[i];o=new s.default.Vector((2*(1&o)-1)/2,((2&o)-1)/2,((4&o)/2-1)/2);this.vertices.push(o),this.uvs.push(1&i,(2&i)/2)}this.faces.push([n,1+n,2+n]),this.faces.push([2+n,1+n,3+n])}}))).computeNormals(),n<=4&&i<=4?o._makeTriangleEdges()._edgesToVertices():this._renderer._doStroke,this._renderer.createBuffers(a,o)),this._renderer.drawBuffersScaled(a,e,t,r),this},s.default.prototype.sphere=function(e,t,r){return this._assert3d("sphere"),s.default._validateParameters("sphere",arguments),this.ellipsoid(e=void 0===e?50:e,e,e,t=void 0===t?24:t,r=void 0===r?16:r),this},s.default.prototype.cylinder=function(e,t,r,n,i,o){this._assert3d("cylinder"),s.default._validateParameters("cylinder",arguments),void 0===e&&(e=50),void 0===t&&(t=e),void 0===n&&(n=1),void 0===o&&(o=!0),void 0===i&&(i=!0);var a,c="cylinder|".concat(r=void 0===r?24:r,"|").concat(n,"|").concat(i,"|").concat(o);return this._renderer.geometryInHash(c)||(a=new s.default.Geometry(r,n),l.call(a,1,1,1,r,n,i,o),r<=24&&n<=16?a._makeTriangleEdges()._edgesToVertices():this._renderer._doStroke,this._renderer.createBuffers(c,a)),this._renderer.drawBuffersScaled(c,e,t,e),this},s.default.prototype.cone=function(e,t,r,n,i){this._assert3d("cone"),s.default._validateParameters("cone",arguments),void 0===e&&(e=50),void 0===t&&(t=e),void 0===n&&(n=1),void 0===i&&(i=!0);var o,a="cone|".concat(r=void 0===r?24:r,"|").concat(n,"|").concat(i);return this._renderer.geometryInHash(a)||(o=new s.default.Geometry(r,n),l.call(o,1,0,1,r,n,i,!1),r<=24&&n<=16?o._makeTriangleEdges()._edgesToVertices():this._renderer._doStroke,this._renderer.createBuffers(a,o)),this._renderer.drawBuffersScaled(a,e,t,e),this},s.default.prototype.ellipsoid=function(e,t,r,n,i){this._assert3d("ellipsoid"),s.default._validateParameters("ellipsoid",arguments),void 0===e&&(e=50),void 0===t&&(t=e),void 0===r&&(r=e),void 0===i&&(i=16);var o,a="ellipsoid|".concat(n=void 0===n?24:n,"|").concat(i);return this._renderer.geometryInHash(a)||((o=new s.default.Geometry(n,i,(function(){for(var e=0;e<=this.detailY;e++)for(var t=e/this.detailY,r=Math.PI*t-Math.PI/2,n=Math.cos(r),i=Math.sin(r),o=0;o<=this.detailX;o++){var a=o/this.detailX,l=2*Math.PI*a,c=Math.cos(l);l=Math.sin(l),l=new s.default.Vector(n*l,i,n*c);this.vertices.push(l),this.vertexNormals.push(l),this.uvs.push(a,t)}}))).computeFaces(),n<=24&&i<=24?o._makeTriangleEdges()._edgesToVertices():this._renderer._doStroke,this._renderer.createBuffers(a,o)),this._renderer.drawBuffersScaled(a,e,t,r),this},s.default.prototype.torus=function(e,t,r,n){if(this._assert3d("torus"),s.default._validateParameters("torus",arguments),void 0===e)e=50;else if(!e)return;if(void 0===t)t=10;else if(!t)return;void 0===r&&(r=24),void 0===n&&(n=16);var i,o=(t/e).toPrecision(4);t="torus|".concat(o,"|").concat(r,"|").concat(n);return this._renderer.geometryInHash(t)||((i=new s.default.Geometry(r,n,(function(){for(var e=0;e<=this.detailY;e++)for(var t=e/this.detailY,r=2*Math.PI*t,n=Math.cos(r),i=Math.sin(r),a=1+o*n,l=0;l<=this.detailX;l++){var c=l/this.detailX,u=2*Math.PI*c,h=Math.cos(u),d=(u=Math.sin(u),new s.default.Vector(a*h,a*u,o*i));h=new s.default.Vector(n*h,n*u,i);this.vertices.push(d),this.vertexNormals.push(h),this.uvs.push(c,t)}}))).computeFaces(),r<=24&&n<=16?i._makeTriangleEdges()._edgesToVertices():this._renderer._doStroke,this._renderer.createBuffers(t,i)),this._renderer.drawBuffersScaled(t,e,e,e),this},s.default.RendererGL.prototype.point=function(e,t,r){var n=[];return n.push(new s.default.Vector(e,t,r=void 0===r?0:r)),this._drawPoints(n,this.immediateMode.buffers.point),this},s.default.RendererGL.prototype.triangle=function(e){var t=e[0],r=e[1],n=e[2],i=e[3],o=e[4],a=(e=e[5],this.geometryInHash("tri")||((a=new s.default.Geometry(1,1,(function(){var e=[];e.push(new s.default.Vector(0,0,0)),e.push(new s.default.Vector(1,0,0)),e.push(new s.default.Vector(0,1,0)),this.strokeIndices=[[0,1],[1,2],[2,0]],this.vertices=e,this.faces=[[0,1,2]],this.uvs=[0,0,1,0,1,1]})))._makeTriangleEdges()._edgesToVertices(),a.computeNormals(),this.createBuffers("tri",a)),this.uMVMatrix.copy());try{var l=new s.default.Matrix([n-t,i-r,0,0,o-t,e-r,0,0,0,0,1,0,t,r,0,1]).mult(this.uMVMatrix);this.uMVMatrix=l,this.drawBuffers("tri")}finally{this.uMVMatrix=a}return this},s.default.RendererGL.prototype.ellipse=function(e){this.arc(e[0],e[1],e[2],e[3],0,o.TWO_PI,o.OPEN,e[4])},s.default.RendererGL.prototype.arc=function(e){var t,r=arguments[1],n=arguments[2],i=arguments[3],a=arguments[4],l=arguments[5],c=arguments[6],u=arguments[7]||25,h=(Math.abs(l-a)>=o.TWO_PI?"".concat(d="ellipse","|"):"".concat(d="arc","|").concat(a,"|").concat(l,"|").concat(c,"|")).concat(u,"|"),d=(this.geometryInHash(h)||((t=new s.default.Geometry(u,1,(function(){if(this.strokeIndices=[],a.toFixed(10)!==l.toFixed(10)){c!==o.PIE&&void 0!==c||(this.vertices.push(new s.default.Vector(.5,.5,0)),this.uvs.push([.5,.5]));for(var e=0;e<=u;e++){var t=e/u*(l-a)+a,r=.5+Math.cos(t)/2;t=.5+Math.sin(t)/2;this.vertices.push(new s.default.Vector(r,t,0)),this.uvs.push([r,t]),e<u-1&&(this.faces.push([0,e+1,e+2]),this.strokeIndices.push([e+1,e+2]))}switch(c){case o.PIE:this.faces.push([0,this.vertices.length-2,this.vertices.length-1]),this.strokeIndices.push([0,1]),this.strokeIndices.push([this.vertices.length-2,this.vertices.length-1]),this.strokeIndices.push([0,this.vertices.length-1]);break;case o.CHORD:this.strokeIndices.push([0,1]),this.strokeIndices.push([0,this.vertices.length-1]);break;case o.OPEN:this.strokeIndices.push([0,1]);break;default:this.faces.push([0,this.vertices.length-2,this.vertices.length-1]),this.strokeIndices.push([this.vertices.length-2,this.vertices.length-1])}}}))).computeNormals(),u<=50?t._makeTriangleEdges()._edgesToVertices(t):this._doStroke,this.createBuffers(h,t)),this.uMVMatrix.copy());try{this.uMVMatrix.translate([e,r,0]),this.uMVMatrix.scale(n,i,1),this.drawBuffers(h)}finally{this.uMVMatrix=d}return this},s.default.RendererGL.prototype.rect=function(e){var t=e[0],r=e[1],n=e[2],i=e[3];if(void 0===e[4]){var a=this._pInst._glAttributes.perPixelLighting,l=e[4]||(a?1:24),c=e[5]||(a?1:16),u=(a="rect|".concat(l,"|").concat(c),this.geometryInHash(a)||((u=new s.default.Geometry(l,c,(function(){for(var e=0;e<=this.detailY;e++)for(var t=e/this.detailY,r=0;r<=this.detailX;r++){var n=r/this.detailX,i=new s.default.Vector(n,t,0);this.vertices.push(i),this.uvs.push(n,t)}0<l&&0<c&&(this.strokeIndices=[[0,l],[l,(l+1)*(c+1)-1],[(l+1)*(c+1)-1,(l+1)*c],[(l+1)*c,0]])}))).computeFaces().computeNormals()._makeTriangleEdges()._edgesToVertices(),this.createBuffers(a,u)),this.uMVMatrix.copy());try{this.uMVMatrix.translate([t,r,0]),this.uMVMatrix.scale(n,i,1),this.drawBuffers(a)}finally{this.uMVMatrix=u}}else{a=e[4],u=void 0===e[5]?a:e[5];var h=void 0===e[6]?u:e[6],d=(e=void 0===e[7]?h:e[7],n),p=i,f=((g=((d+=t)<t&&(g=t,t=d,d=g),(p+=r)<r&&(g=r,r=p,p=g),Math.min((d-t)/2,(p-r)/2)))<a&&(a=g),g<u&&(u=g),g<h&&(h=g),g<e&&(e=g),t),m=r,g=d,y=(t=p,this.beginShape(),0!==u?(this.vertex(g-u,m),this.quadraticVertex(g,m,g,m+u)):this.vertex(g,m),0!==h?(this.vertex(g,t-h),this.quadraticVertex(g,t,g-h,t)):this.vertex(g,t),0!==e?(this.vertex(f+e,t),this.quadraticVertex(f,t,f,t-e)):this.vertex(f,t),0!==a?(this.vertex(f,m+a),this.quadraticVertex(f,m,f+a,m)):this.vertex(f,m),!(this.immediateMode.geometry.uvs.length=0));r=!1,d=void 0;try{for(var v,_=this.immediateMode.geometry.vertices[Symbol.iterator]();!(y=(v=_.next()).done);y=!0){var x=v.value,b=(x.x-f)/n,w=(x.y-m)/i;this.immediateMode.geometry.uvs.push(b,w)}}catch(e){r=!0,d=e}finally{try{y||null==_.return||_.return()}finally{if(r)throw d}}this.endShape(o.CLOSE)}return this},s.default.RendererGL.prototype.quad=function(e,t,r,n,i,o,a,l,c,u,h,d,p,f){void 0===p&&(p=2),void 0===f&&(f=2);var m="quad|".concat(e,"|").concat(t,"|").concat(r,"|").concat(n,"|").concat(i,"|").concat(o,"|").concat(a,"|").concat(l,"|").concat(c,"|").concat(u,"|").concat(h,"|").concat(d,"|").concat(p,"|").concat(f);if(!this.geometryInHash(m)){var g=new s.default.Geometry(p,f,(function(){for(var p=1/(this.detailX-1),f=1/(this.detailY-1),m=0;m<this.detailY;m++)for(var g=0;g<this.detailX;g++){var y=g*p,v=m*f;this.vertices.push(new s.default.Vector((1-y)*((1-v)*e+v*u)+y*((1-v)*n+v*a),(1-y)*((1-v)*t+v*h)+y*((1-v)*i+v*l),(1-y)*((1-v)*r+v*d)+y*((1-v)*o+v*c))),this.uvs.push([y,v])}}));g.faces=[];for(var y=0;y<f-1;y++)for(var v=0;v<p-1;v++){var _=v+y*p,x=v+1+(y+1)*p,b=v+(y+1)*p;g.faces.push([_,v+1+y*p,x]),g.faces.push([_,x,b])}g.computeNormals()._makeTriangleEdges()._edgesToVertices(),this.createBuffers(m,g)}return this.drawBuffers(m),this},s.default.RendererGL.prototype.bezier=function(e,t,r,n,i,s,o,a,l,c,u,h){8===arguments.length&&(u=a,c=o,a=s,o=i,i=n,n=r,r=s=l=h=0);var d=this._pInst._bezierDetail||20;this.beginShape();for(var p=0;p<=d;p++){var f=Math.pow(1-p/d,3),m=p/d*3*Math.pow(1-p/d,2),g=3*Math.pow(p/d,2)*(1-p/d),y=Math.pow(p/d,3);this.vertex(e*f+n*m+o*g+c*y,t*f+i*m+a*g+u*y,r*f+s*m+l*g+h*y)}return this.endShape(),this},s.default.RendererGL.prototype.curve=function(e,t,r,n,i,s,o,a,l,c,u,h){8===arguments.length&&(c=o,u=a,o=i,a=n,i=n=r,r=s=l=h=0);var d=this._pInst._curveDetail;this.beginShape();for(var p=0;p<=d;p++){var f=.5*Math.pow(p/d,3),m=.5*Math.pow(p/d,2),g=p/d*.5;this.vertex(f*(3*n-e-3*o+c)+m*(2*e-5*n+4*o-c)+g*(-e+o)+2*n*.5,f*(3*i-t-3*a+u)+m*(2*t-5*i+4*a-u)+g*(-t+a)+2*i*.5,f*(3*s-r-3*l+h)+m*(2*r-5*s+4*l-h)+g*(-r+l)+2*s*.5)}return this.endShape(),this},s.default.RendererGL.prototype.line=function(){return 6===arguments.length?(this.beginShape(o.LINES),this.vertex(arguments.length<=0?void 0:arguments[0],arguments.length<=1?void 0:arguments[1],arguments.length<=2?void 0:arguments[2]),this.vertex(arguments.length<=3?void 0:arguments[3],arguments.length<=4?void 0:arguments[4],arguments.length<=5?void 0:arguments[5]),this.endShape()):4===arguments.length&&(this.beginShape(o.LINES),this.vertex(arguments.length<=0?void 0:arguments[0],arguments.length<=1?void 0:arguments[1],0),this.vertex(arguments.length<=2?void 0:arguments[2],arguments.length<=3?void 0:arguments[3],0),this.endShape()),this},s.default.RendererGL.prototype.bezierVertex=function(){if(0===this.immediateMode._bezierVertex.length)throw Error("vertex() must be used once before calling bezierVertex()");var e,t,r,n,i,s,o=[],a=[],l=arguments.length;if(0===this._lookUpTableBezier.length||this._lutBezierDetail!==this._pInst._curveDetail){this._lookUpTableBezier=[],this._lutBezierDetail=this._pInst._curveDetail;for(var c=1/this._lutBezierDetail,u=0,h=1,d=0;u<1;){if(s=parseFloat(u.toFixed(6)),this._lookUpTableBezier[d]=this._bezierCoefficients(s),h.toFixed(6)===c.toFixed(6)){s=parseFloat(h.toFixed(6))+parseFloat(u.toFixed(6)),++d,this._lookUpTableBezier[d]=this._bezierCoefficients(s);break}u+=c,h-=c,++d}}for(var p=this._lookUpTableBezier.length,f=[],m=0;m<4;m++)f.push([]);f[0]=this.immediateMode.geometry.vertexColors.slice(-4),f[3]=this.curFillColor.slice();var g=[];for(m=0;m<4;m++)g.push([]);if(g[0]=this.immediateMode.geometry.vertexStrokeColors.slice(-4),g[3]=this.curStrokeColor.slice(),6===l){this.isBezier=!0;o=[this.immediateMode._bezierVertex[0],arguments.length<=0?void 0:arguments[0],arguments.length<=2?void 0:arguments[2],arguments.length<=4?void 0:arguments[4]],a=[this.immediateMode._bezierVertex[1],arguments.length<=1?void 0:arguments[1],arguments.length<=3?void 0:arguments[3],arguments.length<=5?void 0:arguments[5]];var y=Math.hypot(o[0]-o[1],a[0]-a[1]),v=Math.hypot(o[1]-o[2],a[1]-a[2]),_=Math.hypot(o[2]-o[3],a[2]-a[3]);for(y/=v=y+v+_,_/=v,i=0;i<4;i++)f[1].push(f[0][i]*(1-y)+f[3][i]*y),f[2].push(f[0][i]*_+f[3][i]*(1-_)),g[1].push(g[0][i]*(1-y)+g[3][i]*y),g[2].push(g[0][i]*_+g[3][i]*(1-_));for(n=0;n<p;n++){for(this.curFillColor=[0,0,0,0],this.curStrokeColor=[0,0,0,0],m=e=t=0;m<4;m++){for(i=0;i<4;i++)this.curFillColor[i]+=this._lookUpTableBezier[n][m]*f[m][i],this.curStrokeColor[i]+=this._lookUpTableBezier[n][m]*g[m][i];e+=o[m]*this._lookUpTableBezier[n][m],t+=a[m]*this._lookUpTableBezier[n][m]}this.vertex(e,t)}this.curFillColor=f[3],this.curStrokeColor=g[3],this.immediateMode._bezierVertex[0]=arguments.length<=4?void 0:arguments[4],this.immediateMode._bezierVertex[1]=arguments.length<=5?void 0:arguments[5]}else if(9===l){this.isBezier=!0,o=[this.immediateMode._bezierVertex[0],arguments.length<=0?void 0:arguments[0],arguments.length<=3?void 0:arguments[3],arguments.length<=6?void 0:arguments[6]],a=[this.immediateMode._bezierVertex[1],arguments.length<=1?void 0:arguments[1],arguments.length<=4?void 0:arguments[4],arguments.length<=7?void 0:arguments[7]];var x=[this.immediateMode._bezierVertex[2],arguments.length<=2?void 0:arguments[2],arguments.length<=5?void 0:arguments[5],arguments.length<=8?void 0:arguments[8]],b=Math.hypot(o[0]-o[1],a[0]-a[1],x[0]-x[1]),w=(v=Math.hypot(o[1]-o[2],a[1]-a[2],x[1]-x[2]),Math.hypot(o[2]-o[3],a[2]-a[3],x[2]-x[3]));for(b/=l=b+v+w,w/=l,i=0;i<4;i++)f[1].push(f[0][i]*(1-b)+f[3][i]*b),f[2].push(f[0][i]*w+f[3][i]*(1-w)),g[1].push(g[0][i]*(1-b)+g[3][i]*b),g[2].push(g[0][i]*w+g[3][i]*(1-w));for(n=0;n<p;n++){for(this.curFillColor=[0,0,0,0],this.curStrokeColor=[0,0,0,0],m=e=t=r=0;m<4;m++){for(i=0;i<4;i++)this.curFillColor[i]+=this._lookUpTableBezier[n][m]*f[m][i],this.curStrokeColor[i]+=this._lookUpTableBezier[n][m]*g[m][i];e+=o[m]*this._lookUpTableBezier[n][m],t+=a[m]*this._lookUpTableBezier[n][m],r+=x[m]*this._lookUpTableBezier[n][m]}this.vertex(e,t,r)}this.curFillColor=f[3],this.curStrokeColor=g[3],this.immediateMode._bezierVertex[0]=arguments.length<=6?void 0:arguments[6],this.immediateMode._bezierVertex[1]=arguments.length<=7?void 0:arguments[7],this.immediateMode._bezierVertex[2]=arguments.length<=8?void 0:arguments[8]}},s.default.RendererGL.prototype.quadraticVertex=function(){if(0===this.immediateMode._quadraticVertex.length)throw Error("vertex() must be used once before calling quadraticVertex()");var e,t,r,n,i,s,o=[],a=[],l=arguments.length;if(0===this._lookUpTableQuadratic.length||this._lutQuadraticDetail!==this._pInst._curveDetail){this._lookUpTableQuadratic=[],this._lutQuadraticDetail=this._pInst._curveDetail;for(var c=1/this._lutQuadraticDetail,u=0,h=1,d=0;u<1;){if(s=parseFloat(u.toFixed(6)),this._lookUpTableQuadratic[d]=this._quadraticCoefficients(s),h.toFixed(6)===c.toFixed(6)){s=parseFloat(h.toFixed(6))+parseFloat(u.toFixed(6)),++d,this._lookUpTableQuadratic[d]=this._quadraticCoefficients(s);break}u+=c,h-=c,++d}}for(var p=this._lookUpTableQuadratic.length,f=[],m=0;m<3;m++)f.push([]);f[0]=this.immediateMode.geometry.vertexColors.slice(-4),f[2]=this.curFillColor.slice();var g=[];for(m=0;m<3;m++)g.push([]);if(g[0]=this.immediateMode.geometry.vertexStrokeColors.slice(-4),g[2]=this.curStrokeColor.slice(),4===l){this.isQuadratic=!0;o=[this.immediateMode._quadraticVertex[0],arguments.length<=0?void 0:arguments[0],arguments.length<=2?void 0:arguments[2]],a=[this.immediateMode._quadraticVertex[1],arguments.length<=1?void 0:arguments[1],arguments.length<=3?void 0:arguments[3]];var y=Math.hypot(o[0]-o[1],a[0]-a[1]);for(y/=y+Math.hypot(o[1]-o[2],a[1]-a[2]),i=0;i<4;i++)f[1].push(f[0][i]*(1-y)+f[2][i]*y),g[1].push(g[0][i]*(1-y)+g[2][i]*y);for(n=0;n<p;n++){for(this.curFillColor=[0,0,0,0],this.curStrokeColor=[0,0,0,0],m=e=t=0;m<3;m++){for(i=0;i<4;i++)this.curFillColor[i]+=this._lookUpTableQuadratic[n][m]*f[m][i],this.curStrokeColor[i]+=this._lookUpTableQuadratic[n][m]*g[m][i];e+=o[m]*this._lookUpTableQuadratic[n][m],t+=a[m]*this._lookUpTableQuadratic[n][m]}this.vertex(e,t)}this.curFillColor=f[2],this.curStrokeColor=g[2],this.immediateMode._quadraticVertex[0]=arguments.length<=2?void 0:arguments[2],this.immediateMode._quadraticVertex[1]=arguments.length<=3?void 0:arguments[3]}else if(6===l){this.isQuadratic=!0,o=[this.immediateMode._quadraticVertex[0],arguments.length<=0?void 0:arguments[0],arguments.length<=3?void 0:arguments[3]],a=[this.immediateMode._quadraticVertex[1],arguments.length<=1?void 0:arguments[1],arguments.length<=4?void 0:arguments[4]];var v=[this.immediateMode._quadraticVertex[2],arguments.length<=2?void 0:arguments[2],arguments.length<=5?void 0:arguments[5]],_=Math.hypot(o[0]-o[1],a[0]-a[1],v[0]-v[1]);for(_/=_+Math.hypot(o[1]-o[2],a[1]-a[2],v[1]-v[2]),i=0;i<4;i++)f[1].push(f[0][i]*(1-_)+f[2][i]*_),g[1].push(g[0][i]*(1-_)+g[2][i]*_);for(n=0;n<p;n++){for(this.curFillColor=[0,0,0,0],this.curStrokeColor=[0,0,0,0],m=e=t=r=0;m<3;m++){for(i=0;i<4;i++)this.curFillColor[i]+=this._lookUpTableQuadratic[n][m]*f[m][i],this.curStrokeColor[i]+=this._lookUpTableQuadratic[n][m]*g[m][i];e+=o[m]*this._lookUpTableQuadratic[n][m],t+=a[m]*this._lookUpTableQuadratic[n][m],r+=v[m]*this._lookUpTableQuadratic[n][m]}this.vertex(e,t,r)}this.curFillColor=f[2],this.curStrokeColor=g[2],this.immediateMode._quadraticVertex[0]=arguments.length<=3?void 0:arguments[3],this.immediateMode._quadraticVertex[1]=arguments.length<=4?void 0:arguments[4],this.immediateMode._quadraticVertex[2]=arguments.length<=5?void 0:arguments[5]}},s.default.RendererGL.prototype.curveVertex=function(){var e,t,r,n,i,s,o=[],a=[],l=arguments.length;if(0===this._lookUpTableBezier.length||this._lutBezierDetail!==this._pInst._curveDetail){this._lookUpTableBezier=[],this._lutBezierDetail=this._pInst._curveDetail;for(var c=1/this._lutBezierDetail,u=0,h=1,d=0;u<1;){if(s=parseFloat(u.toFixed(6)),this._lookUpTableBezier[d]=this._bezierCoefficients(s),h.toFixed(6)===c.toFixed(6)){s=parseFloat(h.toFixed(6))+parseFloat(u.toFixed(6)),++d,this._lookUpTableBezier[d]=this._bezierCoefficients(s);break}u+=c,h-=c,++d}}var p=this._lookUpTableBezier.length;if(2===l){if(this.immediateMode._curveVertex.push(arguments.length<=0?void 0:arguments[0]),this.immediateMode._curveVertex.push(arguments.length<=1?void 0:arguments[1]),8===this.immediateMode._curveVertex.length){for(this.isCurve=!0,o=this._bezierToCatmull([this.immediateMode._curveVertex[0],this.immediateMode._curveVertex[2],this.immediateMode._curveVertex[4],this.immediateMode._curveVertex[6]]),a=this._bezierToCatmull([this.immediateMode._curveVertex[1],this.immediateMode._curveVertex[3],this.immediateMode._curveVertex[5],this.immediateMode._curveVertex[7]]),i=0;i<p;i++)t=o[0]*this._lookUpTableBezier[i][0]+o[1]*this._lookUpTableBezier[i][1]+o[2]*this._lookUpTableBezier[i][2]+o[3]*this._lookUpTableBezier[i][3],r=a[0]*this._lookUpTableBezier[i][0]+a[1]*this._lookUpTableBezier[i][1]+a[2]*this._lookUpTableBezier[i][2]+a[3]*this._lookUpTableBezier[i][3],this.vertex(t,r);for(i=0;i<l;i++)this.immediateMode._curveVertex.shift()}}else if(3===l&&(this.immediateMode._curveVertex.push(arguments.length<=0?void 0:arguments[0]),this.immediateMode._curveVertex.push(arguments.length<=1?void 0:arguments[1]),this.immediateMode._curveVertex.push(arguments.length<=2?void 0:arguments[2]),12===this.immediateMode._curveVertex.length)){for(this.isCurve=!0,o=this._bezierToCatmull([this.immediateMode._curveVertex[0],this.immediateMode._curveVertex[3],this.immediateMode._curveVertex[6],this.immediateMode._curveVertex[9]]),a=this._bezierToCatmull([this.immediateMode._curveVertex[1],this.immediateMode._curveVertex[4],this.immediateMode._curveVertex[7],this.immediateMode._curveVertex[10]]),e=this._bezierToCatmull([this.immediateMode._curveVertex[2],this.immediateMode._curveVertex[5],this.immediateMode._curveVertex[8],this.immediateMode._curveVertex[11]]),i=0;i<p;i++)t=o[0]*this._lookUpTableBezier[i][0]+o[1]*this._lookUpTableBezier[i][1]+o[2]*this._lookUpTableBezier[i][2]+o[3]*this._lookUpTableBezier[i][3],r=a[0]*this._lookUpTableBezier[i][0]+a[1]*this._lookUpTableBezier[i][1]+a[2]*this._lookUpTableBezier[i][2]+a[3]*this._lookUpTableBezier[i][3],n=e[0]*this._lookUpTableBezier[i][0]+e[1]*this._lookUpTableBezier[i][1]+e[2]*this._lookUpTableBezier[i][2]+e[3]*this._lookUpTableBezier[i][3],this.vertex(t,r,n);for(i=0;i<l;i++)this.immediateMode._curveVertex.shift()}},s.default.RendererGL.prototype.image=function(e,t,r,n,i,s,a,l,c){this._isErasing&&this.blendMode(this._cachedBlendMode),this._pInst.push(),this._pInst.noLights(),this._pInst.noStroke(),this._pInst.texture(e),this._pInst.textureMode(o.NORMAL);var u=0,h=(t<=e.width&&(u=t/e.width),1);t+n<=e.width&&(h=(t+n)/e.width),t=0,r<=e.height&&(t=r/e.height),n=1;r+i<=e.height&&(n=(r+i)/e.height),this.beginShape(),this.vertex(s,a,0,u,t),this.vertex(s+l,a,0,h,t),this.vertex(s+l,a+c,0,h,n),this.vertex(s,a+c,0,u,n),this.endShape(o.CLOSE),this._pInst.pop(),this._isErasing&&this.blendMode(o.REMOVE)};var c=s.default;r.default=c},{"../core/constants":256,"../core/main":267,"./p5.Geometry":316,"core-js/modules/es.array.concat":149,"core-js/modules/es.array.iterator":158,"core-js/modules/es.array.slice":162,"core-js/modules/es.math.hypot":167,"core-js/modules/es.number.to-fixed":171,"core-js/modules/es.object.get-own-property-descriptor":173,"core-js/modules/es.object.to-string":177,"core-js/modules/es.string.iterator":186,"core-js/modules/es.symbol":196,"core-js/modules/es.symbol.description":194,"core-js/modules/es.symbol.iterator":195,"core-js/modules/es.weak-map":228,"core-js/modules/web.dom-collections.iterator":230}],311:[function(e,t,r){"use strict";function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function i(e){return(i="function"==typeof Symbol&&"symbol"===n(Symbol.iterator)?function(e){return n(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":n(e)})(e)}e("core-js/modules/es.symbol"),e("core-js/modules/es.symbol.description"),e("core-js/modules/es.symbol.iterator"),e("core-js/modules/es.array.iterator"),e("core-js/modules/es.array.splice"),e("core-js/modules/es.object.get-own-property-descriptor"),e("core-js/modules/es.object.to-string"),e("core-js/modules/es.regexp.to-string"),e("core-js/modules/es.string.iterator"),e("core-js/modules/es.weak-map"),e("core-js/modules/web.dom-collections.iterator"),e("core-js/modules/es.array.splice"),e("core-js/modules/es.object.to-string"),e("core-js/modules/es.regexp.to-string"),Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var s=(l=e("../core/main"))&&l.__esModule?l:{default:l},o=function(e){if(e&&e.__esModule)return e;if(null===e||"object"!==i(e)&&"function"!=typeof e)return{default:e};var t=a();if(t&&t.has(e))return t.get(e);var r,n={},s=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(r in e){var o;Object.prototype.hasOwnProperty.call(e,r)&&((o=s?Object.getOwnPropertyDescriptor(e,r):null)&&(o.get||o.set)?Object.defineProperty(n,r,o):n[r]=e[r])}return n.default=e,t&&t.set(e,n),n}(e("../core/constants"));function a(){var e;return"function"!=typeof WeakMap?null:(e=new WeakMap,a=function(){return e},e)}s.default.prototype.orbitControl=function(e,t,r){var n,i;if(this._assert3d("orbitControl"),s.default._validateParameters("orbitControl",arguments),this.mouseX<this.width&&0<this.mouseX&&this.mouseY<this.height&&0<this.mouseY)return n=this._renderer._curCamera,void 0===e&&(e=1),void 0===t&&(t=e),void 0===r&&(r=.5),!0!==this.contextMenuDisabled&&(this.canvas.oncontextmenu=function(){return!1},this._setProperty("contextMenuDisabled",!0)),!0!==this.wheelDefaultDisabled&&(this.canvas.onwheel=function(){return!1},this._setProperty("wheelDefaultDisabled",!0)),i=this.height<this.width?this.height:this.width,this._mouseWheelDeltaY!==this._pmouseWheelDeltaY&&(0<this._mouseWheelDeltaY?this._renderer._curCamera._orbit(0,0,r*i):this._renderer._curCamera._orbit(0,0,-r*i)),this.mouseIsPressed&&(this.mouseButton===this.LEFT?(r=-e*(this.mouseX-this.pmouseX)/i,i=t*(this.mouseY-this.pmouseY)/i,this._renderer._curCamera._orbit(r,i,0)):this.mouseButton===this.RIGHT&&(r=n._getLocalAxes(),0!==(i=Math.sqrt(r.x[0]*r.x[0]+r.x[2]*r.x[2]))&&(r.x[0]/=i,r.x[2]/=i),0!==(i=Math.sqrt(r.y[0]*r.y[0]+r.y[2]*r.y[2]))&&(r.y[0]/=i,r.y[2]/=i),i=-1*e*(this.mouseX-this.pmouseX),e=-1*t*(this.mouseY-this.pmouseY),n.setPosition(n.eyeX+i*r.x[0]+e*r.z[0],n.eyeY,n.eyeZ+i*r.x[2]+e*r.z[2]))),this},s.default.prototype.debugMode=function(){this._assert3d("debugMode");for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];s.default._validateParameters("debugMode",t);for(var n=this._registeredMethods.post.length-1;0<=n;n--)this._registeredMethods.post[n].toString()!==this._grid().toString()&&this._registeredMethods.post[n].toString()!==this._axesIcon().toString()||this._registeredMethods.post.splice(n,1);t[0]===o.GRID?this.registerMethod("post",this._grid.call(this,t[1],t[2],t[3],t[4],t[5])):t[0]===o.AXES?this.registerMethod("post",this._axesIcon.call(this,t[1],t[2],t[3],t[4])):(this.registerMethod("post",this._grid.call(this,t[0],t[1],t[2],t[3],t[4])),this.registerMethod("post",this._axesIcon.call(this,t[5],t[6],t[7],t[8])))},s.default.prototype.noDebugMode=function(){this._assert3d("noDebugMode");for(var e=this._registeredMethods.post.length-1;0<=e;e--)this._registeredMethods.post[e].toString()!==this._grid().toString()&&this._registeredMethods.post[e].toString()!==this._axesIcon().toString()||this._registeredMethods.post.splice(e,1)},s.default.prototype._grid=function(e,t,r,n,i){void 0===e&&(e=this.width/2),void 0===t&&(t=Math.round(e/30)<4?4:Math.round(e/30)),void 0===r&&(r=0),void 0===n&&(n=0),void 0===i&&(i=0);var s=e/t,o=e/2;return function(){this.push(),this.stroke(255*this._renderer.curStrokeColor[0],255*this._renderer.curStrokeColor[1],255*this._renderer.curStrokeColor[2]),this._renderer.uMVMatrix.set(this._renderer._curCamera.cameraMatrix.mat4[0],this._renderer._curCamera.cameraMatrix.mat4[1],this._renderer._curCamera.cameraMatrix.mat4[2],this._renderer._curCamera.cameraMatrix.mat4[3],this._renderer._curCamera.cameraMatrix.mat4[4],this._renderer._curCamera.cameraMatrix.mat4[5],this._renderer._curCamera.cameraMatrix.mat4[6],this._renderer._curCamera.cameraMatrix.mat4[7],this._renderer._curCamera.cameraMatrix.mat4[8],this._renderer._curCamera.cameraMatrix.mat4[9],this._renderer._curCamera.cameraMatrix.mat4[10],this._renderer._curCamera.cameraMatrix.mat4[11],this._renderer._curCamera.cameraMatrix.mat4[12],this._renderer._curCamera.cameraMatrix.mat4[13],this._renderer._curCamera.cameraMatrix.mat4[14],this._renderer._curCamera.cameraMatrix.mat4[15]);for(var e=0;e<=t;e++)this.beginShape(this.LINES),this.vertex(-o+r,n,e*s-o+i),this.vertex(o+r,n,e*s-o+i),this.endShape();for(var a=0;a<=t;a++)this.beginShape(this.LINES),this.vertex(a*s-o+r,n,-o+i),this.vertex(a*s-o+r,n,o+i),this.endShape();this.pop()}},s.default.prototype._axesIcon=function(e,t,r,n){return void 0===e&&(e=40<this.width/20?this.width/20:40),void 0===t&&(t=-this.width/4),void 0===r&&(r=t),void 0===n&&(n=t),function(){this.push(),this._renderer.uMVMatrix.set(this._renderer._curCamera.cameraMatrix.mat4[0],this._renderer._curCamera.cameraMatrix.mat4[1],this._renderer._curCamera.cameraMatrix.mat4[2],this._renderer._curCamera.cameraMatrix.mat4[3],this._renderer._curCamera.cameraMatrix.mat4[4],this._renderer._curCamera.cameraMatrix.mat4[5],this._renderer._curCamera.cameraMatrix.mat4[6],this._renderer._curCamera.cameraMatrix.mat4[7],this._renderer._curCamera.cameraMatrix.mat4[8],this._renderer._curCamera.cameraMatrix.mat4[9],this._renderer._curCamera.cameraMatrix.mat4[10],this._renderer._curCamera.cameraMatrix.mat4[11],this._renderer._curCamera.cameraMatrix.mat4[12],this._renderer._curCamera.cameraMatrix.mat4[13],this._renderer._curCamera.cameraMatrix.mat4[14],this._renderer._curCamera.cameraMatrix.mat4[15]),this.strokeWeight(2),this.stroke(255,0,0),this.beginShape(this.LINES),this.vertex(t,r,n),this.vertex(t+e,r,n),this.endShape(),this.stroke(0,255,0),this.beginShape(this.LINES),this.vertex(t,r,n),this.vertex(t,r+e,n),this.endShape(),this.stroke(0,0,255),this.beginShape(this.LINES),this.vertex(t,r,n),this.vertex(t,r,n+e),this.endShape(),this.pop()}};var l=s.default;r.default=l},{"../core/constants":256,"../core/main":267,"core-js/modules/es.array.iterator":158,"core-js/modules/es.array.splice":164,"core-js/modules/es.object.get-own-property-descriptor":173,"core-js/modules/es.object.to-string":177,"core-js/modules/es.regexp.to-string":182,"core-js/modules/es.string.iterator":186,"core-js/modules/es.symbol":196,"core-js/modules/es.symbol.description":194,"core-js/modules/es.symbol.iterator":195,"core-js/modules/es.weak-map":228,"core-js/modules/web.dom-collections.iterator":230}],312:[function(e,t,r){"use strict";function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function i(e){return(i="function"==typeof Symbol&&"symbol"===n(Symbol.iterator)?function(e){return n(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":n(e)})(e)}e("core-js/modules/es.symbol"),e("core-js/modules/es.symbol.description"),e("core-js/modules/es.symbol.iterator"),e("core-js/modules/es.array.iterator"),e("core-js/modules/es.object.get-own-property-descriptor"),e("core-js/modules/es.object.to-string"),e("core-js/modules/es.string.iterator"),e("core-js/modules/es.weak-map"),e("core-js/modules/web.dom-collections.iterator"),Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var s=(l=e("../core/main"))&&l.__esModule?l:{default:l},o=function(e){if(e&&e.__esModule)return e;if(null===e||"object"!==i(e)&&"function"!=typeof e)return{default:e};var t=a();if(t&&t.has(e))return t.get(e);var r,n={},s=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(r in e){var o;Object.prototype.hasOwnProperty.call(e,r)&&((o=s?Object.getOwnPropertyDescriptor(e,r):null)&&(o.get||o.set)?Object.defineProperty(n,r,o):n[r]=e[r])}return n.default=e,t&&t.set(e,n),n}(e("../core/constants"));function a(){var e;return"function"!=typeof WeakMap?null:(e=new WeakMap,a=function(){return e},e)}s.default.prototype.ambientLight=function(e,t,r,n){this._assert3d("ambientLight"),s.default._validateParameters("ambientLight",arguments);var i=this.color.apply(this,arguments);return this._renderer.ambientLightColors.push(i._array[0],i._array[1],i._array[2]),this._renderer._enableLighting=!0,this},s.default.prototype.specularColor=function(e,t,r){this._assert3d("specularColor"),s.default._validateParameters("specularColor",arguments);var n=this.color.apply(this,arguments);return this._renderer.specularColors=[n._array[0],n._array[1],n._array[2]],this},s.default.prototype.directionalLight=function(e,t,r,n,i,o){this._assert3d("directionalLight"),s.default._validateParameters("directionalLight",arguments),e=e instanceof s.default.Color?e:this.color(e,t,r);var a,l;r="number"==typeof(t=arguments[arguments.length-1])?(a=arguments[arguments.length-3],l=arguments[arguments.length-2],arguments[arguments.length-1]):(a=t.x,l=t.y,t.z),t=Math.sqrt(a*a+l*l+r*r);return this._renderer.directionalLightDirections.push(a/t,l/t,r/t),this._renderer.directionalLightDiffuseColors.push(e._array[0],e._array[1],e._array[2]),Array.prototype.push.apply(this._renderer.directionalLightSpecularColors,this._renderer.specularColors),this._renderer._enableLighting=!0,this},s.default.prototype.pointLight=function(e,t,r,n,i,o){this._assert3d("pointLight"),s.default._validateParameters("pointLight",arguments),e=e instanceof s.default.Color?e:this.color(e,t,r);var a,l;r="number"==typeof(t=arguments[arguments.length-1])?(a=arguments[arguments.length-3],l=arguments[arguments.length-2],arguments[arguments.length-1]):(a=t.x,l=t.y,t.z);return this._renderer.pointLightPositions.push(a,l,r),this._renderer.pointLightDiffuseColors.push(e._array[0],e._array[1],e._array[2]),Array.prototype.push.apply(this._renderer.pointLightSpecularColors,this._renderer.specularColors),this._renderer._enableLighting=!0,this},s.default.prototype.lights=function(){var e;return this._assert3d("lights"),this._colorMode===o.RGB?(this.ambientLight(128,128,128),this.directionalLight(128,128,128,0,0,-1)):(e=this._colorMaxes[this._colorMode][2],this.ambientLight(0,0,e),this.directionalLight(0,0,e,0,0,-1)),this},s.default.prototype.lightFalloff=function(e,t,r){return this._assert3d("lightFalloff"),s.default._validateParameters("lightFalloff",arguments),e<0&&(e=0),t<0&&(t=0),r<0&&(r=0),0===e&&0===t&&0===r&&(e=1),this._renderer.constantAttenuation=e,this._renderer.linearAttenuation=t,this._renderer.quadraticAttenuation=r,this},s.default.prototype.spotLight=function(e,t,r,n,i,o,a,l,c,u,h){var d,p,f;switch(this._assert3d("spotLight"),s.default._validateParameters("spotLight",arguments),arguments.length){case 11:case 10:d=this.color(e,t,r),p=new s.default.Vector(n,i,o),f=new s.default.Vector(a,l,c);break;case 9:e instanceof s.default.Color?(d=e,p=new s.default.Vector(t,r,n),f=new s.default.Vector(i,o,a),u=l,h=c):n instanceof s.default.Vector?(d=this.color(e,t,r),p=n,f=new s.default.Vector(i,o,a),u=l,h=c):a instanceof s.default.Vector?(d=this.color(e,t,r),p=new s.default.Vector(n,i,o),f=a,u=l,h=c):(d=this.color(e,t,r),p=new s.default.Vector(n,i,o),f=new s.default.Vector(a,l,c));break;case 8:f=e instanceof s.default.Color?(d=e,p=new s.default.Vector(t,r,n),new s.default.Vector(i,o,a)):n instanceof s.default.Vector?(d=this.color(e,t,r),p=n,new s.default.Vector(i,o,a)):(d=this.color(e,t,r),p=new s.default.Vector(n,i,o),a),u=l;break;case 7:e instanceof s.default.Color&&t instanceof s.default.Vector?(d=e,p=t,f=new s.default.Vector(r,n,i),u=o,h=a):e instanceof s.default.Color&&i instanceof s.default.Vector?(d=e,p=new s.default.Vector(t,r,n),f=i,u=o,h=a):n instanceof s.default.Vector&&i instanceof s.default.Vector?(d=this.color(e,t,r),p=n,f=i,u=o,h=a):f=e instanceof s.default.Color?(d=e,p=new s.default.Vector(t,r,n),new s.default.Vector(i,o,a)):n instanceof s.default.Vector?(d=this.color(e,t,r),p=n,new s.default.Vector(i,o,a)):(d=this.color(e,t,r),p=new s.default.Vector(n,i,o),a);break;case 6:n instanceof s.default.Vector&&i instanceof s.default.Vector?(d=this.color(e,t,r),p=n,f=i,u=o):e instanceof s.default.Color&&i instanceof s.default.Vector?(d=e,p=new s.default.Vector(t,r,n),f=i,u=o):e instanceof s.default.Color&&t instanceof s.default.Vector&&(d=e,p=t,f=new s.default.Vector(r,n,i),u=o);break;case 5:e instanceof s.default.Color&&t instanceof s.default.Vector&&r instanceof s.default.Vector?(d=e,p=t,f=r,u=n,h=i):n instanceof s.default.Vector&&i instanceof s.default.Vector?(d=this.color(e,t,r),p=n,f=i):e instanceof s.default.Color&&i instanceof s.default.Vector?(d=e,p=new s.default.Vector(t,r,n),f=i):e instanceof s.default.Color&&t instanceof s.default.Vector&&(d=e,p=t,f=new s.default.Vector(r,n,i));break;case 4:d=e,p=t,f=r,u=n;break;case 3:d=e,p=t,f=r;break;default:return this}return this._renderer.spotLightDiffuseColors.push(d._array[0],d._array[1],d._array[2]),Array.prototype.push.apply(this._renderer.spotLightSpecularColors,this._renderer.specularColors),this._renderer.spotLightPositions.push(p.x,p.y,p.z),f.normalize(),this._renderer.spotLightDirections.push(f.x,f.y,f.z),void 0===u&&(u=Math.PI/3),void 0!==h&&h<1?h=1:void 0===h&&(h=100),u=this._renderer._pInst._toRadians(u),this._renderer.spotLightAngle.push(Math.cos(u)),this._renderer.spotLightConc.push(h),this._renderer._enableLighting=!0,this},s.default.prototype.noLights=function(){return this._assert3d("noLights"),s.default._validateParameters("noLights",arguments),this._renderer._enableLighting=!1,this._renderer.ambientLightColors.length=0,this._renderer.specularColors=[1,1,1],this._renderer.directionalLightDirections.length=0,this._renderer.directionalLightDiffuseColors.length=0,this._renderer.directionalLightSpecularColors.length=0,this._renderer.pointLightPositions.length=0,this._renderer.pointLightDiffuseColors.length=0,this._renderer.pointLightSpecularColors.length=0,this._renderer.spotLightPositions.length=0,this._renderer.spotLightDirections.length=0,this._renderer.spotLightDiffuseColors.length=0,this._renderer.spotLightSpecularColors.length=0,this._renderer.spotLightAngle.length=0,this._renderer.spotLightConc.length=0,this._renderer.constantAttenuation=1,this._renderer.linearAttenuation=0,this._renderer.quadraticAttenuation=0,this._renderer._useShininess=1,this};var l=s.default;r.default=l},{"../core/constants":256,"../core/main":267,"core-js/modules/es.array.iterator":158,"core-js/modules/es.object.get-own-property-descriptor":173,"core-js/modules/es.object.to-string":177,"core-js/modules/es.string.iterator":186,"core-js/modules/es.symbol":196,"core-js/modules/es.symbol.description":194,"core-js/modules/es.symbol.iterator":195,"core-js/modules/es.weak-map":228,"core-js/modules/web.dom-collections.iterator":230}],313:[function(e,t,r){"use strict";e("core-js/modules/es.array.concat"),e("core-js/modules/es.array.index-of"),e("core-js/modules/es.array.slice"),e("core-js/modules/es.array.splice"),e("core-js/modules/es.object.to-string"),e("core-js/modules/es.regexp.exec"),e("core-js/modules/es.string.match"),e("core-js/modules/es.string.split"),e("core-js/modules/es.string.trim"),e("core-js/modules/es.array.concat"),e("core-js/modules/es.array.index-of"),e("core-js/modules/es.array.slice"),e("core-js/modules/es.array.splice"),e("core-js/modules/es.object.to-string"),e("core-js/modules/es.regexp.exec"),e("core-js/modules/es.string.match"),e("core-js/modules/es.string.split"),e("core-js/modules/es.string.trim"),Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n=(i=e("../core/main"))&&i.__esModule?i:{default:i};e("./p5.Geometry"),n.default.prototype.loadModel=function(e){n.default._validateParameters("loadModel",arguments);var t,r,i,s=e.slice(-4),o=("boolean"==typeof arguments[1]?(t=arguments[1],r=arguments[2],i=arguments[3],void 0!==arguments[4]&&(s=arguments[4])):(t=!1,r=arguments[1],i=arguments[2],void 0!==arguments[3]&&(s=arguments[3])),new n.default.Geometry),a=(o.gid="".concat(e,"|").concat(t),this);return s.match(/\.stl$/i)?this.httpDo(e,"GET","arrayBuffer",(function(e){!function(e,t){if(function(e){for(var t=new DataView(e),r=[115,111,108,105,100],n=0;n<5;n++)if(function(e,t,r){for(var n=0,i=e.length;n<i;n++)if(e[n]!==t.getUint8(r+n,!1))return;return 1}(r,t,n))return;return 1}(t))!function(e,t){for(var r,i,s,o,a,l,c,u=new DataView(t),h=u.getUint32(80,!0),d=!1,p=0;p<70;p++)1129270351===u.getUint32(p,!1)&&82===u.getUint8(p+4)&&61===u.getUint8(p+5)&&(d=!0,o=[],a=u.getUint8(p+6)/255,l=u.getUint8(p+7)/255,c=u.getUint8(p+8)/255);for(var f=0;f<h;f++){for(var m,g=84+50*f,y=u.getFloat32(g,!0),v=u.getFloat32(4+g,!0),_=u.getFloat32(8+g,!0),x=(d&&(s=0==(32768&(m=u.getUint16(48+g,!0)))?(r=(31&m)/31,i=(m>>5&31)/31,(m>>10&31)/31):(r=a,i=l,c)),new n.default.Vector(y,v,_)),b=1;b<=3;b++){var w=g+12*b;w=new n.default.Vector(u.getFloat32(w,!0),u.getFloat32(4+w,!0),u.getFloat32(8+w,!0));e.vertices.push(w),e.vertexNormals.push(x),d&&o.push(r,i,s)}e.faces.push([3*f,3*f+1,3*f+2]),e.uvs.push([0,0],[0,0],[0,0])}}(e,t);else{if(t=new DataView(t),!("TextDecoder"in window))return;(function(e,t){for(var r,i,s="",o=[],a=0;a<t.length;++a){for(var l=t[a].trim().split(" "),c=0;c<l.length;++c)""===l[c]&&l.splice(c,1);if(0!==l.length)switch(s){case"":if("solid"!==l[0])return;s="solid";break;case"solid":if("facet"!==l[0]||"normal"!==l[1])return;r=new n.default.Vector(parseFloat(l[2]),parseFloat(l[3]),parseFloat(l[4])),e.vertexNormals.push(r,r,r),s="facet normal";break;case"facet normal":if("outer"!==l[0]||"loop"!==l[1])return;s="vertex";break;case"vertex":if("vertex"===l[0])i=new n.default.Vector(parseFloat(l[1]),parseFloat(l[2]),parseFloat(l[3])),e.vertices.push(i),e.uvs.push([0,0]),o.push(e.vertices.indexOf(i));else{if("endloop"!==l[0])return;e.faces.push(o),o=[],s="endloop"}break;case"endloop":if("endfacet"!==l[0])return;s="endfacet";break;case"endfacet":if("endsolid"!==l[0]){if("facet"!==l[0]||"normal"!==l[1])return;r=new n.default.Vector(parseFloat(l[2]),parseFloat(l[3]),parseFloat(l[4])),e.vertexNormals.push(r,r,r),s="facet normal"}}}})(e,t=new TextDecoder("utf-8").decode(t).split("\n"))}}(o,e),t&&o.normalize(),a._decrementPreload(),"function"==typeof r&&r(o)}),i):s.match(/\.obj$/i)?this.loadStrings(e,(function(e){for(var i=o,s=e,l={v:[],vt:[],vn:[]},c={},u=0;u<s.length;++u){var h=s[u].trim().split(/\b\s+/);if(0<h.length)if("v"===h[0]||"vn"===h[0]){var d=new n.default.Vector(parseFloat(h[1]),parseFloat(h[2]),parseFloat(h[3]));l[h[0]].push(d)}else if("vt"===h[0])d=[parseFloat(h[1]),1-parseFloat(h[2])],l[h[0]].push(d);else if("f"===h[0])for(var p=3;p<h.length;++p){for(var f=[],m=[1,p-1,p],g=0;g<m.length;++g){var y=h[m[g]],v=0;if(void 0!==c[y])v=c[y];else{for(var _=y.split("/"),x=0;x<_.length;x++)_[x]=parseInt(_[x])-1;v=c[y]=i.vertices.length,i.vertices.push(l.v[_[0]].copy()),l.vt[_[1]]?i.uvs.push(l.vt[_[1]].slice()):i.uvs.push([0,0]),l.vn[_[2]]&&i.vertexNormals.push(l.vn[_[2]].copy())}f.push(v)}f[0]!==f[1]&&f[0]!==f[2]&&f[1]!==f[2]&&i.faces.push(f)}}0===i.vertexNormals.length&&i.computeNormals(),t&&o.normalize(),a._decrementPreload(),"function"==typeof r&&r(o)}),i):(n.default._friendlyFileLoadError(3,e),i&&i()),o},n.default.prototype.model=function(e){this._assert3d("model"),n.default._validateParameters("model",arguments),0<e.vertices.length&&(this._renderer.geometryInHash(e.gid)||(e._makeTriangleEdges()._edgesToVertices(),this._renderer.createBuffers(e.gid,e)),this._renderer.drawBuffers(e.gid))};var i=n.default;r.default=i},{"../core/main":267,"./p5.Geometry":316,"core-js/modules/es.array.concat":149,"core-js/modules/es.array.index-of":157,"core-js/modules/es.array.slice":162,"core-js/modules/es.array.splice":164,"core-js/modules/es.object.to-string":177,"core-js/modules/es.regexp.exec":181,"core-js/modules/es.string.match":187,"core-js/modules/es.string.split":191,"core-js/modules/es.string.trim":193}],314:[function(e,t,r){"use strict";function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function i(e){return(i="function"==typeof Symbol&&"symbol"===n(Symbol.iterator)?function(e){return n(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":n(e)})(e)}e("core-js/modules/es.symbol"),e("core-js/modules/es.symbol.description"),e("core-js/modules/es.symbol.iterator"),e("core-js/modules/es.array.iterator"),e("core-js/modules/es.array.join"),e("core-js/modules/es.object.get-own-property-descriptor"),e("core-js/modules/es.object.to-string"),e("core-js/modules/es.string.iterator"),e("core-js/modules/es.weak-map"),e("core-js/modules/web.dom-collections.iterator"),e("core-js/modules/es.array.join"),Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var s=(l=e("../core/main"))&&l.__esModule?l:{default:l},o=function(e){if(e&&e.__esModule)return e;if(null===e||"object"!==i(e)&&"function"!=typeof e)return{default:e};var t=a();if(t&&t.has(e))return t.get(e);var r,n={},s=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(r in e){var o;Object.prototype.hasOwnProperty.call(e,r)&&((o=s?Object.getOwnPropertyDescriptor(e,r):null)&&(o.get||o.set)?Object.defineProperty(n,r,o):n[r]=e[r])}return n.default=e,t&&t.set(e,n),n}(e("../core/constants"));function a(){var e;return"function"!=typeof WeakMap?null:(e=new WeakMap,a=function(){return e},e)}e("./p5.Texture"),s.default.prototype.loadShader=function(e,t,r,n){function i(){a._decrementPreload(),r&&r(o)}s.default._validateParameters("loadShader",arguments),n=n||console.error;var o=new s.default.Shader,a=this,l=!1,c=!1;return this.loadStrings(e,(function(e){o._vertSrc=e.join("\n"),c=!0,l&&i()}),n),this.loadStrings(t,(function(e){o._fragSrc=e.join("\n"),l=!0,c&&i()}),n),o},s.default.prototype.createShader=function(e,t){return this._assert3d("createShader"),s.default._validateParameters("createShader",arguments),new s.default.Shader(this._renderer,e,t)},s.default.prototype.shader=function(e){return this._assert3d("shader"),s.default._validateParameters("shader",arguments),void 0===e._renderer&&(e._renderer=this._renderer),e.init(),e.isStrokeShader()?this._renderer.userStrokeShader=e:(this._renderer.userFillShader=e,this._renderer._useNormalMaterial=!1),this},s.default.prototype.resetShader=function(){return this._renderer.userFillShader=this._renderer.userStrokeShader=null,this},s.default.prototype.texture=function(e){return this._assert3d("texture"),s.default._validateParameters("texture",arguments),e.gifProperties&&e._animateGif(this),this._renderer.drawMode=o.TEXTURE,this._renderer._useSpecularMaterial=!1,this._renderer._useEmissiveMaterial=!1,this._renderer._useNormalMaterial=!1,this._renderer._tex=e,this._renderer._setProperty("_doFill",!0),this},s.default.prototype.textureMode=function(e){e!==o.IMAGE&&e!==o.NORMAL||(this._renderer.textureMode=e)},s.default.prototype.textureWrap=function(e){for(var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:e,r=(this._renderer.textureWrapX=e,this._renderer.textureWrapY=t,this._renderer.textures),n=0;n<r.length;n++)r[n].setWrapMode(e,t)},s.default.prototype.normalMaterial=function(){this._assert3d("normalMaterial");for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return s.default._validateParameters("normalMaterial",t),this._renderer.drawMode=o.FILL,this._renderer._useSpecularMaterial=!1,this._renderer._useEmissiveMaterial=!1,this._renderer._useNormalMaterial=!0,this._renderer.curFillColor=[1,1,1,1],this._renderer._setProperty("_doFill",!0),this.noStroke(),this},s.default.prototype.ambientMaterial=function(e,t,r){this._assert3d("ambientMaterial"),s.default._validateParameters("ambientMaterial",arguments);var n=s.default.prototype.color.apply(this,arguments);return this._renderer.curAmbientColor=n._array,this._renderer._useNormalMaterial=!1,this._renderer._enableLighting=!0,this._renderer._tex=null,this._renderer._setProperty("_doFill",!0),this},s.default.prototype.emissiveMaterial=function(e,t,r,n){this._assert3d("emissiveMaterial"),s.default._validateParameters("emissiveMaterial",arguments);var i=s.default.prototype.color.apply(this,arguments);return this._renderer.curEmissiveColor=i._array,this._renderer._useEmissiveMaterial=!0,this._renderer._useNormalMaterial=!1,this._renderer._enableLighting=!0,this._renderer._tex=null,this},s.default.prototype.specularMaterial=function(e,t,r,n){this._assert3d("specularMaterial"),s.default._validateParameters("specularMaterial",arguments);var i=s.default.prototype.color.apply(this,arguments);return this._renderer.curSpecularColor=i._array,this._renderer._useSpecularMaterial=!0,this._renderer._useNormalMaterial=!1,this._renderer._enableLighting=!0,this._renderer._tex=null,this},s.default.prototype.shininess=function(e){return this._assert3d("shininess"),s.default._validateParameters("shininess",arguments),this._renderer._useShininess=e=e<1?1:e,this},s.default.RendererGL.prototype._applyColorBlend=function(e){var t=this.GL,r=this.drawMode===o.TEXTURE;return(r=this.userFillShader||this.userStrokeShader||this.userPointShader||r||this.curBlendMode!==o.BLEND||e[e.length-1]<1||this._isErasing)!==this._isBlending&&(r||this.curBlendMode!==o.BLEND&&this.curBlendMode!==o.ADD?t.enable(t.BLEND):t.disable(t.BLEND),t.depthMask(!0),this._isBlending=r),this._applyBlendMode(),e},s.default.RendererGL.prototype._applyBlendMode=function(){if(this._cachedBlendMode!==this.curBlendMode){var e=this.GL;switch(this.curBlendMode){case o.BLEND:e.blendEquation(e.FUNC_ADD),e.blendFunc(e.ONE,e.ONE_MINUS_SRC_ALPHA);break;case o.ADD:e.blendEquation(e.FUNC_ADD),e.blendFunc(e.ONE,e.ONE);break;case o.REMOVE:e.blendEquation(e.FUNC_ADD),e.blendFunc(e.ZERO,e.ONE_MINUS_SRC_ALPHA);break;case o.MULTIPLY:e.blendEquation(e.FUNC_ADD),e.blendFunc(e.DST_COLOR,e.ONE_MINUS_SRC_ALPHA);break;case o.SCREEN:e.blendEquation(e.FUNC_ADD),e.blendFunc(e.ONE,e.ONE_MINUS_SRC_COLOR);break;case o.EXCLUSION:e.blendEquationSeparate(e.FUNC_ADD,e.FUNC_ADD),e.blendFuncSeparate(e.ONE_MINUS_DST_COLOR,e.ONE_MINUS_SRC_COLOR,e.ONE,e.ONE);break;case o.REPLACE:e.blendEquation(e.FUNC_ADD),e.blendFunc(e.ONE,e.ZERO);break;case o.SUBTRACT:e.blendEquationSeparate(e.FUNC_REVERSE_SUBTRACT,e.FUNC_ADD),e.blendFuncSeparate(e.ONE,e.ONE,e.ONE,e.ONE_MINUS_SRC_ALPHA);break;case o.DARKEST:this.blendExt&&(e.blendEquationSeparate(this.blendExt.MIN_EXT,e.FUNC_ADD),e.blendFuncSeparate(e.ONE,e.ONE,e.ONE,e.ONE));break;case o.LIGHTEST:this.blendExt&&(e.blendEquationSeparate(this.blendExt.MAX_EXT,e.FUNC_ADD),e.blendFuncSeparate(e.ONE,e.ONE,e.ONE,e.ONE))}this._isErasing||(this._cachedBlendMode=this.curBlendMode)}};var l=s.default;r.default=l},{"../core/constants":256,"../core/main":267,"./p5.Texture":323,"core-js/modules/es.array.iterator":158,"core-js/modules/es.array.join":159,"core-js/modules/es.object.get-own-property-descriptor":173,"core-js/modules/es.object.to-string":177,"core-js/modules/es.string.iterator":186,"core-js/modules/es.symbol":196,"core-js/modules/es.symbol.description":194,"core-js/modules/es.symbol.iterator":195,"core-js/modules/es.weak-map":228,"core-js/modules/web.dom-collections.iterator":230}],315:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n=(e=e("../core/main"))&&e.__esModule?e:{default:e};n.default.prototype.camera=function(){var e;this._assert3d("camera");for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];return n.default._validateParameters("camera",r),(e=this._renderer._curCamera).camera.apply(e,r),this},n.default.prototype.perspective=function(){var e;this._assert3d("perspective");for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];return n.default._validateParameters("perspective",r),(e=this._renderer._curCamera).perspective.apply(e,r),this},n.default.prototype.ortho=function(){var e;this._assert3d("ortho");for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];return n.default._validateParameters("ortho",r),(e=this._renderer._curCamera).ortho.apply(e,r),this},n.default.prototype.frustum=function(){var e;this._assert3d("frustum");for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];return n.default._validateParameters("frustum",r),(e=this._renderer._curCamera).frustum.apply(e,r),this},n.default.prototype.createCamera=function(){this._assert3d("createCamera");var e=new n.default.Camera(this._renderer);return e._computeCameraDefaultSettings(),e._setDefaultCamera(),this._renderer._curCamera=e},n.default.Camera=function(e){this._renderer=e,this.cameraType="default",this.cameraMatrix=new n.default.Matrix,this.projMatrix=new n.default.Matrix},n.default.Camera.prototype.perspective=function(e,t,r,i){this.cameraType=0<arguments.length?"custom":"default",void 0===e?(e=this.defaultCameraFOV,this.cameraFOV=e):this.cameraFOV=this._renderer._pInst._toRadians(e),void 0===t&&(t=this.defaultAspectRatio),void 0===r&&(r=this.defaultCameraNear),void 0===i&&(i=this.defaultCameraFar),r<=1e-4&&(r=.01),this.aspectRatio=t,this.cameraNear=r,this.cameraFar=i,this.projMatrix=n.default.Matrix.identity();e=1/Math.tan(this.cameraFOV/2);var s=1/(this.cameraNear-this.cameraFar);this.projMatrix.set(e/t,0,0,0,0,-e,0,0,0,0,(i+r)*s,-1,0,0,2*i*r*s,0),this._isActive()&&this._renderer.uPMatrix.set(this.projMatrix.mat4[0],this.projMatrix.mat4[1],this.projMatrix.mat4[2],this.projMatrix.mat4[3],this.projMatrix.mat4[4],this.projMatrix.mat4[5],this.projMatrix.mat4[6],this.projMatrix.mat4[7],this.projMatrix.mat4[8],this.projMatrix.mat4[9],this.projMatrix.mat4[10],this.projMatrix.mat4[11],this.projMatrix.mat4[12],this.projMatrix.mat4[13],this.projMatrix.mat4[14],this.projMatrix.mat4[15])},n.default.Camera.prototype.ortho=function(e,t,r,i,s,o){void 0===e&&(e=-this._renderer.width/2),void 0===t&&(t=+this._renderer.width/2),void 0===r&&(r=-this._renderer.height/2),void 0===s&&(s=0);var a=t-e,l=(i=void 0===i?+this._renderer.height/2:i)-r,c=(o=void 0===o?Math.max(this._renderer.width,this._renderer.height):o)-s,u=2/a,h=2/l,d=-2/c;t=-(t+e)/a,e=-(i+r)/l,a=-(o+s)/c;this.projMatrix=n.default.Matrix.identity(),this.projMatrix.set(u,0,0,0,0,-h,0,0,0,0,d,0,t,e,a,1),this._isActive()&&this._renderer.uPMatrix.set(this.projMatrix.mat4[0],this.projMatrix.mat4[1],this.projMatrix.mat4[2],this.projMatrix.mat4[3],this.projMatrix.mat4[4],this.projMatrix.mat4[5],this.projMatrix.mat4[6],this.projMatrix.mat4[7],this.projMatrix.mat4[8],this.projMatrix.mat4[9],this.projMatrix.mat4[10],this.projMatrix.mat4[11],this.projMatrix.mat4[12],this.projMatrix.mat4[13],this.projMatrix.mat4[14],this.projMatrix.mat4[15]),this.cameraType="custom"},n.default.Camera.prototype.frustum=function(e,t,r,i,s,o){void 0===e&&(e=-this._renderer.width/2),void 0===t&&(t=+this._renderer.width/2),void 0===r&&(r=-this._renderer.height/2),void 0===s&&(s=0);var a=t-e,l=(i=void 0===i?+this._renderer.height/2:i)-r,c=(o=void 0===o?Math.max(this._renderer.width,this._renderer.height):o)-s,u=2*s/a,h=2*s/l,d=-2*o*s/c;t=(t+e)/a,e=(i+r)/l,a=-(o+s)/c;this.projMatrix=n.default.Matrix.identity(),this.projMatrix.set(u,0,0,0,0,h,0,0,t,e,a,-1,0,0,d,0),this._isActive()&&this._renderer.uPMatrix.set(this.projMatrix.mat4[0],this.projMatrix.mat4[1],this.projMatrix.mat4[2],this.projMatrix.mat4[3],this.projMatrix.mat4[4],this.projMatrix.mat4[5],this.projMatrix.mat4[6],this.projMatrix.mat4[7],this.projMatrix.mat4[8],this.projMatrix.mat4[9],this.projMatrix.mat4[10],this.projMatrix.mat4[11],this.projMatrix.mat4[12],this.projMatrix.mat4[13],this.projMatrix.mat4[14],this.projMatrix.mat4[15]),this.cameraType="custom"},n.default.Camera.prototype._rotateView=function(e,t,r,i){var s=this.centerX,o=this.centerY,a=this.centerZ,l=(s-=this.eyeX,o-=this.eyeY,a-=this.eyeZ,n.default.Matrix.identity(this._renderer._pInst));(e=(l.rotate(this._renderer._pInst._toRadians(e),t,r,i),[s*l.mat4[0]+o*l.mat4[4]+a*l.mat4[8],s*l.mat4[1]+o*l.mat4[5]+a*l.mat4[9],s*l.mat4[2]+o*l.mat4[6]+a*l.mat4[10]]))[0]+=this.eyeX,e[1]+=this.eyeY,e[2]+=this.eyeZ,this.camera(this.eyeX,this.eyeY,this.eyeZ,e[0],e[1],e[2],this.upX,this.upY,this.upZ)},n.default.Camera.prototype.pan=function(e){var t=this._getLocalAxes();this._rotateView(e,t.y[0],t.y[1],t.y[2])},n.default.Camera.prototype.tilt=function(e){var t=this._getLocalAxes();this._rotateView(e,t.x[0],t.x[1],t.x[2])},n.default.Camera.prototype.lookAt=function(e,t,r){this.camera(this.eyeX,this.eyeY,this.eyeZ,e,t,r,this.upX,this.upY,this.upZ)},n.default.Camera.prototype.camera=function(e,t,r,n,i,s,o,a,l){return void 0===e&&(e=this.defaultEyeX,t=this.defaultEyeY,r=this.defaultEyeZ,n=e,i=t,a=1,l=o=s=0),this.eyeX=e,this.eyeY=t,this.eyeZ=r,void 0!==n&&(this.centerX=n,this.centerY=i,this.centerZ=s),void 0!==o&&(this.upX=o,this.upY=a,this.upZ=l),n=this._getLocalAxes(),this.cameraMatrix.set(n.x[0],n.y[0],n.z[0],0,n.x[1],n.y[1],n.z[1],0,n.x[2],n.y[2],n.z[2],0,0,0,0,1),i=-e,this.cameraMatrix.translate([i,-t,-r]),this._isActive()&&this._renderer.uMVMatrix.set(this.cameraMatrix.mat4[0],this.cameraMatrix.mat4[1],this.cameraMatrix.mat4[2],this.cameraMatrix.mat4[3],this.cameraMatrix.mat4[4],this.cameraMatrix.mat4[5],this.cameraMatrix.mat4[6],this.cameraMatrix.mat4[7],this.cameraMatrix.mat4[8],this.cameraMatrix.mat4[9],this.cameraMatrix.mat4[10],this.cameraMatrix.mat4[11],this.cameraMatrix.mat4[12],this.cameraMatrix.mat4[13],this.cameraMatrix.mat4[14],this.cameraMatrix.mat4[15]),this},n.default.Camera.prototype.move=function(e,t,r){e=[(n=this._getLocalAxes()).x[0]*e,n.x[1]*e,n.x[2]*e],t=[n.y[0]*t,n.y[1]*t,n.y[2]*t];var n=[n.z[0]*r,n.z[1]*r,n.z[2]*r];this.camera(this.eyeX+e[0]+t[0]+n[0],this.eyeY+e[1]+t[1]+n[1],this.eyeZ+e[2]+t[2]+n[2],this.centerX+e[0]+t[0]+n[0],this.centerY+e[1]+t[1]+n[1],this.centerZ+e[2]+t[2]+n[2],this.upX,this.upY,this.upZ)},n.default.Camera.prototype.setPosition=function(e,t,r){var n=e-this.eyeX,i=t-this.eyeY,s=r-this.eyeZ;this.camera(e,t,r,this.centerX+n,this.centerY+i,this.centerZ+s,this.upX,this.upY,this.upZ)},n.default.Camera.prototype._computeCameraDefaultSettings=function(){this.defaultCameraFOV=60/180*Math.PI,this.defaultAspectRatio=this._renderer.width/this._renderer.height,this.defaultEyeX=0,this.defaultEyeY=0,this.defaultEyeZ=this._renderer.height/2/Math.tan(this.defaultCameraFOV/2),this.defaultCenterX=0,this.defaultCenterY=0,this.defaultCenterZ=0,this.defaultCameraNear=.1*this.defaultEyeZ,this.defaultCameraFar=10*this.defaultEyeZ},n.default.Camera.prototype._setDefaultCamera=function(){this.cameraFOV=this.defaultCameraFOV,this.aspectRatio=this.defaultAspectRatio,this.eyeX=this.defaultEyeX,this.eyeY=this.defaultEyeY,this.eyeZ=this.defaultEyeZ,this.centerX=this.defaultCenterX,this.centerY=this.defaultCenterY,this.centerZ=this.defaultCenterZ,this.upX=0,this.upY=1,this.upZ=0,this.cameraNear=this.defaultCameraNear,this.cameraFar=this.defaultCameraFar,this.perspective(),this.camera(),this.cameraType="default"},n.default.Camera.prototype._resize=function(){"default"===this.cameraType?(this._computeCameraDefaultSettings(),this._setDefaultCamera()):this.perspective(this.cameraFOV,this._renderer.width/this._renderer.height)},n.default.Camera.prototype.copy=function(){var e=new n.default.Camera(this._renderer);return e.cameraFOV=this.cameraFOV,e.aspectRatio=this.aspectRatio,e.eyeX=this.eyeX,e.eyeY=this.eyeY,e.eyeZ=this.eyeZ,e.centerX=this.centerX,e.centerY=this.centerY,e.centerZ=this.centerZ,e.cameraNear=this.cameraNear,e.cameraFar=this.cameraFar,e.cameraType=this.cameraType,e.cameraMatrix=this.cameraMatrix.copy(),e.projMatrix=this.projMatrix.copy(),e},n.default.Camera.prototype._getLocalAxes=function(){var e,t=this.eyeX-this.centerX,r=this.eyeY-this.centerY,n=this.eyeZ-this.centerZ,i=(0!==(i=Math.sqrt(t*t+r*r+n*n))&&(t/=i,r/=i,n/=i),this.upX),s=(l=this.upY)*n-(c=this.upZ)*r,o=-i*n+c*t,a=i*r-l*t,l=(i=r*a-n*o,-t*a+n*s),c=t*o-r*s;return 0!==(e=(0!==(e=Math.sqrt(s*s+o*o+a*a))&&(s/=e,o/=e,a/=e),Math.sqrt(i*i+l*l+c*c)))&&(i/=e,l/=e,c/=e),{x:[s,o,a],y:[i,l,c],z:[t,r,n]}},n.default.Camera.prototype._orbit=function(e,t,r){var n=this.eyeX-this.centerX,i=this.eyeY-this.centerY,s=this.eyeZ-this.centerZ,o=Math.sqrt(n*n+i*i+s*s);n=Math.atan2(n,s),s=Math.acos(Math.max(-1,Math.min(1,i/o))),n+=(i=0<this.upY?1:-1)*e,((s+=i*t)<=0||s>=Math.PI)&&(i*=-1),(o+=r)<0&&(o=.1),e=Math.sin(s)*o*Math.sin(n),t=Math.cos(s)*o,r=Math.sin(s)*o*Math.cos(n);this.camera(e+this.centerX,t+this.centerY,r+this.centerZ,this.centerX,this.centerY,this.centerZ,0,i,0)},n.default.Camera.prototype._isActive=function(){return this===this._renderer._curCamera},n.default.prototype.setCamera=function(e){this._renderer._curCamera=e,this._renderer.uPMatrix.set(e.projMatrix.mat4[0],e.projMatrix.mat4[1],e.projMatrix.mat4[2],e.projMatrix.mat4[3],e.projMatrix.mat4[4],e.projMatrix.mat4[5],e.projMatrix.mat4[6],e.projMatrix.mat4[7],e.projMatrix.mat4[8],e.projMatrix.mat4[9],e.projMatrix.mat4[10],e.projMatrix.mat4[11],e.projMatrix.mat4[12],e.projMatrix.mat4[13],e.projMatrix.mat4[14],e.projMatrix.mat4[15])},e=n.default.Camera,r.default=e},{"../core/main":267}],316:[function(e,t,r){"use strict";e("core-js/modules/es.array.slice"),e("core-js/modules/es.string.sub"),e("core-js/modules/es.array.slice"),e("core-js/modules/es.string.sub"),Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n=(e=e("../core/main"))&&e.__esModule?e:{default:e};n.default.Geometry=function(e,t,r){return this.vertices=[],this.lineVertices=[],this.lineTangentsIn=[],this.lineTangentsOut=[],this.lineSides=[],this.vertexNormals=[],this.faces=[],this.uvs=[],this.edges=[],this.vertexColors=[],this.vertexStrokeColors=[],this.lineVertexColors=[],this.detailX=void 0!==e?e:1,this.detailY=void 0!==t?t:1,this.dirtyFlags={},r instanceof Function&&r.call(this),this},n.default.Geometry.prototype.reset=function(){this.lineVertices.length=0,this.lineTangentsIn.length=0,this.lineTangentsOut.length=0,this.lineSides.length=0,this.vertices.length=0,this.edges.length=0,this.vertexColors.length=0,this.vertexStrokeColors.length=0,this.lineVertexColors.length=0,this.vertexNormals.length=0,this.uvs.length=0,this.dirtyFlags={}},n.default.Geometry.prototype.computeFaces=function(){this.faces.length=0;for(var e,t,r,n=this.detailX+1,i=0;i<this.detailY;i++)for(var s=0;s<this.detailX;s++)t=(i+1)*n+s+1,this.faces.push([i*n+s,e=i*n+s+1,r=(i+1)*n+s]),this.faces.push([r,e,t]);return this},n.default.Geometry.prototype._getFaceNormal=function(e){e=this.faces[e];var t=this.vertices[e[0]],r=this.vertices[e[1]],i=(e=this.vertices[e[2]],r=n.default.Vector.sub(r,t),e=n.default.Vector.sub(e,t),t=n.default.Vector.cross(r,e),n.default.Vector.mag(t));return 0===(r=i/(n.default.Vector.mag(r)*n.default.Vector.mag(e)))||isNaN(r)?t:(1<r&&(r=1),t.mult(Math.asin(r)/i))},n.default.Geometry.prototype.computeNormals=function(){for(var e=this.vertexNormals,t=this.vertices,r=this.faces,i=e.length=0;i<t.length;++i)e.push(new n.default.Vector);for(var s=0;s<r.length;++s)for(var o=r[s],a=this._getFaceNormal(s),l=0;l<3;++l)e[o[l]].add(a);for(i=0;i<t.length;++i)e[i].normalize();return this},n.default.Geometry.prototype.averageNormals=function(){for(var e=0;e<=this.detailY;e++){var t=this.detailX+1,r=n.default.Vector.add(this.vertexNormals[e*t],this.vertexNormals[e*t+this.detailX]);r=n.default.Vector.div(r,2);this.vertexNormals[e*t]=r,this.vertexNormals[e*t+this.detailX]=r}return this},n.default.Geometry.prototype.averagePoleNormals=function(){for(var e=new n.default.Vector(0,0,0),t=0;t<this.detailX;t++)e.add(this.vertexNormals[t]);e=n.default.Vector.div(e,this.detailX);for(var r=0;r<this.detailX;r++)this.vertexNormals[r]=e;e=new n.default.Vector(0,0,0);for(var i=this.vertices.length-1;i>this.vertices.length-1-this.detailX;i--)e.add(this.vertexNormals[i]);e=n.default.Vector.div(e,this.detailX);for(var s=this.vertices.length-1;s>this.vertices.length-1-this.detailX;s--)this.vertexNormals[s]=e;return this},n.default.Geometry.prototype._makeTriangleEdges=function(){if(this.edges.length=0,Array.isArray(this.strokeIndices))for(var e=0,t=this.strokeIndices.length;e<t;e++)this.edges.push(this.strokeIndices[e]);else for(var r=0;r<this.faces.length;r++)this.edges.push([this.faces[r][0],this.faces[r][1]]),this.edges.push([this.faces[r][1],this.faces[r][2]]),this.edges.push([this.faces[r][2],this.faces[r][0]]);return this},n.default.Geometry.prototype._edgesToVertices=function(){this.lineVertices.length=0,this.lineTangentsIn.length=0,this.lineTangentsOut.length=0,this.lineSides.length=0;for(var e,t=1<this.edges.length&&this.edges[0][0]===this.edges[this.edges.length-1][1],r=!1,n=0;n<this.edges.length;n++){var i=this.edges[n-1],s=this.edges[n],o=this.vertices[s[0]],a=this.vertices[s[1]],l=0<this.vertexStrokeColors.length?this.vertexStrokeColors.slice(4*s[0],4*(s[0]+1)):[0,0,0,0],c=0<this.vertexStrokeColors.length?this.vertexStrokeColors.slice(4*s[1],4*(s[1]+1)):[0,0,0,0],u=a.copy().sub(o).normalize(),h=0<u.magSq();h&&this._addSegment(o,a,l,c,u),0<n&&i[1]===s[0]?(e&&h&&u.dot(e)<1-1e-8&&this._addJoin(o,e,u,l),!h||r||t||(this._addCap(o,u.copy().mult(-1),l),r=!0)):(r=!1,h&&(!t||0<n)&&(this._addCap(o,u.copy().mult(-1),l),r=!0),e&&(!t||n<this.edges.length-1)&&(this._addCap(this.vertices[i[1]],e,l),e=void 0)),n===this.edges.length-1&&(t?this._addJoin(a,u,this.vertices[this.edges[0][1]].copy().sub(a).normalize(),c):this._addCap(a,u,c)),h&&(e=u)}return this},n.default.Geometry.prototype._addSegment=function(e,t,r,n,i){e=e.array(),t=t.array();var s=i.array();this.lineSides.push(1,-1,1,1,-1,-1);for(var o=0,a=[this.lineTangentsIn,this.lineTangentsOut];o<a.length;o++)a[o].push(s,s,s,s,s,s);return this.lineVertices.push(e,e,t,t,e,t),this.lineVertexColors.push(r,r,n,n,r,n),this},n.default.Geometry.prototype._addCap=function(e,t,r){for(var n=e.array(),i=t.array(),s=[0,0,0],o=0;o<6;o++)this.lineVertices.push(n),this.lineTangentsIn.push(i),this.lineTangentsOut.push(s),this.lineVertexColors.push(r);return this.lineSides.push(-1,-2,2,2,1,-1),this},n.default.Geometry.prototype._addJoin=function(e,t,r,n){for(var i=e.array(),s=t.array(),o=r.array(),a=0;a<12;a++)this.lineVertices.push(i),this.lineTangentsIn.push(s),this.lineTangentsOut.push(o),this.lineVertexColors.push(n);for(var l=0,c=[-1,1];l<c.length;l++){var u=c[l];this.lineSides.push(u,2*u,3*u,u,3*u,0)}return this},n.default.Geometry.prototype.normalize=function(){if(0<this.vertices.length){for(var e=this.vertices[0].copy(),t=this.vertices[0].copy(),r=0;r<this.vertices.length;r++)e.x=Math.max(e.x,this.vertices[r].x),t.x=Math.min(t.x,this.vertices[r].x),e.y=Math.max(e.y,this.vertices[r].y),t.y=Math.min(t.y,this.vertices[r].y),e.z=Math.max(e.z,this.vertices[r].z),t.z=Math.min(t.z,this.vertices[r].z);for(var i=n.default.Vector.lerp(e,t,.5),s=n.default.Vector.sub(e,t),o=200/Math.max(Math.max(s.x,s.y),s.z),a=0;a<this.vertices.length;a++)this.vertices[a].sub(i),this.vertices[a].mult(o)}return this},e=n.default.Geometry,r.default=e},{"../core/main":267,"core-js/modules/es.array.slice":162,"core-js/modules/es.string.sub":192}],317:[function(e,t,r){"use strict";e("core-js/modules/es.array.iterator"),e("core-js/modules/es.object.to-string"),e("core-js/modules/es.typed-array.float32-array"),e("core-js/modules/es.typed-array.copy-within"),e("core-js/modules/es.typed-array.every"),e("core-js/modules/es.typed-array.fill"),e("core-js/modules/es.typed-array.filter"),e("core-js/modules/es.typed-array.find"),e("core-js/modules/es.typed-array.find-index"),e("core-js/modules/es.typed-array.for-each"),e("core-js/modules/es.typed-array.includes"),e("core-js/modules/es.typed-array.index-of"),e("core-js/modules/es.typed-array.iterator"),e("core-js/modules/es.typed-array.join"),e("core-js/modules/es.typed-array.last-index-of"),e("core-js/modules/es.typed-array.map"),e("core-js/modules/es.typed-array.reduce"),e("core-js/modules/es.typed-array.reduce-right"),e("core-js/modules/es.typed-array.reverse"),e("core-js/modules/es.typed-array.set"),e("core-js/modules/es.typed-array.slice"),e("core-js/modules/es.typed-array.some"),e("core-js/modules/es.typed-array.sort"),e("core-js/modules/es.typed-array.subarray"),e("core-js/modules/es.typed-array.to-locale-string"),e("core-js/modules/es.typed-array.to-string"),e("core-js/modules/es.array.iterator"),e("core-js/modules/es.object.to-string"),e("core-js/modules/es.typed-array.float32-array"),e("core-js/modules/es.typed-array.copy-within"),e("core-js/modules/es.typed-array.every"),e("core-js/modules/es.typed-array.fill"),e("core-js/modules/es.typed-array.filter"),e("core-js/modules/es.typed-array.find"),e("core-js/modules/es.typed-array.find-index"),e("core-js/modules/es.typed-array.for-each"),e("core-js/modules/es.typed-array.includes"),e("core-js/modules/es.typed-array.index-of"),e("core-js/modules/es.typed-array.iterator"),e("core-js/modules/es.typed-array.join"),e("core-js/modules/es.typed-array.last-index-of"),e("core-js/modules/es.typed-array.map"),e("core-js/modules/es.typed-array.reduce"),e("core-js/modules/es.typed-array.reduce-right"),e("core-js/modules/es.typed-array.reverse"),e("core-js/modules/es.typed-array.set"),e("core-js/modules/es.typed-array.slice"),e("core-js/modules/es.typed-array.some"),e("core-js/modules/es.typed-array.sort"),e("core-js/modules/es.typed-array.subarray"),e("core-js/modules/es.typed-array.to-locale-string"),e("core-js/modules/es.typed-array.to-string"),Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n=(e=e("../core/main"))&&e.__esModule?e:{default:e},i=Array,s=function(e){return e instanceof Array};"undefined"!=typeof Float32Array&&(i=Float32Array,s=function(e){return e instanceof Array||e instanceof Float32Array}),n.default.Matrix=function(){for(var e=new Array(arguments.length),t=0;t<e.length;++t)e[t]=arguments[t];return e.length&&e[e.length-1]instanceof n.default&&(this.p5=e[e.length-1]),"mat3"===e[0]?this.mat3=Array.isArray(e[1])?e[1]:new i([1,0,0,0,1,0,0,0,1]):this.mat4=Array.isArray(e[0])?e[0]:new i([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]),this},n.default.Matrix.prototype.set=function(e){return e instanceof n.default.Matrix?this.mat4=e.mat4:s(e)?this.mat4=e:16===arguments.length&&(this.mat4[0]=e,this.mat4[1]=arguments[1],this.mat4[2]=arguments[2],this.mat4[3]=arguments[3],this.mat4[4]=arguments[4],this.mat4[5]=arguments[5],this.mat4[6]=arguments[6],this.mat4[7]=arguments[7],this.mat4[8]=arguments[8],this.mat4[9]=arguments[9],this.mat4[10]=arguments[10],this.mat4[11]=arguments[11],this.mat4[12]=arguments[12],this.mat4[13]=arguments[13],this.mat4[14]=arguments[14],this.mat4[15]=arguments[15]),this},n.default.Matrix.prototype.get=function(){return new n.default.Matrix(this.mat4,this.p5)},n.default.Matrix.prototype.copy=function(){var e=new n.default.Matrix(this.p5);return e.mat4[0]=this.mat4[0],e.mat4[1]=this.mat4[1],e.mat4[2]=this.mat4[2],e.mat4[3]=this.mat4[3],e.mat4[4]=this.mat4[4],e.mat4[5]=this.mat4[5],e.mat4[6]=this.mat4[6],e.mat4[7]=this.mat4[7],e.mat4[8]=this.mat4[8],e.mat4[9]=this.mat4[9],e.mat4[10]=this.mat4[10],e.mat4[11]=this.mat4[11],e.mat4[12]=this.mat4[12],e.mat4[13]=this.mat4[13],e.mat4[14]=this.mat4[14],e.mat4[15]=this.mat4[15],e},n.default.Matrix.identity=function(e){return new n.default.Matrix(e)},n.default.Matrix.prototype.transpose=function(e){var t,r,i,o,a,l;return e instanceof n.default.Matrix?(t=e.mat4[1],r=e.mat4[2],i=e.mat4[3],o=e.mat4[6],a=e.mat4[7],l=e.mat4[11],this.mat4[0]=e.mat4[0],this.mat4[1]=e.mat4[4],this.mat4[2]=e.mat4[8],this.mat4[3]=e.mat4[12],this.mat4[4]=t,this.mat4[5]=e.mat4[5],this.mat4[6]=e.mat4[9],this.mat4[7]=e.mat4[13],this.mat4[8]=r,this.mat4[9]=o,this.mat4[10]=e.mat4[10],this.mat4[11]=e.mat4[14],this.mat4[12]=i,this.mat4[13]=a,this.mat4[14]=l,this.mat4[15]=e.mat4[15]):s(e)&&(t=e[1],r=e[2],i=e[3],o=e[6],a=e[7],l=e[11],this.mat4[0]=e[0],this.mat4[1]=e[4],this.mat4[2]=e[8],this.mat4[3]=e[12],this.mat4[4]=t,this.mat4[5]=e[5],this.mat4[6]=e[9],this.mat4[7]=e[13],this.mat4[8]=r,this.mat4[9]=o,this.mat4[10]=e[10],this.mat4[11]=e[14],this.mat4[12]=i,this.mat4[13]=a,this.mat4[14]=l,this.mat4[15]=e[15]),this},n.default.Matrix.prototype.invert=function(e){e instanceof n.default.Matrix?(t=e.mat4[0],r=e.mat4[1],i=e.mat4[2],o=e.mat4[3],a=e.mat4[4],l=e.mat4[5],c=e.mat4[6],u=e.mat4[7],h=e.mat4[8],d=e.mat4[9],p=e.mat4[10],f=e.mat4[11],m=e.mat4[12],g=e.mat4[13],y=e.mat4[14],v=e.mat4[15]):s(e)&&(t=e[0],r=e[1],i=e[2],o=e[3],a=e[4],l=e[5],c=e[6],u=e[7],h=e[8],d=e[9],p=e[10],f=e[11],m=e[12],g=e[13],y=e[14],v=e[15]);var t,r,i,o,a,l,c,u,h,d,p,f,m,g,y,v,_=t*c-i*a,x=t*u-o*a,b=r*c-i*l,w=r*u-o*l,S=i*u-o*c,M=h*g-d*m,T=h*y-p*m,E=h*v-f*m,A=d*y-p*g,C=d*v-f*g,L=p*v-f*y,R=(e=t*l-r*a)*L-_*C+x*A+b*E-w*T+S*M;return R?(this.mat4[0]=(l*L-c*C+u*A)*(R=1/R),this.mat4[1]=(i*C-r*L-o*A)*R,this.mat4[2]=(g*S-y*w+v*b)*R,this.mat4[3]=(p*w-d*S-f*b)*R,this.mat4[4]=(c*E-a*L-u*T)*R,this.mat4[5]=(t*L-i*E+o*T)*R,this.mat4[6]=(y*x-m*S-v*_)*R,this.mat4[7]=(h*S-p*x+f*_)*R,this.mat4[8]=(a*C-l*E+u*M)*R,this.mat4[9]=(r*E-t*C-o*M)*R,this.mat4[10]=(m*w-g*x+v*e)*R,this.mat4[11]=(d*x-h*w-f*e)*R,this.mat4[12]=(l*T-a*A-c*M)*R,this.mat4[13]=(t*A-r*T+i*M)*R,this.mat4[14]=(g*_-m*b-y*e)*R,this.mat4[15]=(h*b-d*_+p*e)*R,this):null},n.default.Matrix.prototype.invert3x3=function(){var e=this.mat3[0],t=this.mat3[1],r=this.mat3[2],n=this.mat3[3],i=this.mat3[4],s=this.mat3[5],o=this.mat3[6],a=this.mat3[7],l=this.mat3[8],c=l*i-s*a,u=-l*n+s*o,h=a*n-i*o,d=e*c+t*u+r*h;return d?(this.mat3[0]=c*(d=1/d),this.mat3[1]=(-l*t+r*a)*d,this.mat3[2]=(s*t-r*i)*d,this.mat3[3]=u*d,this.mat3[4]=(l*e-r*o)*d,this.mat3[5]=(-s*e+r*n)*d,this.mat3[6]=h*d,this.mat3[7]=(-a*e+t*o)*d,this.mat3[8]=(i*e-t*n)*d,this):null},n.default.Matrix.prototype.transpose3x3=function(e){var t=e[1],r=e[2],n=e[5];return this.mat3[1]=e[3],this.mat3[2]=e[6],this.mat3[3]=t,this.mat3[5]=e[7],this.mat3[6]=r,this.mat3[7]=n,this},n.default.Matrix.prototype.inverseTranspose=function(e){if(void 0===this.mat3||(this.mat3[0]=e.mat4[0],this.mat3[1]=e.mat4[1],this.mat3[2]=e.mat4[2],this.mat3[3]=e.mat4[4],this.mat3[4]=e.mat4[5],this.mat3[5]=e.mat4[6],this.mat3[6]=e.mat4[8],this.mat3[7]=e.mat4[9],this.mat3[8]=e.mat4[10]),e=this.invert3x3())e.transpose3x3(this.mat3);else for(var t=0;t<9;t++)this.mat3[t]=0;return this},n.default.Matrix.prototype.determinant=function(){var e=this.mat4[0]*this.mat4[5]-this.mat4[1]*this.mat4[4],t=this.mat4[0]*this.mat4[6]-this.mat4[2]*this.mat4[4],r=this.mat4[0]*this.mat4[7]-this.mat4[3]*this.mat4[4],n=this.mat4[1]*this.mat4[6]-this.mat4[2]*this.mat4[5],i=this.mat4[1]*this.mat4[7]-this.mat4[3]*this.mat4[5],s=this.mat4[2]*this.mat4[7]-this.mat4[3]*this.mat4[6],o=this.mat4[8]*this.mat4[13]-this.mat4[9]*this.mat4[12],a=this.mat4[8]*this.mat4[14]-this.mat4[10]*this.mat4[12],l=this.mat4[8]*this.mat4[15]-this.mat4[11]*this.mat4[12],c=this.mat4[9]*this.mat4[14]-this.mat4[10]*this.mat4[13],u=this.mat4[9]*this.mat4[15]-this.mat4[11]*this.mat4[13];return e*(this.mat4[10]*this.mat4[15]-this.mat4[11]*this.mat4[14])-t*u+r*c+n*l-i*a+s*o},n.default.Matrix.prototype.mult=function(e){var t;if(e===this||e===this.mat4)t=this.copy().mat4;else if(e instanceof n.default.Matrix)t=e.mat4;else if(s(e))t=e;else{if(16!==arguments.length)return;t=arguments}e=this.mat4[0];var r=this.mat4[1],i=this.mat4[2],o=this.mat4[3];return this.mat4[0]=e*t[0]+r*t[4]+i*t[8]+o*t[12],this.mat4[1]=e*t[1]+r*t[5]+i*t[9]+o*t[13],this.mat4[2]=e*t[2]+r*t[6]+i*t[10]+o*t[14],this.mat4[3]=e*t[3]+r*t[7]+i*t[11]+o*t[15],e=this.mat4[4],r=this.mat4[5],i=this.mat4[6],o=this.mat4[7],this.mat4[4]=e*t[0]+r*t[4]+i*t[8]+o*t[12],this.mat4[5]=e*t[1]+r*t[5]+i*t[9]+o*t[13],this.mat4[6]=e*t[2]+r*t[6]+i*t[10]+o*t[14],this.mat4[7]=e*t[3]+r*t[7]+i*t[11]+o*t[15],e=this.mat4[8],r=this.mat4[9],i=this.mat4[10],o=this.mat4[11],this.mat4[8]=e*t[0]+r*t[4]+i*t[8]+o*t[12],this.mat4[9]=e*t[1]+r*t[5]+i*t[9]+o*t[13],this.mat4[10]=e*t[2]+r*t[6]+i*t[10]+o*t[14],this.mat4[11]=e*t[3]+r*t[7]+i*t[11]+o*t[15],e=this.mat4[12],r=this.mat4[13],i=this.mat4[14],o=this.mat4[15],this.mat4[12]=e*t[0]+r*t[4]+i*t[8]+o*t[12],this.mat4[13]=e*t[1]+r*t[5]+i*t[9]+o*t[13],this.mat4[14]=e*t[2]+r*t[6]+i*t[10]+o*t[14],this.mat4[15]=e*t[3]+r*t[7]+i*t[11]+o*t[15],this},n.default.Matrix.prototype.apply=function(e){var t;if(e===this||e===this.mat4)t=this.copy().mat4;else if(e instanceof n.default.Matrix)t=e.mat4;else if(s(e))t=e;else{if(16!==arguments.length)return;t=arguments}var r=(e=this.mat4)[0],i=e[4],o=e[8],a=e[12];e[0]=t[0]*r+t[1]*i+t[2]*o+t[3]*a,e[4]=t[4]*r+t[5]*i+t[6]*o+t[7]*a,e[8]=t[8]*r+t[9]*i+t[10]*o+t[11]*a,e[12]=t[12]*r+t[13]*i+t[14]*o+t[15]*a,r=e[1],i=e[5],o=e[9],a=e[13],e[1]=t[0]*r+t[1]*i+t[2]*o+t[3]*a,e[5]=t[4]*r+t[5]*i+t[6]*o+t[7]*a,e[9]=t[8]*r+t[9]*i+t[10]*o+t[11]*a,e[13]=t[12]*r+t[13]*i+t[14]*o+t[15]*a,r=e[2],i=e[6],o=e[10],a=e[14],e[2]=t[0]*r+t[1]*i+t[2]*o+t[3]*a,e[6]=t[4]*r+t[5]*i+t[6]*o+t[7]*a,e[10]=t[8]*r+t[9]*i+t[10]*o+t[11]*a,e[14]=t[12]*r+t[13]*i+t[14]*o+t[15]*a,r=e[3],i=e[7],o=e[11],a=e[15];return e[3]=t[0]*r+t[1]*i+t[2]*o+t[3]*a,e[7]=t[4]*r+t[5]*i+t[6]*o+t[7]*a,e[11]=t[8]*r+t[9]*i+t[10]*o+t[11]*a,e[15]=t[12]*r+t[13]*i+t[14]*o+t[15]*a,this},n.default.Matrix.prototype.scale=function(e,t,r){return e instanceof n.default.Vector?(t=e.y,r=e.z,e=e.x):e instanceof Array&&(t=e[1],r=e[2],e=e[0]),this.mat4[0]*=e,this.mat4[1]*=e,this.mat4[2]*=e,this.mat4[3]*=e,this.mat4[4]*=t,this.mat4[5]*=t,this.mat4[6]*=t,this.mat4[7]*=t,this.mat4[8]*=r,this.mat4[9]*=r,this.mat4[10]*=r,this.mat4[11]*=r,this},n.default.Matrix.prototype.rotate=function(e,t,r,i){t instanceof n.default.Vector?(r=t.y,i=t.z,t=t.x):t instanceof Array&&(r=t[1],i=t[2],t=t[0]);var s=(t*=1/(s=Math.sqrt(t*t+r*r+i*i)),r*=1/s,i*=1/s,this.mat4[0]),o=this.mat4[1],a=this.mat4[2],l=this.mat4[3],c=this.mat4[4],u=this.mat4[5],h=this.mat4[6],d=this.mat4[7],p=this.mat4[8],f=this.mat4[9],m=this.mat4[10],g=this.mat4[11],y=Math.sin(e),v=1-(e=Math.cos(e)),_=t*t*v+e,x=r*t*v+i*y,b=i*t*v-r*y,w=t*r*v-i*y,S=r*r*v+e,M=i*r*v+t*y,T=t*i*v+r*y;r=r*i*v-t*y,t=i*i*v+e;return this.mat4[0]=s*_+c*x+p*b,this.mat4[1]=o*_+u*x+f*b,this.mat4[2]=a*_+h*x+m*b,this.mat4[3]=l*_+d*x+g*b,this.mat4[4]=s*w+c*S+p*M,this.mat4[5]=o*w+u*S+f*M,this.mat4[6]=a*w+h*S+m*M,this.mat4[7]=l*w+d*S+g*M,this.mat4[8]=s*T+c*r+p*t,this.mat4[9]=o*T+u*r+f*t,this.mat4[10]=a*T+h*r+m*t,this.mat4[11]=l*T+d*r+g*t,this},n.default.Matrix.prototype.translate=function(e){var t=e[0],r=e[1];e=e[2]||0;this.mat4[12]+=this.mat4[0]*t+this.mat4[4]*r+this.mat4[8]*e,this.mat4[13]+=this.mat4[1]*t+this.mat4[5]*r+this.mat4[9]*e,this.mat4[14]+=this.mat4[2]*t+this.mat4[6]*r+this.mat4[10]*e,this.mat4[15]+=this.mat4[3]*t+this.mat4[7]*r+this.mat4[11]*e},n.default.Matrix.prototype.rotateX=function(e){this.rotate(e,1,0,0)},n.default.Matrix.prototype.rotateY=function(e){this.rotate(e,0,1,0)},n.default.Matrix.prototype.rotateZ=function(e){this.rotate(e,0,0,1)},n.default.Matrix.prototype.perspective=function(e,t,r,n){e=1/Math.tan(e/2);var i=1/(r-n);return this.mat4[0]=e/t,this.mat4[1]=0,this.mat4[2]=0,this.mat4[3]=0,this.mat4[4]=0,this.mat4[5]=e,this.mat4[6]=0,this.mat4[7]=0,this.mat4[8]=0,this.mat4[9]=0,this.mat4[10]=(n+r)*i,this.mat4[11]=-1,this.mat4[12]=0,this.mat4[13]=0,this.mat4[14]=2*n*r*i,this.mat4[15]=0,this},n.default.Matrix.prototype.ortho=function(e,t,r,n,i,s){var o=1/(e-t),a=1/(r-n),l=1/(i-s);return this.mat4[0]=-2*o,this.mat4[1]=0,this.mat4[2]=0,this.mat4[3]=0,this.mat4[4]=0,this.mat4[5]=-2*a,this.mat4[6]=0,this.mat4[7]=0,this.mat4[8]=0,this.mat4[9]=0,this.mat4[10]=2*l,this.mat4[11]=0,this.mat4[12]=(e+t)*o,this.mat4[13]=(n+r)*a,this.mat4[14]=(s+i)*l,this.mat4[15]=1,this},e=n.default.Matrix;r.default=e},{"../core/main":267,"core-js/modules/es.array.iterator":158,"core-js/modules/es.object.to-string":177,"core-js/modules/es.typed-array.copy-within":197,"core-js/modules/es.typed-array.every":198,"core-js/modules/es.typed-array.fill":199,"core-js/modules/es.typed-array.filter":200,"core-js/modules/es.typed-array.find":202,"core-js/modules/es.typed-array.find-index":201,"core-js/modules/es.typed-array.float32-array":203,"core-js/modules/es.typed-array.for-each":205,"core-js/modules/es.typed-array.includes":206,"core-js/modules/es.typed-array.index-of":207,"core-js/modules/es.typed-array.iterator":210,"core-js/modules/es.typed-array.join":211,"core-js/modules/es.typed-array.last-index-of":212,"core-js/modules/es.typed-array.map":213,"core-js/modules/es.typed-array.reduce":215,"core-js/modules/es.typed-array.reduce-right":214,"core-js/modules/es.typed-array.reverse":216,"core-js/modules/es.typed-array.set":217,"core-js/modules/es.typed-array.slice":218,"core-js/modules/es.typed-array.some":219,"core-js/modules/es.typed-array.sort":220,"core-js/modules/es.typed-array.subarray":221,"core-js/modules/es.typed-array.to-locale-string":222,"core-js/modules/es.typed-array.to-string":223}],318:[function(e,t,r){"use strict";e("core-js/modules/es.array.map"),e("core-js/modules/es.array.map"),Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0,(e=(e=e("../core/main"))&&e.__esModule?e:{default:e}).default.RenderBuffer=function(e,t,r,n,i,s){this.size=e,this.src=t,this.dst=r,this.attr=n,this._renderer=i,this.map=s},e.default.RenderBuffer.prototype._prepareBuffer=function(e,t){var r,n,i,s=t.attributes,o=this._renderer.GL,a=e.model||e;(s=s[this.attr])&&(r=e[this.dst],0<(n=a[this.src]).length?((i=!r)&&(e[this.dst]=r=o.createBuffer()),o.bindBuffer(o.ARRAY_BUFFER,r),!i&&!1===a.dirtyFlags[this.src]||(i=(e=this.map)?e(n):n,this._renderer._bindBuffer(r,o.ARRAY_BUFFER,i),a.dirtyFlags[this.src]=!1),t.enableAttrib(s,this.size)):-1!==(e=s.location)&&this._renderer.registerEnabled[e]&&(o.disableVertexAttribArray(e),this._renderer.registerEnabled[e]=!1))},e=e.default.RenderBuffer,r.default=e},{"../core/main":267,"core-js/modules/es.array.map":161}],319:[function(e,t,r){"use strict";function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function i(e){return(i="function"==typeof Symbol&&"symbol"===n(Symbol.iterator)?function(e){return n(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":n(e)})(e)}e("core-js/modules/es.symbol"),e("core-js/modules/es.symbol.description"),e("core-js/modules/es.symbol.iterator"),e("core-js/modules/es.array.concat"),e("core-js/modules/es.array.fill"),e("core-js/modules/es.array.from"),e("core-js/modules/es.array.iterator"),e("core-js/modules/es.array.map"),e("core-js/modules/es.array.slice"),e("core-js/modules/es.object.get-own-property-descriptor"),e("core-js/modules/es.object.to-string"),e("core-js/modules/es.regexp.to-string"),e("core-js/modules/es.string.iterator"),e("core-js/modules/es.weak-map"),e("core-js/modules/web.dom-collections.iterator"),e("core-js/modules/es.symbol"),e("core-js/modules/es.symbol.description"),e("core-js/modules/es.symbol.iterator"),e("core-js/modules/es.array.concat"),e("core-js/modules/es.array.fill"),e("core-js/modules/es.array.from"),e("core-js/modules/es.array.iterator"),e("core-js/modules/es.array.map"),e("core-js/modules/es.array.slice"),e("core-js/modules/es.object.to-string"),e("core-js/modules/es.regexp.to-string"),e("core-js/modules/es.string.iterator"),e("core-js/modules/web.dom-collections.iterator"),Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var s=(u=e("../core/main"))&&u.__esModule?u:{default:u},o=function(e){if(e&&e.__esModule)return e;if(null===e||"object"!==i(e)&&"function"!=typeof e)return{default:e};var t=a();if(t&&t.has(e))return t.get(e);var r,n={},s=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(r in e){var o;Object.prototype.hasOwnProperty.call(e,r)&&((o=s?Object.getOwnPropertyDescriptor(e,r):null)&&(o.get||o.set)?Object.defineProperty(n,r,o):n[r]=e[r])}return n.default=e,t&&t.set(e,n),n}(e("../core/constants"));function a(){var e;return"function"!=typeof WeakMap?null:(e=new WeakMap,a=function(){return e},e)}function l(e){return function(e){if(Array.isArray(e)){for(var t=0,r=new Array(e.length);t<e.length;t++)r[t]=e[t];return r}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}e("./p5.RenderBuffer"),s.default.RendererGL.prototype.beginShape=function(e){return this.immediateMode.shapeMode=void 0!==e?e:o.TESS,this.immediateMode.geometry.reset(),this};var c={vertices:1,vertexNormals:1,vertexColors:4,vertexStrokeColors:4,uvs:2},u=(s.default.RendererGL.prototype.vertex=function(e,t){if(this.immediateMode.shapeMode===o.QUADS&&this.immediateMode.geometry.vertices.length%6==3)for(var r in c){var n=c[r];(r=this.immediateMode.geometry[r]).push.apply(r,l(r.slice(r.length-3*n,r.length-2*n)).concat(l(r.slice(r.length-n,r.length))))}var i,a,u=i=a=0,h=(3===arguments.length?u=arguments[2]:4===arguments.length?(i=arguments[2],a=arguments[3]):5===arguments.length&&(u=arguments[2],i=arguments[3],a=arguments[4]),new s.default.Vector(e,t,u));this.immediateMode.geometry.vertices.push(h),this.immediateMode.geometry.vertexNormals.push(this._currentNormal),h=this.curFillColor||[.5,.5,.5,1],this.immediateMode.geometry.vertexColors.push(h[0],h[1],h[2],h[3]),h=this.curStrokeColor||[.5,.5,.5,1];return this.immediateMode.geometry.vertexStrokeColors.push(h[0],h[1],h[2],h[3]),this.textureMode===o.IMAGE&&(null!==this._tex?0<this._tex.width&&0<this._tex.height&&(i/=this._tex.width,a/=this._tex.height):!this.isProcessingVertices&&this._tex),this.immediateMode.geometry.uvs.push(i,a),this.immediateMode._bezierVertex[0]=e,this.immediateMode._bezierVertex[1]=t,this.immediateMode._bezierVertex[2]=u,this.immediateMode._quadraticVertex[0]=e,this.immediateMode._quadraticVertex[1]=t,this.immediateMode._quadraticVertex[2]=u,this},s.default.RendererGL.prototype.normal=function(e,t,r){return e instanceof s.default.Vector?this._currentNormal=e:this._currentNormal=new s.default.Vector(e,t,r),this},s.default.RendererGL.prototype.endShape=function(e,t,r,n,i,s){return this.immediateMode.shapeMode===o.POINTS?this._drawPoints(this.immediateMode.geometry.vertices,this.immediateMode.buffers.point):(this.isProcessingVertices=!0,this._processVertices.apply(this,arguments),this.isProcessingVertices=!1,this._doFill&&1<this.immediateMode.geometry.vertices.length&&this._drawImmediateFill(),this._doStroke&&1<this.immediateMode.geometry.lineVertices.length&&this._drawImmediateStroke(),this.isBezier=!1,this.isQuadratic=!1,this.isCurve=!1,this.immediateMode._bezierVertex.length=0,this.immediateMode._quadraticVertex.length=0,this.immediateMode._curveVertex.length=0),this},s.default.RendererGL.prototype._processVertices=function(e){var t;0!==this.immediateMode.geometry.vertices.length&&(t=this._doStroke,e=e===o.CLOSE,t&&(this.immediateMode.geometry.edges=this._calculateEdges(this.immediateMode.shapeMode,this.immediateMode.geometry.vertices,e),this.immediateMode.geometry._edgesToVertices()),t=this.immediateMode.shapeMode===o.TESS,this._doFill&&(this.isBezier||this.isQuadratic||this.isCurve||t)&&this.immediateMode.shapeMode!==o.LINES&&this._tesselateShape())},s.default.RendererGL.prototype._calculateEdges=function(e,t,r){var n=[],i=0;switch(e){case o.TRIANGLE_STRIP:for(i=0;i<t.length-2;i++)n.push([i,i+1]),n.push([i,i+2]);n.push([i,i+1]);break;case o.TRIANGLE_FAN:for(i=1;i<t.length-1;i++)n.push([0,i]),n.push([i,i+1]);n.push([0,t.length-1]);break;case o.TRIANGLES:for(i=0;i<t.length-2;i+=3)n.push([i,i+1]),n.push([i+1,i+2]),n.push([i+2,i]);break;case o.LINES:for(i=0;i<t.length-1;i+=2)n.push([i,i+1]);break;case o.QUADS:for(i=0;i<t.length-5;i+=6)n.push([i,i+1]),n.push([i+1,i+2]),n.push([i+3,i+5]),n.push([i+4,i+5]);break;case o.QUAD_STRIP:for(i=0;i<t.length-2;i+=2)n.push([i,i+1]),n.push([i,i+2]),n.push([i+1,i+3]);n.push([i,i+1]);break;default:for(i=0;i<t.length-1;i++)n.push([i,i+1])}return r&&n.push([t.length-1,0]),n},s.default.RendererGL.prototype._tesselateShape=function(){for(var e=this,t=(this.immediateMode.shapeMode=o.TRIANGLES,[this._flatten(this.immediateMode.geometry.vertices.map((function(t,r){return[t.x,t.y,t.z,e.immediateMode.geometry.uvs[2*r],e.immediateMode.geometry.uvs[2*r+1],e.immediateMode.geometry.vertexColors[4*r],e.immediateMode.geometry.vertexColors[4*r+1],e.immediateMode.geometry.vertexColors[4*r+2],e.immediateMode.geometry.vertexColors[4*r+3],e.immediateMode.geometry.vertexNormals[r].x,e.immediateMode.geometry.vertexNormals[r].y,e.immediateMode.geometry.vertexNormals[r].z]})))]),r=this._triangulate(t),n=(this.immediateMode.geometry.vertices=[],this.immediateMode.geometry.vertexNormals=[],this.immediateMode.geometry.uvs=[],[]),i=0,a=r.length;i<a;i+=s.default.RendererGL.prototype.tessyVertexSize)n.push.apply(n,l(r.slice(i+5,i+9))),this.normal.apply(this,l(r.slice(i+9,i+12))),this.vertex.apply(this,l(r.slice(i,i+5)));this.immediateMode.geometry.vertexColors=n},s.default.RendererGL.prototype._drawImmediateFill=function(){var e=this.GL,t=(this._useVertexColor=0<this.immediateMode.geometry.vertexColors.length,this._getImmediateFillShader()),r=(this._setFillUniforms(t),!0),n=!1,i=void 0;try{for(var s,a=this.immediateMode.buffers.fill[Symbol.iterator]();!(r=(s=a.next()).done);r=!0)s.value._prepareBuffer(this.immediateMode.geometry,t)}catch(e){n=!0,i=e}finally{try{r||null==a.return||a.return()}finally{if(n)throw i}}this.immediateMode.shapeMode!==o.LINE_STRIP&&this.immediateMode.shapeMode!==o.LINES||(this.immediateMode.shapeMode=o.TRIANGLE_FAN),this.immediateMode.shapeMode===o.QUADS?this.immediateMode.shapeMode=o.TRIANGLES:this.immediateMode.shapeMode===o.QUAD_STRIP&&(this.immediateMode.shapeMode=o.TRIANGLE_STRIP),this._applyColorBlend(this.curFillColor),e.drawArrays(this.immediateMode.shapeMode,0,this.immediateMode.geometry.vertices.length),t.unbindShader()},s.default.RendererGL.prototype._drawImmediateStroke=function(){var e=this.GL,t=e.isEnabled(e.CULL_FACE),r=(e.disable(e.CULL_FACE),this._getImmediateStrokeShader()),n=(this._useLineColor=0<this.immediateMode.geometry.vertexStrokeColors.length,this._setStrokeUniforms(r),!0),i=!1,s=void 0;try{for(var o,a=this.immediateMode.buffers.stroke[Symbol.iterator]();!(n=(o=a.next()).done);n=!0)o.value._prepareBuffer(this.immediateMode.geometry,r)}catch(e){i=!0,s=e}finally{try{n||null==a.return||a.return()}finally{if(i)throw s}}this._applyColorBlend(this.curStrokeColor),e.drawArrays(e.TRIANGLES,0,this.immediateMode.geometry.lineVertices.length),t&&e.enable(e.CULL_FACE),r.unbindShader()},s.default.RendererGL);r.default=u},{"../core/constants":256,"../core/main":267,"./p5.RenderBuffer":318,"core-js/modules/es.array.concat":149,"core-js/modules/es.array.fill":152,"core-js/modules/es.array.from":155,"core-js/modules/es.array.iterator":158,"core-js/modules/es.array.map":161,"core-js/modules/es.array.slice":162,"core-js/modules/es.object.get-own-property-descriptor":173,"core-js/modules/es.object.to-string":177,"core-js/modules/es.regexp.to-string":182,"core-js/modules/es.string.iterator":186,"core-js/modules/es.symbol":196,"core-js/modules/es.symbol.description":194,"core-js/modules/es.symbol.iterator":195,"core-js/modules/es.weak-map":228,"core-js/modules/web.dom-collections.iterator":230}],320:[function(e,t,r){"use strict";e("core-js/modules/es.symbol"),e("core-js/modules/es.symbol.description"),e("core-js/modules/es.symbol.iterator"),e("core-js/modules/es.array.fill"),e("core-js/modules/es.array.iterator"),e("core-js/modules/es.array.some"),e("core-js/modules/es.object.keys"),e("core-js/modules/es.object.to-string"),e("core-js/modules/es.string.iterator"),e("core-js/modules/es.typed-array.float32-array"),e("core-js/modules/es.typed-array.uint16-array"),e("core-js/modules/es.typed-array.uint32-array"),e("core-js/modules/es.typed-array.copy-within"),e("core-js/modules/es.typed-array.every"),e("core-js/modules/es.typed-array.fill"),e("core-js/modules/es.typed-array.filter"),e("core-js/modules/es.typed-array.find"),e("core-js/modules/es.typed-array.find-index"),e("core-js/modules/es.typed-array.for-each"),e("core-js/modules/es.typed-array.includes"),e("core-js/modules/es.typed-array.index-of"),e("core-js/modules/es.typed-array.iterator"),e("core-js/modules/es.typed-array.join"),e("core-js/modules/es.typed-array.last-index-of"),e("core-js/modules/es.typed-array.map"),e("core-js/modules/es.typed-array.reduce"),e("core-js/modules/es.typed-array.reduce-right"),e("core-js/modules/es.typed-array.reverse"),e("core-js/modules/es.typed-array.set"),e("core-js/modules/es.typed-array.slice"),e("core-js/modules/es.typed-array.some"),e("core-js/modules/es.typed-array.sort"),e("core-js/modules/es.typed-array.subarray"),e("core-js/modules/es.typed-array.to-locale-string"),e("core-js/modules/es.typed-array.to-string"),e("core-js/modules/web.dom-collections.iterator"),e("core-js/modules/es.symbol"),e("core-js/modules/es.symbol.description"),e("core-js/modules/es.symbol.iterator"),e("core-js/modules/es.array.fill"),e("core-js/modules/es.array.iterator"),e("core-js/modules/es.array.some"),e("core-js/modules/es.object.keys"),e("core-js/modules/es.object.to-string"),e("core-js/modules/es.string.iterator"),e("core-js/modules/es.typed-array.float32-array"),e("core-js/modules/es.typed-array.uint16-array"),e("core-js/modules/es.typed-array.uint32-array"),e("core-js/modules/es.typed-array.copy-within"),e("core-js/modules/es.typed-array.every"),e("core-js/modules/es.typed-array.fill"),e("core-js/modules/es.typed-array.filter"),e("core-js/modules/es.typed-array.find"),e("core-js/modules/es.typed-array.find-index"),e("core-js/modules/es.typed-array.for-each"),e("core-js/modules/es.typed-array.includes"),e("core-js/modules/es.typed-array.index-of"),e("core-js/modules/es.typed-array.iterator"),e("core-js/modules/es.typed-array.join"),e("core-js/modules/es.typed-array.last-index-of"),e("core-js/modules/es.typed-array.map"),e("core-js/modules/es.typed-array.reduce"),e("core-js/modules/es.typed-array.reduce-right"),e("core-js/modules/es.typed-array.reverse"),e("core-js/modules/es.typed-array.set"),e("core-js/modules/es.typed-array.slice"),e("core-js/modules/es.typed-array.some"),e("core-js/modules/es.typed-array.sort"),e("core-js/modules/es.typed-array.subarray"),e("core-js/modules/es.typed-array.to-locale-string"),e("core-js/modules/es.typed-array.to-string"),e("core-js/modules/web.dom-collections.iterator"),Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n=(s=e("../core/main"))&&s.__esModule?s:{default:s};e("./p5.RendererGL"),e("./p5.RenderBuffer");var i=0,s=(n.default.RendererGL.prototype._initBufferDefaults=function(e){var t;return this._freeBuffers(e),1e3<++i&&(t=Object.keys(this.retainedMode.geometry)[0],delete this.retainedMode.geometry[t],i--),this.retainedMode.geometry[e]={}},n.default.RendererGL.prototype._freeBuffers=function(e){var t,r=this.retainedMode.geometry[e];function n(e){var n=!0,i=!1,s=void 0;try{for(var o,a=e[Symbol.iterator]();!(n=(o=a.next()).done);n=!0){var l=o.value;r[l.dst]&&(t.deleteBuffer(r[l.dst]),r[l.dst]=null)}}catch(e){i=!0,s=e}finally{try{n||null==a.return||a.return()}finally{if(i)throw s}}}r&&(delete this.retainedMode.geometry[e],i--,t=this.GL,r.indexBuffer&&t.deleteBuffer(r.indexBuffer),n(this.retainedMode.buffers.stroke),n(this.retainedMode.buffers.fill))},n.default.RendererGL.prototype.createBuffers=function(e,t){var r,i,s,o=this.GL,a=((e=this._initBufferDefaults(e)).model=t,e.indexBuffer);return t.faces.length?(a=a||(e.indexBuffer=o.createBuffer()),s=(i=(r=n.default.RendererGL.prototype._flatten(t.faces)).some((function(e){return 65535<e})))?Uint32Array:Uint16Array,this._bindBuffer(a,o.ELEMENT_ARRAY_BUFFER,r,s),e.indexBufferType=i?o.UNSIGNED_INT:o.UNSIGNED_SHORT,e.vertexCount=3*t.faces.length):(a&&(o.deleteBuffer(a),e.indexBuffer=null),e.vertexCount=t.vertices?t.vertices.length:0),e.lineVertexCount=t.lineVertices?t.lineVertices.length:0,e},n.default.RendererGL.prototype.drawBuffers=function(e){var t=this.GL,r=this.retainedMode.geometry[e];if(this._doStroke&&0<r.lineVertexCount){var n=t.isEnabled(t.CULL_FACE),i=(t.disable(t.CULL_FACE),this._getRetainedStrokeShader()),s=(this._useLineColor=0<r.model.vertexStrokeColors.length,this._setStrokeUniforms(i),!0),o=!1,a=void 0;try{for(var l,c=this.retainedMode.buffers.stroke[Symbol.iterator]();!(s=(l=c.next()).done);s=!0)l.value._prepareBuffer(r,i)}catch(e){o=!0,a=e}finally{try{s||null==c.return||c.return()}finally{if(o)throw a}}this._applyColorBlend(this.curStrokeColor),this._drawArrays(t.TRIANGLES,e),n&&t.enable(t.CULL_FACE),i.unbindShader()}if(this._doFill){this._useVertexColor=0<r.model.vertexColors.length;var u=this._getRetainedFillShader(),h=(this._setFillUniforms(u),!0);o=!1,a=void 0;try{for(var d,p=this.retainedMode.buffers.fill[Symbol.iterator]();!(h=(d=p.next()).done);h=!0)d.value._prepareBuffer(r,u)}catch(e){o=!0,a=e}finally{try{h||null==p.return||p.return()}finally{if(o)throw a}}r.indexBuffer&&this._bindBuffer(r.indexBuffer,t.ELEMENT_ARRAY_BUFFER),this._applyColorBlend(this.curFillColor),this._drawElements(t.TRIANGLES,e),u.unbindShader()}return this},n.default.RendererGL.prototype.drawBuffersScaled=function(e,t,r,n){var i=this.uMVMatrix.copy();try{this.uMVMatrix.scale(t,r,n),this.drawBuffers(e)}finally{this.uMVMatrix=i}},n.default.RendererGL.prototype._drawArrays=function(e,t){return this.GL.drawArrays(e,0,this.retainedMode.geometry[t].lineVertexCount),this},n.default.RendererGL.prototype._drawElements=function(e,t){t=this.retainedMode.geometry[t];var r=this.GL;if(t.indexBuffer){if(t.indexBufferType===r.UNSIGNED_INT&&!r.getExtension("OES_element_index_uint"))throw new Error("Unable to render a 3d model with > 65535 triangles. Your web browser does not support the WebGL Extension OES_element_index_uint.");r.drawElements(r.TRIANGLES,t.vertexCount,t.indexBufferType,0)}else r.drawArrays(e||r.TRIANGLES,0,t.vertexCount)},n.default.RendererGL.prototype._drawPoints=function(e,t){var r=this.GL,n=this._getImmediatePointShader();this._setPointUniforms(n),this._bindBuffer(t,r.ARRAY_BUFFER,this._vToNArray(e),Float32Array,r.STATIC_DRAW),n.enableAttrib(n.attributes.aPosition,3),r.drawArrays(r.Points,0,e.length),n.unbindShader()},n.default.RendererGL);r.default=s},{"../core/main":267,"./p5.RenderBuffer":318,"./p5.RendererGL":321,"core-js/modules/es.array.fill":152,"core-js/modules/es.array.iterator":158,"core-js/modules/es.array.some":163,"core-js/modules/es.object.keys":176,"core-js/modules/es.object.to-string":177,"core-js/modules/es.string.iterator":186,"core-js/modules/es.symbol":196,"core-js/modules/es.symbol.description":194,"core-js/modules/es.symbol.iterator":195,"core-js/modules/es.typed-array.copy-within":197,"core-js/modules/es.typed-array.every":198,"core-js/modules/es.typed-array.fill":199,"core-js/modules/es.typed-array.filter":200,"core-js/modules/es.typed-array.find":202,"core-js/modules/es.typed-array.find-index":201,"core-js/modules/es.typed-array.float32-array":203,"core-js/modules/es.typed-array.for-each":205,"core-js/modules/es.typed-array.includes":206,"core-js/modules/es.typed-array.index-of":207,"core-js/modules/es.typed-array.iterator":210,"core-js/modules/es.typed-array.join":211,"core-js/modules/es.typed-array.last-index-of":212,"core-js/modules/es.typed-array.map":213,"core-js/modules/es.typed-array.reduce":215,"core-js/modules/es.typed-array.reduce-right":214,"core-js/modules/es.typed-array.reverse":216,"core-js/modules/es.typed-array.set":217,"core-js/modules/es.typed-array.slice":218,"core-js/modules/es.typed-array.some":219,"core-js/modules/es.typed-array.sort":220,"core-js/modules/es.typed-array.subarray":221,"core-js/modules/es.typed-array.to-locale-string":222,"core-js/modules/es.typed-array.to-string":223,"core-js/modules/es.typed-array.uint16-array":224,"core-js/modules/es.typed-array.uint32-array":225,"core-js/modules/web.dom-collections.iterator":230}],321:[function(e,t,r){"use strict";function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function i(e){return(i="function"==typeof Symbol&&"symbol"===n(Symbol.iterator)?function(e){return n(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":n(e)})(e)}e("core-js/modules/es.symbol"),e("core-js/modules/es.symbol.description"),e("core-js/modules/es.symbol.iterator"),e("core-js/modules/es.array.concat"),e("core-js/modules/es.array.fill"),e("core-js/modules/es.array.filter"),e("core-js/modules/es.array.from"),e("core-js/modules/es.array.includes"),e("core-js/modules/es.array.iterator"),e("core-js/modules/es.array.slice"),e("core-js/modules/es.object.assign"),e("core-js/modules/es.object.get-own-property-descriptor"),e("core-js/modules/es.object.to-string"),e("core-js/modules/es.regexp.to-string"),e("core-js/modules/es.string.includes"),e("core-js/modules/es.string.iterator"),e("core-js/modules/es.typed-array.float32-array"),e("core-js/modules/es.typed-array.float64-array"),e("core-js/modules/es.typed-array.int16-array"),e("core-js/modules/es.typed-array.uint8-array"),e("core-js/modules/es.typed-array.uint16-array"),e("core-js/modules/es.typed-array.uint32-array"),e("core-js/modules/es.typed-array.copy-within"),e("core-js/modules/es.typed-array.every"),e("core-js/modules/es.typed-array.fill"),e("core-js/modules/es.typed-array.filter"),e("core-js/modules/es.typed-array.find"),e("core-js/modules/es.typed-array.find-index"),e("core-js/modules/es.typed-array.for-each"),e("core-js/modules/es.typed-array.includes"),e("core-js/modules/es.typed-array.index-of"),e("core-js/modules/es.typed-array.iterator"),e("core-js/modules/es.typed-array.join"),e("core-js/modules/es.typed-array.last-index-of"),e("core-js/modules/es.typed-array.map"),e("core-js/modules/es.typed-array.reduce"),e("core-js/modules/es.typed-array.reduce-right"),e("core-js/modules/es.typed-array.reverse"),e("core-js/modules/es.typed-array.set"),e("core-js/modules/es.typed-array.slice"),e("core-js/modules/es.typed-array.some"),e("core-js/modules/es.typed-array.sort"),e("core-js/modules/es.typed-array.subarray"),e("core-js/modules/es.typed-array.to-locale-string"),e("core-js/modules/es.typed-array.to-string"),e("core-js/modules/es.weak-map"),e("core-js/modules/web.dom-collections.iterator"),e("core-js/modules/es.symbol"),e("core-js/modules/es.symbol.description"),e("core-js/modules/es.symbol.iterator"),e("core-js/modules/es.array.concat"),e("core-js/modules/es.array.fill"),e("core-js/modules/es.array.filter"),e("core-js/modules/es.array.from"),e("core-js/modules/es.array.includes"),e("core-js/modules/es.array.iterator"),e("core-js/modules/es.array.slice"),e("core-js/modules/es.object.assign"),e("core-js/modules/es.object.to-string"),e("core-js/modules/es.regexp.to-string"),e("core-js/modules/es.string.includes"),e("core-js/modules/es.string.iterator"),e("core-js/modules/es.typed-array.float32-array"),e("core-js/modules/es.typed-array.float64-array"),e("core-js/modules/es.typed-array.int16-array"),e("core-js/modules/es.typed-array.uint8-array"),e("core-js/modules/es.typed-array.uint16-array"),e("core-js/modules/es.typed-array.uint32-array"),e("core-js/modules/es.typed-array.copy-within"),e("core-js/modules/es.typed-array.every"),e("core-js/modules/es.typed-array.fill"),e("core-js/modules/es.typed-array.filter"),e("core-js/modules/es.typed-array.find"),e("core-js/modules/es.typed-array.find-index"),e("core-js/modules/es.typed-array.for-each"),e("core-js/modules/es.typed-array.includes"),e("core-js/modules/es.typed-array.index-of"),e("core-js/modules/es.typed-array.iterator"),e("core-js/modules/es.typed-array.join"),e("core-js/modules/es.typed-array.last-index-of"),e("core-js/modules/es.typed-array.map"),e("core-js/modules/es.typed-array.reduce"),e("core-js/modules/es.typed-array.reduce-right"),e("core-js/modules/es.typed-array.reverse"),e("core-js/modules/es.typed-array.set"),e("core-js/modules/es.typed-array.slice"),e("core-js/modules/es.typed-array.some"),e("core-js/modules/es.typed-array.sort"),e("core-js/modules/es.typed-array.subarray"),e("core-js/modules/es.typed-array.to-locale-string"),e("core-js/modules/es.typed-array.to-string"),e("core-js/modules/web.dom-collections.iterator"),Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var s=c(e("../core/main")),o=function(e){if(e&&e.__esModule)return e;if(null===e||"object"!==i(e)&&"function"!=typeof e)return{default:e};var t=l();if(t&&t.has(e))return t.get(e);var r,n={},s=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(r in e){var o;Object.prototype.hasOwnProperty.call(e,r)&&((o=s?Object.getOwnPropertyDescriptor(e,r):null)&&(o.get||o.set)?Object.defineProperty(n,r,o):n[r]=e[r])}return n.default=e,t&&t.set(e,n),n}(e("../core/constants")),a=c(e("libtess"));function l(){var e;return"function"!=typeof WeakMap?null:(e=new WeakMap,l=function(){return e},e)}function c(e){return e&&e.__esModule?e:{default:e}}function u(e){return function(e){if(Array.isArray(e)){for(var t=0,r=new Array(e.length);t<e.length;t++)r[t]=e[t];return r}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function h(e,t){m+="#define STROKE_CAP_".concat(e," ").concat(t,"\n"),p[o[e]]=t}function d(e,t){m+="#define STROKE_JOIN_".concat(e," ").concat(t,"\n"),f[o[e]]=t}e("./p5.Shader"),e("./p5.Camera"),e("../core/p5.Renderer"),e("./p5.Matrix"),e("path");var p={},f={},m="",g={immediateVert:"attribute vec3 aPosition;\nattribute vec4 aVertexColor;\n\nuniform mat4 uModelViewMatrix;\nuniform mat4 uProjectionMatrix;\nuniform float uResolution;\nuniform float uPointSize;\n\nvarying vec4 vColor;\nvoid main(void) {\n  vec4 positionVec4 = vec4(aPosition, 1.0);\n  gl_Position = uProjectionMatrix * uModelViewMatrix * positionVec4;\n  vColor = aVertexColor;\n  gl_PointSize = uPointSize;\n}\n",vertexColorVert:"attribute vec3 aPosition;\nattribute vec4 aVertexColor;\n\nuniform mat4 uModelViewMatrix;\nuniform mat4 uProjectionMatrix;\n\nvarying vec4 vColor;\n\nvoid main(void) {\n  vec4 positionVec4 = vec4(aPosition, 1.0);\n  gl_Position = uProjectionMatrix * uModelViewMatrix * positionVec4;\n  vColor = aVertexColor;\n}\n",vertexColorFrag:"precision mediump float;\nvarying vec4 vColor;\nvoid main(void) {\n  gl_FragColor = vec4(vColor.rgb, 1.) * vColor.a;\n}\n",normalVert:"attribute vec3 aPosition;\nattribute vec3 aNormal;\nattribute vec2 aTexCoord;\nattribute vec4 aVertexColor;\n\nuniform mat4 uModelViewMatrix;\nuniform mat4 uProjectionMatrix;\nuniform mat3 uNormalMatrix;\n\nuniform vec4 uMaterialColor;\nuniform bool uUseVertexColor;\n\nvarying vec3 vVertexNormal;\nvarying highp vec2 vVertTexCoord;\nvarying vec4 vColor;\n\nvoid main(void) {\n  vec4 positionVec4 = vec4(aPosition, 1.0);\n  gl_Position = uProjectionMatrix * uModelViewMatrix * positionVec4;\n  vVertexNormal = normalize(vec3( uNormalMatrix * aNormal ));\n  vVertTexCoord = aTexCoord;\n  vColor = (uUseVertexColor ? aVertexColor : uMaterialColor);\n}\n",normalFrag:"precision mediump float;\nvarying vec3 vVertexNormal;\nvoid main(void) {\n  gl_FragColor = vec4(vVertexNormal, 1.0);\n}",basicFrag:"precision mediump float;\nvarying vec4 vColor;\nvoid main(void) {\n  gl_FragColor = vec4(vColor.rgb, 1.) * vColor.a;\n}\n",lightVert:(e=(h("ROUND",0),h("PROJECT",1),h("SQUARE",2),d("ROUND",0),d("MITER",1),d("BEVEL",2),"precision highp float;\nprecision highp int;\n\nuniform mat4 uViewMatrix;\n\nuniform bool uUseLighting;\n\nuniform int uAmbientLightCount;\nuniform vec3 uAmbientColor[5];\n\nuniform int uDirectionalLightCount;\nuniform vec3 uLightingDirection[5];\nuniform vec3 uDirectionalDiffuseColors[5];\nuniform vec3 uDirectionalSpecularColors[5];\n\nuniform int uPointLightCount;\nuniform vec3 uPointLightLocation[5];\nuniform vec3 uPointLightDiffuseColors[5];\t\nuniform vec3 uPointLightSpecularColors[5];\n\nuniform int uSpotLightCount;\nuniform float uSpotLightAngle[5];\nuniform float uSpotLightConc[5];\nuniform vec3 uSpotLightDiffuseColors[5];\nuniform vec3 uSpotLightSpecularColors[5];\nuniform vec3 uSpotLightLocation[5];\nuniform vec3 uSpotLightDirection[5];\n\nuniform bool uSpecular;\nuniform float uShininess;\n\nuniform float uConstantAttenuation;\nuniform float uLinearAttenuation;\nuniform float uQuadraticAttenuation;\n\nconst float specularFactor = 2.0;\nconst float diffuseFactor = 0.73;\n\nstruct LightResult {\n  float specular;\n  float diffuse;\n};\n\nfloat _phongSpecular(\n  vec3 lightDirection,\n  vec3 viewDirection,\n  vec3 surfaceNormal,\n  float shininess) {\n\n  vec3 R = reflect(lightDirection, surfaceNormal);\n  return pow(max(0.0, dot(R, viewDirection)), shininess);\n}\n\nfloat _lambertDiffuse(vec3 lightDirection, vec3 surfaceNormal) {\n  return max(0.0, dot(-lightDirection, surfaceNormal));\n}\n\nLightResult _light(vec3 viewDirection, vec3 normal, vec3 lightVector) {\n\n  vec3 lightDir = normalize(lightVector);\n\n  //compute our diffuse & specular terms\n  LightResult lr;\n  if (uSpecular)\n    lr.specular = _phongSpecular(lightDir, viewDirection, normal, uShininess);\n  lr.diffuse = _lambertDiffuse(lightDir, normal);\n  return lr;\n}\n\nvoid totalLight(\n  vec3 modelPosition,\n  vec3 normal,\n  out vec3 totalDiffuse,\n  out vec3 totalSpecular\n) {\n\n  totalSpecular = vec3(0.0);\n\n  if (!uUseLighting) {\n    totalDiffuse = vec3(1.0);\n    return;\n  }\n\n  totalDiffuse = vec3(0.0);\n\n  vec3 viewDirection = normalize(-modelPosition);\n\n  for (int j = 0; j < 5; j++) {\n    if (j < uDirectionalLightCount) {\n      vec3 lightVector = (uViewMatrix * vec4(uLightingDirection[j], 0.0)).xyz;\n      vec3 lightColor = uDirectionalDiffuseColors[j];\n      vec3 specularColor = uDirectionalSpecularColors[j];\n      LightResult result = _light(viewDirection, normal, lightVector);\n      totalDiffuse += result.diffuse * lightColor;\n      totalSpecular += result.specular * lightColor * specularColor;\n    }\n\n    if (j < uPointLightCount) {\n      vec3 lightPosition = (uViewMatrix * vec4(uPointLightLocation[j], 1.0)).xyz;\n      vec3 lightVector = modelPosition - lightPosition;\n    \n      //calculate attenuation\n      float lightDistance = length(lightVector);\n      float lightFalloff = 1.0 / (uConstantAttenuation + lightDistance * uLinearAttenuation + (lightDistance * lightDistance) * uQuadraticAttenuation);\n      vec3 lightColor = lightFalloff * uPointLightDiffuseColors[j];\n      vec3 specularColor = lightFalloff * uPointLightSpecularColors[j];\n\n      LightResult result = _light(viewDirection, normal, lightVector);\n      totalDiffuse += result.diffuse * lightColor;\n      totalSpecular += result.specular * lightColor * specularColor;\n    }\n\n    if(j < uSpotLightCount) {\n      vec3 lightPosition = (uViewMatrix * vec4(uSpotLightLocation[j], 1.0)).xyz;\n      vec3 lightVector = modelPosition - lightPosition;\n    \n      float lightDistance = length(lightVector);\n      float lightFalloff = 1.0 / (uConstantAttenuation + lightDistance * uLinearAttenuation + (lightDistance * lightDistance) * uQuadraticAttenuation);\n\n      vec3 lightDirection = (uViewMatrix * vec4(uSpotLightDirection[j], 0.0)).xyz;\n      float spotDot = dot(normalize(lightVector), normalize(lightDirection));\n      float spotFalloff;\n      if(spotDot < uSpotLightAngle[j]) {\n        spotFalloff = 0.0;\n      }\n      else {\n        spotFalloff = pow(spotDot, uSpotLightConc[j]);\n      }\n      lightFalloff *= spotFalloff;\n\n      vec3 lightColor = uSpotLightDiffuseColors[j];\n      vec3 specularColor = uSpotLightSpecularColors[j];\n     \n      LightResult result = _light(viewDirection, normal, lightVector);\n      \n      totalDiffuse += result.diffuse * lightColor * lightFalloff;\n      totalSpecular += result.specular * lightColor * specularColor * lightFalloff;\n    }\n  }\n\n  totalDiffuse *= diffuseFactor;\n  totalSpecular *= specularFactor;\n}\n"))+"// include lighting.glgl\n\nattribute vec3 aPosition;\nattribute vec3 aNormal;\nattribute vec2 aTexCoord;\nattribute vec4 aVertexColor;\n\nuniform mat4 uModelViewMatrix;\nuniform mat4 uProjectionMatrix;\nuniform mat3 uNormalMatrix;\n\nuniform bool uUseVertexColor;\nuniform vec4 uMaterialColor;\n\nvarying highp vec2 vVertTexCoord;\nvarying vec3 vDiffuseColor;\nvarying vec3 vSpecularColor;\nvarying vec4 vColor;\n\nvoid main(void) {\n\n  vec4 viewModelPosition = uModelViewMatrix * vec4(aPosition, 1.0);\n  gl_Position = uProjectionMatrix * viewModelPosition;\n\n  vec3 vertexNormal = normalize(uNormalMatrix * aNormal);\n  vVertTexCoord = aTexCoord;\n\n  totalLight(viewModelPosition.xyz, vertexNormal, vDiffuseColor, vSpecularColor);\n\n  for (int i = 0; i < 8; i++) {\n    if (i < uAmbientLightCount) {\n      vDiffuseColor += uAmbientColor[i];\n    }\n  }\n  \n  vColor = (uUseVertexColor ? aVertexColor : uMaterialColor);\n}\n",lightTextureFrag:"precision highp float;\n\nuniform vec4 uTint;\nuniform sampler2D uSampler;\nuniform bool isTexture;\nuniform bool uEmissive;\n\nvarying highp vec2 vVertTexCoord;\nvarying vec3 vDiffuseColor;\nvarying vec3 vSpecularColor;\nvarying vec4 vColor;\n\nvoid main(void) {\n  if(uEmissive && !isTexture) {\n    gl_FragColor = vColor;\n  }\n  else {\n    vec4 baseColor = isTexture ? texture2D(uSampler, vVertTexCoord) * (uTint / vec4(255, 255, 255, 255)) : vColor;\n    gl_FragColor = vec4(gl_FragColor.rgb * vDiffuseColor + vSpecularColor, 1.) * baseColor.a;\n  }\n}\n",phongVert:"precision highp float;\nprecision highp int;\n\nattribute vec3 aPosition;\nattribute vec3 aNormal;\nattribute vec2 aTexCoord;\nattribute vec4 aVertexColor;\n\nuniform vec3 uAmbientColor[5];\n\nuniform mat4 uModelViewMatrix;\nuniform mat4 uProjectionMatrix;\nuniform mat3 uNormalMatrix;\nuniform int uAmbientLightCount;\n\nuniform bool uUseVertexColor;\nuniform vec4 uMaterialColor;\n\nvarying vec3 vNormal;\nvarying vec2 vTexCoord;\nvarying vec3 vViewPosition;\nvarying vec3 vAmbientColor;\nvarying vec4 vColor;\n\nvoid main(void) {\n\n  vec4 viewModelPosition = uModelViewMatrix * vec4(aPosition, 1.0);\n\n  // Pass varyings to fragment shader\n  vViewPosition = viewModelPosition.xyz;\n  gl_Position = uProjectionMatrix * viewModelPosition;  \n\n  vNormal = uNormalMatrix * aNormal;\n  vTexCoord = aTexCoord;\n\n  // TODO: this should be a uniform\n  vAmbientColor = vec3(0.0);\n  for (int i = 0; i < 5; i++) {\n    if (i < uAmbientLightCount) {\n      vAmbientColor += uAmbientColor[i];\n    }\n  }\n  \n  vColor = (uUseVertexColor ? aVertexColor : uMaterialColor);\n}\n",phongFrag:e+"// include lighting.glsl\nprecision highp float;\nprecision highp int;\n\nuniform vec4 uSpecularMatColor;\nuniform vec4 uAmbientMatColor;\nuniform vec4 uEmissiveMatColor;\n\nuniform vec4 uTint;\nuniform sampler2D uSampler;\nuniform bool isTexture;\n\nvarying vec3 vNormal;\nvarying vec2 vTexCoord;\nvarying vec3 vViewPosition;\nvarying vec3 vAmbientColor;\nvarying vec4 vColor;\n\nvoid main(void) {\n\n  vec3 diffuse;\n  vec3 specular;\n  totalLight(vViewPosition, normalize(vNormal), diffuse, specular);\n\n  // Calculating final color as result of all lights (plus emissive term).\n\n  vec4 baseColor = isTexture ? texture2D(uSampler, vTexCoord) * (uTint / vec4(255, 255, 255, 255)) : vColor;\n  gl_FragColor = vec4(diffuse * baseColor.rgb + \n                    vAmbientColor * uAmbientMatColor.rgb + \n                    specular * uSpecularMatColor.rgb + \n                    uEmissiveMatColor.rgb, 1.) * baseColor.a;\n}\n",fontVert:"precision mediump float;\n\nattribute vec3 aPosition;\nattribute vec2 aTexCoord;\nuniform mat4 uModelViewMatrix;\nuniform mat4 uProjectionMatrix;\n\nuniform vec4 uGlyphRect;\nuniform float uGlyphOffset;\n\nvarying vec2 vTexCoord;\nvarying float w;\n\nvoid main() {\n  vec4 positionVec4 = vec4(aPosition, 1.0);\n\n  // scale by the size of the glyph's rectangle\n  positionVec4.xy *= uGlyphRect.zw - uGlyphRect.xy;\n\n  // Expand glyph bounding boxes by 1px on each side to give a bit of room\n  // for antialiasing\n  vec2 pixelScale = vec2(\n    1. / uModelViewMatrix[0][0],\n    1. / uModelViewMatrix[1][1]\n  );\n  vec2 offset = pixelScale * normalize(aTexCoord - vec2(0.5, 0.5)) * vec2(1., -1.);\n  vec2 textureOffset = offset * (1. / vec2(\n    uGlyphRect.z - uGlyphRect.x,\n    uGlyphRect.w - uGlyphRect.y\n  ));\n\n  // move to the corner of the glyph\n  positionVec4.xy += uGlyphRect.xy;\n\n  // move to the letter's line offset\n  positionVec4.x += uGlyphOffset;\n\n  positionVec4.xy += offset;\n  \n  gl_Position = uProjectionMatrix * uModelViewMatrix * positionVec4;\n  vTexCoord = aTexCoord + textureOffset;\n  w = gl_Position.w;\n}\n",fontFrag:"#extension GL_OES_standard_derivatives : enable\nprecision mediump float;\n\n#if 0\n  // simulate integer math using floats\n\t#define int float\n\t#define ivec2 vec2\n\t#define INT(x) float(x)\n\n\tint ifloor(float v) { return floor(v); }\n\tivec2 ifloor(vec2 v) { return floor(v); }\n\n#else\n  // use native integer math\n\tprecision highp int;\n\t#define INT(x) x\n\n\tint ifloor(float v) { return int(v); }\n\tint ifloor(int v) { return v; }\n\tivec2 ifloor(vec2 v) { return ivec2(v); }\n\n#endif\n\nuniform sampler2D uSamplerStrokes;\nuniform sampler2D uSamplerRowStrokes;\nuniform sampler2D uSamplerRows;\nuniform sampler2D uSamplerColStrokes;\nuniform sampler2D uSamplerCols;\n\nuniform ivec2 uStrokeImageSize;\nuniform ivec2 uCellsImageSize;\nuniform ivec2 uGridImageSize;\n\nuniform ivec2 uGridOffset;\nuniform ivec2 uGridSize;\nuniform vec4 uMaterialColor;\n\nvarying vec2 vTexCoord;\n\n// some helper functions\nint round(float v) { return ifloor(v + 0.5); }\nivec2 round(vec2 v) { return ifloor(v + 0.5); }\nfloat saturate(float v) { return clamp(v, 0.0, 1.0); }\nvec2 saturate(vec2 v) { return clamp(v, 0.0, 1.0); }\n\nint mul(float v1, int v2) {\n  return ifloor(v1 * float(v2));\n}\n\nivec2 mul(vec2 v1, ivec2 v2) {\n  return ifloor(v1 * vec2(v2) + 0.5);\n}\n\n// unpack a 16-bit integer from a float vec2\nint getInt16(vec2 v) {\n  ivec2 iv = round(v * 255.0);\n  return iv.x * INT(128) + iv.y;\n}\n\nvec2 pixelScale;\nvec2 coverage = vec2(0.0);\nvec2 weight = vec2(0.5);\nconst float minDistance = 1.0/8192.0;\nconst float hardness = 1.05; // amount of antialias\n\n// the maximum number of curves in a glyph\nconst int N = INT(250);\n\n// retrieves an indexed pixel from a sampler\nvec4 getTexel(sampler2D sampler, int pos, ivec2 size) {\n  int width = size.x;\n  int y = ifloor(pos / width);\n  int x = pos - y * width;  // pos % width\n\n  return texture2D(sampler, (vec2(x, y) + 0.5) / vec2(size));\n}\n\nvoid calulateCrossings(vec2 p0, vec2 p1, vec2 p2, out vec2 C1, out vec2 C2) {\n\n  // get the coefficients of the quadratic in t\n  vec2 a = p0 - p1 * 2.0 + p2;\n  vec2 b = p0 - p1;\n  vec2 c = p0 - vTexCoord;\n\n  // found out which values of 't' it crosses the axes\n  vec2 surd = sqrt(max(vec2(0.0), b * b - a * c));\n  vec2 t1 = ((b - surd) / a).yx;\n  vec2 t2 = ((b + surd) / a).yx;\n\n  // approximate straight lines to avoid rounding errors\n  if (abs(a.y) < 0.001)\n    t1.x = t2.x = c.y / (2.0 * b.y);\n\n  if (abs(a.x) < 0.001)\n    t1.y = t2.y = c.x / (2.0 * b.x);\n\n  // plug into quadratic formula to find the corrdinates of the crossings\n  C1 = ((a * t1 - b * 2.0) * t1 + c) * pixelScale;\n  C2 = ((a * t2 - b * 2.0) * t2 + c) * pixelScale;\n}\n\nvoid coverageX(vec2 p0, vec2 p1, vec2 p2) {\n\n  vec2 C1, C2;\n  calulateCrossings(p0, p1, p2, C1, C2);\n\n  // determine on which side of the x-axis the points lie\n  bool y0 = p0.y > vTexCoord.y;\n  bool y1 = p1.y > vTexCoord.y;\n  bool y2 = p2.y > vTexCoord.y;\n\n  // could web be under the curve (after t1)?\n  if (y1 ? !y2 : y0) {\n    // add the coverage for t1\n    coverage.x += saturate(C1.x + 0.5);\n    // calculate the anti-aliasing for t1\n    weight.x = min(weight.x, abs(C1.x));\n  }\n\n  // are we outside the curve (after t2)?\n  if (y1 ? !y0 : y2) {\n    // subtract the coverage for t2\n    coverage.x -= saturate(C2.x + 0.5);\n    // calculate the anti-aliasing for t2\n    weight.x = min(weight.x, abs(C2.x));\n  }\n}\n\n// this is essentially the same as coverageX, but with the axes swapped\nvoid coverageY(vec2 p0, vec2 p1, vec2 p2) {\n\n  vec2 C1, C2;\n  calulateCrossings(p0, p1, p2, C1, C2);\n\n  bool x0 = p0.x > vTexCoord.x;\n  bool x1 = p1.x > vTexCoord.x;\n  bool x2 = p2.x > vTexCoord.x;\n\n  if (x1 ? !x2 : x0) {\n    coverage.y -= saturate(C1.y + 0.5);\n    weight.y = min(weight.y, abs(C1.y));\n  }\n\n  if (x1 ? !x0 : x2) {\n    coverage.y += saturate(C2.y + 0.5);\n    weight.y = min(weight.y, abs(C2.y));\n  }\n}\n\nvoid main() {\n\n  // calculate the pixel scale based on screen-coordinates\n  pixelScale = hardness / fwidth(vTexCoord);\n\n  // which grid cell is this pixel in?\n  ivec2 gridCoord = ifloor(vTexCoord * vec2(uGridSize));\n\n  // intersect curves in this row\n  {\n    // the index into the row info bitmap\n    int rowIndex = gridCoord.y + uGridOffset.y;\n    // fetch the info texel\n    vec4 rowInfo = getTexel(uSamplerRows, rowIndex, uGridImageSize);\n    // unpack the rowInfo\n    int rowStrokeIndex = getInt16(rowInfo.xy);\n    int rowStrokeCount = getInt16(rowInfo.zw);\n\n    for (int iRowStroke = INT(0); iRowStroke < N; iRowStroke++) {\n      if (iRowStroke >= rowStrokeCount)\n        break;\n\n      // each stroke is made up of 3 points: the start and control point\n      // and the start of the next curve.\n      // fetch the indices of this pair of strokes:\n      vec4 strokeIndices = getTexel(uSamplerRowStrokes, rowStrokeIndex++, uCellsImageSize);\n\n      // unpack the stroke index\n      int strokePos = getInt16(strokeIndices.xy);\n\n      // fetch the two strokes\n      vec4 stroke0 = getTexel(uSamplerStrokes, strokePos + INT(0), uStrokeImageSize);\n      vec4 stroke1 = getTexel(uSamplerStrokes, strokePos + INT(1), uStrokeImageSize);\n\n      // calculate the coverage\n      coverageX(stroke0.xy, stroke0.zw, stroke1.xy);\n    }\n  }\n\n  // intersect curves in this column\n  {\n    int colIndex = gridCoord.x + uGridOffset.x;\n    vec4 colInfo = getTexel(uSamplerCols, colIndex, uGridImageSize);\n    int colStrokeIndex = getInt16(colInfo.xy);\n    int colStrokeCount = getInt16(colInfo.zw);\n    \n    for (int iColStroke = INT(0); iColStroke < N; iColStroke++) {\n      if (iColStroke >= colStrokeCount)\n        break;\n\n      vec4 strokeIndices = getTexel(uSamplerColStrokes, colStrokeIndex++, uCellsImageSize);\n\n      int strokePos = getInt16(strokeIndices.xy);\n      vec4 stroke0 = getTexel(uSamplerStrokes, strokePos + INT(0), uStrokeImageSize);\n      vec4 stroke1 = getTexel(uSamplerStrokes, strokePos + INT(1), uStrokeImageSize);\n      coverageY(stroke0.xy, stroke0.zw, stroke1.xy);\n    }\n  }\n\n  weight = saturate(1.0 - weight * 2.0);\n  float distance = max(weight.x + weight.y, minDistance); // manhattan approx.\n  float antialias = abs(dot(coverage, weight) / distance);\n  float cover = min(abs(coverage.x), abs(coverage.y));\n  gl_FragColor = vec4(uMaterialColor.rgb, 1.) * uMaterialColor.a;\n  gl_FragColor *= saturate(max(antialias, cover));\n}\n",lineVert:m+"/*\n  Part of the Processing project - http://processing.org\n  Copyright (c) 2012-15 The Processing Foundation\n  Copyright (c) 2004-12 Ben Fry and Casey Reas\n  Copyright (c) 2001-04 Massachusetts Institute of Technology\n  This library is free software; you can redistribute it and/or\n  modify it under the terms of the GNU Lesser General Public\n  License as published by the Free Software Foundation, version 2.1.\n  This library is distributed in the hope that it will be useful,\n  but WITHOUT ANY WARRANTY; without even the implied warranty of\n  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n  Lesser General Public License for more details.\n  You should have received a copy of the GNU Lesser General\n  Public License along with this library; if not, write to the\n  Free Software Foundation, Inc., 59 Temple Place, Suite 330,\n  Boston, MA  02111-1307  USA\n*/\n\n#define PROCESSING_LINE_SHADER\n\nprecision mediump float;\nprecision mediump int;\n\nuniform mat4 uModelViewMatrix;\nuniform mat4 uProjectionMatrix;\nuniform float uStrokeWeight;\n\nuniform bool uUseLineColor;\nuniform vec4 uMaterialColor;\n\nuniform vec4 uViewport;\nuniform int uPerspective;\nuniform int uStrokeJoin;\n\nattribute vec4 aPosition;\nattribute vec3 aTangentIn;\nattribute vec3 aTangentOut;\nattribute float aSide;\nattribute vec4 aVertexColor;\n\nvarying vec4 vColor;\nvarying vec2 vTangent;\nvarying vec2 vCenter;\nvarying vec2 vPosition;\nvarying float vMaxDist;\nvarying float vCap;\nvarying float vJoin;\n\nvec2 lineIntersection(vec2 aPoint, vec2 aDir, vec2 bPoint, vec2 bDir) {\n  // Rotate and translate so a starts at the origin and goes out to the right\n  bPoint -= aPoint;\n  vec2 rotatedBFrom = vec2(\n    bPoint.x*aDir.x + bPoint.y*aDir.y,\n    bPoint.y*aDir.x - bPoint.x*aDir.y\n  );\n  vec2 bTo = bPoint + bDir;\n  vec2 rotatedBTo = vec2(\n    bTo.x*aDir.x + bTo.y*aDir.y,\n    bTo.y*aDir.x - bTo.x*aDir.y\n  );\n  float intersectionDistance =\n    rotatedBTo.x + (rotatedBFrom.x - rotatedBTo.x) * rotatedBTo.y /\n    (rotatedBTo.y - rotatedBFrom.y);\n  return aPoint + aDir * intersectionDistance;\n}\n\nvoid main() {\n  // using a scale <1 moves the lines towards the camera\n  // in order to prevent popping effects due to half of\n  // the line disappearing behind the geometry faces.\n  vec3 scale = vec3(0.9995);\n\n  // Caps have one of either the in or out tangent set to 0\n  vCap = (aTangentIn == vec3(0.)) != (aTangentOut == (vec3(0.)))\n    ? 1. : 0.;\n\n  // Joins have two unique, defined tangents\n  vJoin = (\n    aTangentIn != vec3(0.) &&\n    aTangentOut != vec3(0.) &&\n    aTangentIn != aTangentOut\n  ) ? 1. : 0.;\n\n  vec4 posp = uModelViewMatrix * aPosition;\n  vec4 posqIn = uModelViewMatrix * (aPosition + vec4(aTangentIn, 0));\n  vec4 posqOut = uModelViewMatrix * (aPosition + vec4(aTangentOut, 0));\n\n  // Moving vertices slightly toward the camera\n  // to avoid depth-fighting with the fill triangles.\n  // Discussed here:\n  // http://www.opengl.org/discussion_boards/ubbthreads.php?ubb=showflat&Number=252848  \n  posp.xyz = posp.xyz * scale;\n  posqIn.xyz = posqIn.xyz * scale;\n  posqOut.xyz = posqOut.xyz * scale;\n\n  vec4 p = uProjectionMatrix * posp;\n  vec4 qIn = uProjectionMatrix * posqIn;\n  vec4 qOut = uProjectionMatrix * posqOut;\n  vCenter = p.xy;\n\n  // formula to convert from clip space (range -1..1) to screen space (range 0..[width or height])\n  // screen_p = (p.xy/p.w + <1,1>) * 0.5 * uViewport.zw\n\n  // prevent division by W by transforming the tangent formula (div by 0 causes\n  // the line to disappear, see https://github.com/processing/processing/issues/5183)\n  // t = screen_q - screen_p\n  //\n  // tangent is normalized and we don't care which aDirection it points to (+-)\n  // t = +- normalize( screen_q - screen_p )\n  // t = +- normalize( (q.xy/q.w+<1,1>)*0.5*uViewport.zw - (p.xy/p.w+<1,1>)*0.5*uViewport.zw )\n  //\n  // extract common factor, <1,1> - <1,1> cancels out\n  // t = +- normalize( (q.xy/q.w - p.xy/p.w) * 0.5 * uViewport.zw )\n  //\n  // convert to common divisor\n  // t = +- normalize( ((q.xy*p.w - p.xy*q.w) / (p.w*q.w)) * 0.5 * uViewport.zw )\n  //\n  // remove the common scalar divisor/factor, not needed due to normalize and +-\n  // (keep uViewport - can't remove because it has different components for x and y\n  //  and corrects for aspect ratio, see https://github.com/processing/processing/issues/5181)\n  // t = +- normalize( (q.xy*p.w - p.xy*q.w) * uViewport.zw )\n\n  vec2 tangentIn = normalize((qIn.xy*p.w - p.xy*qIn.w) * uViewport.zw);\n  vec2 tangentOut = normalize((qOut.xy*p.w - p.xy*qOut.w) * uViewport.zw);\n\n  vec2 curPerspScale;\n  if(uPerspective == 1) {\n    // Perspective ---\n    // convert from world to clip by multiplying with projection scaling factor\n    // to get the right thickness (see https://github.com/processing/processing/issues/5182)\n    // invert Y, projections in Processing invert Y\n    curPerspScale = (uProjectionMatrix * vec4(1, -1, 0, 0)).xy;\n  } else {\n    // No Perspective ---\n    // multiply by W (to cancel out division by W later in the pipeline) and\n    // convert from screen to clip (derived from clip to screen above)\n    curPerspScale = p.w / (0.5 * uViewport.zw);\n  }\n\n  vec2 offset;\n  if (vJoin == 1.) {\n    vTangent = normalize(tangentIn + tangentOut);\n    vec2 normalIn = vec2(-tangentIn.y, tangentIn.x);\n    vec2 normalOut = vec2(-tangentOut.y, tangentOut.x);\n    float side = sign(aSide);\n    float sideEnum = abs(aSide);\n\n    // We generate vertices for joins on either side of the centerline, but\n    // the \"elbow\" side is the only one needing a join. By not setting the\n    // offset for the other side, all its vertices will end up in the same\n    // spot and not render, effectively discarding it.\n    if (sign(dot(tangentOut, vec2(-tangentIn.y, tangentIn.x))) != side) {\n      // Side enums:\n      //   1: the side going into the join\n      //   2: the middle of the join\n      //   3: the side going out of the join\n      if (sideEnum == 2.) {\n        // Calculate the position + tangent on either side of the join, and\n        // find where the lines intersect to find the elbow of the join\n        vec2 c = (posp.xy/posp.w + vec2(1.,1.)) * 0.5 * uViewport.zw;\n        vec2 intersection = lineIntersection(\n          c + (side * normalIn * uStrokeWeight / 2.) * curPerspScale,\n          tangentIn,\n          c + (side * normalOut * uStrokeWeight / 2.) * curPerspScale,\n          tangentOut\n        );\n        offset = (intersection - c);\n\n        // When lines are thick and the angle of the join approaches 180, the\n        // elbow might be really far from the center. We'll apply a limit to\n        // the magnitude to avoid lines going across the whole screen when this\n        // happens.\n        float mag = length(offset);\n        float maxMag = 3. * uStrokeWeight;\n        if (mag > maxMag) {\n          offset *= maxMag / mag;\n        }\n      } else if (sideEnum == 1.) {\n        offset = side * normalIn * curPerspScale * uStrokeWeight / 2.;\n      } else if (sideEnum == 3.) {\n        offset = side * normalOut * curPerspScale * uStrokeWeight / 2.;\n      }\n    }\n    if (uStrokeJoin == STROKE_JOIN_BEVEL) {\n      vec2 avgNormal = vec2(-vTangent.y, vTangent.x);\n      vMaxDist = abs(dot(avgNormal, normalIn * uStrokeWeight / 2.));\n    } else {\n      vMaxDist = uStrokeWeight / 2.;\n    }\n  } else {\n    vec2 tangent = aTangentIn == vec3(0.) ? tangentOut : tangentIn;\n    vTangent = tangent;\n    vec2 normal = vec2(-tangent.y, tangent.x);\n\n    float normalOffset = sign(aSide);\n    // Caps will have side values of -2 or 2 on the edge of the cap that\n    // extends out from the line\n    float tangentOffset = abs(aSide) - 1.;\n    offset = (normal * normalOffset + tangent * tangentOffset) *\n      uStrokeWeight * 0.5 * curPerspScale;\n    vMaxDist = uStrokeWeight / 2.;\n  }\n  vPosition = vCenter + offset / curPerspScale;\n\n  gl_Position.xy = p.xy + offset.xy;\n  gl_Position.zw = p.zw;\n  \n  vColor = (uUseLineColor ? aVertexColor : uMaterialColor);\n}\n",lineFrag:m+"precision mediump float;\nprecision mediump int;\n\nuniform vec4 uMaterialColor;\nuniform int uStrokeCap;\nuniform int uStrokeJoin;\nuniform float uStrokeWeight;\n\nvarying vec4 vColor;\nvarying vec2 vTangent;\nvarying vec2 vCenter;\nvarying vec2 vPosition;\nvarying float vMaxDist;\nvarying float vCap;\nvarying float vJoin;\n\nfloat distSquared(vec2 a, vec2 b) {\n  vec2 aToB = b - a;\n  return dot(aToB, aToB);\n}\n\nvoid main() {\n  if (vCap > 0.) {\n    if (\n      uStrokeCap == STROKE_CAP_ROUND &&\n      distSquared(vPosition, vCenter) > uStrokeWeight * uStrokeWeight * 0.25\n    ) {\n      discard;\n    } else if (\n      uStrokeCap == STROKE_CAP_SQUARE &&\n      dot(vPosition - vCenter, vTangent) > 0.\n    ) {\n      discard;\n    }\n    // Use full area for PROJECT\n  } else if (vJoin > 0.) {\n    if (\n      uStrokeJoin == STROKE_JOIN_ROUND &&\n      distSquared(vPosition, vCenter) > uStrokeWeight * uStrokeWeight * 0.25\n    ) {\n      discard;\n    } else if (uStrokeJoin == STROKE_JOIN_BEVEL) {\n      vec2 normal = vec2(-vTangent.y, vTangent.x);\n      if (abs(dot(vPosition - vCenter, normal)) > vMaxDist) {\n        discard;\n      }\n    }\n    // Use full area for MITER\n  }\n  gl_FragColor = vec4(vColor.rgb, 1.) * vColor.a;\n}\n",pointVert:"attribute vec3 aPosition;\nuniform float uPointSize;\nvarying float vStrokeWeight;\nuniform mat4 uModelViewMatrix;\nuniform mat4 uProjectionMatrix;\nvoid main() {\n\tvec4 positionVec4 =  vec4(aPosition, 1.0);\n\tgl_Position = uProjectionMatrix * uModelViewMatrix * positionVec4;\n\tgl_PointSize = uPointSize;\n\tvStrokeWeight = uPointSize;\n}",pointFrag:"precision mediump float;\nprecision mediump int;\nuniform vec4 uMaterialColor;\nvarying float vStrokeWeight;\n\nvoid main(){\n  float mask = 0.0;\n\n  // make a circular mask using the gl_PointCoord (goes from 0 - 1 on a point)\n  // might be able to get a nicer edge on big strokeweights with smoothstep but slightly less performant\n\n  mask = step(0.98, length(gl_PointCoord * 2.0 - 1.0));\n\n  // if strokeWeight is 1 or less lets just draw a square\n  // this prevents weird artifacting from carving circles when our points are really small\n  // if strokeWeight is larger than 1, we just use it as is\n\n  mask = mix(0.0, mask, clamp(floor(vStrokeWeight - 0.5),0.0,1.0));\n\n  // throw away the borders of the mask\n  // otherwise we get weird alpha blending issues\n\n  if(mask > 0.98){\n    discard;\n  }\n\n  gl_FragColor = vec4(uMaterialColor.rgb, 1.) * uMaterialColor.a;\n}\n"};s.default.RendererGL=function(e,t,r,n){return s.default.Renderer.call(this,e,t,r),this._setAttributeDefaults(t),this._initContext(),this.isP3D=!0,this.GL=this.drawingContext,this._pInst._setProperty("drawingContext",this.drawingContext),this._isErasing=!1,this._enableLighting=!1,this.ambientLightColors=[],this.specularColors=[1,1,1],this.directionalLightDirections=[],this.directionalLightDiffuseColors=[],this.directionalLightSpecularColors=[],this.pointLightPositions=[],this.pointLightDiffuseColors=[],this.pointLightSpecularColors=[],this.spotLightPositions=[],this.spotLightDirections=[],this.spotLightDiffuseColors=[],this.spotLightSpecularColors=[],this.spotLightAngle=[],this.spotLightConc=[],this.drawMode=o.FILL,this.curFillColor=this._cachedFillStyle=[1,1,1,1],this.curAmbientColor=this._cachedFillStyle=[1,1,1,1],this.curSpecularColor=this._cachedFillStyle=[0,0,0,0],this.curEmissiveColor=this._cachedFillStyle=[0,0,0,0],this.curStrokeColor=this._cachedStrokeStyle=[0,0,0,1],this.curBlendMode=o.BLEND,this._cachedBlendMode=void 0,this.blendExt=this.GL.getExtension("EXT_blend_minmax"),this._isBlending=!1,this._useSpecularMaterial=!1,this._useEmissiveMaterial=!1,this._useNormalMaterial=!1,this._useShininess=1,this._useLineColor=!1,this._useVertexColor=!1,this.registerEnabled=[],this._tint=[255,255,255,255],this.constantAttenuation=1,this.linearAttenuation=0,this.quadraticAttenuation=0,this.uMVMatrix=new s.default.Matrix,this.uPMatrix=new s.default.Matrix,this.uNMatrix=new s.default.Matrix("mat3"),this._currentNormal=new s.default.Vector(0,0,1),this._curCamera=new s.default.Camera(this),this._curCamera._computeCameraDefaultSettings(),this._curCamera._setDefaultCamera(),this._defaultLightShader=void 0,this._defaultImmediateModeShader=void 0,this._defaultNormalShader=void 0,this._defaultColorShader=void 0,this._defaultPointShader=void 0,this.userFillShader=void 0,this.userStrokeShader=void 0,this.userPointShader=void 0,this.retainedMode={geometry:{},buffers:{stroke:[new s.default.RenderBuffer(4,"lineVertexColors","lineColorBuffer","aVertexColor",this,this._flatten),new s.default.RenderBuffer(3,"lineVertices","lineVerticesBuffer","aPosition",this,this._flatten),new s.default.RenderBuffer(3,"lineTangentsIn","lineTangentsInBuffer","aTangentIn",this,this._flatten),new s.default.RenderBuffer(3,"lineTangentsOut","lineTangentsOutBuffer","aTangentOut",this,this._flatten),new s.default.RenderBuffer(1,"lineSides","lineSidesBuffer","aSide",this)],fill:[new s.default.RenderBuffer(3,"vertices","vertexBuffer","aPosition",this,this._vToNArray),new s.default.RenderBuffer(3,"vertexNormals","normalBuffer","aNormal",this,this._vToNArray),new s.default.RenderBuffer(4,"vertexColors","colorBuffer","aVertexColor",this),new s.default.RenderBuffer(3,"vertexAmbients","ambientBuffer","aAmbientColor",this),new s.default.RenderBuffer(2,"uvs","uvBuffer","aTexCoord",this,this._flatten)],text:[new s.default.RenderBuffer(3,"vertices","vertexBuffer","aPosition",this,this._vToNArray),new s.default.RenderBuffer(2,"uvs","uvBuffer","aTexCoord",this,this._flatten)]}},this.immediateMode={geometry:new s.default.Geometry,shapeMode:o.TRIANGLE_FAN,_bezierVertex:[],_quadraticVertex:[],_curveVertex:[],buffers:{fill:[new s.default.RenderBuffer(3,"vertices","vertexBuffer","aPosition",this,this._vToNArray),new s.default.RenderBuffer(3,"vertexNormals","normalBuffer","aNormal",this,this._vToNArray),new s.default.RenderBuffer(4,"vertexColors","colorBuffer","aVertexColor",this),new s.default.RenderBuffer(3,"vertexAmbients","ambientBuffer","aAmbientColor",this),new s.default.RenderBuffer(2,"uvs","uvBuffer","aTexCoord",this,this._flatten)],stroke:[new s.default.RenderBuffer(4,"lineVertexColors","lineColorBuffer","aVertexColor",this,this._flatten),new s.default.RenderBuffer(3,"lineVertices","lineVerticesBuffer","aPosition",this,this._flatten),new s.default.RenderBuffer(3,"lineTangentsIn","lineTangentsInBuffer","aTangentIn",this,this._flatten),new s.default.RenderBuffer(3,"lineTangentsOut","lineTangentsOutBuffer","aTangentOut",this,this._flatten),new s.default.RenderBuffer(1,"lineSides","lineSidesBuffer","aSide",this)],point:this.GL.createBuffer()}},this.pointSize=5,this.curStrokeWeight=1,this.curStrokeCap=o.ROUND,this.curStrokeJoin=o.ROUND,this.textures=[],this.textureMode=o.IMAGE,this.textureWrapX=o.CLAMP,this.textureWrapY=o.CLAMP,this._tex=null,this._curveTightness=6,this._lookUpTableBezier=[],this._lookUpTableQuadratic=[],this._lutBezierDetail=0,this._lutQuadraticDetail=0,this.isProcessingVertices=!1,this._tessy=this._initTessy(),this.fontInfos={},this._curShader=void 0,this},s.default.RendererGL.prototype=Object.create(s.default.Renderer.prototype),s.default.RendererGL.prototype._setAttributeDefaults=function(e){var t={alpha:!0,depth:!0,stencil:!0,antialias:navigator.userAgent.toLowerCase().includes("safari"),premultipliedAlpha:!0,preserveDrawingBuffer:!0,perPixelLighting:!0};null===e._glAttributes?e._glAttributes=t:e._glAttributes=Object.assign(t,e._glAttributes)},s.default.RendererGL.prototype._initContext=function(){if(this.drawingContext=this.canvas.getContext("webgl",this._pInst._glAttributes)||this.canvas.getContext("experimental-webgl",this._pInst._glAttributes),null===this.drawingContext)throw new Error("Error creating webgl context");var e=this.drawingContext;e.enable(e.DEPTH_TEST),e.depthFunc(e.LEQUAL),e.viewport(0,0,e.drawingBufferWidth,e.drawingBufferHeight),this._viewport=this.drawingContext.getParameter(this.drawingContext.VIEWPORT)},s.default.RendererGL.prototype._resetContext=function(e,t){var r,n=this.width,i=this.height,o=this.canvas.id,a=this._pInst instanceof s.default.Graphics;a?((r=this._pInst).canvas.parentNode.removeChild(r.canvas),r.canvas=document.createElement("canvas"),(r._pInst._userNode||document.body).appendChild(r.canvas),s.default.Element.call(r,r.canvas,r._pInst),r.width=n,r.height=i):((r=this.canvas)&&r.parentNode.removeChild(r),(r=document.createElement("canvas")).id=o,(this._pInst._userNode||document.body).appendChild(r),this._pInst.canvas=r,this.canvas=r),o=new s.default.RendererGL(this._pInst.canvas,this._pInst,!a);this._pInst._setProperty("_renderer",o),o.resize(n,i),o._applyDefaults(),a||this._pInst._elements.push(o),"function"==typeof t&&setTimeout((function(){t.apply(window._renderer,e)}),0)},s.default.prototype.setAttributes=function(e,t){if(void 0===this._glAttributes);else{var r=!0;if(void 0!==t?(null===this._glAttributes&&(this._glAttributes={}),this._glAttributes[e]!==t&&(this._glAttributes[e]=t,r=!1)):e instanceof Object&&this._glAttributes!==e&&(this._glAttributes=e,r=!1),this._renderer.isP3D&&!r){if(!this._setupDone)for(var n in this._renderer.retainedMode.geometry)if(this._renderer.retainedMode.geometry.hasOwnProperty(n))return;this.push(),this._renderer._resetContext(),this.pop(),this._renderer._curCamera&&(this._renderer._curCamera._renderer=this._renderer)}}},s.default.RendererGL.prototype._update=function(){this.uMVMatrix.set(this._curCamera.cameraMatrix.mat4[0],this._curCamera.cameraMatrix.mat4[1],this._curCamera.cameraMatrix.mat4[2],this._curCamera.cameraMatrix.mat4[3],this._curCamera.cameraMatrix.mat4[4],this._curCamera.cameraMatrix.mat4[5],this._curCamera.cameraMatrix.mat4[6],this._curCamera.cameraMatrix.mat4[7],this._curCamera.cameraMatrix.mat4[8],this._curCamera.cameraMatrix.mat4[9],this._curCamera.cameraMatrix.mat4[10],this._curCamera.cameraMatrix.mat4[11],this._curCamera.cameraMatrix.mat4[12],this._curCamera.cameraMatrix.mat4[13],this._curCamera.cameraMatrix.mat4[14],this._curCamera.cameraMatrix.mat4[15]),this.ambientLightColors.length=0,this.specularColors=[1,1,1],this.directionalLightDirections.length=0,this.directionalLightDiffuseColors.length=0,this.directionalLightSpecularColors.length=0,this.pointLightPositions.length=0,this.pointLightDiffuseColors.length=0,this.pointLightSpecularColors.length=0,this.spotLightPositions.length=0,this.spotLightDirections.length=0,this.spotLightDiffuseColors.length=0,this.spotLightSpecularColors.length=0,this.spotLightAngle.length=0,this.spotLightConc.length=0,this._enableLighting=!1,this._tint=[255,255,255,255],this.GL.clear(this.GL.DEPTH_BUFFER_BIT)},s.default.RendererGL.prototype.background=function(){var e=(n=(n=this._pInst).color.apply(n,arguments)).levels[0]/255,t=n.levels[1]/255,r=n.levels[2]/255,n=n.levels[3]/255;this.clear(e,t,r,n)},s.default.RendererGL.prototype.fill=function(e,t,r,n){var i=s.default.prototype.color.apply(this._pInst,arguments);this.curFillColor=i._array,this.drawMode=o.FILL,this._useNormalMaterial=!1,this._tex=null},s.default.RendererGL.prototype.stroke=function(e,t,r,n){var i=s.default.prototype.color.apply(this._pInst,arguments);this.curStrokeColor=i._array},s.default.RendererGL.prototype.strokeCap=function(e){this.curStrokeCap=e},s.default.RendererGL.prototype.strokeJoin=function(e){this.curStrokeJoin=e},s.default.RendererGL.prototype.filter=function(e){},s.default.RendererGL.prototype.blendMode=function(e){e===o.DARKEST||e===o.LIGHTEST||e===o.ADD||e===o.BLEND||e===o.SUBTRACT||e===o.SCREEN||e===o.EXCLUSION||e===o.REPLACE||e===o.MULTIPLY||e===o.REMOVE?this.curBlendMode=e:e!==o.BURN&&e!==o.OVERLAY&&e!==o.HARD_LIGHT&&e!==o.SOFT_LIGHT&&o.DODGE},s.default.RendererGL.prototype.erase=function(e,t){this._isErasing||(this._applyBlendMode(o.REMOVE),this._isErasing=!0,this._cachedFillStyle=this.curFillColor.slice(),this.curFillColor=[1,1,1,e/255],this._cachedStrokeStyle=this.curStrokeColor.slice(),this.curStrokeColor=[1,1,1,t/255])},s.default.RendererGL.prototype.noErase=function(){this._isErasing&&(this._isErasing=!1,this.curFillColor=this._cachedFillStyle.slice(),this.curStrokeColor=this._cachedStrokeStyle.slice(),this.blendMode(this._cachedBlendMode))},s.default.RendererGL.prototype.strokeWeight=function(e){this.curStrokeWeight!==e&&(this.pointSize=e,this.curStrokeWeight=e)},s.default.RendererGL.prototype._getPixel=function(e,t){var r=new Uint8Array(4);return this.drawingContext.readPixels(e,t,1,1,this.drawingContext.RGBA,this.drawingContext.UNSIGNED_BYTE,r),[r[0],r[1],r[2],r[3]]},s.default.RendererGL.prototype.loadPixels=function(){var e,t=this._pixelsState;!0!==this._pInst._glAttributes.preserveDrawingBuffer||(t=t.pixels,e=this.GL.drawingBufferWidth*this.GL.drawingBufferHeight*4,t instanceof Uint8Array&&t.length===e||(t=new Uint8Array(e),this._pixelsState._setProperty("pixels",t)),e=this._pInst._pixelDensity,this.GL.readPixels(0,0,this.width*e,this.height*e,this.GL.RGBA,this.GL.UNSIGNED_BYTE,t))},s.default.RendererGL.prototype.geometryInHash=function(e){return void 0!==this.retainedMode.geometry[e]},s.default.RendererGL.prototype.resize=function(e,t){s.default.Renderer.prototype.resize.call(this,e,t),this.GL.viewport(0,0,this.GL.drawingBufferWidth,this.GL.drawingBufferHeight),this._viewport=this.GL.getParameter(this.GL.VIEWPORT),this._curCamera._resize(),void 0!==(e=this._pixelsState).pixels&&e._setProperty("pixels",new Uint8Array(this.GL.drawingBufferWidth*this.GL.drawingBufferHeight*4))},s.default.RendererGL.prototype.clear=function(){var e=(arguments.length<=0?void 0:arguments[0])||0,t=(arguments.length<=1?void 0:arguments[1])||0,r=(arguments.length<=2?void 0:arguments[2])||0,n=(arguments.length<=3?void 0:arguments[3])||0;this.GL.clearColor(e*n,t*n,r*n,n),this.GL.clearDepth(1),this.GL.clear(this.GL.COLOR_BUFFER_BIT|this.GL.DEPTH_BUFFER_BIT)},s.default.RendererGL.prototype.applyMatrix=function(e,t,r,n,i,o){16===arguments.length?s.default.Matrix.prototype.apply.apply(this.uMVMatrix,arguments):this.uMVMatrix.apply([e,t,0,0,r,n,0,0,0,0,1,0,i,o,0,1])},s.default.RendererGL.prototype.translate=function(e,t,r){return e instanceof s.default.Vector&&(r=e.z,t=e.y,e=e.x),this.uMVMatrix.translate([e,t,r]),this},s.default.RendererGL.prototype.scale=function(e,t,r){return this.uMVMatrix.scale(e,t,r),this},s.default.RendererGL.prototype.rotate=function(e,t){return void 0===t?this.rotateZ(e):(s.default.Matrix.prototype.rotate.apply(this.uMVMatrix,arguments),this)},s.default.RendererGL.prototype.rotateX=function(e){return this.rotate(e,1,0,0),this},s.default.RendererGL.prototype.rotateY=function(e){return this.rotate(e,0,1,0),this},s.default.RendererGL.prototype.rotateZ=function(e){return this.rotate(e,0,0,1),this},s.default.RendererGL.prototype.push=function(){var e=s.default.Renderer.prototype.push.apply(this),t=e.properties;return t.uMVMatrix=this.uMVMatrix.copy(),t.uPMatrix=this.uPMatrix.copy(),t._curCamera=this._curCamera,this._curCamera=this._curCamera.copy(),t.ambientLightColors=this.ambientLightColors.slice(),t.specularColors=this.specularColors.slice(),t.directionalLightDirections=this.directionalLightDirections.slice(),t.directionalLightDiffuseColors=this.directionalLightDiffuseColors.slice(),t.directionalLightSpecularColors=this.directionalLightSpecularColors.slice(),t.pointLightPositions=this.pointLightPositions.slice(),t.pointLightDiffuseColors=this.pointLightDiffuseColors.slice(),t.pointLightSpecularColors=this.pointLightSpecularColors.slice(),t.spotLightPositions=this.spotLightPositions.slice(),t.spotLightDirections=this.spotLightDirections.slice(),t.spotLightDiffuseColors=this.spotLightDiffuseColors.slice(),t.spotLightSpecularColors=this.spotLightSpecularColors.slice(),t.spotLightAngle=this.spotLightAngle.slice(),t.spotLightConc=this.spotLightConc.slice(),t.userFillShader=this.userFillShader,t.userStrokeShader=this.userStrokeShader,t.userPointShader=this.userPointShader,t.pointSize=this.pointSize,t.curStrokeWeight=this.curStrokeWeight,t.curStrokeColor=this.curStrokeColor,t.curFillColor=this.curFillColor,t.curAmbientColor=this.curAmbientColor,t.curSpecularColor=this.curSpecularColor,t.curEmissiveColor=this.curEmissiveColor,t._useSpecularMaterial=this._useSpecularMaterial,t._useEmissiveMaterial=this._useEmissiveMaterial,t._useShininess=this._useShininess,t.constantAttenuation=this.constantAttenuation,t.linearAttenuation=this.linearAttenuation,t.quadraticAttenuation=this.quadraticAttenuation,t._enableLighting=this._enableLighting,t._useNormalMaterial=this._useNormalMaterial,t._tex=this._tex,t.drawMode=this.drawMode,t._currentNormal=this._currentNormal,t.curBlendMode=this.curBlendMode,e},s.default.RendererGL.prototype.resetMatrix=function(){return this.uMVMatrix.set(this._curCamera.cameraMatrix.mat4[0],this._curCamera.cameraMatrix.mat4[1],this._curCamera.cameraMatrix.mat4[2],this._curCamera.cameraMatrix.mat4[3],this._curCamera.cameraMatrix.mat4[4],this._curCamera.cameraMatrix.mat4[5],this._curCamera.cameraMatrix.mat4[6],this._curCamera.cameraMatrix.mat4[7],this._curCamera.cameraMatrix.mat4[8],this._curCamera.cameraMatrix.mat4[9],this._curCamera.cameraMatrix.mat4[10],this._curCamera.cameraMatrix.mat4[11],this._curCamera.cameraMatrix.mat4[12],this._curCamera.cameraMatrix.mat4[13],this._curCamera.cameraMatrix.mat4[14],this._curCamera.cameraMatrix.mat4[15]),this},s.default.RendererGL.prototype._getImmediateStrokeShader=function(){var e=this.userStrokeShader;return e&&e.isStrokeShader()?e:this._getLineShader()},s.default.RendererGL.prototype._getRetainedStrokeShader=s.default.RendererGL.prototype._getImmediateStrokeShader,s.default.RendererGL.prototype._getImmediateFillShader=function(){var e=this.userFillShader;if(this._useNormalMaterial&&(!e||!e.isNormalShader()))return this._getNormalShader();if(this._enableLighting){if(!e||!e.isLightShader())return this._getLightShader()}else if(this._tex){if(!e||!e.isTextureShader())return this._getLightShader()}else if(!e)return this._getImmediateModeShader();return e},s.default.RendererGL.prototype._getRetainedFillShader=function(){if(this._useNormalMaterial)return this._getNormalShader();var e=this.userFillShader;if(this._enableLighting){if(!e||!e.isLightShader())return this._getLightShader()}else if(this._tex){if(!e||!e.isTextureShader())return this._getLightShader()}else if(!e)return this._getColorShader();return e},s.default.RendererGL.prototype._getImmediatePointShader=function(){var e=this.userPointShader;return e&&e.isPointShader()?e:this._getPointShader()},s.default.RendererGL.prototype._getRetainedLineShader=s.default.RendererGL.prototype._getImmediateLineShader,s.default.RendererGL.prototype._getLightShader=function(){return this._defaultLightShader||(this._pInst._glAttributes.perPixelLighting?this._defaultLightShader=new s.default.Shader(this,g.phongVert,g.phongFrag):this._defaultLightShader=new s.default.Shader(this,g.lightVert,g.lightTextureFrag)),this._defaultLightShader},s.default.RendererGL.prototype._getImmediateModeShader=function(){return this._defaultImmediateModeShader||(this._defaultImmediateModeShader=new s.default.Shader(this,g.immediateVert,g.vertexColorFrag)),this._defaultImmediateModeShader},s.default.RendererGL.prototype._getNormalShader=function(){return this._defaultNormalShader||(this._defaultNormalShader=new s.default.Shader(this,g.normalVert,g.normalFrag)),this._defaultNormalShader},s.default.RendererGL.prototype._getColorShader=function(){return this._defaultColorShader||(this._defaultColorShader=new s.default.Shader(this,g.normalVert,g.basicFrag)),this._defaultColorShader},s.default.RendererGL.prototype._getPointShader=function(){return this._defaultPointShader||(this._defaultPointShader=new s.default.Shader(this,g.pointVert,g.pointFrag)),this._defaultPointShader},s.default.RendererGL.prototype._getLineShader=function(){return this._defaultLineShader||(this._defaultLineShader=new s.default.Shader(this,g.lineVert,g.lineFrag)),this._defaultLineShader},s.default.RendererGL.prototype._getFontShader=function(){return this._defaultFontShader||(this.GL.getExtension("OES_standard_derivatives"),this._defaultFontShader=new s.default.Shader(this,g.fontVert,g.fontFrag)),this._defaultFontShader},s.default.RendererGL.prototype._getEmptyTexture=function(){var e;return this._emptyTexture||((e=new s.default.Image(1,1)).set(0,0,255),this._emptyTexture=new s.default.Texture(this,e)),this._emptyTexture},s.default.RendererGL.prototype.getTexture=function(e){var t=this.textures,r=!0,n=!1,i=void 0;try{for(var o,a=t[Symbol.iterator]();!(r=(o=a.next()).done);r=!0){var l=o.value;if(l.src===e)return l}}catch(e){n=!0,i=e}finally{try{r||null==a.return||a.return()}finally{if(n)throw i}}return n=new s.default.Texture(this,e),t.push(n),n},s.default.RendererGL.prototype._setStrokeUniforms=function(e){e.bindShader(),e.setUniform("uUseLineColor",this._useLineColor),e.setUniform("uMaterialColor",this.curStrokeColor),e.setUniform("uStrokeWeight",this.curStrokeWeight),e.setUniform("uStrokeCap",p[this.curStrokeCap]),e.setUniform("uStrokeJoin",f[this.curStrokeJoin])},s.default.RendererGL.prototype._setFillUniforms=function(e){e.bindShader(),e.setUniform("uUseVertexColor",this._useVertexColor),e.setUniform("uMaterialColor",this.curFillColor),e.setUniform("isTexture",!!this._tex),this._tex&&e.setUniform("uSampler",this._tex),e.setUniform("uTint",this._tint),e.setUniform("uAmbientMatColor",this.curAmbientColor),e.setUniform("uSpecularMatColor",this.curSpecularColor),e.setUniform("uEmissiveMatColor",this.curEmissiveColor),e.setUniform("uSpecular",this._useSpecularMaterial),e.setUniform("uEmissive",this._useEmissiveMaterial),e.setUniform("uShininess",this._useShininess),e.setUniform("uUseLighting",this._enableLighting);var t=this.pointLightDiffuseColors.length/3;e.setUniform("uPointLightCount",t),e.setUniform("uPointLightLocation",this.pointLightPositions),e.setUniform("uPointLightDiffuseColors",this.pointLightDiffuseColors),e.setUniform("uPointLightSpecularColors",this.pointLightSpecularColors),t=this.directionalLightDiffuseColors.length/3,e.setUniform("uDirectionalLightCount",t),e.setUniform("uLightingDirection",this.directionalLightDirections),e.setUniform("uDirectionalDiffuseColors",this.directionalLightDiffuseColors),e.setUniform("uDirectionalSpecularColors",this.directionalLightSpecularColors),t=this.ambientLightColors.length/3,e.setUniform("uAmbientLightCount",t),e.setUniform("uAmbientColor",this.ambientLightColors),t=this.spotLightDiffuseColors.length/3;e.setUniform("uSpotLightCount",t),e.setUniform("uSpotLightAngle",this.spotLightAngle),e.setUniform("uSpotLightConc",this.spotLightConc),e.setUniform("uSpotLightDiffuseColors",this.spotLightDiffuseColors),e.setUniform("uSpotLightSpecularColors",this.spotLightSpecularColors),e.setUniform("uSpotLightLocation",this.spotLightPositions),e.setUniform("uSpotLightDirection",this.spotLightDirections),e.setUniform("uConstantAttenuation",this.constantAttenuation),e.setUniform("uLinearAttenuation",this.linearAttenuation),e.setUniform("uQuadraticAttenuation",this.quadraticAttenuation),e.bindTextures()},s.default.RendererGL.prototype._setPointUniforms=function(e){e.bindShader(),e.setUniform("uMaterialColor",this.curStrokeColor),e.setUniform("uPointSize",this.pointSize*this._pInst._pixelDensity)},s.default.RendererGL.prototype._bindBuffer=function(e,t,r,n,i){t=t||this.GL.ARRAY_BUFFER,this.GL.bindBuffer(t,e),void 0!==r&&(e=new(n||Float32Array)(r),this.GL.bufferData(t,e,i||this.GL.STATIC_DRAW))},s.default.RendererGL.prototype._arraysEqual=function(e,t){var r=e.length;if(r!==t.length)return!1;for(var n=0;n<r;n++)if(e[n]!==t[n])return!1;return!0},s.default.RendererGL.prototype._isTypedArray=function(e){return Float32Array,Float64Array,Int16Array,Uint16Array,e instanceof Uint32Array},s.default.RendererGL.prototype._flatten=function(e){if(0===e.length)return[];var t;if(2e4<e.length){for(var r=Object.prototype.toString,n=[],i=e.slice(),s=i.pop();"[object Array]"===r.call(s)?i.push.apply(i,u(s)):n.push(s),i.length&&void 0!==(s=i.pop()););return n.reverse(),n}return(t=[]).concat.apply(t,u(e))},s.default.RendererGL.prototype._vToNArray=function(e){var t=[],r=!0,n=!1,i=void 0;try{for(var s,o=e[Symbol.iterator]();!(r=(s=o.next()).done);r=!0){var a=s.value;t.push(a.x,a.y,a.z)}}catch(e){n=!0,i=e}finally{try{r||null==o.return||o.return()}finally{if(n)throw i}}return t},s.default.prototype._assert3d=function(e){if(!this._renderer.isP3D)throw new Error("".concat(e,"() is only supported in WEBGL mode. If you'd like to use 3D graphics and WebGL, see  https://p5js.org/examples/form-3d-primitives.html for more information."))},s.default.RendererGL.prototype.tessyVertexSize=12,s.default.RendererGL.prototype._initTessy=function(){var e=new a.default.GluTesselator;return e.gluTessCallback(a.default.gluEnum.GLU_TESS_VERTEX_DATA,(function(e,t){for(var r=0;r<e.length;r++)t[t.length]=e[r]})),e.gluTessCallback(a.default.gluEnum.GLU_TESS_BEGIN,(function(e){a.default.primitiveType.GL_TRIANGLES})),e.gluTessCallback(a.default.gluEnum.GLU_TESS_ERROR,(function(e){})),e.gluTessCallback(a.default.gluEnum.GLU_TESS_COMBINE,(function(e,t,r){for(var n=new Array(s.default.RendererGL.prototype.tessyVertexSize).fill(0),i=0;i<r.length;i++)for(var o=0;o<n.length;o++)0!==r[i]&&t[i]&&(n[o]+=t[i][o]*r[i]);return n})),e.gluTessCallback(a.default.gluEnum.GLU_TESS_EDGE_FLAG,(function(e){})),e},s.default.RendererGL.prototype._triangulate=function(e){var t=e[0]?e[0][2]:void 0,r=!0,n=!0,i=!1,o=void 0;try{for(var a,l=e[Symbol.iterator]();!(n=(a=l.next()).done);n=!0)for(var c=a.value,u=0;u<c.length;u+=s.default.RendererGL.prototype.tessyVertexSize)if(c[u+2]!==t){r=!1;break}}catch(e){i=!0,o=e}finally{try{n||null==l.return||l.return()}finally{if(i)throw o}}r?this._tessy.gluTessNormal(0,0,1):this._tessy.gluTessNormal(0,0,0),i=[],this._tessy.gluTessBeginPolygon(i);for(var h=0;h<e.length;h++){this._tessy.gluTessBeginContour();for(var d=e[h],p=0;p<d.length;p+=s.default.RendererGL.prototype.tessyVertexSize){var f=d.slice(p,p+s.default.RendererGL.prototype.tessyVertexSize);this._tessy.gluTessVertex(f,f)}this._tessy.gluTessEndContour()}return this._tessy.gluTessEndPolygon(),i},s.default.RendererGL.prototype._bezierCoefficients=function(e){var t=e*e,r=1-e,n=r*r;return[n*r,3*n*e,3*r*t,t*e]},s.default.RendererGL.prototype._quadraticCoefficients=function(e){var t=1-e;return[t*t,2*t*e,e*e]},s.default.RendererGL.prototype._bezierToCatmull=function(e){return[e[1],e[1]+(e[2]-e[0])/this._curveTightness,e[2]-(e[3]-e[1])/this._curveTightness,e[2]]},e=s.default.RendererGL;r.default=e},{"../core/constants":256,"../core/main":267,"../core/p5.Renderer":270,"./p5.Camera":315,"./p5.Matrix":317,"./p5.Shader":322,"core-js/modules/es.array.concat":149,"core-js/modules/es.array.fill":152,"core-js/modules/es.array.filter":153,"core-js/modules/es.array.from":155,"core-js/modules/es.array.includes":156,"core-js/modules/es.array.iterator":158,"core-js/modules/es.array.slice":162,"core-js/modules/es.object.assign":172,"core-js/modules/es.object.get-own-property-descriptor":173,"core-js/modules/es.object.to-string":177,"core-js/modules/es.regexp.to-string":182,"core-js/modules/es.string.includes":185,"core-js/modules/es.string.iterator":186,"core-js/modules/es.symbol":196,"core-js/modules/es.symbol.description":194,"core-js/modules/es.symbol.iterator":195,"core-js/modules/es.typed-array.copy-within":197,"core-js/modules/es.typed-array.every":198,"core-js/modules/es.typed-array.fill":199,"core-js/modules/es.typed-array.filter":200,"core-js/modules/es.typed-array.find":202,"core-js/modules/es.typed-array.find-index":201,"core-js/modules/es.typed-array.float32-array":203,"core-js/modules/es.typed-array.float64-array":204,"core-js/modules/es.typed-array.for-each":205,"core-js/modules/es.typed-array.includes":206,"core-js/modules/es.typed-array.index-of":207,"core-js/modules/es.typed-array.int16-array":208,"core-js/modules/es.typed-array.iterator":210,"core-js/modules/es.typed-array.join":211,"core-js/modules/es.typed-array.last-index-of":212,"core-js/modules/es.typed-array.map":213,"core-js/modules/es.typed-array.reduce":215,"core-js/modules/es.typed-array.reduce-right":214,"core-js/modules/es.typed-array.reverse":216,"core-js/modules/es.typed-array.set":217,"core-js/modules/es.typed-array.slice":218,"core-js/modules/es.typed-array.some":219,"core-js/modules/es.typed-array.sort":220,"core-js/modules/es.typed-array.subarray":221,"core-js/modules/es.typed-array.to-locale-string":222,"core-js/modules/es.typed-array.to-string":223,"core-js/modules/es.typed-array.uint16-array":224,"core-js/modules/es.typed-array.uint32-array":225,"core-js/modules/es.typed-array.uint8-array":226,"core-js/modules/es.weak-map":228,"core-js/modules/web.dom-collections.iterator":230,libtess:239,path:242}],322:[function(e,t,r){"use strict";e("core-js/modules/es.symbol"),e("core-js/modules/es.symbol.description"),e("core-js/modules/es.symbol.iterator"),e("core-js/modules/es.array.index-of"),e("core-js/modules/es.array.iterator"),e("core-js/modules/es.array.slice"),e("core-js/modules/es.function.name"),e("core-js/modules/es.object.to-string"),e("core-js/modules/es.string.iterator"),e("core-js/modules/web.dom-collections.iterator"),e("core-js/modules/es.symbol"),e("core-js/modules/es.symbol.description"),e("core-js/modules/es.symbol.iterator"),e("core-js/modules/es.array.index-of"),e("core-js/modules/es.array.iterator"),e("core-js/modules/es.array.slice"),e("core-js/modules/es.function.name"),e("core-js/modules/es.object.to-string"),e("core-js/modules/es.string.iterator"),e("core-js/modules/web.dom-collections.iterator"),Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n=(e=e("../core/main"))&&e.__esModule?e:{default:e};n.default.Shader=function(e,t,r){this._renderer=e,this._vertSrc=t,this._fragSrc=r,this._vertShader=-1,this._fragShader=-1,this._glProgram=0,this._loadedAttributes=!1,this.attributes={},this._loadedUniforms=!1,this.uniforms={},this._bound=!1,this.samplers=[]},n.default.Shader.prototype.init=function(){if(0===this._glProgram){var e=this._renderer.GL;if(this._vertShader=e.createShader(e.VERTEX_SHADER),e.shaderSource(this._vertShader,this._vertSrc),e.compileShader(this._vertShader),!e.getShaderParameter(this._vertShader,e.COMPILE_STATUS))return null;if(this._fragShader=e.createShader(e.FRAGMENT_SHADER),e.shaderSource(this._fragShader,this._fragSrc),e.compileShader(this._fragShader),!e.getShaderParameter(this._fragShader,e.COMPILE_STATUS))return null;this._glProgram=e.createProgram(),e.attachShader(this._glProgram,this._vertShader),e.attachShader(this._glProgram,this._fragShader),e.linkProgram(this._glProgram),e.getProgramParameter(this._glProgram,e.LINK_STATUS),this._loadAttributes(),this._loadUniforms()}return this},n.default.Shader.prototype._loadAttributes=function(){if(!this._loadedAttributes){this.attributes={};for(var e=this._renderer.GL,t=e.getProgramParameter(this._glProgram,e.ACTIVE_ATTRIBUTES),r=0;r<t;++r){var n=e.getActiveAttrib(this._glProgram,r),i=n.name,s=e.getAttribLocation(this._glProgram,i),o={};o.name=i,o.location=s,o.index=r,o.type=n.type,o.size=n.size,this.attributes[i]=o}this._loadedAttributes=!0}},n.default.Shader.prototype._loadUniforms=function(){if(!this._loadedUniforms){for(var e=this._renderer.GL,t=e.getProgramParameter(this._glProgram,e.ACTIVE_UNIFORMS),r=0,n=0;n<t;++n){var i=e.getActiveUniform(this._glProgram,n),s={},o=(s.location=e.getUniformLocation(this._glProgram,i.name),s.size=i.size,i.name);1<i.size&&(o=o.substring(0,o.indexOf("[0]"))),s.name=o,s.type=i.type,s._cachedData=void 0,s.type===e.SAMPLER_2D&&(s.samplerIndex=r,r++,this.samplers.push(s)),s.isArray=1<i.size||s.type===e.FLOAT_MAT3||s.type===e.FLOAT_MAT4||s.type===e.FLOAT_VEC2||s.type===e.FLOAT_VEC3||s.type===e.FLOAT_VEC4||s.type===e.INT_VEC2||s.type===e.INT_VEC4||s.type===e.INT_VEC3,this.uniforms[o]=s}this._loadedUniforms=!0}},n.default.Shader.prototype.compile=function(){},n.default.Shader.prototype.bindShader=function(){this.init(),this._bound||(this.useProgram(),this._bound=!0,this._setMatrixUniforms(),this.setUniform("uViewport",this._renderer._viewport))},n.default.Shader.prototype.unbindShader=function(){return this._bound&&(this.unbindTextures(),this._bound=!1),this},n.default.Shader.prototype.bindTextures=function(){var e=this._renderer.GL,t=!0,r=!1,n=void 0;try{for(var i,s=this.samplers[Symbol.iterator]();!(t=(i=s.next()).done);t=!0){var o=i.value,a=o.texture;void 0===a&&(a=this._renderer._getEmptyTexture()),e.activeTexture(e.TEXTURE0+o.samplerIndex),a.bindTexture(),a.update(),e.uniform1i(o.location,o.samplerIndex)}}catch(e){r=!0,n=e}finally{try{t||null==s.return||s.return()}finally{if(r)throw n}}},n.default.Shader.prototype.updateTextures=function(){var e=!0,t=!1,r=void 0;try{for(var n,i=this.samplers[Symbol.iterator]();!(e=(n=i.next()).done);e=!0){var s=n.value.texture;s&&s.update()}}catch(e){t=!0,r=e}finally{try{e||null==i.return||i.return()}finally{if(t)throw r}}},n.default.Shader.prototype.unbindTextures=function(){var e=!0,t=!1,r=void 0;try{for(var n,i=this.samplers[Symbol.iterator]();!(e=(n=i.next()).done);e=!0){var s=n.value;this.setUniform(s.name,this._renderer._getEmptyTexture())}}catch(e){t=!0,r=e}finally{try{e||null==i.return||i.return()}finally{if(t)throw r}}},n.default.Shader.prototype._setMatrixUniforms=function(){var e=this._renderer._curCamera.cameraMatrix,t=this._renderer.uPMatrix,r=this._renderer.uMVMatrix,n=r.copy();n.mult(t),this.isStrokeShader()&&("default"===this._renderer._curCamera.cameraType?this.setUniform("uPerspective",1):this.setUniform("uPerspective",0)),this.setUniform("uViewMatrix",e.mat4),this.setUniform("uProjectionMatrix",t.mat4),this.setUniform("uModelViewMatrix",r.mat4),this.setUniform("uModelViewProjectionMatrix",n.mat4),this.uniforms.uNormalMatrix&&(this._renderer.uNMatrix.inverseTranspose(this._renderer.uMVMatrix),this.setUniform("uNormalMatrix",this._renderer.uNMatrix.mat3))},n.default.Shader.prototype.useProgram=function(){var e=this._renderer.GL;return this._renderer._curShader!==this&&(e.useProgram(this._glProgram),this._renderer._curShader=this),this},n.default.Shader.prototype.setUniform=function(e,t){var r=this.uniforms[e];if(r){var i=this._renderer.GL;if(r.isArray){if(r._cachedData&&this._renderer._arraysEqual(r._cachedData,t))return;r._cachedData=t.slice(0)}else{if(r._cachedData&&r._cachedData===t)return;Array.isArray(t)?r._cachedData=t.slice(0):r._cachedData=t}var s=r.location;switch(this.useProgram(),r.type){case i.BOOL:!0===t?i.uniform1i(s,1):i.uniform1i(s,0);break;case i.INT:1<r.size?t.length&&i.uniform1iv(s,t):i.uniform1i(s,t);break;case i.FLOAT:1<r.size?t.length&&i.uniform1fv(s,t):i.uniform1f(s,t);break;case i.FLOAT_MAT3:i.uniformMatrix3fv(s,!1,t);break;case i.FLOAT_MAT4:i.uniformMatrix4fv(s,!1,t);break;case i.FLOAT_VEC2:1<r.size?t.length&&i.uniform2fv(s,t):i.uniform2f(s,t[0],t[1]);break;case i.FLOAT_VEC3:1<r.size?t.length&&i.uniform3fv(s,t):i.uniform3f(s,t[0],t[1],t[2]);break;case i.FLOAT_VEC4:1<r.size?t.length&&i.uniform4fv(s,t):i.uniform4f(s,t[0],t[1],t[2],t[3]);break;case i.INT_VEC2:1<r.size?t.length&&i.uniform2iv(s,t):i.uniform2i(s,t[0],t[1]);break;case i.INT_VEC3:1<r.size?t.length&&i.uniform3iv(s,t):i.uniform3i(s,t[0],t[1],t[2]);break;case i.INT_VEC4:1<r.size?t.length&&i.uniform4iv(s,t):i.uniform4i(s,t[0],t[1],t[2],t[3]);break;case i.SAMPLER_2D:i.activeTexture(i.TEXTURE0+r.samplerIndex),r.texture=t instanceof n.default.Texture?t:this._renderer.getTexture(t),i.uniform1i(s,r.samplerIndex),r.texture.src.gifProperties&&r.texture.src._animateGif(this._renderer._pInst)}return this}},n.default.Shader.prototype.isLightShader=function(){return void 0!==this.attributes.aNormal||void 0!==this.uniforms.uUseLighting||void 0!==this.uniforms.uAmbientLightCount||void 0!==this.uniforms.uDirectionalLightCount||void 0!==this.uniforms.uPointLightCount||void 0!==this.uniforms.uAmbientColor||void 0!==this.uniforms.uDirectionalDiffuseColors||void 0!==this.uniforms.uDirectionalSpecularColors||void 0!==this.uniforms.uPointLightLocation||void 0!==this.uniforms.uPointLightDiffuseColors||void 0!==this.uniforms.uPointLightSpecularColors||void 0!==this.uniforms.uLightingDirection||void 0!==this.uniforms.uSpecular},n.default.Shader.prototype.isNormalShader=function(){return void 0!==this.attributes.aNormal},n.default.Shader.prototype.isTextureShader=function(){return 0<this.samplers.length},n.default.Shader.prototype.isColorShader=function(){return void 0!==this.attributes.aVertexColor||void 0!==this.uniforms.uMaterialColor},n.default.Shader.prototype.isTexLightShader=function(){return this.isLightShader()&&this.isTextureShader()},n.default.Shader.prototype.isStrokeShader=function(){return void 0!==this.uniforms.uStrokeWeight},n.default.Shader.prototype.enableAttrib=function(e,t,r,n,i,s){var o;return e&&-1!==(e=e.location)&&(o=this._renderer.GL,this._renderer.registerEnabled[e]||(o.enableVertexAttribArray(e),this._renderer.registerEnabled[e]=!0),this._renderer.GL.vertexAttribPointer(e,t,r||o.FLOAT,n||!1,i||0,s||0)),this},e=n.default.Shader,r.default=e},{"../core/main":267,"core-js/modules/es.array.index-of":157,"core-js/modules/es.array.iterator":158,"core-js/modules/es.array.slice":162,"core-js/modules/es.function.name":165,"core-js/modules/es.object.to-string":177,"core-js/modules/es.string.iterator":186,"core-js/modules/es.symbol":196,"core-js/modules/es.symbol.description":194,"core-js/modules/es.symbol.iterator":195,"core-js/modules/web.dom-collections.iterator":230}],323:[function(e,t,r){"use strict";function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function i(e){return(i="function"==typeof Symbol&&"symbol"===n(Symbol.iterator)?function(e){return n(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":n(e)})(e)}e("core-js/modules/es.symbol"),e("core-js/modules/es.symbol.description"),e("core-js/modules/es.symbol.iterator"),e("core-js/modules/es.array.iterator"),e("core-js/modules/es.object.get-own-property-descriptor"),e("core-js/modules/es.object.to-string"),e("core-js/modules/es.string.iterator"),e("core-js/modules/es.typed-array.uint8-array"),e("core-js/modules/es.typed-array.copy-within"),e("core-js/modules/es.typed-array.every"),e("core-js/modules/es.typed-array.fill"),e("core-js/modules/es.typed-array.filter"),e("core-js/modules/es.typed-array.find"),e("core-js/modules/es.typed-array.find-index"),e("core-js/modules/es.typed-array.for-each"),e("core-js/modules/es.typed-array.includes"),e("core-js/modules/es.typed-array.index-of"),e("core-js/modules/es.typed-array.iterator"),e("core-js/modules/es.typed-array.join"),e("core-js/modules/es.typed-array.last-index-of"),e("core-js/modules/es.typed-array.map"),e("core-js/modules/es.typed-array.reduce"),e("core-js/modules/es.typed-array.reduce-right"),e("core-js/modules/es.typed-array.reverse"),e("core-js/modules/es.typed-array.set"),e("core-js/modules/es.typed-array.slice"),e("core-js/modules/es.typed-array.some"),e("core-js/modules/es.typed-array.sort"),e("core-js/modules/es.typed-array.subarray"),e("core-js/modules/es.typed-array.to-locale-string"),e("core-js/modules/es.typed-array.to-string"),e("core-js/modules/es.weak-map"),e("core-js/modules/web.dom-collections.iterator"),e("core-js/modules/es.array.iterator"),e("core-js/modules/es.object.to-string"),e("core-js/modules/es.typed-array.uint8-array"),e("core-js/modules/es.typed-array.copy-within"),e("core-js/modules/es.typed-array.every"),e("core-js/modules/es.typed-array.fill"),e("core-js/modules/es.typed-array.filter"),e("core-js/modules/es.typed-array.find"),e("core-js/modules/es.typed-array.find-index"),e("core-js/modules/es.typed-array.for-each"),e("core-js/modules/es.typed-array.includes"),e("core-js/modules/es.typed-array.index-of"),e("core-js/modules/es.typed-array.iterator"),e("core-js/modules/es.typed-array.join"),e("core-js/modules/es.typed-array.last-index-of"),e("core-js/modules/es.typed-array.map"),e("core-js/modules/es.typed-array.reduce"),e("core-js/modules/es.typed-array.reduce-right"),e("core-js/modules/es.typed-array.reverse"),e("core-js/modules/es.typed-array.set"),e("core-js/modules/es.typed-array.slice"),e("core-js/modules/es.typed-array.some"),e("core-js/modules/es.typed-array.sort"),e("core-js/modules/es.typed-array.subarray"),e("core-js/modules/es.typed-array.to-locale-string"),e("core-js/modules/es.typed-array.to-string"),Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var s=(l=e("../core/main"))&&l.__esModule?l:{default:l},o=function(e){if(e&&e.__esModule)return e;if(null===e||"object"!==i(e)&&"function"!=typeof e)return{default:e};var t=a();if(t&&t.has(e))return t.get(e);var r,n={},s=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(r in e){var o;Object.prototype.hasOwnProperty.call(e,r)&&((o=s?Object.getOwnPropertyDescriptor(e,r):null)&&(o.get||o.set)?Object.defineProperty(n,r,o):n[r]=e[r])}return n.default=e,t&&t.set(e,n),n}(e("../core/constants"));function a(){var e;return"function"!=typeof WeakMap?null:(e=new WeakMap,a=function(){return e},e)}s.default.Texture=function(e,t,r){return this._renderer=e,e=this._renderer.GL,(r=r||{}).dataType===e.FLOAT&&(e.getExtension("OES_texture_float"),e.getExtension("OES_texture_float_linear")),this.src=t,this.glTex=void 0,this.glTarget=e.TEXTURE_2D,this.glFormat=r.format||e.RGBA,this.mipmaps=!1,this.glMinFilter=r.minFilter||e.LINEAR,this.glMagFilter=r.magFilter||e.LINEAR,this.glWrapS=r.wrapS||e.CLAMP_TO_EDGE,this.glWrapT=r.wrapT||e.CLAMP_TO_EDGE,this.glDataType=r.dataType||e.UNSIGNED_BYTE,this.isSrcMediaElement=void 0!==s.default.MediaElement&&t instanceof s.default.MediaElement,this._videoPrevUpdateTime=0,this.isSrcHTMLElement=void 0!==s.default.Element&&t instanceof s.default.Element&&!(t instanceof s.default.Graphics)&&!(t instanceof s.default.Renderer),this.isSrcP5Image=t instanceof s.default.Image,this.isSrcP5Graphics=t instanceof s.default.Graphics,this.isSrcP5Renderer=t instanceof s.default.Renderer,this.isImageData="undefined"!=typeof ImageData&&t instanceof ImageData,r=this._getTextureDataFromSource(),this.width=r.width,this.height=r.height,this.init(r),this},s.default.Texture.prototype._getTextureDataFromSource=function(){var e;return this.isSrcP5Image?e=this.src.canvas:this.isSrcMediaElement||this.isSrcP5Graphics||this.isSrcP5Renderer||this.isSrcHTMLElement?e=this.src.elt:this.isImageData&&(e=this.src),e},s.default.Texture.prototype.init=function(e){var t,r=this._renderer.GL;this.glTex=r.createTexture(),this.glWrapS=this._renderer.textureWrapX,this.glWrapT=this._renderer.textureWrapY,this.setWrapMode(this.glWrapS,this.glWrapT),this.bindTexture(),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MAG_FILTER,this.glMagFilter),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MIN_FILTER,this.glMinFilter),0===this.width||0===this.height||this.isSrcMediaElement&&!this.src.loadedmetadata?(t=new Uint8Array([1,1,1,1]),r.texImage2D(this.glTarget,0,r.RGBA,1,1,0,this.glFormat,this.glDataType,t)):r.texImage2D(this.glTarget,0,this.glFormat,this.glFormat,this.glDataType,e)},s.default.Texture.prototype.update=function(){var e,t,r,n=this.src;return 0!==n.width&&0!==n.height&&(e=this._getTextureDataFromSource(),t=!1,r=this._renderer.GL,e.width!==this.width||e.height!==this.height?(t=!0,this.width=e.width,this.height=e.height,this.isSrcP5Image?n.setModified(!1):(this.isSrcMediaElement||this.isSrcHTMLElement)&&n.setModified(!0)):this.isSrcP5Image?n.isModified()&&n.setModified(!(t=!0)):this.isSrcMediaElement?n.isModified()?n.setModified(!(t=!0)):n.loadedmetadata&&this._videoPrevUpdateTime!==n.time()&&(this._videoPrevUpdateTime=n.time(),t=!0):this.isImageData?n._dirty&&(t=!(n._dirty=!1)):t=!0,t&&(this.bindTexture(),r.texImage2D(this.glTarget,0,this.glFormat,this.glFormat,this.glDataType,e)),t)},s.default.Texture.prototype.bindTexture=function(){return this._renderer.GL.bindTexture(this.glTarget,this.glTex),this},s.default.Texture.prototype.unbindTexture=function(){this._renderer.GL.bindTexture(this.glTarget,null)},s.default.Texture.prototype.setInterpolation=function(e,t){var r=this._renderer.GL;e===o.NEAREST?this.glMinFilter=r.NEAREST:this.glMinFilter=r.LINEAR,t===o.NEAREST?this.glMagFilter=r.NEAREST:this.glMagFilter=r.LINEAR,this.bindTexture(),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MIN_FILTER,this.glMinFilter),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MAG_FILTER,this.glMagFilter),this.unbindTexture()},s.default.Texture.prototype.setWrapMode=function(e,t){function r(e){return 0==(e&e-1)}var n=this._renderer.GL,i=(i=this._getTextureDataFromSource()).naturalWidth&&i.naturalHeight?(s=i.naturalWidth,i.naturalHeight):(s=this.width,this.height),s=r(s);i=r(i);e===o.REPEAT?this.glWrapS=s&&i?n.REPEAT:n.CLAMP_TO_EDGE:e===o.MIRROR?this.glWrapS=s&&i?n.MIRRORED_REPEAT:n.CLAMP_TO_EDGE:this.glWrapS=n.CLAMP_TO_EDGE,t===o.REPEAT?this.glWrapT=s&&i?n.REPEAT:n.CLAMP_TO_EDGE:t===o.MIRROR?this.glWrapT=s&&i?n.MIRRORED_REPEAT:n.CLAMP_TO_EDGE:this.glWrapT=n.CLAMP_TO_EDGE,this.bindTexture(),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_WRAP_S,this.glWrapS),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_WRAP_T,this.glWrapT),this.unbindTexture()};var l=s.default.Texture;r.default=l},{"../core/constants":256,"../core/main":267,"core-js/modules/es.array.iterator":158,"core-js/modules/es.object.get-own-property-descriptor":173,"core-js/modules/es.object.to-string":177,"core-js/modules/es.string.iterator":186,"core-js/modules/es.symbol":196,"core-js/modules/es.symbol.description":194,"core-js/modules/es.symbol.iterator":195,"core-js/modules/es.typed-array.copy-within":197,"core-js/modules/es.typed-array.every":198,"core-js/modules/es.typed-array.fill":199,"core-js/modules/es.typed-array.filter":200,"core-js/modules/es.typed-array.find":202,"core-js/modules/es.typed-array.find-index":201,"core-js/modules/es.typed-array.for-each":205,"core-js/modules/es.typed-array.includes":206,"core-js/modules/es.typed-array.index-of":207,"core-js/modules/es.typed-array.iterator":210,"core-js/modules/es.typed-array.join":211,"core-js/modules/es.typed-array.last-index-of":212,"core-js/modules/es.typed-array.map":213,"core-js/modules/es.typed-array.reduce":215,"core-js/modules/es.typed-array.reduce-right":214,"core-js/modules/es.typed-array.reverse":216,"core-js/modules/es.typed-array.set":217,"core-js/modules/es.typed-array.slice":218,"core-js/modules/es.typed-array.some":219,"core-js/modules/es.typed-array.sort":220,"core-js/modules/es.typed-array.subarray":221,"core-js/modules/es.typed-array.to-locale-string":222,"core-js/modules/es.typed-array.to-string":223,"core-js/modules/es.typed-array.uint8-array":226,"core-js/modules/es.weak-map":228,"core-js/modules/web.dom-collections.iterator":230}],324:[function(e,t,r){"use strict";function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function i(e){return(i="function"==typeof Symbol&&"symbol"===n(Symbol.iterator)?function(e){return n(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":n(e)})(e)}e("core-js/modules/es.symbol"),e("core-js/modules/es.symbol.description"),e("core-js/modules/es.symbol.iterator"),e("core-js/modules/es.array.iterator"),e("core-js/modules/es.object.get-own-property-descriptor"),e("core-js/modules/es.object.to-string"),e("core-js/modules/es.regexp.exec"),e("core-js/modules/es.string.iterator"),e("core-js/modules/es.string.split"),e("core-js/modules/es.string.sub"),e("core-js/modules/es.weak-map"),e("core-js/modules/web.dom-collections.iterator"),e("core-js/modules/es.symbol"),e("core-js/modules/es.symbol.description"),e("core-js/modules/es.symbol.iterator"),e("core-js/modules/es.array.iterator"),e("core-js/modules/es.object.to-string"),e("core-js/modules/es.regexp.exec"),e("core-js/modules/es.string.iterator"),e("core-js/modules/es.string.split"),e("core-js/modules/es.string.sub"),e("core-js/modules/web.dom-collections.iterator");var s,o=(s=e("../core/main"))&&s.__esModule?s:{default:s},a=function(e){if(e&&e.__esModule)return e;if(null===e||"object"!==i(e)&&"function"!=typeof e)return{default:e};var t=l();if(t&&t.has(e))return t.get(e);var r,n={},s=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(r in e){var o;Object.prototype.hasOwnProperty.call(e,r)&&((o=s?Object.getOwnPropertyDescriptor(e,r):null)&&(o.get||o.set)?Object.defineProperty(n,r,o):n[r]=e[r])}return n.default=e,t&&t.set(e,n),n}(e("../core/constants"));function l(){var e;return"function"!=typeof WeakMap?null:(e=new WeakMap,l=function(){return e},e)}function c(e,t){this.width=e,this.height=t,this.infos=[],this.findImage=function(e){var t,r,n=this.width*this.height;if(n<e)throw new Error("font is too complex to render in 3D");for(var i=this.infos.length-1;0<=i;--i){var s=this.infos[i];if(s.index+e<n){r=(t=s).imageData;break}}if(!t){try{r=new ImageData(this.width,this.height)}catch(e){var o=document.getElementsByTagName("canvas")[0],a=!o,l=(o||((o=document.createElement("canvas")).style.display="none",document.body.appendChild(o)),o.getContext("2d"));l&&(r=l.createImageData(this.width,this.height)),a&&document.body.removeChild(o)}this.infos.push(t={index:0,imageData:r})}return l=t.index,t.index+=e,r._dirty=!0,{imageData:r,index:l}}}function u(e,t,r,n,i){var s=e.imageData.data;e=4*e.index++;s[e++]=t,s[e++]=r,s[e++]=n,s[+e]=i}function h(e){this.font=e,this.strokeImageInfos=new c(64,64),this.colDimImageInfos=new c(64,64),this.rowDimImageInfos=new c(64,64),this.colCellImageInfos=new c(64,64),this.rowCellImageInfos=new c(64,64),this.glyphInfos={},this.getGlyphInfo=function(e){var t=this.glyphInfos[e.index];if(!t){var r=e.getBoundingBox(),n=r.x1,i=r.y1,s=r.x2-n,a=r.y2-i,l=e.path.commands;if(0==s||0==a||!l.length)return this.glyphInfos[e.index]={};for(var c,h,p,f,m=[],g=[],y=[],v=8;0<=v;--v)y.push([]);for(v=8;0<=v;--v)g.push([]);var _=!0,x=!1,b=void 0;try{for(var w,S=l[Symbol.iterator]();!(_=(w=S.next()).done);_=!0){var M=w.value,T=(M.x-n)/s,E=(M.y-i)/a;if(!z(c,h,T,E)){switch(M.type){case"M":p=T,f=E;break;case"L":B(c,h,T,E);break;case"Q":var A=(M.x1-n)/s,C=(M.y1-i)/a;U([c,T,A],[h,E,C],{x:c,y:h,cx:A,cy:C});break;case"Z":z(c,h,p,f)?m.push({x:c,y:h}):(B(c,h,p,f),m.push({x:p,y:f}));break;case"C":for(var L=function(e,t,r,n,i,s,a,l){e=new F(new o.default.Vector(e,t),new o.default.Vector(r,n),new o.default.Vector(i,s),new o.default.Vector(a,l)).splitInflections();var c=[],u=30/d,h=!0;t=!1,r=void 0;try{for(var p,f=e[Symbol.iterator]();!(h=(p=f.next()).done);h=!0){for(var m=p.value,g=[],y=void 0;!(.125<=(y=u/m.quadError()));){var v=Math.pow(y,1/3),_=m.split(v),x=m.split(1-v/(1-v));c.push(_),g.push(m),m=x}y<1&&c.push(m.split(.5)),c.push(m),Array.prototype.push.apply(c,g.reverse())}}catch(e){t=!0,r=e}finally{try{h||null==f.return||f.return()}finally{if(t)throw r}}return c}(c,h,(M.x1-n)/s,(M.y1-i)/a,(M.x2-n)/s,(M.y2-i)/a,T,E),R=0;R<L.length;R++){var P=L[R].toQuadratic();U([P.x,P.x1,P.cx],[P.y,P.y1,P.cy],P)}break;default:throw new Error("unknown command type: ".concat(M.type))}c=T,h=E}}}catch(e){x=!0,b=e}finally{try{_||null==S.return||S.return()}finally{if(x)throw b}}for(var j=m.length,I=this.strokeImageInfos.findImage(j),D=I.index,O=0;O<j;++O){var N=m[O];u(I,k(N.x),k(N.y),k(N.cx),k(N.cy))}(t=this.glyphInfos[e.index]={glyph:e,uGlyphRect:[r.x1,-r.y1,r.x2,-r.y2],strokeImageInfo:I,strokes:m,colInfo:G(y,this.colDimImageInfos,this.colCellImageInfos),rowInfo:G(g,this.rowDimImageInfos,this.rowCellImageInfos)}).uGridOffset=[t.colInfo.dimOffset,t.rowInfo.dimOffset]}return t;function U(e,t,r){var n=m.length;function i(e,t,r){for(var n=e.length;0<n--;){var i=e[n];i<t&&(t=i),r<i&&(r=i)}return{min:t,max:r}}m.push(r);r=i(e,1,0),e=Math.max(Math.floor(9*r.min-.5),0);for(var s=Math.min(Math.ceil(9*r.max+.5),9),o=e;o<s;++o)y[o].push(n);r=i(t,1,0),e=Math.max(Math.floor(9*r.min-.5),0);for(var a=Math.min(Math.ceil(9*r.max+.5),9),l=e;l<a;++l)g[l].push(n)}function k(e){return(e=255*e)<0?0:255<e?255:e}function F(e,t,r,n){this.p0=e,this.c0=t,this.c1=r,this.p1=n,this.toQuadratic=function(){return{x:this.p0.x,y:this.p0.y,x1:this.p1.x,y1:this.p1.y,cx:(3*(this.c0.x+this.c1.x)-(this.p0.x+this.p1.x))/4,cy:(3*(this.c0.y+this.c1.y)-(this.p0.y+this.p1.y))/4}},this.quadError=function(){return o.default.Vector.sub(o.default.Vector.sub(this.p1,this.p0),o.default.Vector.mult(o.default.Vector.sub(this.c1,this.c0),3)).mag()/2},this.split=function(e){var t=o.default.Vector.lerp(this.p0,this.c0,e),r=o.default.Vector.lerp(this.c0,this.c1,e),n=o.default.Vector.lerp(t,r,e);this.c1=o.default.Vector.lerp(this.c1,this.p1,e),this.c0=o.default.Vector.lerp(r,this.c1,e),r=o.default.Vector.lerp(n,this.c0,e),e=new F(this.p0,t,n,r);return this.p0=r,e},this.splitInflections=function(){var e=o.default.Vector.sub(this.c0,this.p0),t=o.default.Vector.sub(o.default.Vector.sub(this.c1,this.c0),e),r=o.default.Vector.sub(o.default.Vector.sub(o.default.Vector.sub(this.p1,this.c1),e),o.default.Vector.mult(t,2)),n=[],i=t.x*r.y-t.y*r.x;return 0!==i&&0<=(e=(r=e.x*r.y-e.y*r.x)*r-4*i*(e.x*t.y-e.y*t.x))&&(i<0&&(i=-i,r=-r),e=(-r+(t=Math.sqrt(e)))/(2*i),0<(r=(-r-t)/(2*i))&&r<1&&(n.push(this.split(r)),e=1-(1-e)/(1-r)),0<e&&e<1&&n.push(this.split(e))),n.push(this),n}}function B(e,t,r,n){U([e,r],[t,n],{x:e,y:t,cx:(e+r)/2,cy:(t+n)/2})}function z(e,t,r,n){return Math.abs(r-e)<1e-5&&Math.abs(n-t)<1e-5}function G(e,t,r){for(var n=e.length,i=t.findImage(n),s=(t=i.index,0),o=0;o<n;++o)s+=e[o].length;for(var a=r.findImage(s),l=0;l<n;++l){var c=e[l],h=c.length,d=a.index;u(i,d>>7,127&d,h>>7,127&h);for(var p=0;p<h;++p){var f=c[p]+D;u(a,f>>7,127&f,0,0)}}return{cellImageInfo:a,dimOffset:t,dimImageInfo:i}}}}e("./p5.Shader"),e("./p5.RendererGL.Retained"),o.default.RendererGL.prototype._applyTextProperties=function(){},o.default.RendererGL.prototype.textWidth=function(e){return this._isOpenType()?this._textFont._textWidth(e,this._textSize):0};var d=Math.sqrt(3);o.default.RendererGL.prototype._renderText=function(e,t,r,n,i){if(this._textFont&&"string"!=typeof this._textFont&&!(i<=n)&&this._doFill){if(this._isOpenType()){e.push();i=this._doStroke;var s=this.drawMode,l=(this._doStroke=!1,this.drawMode=a.TEXTURE,this._textFont.font),c=(c=this._textFont._fontInfo)||(this._textFont._fontInfo=new h(l)),u=(r=this._textFont._handleAlignment(this,t,r,n),n=this._textSize/l.unitsPerEm,this.translate(r.x,r.y,0),this.scale(n,n,1),this.GL),d=(r=!this._defaultFontShader,this._getFontShader()),p=(d.init(),d.bindShader(),r&&(d.setUniform("uGridImageSize",[64,64]),d.setUniform("uCellsImageSize",[64,64]),d.setUniform("uStrokeImageSize",[64,64]),d.setUniform("uGridSize",[9,9])),this._applyColorBlend(this.curFillColor),this.retainedMode.geometry.glyph),f=(p||((n=this._textGeom=new o.default.Geometry(1,1,(function(){for(var e=0;e<=1;e++)for(var t=0;t<=1;t++)this.vertices.push(new o.default.Vector(t,e,0)),this.uvs.push(t,e)}))).computeFaces().computeNormals(),p=this.createBuffers("glyph",n)),!0);r=!1,n=void 0;try{for(var m,g=this.retainedMode.buffers.text[Symbol.iterator]();!(f=(m=g.next()).done);f=!0)m.value._prepareBuffer(p,d)}catch(e){r=!0,n=e}finally{try{f||null==g.return||g.return()}finally{if(r)throw n}}this._bindBuffer(p.indexBuffer,u.ELEMENT_ARRAY_BUFFER),d.setUniform("uMaterialColor",this.curFillColor);try{var y=0,v=null,_=l.stringToGlyphs(t),x=!0,b=!1,w=void 0;try{for(var S,M=_[Symbol.iterator]();!(x=(S=M.next()).done);x=!0){var T,E,A=S.value,C=(v&&(y+=l.getKerningValue(v,A)),c.getGlyphInfo(A));C.uGlyphRect&&(T=C.rowInfo,E=C.colInfo,d.setUniform("uSamplerStrokes",C.strokeImageInfo.imageData),d.setUniform("uSamplerRowStrokes",T.cellImageInfo.imageData),d.setUniform("uSamplerRows",T.dimImageInfo.imageData),d.setUniform("uSamplerColStrokes",E.cellImageInfo.imageData),d.setUniform("uSamplerCols",E.dimImageInfo.imageData),d.setUniform("uGridOffset",C.uGridOffset),d.setUniform("uGlyphRect",C.uGlyphRect),d.setUniform("uGlyphOffset",y),d.bindTextures(),u.drawElements(u.TRIANGLES,6,this.GL.UNSIGNED_SHORT,0)),y+=A.advanceWidth,v=A}}catch(e){b=!0,w=e}finally{try{x||null==M.return||M.return()}finally{if(b)throw w}}}finally{d.unbindShader(),this._doStroke=i,this.drawMode=s,e.pop()}}return e}}},{"../core/constants":256,"../core/main":267,"./p5.RendererGL.Retained":320,"./p5.Shader":322,"core-js/modules/es.array.iterator":158,"core-js/modules/es.object.get-own-property-descriptor":173,"core-js/modules/es.object.to-string":177,"core-js/modules/es.regexp.exec":181,"core-js/modules/es.string.iterator":186,"core-js/modules/es.string.split":191,"core-js/modules/es.string.sub":192,"core-js/modules/es.symbol":196,"core-js/modules/es.symbol.description":194,"core-js/modules/es.symbol.iterator":195,"core-js/modules/es.weak-map":228,"core-js/modules/web.dom-collections.iterator":230}]},{},[251])(251)}))},5256:function(e,t,r){(function(){"use strict";var n=this.THREE||r(5232);if(!n)throw new Error("MeshLine requires three.js");class i extends n.BufferGeometry{constructor(){super(),this.isMeshLine=!0,this.type="MeshLine",this.positions=[],this.previous=[],this.next=[],this.side=[],this.width=[],this.indices_array=[],this.uvs=[],this.counters=[],this._points=[],this._geom=null,this.widthCallback=null,this.matrixWorld=new n.Matrix4,Object.defineProperties(this,{geometry:{enumerable:!0,get:function(){return this}},geom:{enumerable:!0,get:function(){return this._geom},set:function(e){this.setGeometry(e,this.widthCallback)}},points:{enumerable:!0,get:function(){return this._points},set:function(e){this.setPoints(e,this.widthCallback)}}})}}function s(e,t){var r=new n.Matrix4,i=new n.Ray,s=new n.Sphere,o=new n.Vector3,a=this.geometry;if(a.boundingSphere||a.computeBoundingSphere(),s.copy(a.boundingSphere),s.applyMatrix4(this.matrixWorld),!1!==e.ray.intersectSphere(s,o)){r.copy(this.matrixWorld).invert(),i.copy(e.ray).applyMatrix4(r);var l=new n.Vector3,c=new n.Vector3,u=new n.Vector3,h=this instanceof n.LineSegments?2:1,d=a.index,p=a.attributes;if(null!==d)for(var f=d.array,m=p.position.array,g=p.width.array,y=0,v=f.length-1;y<v;y+=h){var _=f[y],x=f[y+1];l.fromArray(m,3*_),c.fromArray(m,3*x);var b=void 0!==g[Math.floor(y/3)]?g[Math.floor(y/3)]:1,w=e.params.Line.threshold+this.material.lineWidth*b/2,S=w*w;if(!(i.distanceSqToSegment(l,c,o,u)>S)){o.applyMatrix4(this.matrixWorld);var M=e.ray.origin.distanceTo(o);M<e.near||M>e.far||(t.push({distance:M,point:u.clone().applyMatrix4(this.matrixWorld),index:y,face:null,faceIndex:null,object:this}),y=v)}}}}function o(e,t,r,n,i){var s;if(e=e.subarray||e.slice?e:e.buffer,r=r.subarray||r.slice?r:r.buffer,e=t?e.subarray?e.subarray(t,i&&t+i):e.slice(t,i&&t+i):e,r.set)r.set(e,n);else for(s=0;s<e.length;s++)r[s+n]=e[s];return r}i.prototype.setMatrixWorld=function(e){this.matrixWorld=e},i.prototype.setGeometry=function(e,t){this._geometry=e,this.setPoints(e.getAttribute("position").array,t)},i.prototype.setPoints=function(e,t){if(e instanceof Float32Array||e instanceof Array){if(this._points=e,this.widthCallback=t,this.positions=[],this.counters=[],e.length&&e[0]instanceof n.Vector3)for(var r=0;r<e.length;r++){var i=e[r],s=r/e.length;this.positions.push(i.x,i.y,i.z),this.positions.push(i.x,i.y,i.z),this.counters.push(s),this.counters.push(s)}else for(r=0;r<e.length;r+=3){s=r/e.length;this.positions.push(e[r],e[r+1],e[r+2]),this.positions.push(e[r],e[r+1],e[r+2]),this.counters.push(s),this.counters.push(s)}this.process()}},i.prototype.raycast=s,i.prototype.compareV3=function(e,t){var r=6*e,n=6*t;return this.positions[r]===this.positions[n]&&this.positions[r+1]===this.positions[n+1]&&this.positions[r+2]===this.positions[n+2]},i.prototype.copyV3=function(e){var t=6*e;return[this.positions[t],this.positions[t+1],this.positions[t+2]]},i.prototype.process=function(){var e,t,r=this.positions.length/6;this.previous=[],this.next=[],this.side=[],this.width=[],this.indices_array=[],this.uvs=[],t=this.compareV3(0,r-1)?this.copyV3(r-2):this.copyV3(0),this.previous.push(t[0],t[1],t[2]),this.previous.push(t[0],t[1],t[2]);for(var i=0;i<r;i++){if(this.side.push(1),this.side.push(-1),e=this.widthCallback?this.widthCallback(i/(r-1)):1,this.width.push(e),this.width.push(e),this.uvs.push(i/(r-1),0),this.uvs.push(i/(r-1),1),i<r-1){t=this.copyV3(i),this.previous.push(t[0],t[1],t[2]),this.previous.push(t[0],t[1],t[2]);var s=2*i;this.indices_array.push(s,s+1,s+2),this.indices_array.push(s+2,s+1,s+3)}i>0&&(t=this.copyV3(i),this.next.push(t[0],t[1],t[2]),this.next.push(t[0],t[1],t[2]))}t=this.compareV3(r-1,0)?this.copyV3(1):this.copyV3(r-1),this.next.push(t[0],t[1],t[2]),this.next.push(t[0],t[1],t[2]),this._attributes&&this._attributes.position.count===this.positions.length?(this._attributes.position.copyArray(new Float32Array(this.positions)),this._attributes.position.needsUpdate=!0,this._attributes.previous.copyArray(new Float32Array(this.previous)),this._attributes.previous.needsUpdate=!0,this._attributes.next.copyArray(new Float32Array(this.next)),this._attributes.next.needsUpdate=!0,this._attributes.side.copyArray(new Float32Array(this.side)),this._attributes.side.needsUpdate=!0,this._attributes.width.copyArray(new Float32Array(this.width)),this._attributes.width.needsUpdate=!0,this._attributes.uv.copyArray(new Float32Array(this.uvs)),this._attributes.uv.needsUpdate=!0,this._attributes.index.copyArray(new Uint16Array(this.indices_array)),this._attributes.index.needsUpdate=!0):this._attributes={position:new n.BufferAttribute(new Float32Array(this.positions),3),previous:new n.BufferAttribute(new Float32Array(this.previous),3),next:new n.BufferAttribute(new Float32Array(this.next),3),side:new n.BufferAttribute(new Float32Array(this.side),1),width:new n.BufferAttribute(new Float32Array(this.width),1),uv:new n.BufferAttribute(new Float32Array(this.uvs),2),index:new n.BufferAttribute(new Uint16Array(this.indices_array),1),counters:new n.BufferAttribute(new Float32Array(this.counters),1)},this.setAttribute("position",this._attributes.position),this.setAttribute("previous",this._attributes.previous),this.setAttribute("next",this._attributes.next),this.setAttribute("side",this._attributes.side),this.setAttribute("width",this._attributes.width),this.setAttribute("uv",this._attributes.uv),this.setAttribute("counters",this._attributes.counters),this.setIndex(this._attributes.index),this.computeBoundingSphere(),this.computeBoundingBox()},i.prototype.advance=function(e){var t=this._attributes.position.array,r=this._attributes.previous.array,n=this._attributes.next.array,i=t.length;o(t,0,r,0,i),o(t,6,t,0,i-6),t[i-6]=e.x,t[i-5]=e.y,t[i-4]=e.z,t[i-3]=e.x,t[i-2]=e.y,t[i-1]=e.z,o(t,6,n,0,i-6),n[i-6]=e.x,n[i-5]=e.y,n[i-4]=e.z,n[i-3]=e.x,n[i-2]=e.y,n[i-1]=e.z,this._attributes.position.needsUpdate=!0,this._attributes.previous.needsUpdate=!0,this._attributes.next.needsUpdate=!0},n.ShaderChunk.meshline_vert=["",n.ShaderChunk.logdepthbuf_pars_vertex,n.ShaderChunk.fog_pars_vertex,"","attribute vec3 previous;","attribute vec3 next;","attribute float side;","attribute float width;","attribute float counters;","","uniform vec2 resolution;","uniform float lineWidth;","uniform vec3 color;","uniform float opacity;","uniform float sizeAttenuation;","","varying vec2 vUV;","varying vec4 vColor;","varying float vCounters;","","vec2 fix( vec4 i, float aspect ) {","","    vec2 res = i.xy / i.w;","    res.x *= aspect;","\t vCounters = counters;","    return res;","","}","","void main() {","","    float aspect = resolution.x / resolution.y;","","    vColor = vec4( color, opacity );","    vUV = uv;","","    mat4 m = projectionMatrix * modelViewMatrix;","    vec4 finalPosition = m * vec4( position, 1.0 );","    vec4 prevPos = m * vec4( previous, 1.0 );","    vec4 nextPos = m * vec4( next, 1.0 );","","    vec2 currentP = fix( finalPosition, aspect );","    vec2 prevP = fix( prevPos, aspect );","    vec2 nextP = fix( nextPos, aspect );","","    float w = lineWidth * width;","","    vec2 dir;","    if( nextP == currentP ) dir = normalize( currentP - prevP );","    else if( prevP == currentP ) dir = normalize( nextP - currentP );","    else {","        vec2 dir1 = normalize( currentP - prevP );","        vec2 dir2 = normalize( nextP - currentP );","        dir = normalize( dir1 + dir2 );","","        vec2 perp = vec2( -dir1.y, dir1.x );","        vec2 miter = vec2( -dir.y, dir.x );","        //w = clamp( w / dot( miter, perp ), 0., 4. * lineWidth * width );","","    }","","    //vec2 normal = ( cross( vec3( dir, 0. ), vec3( 0., 0., 1. ) ) ).xy;","    vec4 normal = vec4( -dir.y, dir.x, 0., 1. );","    normal.xy *= .5 * w;","    normal *= projectionMatrix;","    if( sizeAttenuation == 0. ) {","        normal.xy *= finalPosition.w;","        normal.xy /= ( vec4( resolution, 0., 1. ) * projectionMatrix ).xy;","    }","","    finalPosition.xy += normal.xy * side;","","    gl_Position = finalPosition;","",n.ShaderChunk.logdepthbuf_vertex,n.ShaderChunk.fog_vertex&&"    vec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );",n.ShaderChunk.fog_vertex,"}"].join("\n"),n.ShaderChunk.meshline_frag=["",n.ShaderChunk.fog_pars_fragment,n.ShaderChunk.logdepthbuf_pars_fragment,"","uniform sampler2D map;","uniform sampler2D alphaMap;","uniform float useMap;","uniform float useAlphaMap;","uniform float useDash;","uniform float dashArray;","uniform float dashOffset;","uniform float dashRatio;","uniform float visibility;","uniform float alphaTest;","uniform vec2 repeat;","","varying vec2 vUV;","varying vec4 vColor;","varying float vCounters;","","void main() {","",n.ShaderChunk.logdepthbuf_fragment,"","    vec4 c = vColor;","    if( useMap == 1. ) c *= texture2D( map, vUV * repeat );","    if( useAlphaMap == 1. ) c.a *= texture2D( alphaMap, vUV * repeat ).a;","    if( c.a < alphaTest ) discard;","    if( useDash == 1. ){","        c.a *= ceil(mod(vCounters + dashOffset, dashArray) - (dashArray * dashRatio));","    }","    gl_FragColor = c;","    gl_FragColor.a *= step(vCounters, visibility);","",n.ShaderChunk.fog_fragment,"}"].join("\n");class a extends n.ShaderMaterial{constructor(e){super({uniforms:Object.assign({},n.UniformsLib.fog,{lineWidth:{value:1},map:{value:null},useMap:{value:0},alphaMap:{value:null},useAlphaMap:{value:0},color:{value:new n.Color(16777215)},opacity:{value:1},resolution:{value:new n.Vector2(1,1)},sizeAttenuation:{value:1},dashArray:{value:0},dashOffset:{value:0},dashRatio:{value:.5},useDash:{value:0},visibility:{value:1},alphaTest:{value:0},repeat:{value:new n.Vector2(1,1)}}),vertexShader:n.ShaderChunk.meshline_vert,fragmentShader:n.ShaderChunk.meshline_frag}),this.isMeshLineMaterial=!0,this.type="MeshLineMaterial",Object.defineProperties(this,{lineWidth:{enumerable:!0,get:function(){return this.uniforms.lineWidth.value},set:function(e){this.uniforms.lineWidth.value=e}},map:{enumerable:!0,get:function(){return this.uniforms.map.value},set:function(e){this.uniforms.map.value=e}},useMap:{enumerable:!0,get:function(){return this.uniforms.useMap.value},set:function(e){this.uniforms.useMap.value=e}},alphaMap:{enumerable:!0,get:function(){return this.uniforms.alphaMap.value},set:function(e){this.uniforms.alphaMap.value=e}},useAlphaMap:{enumerable:!0,get:function(){return this.uniforms.useAlphaMap.value},set:function(e){this.uniforms.useAlphaMap.value=e}},color:{enumerable:!0,get:function(){return this.uniforms.color.value},set:function(e){this.uniforms.color.value=e}},opacity:{enumerable:!0,get:function(){return this.uniforms.opacity.value},set:function(e){this.uniforms.opacity.value=e}},resolution:{enumerable:!0,get:function(){return this.uniforms.resolution.value},set:function(e){this.uniforms.resolution.value.copy(e)}},sizeAttenuation:{enumerable:!0,get:function(){return this.uniforms.sizeAttenuation.value},set:function(e){this.uniforms.sizeAttenuation.value=e}},dashArray:{enumerable:!0,get:function(){return this.uniforms.dashArray.value},set:function(e){this.uniforms.dashArray.value=e,this.useDash=0!==e?1:0}},dashOffset:{enumerable:!0,get:function(){return this.uniforms.dashOffset.value},set:function(e){this.uniforms.dashOffset.value=e}},dashRatio:{enumerable:!0,get:function(){return this.uniforms.dashRatio.value},set:function(e){this.uniforms.dashRatio.value=e}},useDash:{enumerable:!0,get:function(){return this.uniforms.useDash.value},set:function(e){this.uniforms.useDash.value=e}},visibility:{enumerable:!0,get:function(){return this.uniforms.visibility.value},set:function(e){this.uniforms.visibility.value=e}},alphaTest:{enumerable:!0,get:function(){return this.uniforms.alphaTest.value},set:function(e){this.uniforms.alphaTest.value=e}},repeat:{enumerable:!0,get:function(){return this.uniforms.repeat.value},set:function(e){this.uniforms.repeat.value.copy(e)}}}),this.setValues(e)}}a.prototype.copy=function(e){return n.ShaderMaterial.prototype.copy.call(this,e),this.lineWidth=e.lineWidth,this.map=e.map,this.useMap=e.useMap,this.alphaMap=e.alphaMap,this.useAlphaMap=e.useAlphaMap,this.color.copy(e.color),this.opacity=e.opacity,this.resolution.copy(e.resolution),this.sizeAttenuation=e.sizeAttenuation,this.dashArray.copy(e.dashArray),this.dashOffset.copy(e.dashOffset),this.dashRatio.copy(e.dashRatio),this.useDash=e.useDash,this.visibility=e.visibility,this.alphaTest=e.alphaTest,this.repeat.copy(e.repeat),this},e.exports&&(t=e.exports={MeshLine:i,MeshLineMaterial:a,MeshLineRaycast:s}),t.MeshLine=i,t.MeshLineMaterial=a,t.MeshLineRaycast=s}).call(this)},5232:(e,t)=>{"use strict";const r="150",n=0,i=1,s=2,o=1,a=2,l=3,c=0,u=1,h=2,d=0,p=1,f=2,m=3,g=4,y=5,v=100,_=101,x=102,b=103,w=104,S=200,M=201,T=202,E=203,A=204,C=205,L=206,R=207,P=208,j=209,I=210,D=0,O=1,N=2,U=3,k=4,F=5,B=6,z=7,G=0,V=1,H=2,W=0,X=1,q=2,Y=3,Z=4,J=5,K=300,Q=301,$=302,ee=303,te=304,re=306,ne=1e3,ie=1001,se=1002,oe=1003,ae=1004,le=1005,ce=1006,ue=1007,he=1008,de=1009,pe=1010,fe=1011,me=1012,ge=1013,ye=1014,ve=1015,_e=1016,xe=1017,be=1018,we=1020,Se=1021,Me=1023,Te=1024,Ee=1025,Ae=1026,Ce=1027,Le=1028,Re=1029,Pe=1030,je=1031,Ie=1033,De=33776,Oe=33777,Ne=33778,Ue=33779,ke=35840,Fe=35841,Be=35842,ze=35843,Ge=36196,Ve=37492,He=37496,We=37808,Xe=37809,qe=37810,Ye=37811,Ze=37812,Je=37813,Ke=37814,Qe=37815,$e=37816,et=37817,tt=37818,rt=37819,nt=37820,it=37821,st=36492,ot=36283,at=36284,lt=36285,ct=36286,ut=2300,ht=2301,dt=2302,pt=2400,ft=2401,mt=2402,gt=2500,yt=2501,vt=3e3,_t=3001,xt=3201,bt=0,wt=1,St="srgb",Mt="srgb-linear",Tt="display-p3",Et=7680,At=35044,Ct="300 es",Lt=1035;class Rt{addEventListener(e,t){void 0===this._listeners&&(this._listeners={});const r=this._listeners;void 0===r[e]&&(r[e]=[]),-1===r[e].indexOf(t)&&r[e].push(t)}hasEventListener(e,t){if(void 0===this._listeners)return!1;const r=this._listeners;return void 0!==r[e]&&-1!==r[e].indexOf(t)}removeEventListener(e,t){if(void 0===this._listeners)return;const r=this._listeners[e];if(void 0!==r){const e=r.indexOf(t);-1!==e&&r.splice(e,1)}}dispatchEvent(e){if(void 0===this._listeners)return;const t=this._listeners[e.type];if(void 0!==t){e.target=this;const r=t.slice(0);for(let t=0,n=r.length;t<n;t++)r[t].call(this,e);e.target=null}}}const Pt=["00","01","02","03","04","05","06","07","08","09","0a","0b","0c","0d","0e","0f","10","11","12","13","14","15","16","17","18","19","1a","1b","1c","1d","1e","1f","20","21","22","23","24","25","26","27","28","29","2a","2b","2c","2d","2e","2f","30","31","32","33","34","35","36","37","38","39","3a","3b","3c","3d","3e","3f","40","41","42","43","44","45","46","47","48","49","4a","4b","4c","4d","4e","4f","50","51","52","53","54","55","56","57","58","59","5a","5b","5c","5d","5e","5f","60","61","62","63","64","65","66","67","68","69","6a","6b","6c","6d","6e","6f","70","71","72","73","74","75","76","77","78","79","7a","7b","7c","7d","7e","7f","80","81","82","83","84","85","86","87","88","89","8a","8b","8c","8d","8e","8f","90","91","92","93","94","95","96","97","98","99","9a","9b","9c","9d","9e","9f","a0","a1","a2","a3","a4","a5","a6","a7","a8","a9","aa","ab","ac","ad","ae","af","b0","b1","b2","b3","b4","b5","b6","b7","b8","b9","ba","bb","bc","bd","be","bf","c0","c1","c2","c3","c4","c5","c6","c7","c8","c9","ca","cb","cc","cd","ce","cf","d0","d1","d2","d3","d4","d5","d6","d7","d8","d9","da","db","dc","dd","de","df","e0","e1","e2","e3","e4","e5","e6","e7","e8","e9","ea","eb","ec","ed","ee","ef","f0","f1","f2","f3","f4","f5","f6","f7","f8","f9","fa","fb","fc","fd","fe","ff"];let jt=1234567;const It=Math.PI/180,Dt=180/Math.PI;function Ot(){const e=4294967295*Math.random()|0,t=4294967295*Math.random()|0,r=4294967295*Math.random()|0,n=4294967295*Math.random()|0;return(Pt[255&e]+Pt[e>>8&255]+Pt[e>>16&255]+Pt[e>>24&255]+"-"+Pt[255&t]+Pt[t>>8&255]+"-"+Pt[t>>16&15|64]+Pt[t>>24&255]+"-"+Pt[63&r|128]+Pt[r>>8&255]+"-"+Pt[r>>16&255]+Pt[r>>24&255]+Pt[255&n]+Pt[n>>8&255]+Pt[n>>16&255]+Pt[n>>24&255]).toLowerCase()}function Nt(e,t,r){return Math.max(t,Math.min(r,e))}function Ut(e,t){return(e%t+t)%t}function kt(e,t,r){return(1-r)*e+r*t}function Ft(e){return 0==(e&e-1)&&0!==e}function Bt(e){return Math.pow(2,Math.ceil(Math.log(e)/Math.LN2))}function zt(e){return Math.pow(2,Math.floor(Math.log(e)/Math.LN2))}function Gt(e,t){switch(t.constructor){case Float32Array:return e;case Uint16Array:return e/65535;case Uint8Array:return e/255;case Int16Array:return Math.max(e/32767,-1);case Int8Array:return Math.max(e/127,-1);default:throw new Error("Invalid component type.")}}function Vt(e,t){switch(t.constructor){case Float32Array:return e;case Uint16Array:return Math.round(65535*e);case Uint8Array:return Math.round(255*e);case Int16Array:return Math.round(32767*e);case Int8Array:return Math.round(127*e);default:throw new Error("Invalid component type.")}}const Ht={DEG2RAD:It,RAD2DEG:Dt,generateUUID:Ot,clamp:Nt,euclideanModulo:Ut,mapLinear:function(e,t,r,n,i){return n+(e-t)*(i-n)/(r-t)},inverseLerp:function(e,t,r){return e!==t?(r-e)/(t-e):0},lerp:kt,damp:function(e,t,r,n){return kt(e,t,1-Math.exp(-r*n))},pingpong:function(e,t=1){return t-Math.abs(Ut(e,2*t)-t)},smoothstep:function(e,t,r){return e<=t?0:e>=r?1:(e=(e-t)/(r-t))*e*(3-2*e)},smootherstep:function(e,t,r){return e<=t?0:e>=r?1:(e=(e-t)/(r-t))*e*e*(e*(6*e-15)+10)},randInt:function(e,t){return e+Math.floor(Math.random()*(t-e+1))},randFloat:function(e,t){return e+Math.random()*(t-e)},randFloatSpread:function(e){return e*(.5-Math.random())},seededRandom:function(e){void 0!==e&&(jt=e);let t=jt+=1831565813;return t=Math.imul(t^t>>>15,1|t),t^=t+Math.imul(t^t>>>7,61|t),((t^t>>>14)>>>0)/4294967296},degToRad:function(e){return e*It},radToDeg:function(e){return e*Dt},isPowerOfTwo:Ft,ceilPowerOfTwo:Bt,floorPowerOfTwo:zt,setQuaternionFromProperEuler:function(e,t,r,n,i){const s=Math.cos,o=Math.sin,a=s(r/2),l=o(r/2),c=s((t+n)/2),u=o((t+n)/2),h=s((t-n)/2),d=o((t-n)/2),p=s((n-t)/2),f=o((n-t)/2);switch(i){case"XYX":e.set(a*u,l*h,l*d,a*c);break;case"YZY":e.set(l*d,a*u,l*h,a*c);break;case"ZXZ":e.set(l*h,l*d,a*u,a*c);break;case"XZX":e.set(a*u,l*f,l*p,a*c);break;case"YXY":e.set(l*p,a*u,l*f,a*c);break;case"ZYZ":e.set(l*f,l*p,a*u,a*c)}},normalize:Vt,denormalize:Gt};class Wt{constructor(e=0,t=0){Wt.prototype.isVector2=!0,this.x=e,this.y=t}get width(){return this.x}set width(e){this.x=e}get height(){return this.y}set height(e){this.y=e}set(e,t){return this.x=e,this.y=t,this}setScalar(e){return this.x=e,this.y=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y)}copy(e){return this.x=e.x,this.y=e.y,this}add(e){return this.x+=e.x,this.y+=e.y,this}addScalar(e){return this.x+=e,this.y+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this}subScalar(e){return this.x-=e,this.y-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this}multiply(e){return this.x*=e.x,this.y*=e.y,this}multiplyScalar(e){return this.x*=e,this.y*=e,this}divide(e){return this.x/=e.x,this.y/=e.y,this}divideScalar(e){return this.multiplyScalar(1/e)}applyMatrix3(e){const t=this.x,r=this.y,n=e.elements;return this.x=n[0]*t+n[3]*r+n[6],this.y=n[1]*t+n[4]*r+n[7],this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this}clampLength(e,t){const r=this.length();return this.divideScalar(r||1).multiplyScalar(Math.max(e,Math.min(t,r)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this}negate(){return this.x=-this.x,this.y=-this.y,this}dot(e){return this.x*e.x+this.y*e.y}cross(e){return this.x*e.y-this.y*e.x}lengthSq(){return this.x*this.x+this.y*this.y}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)}normalize(){return this.divideScalar(this.length()||1)}angle(){return Math.atan2(-this.y,-this.x)+Math.PI}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const t=this.x-e.x,r=this.y-e.y;return t*t+r*r}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this}lerpVectors(e,t,r){return this.x=e.x+(t.x-e.x)*r,this.y=e.y+(t.y-e.y)*r,this}equals(e){return e.x===this.x&&e.y===this.y}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this}rotateAround(e,t){const r=Math.cos(t),n=Math.sin(t),i=this.x-e.x,s=this.y-e.y;return this.x=i*r-s*n+e.x,this.y=i*n+s*r+e.y,this}random(){return this.x=Math.random(),this.y=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y}}class Xt{constructor(){Xt.prototype.isMatrix3=!0,this.elements=[1,0,0,0,1,0,0,0,1]}set(e,t,r,n,i,s,o,a,l){const c=this.elements;return c[0]=e,c[1]=n,c[2]=o,c[3]=t,c[4]=i,c[5]=a,c[6]=r,c[7]=s,c[8]=l,this}identity(){return this.set(1,0,0,0,1,0,0,0,1),this}copy(e){const t=this.elements,r=e.elements;return t[0]=r[0],t[1]=r[1],t[2]=r[2],t[3]=r[3],t[4]=r[4],t[5]=r[5],t[6]=r[6],t[7]=r[7],t[8]=r[8],this}extractBasis(e,t,r){return e.setFromMatrix3Column(this,0),t.setFromMatrix3Column(this,1),r.setFromMatrix3Column(this,2),this}setFromMatrix4(e){const t=e.elements;return this.set(t[0],t[4],t[8],t[1],t[5],t[9],t[2],t[6],t[10]),this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,t){const r=e.elements,n=t.elements,i=this.elements,s=r[0],o=r[3],a=r[6],l=r[1],c=r[4],u=r[7],h=r[2],d=r[5],p=r[8],f=n[0],m=n[3],g=n[6],y=n[1],v=n[4],_=n[7],x=n[2],b=n[5],w=n[8];return i[0]=s*f+o*y+a*x,i[3]=s*m+o*v+a*b,i[6]=s*g+o*_+a*w,i[1]=l*f+c*y+u*x,i[4]=l*m+c*v+u*b,i[7]=l*g+c*_+u*w,i[2]=h*f+d*y+p*x,i[5]=h*m+d*v+p*b,i[8]=h*g+d*_+p*w,this}multiplyScalar(e){const t=this.elements;return t[0]*=e,t[3]*=e,t[6]*=e,t[1]*=e,t[4]*=e,t[7]*=e,t[2]*=e,t[5]*=e,t[8]*=e,this}determinant(){const e=this.elements,t=e[0],r=e[1],n=e[2],i=e[3],s=e[4],o=e[5],a=e[6],l=e[7],c=e[8];return t*s*c-t*o*l-r*i*c+r*o*a+n*i*l-n*s*a}invert(){const e=this.elements,t=e[0],r=e[1],n=e[2],i=e[3],s=e[4],o=e[5],a=e[6],l=e[7],c=e[8],u=c*s-o*l,h=o*a-c*i,d=l*i-s*a,p=t*u+r*h+n*d;if(0===p)return this.set(0,0,0,0,0,0,0,0,0);const f=1/p;return e[0]=u*f,e[1]=(n*l-c*r)*f,e[2]=(o*r-n*s)*f,e[3]=h*f,e[4]=(c*t-n*a)*f,e[5]=(n*i-o*t)*f,e[6]=d*f,e[7]=(r*a-l*t)*f,e[8]=(s*t-r*i)*f,this}transpose(){let e;const t=this.elements;return e=t[1],t[1]=t[3],t[3]=e,e=t[2],t[2]=t[6],t[6]=e,e=t[5],t[5]=t[7],t[7]=e,this}getNormalMatrix(e){return this.setFromMatrix4(e).invert().transpose()}transposeIntoArray(e){const t=this.elements;return e[0]=t[0],e[1]=t[3],e[2]=t[6],e[3]=t[1],e[4]=t[4],e[5]=t[7],e[6]=t[2],e[7]=t[5],e[8]=t[8],this}setUvTransform(e,t,r,n,i,s,o){const a=Math.cos(i),l=Math.sin(i);return this.set(r*a,r*l,-r*(a*s+l*o)+s+e,-n*l,n*a,-n*(-l*s+a*o)+o+t,0,0,1),this}scale(e,t){return this.premultiply(qt.makeScale(e,t)),this}rotate(e){return this.premultiply(qt.makeRotation(-e)),this}translate(e,t){return this.premultiply(qt.makeTranslation(e,t)),this}makeTranslation(e,t){return this.set(1,0,e,0,1,t,0,0,1),this}makeRotation(e){const t=Math.cos(e),r=Math.sin(e);return this.set(t,-r,0,r,t,0,0,0,1),this}makeScale(e,t){return this.set(e,0,0,0,t,0,0,0,1),this}equals(e){const t=this.elements,r=e.elements;for(let e=0;e<9;e++)if(t[e]!==r[e])return!1;return!0}fromArray(e,t=0){for(let r=0;r<9;r++)this.elements[r]=e[r+t];return this}toArray(e=[],t=0){const r=this.elements;return e[t]=r[0],e[t+1]=r[1],e[t+2]=r[2],e[t+3]=r[3],e[t+4]=r[4],e[t+5]=r[5],e[t+6]=r[6],e[t+7]=r[7],e[t+8]=r[8],e}clone(){return(new this.constructor).fromArray(this.elements)}}const qt=new Xt;function Yt(e){for(let t=e.length-1;t>=0;--t)if(e[t]>=65535)return!0;return!1}const Zt={Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array};function Jt(e,t){return new Zt[e](t)}function Kt(e){return document.createElementNS("http://www.w3.org/1999/xhtml",e)}class Qt{constructor(e=0,t=0,r=0,n=1){this.isQuaternion=!0,this._x=e,this._y=t,this._z=r,this._w=n}static slerpFlat(e,t,r,n,i,s,o){let a=r[n+0],l=r[n+1],c=r[n+2],u=r[n+3];const h=i[s+0],d=i[s+1],p=i[s+2],f=i[s+3];if(0===o)return e[t+0]=a,e[t+1]=l,e[t+2]=c,void(e[t+3]=u);if(1===o)return e[t+0]=h,e[t+1]=d,e[t+2]=p,void(e[t+3]=f);if(u!==f||a!==h||l!==d||c!==p){let e=1-o;const t=a*h+l*d+c*p+u*f,r=t>=0?1:-1,n=1-t*t;if(n>Number.EPSILON){const i=Math.sqrt(n),s=Math.atan2(i,t*r);e=Math.sin(e*s)/i,o=Math.sin(o*s)/i}const i=o*r;if(a=a*e+h*i,l=l*e+d*i,c=c*e+p*i,u=u*e+f*i,e===1-o){const e=1/Math.sqrt(a*a+l*l+c*c+u*u);a*=e,l*=e,c*=e,u*=e}}e[t]=a,e[t+1]=l,e[t+2]=c,e[t+3]=u}static multiplyQuaternionsFlat(e,t,r,n,i,s){const o=r[n],a=r[n+1],l=r[n+2],c=r[n+3],u=i[s],h=i[s+1],d=i[s+2],p=i[s+3];return e[t]=o*p+c*u+a*d-l*h,e[t+1]=a*p+c*h+l*u-o*d,e[t+2]=l*p+c*d+o*h-a*u,e[t+3]=c*p-o*u-a*h-l*d,e}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get w(){return this._w}set w(e){this._w=e,this._onChangeCallback()}set(e,t,r,n){return this._x=e,this._y=t,this._z=r,this._w=n,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._w)}copy(e){return this._x=e.x,this._y=e.y,this._z=e.z,this._w=e.w,this._onChangeCallback(),this}setFromEuler(e,t){const r=e._x,n=e._y,i=e._z,s=e._order,o=Math.cos,a=Math.sin,l=o(r/2),c=o(n/2),u=o(i/2),h=a(r/2),d=a(n/2),p=a(i/2);switch(s){case"XYZ":this._x=h*c*u+l*d*p,this._y=l*d*u-h*c*p,this._z=l*c*p+h*d*u,this._w=l*c*u-h*d*p;break;case"YXZ":this._x=h*c*u+l*d*p,this._y=l*d*u-h*c*p,this._z=l*c*p-h*d*u,this._w=l*c*u+h*d*p;break;case"ZXY":this._x=h*c*u-l*d*p,this._y=l*d*u+h*c*p,this._z=l*c*p+h*d*u,this._w=l*c*u-h*d*p;break;case"ZYX":this._x=h*c*u-l*d*p,this._y=l*d*u+h*c*p,this._z=l*c*p-h*d*u,this._w=l*c*u+h*d*p;break;case"YZX":this._x=h*c*u+l*d*p,this._y=l*d*u+h*c*p,this._z=l*c*p-h*d*u,this._w=l*c*u-h*d*p;break;case"XZY":this._x=h*c*u-l*d*p,this._y=l*d*u-h*c*p,this._z=l*c*p+h*d*u,this._w=l*c*u+h*d*p}return!1!==t&&this._onChangeCallback(),this}setFromAxisAngle(e,t){const r=t/2,n=Math.sin(r);return this._x=e.x*n,this._y=e.y*n,this._z=e.z*n,this._w=Math.cos(r),this._onChangeCallback(),this}setFromRotationMatrix(e){const t=e.elements,r=t[0],n=t[4],i=t[8],s=t[1],o=t[5],a=t[9],l=t[2],c=t[6],u=t[10],h=r+o+u;if(h>0){const e=.5/Math.sqrt(h+1);this._w=.25/e,this._x=(c-a)*e,this._y=(i-l)*e,this._z=(s-n)*e}else if(r>o&&r>u){const e=2*Math.sqrt(1+r-o-u);this._w=(c-a)/e,this._x=.25*e,this._y=(n+s)/e,this._z=(i+l)/e}else if(o>u){const e=2*Math.sqrt(1+o-r-u);this._w=(i-l)/e,this._x=(n+s)/e,this._y=.25*e,this._z=(a+c)/e}else{const e=2*Math.sqrt(1+u-r-o);this._w=(s-n)/e,this._x=(i+l)/e,this._y=(a+c)/e,this._z=.25*e}return this._onChangeCallback(),this}setFromUnitVectors(e,t){let r=e.dot(t)+1;return r<Number.EPSILON?(r=0,Math.abs(e.x)>Math.abs(e.z)?(this._x=-e.y,this._y=e.x,this._z=0,this._w=r):(this._x=0,this._y=-e.z,this._z=e.y,this._w=r)):(this._x=e.y*t.z-e.z*t.y,this._y=e.z*t.x-e.x*t.z,this._z=e.x*t.y-e.y*t.x,this._w=r),this.normalize()}angleTo(e){return 2*Math.acos(Math.abs(Nt(this.dot(e),-1,1)))}rotateTowards(e,t){const r=this.angleTo(e);if(0===r)return this;const n=Math.min(1,t/r);return this.slerp(e,n),this}identity(){return this.set(0,0,0,1)}invert(){return this.conjugate()}conjugate(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this}dot(e){return this._x*e._x+this._y*e._y+this._z*e._z+this._w*e._w}lengthSq(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w}length(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)}normalize(){let e=this.length();return 0===e?(this._x=0,this._y=0,this._z=0,this._w=1):(e=1/e,this._x=this._x*e,this._y=this._y*e,this._z=this._z*e,this._w=this._w*e),this._onChangeCallback(),this}multiply(e){return this.multiplyQuaternions(this,e)}premultiply(e){return this.multiplyQuaternions(e,this)}multiplyQuaternions(e,t){const r=e._x,n=e._y,i=e._z,s=e._w,o=t._x,a=t._y,l=t._z,c=t._w;return this._x=r*c+s*o+n*l-i*a,this._y=n*c+s*a+i*o-r*l,this._z=i*c+s*l+r*a-n*o,this._w=s*c-r*o-n*a-i*l,this._onChangeCallback(),this}slerp(e,t){if(0===t)return this;if(1===t)return this.copy(e);const r=this._x,n=this._y,i=this._z,s=this._w;let o=s*e._w+r*e._x+n*e._y+i*e._z;if(o<0?(this._w=-e._w,this._x=-e._x,this._y=-e._y,this._z=-e._z,o=-o):this.copy(e),o>=1)return this._w=s,this._x=r,this._y=n,this._z=i,this;const a=1-o*o;if(a<=Number.EPSILON){const e=1-t;return this._w=e*s+t*this._w,this._x=e*r+t*this._x,this._y=e*n+t*this._y,this._z=e*i+t*this._z,this.normalize(),this._onChangeCallback(),this}const l=Math.sqrt(a),c=Math.atan2(l,o),u=Math.sin((1-t)*c)/l,h=Math.sin(t*c)/l;return this._w=s*u+this._w*h,this._x=r*u+this._x*h,this._y=n*u+this._y*h,this._z=i*u+this._z*h,this._onChangeCallback(),this}slerpQuaternions(e,t,r){return this.copy(e).slerp(t,r)}random(){const e=Math.random(),t=Math.sqrt(1-e),r=Math.sqrt(e),n=2*Math.PI*Math.random(),i=2*Math.PI*Math.random();return this.set(t*Math.cos(n),r*Math.sin(i),r*Math.cos(i),t*Math.sin(n))}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._w===this._w}fromArray(e,t=0){return this._x=e[t],this._y=e[t+1],this._z=e[t+2],this._w=e[t+3],this._onChangeCallback(),this}toArray(e=[],t=0){return e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._w,e}fromBufferAttribute(e,t){return this._x=e.getX(t),this._y=e.getY(t),this._z=e.getZ(t),this._w=e.getW(t),this}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._w}}class $t{constructor(e=0,t=0,r=0){$t.prototype.isVector3=!0,this.x=e,this.y=t,this.z=r}set(e,t,r){return void 0===r&&(r=this.z),this.x=e,this.y=t,this.z=r,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this}multiplyVectors(e,t){return this.x=e.x*t.x,this.y=e.y*t.y,this.z=e.z*t.z,this}applyEuler(e){return this.applyQuaternion(tr.setFromEuler(e))}applyAxisAngle(e,t){return this.applyQuaternion(tr.setFromAxisAngle(e,t))}applyMatrix3(e){const t=this.x,r=this.y,n=this.z,i=e.elements;return this.x=i[0]*t+i[3]*r+i[6]*n,this.y=i[1]*t+i[4]*r+i[7]*n,this.z=i[2]*t+i[5]*r+i[8]*n,this}applyNormalMatrix(e){return this.applyMatrix3(e).normalize()}applyMatrix4(e){const t=this.x,r=this.y,n=this.z,i=e.elements,s=1/(i[3]*t+i[7]*r+i[11]*n+i[15]);return this.x=(i[0]*t+i[4]*r+i[8]*n+i[12])*s,this.y=(i[1]*t+i[5]*r+i[9]*n+i[13])*s,this.z=(i[2]*t+i[6]*r+i[10]*n+i[14])*s,this}applyQuaternion(e){const t=this.x,r=this.y,n=this.z,i=e.x,s=e.y,o=e.z,a=e.w,l=a*t+s*n-o*r,c=a*r+o*t-i*n,u=a*n+i*r-s*t,h=-i*t-s*r-o*n;return this.x=l*a+h*-i+c*-o-u*-s,this.y=c*a+h*-s+u*-i-l*-o,this.z=u*a+h*-o+l*-s-c*-i,this}project(e){return this.applyMatrix4(e.matrixWorldInverse).applyMatrix4(e.projectionMatrix)}unproject(e){return this.applyMatrix4(e.projectionMatrixInverse).applyMatrix4(e.matrixWorld)}transformDirection(e){const t=this.x,r=this.y,n=this.z,i=e.elements;return this.x=i[0]*t+i[4]*r+i[8]*n,this.y=i[1]*t+i[5]*r+i[9]*n,this.z=i[2]*t+i[6]*r+i[10]*n,this.normalize()}divide(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this}divideScalar(e){return this.multiplyScalar(1/e)}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this.z=Math.max(e.z,Math.min(t.z,this.z)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this.z=Math.max(e,Math.min(t,this.z)),this}clampLength(e,t){const r=this.length();return this.divideScalar(r||1).multiplyScalar(Math.max(e,Math.min(t,r)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this}lerpVectors(e,t,r){return this.x=e.x+(t.x-e.x)*r,this.y=e.y+(t.y-e.y)*r,this.z=e.z+(t.z-e.z)*r,this}cross(e){return this.crossVectors(this,e)}crossVectors(e,t){const r=e.x,n=e.y,i=e.z,s=t.x,o=t.y,a=t.z;return this.x=n*a-i*o,this.y=i*s-r*a,this.z=r*o-n*s,this}projectOnVector(e){const t=e.lengthSq();if(0===t)return this.set(0,0,0);const r=e.dot(this)/t;return this.copy(e).multiplyScalar(r)}projectOnPlane(e){return er.copy(this).projectOnVector(e),this.sub(er)}reflect(e){return this.sub(er.copy(e).multiplyScalar(2*this.dot(e)))}angleTo(e){const t=Math.sqrt(this.lengthSq()*e.lengthSq());if(0===t)return Math.PI/2;const r=this.dot(e)/t;return Math.acos(Nt(r,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const t=this.x-e.x,r=this.y-e.y,n=this.z-e.z;return t*t+r*r+n*n}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)+Math.abs(this.z-e.z)}setFromSpherical(e){return this.setFromSphericalCoords(e.radius,e.phi,e.theta)}setFromSphericalCoords(e,t,r){const n=Math.sin(t)*e;return this.x=n*Math.sin(r),this.y=Math.cos(t)*e,this.z=n*Math.cos(r),this}setFromCylindrical(e){return this.setFromCylindricalCoords(e.radius,e.theta,e.y)}setFromCylindricalCoords(e,t,r){return this.x=e*Math.sin(t),this.y=r,this.z=e*Math.cos(t),this}setFromMatrixPosition(e){const t=e.elements;return this.x=t[12],this.y=t[13],this.z=t[14],this}setFromMatrixScale(e){const t=this.setFromMatrixColumn(e,0).length(),r=this.setFromMatrixColumn(e,1).length(),n=this.setFromMatrixColumn(e,2).length();return this.x=t,this.y=r,this.z=n,this}setFromMatrixColumn(e,t){return this.fromArray(e.elements,4*t)}setFromMatrix3Column(e,t){return this.fromArray(e.elements,3*t)}setFromEuler(e){return this.x=e._x,this.y=e._y,this.z=e._z,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this.z=e[t+2],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this}randomDirection(){const e=2*(Math.random()-.5),t=Math.random()*Math.PI*2,r=Math.sqrt(1-e**2);return this.x=r*Math.cos(t),this.y=r*Math.sin(t),this.z=e,this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z}}const er=new $t,tr=new Qt;function rr(e){return e<.04045?.0773993808*e:Math.pow(.9478672986*e+.0521327014,2.4)}function nr(e){return e<.0031308?12.92*e:1.055*Math.pow(e,.41666)-.055}const ir=(new Xt).fromArray([.8224621,.0331941,.0170827,.177538,.9668058,.0723974,-1e-7,1e-7,.9105199]),sr=(new Xt).fromArray([1.2249401,-.0420569,-.0196376,-.2249404,1.0420571,-.0786361,1e-7,0,1.0982735]),or=new $t;const ar={[Mt]:e=>e,[St]:e=>e.convertSRGBToLinear(),[Tt]:function(e){return e.convertSRGBToLinear(),or.set(e.r,e.g,e.b).applyMatrix3(sr),e.setRGB(or.x,or.y,or.z)}},lr={[Mt]:e=>e,[St]:e=>e.convertLinearToSRGB(),[Tt]:function(e){return or.set(e.r,e.g,e.b).applyMatrix3(ir),e.setRGB(or.x,or.y,or.z).convertLinearToSRGB()}},cr={enabled:!1,get legacyMode(){return!this.enabled},set legacyMode(e){this.enabled=!e},get workingColorSpace(){return Mt},set workingColorSpace(e){},convert:function(e,t,r){if(!1===this.enabled||t===r||!t||!r)return e;const n=ar[t],i=lr[r];if(void 0===n||void 0===i)throw new Error(`Unsupported color space conversion, "${t}" to "${r}".`);return i(n(e))},fromWorkingColorSpace:function(e,t){return this.convert(e,this.workingColorSpace,t)},toWorkingColorSpace:function(e,t){return this.convert(e,t,this.workingColorSpace)}};let ur;class hr{static getDataURL(e){if(/^data:/i.test(e.src))return e.src;if("undefined"==typeof HTMLCanvasElement)return e.src;let t;if(e instanceof HTMLCanvasElement)t=e;else{void 0===ur&&(ur=Kt("canvas")),ur.width=e.width,ur.height=e.height;const r=ur.getContext("2d");e instanceof ImageData?r.putImageData(e,0,0):r.drawImage(e,0,0,e.width,e.height),t=ur}return t.width>2048||t.height>2048?t.toDataURL("image/jpeg",.6):t.toDataURL("image/png")}static sRGBToLinear(e){if("undefined"!=typeof HTMLImageElement&&e instanceof HTMLImageElement||"undefined"!=typeof HTMLCanvasElement&&e instanceof HTMLCanvasElement||"undefined"!=typeof ImageBitmap&&e instanceof ImageBitmap){const t=Kt("canvas");t.width=e.width,t.height=e.height;const r=t.getContext("2d");r.drawImage(e,0,0,e.width,e.height);const n=r.getImageData(0,0,e.width,e.height),i=n.data;for(let e=0;e<i.length;e++)i[e]=255*rr(i[e]/255);return r.putImageData(n,0,0),t}if(e.data){const t=e.data.slice(0);for(let e=0;e<t.length;e++)t instanceof Uint8Array||t instanceof Uint8ClampedArray?t[e]=Math.floor(255*rr(t[e]/255)):t[e]=rr(t[e]);return{data:t,width:e.width,height:e.height}}return e}}class dr{constructor(e=null){this.isSource=!0,this.uuid=Ot(),this.data=e,this.version=0}set needsUpdate(e){!0===e&&this.version++}toJSON(e){const t=void 0===e||"string"==typeof e;if(!t&&void 0!==e.images[this.uuid])return e.images[this.uuid];const r={uuid:this.uuid,url:""},n=this.data;if(null!==n){let e;if(Array.isArray(n)){e=[];for(let t=0,r=n.length;t<r;t++)n[t].isDataTexture?e.push(pr(n[t].image)):e.push(pr(n[t]))}else e=pr(n);r.url=e}return t||(e.images[this.uuid]=r),r}}function pr(e){return"undefined"!=typeof HTMLImageElement&&e instanceof HTMLImageElement||"undefined"!=typeof HTMLCanvasElement&&e instanceof HTMLCanvasElement||"undefined"!=typeof ImageBitmap&&e instanceof ImageBitmap?hr.getDataURL(e):e.data?{data:Array.from(e.data),width:e.width,height:e.height,type:e.data.constructor.name}:{}}let fr=0;class mr extends Rt{constructor(e=mr.DEFAULT_IMAGE,t=mr.DEFAULT_MAPPING,r=ie,n=ie,i=ce,s=he,o=Me,a=de,l=mr.DEFAULT_ANISOTROPY,c=vt){super(),this.isTexture=!0,Object.defineProperty(this,"id",{value:fr++}),this.uuid=Ot(),this.name="",this.source=new dr(e),this.mipmaps=[],this.mapping=t,this.wrapS=r,this.wrapT=n,this.magFilter=i,this.minFilter=s,this.anisotropy=l,this.format=o,this.internalFormat=null,this.type=a,this.offset=new Wt(0,0),this.repeat=new Wt(1,1),this.center=new Wt(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new Xt,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,this.encoding=c,this.userData={},this.version=0,this.onUpdate=null,this.isRenderTargetTexture=!1,this.needsPMREMUpdate=!1}get image(){return this.source.data}set image(e=null){this.source.data=e}updateMatrix(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)}clone(){return(new this.constructor).copy(this)}copy(e){return this.name=e.name,this.source=e.source,this.mipmaps=e.mipmaps.slice(0),this.mapping=e.mapping,this.wrapS=e.wrapS,this.wrapT=e.wrapT,this.magFilter=e.magFilter,this.minFilter=e.minFilter,this.anisotropy=e.anisotropy,this.format=e.format,this.internalFormat=e.internalFormat,this.type=e.type,this.offset.copy(e.offset),this.repeat.copy(e.repeat),this.center.copy(e.center),this.rotation=e.rotation,this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrix.copy(e.matrix),this.generateMipmaps=e.generateMipmaps,this.premultiplyAlpha=e.premultiplyAlpha,this.flipY=e.flipY,this.unpackAlignment=e.unpackAlignment,this.encoding=e.encoding,this.userData=JSON.parse(JSON.stringify(e.userData)),this.needsUpdate=!0,this}toJSON(e){const t=void 0===e||"string"==typeof e;if(!t&&void 0!==e.textures[this.uuid])return e.textures[this.uuid];const r={metadata:{version:4.5,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,image:this.source.toJSON(e).uuid,mapping:this.mapping,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,internalFormat:this.internalFormat,type:this.type,encoding:this.encoding,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,generateMipmaps:this.generateMipmaps,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};return Object.keys(this.userData).length>0&&(r.userData=this.userData),t||(e.textures[this.uuid]=r),r}dispose(){this.dispatchEvent({type:"dispose"})}transformUv(e){if(this.mapping!==K)return e;if(e.applyMatrix3(this.matrix),e.x<0||e.x>1)switch(this.wrapS){case ne:e.x=e.x-Math.floor(e.x);break;case ie:e.x=e.x<0?0:1;break;case se:1===Math.abs(Math.floor(e.x)%2)?e.x=Math.ceil(e.x)-e.x:e.x=e.x-Math.floor(e.x)}if(e.y<0||e.y>1)switch(this.wrapT){case ne:e.y=e.y-Math.floor(e.y);break;case ie:e.y=e.y<0?0:1;break;case se:1===Math.abs(Math.floor(e.y)%2)?e.y=Math.ceil(e.y)-e.y:e.y=e.y-Math.floor(e.y)}return this.flipY&&(e.y=1-e.y),e}set needsUpdate(e){!0===e&&(this.version++,this.source.needsUpdate=!0)}}mr.DEFAULT_IMAGE=null,mr.DEFAULT_MAPPING=K,mr.DEFAULT_ANISOTROPY=1;class gr{constructor(e=0,t=0,r=0,n=1){gr.prototype.isVector4=!0,this.x=e,this.y=t,this.z=r,this.w=n}get width(){return this.z}set width(e){this.z=e}get height(){return this.w}set height(e){this.w=e}set(e,t,r,n){return this.x=e,this.y=t,this.z=r,this.w=n,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this.w=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setW(e){return this.w=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;case 3:this.w=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z,this.w)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this.w=void 0!==e.w?e.w:1,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this.w+=e.w,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this.w+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this.w=e.w+t.w,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this.w+=e.w*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this.w-=e.w,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this.w-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this.w=e.w-t.w,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this.w*=e.w,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this.w*=e,this}applyMatrix4(e){const t=this.x,r=this.y,n=this.z,i=this.w,s=e.elements;return this.x=s[0]*t+s[4]*r+s[8]*n+s[12]*i,this.y=s[1]*t+s[5]*r+s[9]*n+s[13]*i,this.z=s[2]*t+s[6]*r+s[10]*n+s[14]*i,this.w=s[3]*t+s[7]*r+s[11]*n+s[15]*i,this}divideScalar(e){return this.multiplyScalar(1/e)}setAxisAngleFromQuaternion(e){this.w=2*Math.acos(e.w);const t=Math.sqrt(1-e.w*e.w);return t<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=e.x/t,this.y=e.y/t,this.z=e.z/t),this}setAxisAngleFromRotationMatrix(e){let t,r,n,i;const s=.01,o=.1,a=e.elements,l=a[0],c=a[4],u=a[8],h=a[1],d=a[5],p=a[9],f=a[2],m=a[6],g=a[10];if(Math.abs(c-h)<s&&Math.abs(u-f)<s&&Math.abs(p-m)<s){if(Math.abs(c+h)<o&&Math.abs(u+f)<o&&Math.abs(p+m)<o&&Math.abs(l+d+g-3)<o)return this.set(1,0,0,0),this;t=Math.PI;const e=(l+1)/2,a=(d+1)/2,y=(g+1)/2,v=(c+h)/4,_=(u+f)/4,x=(p+m)/4;return e>a&&e>y?e<s?(r=0,n=.707106781,i=.707106781):(r=Math.sqrt(e),n=v/r,i=_/r):a>y?a<s?(r=.707106781,n=0,i=.707106781):(n=Math.sqrt(a),r=v/n,i=x/n):y<s?(r=.707106781,n=.707106781,i=0):(i=Math.sqrt(y),r=_/i,n=x/i),this.set(r,n,i,t),this}let y=Math.sqrt((m-p)*(m-p)+(u-f)*(u-f)+(h-c)*(h-c));return Math.abs(y)<.001&&(y=1),this.x=(m-p)/y,this.y=(u-f)/y,this.z=(h-c)/y,this.w=Math.acos((l+d+g-1)/2),this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this.w=Math.min(this.w,e.w),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this.w=Math.max(this.w,e.w),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this.z=Math.max(e.z,Math.min(t.z,this.z)),this.w=Math.max(e.w,Math.min(t.w,this.w)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this.z=Math.max(e,Math.min(t,this.z)),this.w=Math.max(e,Math.min(t,this.w)),this}clampLength(e,t){const r=this.length();return this.divideScalar(r||1).multiplyScalar(Math.max(e,Math.min(t,r)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this.w=this.w<0?Math.ceil(this.w):Math.floor(this.w),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z+this.w*e.w}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this.w+=(e.w-this.w)*t,this}lerpVectors(e,t,r){return this.x=e.x+(t.x-e.x)*r,this.y=e.y+(t.y-e.y)*r,this.z=e.z+(t.z-e.z)*r,this.w=e.w+(t.w-e.w)*r,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z&&e.w===this.w}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this.z=e[t+2],this.w=e[t+3],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e[t+3]=this.w,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this.w=e.getW(t),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this.w=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z,yield this.w}}class yr extends Rt{constructor(e=1,t=1,r={}){super(),this.isWebGLRenderTarget=!0,this.width=e,this.height=t,this.depth=1,this.scissor=new gr(0,0,e,t),this.scissorTest=!1,this.viewport=new gr(0,0,e,t);const n={width:e,height:t,depth:1};this.texture=new mr(n,r.mapping,r.wrapS,r.wrapT,r.magFilter,r.minFilter,r.format,r.type,r.anisotropy,r.encoding),this.texture.isRenderTargetTexture=!0,this.texture.flipY=!1,this.texture.generateMipmaps=void 0!==r.generateMipmaps&&r.generateMipmaps,this.texture.internalFormat=void 0!==r.internalFormat?r.internalFormat:null,this.texture.minFilter=void 0!==r.minFilter?r.minFilter:ce,this.depthBuffer=void 0===r.depthBuffer||r.depthBuffer,this.stencilBuffer=void 0!==r.stencilBuffer&&r.stencilBuffer,this.depthTexture=void 0!==r.depthTexture?r.depthTexture:null,this.samples=void 0!==r.samples?r.samples:0}setSize(e,t,r=1){this.width===e&&this.height===t&&this.depth===r||(this.width=e,this.height=t,this.depth=r,this.texture.image.width=e,this.texture.image.height=t,this.texture.image.depth=r,this.dispose()),this.viewport.set(0,0,e,t),this.scissor.set(0,0,e,t)}clone(){return(new this.constructor).copy(this)}copy(e){this.width=e.width,this.height=e.height,this.depth=e.depth,this.viewport.copy(e.viewport),this.texture=e.texture.clone(),this.texture.isRenderTargetTexture=!0;const t=Object.assign({},e.texture.image);return this.texture.source=new dr(t),this.depthBuffer=e.depthBuffer,this.stencilBuffer=e.stencilBuffer,null!==e.depthTexture&&(this.depthTexture=e.depthTexture.clone()),this.samples=e.samples,this}dispose(){this.dispatchEvent({type:"dispose"})}}class vr extends mr{constructor(e=null,t=1,r=1,n=1){super(null),this.isDataArrayTexture=!0,this.image={data:e,width:t,height:r,depth:n},this.magFilter=oe,this.minFilter=oe,this.wrapR=ie,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}class _r extends mr{constructor(e=null,t=1,r=1,n=1){super(null),this.isData3DTexture=!0,this.image={data:e,width:t,height:r,depth:n},this.magFilter=oe,this.minFilter=oe,this.wrapR=ie,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}class xr{constructor(e=new $t(1/0,1/0,1/0),t=new $t(-1/0,-1/0,-1/0)){this.isBox3=!0,this.min=e,this.max=t}set(e,t){return this.min.copy(e),this.max.copy(t),this}setFromArray(e){let t=1/0,r=1/0,n=1/0,i=-1/0,s=-1/0,o=-1/0;for(let a=0,l=e.length;a<l;a+=3){const l=e[a],c=e[a+1],u=e[a+2];l<t&&(t=l),c<r&&(r=c),u<n&&(n=u),l>i&&(i=l),c>s&&(s=c),u>o&&(o=u)}return this.min.set(t,r,n),this.max.set(i,s,o),this}setFromBufferAttribute(e){let t=1/0,r=1/0,n=1/0,i=-1/0,s=-1/0,o=-1/0;for(let a=0,l=e.count;a<l;a++){const l=e.getX(a),c=e.getY(a),u=e.getZ(a);l<t&&(t=l),c<r&&(r=c),u<n&&(n=u),l>i&&(i=l),c>s&&(s=c),u>o&&(o=u)}return this.min.set(t,r,n),this.max.set(i,s,o),this}setFromPoints(e){this.makeEmpty();for(let t=0,r=e.length;t<r;t++)this.expandByPoint(e[t]);return this}setFromCenterAndSize(e,t){const r=wr.copy(t).multiplyScalar(.5);return this.min.copy(e).sub(r),this.max.copy(e).add(r),this}setFromObject(e,t=!1){return this.makeEmpty(),this.expandByObject(e,t)}clone(){return(new this.constructor).copy(this)}copy(e){return this.min.copy(e.min),this.max.copy(e.max),this}makeEmpty(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z}getCenter(e){return this.isEmpty()?e.set(0,0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(e){return this.isEmpty()?e.set(0,0,0):e.subVectors(this.max,this.min)}expandByPoint(e){return this.min.min(e),this.max.max(e),this}expandByVector(e){return this.min.sub(e),this.max.add(e),this}expandByScalar(e){return this.min.addScalar(-e),this.max.addScalar(e),this}expandByObject(e,t=!1){e.updateWorldMatrix(!1,!1);const r=e.geometry;if(void 0!==r)if(t&&null!=r.attributes&&void 0!==r.attributes.position){const t=r.attributes.position;for(let r=0,n=t.count;r<n;r++)wr.fromBufferAttribute(t,r).applyMatrix4(e.matrixWorld),this.expandByPoint(wr)}else null===r.boundingBox&&r.computeBoundingBox(),Sr.copy(r.boundingBox),Sr.applyMatrix4(e.matrixWorld),this.union(Sr);const n=e.children;for(let e=0,r=n.length;e<r;e++)this.expandByObject(n[e],t);return this}containsPoint(e){return!(e.x<this.min.x||e.x>this.max.x||e.y<this.min.y||e.y>this.max.y||e.z<this.min.z||e.z>this.max.z)}containsBox(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y&&this.min.z<=e.min.z&&e.max.z<=this.max.z}getParameter(e,t){return t.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y),(e.z-this.min.z)/(this.max.z-this.min.z))}intersectsBox(e){return!(e.max.x<this.min.x||e.min.x>this.max.x||e.max.y<this.min.y||e.min.y>this.max.y||e.max.z<this.min.z||e.min.z>this.max.z)}intersectsSphere(e){return this.clampPoint(e.center,wr),wr.distanceToSquared(e.center)<=e.radius*e.radius}intersectsPlane(e){let t,r;return e.normal.x>0?(t=e.normal.x*this.min.x,r=e.normal.x*this.max.x):(t=e.normal.x*this.max.x,r=e.normal.x*this.min.x),e.normal.y>0?(t+=e.normal.y*this.min.y,r+=e.normal.y*this.max.y):(t+=e.normal.y*this.max.y,r+=e.normal.y*this.min.y),e.normal.z>0?(t+=e.normal.z*this.min.z,r+=e.normal.z*this.max.z):(t+=e.normal.z*this.max.z,r+=e.normal.z*this.min.z),t<=-e.constant&&r>=-e.constant}intersectsTriangle(e){if(this.isEmpty())return!1;this.getCenter(Rr),Pr.subVectors(this.max,Rr),Mr.subVectors(e.a,Rr),Tr.subVectors(e.b,Rr),Er.subVectors(e.c,Rr),Ar.subVectors(Tr,Mr),Cr.subVectors(Er,Tr),Lr.subVectors(Mr,Er);let t=[0,-Ar.z,Ar.y,0,-Cr.z,Cr.y,0,-Lr.z,Lr.y,Ar.z,0,-Ar.x,Cr.z,0,-Cr.x,Lr.z,0,-Lr.x,-Ar.y,Ar.x,0,-Cr.y,Cr.x,0,-Lr.y,Lr.x,0];return!!Dr(t,Mr,Tr,Er,Pr)&&(t=[1,0,0,0,1,0,0,0,1],!!Dr(t,Mr,Tr,Er,Pr)&&(jr.crossVectors(Ar,Cr),t=[jr.x,jr.y,jr.z],Dr(t,Mr,Tr,Er,Pr)))}clampPoint(e,t){return t.copy(e).clamp(this.min,this.max)}distanceToPoint(e){return this.clampPoint(e,wr).distanceTo(e)}getBoundingSphere(e){return this.isEmpty()?e.makeEmpty():(this.getCenter(e.center),e.radius=.5*this.getSize(wr).length()),e}intersect(e){return this.min.max(e.min),this.max.min(e.max),this.isEmpty()&&this.makeEmpty(),this}union(e){return this.min.min(e.min),this.max.max(e.max),this}applyMatrix4(e){return this.isEmpty()||(br[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(e),br[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(e),br[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(e),br[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(e),br[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(e),br[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(e),br[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(e),br[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(e),this.setFromPoints(br)),this}translate(e){return this.min.add(e),this.max.add(e),this}equals(e){return e.min.equals(this.min)&&e.max.equals(this.max)}}const br=[new $t,new $t,new $t,new $t,new $t,new $t,new $t,new $t],wr=new $t,Sr=new xr,Mr=new $t,Tr=new $t,Er=new $t,Ar=new $t,Cr=new $t,Lr=new $t,Rr=new $t,Pr=new $t,jr=new $t,Ir=new $t;function Dr(e,t,r,n,i){for(let s=0,o=e.length-3;s<=o;s+=3){Ir.fromArray(e,s);const o=i.x*Math.abs(Ir.x)+i.y*Math.abs(Ir.y)+i.z*Math.abs(Ir.z),a=t.dot(Ir),l=r.dot(Ir),c=n.dot(Ir);if(Math.max(-Math.max(a,l,c),Math.min(a,l,c))>o)return!1}return!0}const Or=new xr,Nr=new $t,Ur=new $t;class kr{constructor(e=new $t,t=-1){this.center=e,this.radius=t}set(e,t){return this.center.copy(e),this.radius=t,this}setFromPoints(e,t){const r=this.center;void 0!==t?r.copy(t):Or.setFromPoints(e).getCenter(r);let n=0;for(let t=0,i=e.length;t<i;t++)n=Math.max(n,r.distanceToSquared(e[t]));return this.radius=Math.sqrt(n),this}copy(e){return this.center.copy(e.center),this.radius=e.radius,this}isEmpty(){return this.radius<0}makeEmpty(){return this.center.set(0,0,0),this.radius=-1,this}containsPoint(e){return e.distanceToSquared(this.center)<=this.radius*this.radius}distanceToPoint(e){return e.distanceTo(this.center)-this.radius}intersectsSphere(e){const t=this.radius+e.radius;return e.center.distanceToSquared(this.center)<=t*t}intersectsBox(e){return e.intersectsSphere(this)}intersectsPlane(e){return Math.abs(e.distanceToPoint(this.center))<=this.radius}clampPoint(e,t){const r=this.center.distanceToSquared(e);return t.copy(e),r>this.radius*this.radius&&(t.sub(this.center).normalize(),t.multiplyScalar(this.radius).add(this.center)),t}getBoundingBox(e){return this.isEmpty()?(e.makeEmpty(),e):(e.set(this.center,this.center),e.expandByScalar(this.radius),e)}applyMatrix4(e){return this.center.applyMatrix4(e),this.radius=this.radius*e.getMaxScaleOnAxis(),this}translate(e){return this.center.add(e),this}expandByPoint(e){if(this.isEmpty())return this.center.copy(e),this.radius=0,this;Nr.subVectors(e,this.center);const t=Nr.lengthSq();if(t>this.radius*this.radius){const e=Math.sqrt(t),r=.5*(e-this.radius);this.center.addScaledVector(Nr,r/e),this.radius+=r}return this}union(e){return e.isEmpty()?this:this.isEmpty()?(this.copy(e),this):(!0===this.center.equals(e.center)?this.radius=Math.max(this.radius,e.radius):(Ur.subVectors(e.center,this.center).setLength(e.radius),this.expandByPoint(Nr.copy(e.center).add(Ur)),this.expandByPoint(Nr.copy(e.center).sub(Ur))),this)}equals(e){return e.center.equals(this.center)&&e.radius===this.radius}clone(){return(new this.constructor).copy(this)}}const Fr=new $t,Br=new $t,zr=new $t,Gr=new $t,Vr=new $t,Hr=new $t,Wr=new $t;class Xr{constructor(e=new $t,t=new $t(0,0,-1)){this.origin=e,this.direction=t}set(e,t){return this.origin.copy(e),this.direction.copy(t),this}copy(e){return this.origin.copy(e.origin),this.direction.copy(e.direction),this}at(e,t){return t.copy(this.origin).addScaledVector(this.direction,e)}lookAt(e){return this.direction.copy(e).sub(this.origin).normalize(),this}recast(e){return this.origin.copy(this.at(e,Fr)),this}closestPointToPoint(e,t){t.subVectors(e,this.origin);const r=t.dot(this.direction);return r<0?t.copy(this.origin):t.copy(this.origin).addScaledVector(this.direction,r)}distanceToPoint(e){return Math.sqrt(this.distanceSqToPoint(e))}distanceSqToPoint(e){const t=Fr.subVectors(e,this.origin).dot(this.direction);return t<0?this.origin.distanceToSquared(e):(Fr.copy(this.origin).addScaledVector(this.direction,t),Fr.distanceToSquared(e))}distanceSqToSegment(e,t,r,n){Br.copy(e).add(t).multiplyScalar(.5),zr.copy(t).sub(e).normalize(),Gr.copy(this.origin).sub(Br);const i=.5*e.distanceTo(t),s=-this.direction.dot(zr),o=Gr.dot(this.direction),a=-Gr.dot(zr),l=Gr.lengthSq(),c=Math.abs(1-s*s);let u,h,d,p;if(c>0)if(u=s*a-o,h=s*o-a,p=i*c,u>=0)if(h>=-p)if(h<=p){const e=1/c;u*=e,h*=e,d=u*(u+s*h+2*o)+h*(s*u+h+2*a)+l}else h=i,u=Math.max(0,-(s*h+o)),d=-u*u+h*(h+2*a)+l;else h=-i,u=Math.max(0,-(s*h+o)),d=-u*u+h*(h+2*a)+l;else h<=-p?(u=Math.max(0,-(-s*i+o)),h=u>0?-i:Math.min(Math.max(-i,-a),i),d=-u*u+h*(h+2*a)+l):h<=p?(u=0,h=Math.min(Math.max(-i,-a),i),d=h*(h+2*a)+l):(u=Math.max(0,-(s*i+o)),h=u>0?i:Math.min(Math.max(-i,-a),i),d=-u*u+h*(h+2*a)+l);else h=s>0?-i:i,u=Math.max(0,-(s*h+o)),d=-u*u+h*(h+2*a)+l;return r&&r.copy(this.origin).addScaledVector(this.direction,u),n&&n.copy(Br).addScaledVector(zr,h),d}intersectSphere(e,t){Fr.subVectors(e.center,this.origin);const r=Fr.dot(this.direction),n=Fr.dot(Fr)-r*r,i=e.radius*e.radius;if(n>i)return null;const s=Math.sqrt(i-n),o=r-s,a=r+s;return a<0?null:o<0?this.at(a,t):this.at(o,t)}intersectsSphere(e){return this.distanceSqToPoint(e.center)<=e.radius*e.radius}distanceToPlane(e){const t=e.normal.dot(this.direction);if(0===t)return 0===e.distanceToPoint(this.origin)?0:null;const r=-(this.origin.dot(e.normal)+e.constant)/t;return r>=0?r:null}intersectPlane(e,t){const r=this.distanceToPlane(e);return null===r?null:this.at(r,t)}intersectsPlane(e){const t=e.distanceToPoint(this.origin);if(0===t)return!0;return e.normal.dot(this.direction)*t<0}intersectBox(e,t){let r,n,i,s,o,a;const l=1/this.direction.x,c=1/this.direction.y,u=1/this.direction.z,h=this.origin;return l>=0?(r=(e.min.x-h.x)*l,n=(e.max.x-h.x)*l):(r=(e.max.x-h.x)*l,n=(e.min.x-h.x)*l),c>=0?(i=(e.min.y-h.y)*c,s=(e.max.y-h.y)*c):(i=(e.max.y-h.y)*c,s=(e.min.y-h.y)*c),r>s||i>n?null:((i>r||isNaN(r))&&(r=i),(s<n||isNaN(n))&&(n=s),u>=0?(o=(e.min.z-h.z)*u,a=(e.max.z-h.z)*u):(o=(e.max.z-h.z)*u,a=(e.min.z-h.z)*u),r>a||o>n?null:((o>r||r!=r)&&(r=o),(a<n||n!=n)&&(n=a),n<0?null:this.at(r>=0?r:n,t)))}intersectsBox(e){return null!==this.intersectBox(e,Fr)}intersectTriangle(e,t,r,n,i){Vr.subVectors(t,e),Hr.subVectors(r,e),Wr.crossVectors(Vr,Hr);let s,o=this.direction.dot(Wr);if(o>0){if(n)return null;s=1}else{if(!(o<0))return null;s=-1,o=-o}Gr.subVectors(this.origin,e);const a=s*this.direction.dot(Hr.crossVectors(Gr,Hr));if(a<0)return null;const l=s*this.direction.dot(Vr.cross(Gr));if(l<0)return null;if(a+l>o)return null;const c=-s*Gr.dot(Wr);return c<0?null:this.at(c/o,i)}applyMatrix4(e){return this.origin.applyMatrix4(e),this.direction.transformDirection(e),this}equals(e){return e.origin.equals(this.origin)&&e.direction.equals(this.direction)}clone(){return(new this.constructor).copy(this)}}class qr{constructor(){qr.prototype.isMatrix4=!0,this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}set(e,t,r,n,i,s,o,a,l,c,u,h,d,p,f,m){const g=this.elements;return g[0]=e,g[4]=t,g[8]=r,g[12]=n,g[1]=i,g[5]=s,g[9]=o,g[13]=a,g[2]=l,g[6]=c,g[10]=u,g[14]=h,g[3]=d,g[7]=p,g[11]=f,g[15]=m,this}identity(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this}clone(){return(new qr).fromArray(this.elements)}copy(e){const t=this.elements,r=e.elements;return t[0]=r[0],t[1]=r[1],t[2]=r[2],t[3]=r[3],t[4]=r[4],t[5]=r[5],t[6]=r[6],t[7]=r[7],t[8]=r[8],t[9]=r[9],t[10]=r[10],t[11]=r[11],t[12]=r[12],t[13]=r[13],t[14]=r[14],t[15]=r[15],this}copyPosition(e){const t=this.elements,r=e.elements;return t[12]=r[12],t[13]=r[13],t[14]=r[14],this}setFromMatrix3(e){const t=e.elements;return this.set(t[0],t[3],t[6],0,t[1],t[4],t[7],0,t[2],t[5],t[8],0,0,0,0,1),this}extractBasis(e,t,r){return e.setFromMatrixColumn(this,0),t.setFromMatrixColumn(this,1),r.setFromMatrixColumn(this,2),this}makeBasis(e,t,r){return this.set(e.x,t.x,r.x,0,e.y,t.y,r.y,0,e.z,t.z,r.z,0,0,0,0,1),this}extractRotation(e){const t=this.elements,r=e.elements,n=1/Yr.setFromMatrixColumn(e,0).length(),i=1/Yr.setFromMatrixColumn(e,1).length(),s=1/Yr.setFromMatrixColumn(e,2).length();return t[0]=r[0]*n,t[1]=r[1]*n,t[2]=r[2]*n,t[3]=0,t[4]=r[4]*i,t[5]=r[5]*i,t[6]=r[6]*i,t[7]=0,t[8]=r[8]*s,t[9]=r[9]*s,t[10]=r[10]*s,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}makeRotationFromEuler(e){const t=this.elements,r=e.x,n=e.y,i=e.z,s=Math.cos(r),o=Math.sin(r),a=Math.cos(n),l=Math.sin(n),c=Math.cos(i),u=Math.sin(i);if("XYZ"===e.order){const e=s*c,r=s*u,n=o*c,i=o*u;t[0]=a*c,t[4]=-a*u,t[8]=l,t[1]=r+n*l,t[5]=e-i*l,t[9]=-o*a,t[2]=i-e*l,t[6]=n+r*l,t[10]=s*a}else if("YXZ"===e.order){const e=a*c,r=a*u,n=l*c,i=l*u;t[0]=e+i*o,t[4]=n*o-r,t[8]=s*l,t[1]=s*u,t[5]=s*c,t[9]=-o,t[2]=r*o-n,t[6]=i+e*o,t[10]=s*a}else if("ZXY"===e.order){const e=a*c,r=a*u,n=l*c,i=l*u;t[0]=e-i*o,t[4]=-s*u,t[8]=n+r*o,t[1]=r+n*o,t[5]=s*c,t[9]=i-e*o,t[2]=-s*l,t[6]=o,t[10]=s*a}else if("ZYX"===e.order){const e=s*c,r=s*u,n=o*c,i=o*u;t[0]=a*c,t[4]=n*l-r,t[8]=e*l+i,t[1]=a*u,t[5]=i*l+e,t[9]=r*l-n,t[2]=-l,t[6]=o*a,t[10]=s*a}else if("YZX"===e.order){const e=s*a,r=s*l,n=o*a,i=o*l;t[0]=a*c,t[4]=i-e*u,t[8]=n*u+r,t[1]=u,t[5]=s*c,t[9]=-o*c,t[2]=-l*c,t[6]=r*u+n,t[10]=e-i*u}else if("XZY"===e.order){const e=s*a,r=s*l,n=o*a,i=o*l;t[0]=a*c,t[4]=-u,t[8]=l*c,t[1]=e*u+i,t[5]=s*c,t[9]=r*u-n,t[2]=n*u-r,t[6]=o*c,t[10]=i*u+e}return t[3]=0,t[7]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}makeRotationFromQuaternion(e){return this.compose(Jr,e,Kr)}lookAt(e,t,r){const n=this.elements;return en.subVectors(e,t),0===en.lengthSq()&&(en.z=1),en.normalize(),Qr.crossVectors(r,en),0===Qr.lengthSq()&&(1===Math.abs(r.z)?en.x+=1e-4:en.z+=1e-4,en.normalize(),Qr.crossVectors(r,en)),Qr.normalize(),$r.crossVectors(en,Qr),n[0]=Qr.x,n[4]=$r.x,n[8]=en.x,n[1]=Qr.y,n[5]=$r.y,n[9]=en.y,n[2]=Qr.z,n[6]=$r.z,n[10]=en.z,this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,t){const r=e.elements,n=t.elements,i=this.elements,s=r[0],o=r[4],a=r[8],l=r[12],c=r[1],u=r[5],h=r[9],d=r[13],p=r[2],f=r[6],m=r[10],g=r[14],y=r[3],v=r[7],_=r[11],x=r[15],b=n[0],w=n[4],S=n[8],M=n[12],T=n[1],E=n[5],A=n[9],C=n[13],L=n[2],R=n[6],P=n[10],j=n[14],I=n[3],D=n[7],O=n[11],N=n[15];return i[0]=s*b+o*T+a*L+l*I,i[4]=s*w+o*E+a*R+l*D,i[8]=s*S+o*A+a*P+l*O,i[12]=s*M+o*C+a*j+l*N,i[1]=c*b+u*T+h*L+d*I,i[5]=c*w+u*E+h*R+d*D,i[9]=c*S+u*A+h*P+d*O,i[13]=c*M+u*C+h*j+d*N,i[2]=p*b+f*T+m*L+g*I,i[6]=p*w+f*E+m*R+g*D,i[10]=p*S+f*A+m*P+g*O,i[14]=p*M+f*C+m*j+g*N,i[3]=y*b+v*T+_*L+x*I,i[7]=y*w+v*E+_*R+x*D,i[11]=y*S+v*A+_*P+x*O,i[15]=y*M+v*C+_*j+x*N,this}multiplyScalar(e){const t=this.elements;return t[0]*=e,t[4]*=e,t[8]*=e,t[12]*=e,t[1]*=e,t[5]*=e,t[9]*=e,t[13]*=e,t[2]*=e,t[6]*=e,t[10]*=e,t[14]*=e,t[3]*=e,t[7]*=e,t[11]*=e,t[15]*=e,this}determinant(){const e=this.elements,t=e[0],r=e[4],n=e[8],i=e[12],s=e[1],o=e[5],a=e[9],l=e[13],c=e[2],u=e[6],h=e[10],d=e[14];return e[3]*(+i*a*u-n*l*u-i*o*h+r*l*h+n*o*d-r*a*d)+e[7]*(+t*a*d-t*l*h+i*s*h-n*s*d+n*l*c-i*a*c)+e[11]*(+t*l*u-t*o*d-i*s*u+r*s*d+i*o*c-r*l*c)+e[15]*(-n*o*c-t*a*u+t*o*h+n*s*u-r*s*h+r*a*c)}transpose(){const e=this.elements;let t;return t=e[1],e[1]=e[4],e[4]=t,t=e[2],e[2]=e[8],e[8]=t,t=e[6],e[6]=e[9],e[9]=t,t=e[3],e[3]=e[12],e[12]=t,t=e[7],e[7]=e[13],e[13]=t,t=e[11],e[11]=e[14],e[14]=t,this}setPosition(e,t,r){const n=this.elements;return e.isVector3?(n[12]=e.x,n[13]=e.y,n[14]=e.z):(n[12]=e,n[13]=t,n[14]=r),this}invert(){const e=this.elements,t=e[0],r=e[1],n=e[2],i=e[3],s=e[4],o=e[5],a=e[6],l=e[7],c=e[8],u=e[9],h=e[10],d=e[11],p=e[12],f=e[13],m=e[14],g=e[15],y=u*m*l-f*h*l+f*a*d-o*m*d-u*a*g+o*h*g,v=p*h*l-c*m*l-p*a*d+s*m*d+c*a*g-s*h*g,_=c*f*l-p*u*l+p*o*d-s*f*d-c*o*g+s*u*g,x=p*u*a-c*f*a-p*o*h+s*f*h+c*o*m-s*u*m,b=t*y+r*v+n*_+i*x;if(0===b)return this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);const w=1/b;return e[0]=y*w,e[1]=(f*h*i-u*m*i-f*n*d+r*m*d+u*n*g-r*h*g)*w,e[2]=(o*m*i-f*a*i+f*n*l-r*m*l-o*n*g+r*a*g)*w,e[3]=(u*a*i-o*h*i-u*n*l+r*h*l+o*n*d-r*a*d)*w,e[4]=v*w,e[5]=(c*m*i-p*h*i+p*n*d-t*m*d-c*n*g+t*h*g)*w,e[6]=(p*a*i-s*m*i-p*n*l+t*m*l+s*n*g-t*a*g)*w,e[7]=(s*h*i-c*a*i+c*n*l-t*h*l-s*n*d+t*a*d)*w,e[8]=_*w,e[9]=(p*u*i-c*f*i-p*r*d+t*f*d+c*r*g-t*u*g)*w,e[10]=(s*f*i-p*o*i+p*r*l-t*f*l-s*r*g+t*o*g)*w,e[11]=(c*o*i-s*u*i-c*r*l+t*u*l+s*r*d-t*o*d)*w,e[12]=x*w,e[13]=(c*f*n-p*u*n+p*r*h-t*f*h-c*r*m+t*u*m)*w,e[14]=(p*o*n-s*f*n-p*r*a+t*f*a+s*r*m-t*o*m)*w,e[15]=(s*u*n-c*o*n+c*r*a-t*u*a-s*r*h+t*o*h)*w,this}scale(e){const t=this.elements,r=e.x,n=e.y,i=e.z;return t[0]*=r,t[4]*=n,t[8]*=i,t[1]*=r,t[5]*=n,t[9]*=i,t[2]*=r,t[6]*=n,t[10]*=i,t[3]*=r,t[7]*=n,t[11]*=i,this}getMaxScaleOnAxis(){const e=this.elements,t=e[0]*e[0]+e[1]*e[1]+e[2]*e[2],r=e[4]*e[4]+e[5]*e[5]+e[6]*e[6],n=e[8]*e[8]+e[9]*e[9]+e[10]*e[10];return Math.sqrt(Math.max(t,r,n))}makeTranslation(e,t,r){return this.set(1,0,0,e,0,1,0,t,0,0,1,r,0,0,0,1),this}makeRotationX(e){const t=Math.cos(e),r=Math.sin(e);return this.set(1,0,0,0,0,t,-r,0,0,r,t,0,0,0,0,1),this}makeRotationY(e){const t=Math.cos(e),r=Math.sin(e);return this.set(t,0,r,0,0,1,0,0,-r,0,t,0,0,0,0,1),this}makeRotationZ(e){const t=Math.cos(e),r=Math.sin(e);return this.set(t,-r,0,0,r,t,0,0,0,0,1,0,0,0,0,1),this}makeRotationAxis(e,t){const r=Math.cos(t),n=Math.sin(t),i=1-r,s=e.x,o=e.y,a=e.z,l=i*s,c=i*o;return this.set(l*s+r,l*o-n*a,l*a+n*o,0,l*o+n*a,c*o+r,c*a-n*s,0,l*a-n*o,c*a+n*s,i*a*a+r,0,0,0,0,1),this}makeScale(e,t,r){return this.set(e,0,0,0,0,t,0,0,0,0,r,0,0,0,0,1),this}makeShear(e,t,r,n,i,s){return this.set(1,r,i,0,e,1,s,0,t,n,1,0,0,0,0,1),this}compose(e,t,r){const n=this.elements,i=t._x,s=t._y,o=t._z,a=t._w,l=i+i,c=s+s,u=o+o,h=i*l,d=i*c,p=i*u,f=s*c,m=s*u,g=o*u,y=a*l,v=a*c,_=a*u,x=r.x,b=r.y,w=r.z;return n[0]=(1-(f+g))*x,n[1]=(d+_)*x,n[2]=(p-v)*x,n[3]=0,n[4]=(d-_)*b,n[5]=(1-(h+g))*b,n[6]=(m+y)*b,n[7]=0,n[8]=(p+v)*w,n[9]=(m-y)*w,n[10]=(1-(h+f))*w,n[11]=0,n[12]=e.x,n[13]=e.y,n[14]=e.z,n[15]=1,this}decompose(e,t,r){const n=this.elements;let i=Yr.set(n[0],n[1],n[2]).length();const s=Yr.set(n[4],n[5],n[6]).length(),o=Yr.set(n[8],n[9],n[10]).length();this.determinant()<0&&(i=-i),e.x=n[12],e.y=n[13],e.z=n[14],Zr.copy(this);const a=1/i,l=1/s,c=1/o;return Zr.elements[0]*=a,Zr.elements[1]*=a,Zr.elements[2]*=a,Zr.elements[4]*=l,Zr.elements[5]*=l,Zr.elements[6]*=l,Zr.elements[8]*=c,Zr.elements[9]*=c,Zr.elements[10]*=c,t.setFromRotationMatrix(Zr),r.x=i,r.y=s,r.z=o,this}makePerspective(e,t,r,n,i,s){const o=this.elements,a=2*i/(t-e),l=2*i/(r-n),c=(t+e)/(t-e),u=(r+n)/(r-n),h=-(s+i)/(s-i),d=-2*s*i/(s-i);return o[0]=a,o[4]=0,o[8]=c,o[12]=0,o[1]=0,o[5]=l,o[9]=u,o[13]=0,o[2]=0,o[6]=0,o[10]=h,o[14]=d,o[3]=0,o[7]=0,o[11]=-1,o[15]=0,this}makeOrthographic(e,t,r,n,i,s){const o=this.elements,a=1/(t-e),l=1/(r-n),c=1/(s-i),u=(t+e)*a,h=(r+n)*l,d=(s+i)*c;return o[0]=2*a,o[4]=0,o[8]=0,o[12]=-u,o[1]=0,o[5]=2*l,o[9]=0,o[13]=-h,o[2]=0,o[6]=0,o[10]=-2*c,o[14]=-d,o[3]=0,o[7]=0,o[11]=0,o[15]=1,this}equals(e){const t=this.elements,r=e.elements;for(let e=0;e<16;e++)if(t[e]!==r[e])return!1;return!0}fromArray(e,t=0){for(let r=0;r<16;r++)this.elements[r]=e[r+t];return this}toArray(e=[],t=0){const r=this.elements;return e[t]=r[0],e[t+1]=r[1],e[t+2]=r[2],e[t+3]=r[3],e[t+4]=r[4],e[t+5]=r[5],e[t+6]=r[6],e[t+7]=r[7],e[t+8]=r[8],e[t+9]=r[9],e[t+10]=r[10],e[t+11]=r[11],e[t+12]=r[12],e[t+13]=r[13],e[t+14]=r[14],e[t+15]=r[15],e}}const Yr=new $t,Zr=new qr,Jr=new $t(0,0,0),Kr=new $t(1,1,1),Qr=new $t,$r=new $t,en=new $t,tn=new qr,rn=new Qt;class nn{constructor(e=0,t=0,r=0,n=nn.DEFAULT_ORDER){this.isEuler=!0,this._x=e,this._y=t,this._z=r,this._order=n}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get order(){return this._order}set order(e){this._order=e,this._onChangeCallback()}set(e,t,r,n=this._order){return this._x=e,this._y=t,this._z=r,this._order=n,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._order)}copy(e){return this._x=e._x,this._y=e._y,this._z=e._z,this._order=e._order,this._onChangeCallback(),this}setFromRotationMatrix(e,t=this._order,r=!0){const n=e.elements,i=n[0],s=n[4],o=n[8],a=n[1],l=n[5],c=n[9],u=n[2],h=n[6],d=n[10];switch(t){case"XYZ":this._y=Math.asin(Nt(o,-1,1)),Math.abs(o)<.9999999?(this._x=Math.atan2(-c,d),this._z=Math.atan2(-s,i)):(this._x=Math.atan2(h,l),this._z=0);break;case"YXZ":this._x=Math.asin(-Nt(c,-1,1)),Math.abs(c)<.9999999?(this._y=Math.atan2(o,d),this._z=Math.atan2(a,l)):(this._y=Math.atan2(-u,i),this._z=0);break;case"ZXY":this._x=Math.asin(Nt(h,-1,1)),Math.abs(h)<.9999999?(this._y=Math.atan2(-u,d),this._z=Math.atan2(-s,l)):(this._y=0,this._z=Math.atan2(a,i));break;case"ZYX":this._y=Math.asin(-Nt(u,-1,1)),Math.abs(u)<.9999999?(this._x=Math.atan2(h,d),this._z=Math.atan2(a,i)):(this._x=0,this._z=Math.atan2(-s,l));break;case"YZX":this._z=Math.asin(Nt(a,-1,1)),Math.abs(a)<.9999999?(this._x=Math.atan2(-c,l),this._y=Math.atan2(-u,i)):(this._x=0,this._y=Math.atan2(o,d));break;case"XZY":this._z=Math.asin(-Nt(s,-1,1)),Math.abs(s)<.9999999?(this._x=Math.atan2(h,l),this._y=Math.atan2(o,i)):(this._x=Math.atan2(-c,d),this._y=0)}return this._order=t,!0===r&&this._onChangeCallback(),this}setFromQuaternion(e,t,r){return tn.makeRotationFromQuaternion(e),this.setFromRotationMatrix(tn,t,r)}setFromVector3(e,t=this._order){return this.set(e.x,e.y,e.z,t)}reorder(e){return rn.setFromEuler(this),this.setFromQuaternion(rn,e)}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._order===this._order}fromArray(e){return this._x=e[0],this._y=e[1],this._z=e[2],void 0!==e[3]&&(this._order=e[3]),this._onChangeCallback(),this}toArray(e=[],t=0){return e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._order,e}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._order}}nn.DEFAULT_ORDER="XYZ";class sn{constructor(){this.mask=1}set(e){this.mask=(1<<e|0)>>>0}enable(e){this.mask|=1<<e|0}enableAll(){this.mask=-1}toggle(e){this.mask^=1<<e|0}disable(e){this.mask&=~(1<<e|0)}disableAll(){this.mask=0}test(e){return 0!=(this.mask&e.mask)}isEnabled(e){return 0!=(this.mask&(1<<e|0))}}let on=0;const an=new $t,ln=new Qt,cn=new qr,un=new $t,hn=new $t,dn=new $t,pn=new Qt,fn=new $t(1,0,0),mn=new $t(0,1,0),gn=new $t(0,0,1),yn={type:"added"},vn={type:"removed"};class _n extends Rt{constructor(){super(),this.isObject3D=!0,Object.defineProperty(this,"id",{value:on++}),this.uuid=Ot(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=_n.DEFAULT_UP.clone();const e=new $t,t=new nn,r=new Qt,n=new $t(1,1,1);t._onChange((function(){r.setFromEuler(t,!1)})),r._onChange((function(){t.setFromQuaternion(r,void 0,!1)})),Object.defineProperties(this,{position:{configurable:!0,enumerable:!0,value:e},rotation:{configurable:!0,enumerable:!0,value:t},quaternion:{configurable:!0,enumerable:!0,value:r},scale:{configurable:!0,enumerable:!0,value:n},modelViewMatrix:{value:new qr},normalMatrix:{value:new Xt}}),this.matrix=new qr,this.matrixWorld=new qr,this.matrixAutoUpdate=_n.DEFAULT_MATRIX_AUTO_UPDATE,this.matrixWorldNeedsUpdate=!1,this.matrixWorldAutoUpdate=_n.DEFAULT_MATRIX_WORLD_AUTO_UPDATE,this.layers=new sn,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.animations=[],this.userData={}}onBeforeRender(){}onAfterRender(){}applyMatrix4(e){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(e),this.matrix.decompose(this.position,this.quaternion,this.scale)}applyQuaternion(e){return this.quaternion.premultiply(e),this}setRotationFromAxisAngle(e,t){this.quaternion.setFromAxisAngle(e,t)}setRotationFromEuler(e){this.quaternion.setFromEuler(e,!0)}setRotationFromMatrix(e){this.quaternion.setFromRotationMatrix(e)}setRotationFromQuaternion(e){this.quaternion.copy(e)}rotateOnAxis(e,t){return ln.setFromAxisAngle(e,t),this.quaternion.multiply(ln),this}rotateOnWorldAxis(e,t){return ln.setFromAxisAngle(e,t),this.quaternion.premultiply(ln),this}rotateX(e){return this.rotateOnAxis(fn,e)}rotateY(e){return this.rotateOnAxis(mn,e)}rotateZ(e){return this.rotateOnAxis(gn,e)}translateOnAxis(e,t){return an.copy(e).applyQuaternion(this.quaternion),this.position.add(an.multiplyScalar(t)),this}translateX(e){return this.translateOnAxis(fn,e)}translateY(e){return this.translateOnAxis(mn,e)}translateZ(e){return this.translateOnAxis(gn,e)}localToWorld(e){return this.updateWorldMatrix(!0,!1),e.applyMatrix4(this.matrixWorld)}worldToLocal(e){return this.updateWorldMatrix(!0,!1),e.applyMatrix4(cn.copy(this.matrixWorld).invert())}lookAt(e,t,r){e.isVector3?un.copy(e):un.set(e,t,r);const n=this.parent;this.updateWorldMatrix(!0,!1),hn.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?cn.lookAt(hn,un,this.up):cn.lookAt(un,hn,this.up),this.quaternion.setFromRotationMatrix(cn),n&&(cn.extractRotation(n.matrixWorld),ln.setFromRotationMatrix(cn),this.quaternion.premultiply(ln.invert()))}add(e){if(arguments.length>1){for(let e=0;e<arguments.length;e++)this.add(arguments[e]);return this}return e===this||e&&e.isObject3D&&(null!==e.parent&&e.parent.remove(e),e.parent=this,this.children.push(e),e.dispatchEvent(yn)),this}remove(e){if(arguments.length>1){for(let e=0;e<arguments.length;e++)this.remove(arguments[e]);return this}const t=this.children.indexOf(e);return-1!==t&&(e.parent=null,this.children.splice(t,1),e.dispatchEvent(vn)),this}removeFromParent(){const e=this.parent;return null!==e&&e.remove(this),this}clear(){for(let e=0;e<this.children.length;e++){const t=this.children[e];t.parent=null,t.dispatchEvent(vn)}return this.children.length=0,this}attach(e){return this.updateWorldMatrix(!0,!1),cn.copy(this.matrixWorld).invert(),null!==e.parent&&(e.parent.updateWorldMatrix(!0,!1),cn.multiply(e.parent.matrixWorld)),e.applyMatrix4(cn),this.add(e),e.updateWorldMatrix(!1,!0),this}getObjectById(e){return this.getObjectByProperty("id",e)}getObjectByName(e){return this.getObjectByProperty("name",e)}getObjectByProperty(e,t){if(this[e]===t)return this;for(let r=0,n=this.children.length;r<n;r++){const n=this.children[r].getObjectByProperty(e,t);if(void 0!==n)return n}}getObjectsByProperty(e,t){let r=[];this[e]===t&&r.push(this);for(let n=0,i=this.children.length;n<i;n++){const i=this.children[n].getObjectsByProperty(e,t);i.length>0&&(r=r.concat(i))}return r}getWorldPosition(e){return this.updateWorldMatrix(!0,!1),e.setFromMatrixPosition(this.matrixWorld)}getWorldQuaternion(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(hn,e,dn),e}getWorldScale(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(hn,pn,e),e}getWorldDirection(e){this.updateWorldMatrix(!0,!1);const t=this.matrixWorld.elements;return e.set(t[8],t[9],t[10]).normalize()}raycast(){}traverse(e){e(this);const t=this.children;for(let r=0,n=t.length;r<n;r++)t[r].traverse(e)}traverseVisible(e){if(!1===this.visible)return;e(this);const t=this.children;for(let r=0,n=t.length;r<n;r++)t[r].traverseVisible(e)}traverseAncestors(e){const t=this.parent;null!==t&&(e(t),t.traverseAncestors(e))}updateMatrix(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0}updateMatrixWorld(e){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||e)&&(null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),this.matrixWorldNeedsUpdate=!1,e=!0);const t=this.children;for(let r=0,n=t.length;r<n;r++){const n=t[r];!0!==n.matrixWorldAutoUpdate&&!0!==e||n.updateMatrixWorld(e)}}updateWorldMatrix(e,t){const r=this.parent;if(!0===e&&null!==r&&!0===r.matrixWorldAutoUpdate&&r.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),!0===t){const e=this.children;for(let t=0,r=e.length;t<r;t++){const r=e[t];!0===r.matrixWorldAutoUpdate&&r.updateWorldMatrix(!1,!0)}}}toJSON(e){const t=void 0===e||"string"==typeof e,r={};t&&(e={geometries:{},materials:{},textures:{},images:{},shapes:{},skeletons:{},animations:{},nodes:{}},r.metadata={version:4.5,type:"Object",generator:"Object3D.toJSON"});const n={};function i(t,r){return void 0===t[r.uuid]&&(t[r.uuid]=r.toJSON(e)),r.uuid}if(n.uuid=this.uuid,n.type=this.type,""!==this.name&&(n.name=this.name),!0===this.castShadow&&(n.castShadow=!0),!0===this.receiveShadow&&(n.receiveShadow=!0),!1===this.visible&&(n.visible=!1),!1===this.frustumCulled&&(n.frustumCulled=!1),0!==this.renderOrder&&(n.renderOrder=this.renderOrder),Object.keys(this.userData).length>0&&(n.userData=this.userData),n.layers=this.layers.mask,n.matrix=this.matrix.toArray(),!1===this.matrixAutoUpdate&&(n.matrixAutoUpdate=!1),this.isInstancedMesh&&(n.type="InstancedMesh",n.count=this.count,n.instanceMatrix=this.instanceMatrix.toJSON(),null!==this.instanceColor&&(n.instanceColor=this.instanceColor.toJSON())),this.isScene)this.background&&(this.background.isColor?n.background=this.background.toJSON():this.background.isTexture&&(n.background=this.background.toJSON(e).uuid)),this.environment&&this.environment.isTexture&&!0!==this.environment.isRenderTargetTexture&&(n.environment=this.environment.toJSON(e).uuid);else if(this.isMesh||this.isLine||this.isPoints){n.geometry=i(e.geometries,this.geometry);const t=this.geometry.parameters;if(void 0!==t&&void 0!==t.shapes){const r=t.shapes;if(Array.isArray(r))for(let t=0,n=r.length;t<n;t++){const n=r[t];i(e.shapes,n)}else i(e.shapes,r)}}if(this.isSkinnedMesh&&(n.bindMode=this.bindMode,n.bindMatrix=this.bindMatrix.toArray(),void 0!==this.skeleton&&(i(e.skeletons,this.skeleton),n.skeleton=this.skeleton.uuid)),void 0!==this.material)if(Array.isArray(this.material)){const t=[];for(let r=0,n=this.material.length;r<n;r++)t.push(i(e.materials,this.material[r]));n.material=t}else n.material=i(e.materials,this.material);if(this.children.length>0){n.children=[];for(let t=0;t<this.children.length;t++)n.children.push(this.children[t].toJSON(e).object)}if(this.animations.length>0){n.animations=[];for(let t=0;t<this.animations.length;t++){const r=this.animations[t];n.animations.push(i(e.animations,r))}}if(t){const t=s(e.geometries),n=s(e.materials),i=s(e.textures),o=s(e.images),a=s(e.shapes),l=s(e.skeletons),c=s(e.animations),u=s(e.nodes);t.length>0&&(r.geometries=t),n.length>0&&(r.materials=n),i.length>0&&(r.textures=i),o.length>0&&(r.images=o),a.length>0&&(r.shapes=a),l.length>0&&(r.skeletons=l),c.length>0&&(r.animations=c),u.length>0&&(r.nodes=u)}return r.object=n,r;function s(e){const t=[];for(const r in e){const n=e[r];delete n.metadata,t.push(n)}return t}}clone(e){return(new this.constructor).copy(this,e)}copy(e,t=!0){if(this.name=e.name,this.up.copy(e.up),this.position.copy(e.position),this.rotation.order=e.rotation.order,this.quaternion.copy(e.quaternion),this.scale.copy(e.scale),this.matrix.copy(e.matrix),this.matrixWorld.copy(e.matrixWorld),this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrixWorldNeedsUpdate=e.matrixWorldNeedsUpdate,this.matrixWorldAutoUpdate=e.matrixWorldAutoUpdate,this.layers.mask=e.layers.mask,this.visible=e.visible,this.castShadow=e.castShadow,this.receiveShadow=e.receiveShadow,this.frustumCulled=e.frustumCulled,this.renderOrder=e.renderOrder,this.userData=JSON.parse(JSON.stringify(e.userData)),!0===t)for(let t=0;t<e.children.length;t++){const r=e.children[t];this.add(r.clone())}return this}}_n.DEFAULT_UP=new $t(0,1,0),_n.DEFAULT_MATRIX_AUTO_UPDATE=!0,_n.DEFAULT_MATRIX_WORLD_AUTO_UPDATE=!0;const xn=new $t,bn=new $t,wn=new $t,Sn=new $t,Mn=new $t,Tn=new $t,En=new $t,An=new $t,Cn=new $t,Ln=new $t;class Rn{constructor(e=new $t,t=new $t,r=new $t){this.a=e,this.b=t,this.c=r}static getNormal(e,t,r,n){n.subVectors(r,t),xn.subVectors(e,t),n.cross(xn);const i=n.lengthSq();return i>0?n.multiplyScalar(1/Math.sqrt(i)):n.set(0,0,0)}static getBarycoord(e,t,r,n,i){xn.subVectors(n,t),bn.subVectors(r,t),wn.subVectors(e,t);const s=xn.dot(xn),o=xn.dot(bn),a=xn.dot(wn),l=bn.dot(bn),c=bn.dot(wn),u=s*l-o*o;if(0===u)return i.set(-2,-1,-1);const h=1/u,d=(l*a-o*c)*h,p=(s*c-o*a)*h;return i.set(1-d-p,p,d)}static containsPoint(e,t,r,n){return this.getBarycoord(e,t,r,n,Sn),Sn.x>=0&&Sn.y>=0&&Sn.x+Sn.y<=1}static getUV(e,t,r,n,i,s,o,a){return this.getBarycoord(e,t,r,n,Sn),a.set(0,0),a.addScaledVector(i,Sn.x),a.addScaledVector(s,Sn.y),a.addScaledVector(o,Sn.z),a}static isFrontFacing(e,t,r,n){return xn.subVectors(r,t),bn.subVectors(e,t),xn.cross(bn).dot(n)<0}set(e,t,r){return this.a.copy(e),this.b.copy(t),this.c.copy(r),this}setFromPointsAndIndices(e,t,r,n){return this.a.copy(e[t]),this.b.copy(e[r]),this.c.copy(e[n]),this}setFromAttributeAndIndices(e,t,r,n){return this.a.fromBufferAttribute(e,t),this.b.fromBufferAttribute(e,r),this.c.fromBufferAttribute(e,n),this}clone(){return(new this.constructor).copy(this)}copy(e){return this.a.copy(e.a),this.b.copy(e.b),this.c.copy(e.c),this}getArea(){return xn.subVectors(this.c,this.b),bn.subVectors(this.a,this.b),.5*xn.cross(bn).length()}getMidpoint(e){return e.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)}getNormal(e){return Rn.getNormal(this.a,this.b,this.c,e)}getPlane(e){return e.setFromCoplanarPoints(this.a,this.b,this.c)}getBarycoord(e,t){return Rn.getBarycoord(e,this.a,this.b,this.c,t)}getUV(e,t,r,n,i){return Rn.getUV(e,this.a,this.b,this.c,t,r,n,i)}containsPoint(e){return Rn.containsPoint(e,this.a,this.b,this.c)}isFrontFacing(e){return Rn.isFrontFacing(this.a,this.b,this.c,e)}intersectsBox(e){return e.intersectsTriangle(this)}closestPointToPoint(e,t){const r=this.a,n=this.b,i=this.c;let s,o;Mn.subVectors(n,r),Tn.subVectors(i,r),An.subVectors(e,r);const a=Mn.dot(An),l=Tn.dot(An);if(a<=0&&l<=0)return t.copy(r);Cn.subVectors(e,n);const c=Mn.dot(Cn),u=Tn.dot(Cn);if(c>=0&&u<=c)return t.copy(n);const h=a*u-c*l;if(h<=0&&a>=0&&c<=0)return s=a/(a-c),t.copy(r).addScaledVector(Mn,s);Ln.subVectors(e,i);const d=Mn.dot(Ln),p=Tn.dot(Ln);if(p>=0&&d<=p)return t.copy(i);const f=d*l-a*p;if(f<=0&&l>=0&&p<=0)return o=l/(l-p),t.copy(r).addScaledVector(Tn,o);const m=c*p-d*u;if(m<=0&&u-c>=0&&d-p>=0)return En.subVectors(i,n),o=(u-c)/(u-c+(d-p)),t.copy(n).addScaledVector(En,o);const g=1/(m+f+h);return s=f*g,o=h*g,t.copy(r).addScaledVector(Mn,s).addScaledVector(Tn,o)}equals(e){return e.a.equals(this.a)&&e.b.equals(this.b)&&e.c.equals(this.c)}}let Pn=0;class jn extends Rt{constructor(){super(),this.isMaterial=!0,Object.defineProperty(this,"id",{value:Pn++}),this.uuid=Ot(),this.name="",this.type="Material",this.blending=p,this.side=c,this.vertexColors=!1,this.opacity=1,this.transparent=!1,this.blendSrc=A,this.blendDst=C,this.blendEquation=v,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.depthFunc=U,this.depthTest=!0,this.depthWrite=!0,this.stencilWriteMask=255,this.stencilFunc=519,this.stencilRef=0,this.stencilFuncMask=255,this.stencilFail=Et,this.stencilZFail=Et,this.stencilZPass=Et,this.stencilWrite=!1,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.shadowSide=null,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.dithering=!1,this.alphaToCoverage=!1,this.premultipliedAlpha=!1,this.forceSinglePass=!1,this.visible=!0,this.toneMapped=!0,this.userData={},this.version=0,this._alphaTest=0}get alphaTest(){return this._alphaTest}set alphaTest(e){this._alphaTest>0!=e>0&&this.version++,this._alphaTest=e}onBuild(){}onBeforeRender(){}onBeforeCompile(){}customProgramCacheKey(){return this.onBeforeCompile.toString()}setValues(e){if(void 0!==e)for(const t in e){const r=e[t];if(void 0===r)continue;const n=this[t];void 0!==n&&(n&&n.isColor?n.set(r):n&&n.isVector3&&r&&r.isVector3?n.copy(r):this[t]=r)}}toJSON(e){const t=void 0===e||"string"==typeof e;t&&(e={textures:{},images:{}});const r={metadata:{version:4.5,type:"Material",generator:"Material.toJSON"}};function n(e){const t=[];for(const r in e){const n=e[r];delete n.metadata,t.push(n)}return t}if(r.uuid=this.uuid,r.type=this.type,""!==this.name&&(r.name=this.name),this.color&&this.color.isColor&&(r.color=this.color.getHex()),void 0!==this.roughness&&(r.roughness=this.roughness),void 0!==this.metalness&&(r.metalness=this.metalness),void 0!==this.sheen&&(r.sheen=this.sheen),this.sheenColor&&this.sheenColor.isColor&&(r.sheenColor=this.sheenColor.getHex()),void 0!==this.sheenRoughness&&(r.sheenRoughness=this.sheenRoughness),this.emissive&&this.emissive.isColor&&(r.emissive=this.emissive.getHex()),this.emissiveIntensity&&1!==this.emissiveIntensity&&(r.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(r.specular=this.specular.getHex()),void 0!==this.specularIntensity&&(r.specularIntensity=this.specularIntensity),this.specularColor&&this.specularColor.isColor&&(r.specularColor=this.specularColor.getHex()),void 0!==this.shininess&&(r.shininess=this.shininess),void 0!==this.clearcoat&&(r.clearcoat=this.clearcoat),void 0!==this.clearcoatRoughness&&(r.clearcoatRoughness=this.clearcoatRoughness),this.clearcoatMap&&this.clearcoatMap.isTexture&&(r.clearcoatMap=this.clearcoatMap.toJSON(e).uuid),this.clearcoatRoughnessMap&&this.clearcoatRoughnessMap.isTexture&&(r.clearcoatRoughnessMap=this.clearcoatRoughnessMap.toJSON(e).uuid),this.clearcoatNormalMap&&this.clearcoatNormalMap.isTexture&&(r.clearcoatNormalMap=this.clearcoatNormalMap.toJSON(e).uuid,r.clearcoatNormalScale=this.clearcoatNormalScale.toArray()),void 0!==this.iridescence&&(r.iridescence=this.iridescence),void 0!==this.iridescenceIOR&&(r.iridescenceIOR=this.iridescenceIOR),void 0!==this.iridescenceThicknessRange&&(r.iridescenceThicknessRange=this.iridescenceThicknessRange),this.iridescenceMap&&this.iridescenceMap.isTexture&&(r.iridescenceMap=this.iridescenceMap.toJSON(e).uuid),this.iridescenceThicknessMap&&this.iridescenceThicknessMap.isTexture&&(r.iridescenceThicknessMap=this.iridescenceThicknessMap.toJSON(e).uuid),this.map&&this.map.isTexture&&(r.map=this.map.toJSON(e).uuid),this.matcap&&this.matcap.isTexture&&(r.matcap=this.matcap.toJSON(e).uuid),this.alphaMap&&this.alphaMap.isTexture&&(r.alphaMap=this.alphaMap.toJSON(e).uuid),this.lightMap&&this.lightMap.isTexture&&(r.lightMap=this.lightMap.toJSON(e).uuid,r.lightMapIntensity=this.lightMapIntensity),this.aoMap&&this.aoMap.isTexture&&(r.aoMap=this.aoMap.toJSON(e).uuid,r.aoMapIntensity=this.aoMapIntensity),this.bumpMap&&this.bumpMap.isTexture&&(r.bumpMap=this.bumpMap.toJSON(e).uuid,r.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(r.normalMap=this.normalMap.toJSON(e).uuid,r.normalMapType=this.normalMapType,r.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(r.displacementMap=this.displacementMap.toJSON(e).uuid,r.displacementScale=this.displacementScale,r.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(r.roughnessMap=this.roughnessMap.toJSON(e).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(r.metalnessMap=this.metalnessMap.toJSON(e).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(r.emissiveMap=this.emissiveMap.toJSON(e).uuid),this.specularMap&&this.specularMap.isTexture&&(r.specularMap=this.specularMap.toJSON(e).uuid),this.specularIntensityMap&&this.specularIntensityMap.isTexture&&(r.specularIntensityMap=this.specularIntensityMap.toJSON(e).uuid),this.specularColorMap&&this.specularColorMap.isTexture&&(r.specularColorMap=this.specularColorMap.toJSON(e).uuid),this.envMap&&this.envMap.isTexture&&(r.envMap=this.envMap.toJSON(e).uuid,void 0!==this.combine&&(r.combine=this.combine)),void 0!==this.envMapIntensity&&(r.envMapIntensity=this.envMapIntensity),void 0!==this.reflectivity&&(r.reflectivity=this.reflectivity),void 0!==this.refractionRatio&&(r.refractionRatio=this.refractionRatio),this.gradientMap&&this.gradientMap.isTexture&&(r.gradientMap=this.gradientMap.toJSON(e).uuid),void 0!==this.transmission&&(r.transmission=this.transmission),this.transmissionMap&&this.transmissionMap.isTexture&&(r.transmissionMap=this.transmissionMap.toJSON(e).uuid),void 0!==this.thickness&&(r.thickness=this.thickness),this.thicknessMap&&this.thicknessMap.isTexture&&(r.thicknessMap=this.thicknessMap.toJSON(e).uuid),void 0!==this.attenuationDistance&&this.attenuationDistance!==1/0&&(r.attenuationDistance=this.attenuationDistance),void 0!==this.attenuationColor&&(r.attenuationColor=this.attenuationColor.getHex()),void 0!==this.size&&(r.size=this.size),null!==this.shadowSide&&(r.shadowSide=this.shadowSide),void 0!==this.sizeAttenuation&&(r.sizeAttenuation=this.sizeAttenuation),this.blending!==p&&(r.blending=this.blending),this.side!==c&&(r.side=this.side),this.vertexColors&&(r.vertexColors=!0),this.opacity<1&&(r.opacity=this.opacity),!0===this.transparent&&(r.transparent=this.transparent),r.depthFunc=this.depthFunc,r.depthTest=this.depthTest,r.depthWrite=this.depthWrite,r.colorWrite=this.colorWrite,r.stencilWrite=this.stencilWrite,r.stencilWriteMask=this.stencilWriteMask,r.stencilFunc=this.stencilFunc,r.stencilRef=this.stencilRef,r.stencilFuncMask=this.stencilFuncMask,r.stencilFail=this.stencilFail,r.stencilZFail=this.stencilZFail,r.stencilZPass=this.stencilZPass,void 0!==this.rotation&&0!==this.rotation&&(r.rotation=this.rotation),!0===this.polygonOffset&&(r.polygonOffset=!0),0!==this.polygonOffsetFactor&&(r.polygonOffsetFactor=this.polygonOffsetFactor),0!==this.polygonOffsetUnits&&(r.polygonOffsetUnits=this.polygonOffsetUnits),void 0!==this.linewidth&&1!==this.linewidth&&(r.linewidth=this.linewidth),void 0!==this.dashSize&&(r.dashSize=this.dashSize),void 0!==this.gapSize&&(r.gapSize=this.gapSize),void 0!==this.scale&&(r.scale=this.scale),!0===this.dithering&&(r.dithering=!0),this.alphaTest>0&&(r.alphaTest=this.alphaTest),!0===this.alphaToCoverage&&(r.alphaToCoverage=this.alphaToCoverage),!0===this.premultipliedAlpha&&(r.premultipliedAlpha=this.premultipliedAlpha),!0===this.forceSinglePass&&(r.forceSinglePass=this.forceSinglePass),!0===this.wireframe&&(r.wireframe=this.wireframe),this.wireframeLinewidth>1&&(r.wireframeLinewidth=this.wireframeLinewidth),"round"!==this.wireframeLinecap&&(r.wireframeLinecap=this.wireframeLinecap),"round"!==this.wireframeLinejoin&&(r.wireframeLinejoin=this.wireframeLinejoin),!0===this.flatShading&&(r.flatShading=this.flatShading),!1===this.visible&&(r.visible=!1),!1===this.toneMapped&&(r.toneMapped=!1),!1===this.fog&&(r.fog=!1),Object.keys(this.userData).length>0&&(r.userData=this.userData),t){const t=n(e.textures),i=n(e.images);t.length>0&&(r.textures=t),i.length>0&&(r.images=i)}return r}clone(){return(new this.constructor).copy(this)}copy(e){this.name=e.name,this.blending=e.blending,this.side=e.side,this.vertexColors=e.vertexColors,this.opacity=e.opacity,this.transparent=e.transparent,this.blendSrc=e.blendSrc,this.blendDst=e.blendDst,this.blendEquation=e.blendEquation,this.blendSrcAlpha=e.blendSrcAlpha,this.blendDstAlpha=e.blendDstAlpha,this.blendEquationAlpha=e.blendEquationAlpha,this.depthFunc=e.depthFunc,this.depthTest=e.depthTest,this.depthWrite=e.depthWrite,this.stencilWriteMask=e.stencilWriteMask,this.stencilFunc=e.stencilFunc,this.stencilRef=e.stencilRef,this.stencilFuncMask=e.stencilFuncMask,this.stencilFail=e.stencilFail,this.stencilZFail=e.stencilZFail,this.stencilZPass=e.stencilZPass,this.stencilWrite=e.stencilWrite;const t=e.clippingPlanes;let r=null;if(null!==t){const e=t.length;r=new Array(e);for(let n=0;n!==e;++n)r[n]=t[n].clone()}return this.clippingPlanes=r,this.clipIntersection=e.clipIntersection,this.clipShadows=e.clipShadows,this.shadowSide=e.shadowSide,this.colorWrite=e.colorWrite,this.precision=e.precision,this.polygonOffset=e.polygonOffset,this.polygonOffsetFactor=e.polygonOffsetFactor,this.polygonOffsetUnits=e.polygonOffsetUnits,this.dithering=e.dithering,this.alphaTest=e.alphaTest,this.alphaToCoverage=e.alphaToCoverage,this.premultipliedAlpha=e.premultipliedAlpha,this.forceSinglePass=e.forceSinglePass,this.visible=e.visible,this.toneMapped=e.toneMapped,this.userData=JSON.parse(JSON.stringify(e.userData)),this}dispose(){this.dispatchEvent({type:"dispose"})}set needsUpdate(e){!0===e&&this.version++}}const In={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},Dn={h:0,s:0,l:0},On={h:0,s:0,l:0};function Nn(e,t,r){return r<0&&(r+=1),r>1&&(r-=1),r<1/6?e+6*(t-e)*r:r<.5?t:r<2/3?e+6*(t-e)*(2/3-r):e}class Un{constructor(e,t,r){return this.isColor=!0,this.r=1,this.g=1,this.b=1,void 0===t&&void 0===r?this.set(e):this.setRGB(e,t,r)}set(e){return e&&e.isColor?this.copy(e):"number"==typeof e?this.setHex(e):"string"==typeof e&&this.setStyle(e),this}setScalar(e){return this.r=e,this.g=e,this.b=e,this}setHex(e,t=St){return e=Math.floor(e),this.r=(e>>16&255)/255,this.g=(e>>8&255)/255,this.b=(255&e)/255,cr.toWorkingColorSpace(this,t),this}setRGB(e,t,r,n=cr.workingColorSpace){return this.r=e,this.g=t,this.b=r,cr.toWorkingColorSpace(this,n),this}setHSL(e,t,r,n=cr.workingColorSpace){if(e=Ut(e,1),t=Nt(t,0,1),r=Nt(r,0,1),0===t)this.r=this.g=this.b=r;else{const n=r<=.5?r*(1+t):r+t-r*t,i=2*r-n;this.r=Nn(i,n,e+1/3),this.g=Nn(i,n,e),this.b=Nn(i,n,e-1/3)}return cr.toWorkingColorSpace(this,n),this}setStyle(e,t=St){function r(e){void 0!==e&&parseFloat(e)}let n;if(n=/^(\w+)\(([^\)]*)\)/.exec(e)){let e;const i=n[1],s=n[2];switch(i){case"rgb":case"rgba":if(e=/^\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(s))return this.r=Math.min(255,parseInt(e[1],10))/255,this.g=Math.min(255,parseInt(e[2],10))/255,this.b=Math.min(255,parseInt(e[3],10))/255,cr.toWorkingColorSpace(this,t),r(e[4]),this;if(e=/^\s*(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(s))return this.r=Math.min(100,parseInt(e[1],10))/100,this.g=Math.min(100,parseInt(e[2],10))/100,this.b=Math.min(100,parseInt(e[3],10))/100,cr.toWorkingColorSpace(this,t),r(e[4]),this;break;case"hsl":case"hsla":if(e=/^\s*(\d*\.?\d+)\s*,\s*(\d*\.?\d+)\%\s*,\s*(\d*\.?\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(s)){const n=parseFloat(e[1])/360,i=parseFloat(e[2])/100,s=parseFloat(e[3])/100;return r(e[4]),this.setHSL(n,i,s,t)}}}else if(n=/^\#([A-Fa-f\d]+)$/.exec(e)){const e=n[1],r=e.length;if(3===r)return this.r=parseInt(e.charAt(0)+e.charAt(0),16)/255,this.g=parseInt(e.charAt(1)+e.charAt(1),16)/255,this.b=parseInt(e.charAt(2)+e.charAt(2),16)/255,cr.toWorkingColorSpace(this,t),this;if(6===r)return this.r=parseInt(e.charAt(0)+e.charAt(1),16)/255,this.g=parseInt(e.charAt(2)+e.charAt(3),16)/255,this.b=parseInt(e.charAt(4)+e.charAt(5),16)/255,cr.toWorkingColorSpace(this,t),this}else if(e&&e.length>0)return this.setColorName(e,t);return this}setColorName(e,t=St){const r=In[e.toLowerCase()];return void 0!==r&&this.setHex(r,t),this}clone(){return new this.constructor(this.r,this.g,this.b)}copy(e){return this.r=e.r,this.g=e.g,this.b=e.b,this}copySRGBToLinear(e){return this.r=rr(e.r),this.g=rr(e.g),this.b=rr(e.b),this}copyLinearToSRGB(e){return this.r=nr(e.r),this.g=nr(e.g),this.b=nr(e.b),this}convertSRGBToLinear(){return this.copySRGBToLinear(this),this}convertLinearToSRGB(){return this.copyLinearToSRGB(this),this}getHex(e=St){return cr.fromWorkingColorSpace(kn.copy(this),e),Nt(255*kn.r,0,255)<<16^Nt(255*kn.g,0,255)<<8^Nt(255*kn.b,0,255)<<0}getHexString(e=St){return("000000"+this.getHex(e).toString(16)).slice(-6)}getHSL(e,t=cr.workingColorSpace){cr.fromWorkingColorSpace(kn.copy(this),t);const r=kn.r,n=kn.g,i=kn.b,s=Math.max(r,n,i),o=Math.min(r,n,i);let a,l;const c=(o+s)/2;if(o===s)a=0,l=0;else{const e=s-o;switch(l=c<=.5?e/(s+o):e/(2-s-o),s){case r:a=(n-i)/e+(n<i?6:0);break;case n:a=(i-r)/e+2;break;case i:a=(r-n)/e+4}a/=6}return e.h=a,e.s=l,e.l=c,e}getRGB(e,t=cr.workingColorSpace){return cr.fromWorkingColorSpace(kn.copy(this),t),e.r=kn.r,e.g=kn.g,e.b=kn.b,e}getStyle(e=St){cr.fromWorkingColorSpace(kn.copy(this),e);const t=kn.r,r=kn.g,n=kn.b;return e!==St?`color(${e} ${t.toFixed(3)} ${r.toFixed(3)} ${n.toFixed(3)})`:`rgb(${255*t|0},${255*r|0},${255*n|0})`}offsetHSL(e,t,r){return this.getHSL(Dn),Dn.h+=e,Dn.s+=t,Dn.l+=r,this.setHSL(Dn.h,Dn.s,Dn.l),this}add(e){return this.r+=e.r,this.g+=e.g,this.b+=e.b,this}addColors(e,t){return this.r=e.r+t.r,this.g=e.g+t.g,this.b=e.b+t.b,this}addScalar(e){return this.r+=e,this.g+=e,this.b+=e,this}sub(e){return this.r=Math.max(0,this.r-e.r),this.g=Math.max(0,this.g-e.g),this.b=Math.max(0,this.b-e.b),this}multiply(e){return this.r*=e.r,this.g*=e.g,this.b*=e.b,this}multiplyScalar(e){return this.r*=e,this.g*=e,this.b*=e,this}lerp(e,t){return this.r+=(e.r-this.r)*t,this.g+=(e.g-this.g)*t,this.b+=(e.b-this.b)*t,this}lerpColors(e,t,r){return this.r=e.r+(t.r-e.r)*r,this.g=e.g+(t.g-e.g)*r,this.b=e.b+(t.b-e.b)*r,this}lerpHSL(e,t){this.getHSL(Dn),e.getHSL(On);const r=kt(Dn.h,On.h,t),n=kt(Dn.s,On.s,t),i=kt(Dn.l,On.l,t);return this.setHSL(r,n,i),this}equals(e){return e.r===this.r&&e.g===this.g&&e.b===this.b}fromArray(e,t=0){return this.r=e[t],this.g=e[t+1],this.b=e[t+2],this}toArray(e=[],t=0){return e[t]=this.r,e[t+1]=this.g,e[t+2]=this.b,e}fromBufferAttribute(e,t){return this.r=e.getX(t),this.g=e.getY(t),this.b=e.getZ(t),this}toJSON(){return this.getHex()}*[Symbol.iterator](){yield this.r,yield this.g,yield this.b}}const kn=new Un;Un.NAMES=In;class Fn extends jn{constructor(e){super(),this.isMeshBasicMaterial=!0,this.type="MeshBasicMaterial",this.color=new Un(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=G,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.fog=e.fog,this}}const Bn=new $t,zn=new Wt;class Gn{constructor(e,t,r=!1){if(Array.isArray(e))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.isBufferAttribute=!0,this.name="",this.array=e,this.itemSize=t,this.count=void 0!==e?e.length/t:0,this.normalized=r,this.usage=At,this.updateRange={offset:0,count:-1},this.version=0}onUploadCallback(){}set needsUpdate(e){!0===e&&this.version++}setUsage(e){return this.usage=e,this}copy(e){return this.name=e.name,this.array=new e.array.constructor(e.array),this.itemSize=e.itemSize,this.count=e.count,this.normalized=e.normalized,this.usage=e.usage,this}copyAt(e,t,r){e*=this.itemSize,r*=t.itemSize;for(let n=0,i=this.itemSize;n<i;n++)this.array[e+n]=t.array[r+n];return this}copyArray(e){return this.array.set(e),this}applyMatrix3(e){if(2===this.itemSize)for(let t=0,r=this.count;t<r;t++)zn.fromBufferAttribute(this,t),zn.applyMatrix3(e),this.setXY(t,zn.x,zn.y);else if(3===this.itemSize)for(let t=0,r=this.count;t<r;t++)Bn.fromBufferAttribute(this,t),Bn.applyMatrix3(e),this.setXYZ(t,Bn.x,Bn.y,Bn.z);return this}applyMatrix4(e){for(let t=0,r=this.count;t<r;t++)Bn.fromBufferAttribute(this,t),Bn.applyMatrix4(e),this.setXYZ(t,Bn.x,Bn.y,Bn.z);return this}applyNormalMatrix(e){for(let t=0,r=this.count;t<r;t++)Bn.fromBufferAttribute(this,t),Bn.applyNormalMatrix(e),this.setXYZ(t,Bn.x,Bn.y,Bn.z);return this}transformDirection(e){for(let t=0,r=this.count;t<r;t++)Bn.fromBufferAttribute(this,t),Bn.transformDirection(e),this.setXYZ(t,Bn.x,Bn.y,Bn.z);return this}set(e,t=0){return this.array.set(e,t),this}getX(e){let t=this.array[e*this.itemSize];return this.normalized&&(t=Gt(t,this.array)),t}setX(e,t){return this.normalized&&(t=Vt(t,this.array)),this.array[e*this.itemSize]=t,this}getY(e){let t=this.array[e*this.itemSize+1];return this.normalized&&(t=Gt(t,this.array)),t}setY(e,t){return this.normalized&&(t=Vt(t,this.array)),this.array[e*this.itemSize+1]=t,this}getZ(e){let t=this.array[e*this.itemSize+2];return this.normalized&&(t=Gt(t,this.array)),t}setZ(e,t){return this.normalized&&(t=Vt(t,this.array)),this.array[e*this.itemSize+2]=t,this}getW(e){let t=this.array[e*this.itemSize+3];return this.normalized&&(t=Gt(t,this.array)),t}setW(e,t){return this.normalized&&(t=Vt(t,this.array)),this.array[e*this.itemSize+3]=t,this}setXY(e,t,r){return e*=this.itemSize,this.normalized&&(t=Vt(t,this.array),r=Vt(r,this.array)),this.array[e+0]=t,this.array[e+1]=r,this}setXYZ(e,t,r,n){return e*=this.itemSize,this.normalized&&(t=Vt(t,this.array),r=Vt(r,this.array),n=Vt(n,this.array)),this.array[e+0]=t,this.array[e+1]=r,this.array[e+2]=n,this}setXYZW(e,t,r,n,i){return e*=this.itemSize,this.normalized&&(t=Vt(t,this.array),r=Vt(r,this.array),n=Vt(n,this.array),i=Vt(i,this.array)),this.array[e+0]=t,this.array[e+1]=r,this.array[e+2]=n,this.array[e+3]=i,this}onUpload(e){return this.onUploadCallback=e,this}clone(){return new this.constructor(this.array,this.itemSize).copy(this)}toJSON(){const e={itemSize:this.itemSize,type:this.array.constructor.name,array:Array.from(this.array),normalized:this.normalized};return""!==this.name&&(e.name=this.name),this.usage!==At&&(e.usage=this.usage),0===this.updateRange.offset&&-1===this.updateRange.count||(e.updateRange=this.updateRange),e}copyColorsArray(){}copyVector2sArray(){}copyVector3sArray(){}copyVector4sArray(){}}class Vn extends Gn{constructor(e,t,r){super(new Uint16Array(e),t,r)}}class Hn extends Gn{constructor(e,t,r){super(new Uint32Array(e),t,r)}}class Wn extends Gn{constructor(e,t,r){super(new Float32Array(e),t,r)}}let Xn=0;const qn=new qr,Yn=new _n,Zn=new $t,Jn=new xr,Kn=new xr,Qn=new $t;class $n extends Rt{constructor(){super(),this.isBufferGeometry=!0,Object.defineProperty(this,"id",{value:Xn++}),this.uuid=Ot(),this.name="",this.type="BufferGeometry",this.index=null,this.attributes={},this.morphAttributes={},this.morphTargetsRelative=!1,this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0},this.userData={}}getIndex(){return this.index}setIndex(e){return Array.isArray(e)?this.index=new(Yt(e)?Hn:Vn)(e,1):this.index=e,this}getAttribute(e){return this.attributes[e]}setAttribute(e,t){return this.attributes[e]=t,this}deleteAttribute(e){return delete this.attributes[e],this}hasAttribute(e){return void 0!==this.attributes[e]}addGroup(e,t,r=0){this.groups.push({start:e,count:t,materialIndex:r})}clearGroups(){this.groups=[]}setDrawRange(e,t){this.drawRange.start=e,this.drawRange.count=t}applyMatrix4(e){const t=this.attributes.position;void 0!==t&&(t.applyMatrix4(e),t.needsUpdate=!0);const r=this.attributes.normal;if(void 0!==r){const t=(new Xt).getNormalMatrix(e);r.applyNormalMatrix(t),r.needsUpdate=!0}const n=this.attributes.tangent;return void 0!==n&&(n.transformDirection(e),n.needsUpdate=!0),null!==this.boundingBox&&this.computeBoundingBox(),null!==this.boundingSphere&&this.computeBoundingSphere(),this}applyQuaternion(e){return qn.makeRotationFromQuaternion(e),this.applyMatrix4(qn),this}rotateX(e){return qn.makeRotationX(e),this.applyMatrix4(qn),this}rotateY(e){return qn.makeRotationY(e),this.applyMatrix4(qn),this}rotateZ(e){return qn.makeRotationZ(e),this.applyMatrix4(qn),this}translate(e,t,r){return qn.makeTranslation(e,t,r),this.applyMatrix4(qn),this}scale(e,t,r){return qn.makeScale(e,t,r),this.applyMatrix4(qn),this}lookAt(e){return Yn.lookAt(e),Yn.updateMatrix(),this.applyMatrix4(Yn.matrix),this}center(){return this.computeBoundingBox(),this.boundingBox.getCenter(Zn).negate(),this.translate(Zn.x,Zn.y,Zn.z),this}setFromPoints(e){const t=[];for(let r=0,n=e.length;r<n;r++){const n=e[r];t.push(n.x,n.y,n.z||0)}return this.setAttribute("position",new Wn(t,3)),this}computeBoundingBox(){null===this.boundingBox&&(this.boundingBox=new xr);const e=this.attributes.position,t=this.morphAttributes.position;if(e&&e.isGLBufferAttribute)this.boundingBox.set(new $t(-1/0,-1/0,-1/0),new $t(1/0,1/0,1/0));else{if(void 0!==e){if(this.boundingBox.setFromBufferAttribute(e),t)for(let e=0,r=t.length;e<r;e++){const r=t[e];Jn.setFromBufferAttribute(r),this.morphTargetsRelative?(Qn.addVectors(this.boundingBox.min,Jn.min),this.boundingBox.expandByPoint(Qn),Qn.addVectors(this.boundingBox.max,Jn.max),this.boundingBox.expandByPoint(Qn)):(this.boundingBox.expandByPoint(Jn.min),this.boundingBox.expandByPoint(Jn.max))}}else this.boundingBox.makeEmpty();isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z)}}computeBoundingSphere(){null===this.boundingSphere&&(this.boundingSphere=new kr);const e=this.attributes.position,t=this.morphAttributes.position;if(e&&e.isGLBufferAttribute)this.boundingSphere.set(new $t,1/0);else if(e){const r=this.boundingSphere.center;if(Jn.setFromBufferAttribute(e),t)for(let e=0,r=t.length;e<r;e++){const r=t[e];Kn.setFromBufferAttribute(r),this.morphTargetsRelative?(Qn.addVectors(Jn.min,Kn.min),Jn.expandByPoint(Qn),Qn.addVectors(Jn.max,Kn.max),Jn.expandByPoint(Qn)):(Jn.expandByPoint(Kn.min),Jn.expandByPoint(Kn.max))}Jn.getCenter(r);let n=0;for(let t=0,i=e.count;t<i;t++)Qn.fromBufferAttribute(e,t),n=Math.max(n,r.distanceToSquared(Qn));if(t)for(let i=0,s=t.length;i<s;i++){const s=t[i],o=this.morphTargetsRelative;for(let t=0,i=s.count;t<i;t++)Qn.fromBufferAttribute(s,t),o&&(Zn.fromBufferAttribute(e,t),Qn.add(Zn)),n=Math.max(n,r.distanceToSquared(Qn))}this.boundingSphere.radius=Math.sqrt(n),isNaN(this.boundingSphere.radius)}}computeTangents(){const e=this.index,t=this.attributes;if(null===e||void 0===t.position||void 0===t.normal||void 0===t.uv)return;const r=e.array,n=t.position.array,i=t.normal.array,s=t.uv.array,o=n.length/3;!1===this.hasAttribute("tangent")&&this.setAttribute("tangent",new Gn(new Float32Array(4*o),4));const a=this.getAttribute("tangent").array,l=[],c=[];for(let e=0;e<o;e++)l[e]=new $t,c[e]=new $t;const u=new $t,h=new $t,d=new $t,p=new Wt,f=new Wt,m=new Wt,g=new $t,y=new $t;function v(e,t,r){u.fromArray(n,3*e),h.fromArray(n,3*t),d.fromArray(n,3*r),p.fromArray(s,2*e),f.fromArray(s,2*t),m.fromArray(s,2*r),h.sub(u),d.sub(u),f.sub(p),m.sub(p);const i=1/(f.x*m.y-m.x*f.y);isFinite(i)&&(g.copy(h).multiplyScalar(m.y).addScaledVector(d,-f.y).multiplyScalar(i),y.copy(d).multiplyScalar(f.x).addScaledVector(h,-m.x).multiplyScalar(i),l[e].add(g),l[t].add(g),l[r].add(g),c[e].add(y),c[t].add(y),c[r].add(y))}let _=this.groups;0===_.length&&(_=[{start:0,count:r.length}]);for(let e=0,t=_.length;e<t;++e){const t=_[e],n=t.start;for(let e=n,i=n+t.count;e<i;e+=3)v(r[e+0],r[e+1],r[e+2])}const x=new $t,b=new $t,w=new $t,S=new $t;function M(e){w.fromArray(i,3*e),S.copy(w);const t=l[e];x.copy(t),x.sub(w.multiplyScalar(w.dot(t))).normalize(),b.crossVectors(S,t);const r=b.dot(c[e])<0?-1:1;a[4*e]=x.x,a[4*e+1]=x.y,a[4*e+2]=x.z,a[4*e+3]=r}for(let e=0,t=_.length;e<t;++e){const t=_[e],n=t.start;for(let e=n,i=n+t.count;e<i;e+=3)M(r[e+0]),M(r[e+1]),M(r[e+2])}}computeVertexNormals(){const e=this.index,t=this.getAttribute("position");if(void 0!==t){let r=this.getAttribute("normal");if(void 0===r)r=new Gn(new Float32Array(3*t.count),3),this.setAttribute("normal",r);else for(let e=0,t=r.count;e<t;e++)r.setXYZ(e,0,0,0);const n=new $t,i=new $t,s=new $t,o=new $t,a=new $t,l=new $t,c=new $t,u=new $t;if(e)for(let h=0,d=e.count;h<d;h+=3){const d=e.getX(h+0),p=e.getX(h+1),f=e.getX(h+2);n.fromBufferAttribute(t,d),i.fromBufferAttribute(t,p),s.fromBufferAttribute(t,f),c.subVectors(s,i),u.subVectors(n,i),c.cross(u),o.fromBufferAttribute(r,d),a.fromBufferAttribute(r,p),l.fromBufferAttribute(r,f),o.add(c),a.add(c),l.add(c),r.setXYZ(d,o.x,o.y,o.z),r.setXYZ(p,a.x,a.y,a.z),r.setXYZ(f,l.x,l.y,l.z)}else for(let e=0,o=t.count;e<o;e+=3)n.fromBufferAttribute(t,e+0),i.fromBufferAttribute(t,e+1),s.fromBufferAttribute(t,e+2),c.subVectors(s,i),u.subVectors(n,i),c.cross(u),r.setXYZ(e+0,c.x,c.y,c.z),r.setXYZ(e+1,c.x,c.y,c.z),r.setXYZ(e+2,c.x,c.y,c.z);this.normalizeNormals(),r.needsUpdate=!0}}merge(){return this}normalizeNormals(){const e=this.attributes.normal;for(let t=0,r=e.count;t<r;t++)Qn.fromBufferAttribute(e,t),Qn.normalize(),e.setXYZ(t,Qn.x,Qn.y,Qn.z)}toNonIndexed(){function e(e,t){const r=e.array,n=e.itemSize,i=e.normalized,s=new r.constructor(t.length*n);let o=0,a=0;for(let i=0,l=t.length;i<l;i++){o=e.isInterleavedBufferAttribute?t[i]*e.data.stride+e.offset:t[i]*n;for(let e=0;e<n;e++)s[a++]=r[o++]}return new Gn(s,n,i)}if(null===this.index)return this;const t=new $n,r=this.index.array,n=this.attributes;for(const i in n){const s=e(n[i],r);t.setAttribute(i,s)}const i=this.morphAttributes;for(const n in i){const s=[],o=i[n];for(let t=0,n=o.length;t<n;t++){const n=e(o[t],r);s.push(n)}t.morphAttributes[n]=s}t.morphTargetsRelative=this.morphTargetsRelative;const s=this.groups;for(let e=0,r=s.length;e<r;e++){const r=s[e];t.addGroup(r.start,r.count,r.materialIndex)}return t}toJSON(){const e={metadata:{version:4.5,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(e.uuid=this.uuid,e.type=this.type,""!==this.name&&(e.name=this.name),Object.keys(this.userData).length>0&&(e.userData=this.userData),void 0!==this.parameters){const t=this.parameters;for(const r in t)void 0!==t[r]&&(e[r]=t[r]);return e}e.data={attributes:{}};const t=this.index;null!==t&&(e.data.index={type:t.array.constructor.name,array:Array.prototype.slice.call(t.array)});const r=this.attributes;for(const t in r){const n=r[t];e.data.attributes[t]=n.toJSON(e.data)}const n={};let i=!1;for(const t in this.morphAttributes){const r=this.morphAttributes[t],s=[];for(let t=0,n=r.length;t<n;t++){const n=r[t];s.push(n.toJSON(e.data))}s.length>0&&(n[t]=s,i=!0)}i&&(e.data.morphAttributes=n,e.data.morphTargetsRelative=this.morphTargetsRelative);const s=this.groups;s.length>0&&(e.data.groups=JSON.parse(JSON.stringify(s)));const o=this.boundingSphere;return null!==o&&(e.data.boundingSphere={center:o.center.toArray(),radius:o.radius}),e}clone(){return(new this.constructor).copy(this)}copy(e){this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null;const t={};this.name=e.name;const r=e.index;null!==r&&this.setIndex(r.clone(t));const n=e.attributes;for(const e in n){const r=n[e];this.setAttribute(e,r.clone(t))}const i=e.morphAttributes;for(const e in i){const r=[],n=i[e];for(let e=0,i=n.length;e<i;e++)r.push(n[e].clone(t));this.morphAttributes[e]=r}this.morphTargetsRelative=e.morphTargetsRelative;const s=e.groups;for(let e=0,t=s.length;e<t;e++){const t=s[e];this.addGroup(t.start,t.count,t.materialIndex)}const o=e.boundingBox;null!==o&&(this.boundingBox=o.clone());const a=e.boundingSphere;return null!==a&&(this.boundingSphere=a.clone()),this.drawRange.start=e.drawRange.start,this.drawRange.count=e.drawRange.count,this.userData=e.userData,this}dispose(){this.dispatchEvent({type:"dispose"})}}const ei=new qr,ti=new Xr,ri=new kr,ni=new $t,ii=new $t,si=new $t,oi=new $t,ai=new $t,li=new $t,ci=new Wt,ui=new Wt,hi=new Wt,di=new $t,pi=new $t;class fi extends _n{constructor(e=new $n,t=new Fn){super(),this.isMesh=!0,this.type="Mesh",this.geometry=e,this.material=t,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),void 0!==e.morphTargetInfluences&&(this.morphTargetInfluences=e.morphTargetInfluences.slice()),void 0!==e.morphTargetDictionary&&(this.morphTargetDictionary=Object.assign({},e.morphTargetDictionary)),this.material=e.material,this.geometry=e.geometry,this}updateMorphTargets(){const e=this.geometry.morphAttributes,t=Object.keys(e);if(t.length>0){const r=e[t[0]];if(void 0!==r){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let e=0,t=r.length;e<t;e++){const t=r[e].name||String(e);this.morphTargetInfluences.push(0),this.morphTargetDictionary[t]=e}}}}getVertexPosition(e,t){const r=this.geometry,n=r.attributes.position,i=r.morphAttributes.position,s=r.morphTargetsRelative;t.fromBufferAttribute(n,e);const o=this.morphTargetInfluences;if(i&&o){li.set(0,0,0);for(let r=0,n=i.length;r<n;r++){const n=o[r],a=i[r];0!==n&&(ai.fromBufferAttribute(a,e),s?li.addScaledVector(ai,n):li.addScaledVector(ai.sub(t),n))}t.add(li)}return this.isSkinnedMesh&&this.boneTransform(e,t),t}raycast(e,t){const r=this.geometry,n=this.material,i=this.matrixWorld;if(void 0===n)return;if(null===r.boundingSphere&&r.computeBoundingSphere(),ri.copy(r.boundingSphere),ri.applyMatrix4(i),ti.copy(e.ray).recast(e.near),!1===ri.containsPoint(ti.origin)){if(null===ti.intersectSphere(ri,ni))return;if(ti.origin.distanceToSquared(ni)>(e.far-e.near)**2)return}if(ei.copy(i).invert(),ti.copy(e.ray).applyMatrix4(ei),null!==r.boundingBox&&!1===ti.intersectsBox(r.boundingBox))return;let s;const o=r.index,a=r.attributes.position,l=r.attributes.uv,c=r.attributes.uv2,u=r.groups,h=r.drawRange;if(null!==o)if(Array.isArray(n))for(let r=0,i=u.length;r<i;r++){const i=u[r],a=n[i.materialIndex];for(let r=Math.max(i.start,h.start),n=Math.min(o.count,Math.min(i.start+i.count,h.start+h.count));r<n;r+=3){const n=o.getX(r),u=o.getX(r+1),h=o.getX(r+2);s=mi(this,a,e,ti,l,c,n,u,h),s&&(s.faceIndex=Math.floor(r/3),s.face.materialIndex=i.materialIndex,t.push(s))}}else{for(let r=Math.max(0,h.start),i=Math.min(o.count,h.start+h.count);r<i;r+=3){const i=o.getX(r),a=o.getX(r+1),u=o.getX(r+2);s=mi(this,n,e,ti,l,c,i,a,u),s&&(s.faceIndex=Math.floor(r/3),t.push(s))}}else if(void 0!==a)if(Array.isArray(n))for(let r=0,i=u.length;r<i;r++){const i=u[r],o=n[i.materialIndex];for(let r=Math.max(i.start,h.start),n=Math.min(a.count,Math.min(i.start+i.count,h.start+h.count));r<n;r+=3){s=mi(this,o,e,ti,l,c,r,r+1,r+2),s&&(s.faceIndex=Math.floor(r/3),s.face.materialIndex=i.materialIndex,t.push(s))}}else{for(let r=Math.max(0,h.start),i=Math.min(a.count,h.start+h.count);r<i;r+=3){s=mi(this,n,e,ti,l,c,r,r+1,r+2),s&&(s.faceIndex=Math.floor(r/3),t.push(s))}}}}function mi(e,t,r,n,i,s,o,a,l){e.getVertexPosition(o,ii),e.getVertexPosition(a,si),e.getVertexPosition(l,oi);const h=function(e,t,r,n,i,s,o,a){let l;if(l=t.side===u?n.intersectTriangle(o,s,i,!0,a):n.intersectTriangle(i,s,o,t.side===c,a),null===l)return null;pi.copy(a),pi.applyMatrix4(e.matrixWorld);const h=r.ray.origin.distanceTo(pi);return h<r.near||h>r.far?null:{distance:h,point:pi.clone(),object:e}}(e,t,r,n,ii,si,oi,di);if(h){i&&(ci.fromBufferAttribute(i,o),ui.fromBufferAttribute(i,a),hi.fromBufferAttribute(i,l),h.uv=Rn.getUV(di,ii,si,oi,ci,ui,hi,new Wt)),s&&(ci.fromBufferAttribute(s,o),ui.fromBufferAttribute(s,a),hi.fromBufferAttribute(s,l),h.uv2=Rn.getUV(di,ii,si,oi,ci,ui,hi,new Wt));const e={a:o,b:a,c:l,normal:new $t,materialIndex:0};Rn.getNormal(ii,si,oi,e.normal),h.face=e}return h}class gi extends $n{constructor(e=1,t=1,r=1,n=1,i=1,s=1){super(),this.type="BoxGeometry",this.parameters={width:e,height:t,depth:r,widthSegments:n,heightSegments:i,depthSegments:s};const o=this;n=Math.floor(n),i=Math.floor(i),s=Math.floor(s);const a=[],l=[],c=[],u=[];let h=0,d=0;function p(e,t,r,n,i,s,p,f,m,g,y){const v=s/m,_=p/g,x=s/2,b=p/2,w=f/2,S=m+1,M=g+1;let T=0,E=0;const A=new $t;for(let s=0;s<M;s++){const o=s*_-b;for(let a=0;a<S;a++){const h=a*v-x;A[e]=h*n,A[t]=o*i,A[r]=w,l.push(A.x,A.y,A.z),A[e]=0,A[t]=0,A[r]=f>0?1:-1,c.push(A.x,A.y,A.z),u.push(a/m),u.push(1-s/g),T+=1}}for(let e=0;e<g;e++)for(let t=0;t<m;t++){const r=h+t+S*e,n=h+t+S*(e+1),i=h+(t+1)+S*(e+1),s=h+(t+1)+S*e;a.push(r,n,s),a.push(n,i,s),E+=6}o.addGroup(d,E,y),d+=E,h+=T}p("z","y","x",-1,-1,r,t,e,s,i,0),p("z","y","x",1,-1,r,t,-e,s,i,1),p("x","z","y",1,1,e,r,t,n,s,2),p("x","z","y",1,-1,e,r,-t,n,s,3),p("x","y","z",1,-1,e,t,r,n,i,4),p("x","y","z",-1,-1,e,t,-r,n,i,5),this.setIndex(a),this.setAttribute("position",new Wn(l,3)),this.setAttribute("normal",new Wn(c,3)),this.setAttribute("uv",new Wn(u,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new gi(e.width,e.height,e.depth,e.widthSegments,e.heightSegments,e.depthSegments)}}function yi(e){const t={};for(const r in e){t[r]={};for(const n in e[r]){const i=e[r][n];i&&(i.isColor||i.isMatrix3||i.isMatrix4||i.isVector2||i.isVector3||i.isVector4||i.isTexture||i.isQuaternion)?t[r][n]=i.clone():Array.isArray(i)?t[r][n]=i.slice():t[r][n]=i}}return t}function vi(e){const t={};for(let r=0;r<e.length;r++){const n=yi(e[r]);for(const e in n)t[e]=n[e]}return t}function _i(e){return null===e.getRenderTarget()&&e.outputEncoding===_t?St:Mt}const xi={clone:yi,merge:vi};class bi extends jn{constructor(e){super(),this.isShaderMaterial=!0,this.type="ShaderMaterial",this.defines={},this.uniforms={},this.uniformsGroups=[],this.vertexShader="void main() {\n\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}",this.fragmentShader="void main() {\n\tgl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );\n}",this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.clipping=!1,this.extensions={derivatives:!1,fragDepth:!1,drawBuffers:!1,shaderTextureLOD:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv2:[0,0]},this.index0AttributeName=void 0,this.uniformsNeedUpdate=!1,this.glslVersion=null,void 0!==e&&this.setValues(e)}copy(e){return super.copy(e),this.fragmentShader=e.fragmentShader,this.vertexShader=e.vertexShader,this.uniforms=yi(e.uniforms),this.uniformsGroups=function(e){const t=[];for(let r=0;r<e.length;r++)t.push(e[r].clone());return t}(e.uniformsGroups),this.defines=Object.assign({},e.defines),this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.fog=e.fog,this.lights=e.lights,this.clipping=e.clipping,this.extensions=Object.assign({},e.extensions),this.glslVersion=e.glslVersion,this}toJSON(e){const t=super.toJSON(e);t.glslVersion=this.glslVersion,t.uniforms={};for(const r in this.uniforms){const n=this.uniforms[r].value;n&&n.isTexture?t.uniforms[r]={type:"t",value:n.toJSON(e).uuid}:n&&n.isColor?t.uniforms[r]={type:"c",value:n.getHex()}:n&&n.isVector2?t.uniforms[r]={type:"v2",value:n.toArray()}:n&&n.isVector3?t.uniforms[r]={type:"v3",value:n.toArray()}:n&&n.isVector4?t.uniforms[r]={type:"v4",value:n.toArray()}:n&&n.isMatrix3?t.uniforms[r]={type:"m3",value:n.toArray()}:n&&n.isMatrix4?t.uniforms[r]={type:"m4",value:n.toArray()}:t.uniforms[r]={value:n}}Object.keys(this.defines).length>0&&(t.defines=this.defines),t.vertexShader=this.vertexShader,t.fragmentShader=this.fragmentShader;const r={};for(const e in this.extensions)!0===this.extensions[e]&&(r[e]=!0);return Object.keys(r).length>0&&(t.extensions=r),t}}class wi extends _n{constructor(){super(),this.isCamera=!0,this.type="Camera",this.matrixWorldInverse=new qr,this.projectionMatrix=new qr,this.projectionMatrixInverse=new qr}copy(e,t){return super.copy(e,t),this.matrixWorldInverse.copy(e.matrixWorldInverse),this.projectionMatrix.copy(e.projectionMatrix),this.projectionMatrixInverse.copy(e.projectionMatrixInverse),this}getWorldDirection(e){this.updateWorldMatrix(!0,!1);const t=this.matrixWorld.elements;return e.set(-t[8],-t[9],-t[10]).normalize()}updateMatrixWorld(e){super.updateMatrixWorld(e),this.matrixWorldInverse.copy(this.matrixWorld).invert()}updateWorldMatrix(e,t){super.updateWorldMatrix(e,t),this.matrixWorldInverse.copy(this.matrixWorld).invert()}clone(){return(new this.constructor).copy(this)}}class Si extends wi{constructor(e=50,t=1,r=.1,n=2e3){super(),this.isPerspectiveCamera=!0,this.type="PerspectiveCamera",this.fov=e,this.zoom=1,this.near=r,this.far=n,this.focus=10,this.aspect=t,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}copy(e,t){return super.copy(e,t),this.fov=e.fov,this.zoom=e.zoom,this.near=e.near,this.far=e.far,this.focus=e.focus,this.aspect=e.aspect,this.view=null===e.view?null:Object.assign({},e.view),this.filmGauge=e.filmGauge,this.filmOffset=e.filmOffset,this}setFocalLength(e){const t=.5*this.getFilmHeight()/e;this.fov=2*Dt*Math.atan(t),this.updateProjectionMatrix()}getFocalLength(){const e=Math.tan(.5*It*this.fov);return.5*this.getFilmHeight()/e}getEffectiveFOV(){return 2*Dt*Math.atan(Math.tan(.5*It*this.fov)/this.zoom)}getFilmWidth(){return this.filmGauge*Math.min(this.aspect,1)}getFilmHeight(){return this.filmGauge/Math.max(this.aspect,1)}setViewOffset(e,t,r,n,i,s){this.aspect=e/t,null===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=r,this.view.offsetY=n,this.view.width=i,this.view.height=s,this.updateProjectionMatrix()}clearViewOffset(){null!==this.view&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const e=this.near;let t=e*Math.tan(.5*It*this.fov)/this.zoom,r=2*t,n=this.aspect*r,i=-.5*n;const s=this.view;if(null!==this.view&&this.view.enabled){const e=s.fullWidth,o=s.fullHeight;i+=s.offsetX*n/e,t-=s.offsetY*r/o,n*=s.width/e,r*=s.height/o}const o=this.filmOffset;0!==o&&(i+=e*o/this.getFilmWidth()),this.projectionMatrix.makePerspective(i,i+n,t,t-r,e,this.far),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){const t=super.toJSON(e);return t.object.fov=this.fov,t.object.zoom=this.zoom,t.object.near=this.near,t.object.far=this.far,t.object.focus=this.focus,t.object.aspect=this.aspect,null!==this.view&&(t.object.view=Object.assign({},this.view)),t.object.filmGauge=this.filmGauge,t.object.filmOffset=this.filmOffset,t}}const Mi=-90;class Ti extends _n{constructor(e,t,r){super(),this.type="CubeCamera",this.renderTarget=r;const n=new Si(Mi,1,e,t);n.layers=this.layers,n.up.set(0,1,0),n.lookAt(1,0,0),this.add(n);const i=new Si(Mi,1,e,t);i.layers=this.layers,i.up.set(0,1,0),i.lookAt(-1,0,0),this.add(i);const s=new Si(Mi,1,e,t);s.layers=this.layers,s.up.set(0,0,-1),s.lookAt(0,1,0),this.add(s);const o=new Si(Mi,1,e,t);o.layers=this.layers,o.up.set(0,0,1),o.lookAt(0,-1,0),this.add(o);const a=new Si(Mi,1,e,t);a.layers=this.layers,a.up.set(0,1,0),a.lookAt(0,0,1),this.add(a);const l=new Si(Mi,1,e,t);l.layers=this.layers,l.up.set(0,1,0),l.lookAt(0,0,-1),this.add(l)}update(e,t){null===this.parent&&this.updateMatrixWorld();const r=this.renderTarget,[n,i,s,o,a,l]=this.children,c=e.getRenderTarget(),u=e.toneMapping,h=e.xr.enabled;e.toneMapping=W,e.xr.enabled=!1;const d=r.texture.generateMipmaps;r.texture.generateMipmaps=!1,e.setRenderTarget(r,0),e.render(t,n),e.setRenderTarget(r,1),e.render(t,i),e.setRenderTarget(r,2),e.render(t,s),e.setRenderTarget(r,3),e.render(t,o),e.setRenderTarget(r,4),e.render(t,a),r.texture.generateMipmaps=d,e.setRenderTarget(r,5),e.render(t,l),e.setRenderTarget(c),e.toneMapping=u,e.xr.enabled=h,r.texture.needsPMREMUpdate=!0}}class Ei extends mr{constructor(e,t,r,n,i,s,o,a,l,c){super(e=void 0!==e?e:[],t=void 0!==t?t:Q,r,n,i,s,o,a,l,c),this.isCubeTexture=!0,this.flipY=!1}get images(){return this.image}set images(e){this.image=e}}class Ai extends yr{constructor(e=1,t={}){super(e,e,t),this.isWebGLCubeRenderTarget=!0;const r={width:e,height:e,depth:1},n=[r,r,r,r,r,r];this.texture=new Ei(n,t.mapping,t.wrapS,t.wrapT,t.magFilter,t.minFilter,t.format,t.type,t.anisotropy,t.encoding),this.texture.isRenderTargetTexture=!0,this.texture.generateMipmaps=void 0!==t.generateMipmaps&&t.generateMipmaps,this.texture.minFilter=void 0!==t.minFilter?t.minFilter:ce}fromEquirectangularTexture(e,t){this.texture.type=t.type,this.texture.encoding=t.encoding,this.texture.generateMipmaps=t.generateMipmaps,this.texture.minFilter=t.minFilter,this.texture.magFilter=t.magFilter;const r={uniforms:{tEquirect:{value:null}},vertexShader:"\n\n\t\t\t\tvarying vec3 vWorldDirection;\n\n\t\t\t\tvec3 transformDirection( in vec3 dir, in mat4 matrix ) {\n\n\t\t\t\t\treturn normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );\n\n\t\t\t\t}\n\n\t\t\t\tvoid main() {\n\n\t\t\t\t\tvWorldDirection = transformDirection( position, modelMatrix );\n\n\t\t\t\t\t#include <begin_vertex>\n\t\t\t\t\t#include <project_vertex>\n\n\t\t\t\t}\n\t\t\t",fragmentShader:"\n\n\t\t\t\tuniform sampler2D tEquirect;\n\n\t\t\t\tvarying vec3 vWorldDirection;\n\n\t\t\t\t#include <common>\n\n\t\t\t\tvoid main() {\n\n\t\t\t\t\tvec3 direction = normalize( vWorldDirection );\n\n\t\t\t\t\tvec2 sampleUV = equirectUv( direction );\n\n\t\t\t\t\tgl_FragColor = texture2D( tEquirect, sampleUV );\n\n\t\t\t\t}\n\t\t\t"},n=new gi(5,5,5),i=new bi({name:"CubemapFromEquirect",uniforms:yi(r.uniforms),vertexShader:r.vertexShader,fragmentShader:r.fragmentShader,side:u,blending:d});i.uniforms.tEquirect.value=t;const s=new fi(n,i),o=t.minFilter;t.minFilter===he&&(t.minFilter=ce);return new Ti(1,10,this).update(e,s),t.minFilter=o,s.geometry.dispose(),s.material.dispose(),this}clear(e,t,r,n){const i=e.getRenderTarget();for(let i=0;i<6;i++)e.setRenderTarget(this,i),e.clear(t,r,n);e.setRenderTarget(i)}}const Ci=new $t,Li=new $t,Ri=new Xt;class Pi{constructor(e=new $t(1,0,0),t=0){this.isPlane=!0,this.normal=e,this.constant=t}set(e,t){return this.normal.copy(e),this.constant=t,this}setComponents(e,t,r,n){return this.normal.set(e,t,r),this.constant=n,this}setFromNormalAndCoplanarPoint(e,t){return this.normal.copy(e),this.constant=-t.dot(this.normal),this}setFromCoplanarPoints(e,t,r){const n=Ci.subVectors(r,t).cross(Li.subVectors(e,t)).normalize();return this.setFromNormalAndCoplanarPoint(n,e),this}copy(e){return this.normal.copy(e.normal),this.constant=e.constant,this}normalize(){const e=1/this.normal.length();return this.normal.multiplyScalar(e),this.constant*=e,this}negate(){return this.constant*=-1,this.normal.negate(),this}distanceToPoint(e){return this.normal.dot(e)+this.constant}distanceToSphere(e){return this.distanceToPoint(e.center)-e.radius}projectPoint(e,t){return t.copy(e).addScaledVector(this.normal,-this.distanceToPoint(e))}intersectLine(e,t){const r=e.delta(Ci),n=this.normal.dot(r);if(0===n)return 0===this.distanceToPoint(e.start)?t.copy(e.start):null;const i=-(e.start.dot(this.normal)+this.constant)/n;return i<0||i>1?null:t.copy(e.start).addScaledVector(r,i)}intersectsLine(e){const t=this.distanceToPoint(e.start),r=this.distanceToPoint(e.end);return t<0&&r>0||r<0&&t>0}intersectsBox(e){return e.intersectsPlane(this)}intersectsSphere(e){return e.intersectsPlane(this)}coplanarPoint(e){return e.copy(this.normal).multiplyScalar(-this.constant)}applyMatrix4(e,t){const r=t||Ri.getNormalMatrix(e),n=this.coplanarPoint(Ci).applyMatrix4(e),i=this.normal.applyMatrix3(r).normalize();return this.constant=-n.dot(i),this}translate(e){return this.constant-=e.dot(this.normal),this}equals(e){return e.normal.equals(this.normal)&&e.constant===this.constant}clone(){return(new this.constructor).copy(this)}}const ji=new kr,Ii=new $t;class Di{constructor(e=new Pi,t=new Pi,r=new Pi,n=new Pi,i=new Pi,s=new Pi){this.planes=[e,t,r,n,i,s]}set(e,t,r,n,i,s){const o=this.planes;return o[0].copy(e),o[1].copy(t),o[2].copy(r),o[3].copy(n),o[4].copy(i),o[5].copy(s),this}copy(e){const t=this.planes;for(let r=0;r<6;r++)t[r].copy(e.planes[r]);return this}setFromProjectionMatrix(e){const t=this.planes,r=e.elements,n=r[0],i=r[1],s=r[2],o=r[3],a=r[4],l=r[5],c=r[6],u=r[7],h=r[8],d=r[9],p=r[10],f=r[11],m=r[12],g=r[13],y=r[14],v=r[15];return t[0].setComponents(o-n,u-a,f-h,v-m).normalize(),t[1].setComponents(o+n,u+a,f+h,v+m).normalize(),t[2].setComponents(o+i,u+l,f+d,v+g).normalize(),t[3].setComponents(o-i,u-l,f-d,v-g).normalize(),t[4].setComponents(o-s,u-c,f-p,v-y).normalize(),t[5].setComponents(o+s,u+c,f+p,v+y).normalize(),this}intersectsObject(e){const t=e.geometry;return null===t.boundingSphere&&t.computeBoundingSphere(),ji.copy(t.boundingSphere).applyMatrix4(e.matrixWorld),this.intersectsSphere(ji)}intersectsSprite(e){return ji.center.set(0,0,0),ji.radius=.7071067811865476,ji.applyMatrix4(e.matrixWorld),this.intersectsSphere(ji)}intersectsSphere(e){const t=this.planes,r=e.center,n=-e.radius;for(let e=0;e<6;e++){if(t[e].distanceToPoint(r)<n)return!1}return!0}intersectsBox(e){const t=this.planes;for(let r=0;r<6;r++){const n=t[r];if(Ii.x=n.normal.x>0?e.max.x:e.min.x,Ii.y=n.normal.y>0?e.max.y:e.min.y,Ii.z=n.normal.z>0?e.max.z:e.min.z,n.distanceToPoint(Ii)<0)return!1}return!0}containsPoint(e){const t=this.planes;for(let r=0;r<6;r++)if(t[r].distanceToPoint(e)<0)return!1;return!0}clone(){return(new this.constructor).copy(this)}}function Oi(){let e=null,t=!1,r=null,n=null;function i(t,s){r(t,s),n=e.requestAnimationFrame(i)}return{start:function(){!0!==t&&null!==r&&(n=e.requestAnimationFrame(i),t=!0)},stop:function(){e.cancelAnimationFrame(n),t=!1},setAnimationLoop:function(e){r=e},setContext:function(t){e=t}}}function Ni(e,t){const r=t.isWebGL2,n=new WeakMap;return{get:function(e){return e.isInterleavedBufferAttribute&&(e=e.data),n.get(e)},remove:function(t){t.isInterleavedBufferAttribute&&(t=t.data);const r=n.get(t);r&&(e.deleteBuffer(r.buffer),n.delete(t))},update:function(t,i){if(t.isGLBufferAttribute){const e=n.get(t);return void((!e||e.version<t.version)&&n.set(t,{buffer:t.buffer,type:t.type,bytesPerElement:t.elementSize,version:t.version}))}t.isInterleavedBufferAttribute&&(t=t.data);const s=n.get(t);void 0===s?n.set(t,function(t,n){const i=t.array,s=t.usage,o=e.createBuffer();let a;if(e.bindBuffer(n,o),e.bufferData(n,i,s),t.onUploadCallback(),i instanceof Float32Array)a=e.FLOAT;else if(i instanceof Uint16Array)if(t.isFloat16BufferAttribute){if(!r)throw new Error("THREE.WebGLAttributes: Usage of Float16BufferAttribute requires WebGL2.");a=e.HALF_FLOAT}else a=e.UNSIGNED_SHORT;else if(i instanceof Int16Array)a=e.SHORT;else if(i instanceof Uint32Array)a=e.UNSIGNED_INT;else if(i instanceof Int32Array)a=e.INT;else if(i instanceof Int8Array)a=e.BYTE;else if(i instanceof Uint8Array)a=e.UNSIGNED_BYTE;else{if(!(i instanceof Uint8ClampedArray))throw new Error("THREE.WebGLAttributes: Unsupported buffer data format: "+i);a=e.UNSIGNED_BYTE}return{buffer:o,type:a,bytesPerElement:i.BYTES_PER_ELEMENT,version:t.version}}(t,i)):s.version<t.version&&(!function(t,n,i){const s=n.array,o=n.updateRange;e.bindBuffer(i,t),-1===o.count?e.bufferSubData(i,0,s):(r?e.bufferSubData(i,o.offset*s.BYTES_PER_ELEMENT,s,o.offset,o.count):e.bufferSubData(i,o.offset*s.BYTES_PER_ELEMENT,s.subarray(o.offset,o.offset+o.count)),o.count=-1),n.onUploadCallback()}(s.buffer,t,i),s.version=t.version)}}}class Ui extends $n{constructor(e=1,t=1,r=1,n=1){super(),this.type="PlaneGeometry",this.parameters={width:e,height:t,widthSegments:r,heightSegments:n};const i=e/2,s=t/2,o=Math.floor(r),a=Math.floor(n),l=o+1,c=a+1,u=e/o,h=t/a,d=[],p=[],f=[],m=[];for(let e=0;e<c;e++){const t=e*h-s;for(let r=0;r<l;r++){const n=r*u-i;p.push(n,-t,0),f.push(0,0,1),m.push(r/o),m.push(1-e/a)}}for(let e=0;e<a;e++)for(let t=0;t<o;t++){const r=t+l*e,n=t+l*(e+1),i=t+1+l*(e+1),s=t+1+l*e;d.push(r,n,s),d.push(n,i,s)}this.setIndex(d),this.setAttribute("position",new Wn(p,3)),this.setAttribute("normal",new Wn(f,3)),this.setAttribute("uv",new Wn(m,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new Ui(e.width,e.height,e.widthSegments,e.heightSegments)}}const ki={alphamap_fragment:"#ifdef USE_ALPHAMAP\n\tdiffuseColor.a *= texture2D( alphaMap, vUv ).g;\n#endif",alphamap_pars_fragment:"#ifdef USE_ALPHAMAP\n\tuniform sampler2D alphaMap;\n#endif",alphatest_fragment:"#ifdef USE_ALPHATEST\n\tif ( diffuseColor.a < alphaTest ) discard;\n#endif",alphatest_pars_fragment:"#ifdef USE_ALPHATEST\n\tuniform float alphaTest;\n#endif",aomap_fragment:"#ifdef USE_AOMAP\n\tfloat ambientOcclusion = ( texture2D( aoMap, vUv2 ).r - 1.0 ) * aoMapIntensity + 1.0;\n\treflectedLight.indirectDiffuse *= ambientOcclusion;\n\t#if defined( USE_ENVMAP ) && defined( STANDARD )\n\t\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n\t\treflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.roughness );\n\t#endif\n#endif",aomap_pars_fragment:"#ifdef USE_AOMAP\n\tuniform sampler2D aoMap;\n\tuniform float aoMapIntensity;\n#endif",begin_vertex:"vec3 transformed = vec3( position );",beginnormal_vertex:"vec3 objectNormal = vec3( normal );\n#ifdef USE_TANGENT\n\tvec3 objectTangent = vec3( tangent.xyz );\n#endif",bsdfs:"vec3 BRDF_Lambert( const in vec3 diffuseColor ) {\n\treturn RECIPROCAL_PI * diffuseColor;\n}\nvec3 F_Schlick( const in vec3 f0, const in float f90, const in float dotVH ) {\n\tfloat fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );\n\treturn f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );\n}\nfloat F_Schlick( const in float f0, const in float f90, const in float dotVH ) {\n\tfloat fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );\n\treturn f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );\n}\nvec3 Schlick_to_F0( const in vec3 f, const in float f90, const in float dotVH ) {\n    float x = clamp( 1.0 - dotVH, 0.0, 1.0 );\n    float x2 = x * x;\n    float x5 = clamp( x * x2 * x2, 0.0, 0.9999 );\n    return ( f - vec3( f90 ) * x5 ) / ( 1.0 - x5 );\n}\nfloat V_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {\n\tfloat a2 = pow2( alpha );\n\tfloat gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );\n\tfloat gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );\n\treturn 0.5 / max( gv + gl, EPSILON );\n}\nfloat D_GGX( const in float alpha, const in float dotNH ) {\n\tfloat a2 = pow2( alpha );\n\tfloat denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;\n\treturn RECIPROCAL_PI * a2 / pow2( denom );\n}\nvec3 BRDF_GGX( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 f0, const in float f90, const in float roughness ) {\n\tfloat alpha = pow2( roughness );\n\tvec3 halfDir = normalize( lightDir + viewDir );\n\tfloat dotNL = saturate( dot( normal, lightDir ) );\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\tfloat dotVH = saturate( dot( viewDir, halfDir ) );\n\tvec3 F = F_Schlick( f0, f90, dotVH );\n\tfloat V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );\n\tfloat D = D_GGX( alpha, dotNH );\n\treturn F * ( V * D );\n}\n#ifdef USE_IRIDESCENCE\n\tvec3 BRDF_GGX_Iridescence( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 f0, const in float f90, const in float iridescence, const in vec3 iridescenceFresnel, const in float roughness ) {\n\t\tfloat alpha = pow2( roughness );\n\t\tvec3 halfDir = normalize( lightDir + viewDir );\n\t\tfloat dotNL = saturate( dot( normal, lightDir ) );\n\t\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\t\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\t\tfloat dotVH = saturate( dot( viewDir, halfDir ) );\n\t\tvec3 F = mix( F_Schlick( f0, f90, dotVH ), iridescenceFresnel, iridescence );\n\t\tfloat V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );\n\t\tfloat D = D_GGX( alpha, dotNH );\n\t\treturn F * ( V * D );\n\t}\n#endif\nvec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {\n\tconst float LUT_SIZE = 64.0;\n\tconst float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;\n\tconst float LUT_BIAS = 0.5 / LUT_SIZE;\n\tfloat dotNV = saturate( dot( N, V ) );\n\tvec2 uv = vec2( roughness, sqrt( 1.0 - dotNV ) );\n\tuv = uv * LUT_SCALE + LUT_BIAS;\n\treturn uv;\n}\nfloat LTC_ClippedSphereFormFactor( const in vec3 f ) {\n\tfloat l = length( f );\n\treturn max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );\n}\nvec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {\n\tfloat x = dot( v1, v2 );\n\tfloat y = abs( x );\n\tfloat a = 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;\n\tfloat b = 3.4175940 + ( 4.1616724 + y ) * y;\n\tfloat v = a / b;\n\tfloat theta_sintheta = ( x > 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;\n\treturn cross( v1, v2 ) * theta_sintheta;\n}\nvec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {\n\tvec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];\n\tvec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];\n\tvec3 lightNormal = cross( v1, v2 );\n\tif( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );\n\tvec3 T1, T2;\n\tT1 = normalize( V - N * dot( V, N ) );\n\tT2 = - cross( N, T1 );\n\tmat3 mat = mInv * transposeMat3( mat3( T1, T2, N ) );\n\tvec3 coords[ 4 ];\n\tcoords[ 0 ] = mat * ( rectCoords[ 0 ] - P );\n\tcoords[ 1 ] = mat * ( rectCoords[ 1 ] - P );\n\tcoords[ 2 ] = mat * ( rectCoords[ 2 ] - P );\n\tcoords[ 3 ] = mat * ( rectCoords[ 3 ] - P );\n\tcoords[ 0 ] = normalize( coords[ 0 ] );\n\tcoords[ 1 ] = normalize( coords[ 1 ] );\n\tcoords[ 2 ] = normalize( coords[ 2 ] );\n\tcoords[ 3 ] = normalize( coords[ 3 ] );\n\tvec3 vectorFormFactor = vec3( 0.0 );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );\n\tfloat result = LTC_ClippedSphereFormFactor( vectorFormFactor );\n\treturn vec3( result );\n}\nfloat G_BlinnPhong_Implicit( ) {\n\treturn 0.25;\n}\nfloat D_BlinnPhong( const in float shininess, const in float dotNH ) {\n\treturn RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );\n}\nvec3 BRDF_BlinnPhong( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float shininess ) {\n\tvec3 halfDir = normalize( lightDir + viewDir );\n\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\tfloat dotVH = saturate( dot( viewDir, halfDir ) );\n\tvec3 F = F_Schlick( specularColor, 1.0, dotVH );\n\tfloat G = G_BlinnPhong_Implicit( );\n\tfloat D = D_BlinnPhong( shininess, dotNH );\n\treturn F * ( G * D );\n}\n#if defined( USE_SHEEN )\nfloat D_Charlie( float roughness, float dotNH ) {\n\tfloat alpha = pow2( roughness );\n\tfloat invAlpha = 1.0 / alpha;\n\tfloat cos2h = dotNH * dotNH;\n\tfloat sin2h = max( 1.0 - cos2h, 0.0078125 );\n\treturn ( 2.0 + invAlpha ) * pow( sin2h, invAlpha * 0.5 ) / ( 2.0 * PI );\n}\nfloat V_Neubelt( float dotNV, float dotNL ) {\n\treturn saturate( 1.0 / ( 4.0 * ( dotNL + dotNV - dotNL * dotNV ) ) );\n}\nvec3 BRDF_Sheen( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, vec3 sheenColor, const in float sheenRoughness ) {\n\tvec3 halfDir = normalize( lightDir + viewDir );\n\tfloat dotNL = saturate( dot( normal, lightDir ) );\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\tfloat D = D_Charlie( sheenRoughness, dotNH );\n\tfloat V = V_Neubelt( dotNV, dotNL );\n\treturn sheenColor * ( D * V );\n}\n#endif",iridescence_fragment:"#ifdef USE_IRIDESCENCE\n\tconst mat3 XYZ_TO_REC709 = mat3(\n\t\t 3.2404542, -0.9692660,  0.0556434,\n\t\t-1.5371385,  1.8760108, -0.2040259,\n\t\t-0.4985314,  0.0415560,  1.0572252\n\t);\n\tvec3 Fresnel0ToIor( vec3 fresnel0 ) {\n\t\tvec3 sqrtF0 = sqrt( fresnel0 );\n\t\treturn ( vec3( 1.0 ) + sqrtF0 ) / ( vec3( 1.0 ) - sqrtF0 );\n\t}\n\tvec3 IorToFresnel0( vec3 transmittedIor, float incidentIor ) {\n\t\treturn pow2( ( transmittedIor - vec3( incidentIor ) ) / ( transmittedIor + vec3( incidentIor ) ) );\n\t}\n\tfloat IorToFresnel0( float transmittedIor, float incidentIor ) {\n\t\treturn pow2( ( transmittedIor - incidentIor ) / ( transmittedIor + incidentIor ));\n\t}\n\tvec3 evalSensitivity( float OPD, vec3 shift ) {\n\t\tfloat phase = 2.0 * PI * OPD * 1.0e-9;\n\t\tvec3 val = vec3( 5.4856e-13, 4.4201e-13, 5.2481e-13 );\n\t\tvec3 pos = vec3( 1.6810e+06, 1.7953e+06, 2.2084e+06 );\n\t\tvec3 var = vec3( 4.3278e+09, 9.3046e+09, 6.6121e+09 );\n\t\tvec3 xyz = val * sqrt( 2.0 * PI * var ) * cos( pos * phase + shift ) * exp( - pow2( phase ) * var );\n\t\txyz.x += 9.7470e-14 * sqrt( 2.0 * PI * 4.5282e+09 ) * cos( 2.2399e+06 * phase + shift[ 0 ] ) * exp( - 4.5282e+09 * pow2( phase ) );\n\t\txyz /= 1.0685e-7;\n\t\tvec3 rgb = XYZ_TO_REC709 * xyz;\n\t\treturn rgb;\n\t}\n\tvec3 evalIridescence( float outsideIOR, float eta2, float cosTheta1, float thinFilmThickness, vec3 baseF0 ) {\n\t\tvec3 I;\n\t\tfloat iridescenceIOR = mix( outsideIOR, eta2, smoothstep( 0.0, 0.03, thinFilmThickness ) );\n\t\tfloat sinTheta2Sq = pow2( outsideIOR / iridescenceIOR ) * ( 1.0 - pow2( cosTheta1 ) );\n\t\tfloat cosTheta2Sq = 1.0 - sinTheta2Sq;\n\t\tif ( cosTheta2Sq < 0.0 ) {\n\t\t\t return vec3( 1.0 );\n\t\t}\n\t\tfloat cosTheta2 = sqrt( cosTheta2Sq );\n\t\tfloat R0 = IorToFresnel0( iridescenceIOR, outsideIOR );\n\t\tfloat R12 = F_Schlick( R0, 1.0, cosTheta1 );\n\t\tfloat R21 = R12;\n\t\tfloat T121 = 1.0 - R12;\n\t\tfloat phi12 = 0.0;\n\t\tif ( iridescenceIOR < outsideIOR ) phi12 = PI;\n\t\tfloat phi21 = PI - phi12;\n\t\tvec3 baseIOR = Fresnel0ToIor( clamp( baseF0, 0.0, 0.9999 ) );\t\tvec3 R1 = IorToFresnel0( baseIOR, iridescenceIOR );\n\t\tvec3 R23 = F_Schlick( R1, 1.0, cosTheta2 );\n\t\tvec3 phi23 = vec3( 0.0 );\n\t\tif ( baseIOR[ 0 ] < iridescenceIOR ) phi23[ 0 ] = PI;\n\t\tif ( baseIOR[ 1 ] < iridescenceIOR ) phi23[ 1 ] = PI;\n\t\tif ( baseIOR[ 2 ] < iridescenceIOR ) phi23[ 2 ] = PI;\n\t\tfloat OPD = 2.0 * iridescenceIOR * thinFilmThickness * cosTheta2;\n\t\tvec3 phi = vec3( phi21 ) + phi23;\n\t\tvec3 R123 = clamp( R12 * R23, 1e-5, 0.9999 );\n\t\tvec3 r123 = sqrt( R123 );\n\t\tvec3 Rs = pow2( T121 ) * R23 / ( vec3( 1.0 ) - R123 );\n\t\tvec3 C0 = R12 + Rs;\n\t\tI = C0;\n\t\tvec3 Cm = Rs - T121;\n\t\tfor ( int m = 1; m <= 2; ++ m ) {\n\t\t\tCm *= r123;\n\t\t\tvec3 Sm = 2.0 * evalSensitivity( float( m ) * OPD, float( m ) * phi );\n\t\t\tI += Cm * Sm;\n\t\t}\n\t\treturn max( I, vec3( 0.0 ) );\n\t}\n#endif",bumpmap_pars_fragment:"#ifdef USE_BUMPMAP\n\tuniform sampler2D bumpMap;\n\tuniform float bumpScale;\n\tvec2 dHdxy_fwd() {\n\t\tvec2 dSTdx = dFdx( vUv );\n\t\tvec2 dSTdy = dFdy( vUv );\n\t\tfloat Hll = bumpScale * texture2D( bumpMap, vUv ).x;\n\t\tfloat dBx = bumpScale * texture2D( bumpMap, vUv + dSTdx ).x - Hll;\n\t\tfloat dBy = bumpScale * texture2D( bumpMap, vUv + dSTdy ).x - Hll;\n\t\treturn vec2( dBx, dBy );\n\t}\n\tvec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy, float faceDirection ) {\n\t\tvec3 vSigmaX = dFdx( surf_pos.xyz );\n\t\tvec3 vSigmaY = dFdy( surf_pos.xyz );\n\t\tvec3 vN = surf_norm;\n\t\tvec3 R1 = cross( vSigmaY, vN );\n\t\tvec3 R2 = cross( vN, vSigmaX );\n\t\tfloat fDet = dot( vSigmaX, R1 ) * faceDirection;\n\t\tvec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );\n\t\treturn normalize( abs( fDet ) * surf_norm - vGrad );\n\t}\n#endif",clipping_planes_fragment:"#if NUM_CLIPPING_PLANES > 0\n\tvec4 plane;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {\n\t\tplane = clippingPlanes[ i ];\n\t\tif ( dot( vClipPosition, plane.xyz ) > plane.w ) discard;\n\t}\n\t#pragma unroll_loop_end\n\t#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES\n\t\tbool clipped = true;\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {\n\t\t\tplane = clippingPlanes[ i ];\n\t\t\tclipped = ( dot( vClipPosition, plane.xyz ) > plane.w ) && clipped;\n\t\t}\n\t\t#pragma unroll_loop_end\n\t\tif ( clipped ) discard;\n\t#endif\n#endif",clipping_planes_pars_fragment:"#if NUM_CLIPPING_PLANES > 0\n\tvarying vec3 vClipPosition;\n\tuniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];\n#endif",clipping_planes_pars_vertex:"#if NUM_CLIPPING_PLANES > 0\n\tvarying vec3 vClipPosition;\n#endif",clipping_planes_vertex:"#if NUM_CLIPPING_PLANES > 0\n\tvClipPosition = - mvPosition.xyz;\n#endif",color_fragment:"#if defined( USE_COLOR_ALPHA )\n\tdiffuseColor *= vColor;\n#elif defined( USE_COLOR )\n\tdiffuseColor.rgb *= vColor;\n#endif",color_pars_fragment:"#if defined( USE_COLOR_ALPHA )\n\tvarying vec4 vColor;\n#elif defined( USE_COLOR )\n\tvarying vec3 vColor;\n#endif",color_pars_vertex:"#if defined( USE_COLOR_ALPHA )\n\tvarying vec4 vColor;\n#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )\n\tvarying vec3 vColor;\n#endif",color_vertex:"#if defined( USE_COLOR_ALPHA )\n\tvColor = vec4( 1.0 );\n#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )\n\tvColor = vec3( 1.0 );\n#endif\n#ifdef USE_COLOR\n\tvColor *= color;\n#endif\n#ifdef USE_INSTANCING_COLOR\n\tvColor.xyz *= instanceColor.xyz;\n#endif",common:"#define PI 3.141592653589793\n#define PI2 6.283185307179586\n#define PI_HALF 1.5707963267948966\n#define RECIPROCAL_PI 0.3183098861837907\n#define RECIPROCAL_PI2 0.15915494309189535\n#define EPSILON 1e-6\n#ifndef saturate\n#define saturate( a ) clamp( a, 0.0, 1.0 )\n#endif\n#define whiteComplement( a ) ( 1.0 - saturate( a ) )\nfloat pow2( const in float x ) { return x*x; }\nvec3 pow2( const in vec3 x ) { return x*x; }\nfloat pow3( const in float x ) { return x*x*x; }\nfloat pow4( const in float x ) { float x2 = x*x; return x2*x2; }\nfloat max3( const in vec3 v ) { return max( max( v.x, v.y ), v.z ); }\nfloat average( const in vec3 v ) { return dot( v, vec3( 0.3333333 ) ); }\nhighp float rand( const in vec2 uv ) {\n\tconst highp float a = 12.9898, b = 78.233, c = 43758.5453;\n\thighp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );\n\treturn fract( sin( sn ) * c );\n}\n#ifdef HIGH_PRECISION\n\tfloat precisionSafeLength( vec3 v ) { return length( v ); }\n#else\n\tfloat precisionSafeLength( vec3 v ) {\n\t\tfloat maxComponent = max3( abs( v ) );\n\t\treturn length( v / maxComponent ) * maxComponent;\n\t}\n#endif\nstruct IncidentLight {\n\tvec3 color;\n\tvec3 direction;\n\tbool visible;\n};\nstruct ReflectedLight {\n\tvec3 directDiffuse;\n\tvec3 directSpecular;\n\tvec3 indirectDiffuse;\n\tvec3 indirectSpecular;\n};\nstruct GeometricContext {\n\tvec3 position;\n\tvec3 normal;\n\tvec3 viewDir;\n#ifdef USE_CLEARCOAT\n\tvec3 clearcoatNormal;\n#endif\n};\nvec3 transformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );\n}\nvec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );\n}\nmat3 transposeMat3( const in mat3 m ) {\n\tmat3 tmp;\n\ttmp[ 0 ] = vec3( m[ 0 ].x, m[ 1 ].x, m[ 2 ].x );\n\ttmp[ 1 ] = vec3( m[ 0 ].y, m[ 1 ].y, m[ 2 ].y );\n\ttmp[ 2 ] = vec3( m[ 0 ].z, m[ 1 ].z, m[ 2 ].z );\n\treturn tmp;\n}\nfloat luminance( const in vec3 rgb ) {\n\tconst vec3 weights = vec3( 0.2126729, 0.7151522, 0.0721750 );\n\treturn dot( weights, rgb );\n}\nbool isPerspectiveMatrix( mat4 m ) {\n\treturn m[ 2 ][ 3 ] == - 1.0;\n}\nvec2 equirectUv( in vec3 dir ) {\n\tfloat u = atan( dir.z, dir.x ) * RECIPROCAL_PI2 + 0.5;\n\tfloat v = asin( clamp( dir.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;\n\treturn vec2( u, v );\n}",cube_uv_reflection_fragment:"#ifdef ENVMAP_TYPE_CUBE_UV\n\t#define cubeUV_minMipLevel 4.0\n\t#define cubeUV_minTileSize 16.0\n\tfloat getFace( vec3 direction ) {\n\t\tvec3 absDirection = abs( direction );\n\t\tfloat face = - 1.0;\n\t\tif ( absDirection.x > absDirection.z ) {\n\t\t\tif ( absDirection.x > absDirection.y )\n\t\t\t\tface = direction.x > 0.0 ? 0.0 : 3.0;\n\t\t\telse\n\t\t\t\tface = direction.y > 0.0 ? 1.0 : 4.0;\n\t\t} else {\n\t\t\tif ( absDirection.z > absDirection.y )\n\t\t\t\tface = direction.z > 0.0 ? 2.0 : 5.0;\n\t\t\telse\n\t\t\t\tface = direction.y > 0.0 ? 1.0 : 4.0;\n\t\t}\n\t\treturn face;\n\t}\n\tvec2 getUV( vec3 direction, float face ) {\n\t\tvec2 uv;\n\t\tif ( face == 0.0 ) {\n\t\t\tuv = vec2( direction.z, direction.y ) / abs( direction.x );\n\t\t} else if ( face == 1.0 ) {\n\t\t\tuv = vec2( - direction.x, - direction.z ) / abs( direction.y );\n\t\t} else if ( face == 2.0 ) {\n\t\t\tuv = vec2( - direction.x, direction.y ) / abs( direction.z );\n\t\t} else if ( face == 3.0 ) {\n\t\t\tuv = vec2( - direction.z, direction.y ) / abs( direction.x );\n\t\t} else if ( face == 4.0 ) {\n\t\t\tuv = vec2( - direction.x, direction.z ) / abs( direction.y );\n\t\t} else {\n\t\t\tuv = vec2( direction.x, direction.y ) / abs( direction.z );\n\t\t}\n\t\treturn 0.5 * ( uv + 1.0 );\n\t}\n\tvec3 bilinearCubeUV( sampler2D envMap, vec3 direction, float mipInt ) {\n\t\tfloat face = getFace( direction );\n\t\tfloat filterInt = max( cubeUV_minMipLevel - mipInt, 0.0 );\n\t\tmipInt = max( mipInt, cubeUV_minMipLevel );\n\t\tfloat faceSize = exp2( mipInt );\n\t\thighp vec2 uv = getUV( direction, face ) * ( faceSize - 2.0 ) + 1.0;\n\t\tif ( face > 2.0 ) {\n\t\t\tuv.y += faceSize;\n\t\t\tface -= 3.0;\n\t\t}\n\t\tuv.x += face * faceSize;\n\t\tuv.x += filterInt * 3.0 * cubeUV_minTileSize;\n\t\tuv.y += 4.0 * ( exp2( CUBEUV_MAX_MIP ) - faceSize );\n\t\tuv.x *= CUBEUV_TEXEL_WIDTH;\n\t\tuv.y *= CUBEUV_TEXEL_HEIGHT;\n\t\t#ifdef texture2DGradEXT\n\t\t\treturn texture2DGradEXT( envMap, uv, vec2( 0.0 ), vec2( 0.0 ) ).rgb;\n\t\t#else\n\t\t\treturn texture2D( envMap, uv ).rgb;\n\t\t#endif\n\t}\n\t#define cubeUV_r0 1.0\n\t#define cubeUV_v0 0.339\n\t#define cubeUV_m0 - 2.0\n\t#define cubeUV_r1 0.8\n\t#define cubeUV_v1 0.276\n\t#define cubeUV_m1 - 1.0\n\t#define cubeUV_r4 0.4\n\t#define cubeUV_v4 0.046\n\t#define cubeUV_m4 2.0\n\t#define cubeUV_r5 0.305\n\t#define cubeUV_v5 0.016\n\t#define cubeUV_m5 3.0\n\t#define cubeUV_r6 0.21\n\t#define cubeUV_v6 0.0038\n\t#define cubeUV_m6 4.0\n\tfloat roughnessToMip( float roughness ) {\n\t\tfloat mip = 0.0;\n\t\tif ( roughness >= cubeUV_r1 ) {\n\t\t\tmip = ( cubeUV_r0 - roughness ) * ( cubeUV_m1 - cubeUV_m0 ) / ( cubeUV_r0 - cubeUV_r1 ) + cubeUV_m0;\n\t\t} else if ( roughness >= cubeUV_r4 ) {\n\t\t\tmip = ( cubeUV_r1 - roughness ) * ( cubeUV_m4 - cubeUV_m1 ) / ( cubeUV_r1 - cubeUV_r4 ) + cubeUV_m1;\n\t\t} else if ( roughness >= cubeUV_r5 ) {\n\t\t\tmip = ( cubeUV_r4 - roughness ) * ( cubeUV_m5 - cubeUV_m4 ) / ( cubeUV_r4 - cubeUV_r5 ) + cubeUV_m4;\n\t\t} else if ( roughness >= cubeUV_r6 ) {\n\t\t\tmip = ( cubeUV_r5 - roughness ) * ( cubeUV_m6 - cubeUV_m5 ) / ( cubeUV_r5 - cubeUV_r6 ) + cubeUV_m5;\n\t\t} else {\n\t\t\tmip = - 2.0 * log2( 1.16 * roughness );\t\t}\n\t\treturn mip;\n\t}\n\tvec4 textureCubeUV( sampler2D envMap, vec3 sampleDir, float roughness ) {\n\t\tfloat mip = clamp( roughnessToMip( roughness ), cubeUV_m0, CUBEUV_MAX_MIP );\n\t\tfloat mipF = fract( mip );\n\t\tfloat mipInt = floor( mip );\n\t\tvec3 color0 = bilinearCubeUV( envMap, sampleDir, mipInt );\n\t\tif ( mipF == 0.0 ) {\n\t\t\treturn vec4( color0, 1.0 );\n\t\t} else {\n\t\t\tvec3 color1 = bilinearCubeUV( envMap, sampleDir, mipInt + 1.0 );\n\t\t\treturn vec4( mix( color0, color1, mipF ), 1.0 );\n\t\t}\n\t}\n#endif",defaultnormal_vertex:"vec3 transformedNormal = objectNormal;\n#ifdef USE_INSTANCING\n\tmat3 m = mat3( instanceMatrix );\n\ttransformedNormal /= vec3( dot( m[ 0 ], m[ 0 ] ), dot( m[ 1 ], m[ 1 ] ), dot( m[ 2 ], m[ 2 ] ) );\n\ttransformedNormal = m * transformedNormal;\n#endif\ntransformedNormal = normalMatrix * transformedNormal;\n#ifdef FLIP_SIDED\n\ttransformedNormal = - transformedNormal;\n#endif\n#ifdef USE_TANGENT\n\tvec3 transformedTangent = ( modelViewMatrix * vec4( objectTangent, 0.0 ) ).xyz;\n\t#ifdef FLIP_SIDED\n\t\ttransformedTangent = - transformedTangent;\n\t#endif\n#endif",displacementmap_pars_vertex:"#ifdef USE_DISPLACEMENTMAP\n\tuniform sampler2D displacementMap;\n\tuniform float displacementScale;\n\tuniform float displacementBias;\n#endif",displacementmap_vertex:"#ifdef USE_DISPLACEMENTMAP\n\ttransformed += normalize( objectNormal ) * ( texture2D( displacementMap, vUv ).x * displacementScale + displacementBias );\n#endif",emissivemap_fragment:"#ifdef USE_EMISSIVEMAP\n\tvec4 emissiveColor = texture2D( emissiveMap, vUv );\n\ttotalEmissiveRadiance *= emissiveColor.rgb;\n#endif",emissivemap_pars_fragment:"#ifdef USE_EMISSIVEMAP\n\tuniform sampler2D emissiveMap;\n#endif",encodings_fragment:"gl_FragColor = linearToOutputTexel( gl_FragColor );",encodings_pars_fragment:"vec4 LinearToLinear( in vec4 value ) {\n\treturn value;\n}\nvec4 LinearTosRGB( in vec4 value ) {\n\treturn vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.a );\n}",envmap_fragment:"#ifdef USE_ENVMAP\n\t#ifdef ENV_WORLDPOS\n\t\tvec3 cameraToFrag;\n\t\tif ( isOrthographic ) {\n\t\t\tcameraToFrag = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );\n\t\t} else {\n\t\t\tcameraToFrag = normalize( vWorldPosition - cameraPosition );\n\t\t}\n\t\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvec3 reflectVec = reflect( cameraToFrag, worldNormal );\n\t\t#else\n\t\t\tvec3 reflectVec = refract( cameraToFrag, worldNormal, refractionRatio );\n\t\t#endif\n\t#else\n\t\tvec3 reflectVec = vReflect;\n\t#endif\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tvec4 envColor = textureCube( envMap, vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );\n\t#else\n\t\tvec4 envColor = vec4( 0.0 );\n\t#endif\n\t#ifdef ENVMAP_BLENDING_MULTIPLY\n\t\toutgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_MIX )\n\t\toutgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_ADD )\n\t\toutgoingLight += envColor.xyz * specularStrength * reflectivity;\n\t#endif\n#endif",envmap_common_pars_fragment:"#ifdef USE_ENVMAP\n\tuniform float envMapIntensity;\n\tuniform float flipEnvMap;\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tuniform samplerCube envMap;\n\t#else\n\t\tuniform sampler2D envMap;\n\t#endif\n\t\n#endif",envmap_pars_fragment:"#ifdef USE_ENVMAP\n\tuniform float reflectivity;\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )\n\t\t#define ENV_WORLDPOS\n\t#endif\n\t#ifdef ENV_WORLDPOS\n\t\tvarying vec3 vWorldPosition;\n\t\tuniform float refractionRatio;\n\t#else\n\t\tvarying vec3 vReflect;\n\t#endif\n#endif",envmap_pars_vertex:"#ifdef USE_ENVMAP\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )\n\t\t#define ENV_WORLDPOS\n\t#endif\n\t#ifdef ENV_WORLDPOS\n\t\t\n\t\tvarying vec3 vWorldPosition;\n\t#else\n\t\tvarying vec3 vReflect;\n\t\tuniform float refractionRatio;\n\t#endif\n#endif",envmap_physical_pars_fragment:"#if defined( USE_ENVMAP )\n\tvec3 getIBLIrradiance( const in vec3 normal ) {\n\t\t#if defined( ENVMAP_TYPE_CUBE_UV )\n\t\t\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\t\t\tvec4 envMapColor = textureCubeUV( envMap, worldNormal, 1.0 );\n\t\t\treturn PI * envMapColor.rgb * envMapIntensity;\n\t\t#else\n\t\t\treturn vec3( 0.0 );\n\t\t#endif\n\t}\n\tvec3 getIBLRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness ) {\n\t\t#if defined( ENVMAP_TYPE_CUBE_UV )\n\t\t\tvec3 reflectVec = reflect( - viewDir, normal );\n\t\t\treflectVec = normalize( mix( reflectVec, normal, roughness * roughness) );\n\t\t\treflectVec = inverseTransformDirection( reflectVec, viewMatrix );\n\t\t\tvec4 envMapColor = textureCubeUV( envMap, reflectVec, roughness );\n\t\t\treturn envMapColor.rgb * envMapIntensity;\n\t\t#else\n\t\t\treturn vec3( 0.0 );\n\t\t#endif\n\t}\n#endif",envmap_vertex:"#ifdef USE_ENVMAP\n\t#ifdef ENV_WORLDPOS\n\t\tvWorldPosition = worldPosition.xyz;\n\t#else\n\t\tvec3 cameraToVertex;\n\t\tif ( isOrthographic ) {\n\t\t\tcameraToVertex = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );\n\t\t} else {\n\t\t\tcameraToVertex = normalize( worldPosition.xyz - cameraPosition );\n\t\t}\n\t\tvec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvReflect = reflect( cameraToVertex, worldNormal );\n\t\t#else\n\t\t\tvReflect = refract( cameraToVertex, worldNormal, refractionRatio );\n\t\t#endif\n\t#endif\n#endif",fog_vertex:"#ifdef USE_FOG\n\tvFogDepth = - mvPosition.z;\n#endif",fog_pars_vertex:"#ifdef USE_FOG\n\tvarying float vFogDepth;\n#endif",fog_fragment:"#ifdef USE_FOG\n\t#ifdef FOG_EXP2\n\t\tfloat fogFactor = 1.0 - exp( - fogDensity * fogDensity * vFogDepth * vFogDepth );\n\t#else\n\t\tfloat fogFactor = smoothstep( fogNear, fogFar, vFogDepth );\n\t#endif\n\tgl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );\n#endif",fog_pars_fragment:"#ifdef USE_FOG\n\tuniform vec3 fogColor;\n\tvarying float vFogDepth;\n\t#ifdef FOG_EXP2\n\t\tuniform float fogDensity;\n\t#else\n\t\tuniform float fogNear;\n\t\tuniform float fogFar;\n\t#endif\n#endif",gradientmap_pars_fragment:"#ifdef USE_GRADIENTMAP\n\tuniform sampler2D gradientMap;\n#endif\nvec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {\n\tfloat dotNL = dot( normal, lightDirection );\n\tvec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );\n\t#ifdef USE_GRADIENTMAP\n\t\treturn vec3( texture2D( gradientMap, coord ).r );\n\t#else\n\t\tvec2 fw = fwidth( coord ) * 0.5;\n\t\treturn mix( vec3( 0.7 ), vec3( 1.0 ), smoothstep( 0.7 - fw.x, 0.7 + fw.x, coord.x ) );\n\t#endif\n}",lightmap_fragment:"#ifdef USE_LIGHTMAP\n\tvec4 lightMapTexel = texture2D( lightMap, vUv2 );\n\tvec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;\n\treflectedLight.indirectDiffuse += lightMapIrradiance;\n#endif",lightmap_pars_fragment:"#ifdef USE_LIGHTMAP\n\tuniform sampler2D lightMap;\n\tuniform float lightMapIntensity;\n#endif",lights_lambert_fragment:"LambertMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;\nmaterial.specularStrength = specularStrength;",lights_lambert_pars_fragment:"varying vec3 vViewPosition;\nstruct LambertMaterial {\n\tvec3 diffuseColor;\n\tfloat specularStrength;\n};\nvoid RE_Direct_Lambert( const in IncidentLight directLight, const in GeometricContext geometry, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometry.normal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectDiffuse_Lambert( const in vec3 irradiance, const in GeometricContext geometry, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_Lambert\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Lambert",lights_pars_begin:"uniform bool receiveShadow;\nuniform vec3 ambientLightColor;\nuniform vec3 lightProbe[ 9 ];\nvec3 shGetIrradianceAt( in vec3 normal, in vec3 shCoefficients[ 9 ] ) {\n\tfloat x = normal.x, y = normal.y, z = normal.z;\n\tvec3 result = shCoefficients[ 0 ] * 0.886227;\n\tresult += shCoefficients[ 1 ] * 2.0 * 0.511664 * y;\n\tresult += shCoefficients[ 2 ] * 2.0 * 0.511664 * z;\n\tresult += shCoefficients[ 3 ] * 2.0 * 0.511664 * x;\n\tresult += shCoefficients[ 4 ] * 2.0 * 0.429043 * x * y;\n\tresult += shCoefficients[ 5 ] * 2.0 * 0.429043 * y * z;\n\tresult += shCoefficients[ 6 ] * ( 0.743125 * z * z - 0.247708 );\n\tresult += shCoefficients[ 7 ] * 2.0 * 0.429043 * x * z;\n\tresult += shCoefficients[ 8 ] * 0.429043 * ( x * x - y * y );\n\treturn result;\n}\nvec3 getLightProbeIrradiance( const in vec3 lightProbe[ 9 ], const in vec3 normal ) {\n\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\tvec3 irradiance = shGetIrradianceAt( worldNormal, lightProbe );\n\treturn irradiance;\n}\nvec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {\n\tvec3 irradiance = ambientLightColor;\n\treturn irradiance;\n}\nfloat getDistanceAttenuation( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {\n\t#if defined ( LEGACY_LIGHTS )\n\t\tif ( cutoffDistance > 0.0 && decayExponent > 0.0 ) {\n\t\t\treturn pow( saturate( - lightDistance / cutoffDistance + 1.0 ), decayExponent );\n\t\t}\n\t\treturn 1.0;\n\t#else\n\t\tfloat distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );\n\t\tif ( cutoffDistance > 0.0 ) {\n\t\t\tdistanceFalloff *= pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );\n\t\t}\n\t\treturn distanceFalloff;\n\t#endif\n}\nfloat getSpotAttenuation( const in float coneCosine, const in float penumbraCosine, const in float angleCosine ) {\n\treturn smoothstep( coneCosine, penumbraCosine, angleCosine );\n}\n#if NUM_DIR_LIGHTS > 0\n\tstruct DirectionalLight {\n\t\tvec3 direction;\n\t\tvec3 color;\n\t};\n\tuniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];\n\tvoid getDirectionalLightInfo( const in DirectionalLight directionalLight, const in GeometricContext geometry, out IncidentLight light ) {\n\t\tlight.color = directionalLight.color;\n\t\tlight.direction = directionalLight.direction;\n\t\tlight.visible = true;\n\t}\n#endif\n#if NUM_POINT_LIGHTS > 0\n\tstruct PointLight {\n\t\tvec3 position;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t};\n\tuniform PointLight pointLights[ NUM_POINT_LIGHTS ];\n\tvoid getPointLightInfo( const in PointLight pointLight, const in GeometricContext geometry, out IncidentLight light ) {\n\t\tvec3 lVector = pointLight.position - geometry.position;\n\t\tlight.direction = normalize( lVector );\n\t\tfloat lightDistance = length( lVector );\n\t\tlight.color = pointLight.color;\n\t\tlight.color *= getDistanceAttenuation( lightDistance, pointLight.distance, pointLight.decay );\n\t\tlight.visible = ( light.color != vec3( 0.0 ) );\n\t}\n#endif\n#if NUM_SPOT_LIGHTS > 0\n\tstruct SpotLight {\n\t\tvec3 position;\n\t\tvec3 direction;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t\tfloat coneCos;\n\t\tfloat penumbraCos;\n\t};\n\tuniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];\n\tvoid getSpotLightInfo( const in SpotLight spotLight, const in GeometricContext geometry, out IncidentLight light ) {\n\t\tvec3 lVector = spotLight.position - geometry.position;\n\t\tlight.direction = normalize( lVector );\n\t\tfloat angleCos = dot( light.direction, spotLight.direction );\n\t\tfloat spotAttenuation = getSpotAttenuation( spotLight.coneCos, spotLight.penumbraCos, angleCos );\n\t\tif ( spotAttenuation > 0.0 ) {\n\t\t\tfloat lightDistance = length( lVector );\n\t\t\tlight.color = spotLight.color * spotAttenuation;\n\t\t\tlight.color *= getDistanceAttenuation( lightDistance, spotLight.distance, spotLight.decay );\n\t\t\tlight.visible = ( light.color != vec3( 0.0 ) );\n\t\t} else {\n\t\t\tlight.color = vec3( 0.0 );\n\t\t\tlight.visible = false;\n\t\t}\n\t}\n#endif\n#if NUM_RECT_AREA_LIGHTS > 0\n\tstruct RectAreaLight {\n\t\tvec3 color;\n\t\tvec3 position;\n\t\tvec3 halfWidth;\n\t\tvec3 halfHeight;\n\t};\n\tuniform sampler2D ltc_1;\tuniform sampler2D ltc_2;\n\tuniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];\n#endif\n#if NUM_HEMI_LIGHTS > 0\n\tstruct HemisphereLight {\n\t\tvec3 direction;\n\t\tvec3 skyColor;\n\t\tvec3 groundColor;\n\t};\n\tuniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];\n\tvec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in vec3 normal ) {\n\t\tfloat dotNL = dot( normal, hemiLight.direction );\n\t\tfloat hemiDiffuseWeight = 0.5 * dotNL + 0.5;\n\t\tvec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );\n\t\treturn irradiance;\n\t}\n#endif",lights_toon_fragment:"ToonMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;",lights_toon_pars_fragment:"varying vec3 vViewPosition;\nstruct ToonMaterial {\n\tvec3 diffuseColor;\n};\nvoid RE_Direct_Toon( const in IncidentLight directLight, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {\n\tvec3 irradiance = getGradientIrradiance( geometry.normal, directLight.direction ) * directLight.color;\n\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectDiffuse_Toon( const in vec3 irradiance, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_Toon\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Toon",lights_phong_fragment:"BlinnPhongMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;\nmaterial.specularColor = specular;\nmaterial.specularShininess = shininess;\nmaterial.specularStrength = specularStrength;",lights_phong_pars_fragment:"varying vec3 vViewPosition;\nstruct BlinnPhongMaterial {\n\tvec3 diffuseColor;\n\tvec3 specularColor;\n\tfloat specularShininess;\n\tfloat specularStrength;\n};\nvoid RE_Direct_BlinnPhong( const in IncidentLight directLight, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometry.normal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n\treflectedLight.directSpecular += irradiance * BRDF_BlinnPhong( directLight.direction, geometry.viewDir, geometry.normal, material.specularColor, material.specularShininess ) * material.specularStrength;\n}\nvoid RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_BlinnPhong\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_BlinnPhong",lights_physical_fragment:"PhysicalMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );\nvec3 dxy = max( abs( dFdx( geometryNormal ) ), abs( dFdy( geometryNormal ) ) );\nfloat geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );\nmaterial.roughness = max( roughnessFactor, 0.0525 );material.roughness += geometryRoughness;\nmaterial.roughness = min( material.roughness, 1.0 );\n#ifdef IOR\n\tmaterial.ior = ior;\n\t#ifdef SPECULAR\n\t\tfloat specularIntensityFactor = specularIntensity;\n\t\tvec3 specularColorFactor = specularColor;\n\t\t#ifdef USE_SPECULARINTENSITYMAP\n\t\t\tspecularIntensityFactor *= texture2D( specularIntensityMap, vUv ).a;\n\t\t#endif\n\t\t#ifdef USE_SPECULARCOLORMAP\n\t\t\tspecularColorFactor *= texture2D( specularColorMap, vUv ).rgb;\n\t\t#endif\n\t\tmaterial.specularF90 = mix( specularIntensityFactor, 1.0, metalnessFactor );\n\t#else\n\t\tfloat specularIntensityFactor = 1.0;\n\t\tvec3 specularColorFactor = vec3( 1.0 );\n\t\tmaterial.specularF90 = 1.0;\n\t#endif\n\tmaterial.specularColor = mix( min( pow2( ( material.ior - 1.0 ) / ( material.ior + 1.0 ) ) * specularColorFactor, vec3( 1.0 ) ) * specularIntensityFactor, diffuseColor.rgb, metalnessFactor );\n#else\n\tmaterial.specularColor = mix( vec3( 0.04 ), diffuseColor.rgb, metalnessFactor );\n\tmaterial.specularF90 = 1.0;\n#endif\n#ifdef USE_CLEARCOAT\n\tmaterial.clearcoat = clearcoat;\n\tmaterial.clearcoatRoughness = clearcoatRoughness;\n\tmaterial.clearcoatF0 = vec3( 0.04 );\n\tmaterial.clearcoatF90 = 1.0;\n\t#ifdef USE_CLEARCOATMAP\n\t\tmaterial.clearcoat *= texture2D( clearcoatMap, vUv ).x;\n\t#endif\n\t#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\t\tmaterial.clearcoatRoughness *= texture2D( clearcoatRoughnessMap, vUv ).y;\n\t#endif\n\tmaterial.clearcoat = saturate( material.clearcoat );\tmaterial.clearcoatRoughness = max( material.clearcoatRoughness, 0.0525 );\n\tmaterial.clearcoatRoughness += geometryRoughness;\n\tmaterial.clearcoatRoughness = min( material.clearcoatRoughness, 1.0 );\n#endif\n#ifdef USE_IRIDESCENCE\n\tmaterial.iridescence = iridescence;\n\tmaterial.iridescenceIOR = iridescenceIOR;\n\t#ifdef USE_IRIDESCENCEMAP\n\t\tmaterial.iridescence *= texture2D( iridescenceMap, vUv ).r;\n\t#endif\n\t#ifdef USE_IRIDESCENCE_THICKNESSMAP\n\t\tmaterial.iridescenceThickness = (iridescenceThicknessMaximum - iridescenceThicknessMinimum) * texture2D( iridescenceThicknessMap, vUv ).g + iridescenceThicknessMinimum;\n\t#else\n\t\tmaterial.iridescenceThickness = iridescenceThicknessMaximum;\n\t#endif\n#endif\n#ifdef USE_SHEEN\n\tmaterial.sheenColor = sheenColor;\n\t#ifdef USE_SHEENCOLORMAP\n\t\tmaterial.sheenColor *= texture2D( sheenColorMap, vUv ).rgb;\n\t#endif\n\tmaterial.sheenRoughness = clamp( sheenRoughness, 0.07, 1.0 );\n\t#ifdef USE_SHEENROUGHNESSMAP\n\t\tmaterial.sheenRoughness *= texture2D( sheenRoughnessMap, vUv ).a;\n\t#endif\n#endif",lights_physical_pars_fragment:"struct PhysicalMaterial {\n\tvec3 diffuseColor;\n\tfloat roughness;\n\tvec3 specularColor;\n\tfloat specularF90;\n\t#ifdef USE_CLEARCOAT\n\t\tfloat clearcoat;\n\t\tfloat clearcoatRoughness;\n\t\tvec3 clearcoatF0;\n\t\tfloat clearcoatF90;\n\t#endif\n\t#ifdef USE_IRIDESCENCE\n\t\tfloat iridescence;\n\t\tfloat iridescenceIOR;\n\t\tfloat iridescenceThickness;\n\t\tvec3 iridescenceFresnel;\n\t\tvec3 iridescenceF0;\n\t#endif\n\t#ifdef USE_SHEEN\n\t\tvec3 sheenColor;\n\t\tfloat sheenRoughness;\n\t#endif\n\t#ifdef IOR\n\t\tfloat ior;\n\t#endif\n\t#ifdef USE_TRANSMISSION\n\t\tfloat transmission;\n\t\tfloat transmissionAlpha;\n\t\tfloat thickness;\n\t\tfloat attenuationDistance;\n\t\tvec3 attenuationColor;\n\t#endif\n};\nvec3 clearcoatSpecular = vec3( 0.0 );\nvec3 sheenSpecular = vec3( 0.0 );\nfloat IBLSheenBRDF( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tfloat r2 = roughness * roughness;\n\tfloat a = roughness < 0.25 ? -339.2 * r2 + 161.4 * roughness - 25.9 : -8.48 * r2 + 14.3 * roughness - 9.95;\n\tfloat b = roughness < 0.25 ? 44.0 * r2 - 23.7 * roughness + 3.26 : 1.97 * r2 - 3.27 * roughness + 0.72;\n\tfloat DG = exp( a * dotNV + b ) + ( roughness < 0.25 ? 0.0 : 0.1 * ( roughness - 0.25 ) );\n\treturn saturate( DG * RECIPROCAL_PI );\n}\nvec2 DFGApprox( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tconst vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );\n\tconst vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );\n\tvec4 r = roughness * c0 + c1;\n\tfloat a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;\n\tvec2 fab = vec2( - 1.04, 1.04 ) * a004 + r.zw;\n\treturn fab;\n}\nvec3 EnvironmentBRDF( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness ) {\n\tvec2 fab = DFGApprox( normal, viewDir, roughness );\n\treturn specularColor * fab.x + specularF90 * fab.y;\n}\n#ifdef USE_IRIDESCENCE\nvoid computeMultiscatteringIridescence( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float iridescence, const in vec3 iridescenceF0, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {\n#else\nvoid computeMultiscattering( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {\n#endif\n\tvec2 fab = DFGApprox( normal, viewDir, roughness );\n\t#ifdef USE_IRIDESCENCE\n\t\tvec3 Fr = mix( specularColor, iridescenceF0, iridescence );\n\t#else\n\t\tvec3 Fr = specularColor;\n\t#endif\n\tvec3 FssEss = Fr * fab.x + specularF90 * fab.y;\n\tfloat Ess = fab.x + fab.y;\n\tfloat Ems = 1.0 - Ess;\n\tvec3 Favg = Fr + ( 1.0 - Fr ) * 0.047619;\tvec3 Fms = FssEss * Favg / ( 1.0 - Ems * Favg );\n\tsingleScatter += FssEss;\n\tmultiScatter += Fms * Ems;\n}\n#if NUM_RECT_AREA_LIGHTS > 0\n\tvoid RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\t\tvec3 normal = geometry.normal;\n\t\tvec3 viewDir = geometry.viewDir;\n\t\tvec3 position = geometry.position;\n\t\tvec3 lightPos = rectAreaLight.position;\n\t\tvec3 halfWidth = rectAreaLight.halfWidth;\n\t\tvec3 halfHeight = rectAreaLight.halfHeight;\n\t\tvec3 lightColor = rectAreaLight.color;\n\t\tfloat roughness = material.roughness;\n\t\tvec3 rectCoords[ 4 ];\n\t\trectCoords[ 0 ] = lightPos + halfWidth - halfHeight;\t\trectCoords[ 1 ] = lightPos - halfWidth - halfHeight;\n\t\trectCoords[ 2 ] = lightPos - halfWidth + halfHeight;\n\t\trectCoords[ 3 ] = lightPos + halfWidth + halfHeight;\n\t\tvec2 uv = LTC_Uv( normal, viewDir, roughness );\n\t\tvec4 t1 = texture2D( ltc_1, uv );\n\t\tvec4 t2 = texture2D( ltc_2, uv );\n\t\tmat3 mInv = mat3(\n\t\t\tvec3( t1.x, 0, t1.y ),\n\t\t\tvec3(    0, 1,    0 ),\n\t\t\tvec3( t1.z, 0, t1.w )\n\t\t);\n\t\tvec3 fresnel = ( material.specularColor * t2.x + ( vec3( 1.0 ) - material.specularColor ) * t2.y );\n\t\treflectedLight.directSpecular += lightColor * fresnel * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );\n\t\treflectedLight.directDiffuse += lightColor * material.diffuseColor * LTC_Evaluate( normal, viewDir, position, mat3( 1.0 ), rectCoords );\n\t}\n#endif\nvoid RE_Direct_Physical( const in IncidentLight directLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometry.normal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\t#ifdef USE_CLEARCOAT\n\t\tfloat dotNLcc = saturate( dot( geometry.clearcoatNormal, directLight.direction ) );\n\t\tvec3 ccIrradiance = dotNLcc * directLight.color;\n\t\tclearcoatSpecular += ccIrradiance * BRDF_GGX( directLight.direction, geometry.viewDir, geometry.clearcoatNormal, material.clearcoatF0, material.clearcoatF90, material.clearcoatRoughness );\n\t#endif\n\t#ifdef USE_SHEEN\n\t\tsheenSpecular += irradiance * BRDF_Sheen( directLight.direction, geometry.viewDir, geometry.normal, material.sheenColor, material.sheenRoughness );\n\t#endif\n\t#ifdef USE_IRIDESCENCE\n\t\treflectedLight.directSpecular += irradiance * BRDF_GGX_Iridescence( directLight.direction, geometry.viewDir, geometry.normal, material.specularColor, material.specularF90, material.iridescence, material.iridescenceFresnel, material.roughness );\n\t#else\n\t\treflectedLight.directSpecular += irradiance * BRDF_GGX( directLight.direction, geometry.viewDir, geometry.normal, material.specularColor, material.specularF90, material.roughness );\n\t#endif\n\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 irradiance, const in vec3 clearcoatRadiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight) {\n\t#ifdef USE_CLEARCOAT\n\t\tclearcoatSpecular += clearcoatRadiance * EnvironmentBRDF( geometry.clearcoatNormal, geometry.viewDir, material.clearcoatF0, material.clearcoatF90, material.clearcoatRoughness );\n\t#endif\n\t#ifdef USE_SHEEN\n\t\tsheenSpecular += irradiance * material.sheenColor * IBLSheenBRDF( geometry.normal, geometry.viewDir, material.sheenRoughness );\n\t#endif\n\tvec3 singleScattering = vec3( 0.0 );\n\tvec3 multiScattering = vec3( 0.0 );\n\tvec3 cosineWeightedIrradiance = irradiance * RECIPROCAL_PI;\n\t#ifdef USE_IRIDESCENCE\n\t\tcomputeMultiscatteringIridescence( geometry.normal, geometry.viewDir, material.specularColor, material.specularF90, material.iridescence, material.iridescenceFresnel, material.roughness, singleScattering, multiScattering );\n\t#else\n\t\tcomputeMultiscattering( geometry.normal, geometry.viewDir, material.specularColor, material.specularF90, material.roughness, singleScattering, multiScattering );\n\t#endif\n\tvec3 totalScattering = singleScattering + multiScattering;\n\tvec3 diffuse = material.diffuseColor * ( 1.0 - max( max( totalScattering.r, totalScattering.g ), totalScattering.b ) );\n\treflectedLight.indirectSpecular += radiance * singleScattering;\n\treflectedLight.indirectSpecular += multiScattering * cosineWeightedIrradiance;\n\treflectedLight.indirectDiffuse += diffuse * cosineWeightedIrradiance;\n}\n#define RE_Direct\t\t\t\tRE_Direct_Physical\n#define RE_Direct_RectArea\t\tRE_Direct_RectArea_Physical\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Physical\n#define RE_IndirectSpecular\t\tRE_IndirectSpecular_Physical\nfloat computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {\n\treturn saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );\n}",lights_fragment_begin:"\nGeometricContext geometry;\ngeometry.position = - vViewPosition;\ngeometry.normal = normal;\ngeometry.viewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( vViewPosition );\n#ifdef USE_CLEARCOAT\n\tgeometry.clearcoatNormal = clearcoatNormal;\n#endif\n#ifdef USE_IRIDESCENCE\n\tfloat dotNVi = saturate( dot( normal, geometry.viewDir ) );\n\tif ( material.iridescenceThickness == 0.0 ) {\n\t\tmaterial.iridescence = 0.0;\n\t} else {\n\t\tmaterial.iridescence = saturate( material.iridescence );\n\t}\n\tif ( material.iridescence > 0.0 ) {\n\t\tmaterial.iridescenceFresnel = evalIridescence( 1.0, material.iridescenceIOR, dotNVi, material.iridescenceThickness, material.specularColor );\n\t\tmaterial.iridescenceF0 = Schlick_to_F0( material.iridescenceFresnel, 1.0, dotNVi );\n\t}\n#endif\nIncidentLight directLight;\n#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )\n\tPointLight pointLight;\n\t#if defined( USE_SHADOWMAP ) && NUM_POINT_LIGHT_SHADOWS > 0\n\tPointLightShadow pointLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tpointLight = pointLights[ i ];\n\t\tgetPointLightInfo( pointLight, geometry, directLight );\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_POINT_LIGHT_SHADOWS )\n\t\tpointLightShadow = pointLightShadows[ i ];\n\t\tdirectLight.color *= ( directLight.visible && receiveShadow ) ? getPointShadow( pointShadowMap[ i ], pointLightShadow.shadowMapSize, pointLightShadow.shadowBias, pointLightShadow.shadowRadius, vPointShadowCoord[ i ], pointLightShadow.shadowCameraNear, pointLightShadow.shadowCameraFar ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )\n\tSpotLight spotLight;\n\tvec4 spotColor;\n\tvec3 spotLightCoord;\n\tbool inSpotLightMap;\n\t#if defined( USE_SHADOWMAP ) && NUM_SPOT_LIGHT_SHADOWS > 0\n\tSpotLightShadow spotLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tspotLight = spotLights[ i ];\n\t\tgetSpotLightInfo( spotLight, geometry, directLight );\n\t\t#if ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )\n\t\t#define SPOT_LIGHT_MAP_INDEX UNROLLED_LOOP_INDEX\n\t\t#elif ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )\n\t\t#define SPOT_LIGHT_MAP_INDEX NUM_SPOT_LIGHT_MAPS\n\t\t#else\n\t\t#define SPOT_LIGHT_MAP_INDEX ( UNROLLED_LOOP_INDEX - NUM_SPOT_LIGHT_SHADOWS + NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )\n\t\t#endif\n\t\t#if ( SPOT_LIGHT_MAP_INDEX < NUM_SPOT_LIGHT_MAPS )\n\t\t\tspotLightCoord = vSpotLightCoord[ i ].xyz / vSpotLightCoord[ i ].w;\n\t\t\tinSpotLightMap = all( lessThan( abs( spotLightCoord * 2. - 1. ), vec3( 1.0 ) ) );\n\t\t\tspotColor = texture2D( spotLightMap[ SPOT_LIGHT_MAP_INDEX ], spotLightCoord.xy );\n\t\t\tdirectLight.color = inSpotLightMap ? directLight.color * spotColor.rgb : directLight.color;\n\t\t#endif\n\t\t#undef SPOT_LIGHT_MAP_INDEX\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )\n\t\tspotLightShadow = spotLightShadows[ i ];\n\t\tdirectLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( spotShadowMap[ i ], spotLightShadow.shadowMapSize, spotLightShadow.shadowBias, spotLightShadow.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )\n\tDirectionalLight directionalLight;\n\t#if defined( USE_SHADOWMAP ) && NUM_DIR_LIGHT_SHADOWS > 0\n\tDirectionalLightShadow directionalLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tdirectionalLight = directionalLights[ i ];\n\t\tgetDirectionalLightInfo( directionalLight, geometry, directLight );\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_DIR_LIGHT_SHADOWS )\n\t\tdirectionalLightShadow = directionalLightShadows[ i ];\n\t\tdirectLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( directionalShadowMap[ i ], directionalLightShadow.shadowMapSize, directionalLightShadow.shadowBias, directionalLightShadow.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )\n\tRectAreaLight rectAreaLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {\n\t\trectAreaLight = rectAreaLights[ i ];\n\t\tRE_Direct_RectArea( rectAreaLight, geometry, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if defined( RE_IndirectDiffuse )\n\tvec3 iblIrradiance = vec3( 0.0 );\n\tvec3 irradiance = getAmbientLightIrradiance( ambientLightColor );\n\tirradiance += getLightProbeIrradiance( lightProbe, geometry.normal );\n\t#if ( NUM_HEMI_LIGHTS > 0 )\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {\n\t\t\tirradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry.normal );\n\t\t}\n\t\t#pragma unroll_loop_end\n\t#endif\n#endif\n#if defined( RE_IndirectSpecular )\n\tvec3 radiance = vec3( 0.0 );\n\tvec3 clearcoatRadiance = vec3( 0.0 );\n#endif",lights_fragment_maps:"#if defined( RE_IndirectDiffuse )\n\t#ifdef USE_LIGHTMAP\n\t\tvec4 lightMapTexel = texture2D( lightMap, vUv2 );\n\t\tvec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;\n\t\tirradiance += lightMapIrradiance;\n\t#endif\n\t#if defined( USE_ENVMAP ) && defined( STANDARD ) && defined( ENVMAP_TYPE_CUBE_UV )\n\t\tiblIrradiance += getIBLIrradiance( geometry.normal );\n\t#endif\n#endif\n#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )\n\tradiance += getIBLRadiance( geometry.viewDir, geometry.normal, material.roughness );\n\t#ifdef USE_CLEARCOAT\n\t\tclearcoatRadiance += getIBLRadiance( geometry.viewDir, geometry.clearcoatNormal, material.clearcoatRoughness );\n\t#endif\n#endif",lights_fragment_end:"#if defined( RE_IndirectDiffuse )\n\tRE_IndirectDiffuse( irradiance, geometry, material, reflectedLight );\n#endif\n#if defined( RE_IndirectSpecular )\n\tRE_IndirectSpecular( radiance, iblIrradiance, clearcoatRadiance, geometry, material, reflectedLight );\n#endif",logdepthbuf_fragment:"#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )\n\tgl_FragDepthEXT = vIsPerspective == 0.0 ? gl_FragCoord.z : log2( vFragDepth ) * logDepthBufFC * 0.5;\n#endif",logdepthbuf_pars_fragment:"#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )\n\tuniform float logDepthBufFC;\n\tvarying float vFragDepth;\n\tvarying float vIsPerspective;\n#endif",logdepthbuf_pars_vertex:"#ifdef USE_LOGDEPTHBUF\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tvarying float vFragDepth;\n\t\tvarying float vIsPerspective;\n\t#else\n\t\tuniform float logDepthBufFC;\n\t#endif\n#endif",logdepthbuf_vertex:"#ifdef USE_LOGDEPTHBUF\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tvFragDepth = 1.0 + gl_Position.w;\n\t\tvIsPerspective = float( isPerspectiveMatrix( projectionMatrix ) );\n\t#else\n\t\tif ( isPerspectiveMatrix( projectionMatrix ) ) {\n\t\t\tgl_Position.z = log2( max( EPSILON, gl_Position.w + 1.0 ) ) * logDepthBufFC - 1.0;\n\t\t\tgl_Position.z *= gl_Position.w;\n\t\t}\n\t#endif\n#endif",map_fragment:"#ifdef USE_MAP\n\tvec4 sampledDiffuseColor = texture2D( map, vUv );\n\t#ifdef DECODE_VIDEO_TEXTURE\n\t\tsampledDiffuseColor = vec4( mix( pow( sampledDiffuseColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), sampledDiffuseColor.rgb * 0.0773993808, vec3( lessThanEqual( sampledDiffuseColor.rgb, vec3( 0.04045 ) ) ) ), sampledDiffuseColor.w );\n\t#endif\n\tdiffuseColor *= sampledDiffuseColor;\n#endif",map_pars_fragment:"#ifdef USE_MAP\n\tuniform sampler2D map;\n#endif",map_particle_fragment:"#if defined( USE_MAP ) || defined( USE_ALPHAMAP )\n\tvec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;\n#endif\n#ifdef USE_MAP\n\tdiffuseColor *= texture2D( map, uv );\n#endif\n#ifdef USE_ALPHAMAP\n\tdiffuseColor.a *= texture2D( alphaMap, uv ).g;\n#endif",map_particle_pars_fragment:"#if defined( USE_MAP ) || defined( USE_ALPHAMAP )\n\tuniform mat3 uvTransform;\n#endif\n#ifdef USE_MAP\n\tuniform sampler2D map;\n#endif\n#ifdef USE_ALPHAMAP\n\tuniform sampler2D alphaMap;\n#endif",metalnessmap_fragment:"float metalnessFactor = metalness;\n#ifdef USE_METALNESSMAP\n\tvec4 texelMetalness = texture2D( metalnessMap, vUv );\n\tmetalnessFactor *= texelMetalness.b;\n#endif",metalnessmap_pars_fragment:"#ifdef USE_METALNESSMAP\n\tuniform sampler2D metalnessMap;\n#endif",morphcolor_vertex:"#if defined( USE_MORPHCOLORS ) && defined( MORPHTARGETS_TEXTURE )\n\tvColor *= morphTargetBaseInfluence;\n\tfor ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {\n\t\t#if defined( USE_COLOR_ALPHA )\n\t\t\tif ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ) * morphTargetInfluences[ i ];\n\t\t#elif defined( USE_COLOR )\n\t\t\tif ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ).rgb * morphTargetInfluences[ i ];\n\t\t#endif\n\t}\n#endif",morphnormal_vertex:"#ifdef USE_MORPHNORMALS\n\tobjectNormal *= morphTargetBaseInfluence;\n\t#ifdef MORPHTARGETS_TEXTURE\n\t\tfor ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {\n\t\t\tif ( morphTargetInfluences[ i ] != 0.0 ) objectNormal += getMorph( gl_VertexID, i, 1 ).xyz * morphTargetInfluences[ i ];\n\t\t}\n\t#else\n\t\tobjectNormal += morphNormal0 * morphTargetInfluences[ 0 ];\n\t\tobjectNormal += morphNormal1 * morphTargetInfluences[ 1 ];\n\t\tobjectNormal += morphNormal2 * morphTargetInfluences[ 2 ];\n\t\tobjectNormal += morphNormal3 * morphTargetInfluences[ 3 ];\n\t#endif\n#endif",morphtarget_pars_vertex:"#ifdef USE_MORPHTARGETS\n\tuniform float morphTargetBaseInfluence;\n\t#ifdef MORPHTARGETS_TEXTURE\n\t\tuniform float morphTargetInfluences[ MORPHTARGETS_COUNT ];\n\t\tuniform sampler2DArray morphTargetsTexture;\n\t\tuniform ivec2 morphTargetsTextureSize;\n\t\tvec4 getMorph( const in int vertexIndex, const in int morphTargetIndex, const in int offset ) {\n\t\t\tint texelIndex = vertexIndex * MORPHTARGETS_TEXTURE_STRIDE + offset;\n\t\t\tint y = texelIndex / morphTargetsTextureSize.x;\n\t\t\tint x = texelIndex - y * morphTargetsTextureSize.x;\n\t\t\tivec3 morphUV = ivec3( x, y, morphTargetIndex );\n\t\t\treturn texelFetch( morphTargetsTexture, morphUV, 0 );\n\t\t}\n\t#else\n\t\t#ifndef USE_MORPHNORMALS\n\t\t\tuniform float morphTargetInfluences[ 8 ];\n\t\t#else\n\t\t\tuniform float morphTargetInfluences[ 4 ];\n\t\t#endif\n\t#endif\n#endif",morphtarget_vertex:"#ifdef USE_MORPHTARGETS\n\ttransformed *= morphTargetBaseInfluence;\n\t#ifdef MORPHTARGETS_TEXTURE\n\t\tfor ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {\n\t\t\tif ( morphTargetInfluences[ i ] != 0.0 ) transformed += getMorph( gl_VertexID, i, 0 ).xyz * morphTargetInfluences[ i ];\n\t\t}\n\t#else\n\t\ttransformed += morphTarget0 * morphTargetInfluences[ 0 ];\n\t\ttransformed += morphTarget1 * morphTargetInfluences[ 1 ];\n\t\ttransformed += morphTarget2 * morphTargetInfluences[ 2 ];\n\t\ttransformed += morphTarget3 * morphTargetInfluences[ 3 ];\n\t\t#ifndef USE_MORPHNORMALS\n\t\t\ttransformed += morphTarget4 * morphTargetInfluences[ 4 ];\n\t\t\ttransformed += morphTarget5 * morphTargetInfluences[ 5 ];\n\t\t\ttransformed += morphTarget6 * morphTargetInfluences[ 6 ];\n\t\t\ttransformed += morphTarget7 * morphTargetInfluences[ 7 ];\n\t\t#endif\n\t#endif\n#endif",normal_fragment_begin:"float faceDirection = gl_FrontFacing ? 1.0 : - 1.0;\n#ifdef FLAT_SHADED\n\tvec3 fdx = dFdx( vViewPosition );\n\tvec3 fdy = dFdy( vViewPosition );\n\tvec3 normal = normalize( cross( fdx, fdy ) );\n#else\n\tvec3 normal = normalize( vNormal );\n\t#ifdef DOUBLE_SIDED\n\t\tnormal = normal * faceDirection;\n\t#endif\n\t#ifdef USE_TANGENT\n\t\tvec3 tangent = normalize( vTangent );\n\t\tvec3 bitangent = normalize( vBitangent );\n\t\t#ifdef DOUBLE_SIDED\n\t\t\ttangent = tangent * faceDirection;\n\t\t\tbitangent = bitangent * faceDirection;\n\t\t#endif\n\t\t#if defined( TANGENTSPACE_NORMALMAP ) || defined( USE_CLEARCOAT_NORMALMAP )\n\t\t\tmat3 vTBN = mat3( tangent, bitangent, normal );\n\t\t#endif\n\t#endif\n#endif\nvec3 geometryNormal = normal;",normal_fragment_maps:"#ifdef OBJECTSPACE_NORMALMAP\n\tnormal = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;\n\t#ifdef FLIP_SIDED\n\t\tnormal = - normal;\n\t#endif\n\t#ifdef DOUBLE_SIDED\n\t\tnormal = normal * faceDirection;\n\t#endif\n\tnormal = normalize( normalMatrix * normal );\n#elif defined( TANGENTSPACE_NORMALMAP )\n\tvec3 mapN = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;\n\tmapN.xy *= normalScale;\n\t#ifdef USE_TANGENT\n\t\tnormal = normalize( vTBN * mapN );\n\t#else\n\t\tnormal = perturbNormal2Arb( - vViewPosition, normal, mapN, faceDirection );\n\t#endif\n#elif defined( USE_BUMPMAP )\n\tnormal = perturbNormalArb( - vViewPosition, normal, dHdxy_fwd(), faceDirection );\n#endif",normal_pars_fragment:"#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif",normal_pars_vertex:"#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif",normal_vertex:"#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n\t#ifdef USE_TANGENT\n\t\tvTangent = normalize( transformedTangent );\n\t\tvBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );\n\t#endif\n#endif",normalmap_pars_fragment:"#ifdef USE_NORMALMAP\n\tuniform sampler2D normalMap;\n\tuniform vec2 normalScale;\n#endif\n#ifdef OBJECTSPACE_NORMALMAP\n\tuniform mat3 normalMatrix;\n#endif\n#if ! defined ( USE_TANGENT ) && ( defined ( TANGENTSPACE_NORMALMAP ) || defined ( USE_CLEARCOAT_NORMALMAP ) )\n\tvec3 perturbNormal2Arb( vec3 eye_pos, vec3 surf_norm, vec3 mapN, float faceDirection ) {\n\t\tvec3 q0 = dFdx( eye_pos.xyz );\n\t\tvec3 q1 = dFdy( eye_pos.xyz );\n\t\tvec2 st0 = dFdx( vUv.st );\n\t\tvec2 st1 = dFdy( vUv.st );\n\t\tvec3 N = surf_norm;\n\t\tvec3 q1perp = cross( q1, N );\n\t\tvec3 q0perp = cross( N, q0 );\n\t\tvec3 T = q1perp * st0.x + q0perp * st1.x;\n\t\tvec3 B = q1perp * st0.y + q0perp * st1.y;\n\t\tfloat det = max( dot( T, T ), dot( B, B ) );\n\t\tfloat scale = ( det == 0.0 ) ? 0.0 : faceDirection * inversesqrt( det );\n\t\treturn normalize( T * ( mapN.x * scale ) + B * ( mapN.y * scale ) + N * mapN.z );\n\t}\n#endif",clearcoat_normal_fragment_begin:"#ifdef USE_CLEARCOAT\n\tvec3 clearcoatNormal = geometryNormal;\n#endif",clearcoat_normal_fragment_maps:"#ifdef USE_CLEARCOAT_NORMALMAP\n\tvec3 clearcoatMapN = texture2D( clearcoatNormalMap, vUv ).xyz * 2.0 - 1.0;\n\tclearcoatMapN.xy *= clearcoatNormalScale;\n\t#ifdef USE_TANGENT\n\t\tclearcoatNormal = normalize( vTBN * clearcoatMapN );\n\t#else\n\t\tclearcoatNormal = perturbNormal2Arb( - vViewPosition, clearcoatNormal, clearcoatMapN, faceDirection );\n\t#endif\n#endif",clearcoat_pars_fragment:"#ifdef USE_CLEARCOATMAP\n\tuniform sampler2D clearcoatMap;\n#endif\n#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\tuniform sampler2D clearcoatRoughnessMap;\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n\tuniform sampler2D clearcoatNormalMap;\n\tuniform vec2 clearcoatNormalScale;\n#endif",iridescence_pars_fragment:"#ifdef USE_IRIDESCENCEMAP\n\tuniform sampler2D iridescenceMap;\n#endif\n#ifdef USE_IRIDESCENCE_THICKNESSMAP\n\tuniform sampler2D iridescenceThicknessMap;\n#endif",output_fragment:"#ifdef OPAQUE\ndiffuseColor.a = 1.0;\n#endif\n#ifdef USE_TRANSMISSION\ndiffuseColor.a *= material.transmissionAlpha + 0.1;\n#endif\ngl_FragColor = vec4( outgoingLight, diffuseColor.a );",packing:"vec3 packNormalToRGB( const in vec3 normal ) {\n\treturn normalize( normal ) * 0.5 + 0.5;\n}\nvec3 unpackRGBToNormal( const in vec3 rgb ) {\n\treturn 2.0 * rgb.xyz - 1.0;\n}\nconst float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;\nconst vec3 PackFactors = vec3( 256. * 256. * 256., 256. * 256., 256. );\nconst vec4 UnpackFactors = UnpackDownscale / vec4( PackFactors, 1. );\nconst float ShiftRight8 = 1. / 256.;\nvec4 packDepthToRGBA( const in float v ) {\n\tvec4 r = vec4( fract( v * PackFactors ), v );\n\tr.yzw -= r.xyz * ShiftRight8;\treturn r * PackUpscale;\n}\nfloat unpackRGBAToDepth( const in vec4 v ) {\n\treturn dot( v, UnpackFactors );\n}\nvec2 packDepthToRG( in highp float v ) {\n\treturn packDepthToRGBA( v ).yx;\n}\nfloat unpackRGToDepth( const in highp vec2 v ) {\n\treturn unpackRGBAToDepth( vec4( v.xy, 0.0, 0.0 ) );\n}\nvec4 pack2HalfToRGBA( vec2 v ) {\n\tvec4 r = vec4( v.x, fract( v.x * 255.0 ), v.y, fract( v.y * 255.0 ) );\n\treturn vec4( r.x - r.y / 255.0, r.y, r.z - r.w / 255.0, r.w );\n}\nvec2 unpackRGBATo2Half( vec4 v ) {\n\treturn vec2( v.x + ( v.y / 255.0 ), v.z + ( v.w / 255.0 ) );\n}\nfloat viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {\n\treturn ( viewZ + near ) / ( near - far );\n}\nfloat orthographicDepthToViewZ( const in float linearClipZ, const in float near, const in float far ) {\n\treturn linearClipZ * ( near - far ) - near;\n}\nfloat viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {\n\treturn ( ( near + viewZ ) * far ) / ( ( far - near ) * viewZ );\n}\nfloat perspectiveDepthToViewZ( const in float invClipZ, const in float near, const in float far ) {\n\treturn ( near * far ) / ( ( far - near ) * invClipZ - far );\n}",premultiplied_alpha_fragment:"#ifdef PREMULTIPLIED_ALPHA\n\tgl_FragColor.rgb *= gl_FragColor.a;\n#endif",project_vertex:"vec4 mvPosition = vec4( transformed, 1.0 );\n#ifdef USE_INSTANCING\n\tmvPosition = instanceMatrix * mvPosition;\n#endif\nmvPosition = modelViewMatrix * mvPosition;\ngl_Position = projectionMatrix * mvPosition;",dithering_fragment:"#ifdef DITHERING\n\tgl_FragColor.rgb = dithering( gl_FragColor.rgb );\n#endif",dithering_pars_fragment:"#ifdef DITHERING\n\tvec3 dithering( vec3 color ) {\n\t\tfloat grid_position = rand( gl_FragCoord.xy );\n\t\tvec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );\n\t\tdither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );\n\t\treturn color + dither_shift_RGB;\n\t}\n#endif",roughnessmap_fragment:"float roughnessFactor = roughness;\n#ifdef USE_ROUGHNESSMAP\n\tvec4 texelRoughness = texture2D( roughnessMap, vUv );\n\troughnessFactor *= texelRoughness.g;\n#endif",roughnessmap_pars_fragment:"#ifdef USE_ROUGHNESSMAP\n\tuniform sampler2D roughnessMap;\n#endif",shadowmap_pars_fragment:"#if NUM_SPOT_LIGHT_COORDS > 0\n\tvarying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];\n#endif\n#if NUM_SPOT_LIGHT_MAPS > 0\n\tuniform sampler2D spotLightMap[ NUM_SPOT_LIGHT_MAPS ];\n#endif\n#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tstruct DirectionalLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];\n\t\tstruct SpotLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tstruct PointLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t\tfloat shadowCameraNear;\n\t\t\tfloat shadowCameraFar;\n\t\t};\n\t\tuniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];\n\t#endif\n\tfloat texture2DCompare( sampler2D depths, vec2 uv, float compare ) {\n\t\treturn step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );\n\t}\n\tvec2 texture2DDistribution( sampler2D shadow, vec2 uv ) {\n\t\treturn unpackRGBATo2Half( texture2D( shadow, uv ) );\n\t}\n\tfloat VSMShadow (sampler2D shadow, vec2 uv, float compare ){\n\t\tfloat occlusion = 1.0;\n\t\tvec2 distribution = texture2DDistribution( shadow, uv );\n\t\tfloat hard_shadow = step( compare , distribution.x );\n\t\tif (hard_shadow != 1.0 ) {\n\t\t\tfloat distance = compare - distribution.x ;\n\t\t\tfloat variance = max( 0.00000, distribution.y * distribution.y );\n\t\t\tfloat softness_probability = variance / (variance + distance * distance );\t\t\tsoftness_probability = clamp( ( softness_probability - 0.3 ) / ( 0.95 - 0.3 ), 0.0, 1.0 );\t\t\tocclusion = clamp( max( hard_shadow, softness_probability ), 0.0, 1.0 );\n\t\t}\n\t\treturn occlusion;\n\t}\n\tfloat getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord ) {\n\t\tfloat shadow = 1.0;\n\t\tshadowCoord.xyz /= shadowCoord.w;\n\t\tshadowCoord.z += shadowBias;\n\t\tbool inFrustum = shadowCoord.x >= 0.0 && shadowCoord.x <= 1.0 && shadowCoord.y >= 0.0 && shadowCoord.y <= 1.0;\n\t\tbool frustumTest = inFrustum && shadowCoord.z <= 1.0;\n\t\tif ( frustumTest ) {\n\t\t#if defined( SHADOWMAP_TYPE_PCF )\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx0 = - texelSize.x * shadowRadius;\n\t\t\tfloat dy0 = - texelSize.y * shadowRadius;\n\t\t\tfloat dx1 = + texelSize.x * shadowRadius;\n\t\t\tfloat dy1 = + texelSize.y * shadowRadius;\n\t\t\tfloat dx2 = dx0 / 2.0;\n\t\t\tfloat dy2 = dy0 / 2.0;\n\t\t\tfloat dx3 = dx1 / 2.0;\n\t\t\tfloat dy3 = dy1 / 2.0;\n\t\t\tshadow = (\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )\n\t\t\t) * ( 1.0 / 17.0 );\n\t\t#elif defined( SHADOWMAP_TYPE_PCF_SOFT )\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx = texelSize.x;\n\t\t\tfloat dy = texelSize.y;\n\t\t\tvec2 uv = shadowCoord.xy;\n\t\t\tvec2 f = fract( uv * shadowMapSize + 0.5 );\n\t\t\tuv -= f * texelSize;\n\t\t\tshadow = (\n\t\t\t\ttexture2DCompare( shadowMap, uv, shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + vec2( dx, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + vec2( 0.0, dy ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + texelSize, shadowCoord.z ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( -dx, 0.0 ), shadowCoord.z ),\n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 0.0 ), shadowCoord.z ),\n\t\t\t\t\t f.x ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( -dx, dy ), shadowCoord.z ),\n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, dy ), shadowCoord.z ),\n\t\t\t\t\t f.x ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( 0.0, -dy ), shadowCoord.z ),\n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 0.0, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t f.y ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( dx, -dy ), shadowCoord.z ),\n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( dx, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t f.y ) +\n\t\t\t\tmix( mix( texture2DCompare( shadowMap, uv + vec2( -dx, -dy ), shadowCoord.z ),\n\t\t\t\t\t\t  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, -dy ), shadowCoord.z ),\n\t\t\t\t\t\t  f.x ),\n\t\t\t\t\t mix( texture2DCompare( shadowMap, uv + vec2( -dx, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t\t  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t\t  f.x ),\n\t\t\t\t\t f.y )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#elif defined( SHADOWMAP_TYPE_VSM )\n\t\t\tshadow = VSMShadow( shadowMap, shadowCoord.xy, shadowCoord.z );\n\t\t#else\n\t\t\tshadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );\n\t\t#endif\n\t\t}\n\t\treturn shadow;\n\t}\n\tvec2 cubeToUV( vec3 v, float texelSizeY ) {\n\t\tvec3 absV = abs( v );\n\t\tfloat scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );\n\t\tabsV *= scaleToCube;\n\t\tv *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );\n\t\tvec2 planar = v.xy;\n\t\tfloat almostATexel = 1.5 * texelSizeY;\n\t\tfloat almostOne = 1.0 - almostATexel;\n\t\tif ( absV.z >= almostOne ) {\n\t\t\tif ( v.z > 0.0 )\n\t\t\t\tplanar.x = 4.0 - v.x;\n\t\t} else if ( absV.x >= almostOne ) {\n\t\t\tfloat signX = sign( v.x );\n\t\t\tplanar.x = v.z * signX + 2.0 * signX;\n\t\t} else if ( absV.y >= almostOne ) {\n\t\t\tfloat signY = sign( v.y );\n\t\t\tplanar.x = v.x + 2.0 * signY + 2.0;\n\t\t\tplanar.y = v.z * signY - 2.0;\n\t\t}\n\t\treturn vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );\n\t}\n\tfloat getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {\n\t\tvec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );\n\t\tvec3 lightToPosition = shadowCoord.xyz;\n\t\tfloat dp = ( length( lightToPosition ) - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear );\t\tdp += shadowBias;\n\t\tvec3 bd3D = normalize( lightToPosition );\n\t\t#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT ) || defined( SHADOWMAP_TYPE_VSM )\n\t\t\tvec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;\n\t\t\treturn (\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#else\n\t\t\treturn texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );\n\t\t#endif\n\t}\n#endif",shadowmap_pars_vertex:"#if NUM_SPOT_LIGHT_COORDS > 0\n\tuniform mat4 spotLightMatrix[ NUM_SPOT_LIGHT_COORDS ];\n\tvarying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];\n#endif\n#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t\tuniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tstruct DirectionalLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\t\tstruct SpotLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t\tuniform mat4 pointShadowMatrix[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tstruct PointLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t\tfloat shadowCameraNear;\n\t\t\tfloat shadowCameraFar;\n\t\t};\n\t\tuniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];\n\t#endif\n#endif",shadowmap_vertex:"#if ( defined( USE_SHADOWMAP ) && ( NUM_DIR_LIGHT_SHADOWS > 0 || NUM_POINT_LIGHT_SHADOWS > 0 ) ) || ( NUM_SPOT_LIGHT_COORDS > 0 )\n\tvec3 shadowWorldNormal = inverseTransformDirection( transformedNormal, viewMatrix );\n\tvec4 shadowWorldPosition;\n#endif\n#if defined( USE_SHADOWMAP )\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {\n\t\t\tshadowWorldPosition = worldPosition + vec4( shadowWorldNormal * directionalLightShadows[ i ].shadowNormalBias, 0 );\n\t\t\tvDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * shadowWorldPosition;\n\t\t}\n\t\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {\n\t\t\tshadowWorldPosition = worldPosition + vec4( shadowWorldNormal * pointLightShadows[ i ].shadowNormalBias, 0 );\n\t\t\tvPointShadowCoord[ i ] = pointShadowMatrix[ i ] * shadowWorldPosition;\n\t\t}\n\t\t#pragma unroll_loop_end\n\t#endif\n#endif\n#if NUM_SPOT_LIGHT_COORDS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHT_COORDS; i ++ ) {\n\t\tshadowWorldPosition = worldPosition;\n\t\t#if ( defined( USE_SHADOWMAP ) && UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )\n\t\t\tshadowWorldPosition.xyz += shadowWorldNormal * spotLightShadows[ i ].shadowNormalBias;\n\t\t#endif\n\t\tvSpotLightCoord[ i ] = spotLightMatrix[ i ] * shadowWorldPosition;\n\t}\n\t#pragma unroll_loop_end\n#endif",shadowmask_pars_fragment:"float getShadowMask() {\n\tfloat shadow = 1.0;\n\t#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\tDirectionalLightShadow directionalLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {\n\t\tdirectionalLight = directionalLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\tSpotLightShadow spotLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {\n\t\tspotLight = spotLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\tPointLightShadow pointLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {\n\t\tpointLight = pointLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#endif\n\treturn shadow;\n}",skinbase_vertex:"#ifdef USE_SKINNING\n\tmat4 boneMatX = getBoneMatrix( skinIndex.x );\n\tmat4 boneMatY = getBoneMatrix( skinIndex.y );\n\tmat4 boneMatZ = getBoneMatrix( skinIndex.z );\n\tmat4 boneMatW = getBoneMatrix( skinIndex.w );\n#endif",skinning_pars_vertex:"#ifdef USE_SKINNING\n\tuniform mat4 bindMatrix;\n\tuniform mat4 bindMatrixInverse;\n\tuniform highp sampler2D boneTexture;\n\tuniform int boneTextureSize;\n\tmat4 getBoneMatrix( const in float i ) {\n\t\tfloat j = i * 4.0;\n\t\tfloat x = mod( j, float( boneTextureSize ) );\n\t\tfloat y = floor( j / float( boneTextureSize ) );\n\t\tfloat dx = 1.0 / float( boneTextureSize );\n\t\tfloat dy = 1.0 / float( boneTextureSize );\n\t\ty = dy * ( y + 0.5 );\n\t\tvec4 v1 = texture2D( boneTexture, vec2( dx * ( x + 0.5 ), y ) );\n\t\tvec4 v2 = texture2D( boneTexture, vec2( dx * ( x + 1.5 ), y ) );\n\t\tvec4 v3 = texture2D( boneTexture, vec2( dx * ( x + 2.5 ), y ) );\n\t\tvec4 v4 = texture2D( boneTexture, vec2( dx * ( x + 3.5 ), y ) );\n\t\tmat4 bone = mat4( v1, v2, v3, v4 );\n\t\treturn bone;\n\t}\n#endif",skinning_vertex:"#ifdef USE_SKINNING\n\tvec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );\n\tvec4 skinned = vec4( 0.0 );\n\tskinned += boneMatX * skinVertex * skinWeight.x;\n\tskinned += boneMatY * skinVertex * skinWeight.y;\n\tskinned += boneMatZ * skinVertex * skinWeight.z;\n\tskinned += boneMatW * skinVertex * skinWeight.w;\n\ttransformed = ( bindMatrixInverse * skinned ).xyz;\n#endif",skinnormal_vertex:"#ifdef USE_SKINNING\n\tmat4 skinMatrix = mat4( 0.0 );\n\tskinMatrix += skinWeight.x * boneMatX;\n\tskinMatrix += skinWeight.y * boneMatY;\n\tskinMatrix += skinWeight.z * boneMatZ;\n\tskinMatrix += skinWeight.w * boneMatW;\n\tskinMatrix = bindMatrixInverse * skinMatrix * bindMatrix;\n\tobjectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;\n\t#ifdef USE_TANGENT\n\t\tobjectTangent = vec4( skinMatrix * vec4( objectTangent, 0.0 ) ).xyz;\n\t#endif\n#endif",specularmap_fragment:"float specularStrength;\n#ifdef USE_SPECULARMAP\n\tvec4 texelSpecular = texture2D( specularMap, vUv );\n\tspecularStrength = texelSpecular.r;\n#else\n\tspecularStrength = 1.0;\n#endif",specularmap_pars_fragment:"#ifdef USE_SPECULARMAP\n\tuniform sampler2D specularMap;\n#endif",tonemapping_fragment:"#if defined( TONE_MAPPING )\n\tgl_FragColor.rgb = toneMapping( gl_FragColor.rgb );\n#endif",tonemapping_pars_fragment:"#ifndef saturate\n#define saturate( a ) clamp( a, 0.0, 1.0 )\n#endif\nuniform float toneMappingExposure;\nvec3 LinearToneMapping( vec3 color ) {\n\treturn toneMappingExposure * color;\n}\nvec3 ReinhardToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\treturn saturate( color / ( vec3( 1.0 ) + color ) );\n}\nvec3 OptimizedCineonToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\tcolor = max( vec3( 0.0 ), color - 0.004 );\n\treturn pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );\n}\nvec3 RRTAndODTFit( vec3 v ) {\n\tvec3 a = v * ( v + 0.0245786 ) - 0.000090537;\n\tvec3 b = v * ( 0.983729 * v + 0.4329510 ) + 0.238081;\n\treturn a / b;\n}\nvec3 ACESFilmicToneMapping( vec3 color ) {\n\tconst mat3 ACESInputMat = mat3(\n\t\tvec3( 0.59719, 0.07600, 0.02840 ),\t\tvec3( 0.35458, 0.90834, 0.13383 ),\n\t\tvec3( 0.04823, 0.01566, 0.83777 )\n\t);\n\tconst mat3 ACESOutputMat = mat3(\n\t\tvec3(  1.60475, -0.10208, -0.00327 ),\t\tvec3( -0.53108,  1.10813, -0.07276 ),\n\t\tvec3( -0.07367, -0.00605,  1.07602 )\n\t);\n\tcolor *= toneMappingExposure / 0.6;\n\tcolor = ACESInputMat * color;\n\tcolor = RRTAndODTFit( color );\n\tcolor = ACESOutputMat * color;\n\treturn saturate( color );\n}\nvec3 CustomToneMapping( vec3 color ) { return color; }",transmission_fragment:"#ifdef USE_TRANSMISSION\n\tmaterial.transmission = transmission;\n\tmaterial.transmissionAlpha = 1.0;\n\tmaterial.thickness = thickness;\n\tmaterial.attenuationDistance = attenuationDistance;\n\tmaterial.attenuationColor = attenuationColor;\n\t#ifdef USE_TRANSMISSIONMAP\n\t\tmaterial.transmission *= texture2D( transmissionMap, vUv ).r;\n\t#endif\n\t#ifdef USE_THICKNESSMAP\n\t\tmaterial.thickness *= texture2D( thicknessMap, vUv ).g;\n\t#endif\n\tvec3 pos = vWorldPosition;\n\tvec3 v = normalize( cameraPosition - pos );\n\tvec3 n = inverseTransformDirection( normal, viewMatrix );\n\tvec4 transmission = getIBLVolumeRefraction(\n\t\tn, v, material.roughness, material.diffuseColor, material.specularColor, material.specularF90,\n\t\tpos, modelMatrix, viewMatrix, projectionMatrix, material.ior, material.thickness,\n\t\tmaterial.attenuationColor, material.attenuationDistance );\n\tmaterial.transmissionAlpha = mix( material.transmissionAlpha, transmission.a, material.transmission );\n\ttotalDiffuse = mix( totalDiffuse, transmission.rgb, material.transmission );\n#endif",transmission_pars_fragment:"#ifdef USE_TRANSMISSION\n\tuniform float transmission;\n\tuniform float thickness;\n\tuniform float attenuationDistance;\n\tuniform vec3 attenuationColor;\n\t#ifdef USE_TRANSMISSIONMAP\n\t\tuniform sampler2D transmissionMap;\n\t#endif\n\t#ifdef USE_THICKNESSMAP\n\t\tuniform sampler2D thicknessMap;\n\t#endif\n\tuniform vec2 transmissionSamplerSize;\n\tuniform sampler2D transmissionSamplerMap;\n\tuniform mat4 modelMatrix;\n\tuniform mat4 projectionMatrix;\n\tvarying vec3 vWorldPosition;\n\tfloat w0( float a ) {\n\t\treturn ( 1.0 / 6.0 ) * ( a * ( a * ( - a + 3.0 ) - 3.0 ) + 1.0 );\n\t}\n\tfloat w1( float a ) {\n\t\treturn ( 1.0 / 6.0 ) * ( a *  a * ( 3.0 * a - 6.0 ) + 4.0 );\n\t}\n\tfloat w2( float a ){\n\t\treturn ( 1.0 / 6.0 ) * ( a * ( a * ( - 3.0 * a + 3.0 ) + 3.0 ) + 1.0 );\n\t}\n\tfloat w3( float a ) {\n\t\treturn ( 1.0 / 6.0 ) * ( a * a * a );\n\t}\n\tfloat g0( float a ) {\n\t\treturn w0( a ) + w1( a );\n\t}\n\tfloat g1( float a ) {\n\t\treturn w2( a ) + w3( a );\n\t}\n\tfloat h0( float a ) {\n\t\treturn - 1.0 + w1( a ) / ( w0( a ) + w1( a ) );\n\t}\n\tfloat h1( float a ) {\n\t\treturn 1.0 + w3( a ) / ( w2( a ) + w3( a ) );\n\t}\n\tvec4 bicubic( sampler2D tex, vec2 uv, vec4 texelSize, vec2 fullSize, float lod ) {\n\t\tuv = uv * texelSize.zw + 0.5;\n\t\tvec2 iuv = floor( uv );\n\t\tvec2 fuv = fract( uv );\n\t\tfloat g0x = g0( fuv.x );\n\t\tfloat g1x = g1( fuv.x );\n\t\tfloat h0x = h0( fuv.x );\n\t\tfloat h1x = h1( fuv.x );\n\t\tfloat h0y = h0( fuv.y );\n\t\tfloat h1y = h1( fuv.y );\n\t\tvec2 p0 = ( vec2( iuv.x + h0x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;\n\t\tvec2 p1 = ( vec2( iuv.x + h1x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;\n\t\tvec2 p2 = ( vec2( iuv.x + h0x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;\n\t\tvec2 p3 = ( vec2( iuv.x + h1x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;\n\t\t\n\t\tvec2 lodFudge = pow( 1.95, lod ) / fullSize;\n\t\treturn g0( fuv.y ) * ( g0x * textureLod( tex, p0, lod ) + g1x * textureLod( tex, p1, lod ) ) +\n\t\t\tg1( fuv.y ) * ( g0x * textureLod( tex, p2, lod ) + g1x * textureLod( tex, p3, lod ) );\n\t}\n\tvec4 textureBicubic( sampler2D sampler, vec2 uv, float lod ) {\n\t\tvec2 fLodSize = vec2( textureSize( sampler, int( lod ) ) );\n\t\tvec2 cLodSize = vec2( textureSize( sampler, int( lod + 1.0 ) ) );\n\t\tvec2 fLodSizeInv = 1.0 / fLodSize;\n\t\tvec2 cLodSizeInv = 1.0 / cLodSize;\n\t\tvec2 fullSize = vec2( textureSize( sampler, 0 ) );\n\t\tvec4 fSample = bicubic( sampler, uv, vec4( fLodSizeInv, fLodSize ), fullSize, floor( lod ) );\n\t\tvec4 cSample = bicubic( sampler, uv, vec4( cLodSizeInv, cLodSize ), fullSize, ceil( lod ) );\n\t\treturn mix( fSample, cSample, fract( lod ) );\n\t}\n\tvec3 getVolumeTransmissionRay( const in vec3 n, const in vec3 v, const in float thickness, const in float ior, const in mat4 modelMatrix ) {\n\t\tvec3 refractionVector = refract( - v, normalize( n ), 1.0 / ior );\n\t\tvec3 modelScale;\n\t\tmodelScale.x = length( vec3( modelMatrix[ 0 ].xyz ) );\n\t\tmodelScale.y = length( vec3( modelMatrix[ 1 ].xyz ) );\n\t\tmodelScale.z = length( vec3( modelMatrix[ 2 ].xyz ) );\n\t\treturn normalize( refractionVector ) * thickness * modelScale;\n\t}\n\tfloat applyIorToRoughness( const in float roughness, const in float ior ) {\n\t\treturn roughness * clamp( ior * 2.0 - 2.0, 0.0, 1.0 );\n\t}\n\tvec4 getTransmissionSample( const in vec2 fragCoord, const in float roughness, const in float ior ) {\n\t\tfloat lod = log2( transmissionSamplerSize.x ) * applyIorToRoughness( roughness, ior );\n\t\treturn textureBicubic( transmissionSamplerMap, fragCoord.xy, lod );\n\t}\n\tvec3 applyVolumeAttenuation( const in vec3 radiance, const in float transmissionDistance, const in vec3 attenuationColor, const in float attenuationDistance ) {\n\t\tif ( isinf( attenuationDistance ) ) {\n\t\t\treturn radiance;\n\t\t} else {\n\t\t\tvec3 attenuationCoefficient = -log( attenuationColor ) / attenuationDistance;\n\t\t\tvec3 transmittance = exp( - attenuationCoefficient * transmissionDistance );\t\t\treturn transmittance * radiance;\n\t\t}\n\t}\n\tvec4 getIBLVolumeRefraction( const in vec3 n, const in vec3 v, const in float roughness, const in vec3 diffuseColor,\n\t\tconst in vec3 specularColor, const in float specularF90, const in vec3 position, const in mat4 modelMatrix,\n\t\tconst in mat4 viewMatrix, const in mat4 projMatrix, const in float ior, const in float thickness,\n\t\tconst in vec3 attenuationColor, const in float attenuationDistance ) {\n\t\tvec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, ior, modelMatrix );\n\t\tvec3 refractedRayExit = position + transmissionRay;\n\t\tvec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );\n\t\tvec2 refractionCoords = ndcPos.xy / ndcPos.w;\n\t\trefractionCoords += 1.0;\n\t\trefractionCoords /= 2.0;\n\t\tvec4 transmittedLight = getTransmissionSample( refractionCoords, roughness, ior );\n\t\tvec3 attenuatedColor = applyVolumeAttenuation( transmittedLight.rgb, length( transmissionRay ), attenuationColor, attenuationDistance );\n\t\tvec3 F = EnvironmentBRDF( n, v, specularColor, specularF90, roughness );\n\t\treturn vec4( ( 1.0 - F ) * attenuatedColor * diffuseColor, transmittedLight.a );\n\t}\n#endif",uv_pars_fragment:"#if ( defined( USE_UV ) && ! defined( UVS_VERTEX_ONLY ) )\n\tvarying vec2 vUv;\n#endif",uv_pars_vertex:"#ifdef USE_UV\n\t#ifdef UVS_VERTEX_ONLY\n\t\tvec2 vUv;\n\t#else\n\t\tvarying vec2 vUv;\n\t#endif\n\tuniform mat3 uvTransform;\n#endif",uv_vertex:"#ifdef USE_UV\n\tvUv = ( uvTransform * vec3( uv, 1 ) ).xy;\n#endif",uv2_pars_fragment:"#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tvarying vec2 vUv2;\n#endif",uv2_pars_vertex:"#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tattribute vec2 uv2;\n\tvarying vec2 vUv2;\n\tuniform mat3 uv2Transform;\n#endif",uv2_vertex:"#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tvUv2 = ( uv2Transform * vec3( uv2, 1 ) ).xy;\n#endif",worldpos_vertex:"#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP ) || defined ( USE_TRANSMISSION ) || NUM_SPOT_LIGHT_COORDS > 0\n\tvec4 worldPosition = vec4( transformed, 1.0 );\n\t#ifdef USE_INSTANCING\n\t\tworldPosition = instanceMatrix * worldPosition;\n\t#endif\n\tworldPosition = modelMatrix * worldPosition;\n#endif",background_vert:"varying vec2 vUv;\nuniform mat3 uvTransform;\nvoid main() {\n\tvUv = ( uvTransform * vec3( uv, 1 ) ).xy;\n\tgl_Position = vec4( position.xy, 1.0, 1.0 );\n}",background_frag:"uniform sampler2D t2D;\nuniform float backgroundIntensity;\nvarying vec2 vUv;\nvoid main() {\n\tvec4 texColor = texture2D( t2D, vUv );\n\t#ifdef DECODE_VIDEO_TEXTURE\n\t\ttexColor = vec4( mix( pow( texColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), texColor.rgb * 0.0773993808, vec3( lessThanEqual( texColor.rgb, vec3( 0.04045 ) ) ) ), texColor.w );\n\t#endif\n\ttexColor.rgb *= backgroundIntensity;\n\tgl_FragColor = texColor;\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n}",backgroundCube_vert:"varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\tgl_Position.z = gl_Position.w;\n}",backgroundCube_frag:"#ifdef ENVMAP_TYPE_CUBE\n\tuniform samplerCube envMap;\n#elif defined( ENVMAP_TYPE_CUBE_UV )\n\tuniform sampler2D envMap;\n#endif\nuniform float flipEnvMap;\nuniform float backgroundBlurriness;\nuniform float backgroundIntensity;\nvarying vec3 vWorldDirection;\n#include <cube_uv_reflection_fragment>\nvoid main() {\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tvec4 texColor = textureCube( envMap, vec3( flipEnvMap * vWorldDirection.x, vWorldDirection.yz ) );\n\t#elif defined( ENVMAP_TYPE_CUBE_UV )\n\t\tvec4 texColor = textureCubeUV( envMap, vWorldDirection, backgroundBlurriness );\n\t#else\n\t\tvec4 texColor = vec4( 0.0, 0.0, 0.0, 1.0 );\n\t#endif\n\ttexColor.rgb *= backgroundIntensity;\n\tgl_FragColor = texColor;\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n}",cube_vert:"varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\tgl_Position.z = gl_Position.w;\n}",cube_frag:"uniform samplerCube tCube;\nuniform float tFlip;\nuniform float opacity;\nvarying vec3 vWorldDirection;\nvoid main() {\n\tvec4 texColor = textureCube( tCube, vec3( tFlip * vWorldDirection.x, vWorldDirection.yz ) );\n\tgl_FragColor = texColor;\n\tgl_FragColor.a *= opacity;\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n}",depth_vert:"#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvarying vec2 vHighPrecisionZW;\nvoid main() {\n\t#include <uv_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_DISPLACEMENTMAP\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvHighPrecisionZW = gl_Position.zw;\n}",depth_frag:"#if DEPTH_PACKING == 3200\n\tuniform float opacity;\n#endif\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvarying vec2 vHighPrecisionZW;\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( 1.0 );\n\t#if DEPTH_PACKING == 3200\n\t\tdiffuseColor.a = opacity;\n\t#endif\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <logdepthbuf_fragment>\n\tfloat fragCoordZ = 0.5 * vHighPrecisionZW[0] / vHighPrecisionZW[1] + 0.5;\n\t#if DEPTH_PACKING == 3200\n\t\tgl_FragColor = vec4( vec3( 1.0 - fragCoordZ ), opacity );\n\t#elif DEPTH_PACKING == 3201\n\t\tgl_FragColor = packDepthToRGBA( fragCoordZ );\n\t#endif\n}",distanceRGBA_vert:"#define DISTANCE\nvarying vec3 vWorldPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_DISPLACEMENTMAP\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <worldpos_vertex>\n\t#include <clipping_planes_vertex>\n\tvWorldPosition = worldPosition.xyz;\n}",distanceRGBA_frag:"#define DISTANCE\nuniform vec3 referencePosition;\nuniform float nearDistance;\nuniform float farDistance;\nvarying vec3 vWorldPosition;\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main () {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( 1.0 );\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\tfloat dist = length( vWorldPosition - referencePosition );\n\tdist = ( dist - nearDistance ) / ( farDistance - nearDistance );\n\tdist = saturate( dist );\n\tgl_FragColor = packDepthToRGBA( dist );\n}",equirect_vert:"varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n}",equirect_frag:"uniform sampler2D tEquirect;\nvarying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvec3 direction = normalize( vWorldDirection );\n\tvec2 sampleUV = equirectUv( direction );\n\tgl_FragColor = texture2D( tEquirect, sampleUV );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n}",linedashed_vert:"uniform float scale;\nattribute float lineDistance;\nvarying float vLineDistance;\n#include <common>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\tvLineDistance = scale * lineDistance;\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n}",linedashed_frag:"uniform vec3 diffuse;\nuniform float opacity;\nuniform float dashSize;\nuniform float totalSize;\nvarying float vLineDistance;\n#include <common>\n#include <color_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tif ( mod( vLineDistance, totalSize ) > dashSize ) {\n\t\tdiscard;\n\t}\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <color_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n}",meshbasic_vert:"#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#if defined ( USE_ENVMAP ) || defined ( USE_SKINNING )\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinbase_vertex>\n\t\t#include <skinnormal_vertex>\n\t\t#include <defaultnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <fog_vertex>\n}",meshbasic_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\t#ifdef USE_LIGHTMAP\n\t\tvec4 lightMapTexel = texture2D( lightMap, vUv2 );\n\t\treflectedLight.indirectDiffuse += lightMapTexel.rgb * lightMapIntensity * RECIPROCAL_PI;\n\t#else\n\t\treflectedLight.indirectDiffuse += vec3( 1.0 );\n\t#endif\n\t#include <aomap_fragment>\n\treflectedLight.indirectDiffuse *= diffuseColor.rgb;\n\tvec3 outgoingLight = reflectedLight.indirectDiffuse;\n\t#include <envmap_fragment>\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshlambert_vert:"#define LAMBERT\nvarying vec3 vViewPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshlambert_frag:"#define LAMBERT\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_lambert_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_lambert_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;\n\t#include <envmap_fragment>\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshmatcap_vert:"#define MATCAP\nvarying vec3 vViewPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <color_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n\tvViewPosition = - mvPosition.xyz;\n}",meshmatcap_frag:"#define MATCAP\nuniform vec3 diffuse;\nuniform float opacity;\nuniform sampler2D matcap;\nvarying vec3 vViewPosition;\n#include <common>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <fog_pars_fragment>\n#include <normal_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\tvec3 viewDir = normalize( vViewPosition );\n\tvec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );\n\tvec3 y = cross( viewDir, x );\n\tvec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5;\n\t#ifdef USE_MATCAP\n\t\tvec4 matcapColor = texture2D( matcap, uv );\n\t#else\n\t\tvec4 matcapColor = vec4( vec3( mix( 0.2, 0.8, uv.y ) ), 1.0 );\n\t#endif\n\tvec3 outgoingLight = diffuseColor.rgb * matcapColor.rgb;\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshnormal_vert:"#define NORMAL\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )\n\tvarying vec3 vViewPosition;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )\n\tvViewPosition = - mvPosition.xyz;\n#endif\n}",meshnormal_frag:"#define NORMAL\nuniform float opacity;\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )\n\tvarying vec3 vViewPosition;\n#endif\n#include <packing>\n#include <uv_pars_fragment>\n#include <normal_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\t#include <logdepthbuf_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\tgl_FragColor = vec4( packNormalToRGB( normal ), opacity );\n\t#ifdef OPAQUE\n\t\tgl_FragColor.a = 1.0;\n\t#endif\n}",meshphong_vert:"#define PHONG\nvarying vec3 vViewPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshphong_frag:"#define PHONG\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform vec3 specular;\nuniform float shininess;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_phong_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_phong_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;\n\t#include <envmap_fragment>\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshphysical_vert:"#define STANDARD\nvarying vec3 vViewPosition;\n#ifdef USE_TRANSMISSION\n\tvarying vec3 vWorldPosition;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n#ifdef USE_TRANSMISSION\n\tvWorldPosition = worldPosition.xyz;\n#endif\n}",meshphysical_frag:"#define STANDARD\n#ifdef PHYSICAL\n\t#define IOR\n\t#define SPECULAR\n#endif\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float roughness;\nuniform float metalness;\nuniform float opacity;\n#ifdef IOR\n\tuniform float ior;\n#endif\n#ifdef SPECULAR\n\tuniform float specularIntensity;\n\tuniform vec3 specularColor;\n\t#ifdef USE_SPECULARINTENSITYMAP\n\t\tuniform sampler2D specularIntensityMap;\n\t#endif\n\t#ifdef USE_SPECULARCOLORMAP\n\t\tuniform sampler2D specularColorMap;\n\t#endif\n#endif\n#ifdef USE_CLEARCOAT\n\tuniform float clearcoat;\n\tuniform float clearcoatRoughness;\n#endif\n#ifdef USE_IRIDESCENCE\n\tuniform float iridescence;\n\tuniform float iridescenceIOR;\n\tuniform float iridescenceThicknessMinimum;\n\tuniform float iridescenceThicknessMaximum;\n#endif\n#ifdef USE_SHEEN\n\tuniform vec3 sheenColor;\n\tuniform float sheenRoughness;\n\t#ifdef USE_SHEENCOLORMAP\n\t\tuniform sampler2D sheenColorMap;\n\t#endif\n\t#ifdef USE_SHEENROUGHNESSMAP\n\t\tuniform sampler2D sheenRoughnessMap;\n\t#endif\n#endif\nvarying vec3 vViewPosition;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <bsdfs>\n#include <iridescence_fragment>\n#include <cube_uv_reflection_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_physical_pars_fragment>\n#include <fog_pars_fragment>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_physical_pars_fragment>\n#include <transmission_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <clearcoat_pars_fragment>\n#include <iridescence_pars_fragment>\n#include <roughnessmap_pars_fragment>\n#include <metalnessmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <roughnessmap_fragment>\n\t#include <metalnessmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <clearcoat_normal_fragment_begin>\n\t#include <clearcoat_normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_physical_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 totalDiffuse = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse;\n\tvec3 totalSpecular = reflectedLight.directSpecular + reflectedLight.indirectSpecular;\n\t#include <transmission_fragment>\n\tvec3 outgoingLight = totalDiffuse + totalSpecular + totalEmissiveRadiance;\n\t#ifdef USE_SHEEN\n\t\tfloat sheenEnergyComp = 1.0 - 0.157 * max3( material.sheenColor );\n\t\toutgoingLight = outgoingLight * sheenEnergyComp + sheenSpecular;\n\t#endif\n\t#ifdef USE_CLEARCOAT\n\t\tfloat dotNVcc = saturate( dot( geometry.clearcoatNormal, geometry.viewDir ) );\n\t\tvec3 Fcc = F_Schlick( material.clearcoatF0, material.clearcoatF90, dotNVcc );\n\t\toutgoingLight = outgoingLight * ( 1.0 - material.clearcoat * Fcc ) + clearcoatSpecular * material.clearcoat;\n\t#endif\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshtoon_vert:"#define TOON\nvarying vec3 vViewPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshtoon_frag:"#define TOON\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <gradientmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_toon_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_toon_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",points_vert:"uniform float size;\nuniform float scale;\n#include <common>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <project_vertex>\n\tgl_PointSize = size;\n\t#ifdef USE_SIZEATTENUATION\n\t\tbool isPerspective = isPerspectiveMatrix( projectionMatrix );\n\t\tif ( isPerspective ) gl_PointSize *= ( scale / - mvPosition.z );\n\t#endif\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <fog_vertex>\n}",points_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#include <common>\n#include <color_pars_fragment>\n#include <map_particle_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_particle_fragment>\n\t#include <color_fragment>\n\t#include <alphatest_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n}",shadow_vert:"#include <common>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <shadowmap_pars_vertex>\nvoid main() {\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",shadow_frag:"uniform vec3 color;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <logdepthbuf_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <shadowmask_pars_fragment>\nvoid main() {\n\t#include <logdepthbuf_fragment>\n\tgl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}",sprite_vert:"uniform float rotation;\nuniform vec2 center;\n#include <common>\n#include <uv_pars_vertex>\n#include <fog_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\tvec4 mvPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );\n\tvec2 scale;\n\tscale.x = length( vec3( modelMatrix[ 0 ].x, modelMatrix[ 0 ].y, modelMatrix[ 0 ].z ) );\n\tscale.y = length( vec3( modelMatrix[ 1 ].x, modelMatrix[ 1 ].y, modelMatrix[ 1 ].z ) );\n\t#ifndef USE_SIZEATTENUATION\n\t\tbool isPerspective = isPerspectiveMatrix( projectionMatrix );\n\t\tif ( isPerspective ) scale *= - mvPosition.z;\n\t#endif\n\tvec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale;\n\tvec2 rotatedPosition;\n\trotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;\n\trotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;\n\tmvPosition.xy += rotatedPosition;\n\tgl_Position = projectionMatrix * mvPosition;\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n}",sprite_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#include <common>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}"},Fi={common:{diffuse:{value:new Un(16777215)},opacity:{value:1},map:{value:null},uvTransform:{value:new Xt},uv2Transform:{value:new Xt},alphaMap:{value:null},alphaTest:{value:0}},specularmap:{specularMap:{value:null}},envmap:{envMap:{value:null},flipEnvMap:{value:-1},reflectivity:{value:1},ior:{value:1.5},refractionRatio:{value:.98}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1}},emissivemap:{emissiveMap:{value:null}},bumpmap:{bumpMap:{value:null},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalScale:{value:new Wt(1,1)}},displacementmap:{displacementMap:{value:null},displacementScale:{value:1},displacementBias:{value:0}},roughnessmap:{roughnessMap:{value:null}},metalnessmap:{metalnessMap:{value:null}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:25e-5},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new Un(16777215)}},lights:{ambientLightColor:{value:[]},lightProbe:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{}}},directionalLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{}}},spotLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},spotLightMap:{value:[]},spotShadowMap:{value:[]},spotLightMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{}}},pointLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{},shadowCameraNear:{},shadowCameraFar:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}},ltc_1:{value:null},ltc_2:{value:null}},points:{diffuse:{value:new Un(16777215)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},alphaMap:{value:null},alphaTest:{value:0},uvTransform:{value:new Xt}},sprite:{diffuse:{value:new Un(16777215)},opacity:{value:1},center:{value:new Wt(.5,.5)},rotation:{value:0},map:{value:null},alphaMap:{value:null},alphaTest:{value:0},uvTransform:{value:new Xt}}},Bi={basic:{uniforms:vi([Fi.common,Fi.specularmap,Fi.envmap,Fi.aomap,Fi.lightmap,Fi.fog]),vertexShader:ki.meshbasic_vert,fragmentShader:ki.meshbasic_frag},lambert:{uniforms:vi([Fi.common,Fi.specularmap,Fi.envmap,Fi.aomap,Fi.lightmap,Fi.emissivemap,Fi.bumpmap,Fi.normalmap,Fi.displacementmap,Fi.fog,Fi.lights,{emissive:{value:new Un(0)}}]),vertexShader:ki.meshlambert_vert,fragmentShader:ki.meshlambert_frag},phong:{uniforms:vi([Fi.common,Fi.specularmap,Fi.envmap,Fi.aomap,Fi.lightmap,Fi.emissivemap,Fi.bumpmap,Fi.normalmap,Fi.displacementmap,Fi.fog,Fi.lights,{emissive:{value:new Un(0)},specular:{value:new Un(1118481)},shininess:{value:30}}]),vertexShader:ki.meshphong_vert,fragmentShader:ki.meshphong_frag},standard:{uniforms:vi([Fi.common,Fi.envmap,Fi.aomap,Fi.lightmap,Fi.emissivemap,Fi.bumpmap,Fi.normalmap,Fi.displacementmap,Fi.roughnessmap,Fi.metalnessmap,Fi.fog,Fi.lights,{emissive:{value:new Un(0)},roughness:{value:1},metalness:{value:0},envMapIntensity:{value:1}}]),vertexShader:ki.meshphysical_vert,fragmentShader:ki.meshphysical_frag},toon:{uniforms:vi([Fi.common,Fi.aomap,Fi.lightmap,Fi.emissivemap,Fi.bumpmap,Fi.normalmap,Fi.displacementmap,Fi.gradientmap,Fi.fog,Fi.lights,{emissive:{value:new Un(0)}}]),vertexShader:ki.meshtoon_vert,fragmentShader:ki.meshtoon_frag},matcap:{uniforms:vi([Fi.common,Fi.bumpmap,Fi.normalmap,Fi.displacementmap,Fi.fog,{matcap:{value:null}}]),vertexShader:ki.meshmatcap_vert,fragmentShader:ki.meshmatcap_frag},points:{uniforms:vi([Fi.points,Fi.fog]),vertexShader:ki.points_vert,fragmentShader:ki.points_frag},dashed:{uniforms:vi([Fi.common,Fi.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:ki.linedashed_vert,fragmentShader:ki.linedashed_frag},depth:{uniforms:vi([Fi.common,Fi.displacementmap]),vertexShader:ki.depth_vert,fragmentShader:ki.depth_frag},normal:{uniforms:vi([Fi.common,Fi.bumpmap,Fi.normalmap,Fi.displacementmap,{opacity:{value:1}}]),vertexShader:ki.meshnormal_vert,fragmentShader:ki.meshnormal_frag},sprite:{uniforms:vi([Fi.sprite,Fi.fog]),vertexShader:ki.sprite_vert,fragmentShader:ki.sprite_frag},background:{uniforms:{uvTransform:{value:new Xt},t2D:{value:null},backgroundIntensity:{value:1}},vertexShader:ki.background_vert,fragmentShader:ki.background_frag},backgroundCube:{uniforms:{envMap:{value:null},flipEnvMap:{value:-1},backgroundBlurriness:{value:0},backgroundIntensity:{value:1}},vertexShader:ki.backgroundCube_vert,fragmentShader:ki.backgroundCube_frag},cube:{uniforms:{tCube:{value:null},tFlip:{value:-1},opacity:{value:1}},vertexShader:ki.cube_vert,fragmentShader:ki.cube_frag},equirect:{uniforms:{tEquirect:{value:null}},vertexShader:ki.equirect_vert,fragmentShader:ki.equirect_frag},distanceRGBA:{uniforms:vi([Fi.common,Fi.displacementmap,{referencePosition:{value:new $t},nearDistance:{value:1},farDistance:{value:1e3}}]),vertexShader:ki.distanceRGBA_vert,fragmentShader:ki.distanceRGBA_frag},shadow:{uniforms:vi([Fi.lights,Fi.fog,{color:{value:new Un(0)},opacity:{value:1}}]),vertexShader:ki.shadow_vert,fragmentShader:ki.shadow_frag}};Bi.physical={uniforms:vi([Bi.standard.uniforms,{clearcoat:{value:0},clearcoatMap:{value:null},clearcoatRoughness:{value:0},clearcoatRoughnessMap:{value:null},clearcoatNormalScale:{value:new Wt(1,1)},clearcoatNormalMap:{value:null},iridescence:{value:0},iridescenceMap:{value:null},iridescenceIOR:{value:1.3},iridescenceThicknessMinimum:{value:100},iridescenceThicknessMaximum:{value:400},iridescenceThicknessMap:{value:null},sheen:{value:0},sheenColor:{value:new Un(0)},sheenColorMap:{value:null},sheenRoughness:{value:1},sheenRoughnessMap:{value:null},transmission:{value:0},transmissionMap:{value:null},transmissionSamplerSize:{value:new Wt},transmissionSamplerMap:{value:null},thickness:{value:0},thicknessMap:{value:null},attenuationDistance:{value:0},attenuationColor:{value:new Un(0)},specularIntensity:{value:1},specularIntensityMap:{value:null},specularColor:{value:new Un(1,1,1)},specularColorMap:{value:null}}]),vertexShader:ki.meshphysical_vert,fragmentShader:ki.meshphysical_frag};const zi={r:0,b:0,g:0};function Gi(e,t,r,n,i,s,o){const a=new Un(0);let l,h,d=!0===s?0:1,p=null,f=0,m=null;function g(t,r){t.getRGB(zi,_i(e)),n.buffers.color.setClear(zi.r,zi.g,zi.b,r,o)}return{getClearColor:function(){return a},setClearColor:function(e,t=1){a.set(e),d=t,g(a,d)},getClearAlpha:function(){return d},setClearAlpha:function(e){d=e,g(a,d)},render:function(n,s){let o=!1,y=!0===s.isScene?s.background:null;if(y&&y.isTexture){y=(s.backgroundBlurriness>0?r:t).get(y)}const v=e.xr,_=v.getSession&&v.getSession();_&&"additive"===_.environmentBlendMode&&(y=null),null===y?g(a,d):y&&y.isColor&&(g(y,1),o=!0),(e.autoClear||o)&&e.clear(e.autoClearColor,e.autoClearDepth,e.autoClearStencil),y&&(y.isCubeTexture||y.mapping===re)?(void 0===h&&(h=new fi(new gi(1,1,1),new bi({name:"BackgroundCubeMaterial",uniforms:yi(Bi.backgroundCube.uniforms),vertexShader:Bi.backgroundCube.vertexShader,fragmentShader:Bi.backgroundCube.fragmentShader,side:u,depthTest:!1,depthWrite:!1,fog:!1})),h.geometry.deleteAttribute("normal"),h.geometry.deleteAttribute("uv"),h.onBeforeRender=function(e,t,r){this.matrixWorld.copyPosition(r.matrixWorld)},Object.defineProperty(h.material,"envMap",{get:function(){return this.uniforms.envMap.value}}),i.update(h)),h.material.uniforms.envMap.value=y,h.material.uniforms.flipEnvMap.value=y.isCubeTexture&&!1===y.isRenderTargetTexture?-1:1,h.material.uniforms.backgroundBlurriness.value=s.backgroundBlurriness,h.material.uniforms.backgroundIntensity.value=s.backgroundIntensity,h.material.toneMapped=y.encoding!==_t,p===y&&f===y.version&&m===e.toneMapping||(h.material.needsUpdate=!0,p=y,f=y.version,m=e.toneMapping),h.layers.enableAll(),n.unshift(h,h.geometry,h.material,0,0,null)):y&&y.isTexture&&(void 0===l&&(l=new fi(new Ui(2,2),new bi({name:"BackgroundMaterial",uniforms:yi(Bi.background.uniforms),vertexShader:Bi.background.vertexShader,fragmentShader:Bi.background.fragmentShader,side:c,depthTest:!1,depthWrite:!1,fog:!1})),l.geometry.deleteAttribute("normal"),Object.defineProperty(l.material,"map",{get:function(){return this.uniforms.t2D.value}}),i.update(l)),l.material.uniforms.t2D.value=y,l.material.uniforms.backgroundIntensity.value=s.backgroundIntensity,l.material.toneMapped=y.encoding!==_t,!0===y.matrixAutoUpdate&&y.updateMatrix(),l.material.uniforms.uvTransform.value.copy(y.matrix),p===y&&f===y.version&&m===e.toneMapping||(l.material.needsUpdate=!0,p=y,f=y.version,m=e.toneMapping),l.layers.enableAll(),n.unshift(l,l.geometry,l.material,0,0,null))}}}function Vi(e,t,r,n){const i=e.getParameter(e.MAX_VERTEX_ATTRIBS),s=n.isWebGL2?null:t.get("OES_vertex_array_object"),o=n.isWebGL2||null!==s,a={},l=p(null);let c=l,u=!1;function h(t){return n.isWebGL2?e.bindVertexArray(t):s.bindVertexArrayOES(t)}function d(t){return n.isWebGL2?e.deleteVertexArray(t):s.deleteVertexArrayOES(t)}function p(e){const t=[],r=[],n=[];for(let e=0;e<i;e++)t[e]=0,r[e]=0,n[e]=0;return{geometry:null,program:null,wireframe:!1,newAttributes:t,enabledAttributes:r,attributeDivisors:n,object:e,attributes:{},index:null}}function f(){const e=c.newAttributes;for(let t=0,r=e.length;t<r;t++)e[t]=0}function m(e){g(e,0)}function g(r,i){const s=c.newAttributes,o=c.enabledAttributes,a=c.attributeDivisors;if(s[r]=1,0===o[r]&&(e.enableVertexAttribArray(r),o[r]=1),a[r]!==i){(n.isWebGL2?e:t.get("ANGLE_instanced_arrays"))[n.isWebGL2?"vertexAttribDivisor":"vertexAttribDivisorANGLE"](r,i),a[r]=i}}function y(){const t=c.newAttributes,r=c.enabledAttributes;for(let n=0,i=r.length;n<i;n++)r[n]!==t[n]&&(e.disableVertexAttribArray(n),r[n]=0)}function v(t,r,i,s,o,a){!0!==n.isWebGL2||i!==e.INT&&i!==e.UNSIGNED_INT?e.vertexAttribPointer(t,r,i,s,o,a):e.vertexAttribIPointer(t,r,i,o,a)}function _(){x(),u=!0,c!==l&&(c=l,h(c.object))}function x(){l.geometry=null,l.program=null,l.wireframe=!1}return{setup:function(i,l,d,_,x){let b=!1;if(o){const t=function(t,r,i){const o=!0===i.wireframe;let l=a[t.id];void 0===l&&(l={},a[t.id]=l);let c=l[r.id];void 0===c&&(c={},l[r.id]=c);let u=c[o];void 0===u&&(u=p(n.isWebGL2?e.createVertexArray():s.createVertexArrayOES()),c[o]=u);return u}(_,d,l);c!==t&&(c=t,h(c.object)),b=function(e,t,r,n){const i=c.attributes,s=t.attributes;let o=0;const a=r.getAttributes();for(const t in a){if(a[t].location>=0){const r=i[t];let n=s[t];if(void 0===n&&("instanceMatrix"===t&&e.instanceMatrix&&(n=e.instanceMatrix),"instanceColor"===t&&e.instanceColor&&(n=e.instanceColor)),void 0===r)return!0;if(r.attribute!==n)return!0;if(n&&r.data!==n.data)return!0;o++}}return c.attributesNum!==o||c.index!==n}(i,_,d,x),b&&function(e,t,r,n){const i={},s=t.attributes;let o=0;const a=r.getAttributes();for(const t in a){if(a[t].location>=0){let r=s[t];void 0===r&&("instanceMatrix"===t&&e.instanceMatrix&&(r=e.instanceMatrix),"instanceColor"===t&&e.instanceColor&&(r=e.instanceColor));const n={};n.attribute=r,r&&r.data&&(n.data=r.data),i[t]=n,o++}}c.attributes=i,c.attributesNum=o,c.index=n}(i,_,d,x)}else{const e=!0===l.wireframe;c.geometry===_.id&&c.program===d.id&&c.wireframe===e||(c.geometry=_.id,c.program=d.id,c.wireframe=e,b=!0)}null!==x&&r.update(x,e.ELEMENT_ARRAY_BUFFER),(b||u)&&(u=!1,function(i,s,o,a){if(!1===n.isWebGL2&&(i.isInstancedMesh||a.isInstancedBufferGeometry)&&null===t.get("ANGLE_instanced_arrays"))return;f();const l=a.attributes,c=o.getAttributes(),u=s.defaultAttributeValues;for(const t in c){const n=c[t];if(n.location>=0){let s=l[t];if(void 0===s&&("instanceMatrix"===t&&i.instanceMatrix&&(s=i.instanceMatrix),"instanceColor"===t&&i.instanceColor&&(s=i.instanceColor)),void 0!==s){const t=s.normalized,o=s.itemSize,l=r.get(s);if(void 0===l)continue;const c=l.buffer,u=l.type,h=l.bytesPerElement;if(s.isInterleavedBufferAttribute){const r=s.data,l=r.stride,d=s.offset;if(r.isInstancedInterleavedBuffer){for(let e=0;e<n.locationSize;e++)g(n.location+e,r.meshPerAttribute);!0!==i.isInstancedMesh&&void 0===a._maxInstanceCount&&(a._maxInstanceCount=r.meshPerAttribute*r.count)}else for(let e=0;e<n.locationSize;e++)m(n.location+e);e.bindBuffer(e.ARRAY_BUFFER,c);for(let e=0;e<n.locationSize;e++)v(n.location+e,o/n.locationSize,u,t,l*h,(d+o/n.locationSize*e)*h)}else{if(s.isInstancedBufferAttribute){for(let e=0;e<n.locationSize;e++)g(n.location+e,s.meshPerAttribute);!0!==i.isInstancedMesh&&void 0===a._maxInstanceCount&&(a._maxInstanceCount=s.meshPerAttribute*s.count)}else for(let e=0;e<n.locationSize;e++)m(n.location+e);e.bindBuffer(e.ARRAY_BUFFER,c);for(let e=0;e<n.locationSize;e++)v(n.location+e,o/n.locationSize,u,t,o*h,o/n.locationSize*e*h)}}else if(void 0!==u){const r=u[t];if(void 0!==r)switch(r.length){case 2:e.vertexAttrib2fv(n.location,r);break;case 3:e.vertexAttrib3fv(n.location,r);break;case 4:e.vertexAttrib4fv(n.location,r);break;default:e.vertexAttrib1fv(n.location,r)}}}}y()}(i,l,d,_),null!==x&&e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,r.get(x).buffer))},reset:_,resetDefaultState:x,dispose:function(){_();for(const e in a){const t=a[e];for(const e in t){const r=t[e];for(const e in r)d(r[e].object),delete r[e];delete t[e]}delete a[e]}},releaseStatesOfGeometry:function(e){if(void 0===a[e.id])return;const t=a[e.id];for(const e in t){const r=t[e];for(const e in r)d(r[e].object),delete r[e];delete t[e]}delete a[e.id]},releaseStatesOfProgram:function(e){for(const t in a){const r=a[t];if(void 0===r[e.id])continue;const n=r[e.id];for(const e in n)d(n[e].object),delete n[e];delete r[e.id]}},initAttributes:f,enableAttribute:m,disableUnusedAttributes:y}}function Hi(e,t,r,n){const i=n.isWebGL2;let s;this.setMode=function(e){s=e},this.render=function(t,n){e.drawArrays(s,t,n),r.update(n,s,1)},this.renderInstances=function(n,o,a){if(0===a)return;let l,c;if(i)l=e,c="drawArraysInstanced";else if(l=t.get("ANGLE_instanced_arrays"),c="drawArraysInstancedANGLE",null===l)return;l[c](s,n,o,a),r.update(o,s,a)}}function Wi(e,t,r){let n;function i(t){if("highp"===t){if(e.getShaderPrecisionFormat(e.VERTEX_SHADER,e.HIGH_FLOAT).precision>0&&e.getShaderPrecisionFormat(e.FRAGMENT_SHADER,e.HIGH_FLOAT).precision>0)return"highp";t="mediump"}return"mediump"===t&&e.getShaderPrecisionFormat(e.VERTEX_SHADER,e.MEDIUM_FLOAT).precision>0&&e.getShaderPrecisionFormat(e.FRAGMENT_SHADER,e.MEDIUM_FLOAT).precision>0?"mediump":"lowp"}const s="undefined"!=typeof WebGL2RenderingContext&&e instanceof WebGL2RenderingContext;let o=void 0!==r.precision?r.precision:"highp";const a=i(o);a!==o&&(o=a);const l=s||t.has("WEBGL_draw_buffers"),c=!0===r.logarithmicDepthBuffer,u=e.getParameter(e.MAX_TEXTURE_IMAGE_UNITS),h=e.getParameter(e.MAX_VERTEX_TEXTURE_IMAGE_UNITS),d=e.getParameter(e.MAX_TEXTURE_SIZE),p=e.getParameter(e.MAX_CUBE_MAP_TEXTURE_SIZE),f=e.getParameter(e.MAX_VERTEX_ATTRIBS),m=e.getParameter(e.MAX_VERTEX_UNIFORM_VECTORS),g=e.getParameter(e.MAX_VARYING_VECTORS),y=e.getParameter(e.MAX_FRAGMENT_UNIFORM_VECTORS),v=h>0,_=s||t.has("OES_texture_float");return{isWebGL2:s,drawBuffers:l,getMaxAnisotropy:function(){if(void 0!==n)return n;if(!0===t.has("EXT_texture_filter_anisotropic")){const r=t.get("EXT_texture_filter_anisotropic");n=e.getParameter(r.MAX_TEXTURE_MAX_ANISOTROPY_EXT)}else n=0;return n},getMaxPrecision:i,precision:o,logarithmicDepthBuffer:c,maxTextures:u,maxVertexTextures:h,maxTextureSize:d,maxCubemapSize:p,maxAttributes:f,maxVertexUniforms:m,maxVaryings:g,maxFragmentUniforms:y,vertexTextures:v,floatFragmentTextures:_,floatVertexTextures:v&&_,maxSamples:s?e.getParameter(e.MAX_SAMPLES):0}}function Xi(e){const t=this;let r=null,n=0,i=!1,s=!1;const o=new Pi,a=new Xt,l={value:null,needsUpdate:!1};function c(e,r,n,i){const s=null!==e?e.length:0;let c=null;if(0!==s){if(c=l.value,!0!==i||null===c){const t=n+4*s,i=r.matrixWorldInverse;a.getNormalMatrix(i),(null===c||c.length<t)&&(c=new Float32Array(t));for(let t=0,r=n;t!==s;++t,r+=4)o.copy(e[t]).applyMatrix4(i,a),o.normal.toArray(c,r),c[r+3]=o.constant}l.value=c,l.needsUpdate=!0}return t.numPlanes=s,t.numIntersection=0,c}this.uniform=l,this.numPlanes=0,this.numIntersection=0,this.init=function(e,t){const r=0!==e.length||t||0!==n||i;return i=t,n=e.length,r},this.beginShadows=function(){s=!0,c(null)},this.endShadows=function(){s=!1},this.setGlobalState=function(e,t){r=c(e,t,0)},this.setState=function(o,a,u){const h=o.clippingPlanes,d=o.clipIntersection,p=o.clipShadows,f=e.get(o);if(!i||null===h||0===h.length||s&&!p)s?c(null):function(){l.value!==r&&(l.value=r,l.needsUpdate=n>0);t.numPlanes=n,t.numIntersection=0}();else{const e=s?0:n,t=4*e;let i=f.clippingState||null;l.value=i,i=c(h,a,t,u);for(let e=0;e!==t;++e)i[e]=r[e];f.clippingState=i,this.numIntersection=d?this.numPlanes:0,this.numPlanes+=e}}}function qi(e){let t=new WeakMap;function r(e,t){return t===ee?e.mapping=Q:t===te&&(e.mapping=$),e}function n(e){const r=e.target;r.removeEventListener("dispose",n);const i=t.get(r);void 0!==i&&(t.delete(r),i.dispose())}return{get:function(i){if(i&&i.isTexture&&!1===i.isRenderTargetTexture){const s=i.mapping;if(s===ee||s===te){if(t.has(i)){return r(t.get(i).texture,i.mapping)}{const s=i.image;if(s&&s.height>0){const o=new Ai(s.height/2);return o.fromEquirectangularTexture(e,i),t.set(i,o),i.addEventListener("dispose",n),r(o.texture,i.mapping)}return null}}}return i},dispose:function(){t=new WeakMap}}}class Yi extends wi{constructor(e=-1,t=1,r=1,n=-1,i=.1,s=2e3){super(),this.isOrthographicCamera=!0,this.type="OrthographicCamera",this.zoom=1,this.view=null,this.left=e,this.right=t,this.top=r,this.bottom=n,this.near=i,this.far=s,this.updateProjectionMatrix()}copy(e,t){return super.copy(e,t),this.left=e.left,this.right=e.right,this.top=e.top,this.bottom=e.bottom,this.near=e.near,this.far=e.far,this.zoom=e.zoom,this.view=null===e.view?null:Object.assign({},e.view),this}setViewOffset(e,t,r,n,i,s){null===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=r,this.view.offsetY=n,this.view.width=i,this.view.height=s,this.updateProjectionMatrix()}clearViewOffset(){null!==this.view&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const e=(this.right-this.left)/(2*this.zoom),t=(this.top-this.bottom)/(2*this.zoom),r=(this.right+this.left)/2,n=(this.top+this.bottom)/2;let i=r-e,s=r+e,o=n+t,a=n-t;if(null!==this.view&&this.view.enabled){const e=(this.right-this.left)/this.view.fullWidth/this.zoom,t=(this.top-this.bottom)/this.view.fullHeight/this.zoom;i+=e*this.view.offsetX,s=i+e*this.view.width,o-=t*this.view.offsetY,a=o-t*this.view.height}this.projectionMatrix.makeOrthographic(i,s,o,a,this.near,this.far),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){const t=super.toJSON(e);return t.object.zoom=this.zoom,t.object.left=this.left,t.object.right=this.right,t.object.top=this.top,t.object.bottom=this.bottom,t.object.near=this.near,t.object.far=this.far,null!==this.view&&(t.object.view=Object.assign({},this.view)),t}}const Zi=4,Ji=[.125,.215,.35,.446,.526,.582],Ki=20,Qi=new Yi,$i=new Un;let es=null;const ts=(1+Math.sqrt(5))/2,rs=1/ts,ns=[new $t(1,1,1),new $t(-1,1,1),new $t(1,1,-1),new $t(-1,1,-1),new $t(0,ts,rs),new $t(0,ts,-rs),new $t(rs,0,ts),new $t(-rs,0,ts),new $t(ts,rs,0),new $t(-ts,rs,0)];class is{constructor(e){this._renderer=e,this._pingPongRenderTarget=null,this._lodMax=0,this._cubeSize=0,this._lodPlanes=[],this._sizeLods=[],this._sigmas=[],this._blurMaterial=null,this._cubemapMaterial=null,this._equirectMaterial=null,this._compileMaterial(this._blurMaterial)}fromScene(e,t=0,r=.1,n=100){es=this._renderer.getRenderTarget(),this._setSize(256);const i=this._allocateTargets();return i.depthBuffer=!0,this._sceneToCubeUV(e,r,n,i),t>0&&this._blur(i,0,0,t),this._applyPMREM(i),this._cleanup(i),i}fromEquirectangular(e,t=null){return this._fromTexture(e,t)}fromCubemap(e,t=null){return this._fromTexture(e,t)}compileCubemapShader(){null===this._cubemapMaterial&&(this._cubemapMaterial=ls(),this._compileMaterial(this._cubemapMaterial))}compileEquirectangularShader(){null===this._equirectMaterial&&(this._equirectMaterial=as(),this._compileMaterial(this._equirectMaterial))}dispose(){this._dispose(),null!==this._cubemapMaterial&&this._cubemapMaterial.dispose(),null!==this._equirectMaterial&&this._equirectMaterial.dispose()}_setSize(e){this._lodMax=Math.floor(Math.log2(e)),this._cubeSize=Math.pow(2,this._lodMax)}_dispose(){null!==this._blurMaterial&&this._blurMaterial.dispose(),null!==this._pingPongRenderTarget&&this._pingPongRenderTarget.dispose();for(let e=0;e<this._lodPlanes.length;e++)this._lodPlanes[e].dispose()}_cleanup(e){this._renderer.setRenderTarget(es),e.scissorTest=!1,os(e,0,0,e.width,e.height)}_fromTexture(e,t){e.mapping===Q||e.mapping===$?this._setSize(0===e.image.length?16:e.image[0].width||e.image[0].image.width):this._setSize(e.image.width/4),es=this._renderer.getRenderTarget();const r=t||this._allocateTargets();return this._textureToCubeUV(e,r),this._applyPMREM(r),this._cleanup(r),r}_allocateTargets(){const e=3*Math.max(this._cubeSize,112),t=4*this._cubeSize,r={magFilter:ce,minFilter:ce,generateMipmaps:!1,type:_e,format:Me,encoding:vt,depthBuffer:!1},n=ss(e,t,r);if(null===this._pingPongRenderTarget||this._pingPongRenderTarget.width!==e||this._pingPongRenderTarget.height!==t){null!==this._pingPongRenderTarget&&this._dispose(),this._pingPongRenderTarget=ss(e,t,r);const{_lodMax:n}=this;({sizeLods:this._sizeLods,lodPlanes:this._lodPlanes,sigmas:this._sigmas}=function(e){const t=[],r=[],n=[];let i=e;const s=e-Zi+1+Ji.length;for(let o=0;o<s;o++){const s=Math.pow(2,i);r.push(s);let a=1/s;o>e-Zi?a=Ji[o-e+Zi-1]:0===o&&(a=0),n.push(a);const l=1/(s-2),c=-l,u=1+l,h=[c,c,u,c,u,u,c,c,u,u,c,u],d=6,p=6,f=3,m=2,g=1,y=new Float32Array(f*p*d),v=new Float32Array(m*p*d),_=new Float32Array(g*p*d);for(let e=0;e<d;e++){const t=e%3*2/3-1,r=e>2?0:-1,n=[t,r,0,t+2/3,r,0,t+2/3,r+1,0,t,r,0,t+2/3,r+1,0,t,r+1,0];y.set(n,f*p*e),v.set(h,m*p*e);const i=[e,e,e,e,e,e];_.set(i,g*p*e)}const x=new $n;x.setAttribute("position",new Gn(y,f)),x.setAttribute("uv",new Gn(v,m)),x.setAttribute("faceIndex",new Gn(_,g)),t.push(x),i>Zi&&i--}return{lodPlanes:t,sizeLods:r,sigmas:n}}(n)),this._blurMaterial=function(e,t,r){const n=new Float32Array(Ki),i=new $t(0,1,0),s=new bi({name:"SphericalGaussianBlur",defines:{n:Ki,CUBEUV_TEXEL_WIDTH:1/t,CUBEUV_TEXEL_HEIGHT:1/r,CUBEUV_MAX_MIP:`${e}.0`},uniforms:{envMap:{value:null},samples:{value:1},weights:{value:n},latitudinal:{value:!1},dTheta:{value:0},mipInt:{value:0},poleAxis:{value:i}},vertexShader:cs(),fragmentShader:"\n\n\t\t\tprecision mediump float;\n\t\t\tprecision mediump int;\n\n\t\t\tvarying vec3 vOutputDirection;\n\n\t\t\tuniform sampler2D envMap;\n\t\t\tuniform int samples;\n\t\t\tuniform float weights[ n ];\n\t\t\tuniform bool latitudinal;\n\t\t\tuniform float dTheta;\n\t\t\tuniform float mipInt;\n\t\t\tuniform vec3 poleAxis;\n\n\t\t\t#define ENVMAP_TYPE_CUBE_UV\n\t\t\t#include <cube_uv_reflection_fragment>\n\n\t\t\tvec3 getSample( float theta, vec3 axis ) {\n\n\t\t\t\tfloat cosTheta = cos( theta );\n\t\t\t\t// Rodrigues' axis-angle rotation\n\t\t\t\tvec3 sampleDirection = vOutputDirection * cosTheta\n\t\t\t\t\t+ cross( axis, vOutputDirection ) * sin( theta )\n\t\t\t\t\t+ axis * dot( axis, vOutputDirection ) * ( 1.0 - cosTheta );\n\n\t\t\t\treturn bilinearCubeUV( envMap, sampleDirection, mipInt );\n\n\t\t\t}\n\n\t\t\tvoid main() {\n\n\t\t\t\tvec3 axis = latitudinal ? poleAxis : cross( poleAxis, vOutputDirection );\n\n\t\t\t\tif ( all( equal( axis, vec3( 0.0 ) ) ) ) {\n\n\t\t\t\t\taxis = vec3( vOutputDirection.z, 0.0, - vOutputDirection.x );\n\n\t\t\t\t}\n\n\t\t\t\taxis = normalize( axis );\n\n\t\t\t\tgl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );\n\t\t\t\tgl_FragColor.rgb += weights[ 0 ] * getSample( 0.0, axis );\n\n\t\t\t\tfor ( int i = 1; i < n; i++ ) {\n\n\t\t\t\t\tif ( i >= samples ) {\n\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t}\n\n\t\t\t\t\tfloat theta = dTheta * float( i );\n\t\t\t\t\tgl_FragColor.rgb += weights[ i ] * getSample( -1.0 * theta, axis );\n\t\t\t\t\tgl_FragColor.rgb += weights[ i ] * getSample( theta, axis );\n\n\t\t\t\t}\n\n\t\t\t}\n\t\t",blending:d,depthTest:!1,depthWrite:!1});return s}(n,e,t)}return n}_compileMaterial(e){const t=new fi(this._lodPlanes[0],e);this._renderer.compile(t,Qi)}_sceneToCubeUV(e,t,r,n){const i=new Si(90,1,t,r),s=[1,-1,1,1,1,1],o=[1,1,1,-1,-1,-1],a=this._renderer,l=a.autoClear,c=a.toneMapping;a.getClearColor($i),a.toneMapping=W,a.autoClear=!1;const h=new Fn({name:"PMREM.Background",side:u,depthWrite:!1,depthTest:!1}),d=new fi(new gi,h);let p=!1;const f=e.background;f?f.isColor&&(h.color.copy(f),e.background=null,p=!0):(h.color.copy($i),p=!0);for(let t=0;t<6;t++){const r=t%3;0===r?(i.up.set(0,s[t],0),i.lookAt(o[t],0,0)):1===r?(i.up.set(0,0,s[t]),i.lookAt(0,o[t],0)):(i.up.set(0,s[t],0),i.lookAt(0,0,o[t]));const l=this._cubeSize;os(n,r*l,t>2?l:0,l,l),a.setRenderTarget(n),p&&a.render(d,i),a.render(e,i)}d.geometry.dispose(),d.material.dispose(),a.toneMapping=c,a.autoClear=l,e.background=f}_textureToCubeUV(e,t){const r=this._renderer,n=e.mapping===Q||e.mapping===$;n?(null===this._cubemapMaterial&&(this._cubemapMaterial=ls()),this._cubemapMaterial.uniforms.flipEnvMap.value=!1===e.isRenderTargetTexture?-1:1):null===this._equirectMaterial&&(this._equirectMaterial=as());const i=n?this._cubemapMaterial:this._equirectMaterial,s=new fi(this._lodPlanes[0],i);i.uniforms.envMap.value=e;const o=this._cubeSize;os(t,0,0,3*o,2*o),r.setRenderTarget(t),r.render(s,Qi)}_applyPMREM(e){const t=this._renderer,r=t.autoClear;t.autoClear=!1;for(let t=1;t<this._lodPlanes.length;t++){const r=Math.sqrt(this._sigmas[t]*this._sigmas[t]-this._sigmas[t-1]*this._sigmas[t-1]),n=ns[(t-1)%ns.length];this._blur(e,t-1,t,r,n)}t.autoClear=r}_blur(e,t,r,n,i){const s=this._pingPongRenderTarget;this._halfBlur(e,s,t,r,n,"latitudinal",i),this._halfBlur(s,e,r,r,n,"longitudinal",i)}_halfBlur(e,t,r,n,i,s,o){const a=this._renderer,l=this._blurMaterial,c=new fi(this._lodPlanes[n],l),u=l.uniforms,h=this._sizeLods[r]-1,d=isFinite(i)?Math.PI/(2*h):2*Math.PI/(2*Ki-1),p=i/d,f=isFinite(i)?1+Math.floor(3*p):Ki,m=[];let g=0;for(let e=0;e<Ki;++e){const t=e/p,r=Math.exp(-t*t/2);m.push(r),0===e?g+=r:e<f&&(g+=2*r)}for(let e=0;e<m.length;e++)m[e]=m[e]/g;u.envMap.value=e.texture,u.samples.value=f,u.weights.value=m,u.latitudinal.value="latitudinal"===s,o&&(u.poleAxis.value=o);const{_lodMax:y}=this;u.dTheta.value=d,u.mipInt.value=y-r;const v=this._sizeLods[n];os(t,3*v*(n>y-Zi?n-y+Zi:0),4*(this._cubeSize-v),3*v,2*v),a.setRenderTarget(t),a.render(c,Qi)}}function ss(e,t,r){const n=new yr(e,t,r);return n.texture.mapping=re,n.texture.name="PMREM.cubeUv",n.scissorTest=!0,n}function os(e,t,r,n,i){e.viewport.set(t,r,n,i),e.scissor.set(t,r,n,i)}function as(){return new bi({name:"EquirectangularToCubeUV",uniforms:{envMap:{value:null}},vertexShader:cs(),fragmentShader:"\n\n\t\t\tprecision mediump float;\n\t\t\tprecision mediump int;\n\n\t\t\tvarying vec3 vOutputDirection;\n\n\t\t\tuniform sampler2D envMap;\n\n\t\t\t#include <common>\n\n\t\t\tvoid main() {\n\n\t\t\t\tvec3 outputDirection = normalize( vOutputDirection );\n\t\t\t\tvec2 uv = equirectUv( outputDirection );\n\n\t\t\t\tgl_FragColor = vec4( texture2D ( envMap, uv ).rgb, 1.0 );\n\n\t\t\t}\n\t\t",blending:d,depthTest:!1,depthWrite:!1})}function ls(){return new bi({name:"CubemapToCubeUV",uniforms:{envMap:{value:null},flipEnvMap:{value:-1}},vertexShader:cs(),fragmentShader:"\n\n\t\t\tprecision mediump float;\n\t\t\tprecision mediump int;\n\n\t\t\tuniform float flipEnvMap;\n\n\t\t\tvarying vec3 vOutputDirection;\n\n\t\t\tuniform samplerCube envMap;\n\n\t\t\tvoid main() {\n\n\t\t\t\tgl_FragColor = textureCube( envMap, vec3( flipEnvMap * vOutputDirection.x, vOutputDirection.yz ) );\n\n\t\t\t}\n\t\t",blending:d,depthTest:!1,depthWrite:!1})}function cs(){return"\n\n\t\tprecision mediump float;\n\t\tprecision mediump int;\n\n\t\tattribute float faceIndex;\n\n\t\tvarying vec3 vOutputDirection;\n\n\t\t// RH coordinate system; PMREM face-indexing convention\n\t\tvec3 getDirection( vec2 uv, float face ) {\n\n\t\t\tuv = 2.0 * uv - 1.0;\n\n\t\t\tvec3 direction = vec3( uv, 1.0 );\n\n\t\t\tif ( face == 0.0 ) {\n\n\t\t\t\tdirection = direction.zyx; // ( 1, v, u ) pos x\n\n\t\t\t} else if ( face == 1.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xz *= -1.0; // ( -u, 1, -v ) pos y\n\n\t\t\t} else if ( face == 2.0 ) {\n\n\t\t\t\tdirection.x *= -1.0; // ( -u, v, 1 ) pos z\n\n\t\t\t} else if ( face == 3.0 ) {\n\n\t\t\t\tdirection = direction.zyx;\n\t\t\t\tdirection.xz *= -1.0; // ( -1, v, -u ) neg x\n\n\t\t\t} else if ( face == 4.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xy *= -1.0; // ( -u, -1, v ) neg y\n\n\t\t\t} else if ( face == 5.0 ) {\n\n\t\t\t\tdirection.z *= -1.0; // ( u, v, -1 ) neg z\n\n\t\t\t}\n\n\t\t\treturn direction;\n\n\t\t}\n\n\t\tvoid main() {\n\n\t\t\tvOutputDirection = getDirection( uv, faceIndex );\n\t\t\tgl_Position = vec4( position, 1.0 );\n\n\t\t}\n\t"}function us(e){let t=new WeakMap,r=null;function n(e){const r=e.target;r.removeEventListener("dispose",n);const i=t.get(r);void 0!==i&&(t.delete(r),i.dispose())}return{get:function(i){if(i&&i.isTexture){const s=i.mapping,o=s===ee||s===te,a=s===Q||s===$;if(o||a){if(i.isRenderTargetTexture&&!0===i.needsPMREMUpdate){i.needsPMREMUpdate=!1;let n=t.get(i);return null===r&&(r=new is(e)),n=o?r.fromEquirectangular(i,n):r.fromCubemap(i,n),t.set(i,n),n.texture}if(t.has(i))return t.get(i).texture;{const s=i.image;if(o&&s&&s.height>0||a&&s&&function(e){let t=0;const r=6;for(let n=0;n<r;n++)void 0!==e[n]&&t++;return t===r}(s)){null===r&&(r=new is(e));const s=o?r.fromEquirectangular(i):r.fromCubemap(i);return t.set(i,s),i.addEventListener("dispose",n),s.texture}return null}}}return i},dispose:function(){t=new WeakMap,null!==r&&(r.dispose(),r=null)}}}function hs(e){const t={};function r(r){if(void 0!==t[r])return t[r];let n;switch(r){case"WEBGL_depth_texture":n=e.getExtension("WEBGL_depth_texture")||e.getExtension("MOZ_WEBGL_depth_texture")||e.getExtension("WEBKIT_WEBGL_depth_texture");break;case"EXT_texture_filter_anisotropic":n=e.getExtension("EXT_texture_filter_anisotropic")||e.getExtension("MOZ_EXT_texture_filter_anisotropic")||e.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":n=e.getExtension("WEBGL_compressed_texture_s3tc")||e.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||e.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":n=e.getExtension("WEBGL_compressed_texture_pvrtc")||e.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;default:n=e.getExtension(r)}return t[r]=n,n}return{has:function(e){return null!==r(e)},init:function(e){e.isWebGL2?r("EXT_color_buffer_float"):(r("WEBGL_depth_texture"),r("OES_texture_float"),r("OES_texture_half_float"),r("OES_texture_half_float_linear"),r("OES_standard_derivatives"),r("OES_element_index_uint"),r("OES_vertex_array_object"),r("ANGLE_instanced_arrays")),r("OES_texture_float_linear"),r("EXT_color_buffer_half_float"),r("WEBGL_multisampled_render_to_texture")},get:function(e){const t=r(e);return t}}}function ds(e,t,r,n){const i={},s=new WeakMap;function o(e){const a=e.target;null!==a.index&&t.remove(a.index);for(const e in a.attributes)t.remove(a.attributes[e]);a.removeEventListener("dispose",o),delete i[a.id];const l=s.get(a);l&&(t.remove(l),s.delete(a)),n.releaseStatesOfGeometry(a),!0===a.isInstancedBufferGeometry&&delete a._maxInstanceCount,r.memory.geometries--}function a(e){const r=[],n=e.index,i=e.attributes.position;let o=0;if(null!==n){const e=n.array;o=n.version;for(let t=0,n=e.length;t<n;t+=3){const n=e[t+0],i=e[t+1],s=e[t+2];r.push(n,i,i,s,s,n)}}else{const e=i.array;o=i.version;for(let t=0,n=e.length/3-1;t<n;t+=3){const e=t+0,n=t+1,i=t+2;r.push(e,n,n,i,i,e)}}const a=new(Yt(r)?Hn:Vn)(r,1);a.version=o;const l=s.get(e);l&&t.remove(l),s.set(e,a)}return{get:function(e,t){return!0===i[t.id]||(t.addEventListener("dispose",o),i[t.id]=!0,r.memory.geometries++),t},update:function(r){const n=r.attributes;for(const r in n)t.update(n[r],e.ARRAY_BUFFER);const i=r.morphAttributes;for(const r in i){const n=i[r];for(let r=0,i=n.length;r<i;r++)t.update(n[r],e.ARRAY_BUFFER)}},getWireframeAttribute:function(e){const t=s.get(e);if(t){const r=e.index;null!==r&&t.version<r.version&&a(e)}else a(e);return s.get(e)}}}function ps(e,t,r,n){const i=n.isWebGL2;let s,o,a;this.setMode=function(e){s=e},this.setIndex=function(e){o=e.type,a=e.bytesPerElement},this.render=function(t,n){e.drawElements(s,n,o,t*a),r.update(n,s,1)},this.renderInstances=function(n,l,c){if(0===c)return;let u,h;if(i)u=e,h="drawElementsInstanced";else if(u=t.get("ANGLE_instanced_arrays"),h="drawElementsInstancedANGLE",null===u)return;u[h](s,l,o,n*a,c),r.update(l,s,c)}}function fs(e){const t={frame:0,calls:0,triangles:0,points:0,lines:0};return{memory:{geometries:0,textures:0},render:t,programs:null,autoReset:!0,reset:function(){t.frame++,t.calls=0,t.triangles=0,t.points=0,t.lines=0},update:function(r,n,i){switch(t.calls++,n){case e.TRIANGLES:t.triangles+=i*(r/3);break;case e.LINES:t.lines+=i*(r/2);break;case e.LINE_STRIP:t.lines+=i*(r-1);break;case e.LINE_LOOP:t.lines+=i*r;break;case e.POINTS:t.points+=i*r}}}}function ms(e,t){return e[0]-t[0]}function gs(e,t){return Math.abs(t[1])-Math.abs(e[1])}function ys(e,t,r){const n={},i=new Float32Array(8),s=new WeakMap,o=new gr,a=[];for(let e=0;e<8;e++)a[e]=[e,0];return{update:function(l,c,u){const h=l.morphTargetInfluences;if(!0===t.isWebGL2){const d=c.morphAttributes.position||c.morphAttributes.normal||c.morphAttributes.color,p=void 0!==d?d.length:0;let f=s.get(c);if(void 0===f||f.count!==p){void 0!==f&&f.texture.dispose();const y=void 0!==c.morphAttributes.position,v=void 0!==c.morphAttributes.normal,_=void 0!==c.morphAttributes.color,x=c.morphAttributes.position||[],b=c.morphAttributes.normal||[],w=c.morphAttributes.color||[];let S=0;!0===y&&(S=1),!0===v&&(S=2),!0===_&&(S=3);let M=c.attributes.position.count*S,T=1;M>t.maxTextureSize&&(T=Math.ceil(M/t.maxTextureSize),M=t.maxTextureSize);const E=new Float32Array(M*T*4*p),A=new vr(E,M,T,p);A.type=ve,A.needsUpdate=!0;const C=4*S;for(let R=0;R<p;R++){const P=x[R],j=b[R],I=w[R],D=M*T*4*R;for(let O=0;O<P.count;O++){const N=O*C;!0===y&&(o.fromBufferAttribute(P,O),E[D+N+0]=o.x,E[D+N+1]=o.y,E[D+N+2]=o.z,E[D+N+3]=0),!0===v&&(o.fromBufferAttribute(j,O),E[D+N+4]=o.x,E[D+N+5]=o.y,E[D+N+6]=o.z,E[D+N+7]=0),!0===_&&(o.fromBufferAttribute(I,O),E[D+N+8]=o.x,E[D+N+9]=o.y,E[D+N+10]=o.z,E[D+N+11]=4===I.itemSize?o.w:1)}}function L(){A.dispose(),s.delete(c),c.removeEventListener("dispose",L)}f={count:p,texture:A,size:new Wt(M,T)},s.set(c,f),c.addEventListener("dispose",L)}let m=0;for(let U=0;U<h.length;U++)m+=h[U];const g=c.morphTargetsRelative?1:1-m;u.getUniforms().setValue(e,"morphTargetBaseInfluence",g),u.getUniforms().setValue(e,"morphTargetInfluences",h),u.getUniforms().setValue(e,"morphTargetsTexture",f.texture,r),u.getUniforms().setValue(e,"morphTargetsTextureSize",f.size)}else{const k=void 0===h?0:h.length;let F=n[c.id];if(void 0===F||F.length!==k){F=[];for(let H=0;H<k;H++)F[H]=[H,0];n[c.id]=F}for(let W=0;W<k;W++){const X=F[W];X[0]=W,X[1]=h[W]}F.sort(gs);for(let q=0;q<8;q++)q<k&&F[q][1]?(a[q][0]=F[q][0],a[q][1]=F[q][1]):(a[q][0]=Number.MAX_SAFE_INTEGER,a[q][1]=0);a.sort(ms);const B=c.morphAttributes.position,z=c.morphAttributes.normal;let G=0;for(let Y=0;Y<8;Y++){const Z=a[Y],J=Z[0],K=Z[1];J!==Number.MAX_SAFE_INTEGER&&K?(B&&c.getAttribute("morphTarget"+Y)!==B[J]&&c.setAttribute("morphTarget"+Y,B[J]),z&&c.getAttribute("morphNormal"+Y)!==z[J]&&c.setAttribute("morphNormal"+Y,z[J]),i[Y]=K,G+=K):(B&&!0===c.hasAttribute("morphTarget"+Y)&&c.deleteAttribute("morphTarget"+Y),z&&!0===c.hasAttribute("morphNormal"+Y)&&c.deleteAttribute("morphNormal"+Y),i[Y]=0)}const V=c.morphTargetsRelative?1:1-G;u.getUniforms().setValue(e,"morphTargetBaseInfluence",V),u.getUniforms().setValue(e,"morphTargetInfluences",i)}}}}function vs(e,t,r,n){let i=new WeakMap;function s(e){const t=e.target;t.removeEventListener("dispose",s),r.remove(t.instanceMatrix),null!==t.instanceColor&&r.remove(t.instanceColor)}return{update:function(o){const a=n.render.frame,l=o.geometry,c=t.get(o,l);return i.get(c)!==a&&(t.update(c),i.set(c,a)),o.isInstancedMesh&&(!1===o.hasEventListener("dispose",s)&&o.addEventListener("dispose",s),r.update(o.instanceMatrix,e.ARRAY_BUFFER),null!==o.instanceColor&&r.update(o.instanceColor,e.ARRAY_BUFFER)),c},dispose:function(){i=new WeakMap}}}const _s=new mr,xs=new vr,bs=new _r,ws=new Ei,Ss=[],Ms=[],Ts=new Float32Array(16),Es=new Float32Array(9),As=new Float32Array(4);function Cs(e,t,r){const n=e[0];if(n<=0||n>0)return e;const i=t*r;let s=Ss[i];if(void 0===s&&(s=new Float32Array(i),Ss[i]=s),0!==t){n.toArray(s,0);for(let n=1,i=0;n!==t;++n)i+=r,e[n].toArray(s,i)}return s}function Ls(e,t){if(e.length!==t.length)return!1;for(let r=0,n=e.length;r<n;r++)if(e[r]!==t[r])return!1;return!0}function Rs(e,t){for(let r=0,n=t.length;r<n;r++)e[r]=t[r]}function Ps(e,t){let r=Ms[t];void 0===r&&(r=new Int32Array(t),Ms[t]=r);for(let n=0;n!==t;++n)r[n]=e.allocateTextureUnit();return r}function js(e,t){const r=this.cache;r[0]!==t&&(e.uniform1f(this.addr,t),r[0]=t)}function Is(e,t){const r=this.cache;if(void 0!==t.x)r[0]===t.x&&r[1]===t.y||(e.uniform2f(this.addr,t.x,t.y),r[0]=t.x,r[1]=t.y);else{if(Ls(r,t))return;e.uniform2fv(this.addr,t),Rs(r,t)}}function Ds(e,t){const r=this.cache;if(void 0!==t.x)r[0]===t.x&&r[1]===t.y&&r[2]===t.z||(e.uniform3f(this.addr,t.x,t.y,t.z),r[0]=t.x,r[1]=t.y,r[2]=t.z);else if(void 0!==t.r)r[0]===t.r&&r[1]===t.g&&r[2]===t.b||(e.uniform3f(this.addr,t.r,t.g,t.b),r[0]=t.r,r[1]=t.g,r[2]=t.b);else{if(Ls(r,t))return;e.uniform3fv(this.addr,t),Rs(r,t)}}function Os(e,t){const r=this.cache;if(void 0!==t.x)r[0]===t.x&&r[1]===t.y&&r[2]===t.z&&r[3]===t.w||(e.uniform4f(this.addr,t.x,t.y,t.z,t.w),r[0]=t.x,r[1]=t.y,r[2]=t.z,r[3]=t.w);else{if(Ls(r,t))return;e.uniform4fv(this.addr,t),Rs(r,t)}}function Ns(e,t){const r=this.cache,n=t.elements;if(void 0===n){if(Ls(r,t))return;e.uniformMatrix2fv(this.addr,!1,t),Rs(r,t)}else{if(Ls(r,n))return;As.set(n),e.uniformMatrix2fv(this.addr,!1,As),Rs(r,n)}}function Us(e,t){const r=this.cache,n=t.elements;if(void 0===n){if(Ls(r,t))return;e.uniformMatrix3fv(this.addr,!1,t),Rs(r,t)}else{if(Ls(r,n))return;Es.set(n),e.uniformMatrix3fv(this.addr,!1,Es),Rs(r,n)}}function ks(e,t){const r=this.cache,n=t.elements;if(void 0===n){if(Ls(r,t))return;e.uniformMatrix4fv(this.addr,!1,t),Rs(r,t)}else{if(Ls(r,n))return;Ts.set(n),e.uniformMatrix4fv(this.addr,!1,Ts),Rs(r,n)}}function Fs(e,t){const r=this.cache;r[0]!==t&&(e.uniform1i(this.addr,t),r[0]=t)}function Bs(e,t){const r=this.cache;if(void 0!==t.x)r[0]===t.x&&r[1]===t.y||(e.uniform2i(this.addr,t.x,t.y),r[0]=t.x,r[1]=t.y);else{if(Ls(r,t))return;e.uniform2iv(this.addr,t),Rs(r,t)}}function zs(e,t){const r=this.cache;if(void 0!==t.x)r[0]===t.x&&r[1]===t.y&&r[2]===t.z||(e.uniform3i(this.addr,t.x,t.y,t.z),r[0]=t.x,r[1]=t.y,r[2]=t.z);else{if(Ls(r,t))return;e.uniform3iv(this.addr,t),Rs(r,t)}}function Gs(e,t){const r=this.cache;if(void 0!==t.x)r[0]===t.x&&r[1]===t.y&&r[2]===t.z&&r[3]===t.w||(e.uniform4i(this.addr,t.x,t.y,t.z,t.w),r[0]=t.x,r[1]=t.y,r[2]=t.z,r[3]=t.w);else{if(Ls(r,t))return;e.uniform4iv(this.addr,t),Rs(r,t)}}function Vs(e,t){const r=this.cache;r[0]!==t&&(e.uniform1ui(this.addr,t),r[0]=t)}function Hs(e,t){const r=this.cache;if(void 0!==t.x)r[0]===t.x&&r[1]===t.y||(e.uniform2ui(this.addr,t.x,t.y),r[0]=t.x,r[1]=t.y);else{if(Ls(r,t))return;e.uniform2uiv(this.addr,t),Rs(r,t)}}function Ws(e,t){const r=this.cache;if(void 0!==t.x)r[0]===t.x&&r[1]===t.y&&r[2]===t.z||(e.uniform3ui(this.addr,t.x,t.y,t.z),r[0]=t.x,r[1]=t.y,r[2]=t.z);else{if(Ls(r,t))return;e.uniform3uiv(this.addr,t),Rs(r,t)}}function Xs(e,t){const r=this.cache;if(void 0!==t.x)r[0]===t.x&&r[1]===t.y&&r[2]===t.z&&r[3]===t.w||(e.uniform4ui(this.addr,t.x,t.y,t.z,t.w),r[0]=t.x,r[1]=t.y,r[2]=t.z,r[3]=t.w);else{if(Ls(r,t))return;e.uniform4uiv(this.addr,t),Rs(r,t)}}function qs(e,t,r){const n=this.cache,i=r.allocateTextureUnit();n[0]!==i&&(e.uniform1i(this.addr,i),n[0]=i),r.setTexture2D(t||_s,i)}function Ys(e,t,r){const n=this.cache,i=r.allocateTextureUnit();n[0]!==i&&(e.uniform1i(this.addr,i),n[0]=i),r.setTexture3D(t||bs,i)}function Zs(e,t,r){const n=this.cache,i=r.allocateTextureUnit();n[0]!==i&&(e.uniform1i(this.addr,i),n[0]=i),r.setTextureCube(t||ws,i)}function Js(e,t,r){const n=this.cache,i=r.allocateTextureUnit();n[0]!==i&&(e.uniform1i(this.addr,i),n[0]=i),r.setTexture2DArray(t||xs,i)}function Ks(e,t){e.uniform1fv(this.addr,t)}function Qs(e,t){const r=Cs(t,this.size,2);e.uniform2fv(this.addr,r)}function $s(e,t){const r=Cs(t,this.size,3);e.uniform3fv(this.addr,r)}function eo(e,t){const r=Cs(t,this.size,4);e.uniform4fv(this.addr,r)}function to(e,t){const r=Cs(t,this.size,4);e.uniformMatrix2fv(this.addr,!1,r)}function ro(e,t){const r=Cs(t,this.size,9);e.uniformMatrix3fv(this.addr,!1,r)}function no(e,t){const r=Cs(t,this.size,16);e.uniformMatrix4fv(this.addr,!1,r)}function io(e,t){e.uniform1iv(this.addr,t)}function so(e,t){e.uniform2iv(this.addr,t)}function oo(e,t){e.uniform3iv(this.addr,t)}function ao(e,t){e.uniform4iv(this.addr,t)}function lo(e,t){e.uniform1uiv(this.addr,t)}function co(e,t){e.uniform2uiv(this.addr,t)}function uo(e,t){e.uniform3uiv(this.addr,t)}function ho(e,t){e.uniform4uiv(this.addr,t)}function po(e,t,r){const n=this.cache,i=t.length,s=Ps(r,i);Ls(n,s)||(e.uniform1iv(this.addr,s),Rs(n,s));for(let e=0;e!==i;++e)r.setTexture2D(t[e]||_s,s[e])}function fo(e,t,r){const n=this.cache,i=t.length,s=Ps(r,i);Ls(n,s)||(e.uniform1iv(this.addr,s),Rs(n,s));for(let e=0;e!==i;++e)r.setTexture3D(t[e]||bs,s[e])}function mo(e,t,r){const n=this.cache,i=t.length,s=Ps(r,i);Ls(n,s)||(e.uniform1iv(this.addr,s),Rs(n,s));for(let e=0;e!==i;++e)r.setTextureCube(t[e]||ws,s[e])}function go(e,t,r){const n=this.cache,i=t.length,s=Ps(r,i);Ls(n,s)||(e.uniform1iv(this.addr,s),Rs(n,s));for(let e=0;e!==i;++e)r.setTexture2DArray(t[e]||xs,s[e])}class yo{constructor(e,t,r){this.id=e,this.addr=r,this.cache=[],this.setValue=function(e){switch(e){case 5126:return js;case 35664:return Is;case 35665:return Ds;case 35666:return Os;case 35674:return Ns;case 35675:return Us;case 35676:return ks;case 5124:case 35670:return Fs;case 35667:case 35671:return Bs;case 35668:case 35672:return zs;case 35669:case 35673:return Gs;case 5125:return Vs;case 36294:return Hs;case 36295:return Ws;case 36296:return Xs;case 35678:case 36198:case 36298:case 36306:case 35682:return qs;case 35679:case 36299:case 36307:return Ys;case 35680:case 36300:case 36308:case 36293:return Zs;case 36289:case 36303:case 36311:case 36292:return Js}}(t.type)}}class vo{constructor(e,t,r){this.id=e,this.addr=r,this.cache=[],this.size=t.size,this.setValue=function(e){switch(e){case 5126:return Ks;case 35664:return Qs;case 35665:return $s;case 35666:return eo;case 35674:return to;case 35675:return ro;case 35676:return no;case 5124:case 35670:return io;case 35667:case 35671:return so;case 35668:case 35672:return oo;case 35669:case 35673:return ao;case 5125:return lo;case 36294:return co;case 36295:return uo;case 36296:return ho;case 35678:case 36198:case 36298:case 36306:case 35682:return po;case 35679:case 36299:case 36307:return fo;case 35680:case 36300:case 36308:case 36293:return mo;case 36289:case 36303:case 36311:case 36292:return go}}(t.type)}}class _o{constructor(e){this.id=e,this.seq=[],this.map={}}setValue(e,t,r){const n=this.seq;for(let i=0,s=n.length;i!==s;++i){const s=n[i];s.setValue(e,t[s.id],r)}}}const xo=/(\w+)(\])?(\[|\.)?/g;function bo(e,t){e.seq.push(t),e.map[t.id]=t}function wo(e,t,r){const n=e.name,i=n.length;for(xo.lastIndex=0;;){const s=xo.exec(n),o=xo.lastIndex;let a=s[1];const l="]"===s[2],c=s[3];if(l&&(a|=0),void 0===c||"["===c&&o+2===i){bo(r,void 0===c?new yo(a,e,t):new vo(a,e,t));break}{let e=r.map[a];void 0===e&&(e=new _o(a),bo(r,e)),r=e}}}class So{constructor(e,t){this.seq=[],this.map={};const r=e.getProgramParameter(t,e.ACTIVE_UNIFORMS);for(let n=0;n<r;++n){const r=e.getActiveUniform(t,n);wo(r,e.getUniformLocation(t,r.name),this)}}setValue(e,t,r,n){const i=this.map[t];void 0!==i&&i.setValue(e,r,n)}setOptional(e,t,r){const n=t[r];void 0!==n&&this.setValue(e,r,n)}static upload(e,t,r,n){for(let i=0,s=t.length;i!==s;++i){const s=t[i],o=r[s.id];!1!==o.needsUpdate&&s.setValue(e,o.value,n)}}static seqWithValue(e,t){const r=[];for(let n=0,i=e.length;n!==i;++n){const i=e[n];i.id in t&&r.push(i)}return r}}function Mo(e,t,r){const n=e.createShader(t);return e.shaderSource(n,r),e.compileShader(n),n}let To=0;function Eo(e,t,r){const n=e.getShaderParameter(t,e.COMPILE_STATUS),i=e.getShaderInfoLog(t).trim();if(n&&""===i)return"";const s=/ERROR: 0:(\d+)/.exec(i);if(s){const n=parseInt(s[1]);return r.toUpperCase()+"\n\n"+i+"\n\n"+function(e,t){const r=e.split("\n"),n=[],i=Math.max(t-6,0),s=Math.min(t+6,r.length);for(let e=i;e<s;e++){const i=e+1;n.push(`${i===t?">":" "} ${i}: ${r[e]}`)}return n.join("\n")}(e.getShaderSource(t),n)}return i}function Ao(e,t){const r=function(e){switch(e){case vt:return["Linear","( value )"];case _t:return["sRGB","( value )"];default:return["Linear","( value )"]}}(t);return"vec4 "+e+"( vec4 value ) { return LinearTo"+r[0]+r[1]+"; }"}function Co(e,t){let r;switch(t){case X:r="Linear";break;case q:r="Reinhard";break;case Y:r="OptimizedCineon";break;case Z:r="ACESFilmic";break;case J:r="Custom";break;default:r="Linear"}return"vec3 "+e+"( vec3 color ) { return "+r+"ToneMapping( color ); }"}function Lo(e){return""!==e}function Ro(e,t){const r=t.numSpotLightShadows+t.numSpotLightMaps-t.numSpotLightShadowsWithMaps;return e.replace(/NUM_DIR_LIGHTS/g,t.numDirLights).replace(/NUM_SPOT_LIGHTS/g,t.numSpotLights).replace(/NUM_SPOT_LIGHT_MAPS/g,t.numSpotLightMaps).replace(/NUM_SPOT_LIGHT_COORDS/g,r).replace(/NUM_RECT_AREA_LIGHTS/g,t.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,t.numPointLights).replace(/NUM_HEMI_LIGHTS/g,t.numHemiLights).replace(/NUM_DIR_LIGHT_SHADOWS/g,t.numDirLightShadows).replace(/NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS/g,t.numSpotLightShadowsWithMaps).replace(/NUM_SPOT_LIGHT_SHADOWS/g,t.numSpotLightShadows).replace(/NUM_POINT_LIGHT_SHADOWS/g,t.numPointLightShadows)}function Po(e,t){return e.replace(/NUM_CLIPPING_PLANES/g,t.numClippingPlanes).replace(/UNION_CLIPPING_PLANES/g,t.numClippingPlanes-t.numClipIntersection)}const jo=/^[ \t]*#include +<([\w\d./]+)>/gm;function Io(e){return e.replace(jo,Do)}function Do(e,t){const r=ki[t];if(void 0===r)throw new Error("Can not resolve #include <"+t+">");return Io(r)}const Oo=/#pragma unroll_loop_start\s+for\s*\(\s*int\s+i\s*=\s*(\d+)\s*;\s*i\s*<\s*(\d+)\s*;\s*i\s*\+\+\s*\)\s*{([\s\S]+?)}\s+#pragma unroll_loop_end/g;function No(e){return e.replace(Oo,Uo)}function Uo(e,t,r,n){let i="";for(let e=parseInt(t);e<parseInt(r);e++)i+=n.replace(/\[\s*i\s*\]/g,"[ "+e+" ]").replace(/UNROLLED_LOOP_INDEX/g,e);return i}function ko(e){let t="precision "+e.precision+" float;\nprecision "+e.precision+" int;";return"highp"===e.precision?t+="\n#define HIGH_PRECISION":"mediump"===e.precision?t+="\n#define MEDIUM_PRECISION":"lowp"===e.precision&&(t+="\n#define LOW_PRECISION"),t}function Fo(e,t,r,n){const i=e.getContext(),s=r.defines;let c=r.vertexShader,u=r.fragmentShader;const h=function(e){let t="SHADOWMAP_TYPE_BASIC";return e.shadowMapType===o?t="SHADOWMAP_TYPE_PCF":e.shadowMapType===a?t="SHADOWMAP_TYPE_PCF_SOFT":e.shadowMapType===l&&(t="SHADOWMAP_TYPE_VSM"),t}(r),d=function(e){let t="ENVMAP_TYPE_CUBE";if(e.envMap)switch(e.envMapMode){case Q:case $:t="ENVMAP_TYPE_CUBE";break;case re:t="ENVMAP_TYPE_CUBE_UV"}return t}(r),p=function(e){let t="ENVMAP_MODE_REFLECTION";e.envMap&&e.envMapMode===$&&(t="ENVMAP_MODE_REFRACTION");return t}(r),f=function(e){let t="ENVMAP_BLENDING_NONE";if(e.envMap)switch(e.combine){case G:t="ENVMAP_BLENDING_MULTIPLY";break;case V:t="ENVMAP_BLENDING_MIX";break;case H:t="ENVMAP_BLENDING_ADD"}return t}(r),m=function(e){const t=e.envMapCubeUVHeight;if(null===t)return null;const r=Math.log2(t)-2,n=1/t;return{texelWidth:1/(3*Math.max(Math.pow(2,r),112)),texelHeight:n,maxMip:r}}(r),g=r.isWebGL2?"":function(e){return[e.extensionDerivatives||e.envMapCubeUVHeight||e.bumpMap||e.tangentSpaceNormalMap||e.clearcoatNormalMap||e.flatShading||"physical"===e.shaderID?"#extension GL_OES_standard_derivatives : enable":"",(e.extensionFragDepth||e.logarithmicDepthBuffer)&&e.rendererExtensionFragDepth?"#extension GL_EXT_frag_depth : enable":"",e.extensionDrawBuffers&&e.rendererExtensionDrawBuffers?"#extension GL_EXT_draw_buffers : require":"",(e.extensionShaderTextureLOD||e.envMap||e.transmission)&&e.rendererExtensionShaderTextureLod?"#extension GL_EXT_shader_texture_lod : enable":""].filter(Lo).join("\n")}(r),y=function(e){const t=[];for(const r in e){const n=e[r];!1!==n&&t.push("#define "+r+" "+n)}return t.join("\n")}(s),v=i.createProgram();let _,x,b=r.glslVersion?"#version "+r.glslVersion+"\n":"";r.isRawShaderMaterial?(_=[y].filter(Lo).join("\n"),_.length>0&&(_+="\n"),x=[g,y].filter(Lo).join("\n"),x.length>0&&(x+="\n")):(_=[ko(r),"#define SHADER_NAME "+r.shaderName,y,r.instancing?"#define USE_INSTANCING":"",r.instancingColor?"#define USE_INSTANCING_COLOR":"",r.supportsVertexTextures?"#define VERTEX_TEXTURES":"",r.useFog&&r.fog?"#define USE_FOG":"",r.useFog&&r.fogExp2?"#define FOG_EXP2":"",r.map?"#define USE_MAP":"",r.envMap?"#define USE_ENVMAP":"",r.envMap?"#define "+p:"",r.lightMap?"#define USE_LIGHTMAP":"",r.aoMap?"#define USE_AOMAP":"",r.emissiveMap?"#define USE_EMISSIVEMAP":"",r.bumpMap?"#define USE_BUMPMAP":"",r.normalMap?"#define USE_NORMALMAP":"",r.normalMap&&r.objectSpaceNormalMap?"#define OBJECTSPACE_NORMALMAP":"",r.normalMap&&r.tangentSpaceNormalMap?"#define TANGENTSPACE_NORMALMAP":"",r.clearcoatMap?"#define USE_CLEARCOATMAP":"",r.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",r.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",r.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",r.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",r.displacementMap&&r.supportsVertexTextures?"#define USE_DISPLACEMENTMAP":"",r.specularMap?"#define USE_SPECULARMAP":"",r.specularIntensityMap?"#define USE_SPECULARINTENSITYMAP":"",r.specularColorMap?"#define USE_SPECULARCOLORMAP":"",r.roughnessMap?"#define USE_ROUGHNESSMAP":"",r.metalnessMap?"#define USE_METALNESSMAP":"",r.alphaMap?"#define USE_ALPHAMAP":"",r.transmission?"#define USE_TRANSMISSION":"",r.transmissionMap?"#define USE_TRANSMISSIONMAP":"",r.thicknessMap?"#define USE_THICKNESSMAP":"",r.sheenColorMap?"#define USE_SHEENCOLORMAP":"",r.sheenRoughnessMap?"#define USE_SHEENROUGHNESSMAP":"",r.vertexTangents?"#define USE_TANGENT":"",r.vertexColors?"#define USE_COLOR":"",r.vertexAlphas?"#define USE_COLOR_ALPHA":"",r.vertexUvs?"#define USE_UV":"",r.uvsVertexOnly?"#define UVS_VERTEX_ONLY":"",r.flatShading?"#define FLAT_SHADED":"",r.skinning?"#define USE_SKINNING":"",r.morphTargets?"#define USE_MORPHTARGETS":"",r.morphNormals&&!1===r.flatShading?"#define USE_MORPHNORMALS":"",r.morphColors&&r.isWebGL2?"#define USE_MORPHCOLORS":"",r.morphTargetsCount>0&&r.isWebGL2?"#define MORPHTARGETS_TEXTURE":"",r.morphTargetsCount>0&&r.isWebGL2?"#define MORPHTARGETS_TEXTURE_STRIDE "+r.morphTextureStride:"",r.morphTargetsCount>0&&r.isWebGL2?"#define MORPHTARGETS_COUNT "+r.morphTargetsCount:"",r.doubleSided?"#define DOUBLE_SIDED":"",r.flipSided?"#define FLIP_SIDED":"",r.shadowMapEnabled?"#define USE_SHADOWMAP":"",r.shadowMapEnabled?"#define "+h:"",r.sizeAttenuation?"#define USE_SIZEATTENUATION":"",r.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",r.logarithmicDepthBuffer&&r.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;","#ifdef USE_INSTANCING","\tattribute mat4 instanceMatrix;","#endif","#ifdef USE_INSTANCING_COLOR","\tattribute vec3 instanceColor;","#endif","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_TANGENT","\tattribute vec4 tangent;","#endif","#if defined( USE_COLOR_ALPHA )","\tattribute vec4 color;","#elif defined( USE_COLOR )","\tattribute vec3 color;","#endif","#if ( defined( USE_MORPHTARGETS ) && ! defined( MORPHTARGETS_TEXTURE ) )","\tattribute vec3 morphTarget0;","\tattribute vec3 morphTarget1;","\tattribute vec3 morphTarget2;","\tattribute vec3 morphTarget3;","\t#ifdef USE_MORPHNORMALS","\t\tattribute vec3 morphNormal0;","\t\tattribute vec3 morphNormal1;","\t\tattribute vec3 morphNormal2;","\t\tattribute vec3 morphNormal3;","\t#else","\t\tattribute vec3 morphTarget4;","\t\tattribute vec3 morphTarget5;","\t\tattribute vec3 morphTarget6;","\t\tattribute vec3 morphTarget7;","\t#endif","#endif","#ifdef USE_SKINNING","\tattribute vec4 skinIndex;","\tattribute vec4 skinWeight;","#endif","\n"].filter(Lo).join("\n"),x=[g,ko(r),"#define SHADER_NAME "+r.shaderName,y,r.useFog&&r.fog?"#define USE_FOG":"",r.useFog&&r.fogExp2?"#define FOG_EXP2":"",r.map?"#define USE_MAP":"",r.matcap?"#define USE_MATCAP":"",r.envMap?"#define USE_ENVMAP":"",r.envMap?"#define "+d:"",r.envMap?"#define "+p:"",r.envMap?"#define "+f:"",m?"#define CUBEUV_TEXEL_WIDTH "+m.texelWidth:"",m?"#define CUBEUV_TEXEL_HEIGHT "+m.texelHeight:"",m?"#define CUBEUV_MAX_MIP "+m.maxMip+".0":"",r.lightMap?"#define USE_LIGHTMAP":"",r.aoMap?"#define USE_AOMAP":"",r.emissiveMap?"#define USE_EMISSIVEMAP":"",r.bumpMap?"#define USE_BUMPMAP":"",r.normalMap?"#define USE_NORMALMAP":"",r.normalMap&&r.objectSpaceNormalMap?"#define OBJECTSPACE_NORMALMAP":"",r.normalMap&&r.tangentSpaceNormalMap?"#define TANGENTSPACE_NORMALMAP":"",r.clearcoat?"#define USE_CLEARCOAT":"",r.clearcoatMap?"#define USE_CLEARCOATMAP":"",r.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",r.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",r.iridescence?"#define USE_IRIDESCENCE":"",r.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",r.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",r.specularMap?"#define USE_SPECULARMAP":"",r.specularIntensityMap?"#define USE_SPECULARINTENSITYMAP":"",r.specularColorMap?"#define USE_SPECULARCOLORMAP":"",r.roughnessMap?"#define USE_ROUGHNESSMAP":"",r.metalnessMap?"#define USE_METALNESSMAP":"",r.alphaMap?"#define USE_ALPHAMAP":"",r.alphaTest?"#define USE_ALPHATEST":"",r.sheen?"#define USE_SHEEN":"",r.sheenColorMap?"#define USE_SHEENCOLORMAP":"",r.sheenRoughnessMap?"#define USE_SHEENROUGHNESSMAP":"",r.transmission?"#define USE_TRANSMISSION":"",r.transmissionMap?"#define USE_TRANSMISSIONMAP":"",r.thicknessMap?"#define USE_THICKNESSMAP":"",r.decodeVideoTexture?"#define DECODE_VIDEO_TEXTURE":"",r.vertexTangents?"#define USE_TANGENT":"",r.vertexColors||r.instancingColor?"#define USE_COLOR":"",r.vertexAlphas?"#define USE_COLOR_ALPHA":"",r.vertexUvs?"#define USE_UV":"",r.uvsVertexOnly?"#define UVS_VERTEX_ONLY":"",r.gradientMap?"#define USE_GRADIENTMAP":"",r.flatShading?"#define FLAT_SHADED":"",r.doubleSided?"#define DOUBLE_SIDED":"",r.flipSided?"#define FLIP_SIDED":"",r.shadowMapEnabled?"#define USE_SHADOWMAP":"",r.shadowMapEnabled?"#define "+h:"",r.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",r.useLegacyLights?"#define LEGACY_LIGHTS":"",r.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",r.logarithmicDepthBuffer&&r.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;",r.toneMapping!==W?"#define TONE_MAPPING":"",r.toneMapping!==W?ki.tonemapping_pars_fragment:"",r.toneMapping!==W?Co("toneMapping",r.toneMapping):"",r.dithering?"#define DITHERING":"",r.opaque?"#define OPAQUE":"",ki.encodings_pars_fragment,Ao("linearToOutputTexel",r.outputEncoding),r.useDepthPacking?"#define DEPTH_PACKING "+r.depthPacking:"","\n"].filter(Lo).join("\n")),c=Io(c),c=Ro(c,r),c=Po(c,r),u=Io(u),u=Ro(u,r),u=Po(u,r),c=No(c),u=No(u),r.isWebGL2&&!0!==r.isRawShaderMaterial&&(b="#version 300 es\n",_=["precision mediump sampler2DArray;","#define attribute in","#define varying out","#define texture2D texture"].join("\n")+"\n"+_,x=["#define varying in",r.glslVersion===Ct?"":"layout(location = 0) out highp vec4 pc_fragColor;",r.glslVersion===Ct?"":"#define gl_FragColor pc_fragColor","#define gl_FragDepthEXT gl_FragDepth","#define texture2D texture","#define textureCube texture","#define texture2DProj textureProj","#define texture2DLodEXT textureLod","#define texture2DProjLodEXT textureProjLod","#define textureCubeLodEXT textureLod","#define texture2DGradEXT textureGrad","#define texture2DProjGradEXT textureProjGrad","#define textureCubeGradEXT textureGrad"].join("\n")+"\n"+x);const w=b+_+c,S=b+x+u,M=Mo(i,i.VERTEX_SHADER,w),T=Mo(i,i.FRAGMENT_SHADER,S);if(i.attachShader(v,M),i.attachShader(v,T),void 0!==r.index0AttributeName?i.bindAttribLocation(v,0,r.index0AttributeName):!0===r.morphTargets&&i.bindAttribLocation(v,0,"position"),i.linkProgram(v),e.debug.checkShaderErrors){const e=i.getProgramInfoLog(v).trim(),t=i.getShaderInfoLog(M).trim(),r=i.getShaderInfoLog(T).trim();let n=!0,s=!0;if(!1===i.getProgramParameter(v,i.LINK_STATUS)){n=!1;Eo(i,M,"vertex"),Eo(i,T,"fragment")}else""!==e||""!==t&&""!==r||(s=!1);s&&(this.diagnostics={runnable:n,programLog:e,vertexShader:{log:t,prefix:_},fragmentShader:{log:r,prefix:x}})}let E,A;return i.deleteShader(M),i.deleteShader(T),this.getUniforms=function(){return void 0===E&&(E=new So(i,v)),E},this.getAttributes=function(){return void 0===A&&(A=function(e,t){const r={},n=e.getProgramParameter(t,e.ACTIVE_ATTRIBUTES);for(let i=0;i<n;i++){const n=e.getActiveAttrib(t,i),s=n.name;let o=1;n.type===e.FLOAT_MAT2&&(o=2),n.type===e.FLOAT_MAT3&&(o=3),n.type===e.FLOAT_MAT4&&(o=4),r[s]={type:n.type,location:e.getAttribLocation(t,s),locationSize:o}}return r}(i,v)),A},this.destroy=function(){n.releaseStatesOfProgram(this),i.deleteProgram(v),this.program=void 0},this.name=r.shaderName,this.id=To++,this.cacheKey=t,this.usedTimes=1,this.program=v,this.vertexShader=M,this.fragmentShader=T,this}let Bo=0;class zo{constructor(){this.shaderCache=new Map,this.materialCache=new Map}update(e){const t=e.vertexShader,r=e.fragmentShader,n=this._getShaderStage(t),i=this._getShaderStage(r),s=this._getShaderCacheForMaterial(e);return!1===s.has(n)&&(s.add(n),n.usedTimes++),!1===s.has(i)&&(s.add(i),i.usedTimes++),this}remove(e){const t=this.materialCache.get(e);for(const e of t)e.usedTimes--,0===e.usedTimes&&this.shaderCache.delete(e.code);return this.materialCache.delete(e),this}getVertexShaderID(e){return this._getShaderStage(e.vertexShader).id}getFragmentShaderID(e){return this._getShaderStage(e.fragmentShader).id}dispose(){this.shaderCache.clear(),this.materialCache.clear()}_getShaderCacheForMaterial(e){const t=this.materialCache;let r=t.get(e);return void 0===r&&(r=new Set,t.set(e,r)),r}_getShaderStage(e){const t=this.shaderCache;let r=t.get(e);return void 0===r&&(r=new Go(e),t.set(e,r)),r}}class Go{constructor(e){this.id=Bo++,this.code=e,this.usedTimes=0}}function Vo(e,t,r,n,i,s,o){const a=new sn,l=new zo,c=[],d=i.isWebGL2,f=i.logarithmicDepthBuffer,m=i.vertexTextures;let g=i.precision;const y={MeshDepthMaterial:"depth",MeshDistanceMaterial:"distanceRGBA",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"toon",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",MeshMatcapMaterial:"matcap",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points",ShadowMaterial:"shadow",SpriteMaterial:"sprite"};return{getParameters:function(s,a,c,v,_){const x=v.fog,b=_.geometry,w=s.isMeshStandardMaterial?v.environment:null,S=(s.isMeshStandardMaterial?r:t).get(s.envMap||w),M=S&&S.mapping===re?S.image.height:null,T=y[s.type];null!==s.precision&&(g=i.getMaxPrecision(s.precision),s.precision);const E=b.morphAttributes.position||b.morphAttributes.normal||b.morphAttributes.color,A=void 0!==E?E.length:0;let C,L,R,P,j=0;if(void 0!==b.morphAttributes.position&&(j=1),void 0!==b.morphAttributes.normal&&(j=2),void 0!==b.morphAttributes.color&&(j=3),T){const e=Bi[T];C=e.vertexShader,L=e.fragmentShader}else C=s.vertexShader,L=s.fragmentShader,l.update(s),R=l.getVertexShaderID(s),P=l.getFragmentShaderID(s);const I=e.getRenderTarget(),D=s.alphaTest>0,O=s.clearcoat>0,N=s.iridescence>0;return{isWebGL2:d,shaderID:T,shaderName:s.type,vertexShader:C,fragmentShader:L,defines:s.defines,customVertexShaderID:R,customFragmentShaderID:P,isRawShaderMaterial:!0===s.isRawShaderMaterial,glslVersion:s.glslVersion,precision:g,instancing:!0===_.isInstancedMesh,instancingColor:!0===_.isInstancedMesh&&null!==_.instanceColor,supportsVertexTextures:m,outputEncoding:null===I?e.outputEncoding:!0===I.isXRRenderTarget?I.texture.encoding:vt,map:!!s.map,matcap:!!s.matcap,envMap:!!S,envMapMode:S&&S.mapping,envMapCubeUVHeight:M,lightMap:!!s.lightMap,aoMap:!!s.aoMap,emissiveMap:!!s.emissiveMap,bumpMap:!!s.bumpMap,normalMap:!!s.normalMap,objectSpaceNormalMap:s.normalMapType===wt,tangentSpaceNormalMap:s.normalMapType===bt,decodeVideoTexture:!!s.map&&!0===s.map.isVideoTexture&&s.map.encoding===_t,clearcoat:O,clearcoatMap:O&&!!s.clearcoatMap,clearcoatRoughnessMap:O&&!!s.clearcoatRoughnessMap,clearcoatNormalMap:O&&!!s.clearcoatNormalMap,iridescence:N,iridescenceMap:N&&!!s.iridescenceMap,iridescenceThicknessMap:N&&!!s.iridescenceThicknessMap,displacementMap:!!s.displacementMap,roughnessMap:!!s.roughnessMap,metalnessMap:!!s.metalnessMap,specularMap:!!s.specularMap,specularIntensityMap:!!s.specularIntensityMap,specularColorMap:!!s.specularColorMap,opaque:!1===s.transparent&&s.blending===p,alphaMap:!!s.alphaMap,alphaTest:D,gradientMap:!!s.gradientMap,sheen:s.sheen>0,sheenColorMap:!!s.sheenColorMap,sheenRoughnessMap:!!s.sheenRoughnessMap,transmission:s.transmission>0,transmissionMap:!!s.transmissionMap,thicknessMap:!!s.thicknessMap,combine:s.combine,vertexTangents:!!s.normalMap&&!!b.attributes.tangent,vertexColors:s.vertexColors,vertexAlphas:!0===s.vertexColors&&!!b.attributes.color&&4===b.attributes.color.itemSize,vertexUvs:!!(s.map||s.bumpMap||s.normalMap||s.specularMap||s.alphaMap||s.emissiveMap||s.roughnessMap||s.metalnessMap||s.clearcoatMap||s.clearcoatRoughnessMap||s.clearcoatNormalMap||s.iridescenceMap||s.iridescenceThicknessMap||s.displacementMap||s.transmissionMap||s.thicknessMap||s.specularIntensityMap||s.specularColorMap||s.sheenColorMap||s.sheenRoughnessMap),uvsVertexOnly:!(s.map||s.bumpMap||s.normalMap||s.specularMap||s.alphaMap||s.emissiveMap||s.roughnessMap||s.metalnessMap||s.clearcoatNormalMap||s.iridescenceMap||s.iridescenceThicknessMap||s.transmission>0||s.transmissionMap||s.thicknessMap||s.specularIntensityMap||s.specularColorMap||s.sheen>0||s.sheenColorMap||s.sheenRoughnessMap||!s.displacementMap),fog:!!x,useFog:!0===s.fog,fogExp2:x&&x.isFogExp2,flatShading:!!s.flatShading,sizeAttenuation:s.sizeAttenuation,logarithmicDepthBuffer:f,skinning:!0===_.isSkinnedMesh,morphTargets:void 0!==b.morphAttributes.position,morphNormals:void 0!==b.morphAttributes.normal,morphColors:void 0!==b.morphAttributes.color,morphTargetsCount:A,morphTextureStride:j,numDirLights:a.directional.length,numPointLights:a.point.length,numSpotLights:a.spot.length,numSpotLightMaps:a.spotLightMap.length,numRectAreaLights:a.rectArea.length,numHemiLights:a.hemi.length,numDirLightShadows:a.directionalShadowMap.length,numPointLightShadows:a.pointShadowMap.length,numSpotLightShadows:a.spotShadowMap.length,numSpotLightShadowsWithMaps:a.numSpotLightShadowsWithMaps,numClippingPlanes:o.numPlanes,numClipIntersection:o.numIntersection,dithering:s.dithering,shadowMapEnabled:e.shadowMap.enabled&&c.length>0,shadowMapType:e.shadowMap.type,toneMapping:s.toneMapped?e.toneMapping:W,useLegacyLights:e.useLegacyLights,premultipliedAlpha:s.premultipliedAlpha,doubleSided:s.side===h,flipSided:s.side===u,useDepthPacking:!!s.depthPacking,depthPacking:s.depthPacking||0,index0AttributeName:s.index0AttributeName,extensionDerivatives:s.extensions&&s.extensions.derivatives,extensionFragDepth:s.extensions&&s.extensions.fragDepth,extensionDrawBuffers:s.extensions&&s.extensions.drawBuffers,extensionShaderTextureLOD:s.extensions&&s.extensions.shaderTextureLOD,rendererExtensionFragDepth:d||n.has("EXT_frag_depth"),rendererExtensionDrawBuffers:d||n.has("WEBGL_draw_buffers"),rendererExtensionShaderTextureLod:d||n.has("EXT_shader_texture_lod"),customProgramCacheKey:s.customProgramCacheKey()}},getProgramCacheKey:function(t){const r=[];if(t.shaderID?r.push(t.shaderID):(r.push(t.customVertexShaderID),r.push(t.customFragmentShaderID)),void 0!==t.defines)for(const e in t.defines)r.push(e),r.push(t.defines[e]);return!1===t.isRawShaderMaterial&&(!function(e,t){e.push(t.precision),e.push(t.outputEncoding),e.push(t.envMapMode),e.push(t.envMapCubeUVHeight),e.push(t.combine),e.push(t.vertexUvs),e.push(t.fogExp2),e.push(t.sizeAttenuation),e.push(t.morphTargetsCount),e.push(t.morphAttributeCount),e.push(t.numDirLights),e.push(t.numPointLights),e.push(t.numSpotLights),e.push(t.numSpotLightMaps),e.push(t.numHemiLights),e.push(t.numRectAreaLights),e.push(t.numDirLightShadows),e.push(t.numPointLightShadows),e.push(t.numSpotLightShadows),e.push(t.numSpotLightShadowsWithMaps),e.push(t.shadowMapType),e.push(t.toneMapping),e.push(t.numClippingPlanes),e.push(t.numClipIntersection),e.push(t.depthPacking)}(r,t),function(e,t){a.disableAll(),t.isWebGL2&&a.enable(0);t.supportsVertexTextures&&a.enable(1);t.instancing&&a.enable(2);t.instancingColor&&a.enable(3);t.map&&a.enable(4);t.matcap&&a.enable(5);t.envMap&&a.enable(6);t.lightMap&&a.enable(7);t.aoMap&&a.enable(8);t.emissiveMap&&a.enable(9);t.bumpMap&&a.enable(10);t.normalMap&&a.enable(11);t.objectSpaceNormalMap&&a.enable(12);t.tangentSpaceNormalMap&&a.enable(13);t.clearcoat&&a.enable(14);t.clearcoatMap&&a.enable(15);t.clearcoatRoughnessMap&&a.enable(16);t.clearcoatNormalMap&&a.enable(17);t.iridescence&&a.enable(18);t.iridescenceMap&&a.enable(19);t.iridescenceThicknessMap&&a.enable(20);t.displacementMap&&a.enable(21);t.specularMap&&a.enable(22);t.roughnessMap&&a.enable(23);t.metalnessMap&&a.enable(24);t.gradientMap&&a.enable(25);t.alphaMap&&a.enable(26);t.alphaTest&&a.enable(27);t.vertexColors&&a.enable(28);t.vertexAlphas&&a.enable(29);t.vertexUvs&&a.enable(30);t.vertexTangents&&a.enable(31);t.uvsVertexOnly&&a.enable(32);e.push(a.mask),a.disableAll(),t.fog&&a.enable(0);t.useFog&&a.enable(1);t.flatShading&&a.enable(2);t.logarithmicDepthBuffer&&a.enable(3);t.skinning&&a.enable(4);t.morphTargets&&a.enable(5);t.morphNormals&&a.enable(6);t.morphColors&&a.enable(7);t.premultipliedAlpha&&a.enable(8);t.shadowMapEnabled&&a.enable(9);t.useLegacyLights&&a.enable(10);t.doubleSided&&a.enable(11);t.flipSided&&a.enable(12);t.useDepthPacking&&a.enable(13);t.dithering&&a.enable(14);t.specularIntensityMap&&a.enable(15);t.specularColorMap&&a.enable(16);t.transmission&&a.enable(17);t.transmissionMap&&a.enable(18);t.thicknessMap&&a.enable(19);t.sheen&&a.enable(20);t.sheenColorMap&&a.enable(21);t.sheenRoughnessMap&&a.enable(22);t.decodeVideoTexture&&a.enable(23);t.opaque&&a.enable(24);e.push(a.mask)}(r,t),r.push(e.outputEncoding)),r.push(t.customProgramCacheKey),r.join()},getUniforms:function(e){const t=y[e.type];let r;if(t){const e=Bi[t];r=xi.clone(e.uniforms)}else r=e.uniforms;return r},acquireProgram:function(t,r){let n;for(let e=0,t=c.length;e<t;e++){const t=c[e];if(t.cacheKey===r){n=t,++n.usedTimes;break}}return void 0===n&&(n=new Fo(e,r,t,s),c.push(n)),n},releaseProgram:function(e){if(0==--e.usedTimes){const t=c.indexOf(e);c[t]=c[c.length-1],c.pop(),e.destroy()}},releaseShaderCache:function(e){l.remove(e)},programs:c,dispose:function(){l.dispose()}}}function Ho(){let e=new WeakMap;return{get:function(t){let r=e.get(t);return void 0===r&&(r={},e.set(t,r)),r},remove:function(t){e.delete(t)},update:function(t,r,n){e.get(t)[r]=n},dispose:function(){e=new WeakMap}}}function Wo(e,t){return e.groupOrder!==t.groupOrder?e.groupOrder-t.groupOrder:e.renderOrder!==t.renderOrder?e.renderOrder-t.renderOrder:e.material.id!==t.material.id?e.material.id-t.material.id:e.z!==t.z?e.z-t.z:e.id-t.id}function Xo(e,t){return e.groupOrder!==t.groupOrder?e.groupOrder-t.groupOrder:e.renderOrder!==t.renderOrder?e.renderOrder-t.renderOrder:e.z!==t.z?t.z-e.z:e.id-t.id}function qo(){const e=[];let t=0;const r=[],n=[],i=[];function s(r,n,i,s,o,a){let l=e[t];return void 0===l?(l={id:r.id,object:r,geometry:n,material:i,groupOrder:s,renderOrder:r.renderOrder,z:o,group:a},e[t]=l):(l.id=r.id,l.object=r,l.geometry=n,l.material=i,l.groupOrder=s,l.renderOrder=r.renderOrder,l.z=o,l.group=a),t++,l}return{opaque:r,transmissive:n,transparent:i,init:function(){t=0,r.length=0,n.length=0,i.length=0},push:function(e,t,o,a,l,c){const u=s(e,t,o,a,l,c);o.transmission>0?n.push(u):!0===o.transparent?i.push(u):r.push(u)},unshift:function(e,t,o,a,l,c){const u=s(e,t,o,a,l,c);o.transmission>0?n.unshift(u):!0===o.transparent?i.unshift(u):r.unshift(u)},finish:function(){for(let r=t,n=e.length;r<n;r++){const t=e[r];if(null===t.id)break;t.id=null,t.object=null,t.geometry=null,t.material=null,t.group=null}},sort:function(e,t){r.length>1&&r.sort(e||Wo),n.length>1&&n.sort(t||Xo),i.length>1&&i.sort(t||Xo)}}}function Yo(){let e=new WeakMap;return{get:function(t,r){const n=e.get(t);let i;return void 0===n?(i=new qo,e.set(t,[i])):r>=n.length?(i=new qo,n.push(i)):i=n[r],i},dispose:function(){e=new WeakMap}}}function Zo(){const e={};return{get:function(t){if(void 0!==e[t.id])return e[t.id];let r;switch(t.type){case"DirectionalLight":r={direction:new $t,color:new Un};break;case"SpotLight":r={position:new $t,direction:new $t,color:new Un,distance:0,coneCos:0,penumbraCos:0,decay:0};break;case"PointLight":r={position:new $t,color:new Un,distance:0,decay:0};break;case"HemisphereLight":r={direction:new $t,skyColor:new Un,groundColor:new Un};break;case"RectAreaLight":r={color:new Un,position:new $t,halfWidth:new $t,halfHeight:new $t}}return e[t.id]=r,r}}}let Jo=0;function Ko(e,t){return(t.castShadow?2:0)-(e.castShadow?2:0)+(t.map?1:0)-(e.map?1:0)}function Qo(e,t){const r=new Zo,n=function(){const e={};return{get:function(t){if(void 0!==e[t.id])return e[t.id];let r;switch(t.type){case"DirectionalLight":case"SpotLight":r={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new Wt};break;case"PointLight":r={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new Wt,shadowCameraNear:1,shadowCameraFar:1e3}}return e[t.id]=r,r}}}(),i={version:0,hash:{directionalLength:-1,pointLength:-1,spotLength:-1,rectAreaLength:-1,hemiLength:-1,numDirectionalShadows:-1,numPointShadows:-1,numSpotShadows:-1,numSpotMaps:-1},ambient:[0,0,0],probe:[],directional:[],directionalShadow:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotLightMap:[],spotShadow:[],spotShadowMap:[],spotLightMatrix:[],rectArea:[],rectAreaLTC1:null,rectAreaLTC2:null,point:[],pointShadow:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[],numSpotLightShadowsWithMaps:0};for(let e=0;e<9;e++)i.probe.push(new $t);const s=new $t,o=new qr,a=new qr;return{setup:function(s,o){let a=0,l=0,c=0;for(let e=0;e<9;e++)i.probe[e].set(0,0,0);let u=0,h=0,d=0,p=0,f=0,m=0,g=0,y=0,v=0,_=0;s.sort(Ko);const x=!0===o?Math.PI:1;for(let e=0,t=s.length;e<t;e++){const t=s[e],o=t.color,b=t.intensity,w=t.distance,S=t.shadow&&t.shadow.map?t.shadow.map.texture:null;if(t.isAmbientLight)a+=o.r*b*x,l+=o.g*b*x,c+=o.b*b*x;else if(t.isLightProbe)for(let e=0;e<9;e++)i.probe[e].addScaledVector(t.sh.coefficients[e],b);else if(t.isDirectionalLight){const e=r.get(t);if(e.color.copy(t.color).multiplyScalar(t.intensity*x),t.castShadow){const e=t.shadow,r=n.get(t);r.shadowBias=e.bias,r.shadowNormalBias=e.normalBias,r.shadowRadius=e.radius,r.shadowMapSize=e.mapSize,i.directionalShadow[u]=r,i.directionalShadowMap[u]=S,i.directionalShadowMatrix[u]=t.shadow.matrix,m++}i.directional[u]=e,u++}else if(t.isSpotLight){const e=r.get(t);e.position.setFromMatrixPosition(t.matrixWorld),e.color.copy(o).multiplyScalar(b*x),e.distance=w,e.coneCos=Math.cos(t.angle),e.penumbraCos=Math.cos(t.angle*(1-t.penumbra)),e.decay=t.decay,i.spot[d]=e;const s=t.shadow;if(t.map&&(i.spotLightMap[v]=t.map,v++,s.updateMatrices(t),t.castShadow&&_++),i.spotLightMatrix[d]=s.matrix,t.castShadow){const e=n.get(t);e.shadowBias=s.bias,e.shadowNormalBias=s.normalBias,e.shadowRadius=s.radius,e.shadowMapSize=s.mapSize,i.spotShadow[d]=e,i.spotShadowMap[d]=S,y++}d++}else if(t.isRectAreaLight){const e=r.get(t);e.color.copy(o).multiplyScalar(b),e.halfWidth.set(.5*t.width,0,0),e.halfHeight.set(0,.5*t.height,0),i.rectArea[p]=e,p++}else if(t.isPointLight){const e=r.get(t);if(e.color.copy(t.color).multiplyScalar(t.intensity*x),e.distance=t.distance,e.decay=t.decay,t.castShadow){const e=t.shadow,r=n.get(t);r.shadowBias=e.bias,r.shadowNormalBias=e.normalBias,r.shadowRadius=e.radius,r.shadowMapSize=e.mapSize,r.shadowCameraNear=e.camera.near,r.shadowCameraFar=e.camera.far,i.pointShadow[h]=r,i.pointShadowMap[h]=S,i.pointShadowMatrix[h]=t.shadow.matrix,g++}i.point[h]=e,h++}else if(t.isHemisphereLight){const e=r.get(t);e.skyColor.copy(t.color).multiplyScalar(b*x),e.groundColor.copy(t.groundColor).multiplyScalar(b*x),i.hemi[f]=e,f++}}p>0&&(t.isWebGL2||!0===e.has("OES_texture_float_linear")?(i.rectAreaLTC1=Fi.LTC_FLOAT_1,i.rectAreaLTC2=Fi.LTC_FLOAT_2):!0===e.has("OES_texture_half_float_linear")&&(i.rectAreaLTC1=Fi.LTC_HALF_1,i.rectAreaLTC2=Fi.LTC_HALF_2)),i.ambient[0]=a,i.ambient[1]=l,i.ambient[2]=c;const b=i.hash;b.directionalLength===u&&b.pointLength===h&&b.spotLength===d&&b.rectAreaLength===p&&b.hemiLength===f&&b.numDirectionalShadows===m&&b.numPointShadows===g&&b.numSpotShadows===y&&b.numSpotMaps===v||(i.directional.length=u,i.spot.length=d,i.rectArea.length=p,i.point.length=h,i.hemi.length=f,i.directionalShadow.length=m,i.directionalShadowMap.length=m,i.pointShadow.length=g,i.pointShadowMap.length=g,i.spotShadow.length=y,i.spotShadowMap.length=y,i.directionalShadowMatrix.length=m,i.pointShadowMatrix.length=g,i.spotLightMatrix.length=y+v-_,i.spotLightMap.length=v,i.numSpotLightShadowsWithMaps=_,b.directionalLength=u,b.pointLength=h,b.spotLength=d,b.rectAreaLength=p,b.hemiLength=f,b.numDirectionalShadows=m,b.numPointShadows=g,b.numSpotShadows=y,b.numSpotMaps=v,i.version=Jo++)},setupView:function(e,t){let r=0,n=0,l=0,c=0,u=0;const h=t.matrixWorldInverse;for(let t=0,d=e.length;t<d;t++){const d=e[t];if(d.isDirectionalLight){const e=i.directional[r];e.direction.setFromMatrixPosition(d.matrixWorld),s.setFromMatrixPosition(d.target.matrixWorld),e.direction.sub(s),e.direction.transformDirection(h),r++}else if(d.isSpotLight){const e=i.spot[l];e.position.setFromMatrixPosition(d.matrixWorld),e.position.applyMatrix4(h),e.direction.setFromMatrixPosition(d.matrixWorld),s.setFromMatrixPosition(d.target.matrixWorld),e.direction.sub(s),e.direction.transformDirection(h),l++}else if(d.isRectAreaLight){const e=i.rectArea[c];e.position.setFromMatrixPosition(d.matrixWorld),e.position.applyMatrix4(h),a.identity(),o.copy(d.matrixWorld),o.premultiply(h),a.extractRotation(o),e.halfWidth.set(.5*d.width,0,0),e.halfHeight.set(0,.5*d.height,0),e.halfWidth.applyMatrix4(a),e.halfHeight.applyMatrix4(a),c++}else if(d.isPointLight){const e=i.point[n];e.position.setFromMatrixPosition(d.matrixWorld),e.position.applyMatrix4(h),n++}else if(d.isHemisphereLight){const e=i.hemi[u];e.direction.setFromMatrixPosition(d.matrixWorld),e.direction.transformDirection(h),u++}}},state:i}}function $o(e,t){const r=new Qo(e,t),n=[],i=[];return{init:function(){n.length=0,i.length=0},state:{lightsArray:n,shadowsArray:i,lights:r},setupLights:function(e){r.setup(n,e)},setupLightsView:function(e){r.setupView(n,e)},pushLight:function(e){n.push(e)},pushShadow:function(e){i.push(e)}}}function ea(e,t){let r=new WeakMap;return{get:function(n,i=0){const s=r.get(n);let o;return void 0===s?(o=new $o(e,t),r.set(n,[o])):i>=s.length?(o=new $o(e,t),s.push(o)):o=s[i],o},dispose:function(){r=new WeakMap}}}class ta extends jn{constructor(e){super(),this.isMeshDepthMaterial=!0,this.type="MeshDepthMaterial",this.depthPacking=3200,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.setValues(e)}copy(e){return super.copy(e),this.depthPacking=e.depthPacking,this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this}}class ra extends jn{constructor(e){super(),this.isMeshDistanceMaterial=!0,this.type="MeshDistanceMaterial",this.referencePosition=new $t,this.nearDistance=1,this.farDistance=1e3,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.setValues(e)}copy(e){return super.copy(e),this.referencePosition.copy(e.referencePosition),this.nearDistance=e.nearDistance,this.farDistance=e.farDistance,this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this}}const na="void main() {\n\tgl_Position = vec4( position, 1.0 );\n}",ia="uniform sampler2D shadow_pass;\nuniform vec2 resolution;\nuniform float radius;\n#include <packing>\nvoid main() {\n\tconst float samples = float( VSM_SAMPLES );\n\tfloat mean = 0.0;\n\tfloat squared_mean = 0.0;\n\tfloat uvStride = samples <= 1.0 ? 0.0 : 2.0 / ( samples - 1.0 );\n\tfloat uvStart = samples <= 1.0 ? 0.0 : - 1.0;\n\tfor ( float i = 0.0; i < samples; i ++ ) {\n\t\tfloat uvOffset = uvStart + i * uvStride;\n\t\t#ifdef HORIZONTAL_PASS\n\t\t\tvec2 distribution = unpackRGBATo2Half( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( uvOffset, 0.0 ) * radius ) / resolution ) );\n\t\t\tmean += distribution.x;\n\t\t\tsquared_mean += distribution.y * distribution.y + distribution.x * distribution.x;\n\t\t#else\n\t\t\tfloat depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( 0.0, uvOffset ) * radius ) / resolution ) );\n\t\t\tmean += depth;\n\t\t\tsquared_mean += depth * depth;\n\t\t#endif\n\t}\n\tmean = mean / samples;\n\tsquared_mean = squared_mean / samples;\n\tfloat std_dev = sqrt( squared_mean - mean * mean );\n\tgl_FragColor = pack2HalfToRGBA( vec2( mean, std_dev ) );\n}";function sa(e,t,r){let n=new Di;const i=new Wt,s=new Wt,a=new gr,p=new ta({depthPacking:xt}),f=new ra,m={},g=r.maxTextureSize,y={[c]:u,[u]:c,[h]:h},v=new bi({defines:{VSM_SAMPLES:8},uniforms:{shadow_pass:{value:null},resolution:{value:new Wt},radius:{value:4}},vertexShader:na,fragmentShader:ia}),_=v.clone();_.defines.HORIZONTAL_PASS=1;const x=new $n;x.setAttribute("position",new Gn(new Float32Array([-1,-1,.5,3,-1,.5,-1,3,.5]),3));const b=new fi(x,v),w=this;function S(r,n){const s=t.update(b);v.defines.VSM_SAMPLES!==r.blurSamples&&(v.defines.VSM_SAMPLES=r.blurSamples,_.defines.VSM_SAMPLES=r.blurSamples,v.needsUpdate=!0,_.needsUpdate=!0),null===r.mapPass&&(r.mapPass=new yr(i.x,i.y)),v.uniforms.shadow_pass.value=r.map.texture,v.uniforms.resolution.value=r.mapSize,v.uniforms.radius.value=r.radius,e.setRenderTarget(r.mapPass),e.clear(),e.renderBufferDirect(n,null,s,v,b,null),_.uniforms.shadow_pass.value=r.mapPass.texture,_.uniforms.resolution.value=r.mapSize,_.uniforms.radius.value=r.radius,e.setRenderTarget(r.map),e.clear(),e.renderBufferDirect(n,null,s,_,b,null)}function M(t,r,n,i,s,o){let a=null;const c=!0===n.isPointLight?t.customDistanceMaterial:t.customDepthMaterial;if(void 0!==c)a=c;else if(a=!0===n.isPointLight?f:p,e.localClippingEnabled&&!0===r.clipShadows&&Array.isArray(r.clippingPlanes)&&0!==r.clippingPlanes.length||r.displacementMap&&0!==r.displacementScale||r.alphaMap&&r.alphaTest>0||r.map&&r.alphaTest>0){const e=a.uuid,t=r.uuid;let n=m[e];void 0===n&&(n={},m[e]=n);let i=n[t];void 0===i&&(i=a.clone(),n[t]=i),a=i}return a.visible=r.visible,a.wireframe=r.wireframe,a.side=o===l?null!==r.shadowSide?r.shadowSide:r.side:null!==r.shadowSide?r.shadowSide:y[r.side],a.alphaMap=r.alphaMap,a.alphaTest=r.alphaTest,a.map=r.map,a.clipShadows=r.clipShadows,a.clippingPlanes=r.clippingPlanes,a.clipIntersection=r.clipIntersection,a.displacementMap=r.displacementMap,a.displacementScale=r.displacementScale,a.displacementBias=r.displacementBias,a.wireframeLinewidth=r.wireframeLinewidth,a.linewidth=r.linewidth,!0===n.isPointLight&&!0===a.isMeshDistanceMaterial&&(a.referencePosition.setFromMatrixPosition(n.matrixWorld),a.nearDistance=i,a.farDistance=s),a}function T(r,i,s,o,a){if(!1===r.visible)return;if(r.layers.test(i.layers)&&(r.isMesh||r.isLine||r.isPoints)&&(r.castShadow||r.receiveShadow&&a===l)&&(!r.frustumCulled||n.intersectsObject(r))){r.modelViewMatrix.multiplyMatrices(s.matrixWorldInverse,r.matrixWorld);const n=t.update(r),i=r.material;if(Array.isArray(i)){const t=n.groups;for(let l=0,c=t.length;l<c;l++){const c=t[l],u=i[c.materialIndex];if(u&&u.visible){const t=M(r,u,o,s.near,s.far,a);e.renderBufferDirect(s,null,n,t,r,c)}}}else if(i.visible){const t=M(r,i,o,s.near,s.far,a);e.renderBufferDirect(s,null,n,t,r,null)}}const c=r.children;for(let e=0,t=c.length;e<t;e++)T(c[e],i,s,o,a)}this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=o,this.render=function(t,r,o){if(!1===w.enabled)return;if(!1===w.autoUpdate&&!1===w.needsUpdate)return;if(0===t.length)return;const c=e.getRenderTarget(),u=e.getActiveCubeFace(),h=e.getActiveMipmapLevel(),p=e.state;p.setBlending(d),p.buffers.color.setClear(1,1,1,1),p.buffers.depth.setTest(!0),p.setScissorTest(!1);for(let c=0,u=t.length;c<u;c++){const u=t[c],h=u.shadow;if(void 0===h)continue;if(!1===h.autoUpdate&&!1===h.needsUpdate)continue;i.copy(h.mapSize);const d=h.getFrameExtents();if(i.multiply(d),s.copy(h.mapSize),(i.x>g||i.y>g)&&(i.x>g&&(s.x=Math.floor(g/d.x),i.x=s.x*d.x,h.mapSize.x=s.x),i.y>g&&(s.y=Math.floor(g/d.y),i.y=s.y*d.y,h.mapSize.y=s.y)),null===h.map){const e=this.type!==l?{minFilter:oe,magFilter:oe}:{};h.map=new yr(i.x,i.y,e),h.map.texture.name=u.name+".shadowMap",h.camera.updateProjectionMatrix()}e.setRenderTarget(h.map),e.clear();const f=h.getViewportCount();for(let e=0;e<f;e++){const t=h.getViewport(e);a.set(s.x*t.x,s.y*t.y,s.x*t.z,s.y*t.w),p.viewport(a),h.updateMatrices(u,e),n=h.getFrustum(),T(r,o,h.camera,u,this.type)}!0!==h.isPointLightShadow&&this.type===l&&S(h,o),h.needsUpdate=!1}w.needsUpdate=!1,e.setRenderTarget(c,u,h)}}function oa(e,t,r){const o=r.isWebGL2;const a=new function(){let t=!1;const r=new gr;let n=null;const i=new gr(0,0,0,0);return{setMask:function(r){n===r||t||(e.colorMask(r,r,r,r),n=r)},setLocked:function(e){t=e},setClear:function(t,n,s,o,a){!0===a&&(t*=o,n*=o,s*=o),r.set(t,n,s,o),!1===i.equals(r)&&(e.clearColor(t,n,s,o),i.copy(r))},reset:function(){t=!1,n=null,i.set(-1,0,0,0)}}},l=new function(){let t=!1,r=null,n=null,i=null;return{setTest:function(t){t?be(e.DEPTH_TEST):we(e.DEPTH_TEST)},setMask:function(n){r===n||t||(e.depthMask(n),r=n)},setFunc:function(t){if(n!==t){switch(t){case D:e.depthFunc(e.NEVER);break;case O:e.depthFunc(e.ALWAYS);break;case N:e.depthFunc(e.LESS);break;case U:e.depthFunc(e.LEQUAL);break;case k:e.depthFunc(e.EQUAL);break;case F:e.depthFunc(e.GEQUAL);break;case B:e.depthFunc(e.GREATER);break;case z:e.depthFunc(e.NOTEQUAL);break;default:e.depthFunc(e.LEQUAL)}n=t}},setLocked:function(e){t=e},setClear:function(t){i!==t&&(e.clearDepth(t),i=t)},reset:function(){t=!1,r=null,n=null,i=null}}},c=new function(){let t=!1,r=null,n=null,i=null,s=null,o=null,a=null,l=null,c=null;return{setTest:function(r){t||(r?be(e.STENCIL_TEST):we(e.STENCIL_TEST))},setMask:function(n){r===n||t||(e.stencilMask(n),r=n)},setFunc:function(t,r,o){n===t&&i===r&&s===o||(e.stencilFunc(t,r,o),n=t,i=r,s=o)},setOp:function(t,r,n){o===t&&a===r&&l===n||(e.stencilOp(t,r,n),o=t,a=r,l=n)},setLocked:function(e){t=e},setClear:function(t){c!==t&&(e.clearStencil(t),c=t)},reset:function(){t=!1,r=null,n=null,i=null,s=null,o=null,a=null,l=null,c=null}}},G=new WeakMap,V=new WeakMap;let H={},W={},X=new WeakMap,q=[],Y=null,Z=!1,J=null,K=null,Q=null,$=null,ee=null,te=null,re=null,ne=!1,ie=null,se=null,oe=null,ae=null,le=null;const ce=e.getParameter(e.MAX_COMBINED_TEXTURE_IMAGE_UNITS);let ue=!1,he=0;const de=e.getParameter(e.VERSION);-1!==de.indexOf("WebGL")?(he=parseFloat(/^WebGL (\d)/.exec(de)[1]),ue=he>=1):-1!==de.indexOf("OpenGL ES")&&(he=parseFloat(/^OpenGL ES (\d)/.exec(de)[1]),ue=he>=2);let pe=null,fe={};const me=e.getParameter(e.SCISSOR_BOX),ge=e.getParameter(e.VIEWPORT),ye=(new gr).fromArray(me),ve=(new gr).fromArray(ge);function _e(t,r,n){const i=new Uint8Array(4),s=e.createTexture();e.bindTexture(t,s),e.texParameteri(t,e.TEXTURE_MIN_FILTER,e.NEAREST),e.texParameteri(t,e.TEXTURE_MAG_FILTER,e.NEAREST);for(let t=0;t<n;t++)e.texImage2D(r+t,0,e.RGBA,1,1,0,e.RGBA,e.UNSIGNED_BYTE,i);return s}const xe={};function be(t){!0!==H[t]&&(e.enable(t),H[t]=!0)}function we(t){!1!==H[t]&&(e.disable(t),H[t]=!1)}xe[e.TEXTURE_2D]=_e(e.TEXTURE_2D,e.TEXTURE_2D,1),xe[e.TEXTURE_CUBE_MAP]=_e(e.TEXTURE_CUBE_MAP,e.TEXTURE_CUBE_MAP_POSITIVE_X,6),a.setClear(0,0,0,1),l.setClear(1),c.setClear(0),be(e.DEPTH_TEST),l.setFunc(U),Ee(!1),Ae(i),be(e.CULL_FACE),Te(d);const Se={[v]:e.FUNC_ADD,[_]:e.FUNC_SUBTRACT,[x]:e.FUNC_REVERSE_SUBTRACT};if(o)Se[b]=e.MIN,Se[w]=e.MAX;else{const e=t.get("EXT_blend_minmax");null!==e&&(Se[b]=e.MIN_EXT,Se[w]=e.MAX_EXT)}const Me={[S]:e.ZERO,[M]:e.ONE,[T]:e.SRC_COLOR,[A]:e.SRC_ALPHA,[I]:e.SRC_ALPHA_SATURATE,[P]:e.DST_COLOR,[L]:e.DST_ALPHA,[E]:e.ONE_MINUS_SRC_COLOR,[C]:e.ONE_MINUS_SRC_ALPHA,[j]:e.ONE_MINUS_DST_COLOR,[R]:e.ONE_MINUS_DST_ALPHA};function Te(t,r,n,i,s,o,a,l){if(t!==d){if(!1===Z&&(be(e.BLEND),Z=!0),t===y)s=s||r,o=o||n,a=a||i,r===K&&s===ee||(e.blendEquationSeparate(Se[r],Se[s]),K=r,ee=s),n===Q&&i===$&&o===te&&a===re||(e.blendFuncSeparate(Me[n],Me[i],Me[o],Me[a]),Q=n,$=i,te=o,re=a),J=t,ne=!1;else if(t!==J||l!==ne){if(K===v&&ee===v||(e.blendEquation(e.FUNC_ADD),K=v,ee=v),l)switch(t){case p:e.blendFuncSeparate(e.ONE,e.ONE_MINUS_SRC_ALPHA,e.ONE,e.ONE_MINUS_SRC_ALPHA);break;case f:e.blendFunc(e.ONE,e.ONE);break;case m:e.blendFuncSeparate(e.ZERO,e.ONE_MINUS_SRC_COLOR,e.ZERO,e.ONE);break;case g:e.blendFuncSeparate(e.ZERO,e.SRC_COLOR,e.ZERO,e.SRC_ALPHA)}else switch(t){case p:e.blendFuncSeparate(e.SRC_ALPHA,e.ONE_MINUS_SRC_ALPHA,e.ONE,e.ONE_MINUS_SRC_ALPHA);break;case f:e.blendFunc(e.SRC_ALPHA,e.ONE);break;case m:e.blendFuncSeparate(e.ZERO,e.ONE_MINUS_SRC_COLOR,e.ZERO,e.ONE);break;case g:e.blendFunc(e.ZERO,e.SRC_COLOR)}Q=null,$=null,te=null,re=null,J=t,ne=l}}else!0===Z&&(we(e.BLEND),Z=!1)}function Ee(t){ie!==t&&(t?e.frontFace(e.CW):e.frontFace(e.CCW),ie=t)}function Ae(t){t!==n?(be(e.CULL_FACE),t!==se&&(t===i?e.cullFace(e.BACK):t===s?e.cullFace(e.FRONT):e.cullFace(e.FRONT_AND_BACK))):we(e.CULL_FACE),se=t}function Ce(t,r,n){t?(be(e.POLYGON_OFFSET_FILL),ae===r&&le===n||(e.polygonOffset(r,n),ae=r,le=n)):we(e.POLYGON_OFFSET_FILL)}return{buffers:{color:a,depth:l,stencil:c},enable:be,disable:we,bindFramebuffer:function(t,r){return W[t]!==r&&(e.bindFramebuffer(t,r),W[t]=r,o&&(t===e.DRAW_FRAMEBUFFER&&(W[e.FRAMEBUFFER]=r),t===e.FRAMEBUFFER&&(W[e.DRAW_FRAMEBUFFER]=r)),!0)},drawBuffers:function(n,i){let s=q,o=!1;if(n)if(s=X.get(i),void 0===s&&(s=[],X.set(i,s)),n.isWebGLMultipleRenderTargets){const t=n.texture;if(s.length!==t.length||s[0]!==e.COLOR_ATTACHMENT0){for(let r=0,n=t.length;r<n;r++)s[r]=e.COLOR_ATTACHMENT0+r;s.length=t.length,o=!0}}else s[0]!==e.COLOR_ATTACHMENT0&&(s[0]=e.COLOR_ATTACHMENT0,o=!0);else s[0]!==e.BACK&&(s[0]=e.BACK,o=!0);o&&(r.isWebGL2?e.drawBuffers(s):t.get("WEBGL_draw_buffers").drawBuffersWEBGL(s))},useProgram:function(t){return Y!==t&&(e.useProgram(t),Y=t,!0)},setBlending:Te,setMaterial:function(t,r){t.side===h?we(e.CULL_FACE):be(e.CULL_FACE);let n=t.side===u;r&&(n=!n),Ee(n),t.blending===p&&!1===t.transparent?Te(d):Te(t.blending,t.blendEquation,t.blendSrc,t.blendDst,t.blendEquationAlpha,t.blendSrcAlpha,t.blendDstAlpha,t.premultipliedAlpha),l.setFunc(t.depthFunc),l.setTest(t.depthTest),l.setMask(t.depthWrite),a.setMask(t.colorWrite);const i=t.stencilWrite;c.setTest(i),i&&(c.setMask(t.stencilWriteMask),c.setFunc(t.stencilFunc,t.stencilRef,t.stencilFuncMask),c.setOp(t.stencilFail,t.stencilZFail,t.stencilZPass)),Ce(t.polygonOffset,t.polygonOffsetFactor,t.polygonOffsetUnits),!0===t.alphaToCoverage?be(e.SAMPLE_ALPHA_TO_COVERAGE):we(e.SAMPLE_ALPHA_TO_COVERAGE)},setFlipSided:Ee,setCullFace:Ae,setLineWidth:function(t){t!==oe&&(ue&&e.lineWidth(t),oe=t)},setPolygonOffset:Ce,setScissorTest:function(t){t?be(e.SCISSOR_TEST):we(e.SCISSOR_TEST)},activeTexture:function(t){void 0===t&&(t=e.TEXTURE0+ce-1),pe!==t&&(e.activeTexture(t),pe=t)},bindTexture:function(t,r,n){void 0===n&&(n=null===pe?e.TEXTURE0+ce-1:pe);let i=fe[n];void 0===i&&(i={type:void 0,texture:void 0},fe[n]=i),i.type===t&&i.texture===r||(pe!==n&&(e.activeTexture(n),pe=n),e.bindTexture(t,r||xe[t]),i.type=t,i.texture=r)},unbindTexture:function(){const t=fe[pe];void 0!==t&&void 0!==t.type&&(e.bindTexture(t.type,null),t.type=void 0,t.texture=void 0)},compressedTexImage2D:function(){try{e.compressedTexImage2D.apply(e,arguments)}catch(e){}},compressedTexImage3D:function(){try{e.compressedTexImage3D.apply(e,arguments)}catch(e){}},texImage2D:function(){try{e.texImage2D.apply(e,arguments)}catch(e){}},texImage3D:function(){try{e.texImage3D.apply(e,arguments)}catch(e){}},updateUBOMapping:function(t,r){let n=V.get(r);void 0===n&&(n=new WeakMap,V.set(r,n));let i=n.get(t);void 0===i&&(i=e.getUniformBlockIndex(r,t.name),n.set(t,i))},uniformBlockBinding:function(t,r){const n=V.get(r).get(t);G.get(r)!==n&&(e.uniformBlockBinding(r,n,t.__bindingPointIndex),G.set(r,n))},texStorage2D:function(){try{e.texStorage2D.apply(e,arguments)}catch(e){}},texStorage3D:function(){try{e.texStorage3D.apply(e,arguments)}catch(e){}},texSubImage2D:function(){try{e.texSubImage2D.apply(e,arguments)}catch(e){}},texSubImage3D:function(){try{e.texSubImage3D.apply(e,arguments)}catch(e){}},compressedTexSubImage2D:function(){try{e.compressedTexSubImage2D.apply(e,arguments)}catch(e){}},compressedTexSubImage3D:function(){try{e.compressedTexSubImage3D.apply(e,arguments)}catch(e){}},scissor:function(t){!1===ye.equals(t)&&(e.scissor(t.x,t.y,t.z,t.w),ye.copy(t))},viewport:function(t){!1===ve.equals(t)&&(e.viewport(t.x,t.y,t.z,t.w),ve.copy(t))},reset:function(){e.disable(e.BLEND),e.disable(e.CULL_FACE),e.disable(e.DEPTH_TEST),e.disable(e.POLYGON_OFFSET_FILL),e.disable(e.SCISSOR_TEST),e.disable(e.STENCIL_TEST),e.disable(e.SAMPLE_ALPHA_TO_COVERAGE),e.blendEquation(e.FUNC_ADD),e.blendFunc(e.ONE,e.ZERO),e.blendFuncSeparate(e.ONE,e.ZERO,e.ONE,e.ZERO),e.colorMask(!0,!0,!0,!0),e.clearColor(0,0,0,0),e.depthMask(!0),e.depthFunc(e.LESS),e.clearDepth(1),e.stencilMask(4294967295),e.stencilFunc(e.ALWAYS,0,4294967295),e.stencilOp(e.KEEP,e.KEEP,e.KEEP),e.clearStencil(0),e.cullFace(e.BACK),e.frontFace(e.CCW),e.polygonOffset(0,0),e.activeTexture(e.TEXTURE0),e.bindFramebuffer(e.FRAMEBUFFER,null),!0===o&&(e.bindFramebuffer(e.DRAW_FRAMEBUFFER,null),e.bindFramebuffer(e.READ_FRAMEBUFFER,null)),e.useProgram(null),e.lineWidth(1),e.scissor(0,0,e.canvas.width,e.canvas.height),e.viewport(0,0,e.canvas.width,e.canvas.height),H={},pe=null,fe={},W={},X=new WeakMap,q=[],Y=null,Z=!1,J=null,K=null,Q=null,$=null,ee=null,te=null,re=null,ne=!1,ie=null,se=null,oe=null,ae=null,le=null,ye.set(0,0,e.canvas.width,e.canvas.height),ve.set(0,0,e.canvas.width,e.canvas.height),a.reset(),l.reset(),c.reset()}}}function aa(e,t,r,n,i,s,o){const a=i.isWebGL2,l=(i.maxTextures,i.maxCubemapSize),c=i.maxTextureSize,u=i.maxSamples,h=t.has("WEBGL_multisampled_render_to_texture")?t.get("WEBGL_multisampled_render_to_texture"):null,d="undefined"!=typeof navigator&&/OculusBrowser/g.test(navigator.userAgent),p=new WeakMap;let f;const m=new WeakMap;let g=!1;try{g="undefined"!=typeof OffscreenCanvas&&null!==new OffscreenCanvas(1,1).getContext("2d")}catch(e){}function y(e,t){return g?new OffscreenCanvas(e,t):Kt("canvas")}function v(e,t,r,n){let i=1;if((e.width>n||e.height>n)&&(i=n/Math.max(e.width,e.height)),i<1||!0===t){if("undefined"!=typeof HTMLImageElement&&e instanceof HTMLImageElement||"undefined"!=typeof HTMLCanvasElement&&e instanceof HTMLCanvasElement||"undefined"!=typeof ImageBitmap&&e instanceof ImageBitmap){const n=t?zt:Math.floor,s=n(i*e.width),o=n(i*e.height);void 0===f&&(f=y(s,o));const a=r?y(s,o):f;a.width=s,a.height=o;return a.getContext("2d").drawImage(e,0,0,s,o),a}return e}return e}function _(e){return Ft(e.width)&&Ft(e.height)}function x(e,t){return e.generateMipmaps&&t&&e.minFilter!==oe&&e.minFilter!==ce}function b(t){e.generateMipmap(t)}function w(r,n,i,s,o=!1){if(!1===a)return n;if(null!==r&&void 0!==e[r])return e[r];let l=n;return n===e.RED&&(i===e.FLOAT&&(l=e.R32F),i===e.HALF_FLOAT&&(l=e.R16F),i===e.UNSIGNED_BYTE&&(l=e.R8)),n===e.RG&&(i===e.FLOAT&&(l=e.RG32F),i===e.HALF_FLOAT&&(l=e.RG16F),i===e.UNSIGNED_BYTE&&(l=e.RG8)),n===e.RGBA&&(i===e.FLOAT&&(l=e.RGBA32F),i===e.HALF_FLOAT&&(l=e.RGBA16F),i===e.UNSIGNED_BYTE&&(l=s===_t&&!1===o?e.SRGB8_ALPHA8:e.RGBA8),i===e.UNSIGNED_SHORT_4_4_4_4&&(l=e.RGBA4),i===e.UNSIGNED_SHORT_5_5_5_1&&(l=e.RGB5_A1)),l!==e.R16F&&l!==e.R32F&&l!==e.RG16F&&l!==e.RG32F&&l!==e.RGBA16F&&l!==e.RGBA32F||t.get("EXT_color_buffer_float"),l}function S(e,t,r){return!0===x(e,r)||e.isFramebufferTexture&&e.minFilter!==oe&&e.minFilter!==ce?Math.log2(Math.max(t.width,t.height))+1:void 0!==e.mipmaps&&e.mipmaps.length>0?e.mipmaps.length:e.isCompressedTexture&&Array.isArray(e.image)?t.mipmaps.length:1}function M(t){return t===oe||t===ae||t===le?e.NEAREST:e.LINEAR}function T(e){const t=e.target;t.removeEventListener("dispose",T),function(e){const t=n.get(e);if(void 0===t.__webglInit)return;const r=e.source,i=m.get(r);if(i){const n=i[t.__cacheKey];n.usedTimes--,0===n.usedTimes&&A(e),0===Object.keys(i).length&&m.delete(r)}n.remove(e)}(t),t.isVideoTexture&&p.delete(t)}function E(t){const r=t.target;r.removeEventListener("dispose",E),function(t){const r=t.texture,i=n.get(t),s=n.get(r);void 0!==s.__webglTexture&&(e.deleteTexture(s.__webglTexture),o.memory.textures--);t.depthTexture&&t.depthTexture.dispose();if(t.isWebGLCubeRenderTarget)for(let t=0;t<6;t++)e.deleteFramebuffer(i.__webglFramebuffer[t]),i.__webglDepthbuffer&&e.deleteRenderbuffer(i.__webglDepthbuffer[t]);else{if(e.deleteFramebuffer(i.__webglFramebuffer),i.__webglDepthbuffer&&e.deleteRenderbuffer(i.__webglDepthbuffer),i.__webglMultisampledFramebuffer&&e.deleteFramebuffer(i.__webglMultisampledFramebuffer),i.__webglColorRenderbuffer)for(let t=0;t<i.__webglColorRenderbuffer.length;t++)i.__webglColorRenderbuffer[t]&&e.deleteRenderbuffer(i.__webglColorRenderbuffer[t]);i.__webglDepthRenderbuffer&&e.deleteRenderbuffer(i.__webglDepthRenderbuffer)}if(t.isWebGLMultipleRenderTargets)for(let t=0,i=r.length;t<i;t++){const i=n.get(r[t]);i.__webglTexture&&(e.deleteTexture(i.__webglTexture),o.memory.textures--),n.remove(r[t])}n.remove(r),n.remove(t)}(r)}function A(t){const r=n.get(t);e.deleteTexture(r.__webglTexture);const i=t.source;delete m.get(i)[r.__cacheKey],o.memory.textures--}let C=0;function L(t,i){const s=n.get(t);if(t.isVideoTexture&&function(e){const t=o.render.frame;p.get(e)!==t&&(p.set(e,t),e.update())}(t),!1===t.isRenderTargetTexture&&t.version>0&&s.__version!==t.version){const e=t.image;if(null===e);else if(!1!==e.complete)return void D(s,t,i)}r.bindTexture(e.TEXTURE_2D,s.__webglTexture,e.TEXTURE0+i)}const R={[ne]:e.REPEAT,[ie]:e.CLAMP_TO_EDGE,[se]:e.MIRRORED_REPEAT},P={[oe]:e.NEAREST,[ae]:e.NEAREST_MIPMAP_NEAREST,[le]:e.NEAREST_MIPMAP_LINEAR,[ce]:e.LINEAR,[ue]:e.LINEAR_MIPMAP_NEAREST,[he]:e.LINEAR_MIPMAP_LINEAR};function j(r,s,o){if(o?(e.texParameteri(r,e.TEXTURE_WRAP_S,R[s.wrapS]),e.texParameteri(r,e.TEXTURE_WRAP_T,R[s.wrapT]),r!==e.TEXTURE_3D&&r!==e.TEXTURE_2D_ARRAY||e.texParameteri(r,e.TEXTURE_WRAP_R,R[s.wrapR]),e.texParameteri(r,e.TEXTURE_MAG_FILTER,P[s.magFilter]),e.texParameteri(r,e.TEXTURE_MIN_FILTER,P[s.minFilter])):(e.texParameteri(r,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(r,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE),r!==e.TEXTURE_3D&&r!==e.TEXTURE_2D_ARRAY||e.texParameteri(r,e.TEXTURE_WRAP_R,e.CLAMP_TO_EDGE),s.wrapS!==ie||s.wrapT,e.texParameteri(r,e.TEXTURE_MAG_FILTER,M(s.magFilter)),e.texParameteri(r,e.TEXTURE_MIN_FILTER,M(s.minFilter)),s.minFilter!==oe&&s.minFilter),!0===t.has("EXT_texture_filter_anisotropic")){const o=t.get("EXT_texture_filter_anisotropic");if(s.magFilter===oe)return;if(s.minFilter!==le&&s.minFilter!==he)return;if(s.type===ve&&!1===t.has("OES_texture_float_linear"))return;if(!1===a&&s.type===_e&&!1===t.has("OES_texture_half_float_linear"))return;(s.anisotropy>1||n.get(s).__currentAnisotropy)&&(e.texParameterf(r,o.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(s.anisotropy,i.getMaxAnisotropy())),n.get(s).__currentAnisotropy=s.anisotropy)}}function I(t,r){let n=!1;void 0===t.__webglInit&&(t.__webglInit=!0,r.addEventListener("dispose",T));const i=r.source;let s=m.get(i);void 0===s&&(s={},m.set(i,s));const a=function(e){const t=[];return t.push(e.wrapS),t.push(e.wrapT),t.push(e.wrapR||0),t.push(e.magFilter),t.push(e.minFilter),t.push(e.anisotropy),t.push(e.internalFormat),t.push(e.format),t.push(e.type),t.push(e.generateMipmaps),t.push(e.premultiplyAlpha),t.push(e.flipY),t.push(e.unpackAlignment),t.push(e.encoding),t.join()}(r);if(a!==t.__cacheKey){void 0===s[a]&&(s[a]={texture:e.createTexture(),usedTimes:0},o.memory.textures++,n=!0),s[a].usedTimes++;const i=s[t.__cacheKey];void 0!==i&&(s[t.__cacheKey].usedTimes--,0===i.usedTimes&&A(r)),t.__cacheKey=a,t.__webglTexture=s[a].texture}return n}function D(t,i,o){let l=e.TEXTURE_2D;(i.isDataArrayTexture||i.isCompressedArrayTexture)&&(l=e.TEXTURE_2D_ARRAY),i.isData3DTexture&&(l=e.TEXTURE_3D);const u=I(t,i),h=i.source;r.bindTexture(l,t.__webglTexture,e.TEXTURE0+o);const d=n.get(h);if(h.version!==d.__version||!0===u){r.activeTexture(e.TEXTURE0+o),e.pixelStorei(e.UNPACK_FLIP_Y_WEBGL,i.flipY),e.pixelStorei(e.UNPACK_PREMULTIPLY_ALPHA_WEBGL,i.premultiplyAlpha),e.pixelStorei(e.UNPACK_ALIGNMENT,i.unpackAlignment),e.pixelStorei(e.UNPACK_COLORSPACE_CONVERSION_WEBGL,e.NONE);const t=function(e){return!a&&(e.wrapS!==ie||e.wrapT!==ie||e.minFilter!==oe&&e.minFilter!==ce)}(i)&&!1===_(i.image);let n=v(i.image,t,!1,c);n=B(i,n);const p=_(n)||a,f=s.convert(i.format,i.encoding);let m,g=s.convert(i.type),y=w(i.internalFormat,f,g,i.encoding,i.isVideoTexture);j(l,i,p);const M=i.mipmaps,T=a&&!0!==i.isVideoTexture,E=void 0===d.__version||!0===u,A=S(i,n,p);if(i.isDepthTexture)y=e.DEPTH_COMPONENT,a?y=i.type===ve?e.DEPTH_COMPONENT32F:i.type===ye?e.DEPTH_COMPONENT24:i.type===we?e.DEPTH24_STENCIL8:e.DEPTH_COMPONENT16:i.type,i.format===Ae&&y===e.DEPTH_COMPONENT&&i.type!==me&&i.type!==ye&&(i.type=ye,g=s.convert(i.type)),i.format===Ce&&y===e.DEPTH_COMPONENT&&(y=e.DEPTH_STENCIL,i.type!==we&&(i.type=we,g=s.convert(i.type))),E&&(T?r.texStorage2D(e.TEXTURE_2D,1,y,n.width,n.height):r.texImage2D(e.TEXTURE_2D,0,y,n.width,n.height,0,f,g,null));else if(i.isDataTexture)if(M.length>0&&p){T&&E&&r.texStorage2D(e.TEXTURE_2D,A,y,M[0].width,M[0].height);for(let t=0,n=M.length;t<n;t++)m=M[t],T?r.texSubImage2D(e.TEXTURE_2D,t,0,0,m.width,m.height,f,g,m.data):r.texImage2D(e.TEXTURE_2D,t,y,m.width,m.height,0,f,g,m.data);i.generateMipmaps=!1}else T?(E&&r.texStorage2D(e.TEXTURE_2D,A,y,n.width,n.height),r.texSubImage2D(e.TEXTURE_2D,0,0,0,n.width,n.height,f,g,n.data)):r.texImage2D(e.TEXTURE_2D,0,y,n.width,n.height,0,f,g,n.data);else if(i.isCompressedTexture)if(i.isCompressedArrayTexture){T&&E&&r.texStorage3D(e.TEXTURE_2D_ARRAY,A,y,M[0].width,M[0].height,n.depth);for(let t=0,s=M.length;t<s;t++)m=M[t],i.format!==Me?null!==f&&(T?r.compressedTexSubImage3D(e.TEXTURE_2D_ARRAY,t,0,0,0,m.width,m.height,n.depth,f,m.data,0,0):r.compressedTexImage3D(e.TEXTURE_2D_ARRAY,t,y,m.width,m.height,n.depth,0,m.data,0,0)):T?r.texSubImage3D(e.TEXTURE_2D_ARRAY,t,0,0,0,m.width,m.height,n.depth,f,g,m.data):r.texImage3D(e.TEXTURE_2D_ARRAY,t,y,m.width,m.height,n.depth,0,f,g,m.data)}else{T&&E&&r.texStorage2D(e.TEXTURE_2D,A,y,M[0].width,M[0].height);for(let t=0,n=M.length;t<n;t++)m=M[t],i.format!==Me?null!==f&&(T?r.compressedTexSubImage2D(e.TEXTURE_2D,t,0,0,m.width,m.height,f,m.data):r.compressedTexImage2D(e.TEXTURE_2D,t,y,m.width,m.height,0,m.data)):T?r.texSubImage2D(e.TEXTURE_2D,t,0,0,m.width,m.height,f,g,m.data):r.texImage2D(e.TEXTURE_2D,t,y,m.width,m.height,0,f,g,m.data)}else if(i.isDataArrayTexture)T?(E&&r.texStorage3D(e.TEXTURE_2D_ARRAY,A,y,n.width,n.height,n.depth),r.texSubImage3D(e.TEXTURE_2D_ARRAY,0,0,0,0,n.width,n.height,n.depth,f,g,n.data)):r.texImage3D(e.TEXTURE_2D_ARRAY,0,y,n.width,n.height,n.depth,0,f,g,n.data);else if(i.isData3DTexture)T?(E&&r.texStorage3D(e.TEXTURE_3D,A,y,n.width,n.height,n.depth),r.texSubImage3D(e.TEXTURE_3D,0,0,0,0,n.width,n.height,n.depth,f,g,n.data)):r.texImage3D(e.TEXTURE_3D,0,y,n.width,n.height,n.depth,0,f,g,n.data);else if(i.isFramebufferTexture){if(E)if(T)r.texStorage2D(e.TEXTURE_2D,A,y,n.width,n.height);else{let t=n.width,i=n.height;for(let n=0;n<A;n++)r.texImage2D(e.TEXTURE_2D,n,y,t,i,0,f,g,null),t>>=1,i>>=1}}else if(M.length>0&&p){T&&E&&r.texStorage2D(e.TEXTURE_2D,A,y,M[0].width,M[0].height);for(let t=0,n=M.length;t<n;t++)m=M[t],T?r.texSubImage2D(e.TEXTURE_2D,t,0,0,f,g,m):r.texImage2D(e.TEXTURE_2D,t,y,f,g,m);i.generateMipmaps=!1}else T?(E&&r.texStorage2D(e.TEXTURE_2D,A,y,n.width,n.height),r.texSubImage2D(e.TEXTURE_2D,0,0,0,f,g,n)):r.texImage2D(e.TEXTURE_2D,0,y,f,g,n);x(i,p)&&b(l),d.__version=h.version,i.onUpdate&&i.onUpdate(i)}t.__version=i.version}function O(t,i,o,a,l){const c=s.convert(o.format,o.encoding),u=s.convert(o.type),d=w(o.internalFormat,c,u,o.encoding);n.get(i).__hasExternalTextures||(l===e.TEXTURE_3D||l===e.TEXTURE_2D_ARRAY?r.texImage3D(l,0,d,i.width,i.height,i.depth,0,c,u,null):r.texImage2D(l,0,d,i.width,i.height,0,c,u,null)),r.bindFramebuffer(e.FRAMEBUFFER,t),F(i)?h.framebufferTexture2DMultisampleEXT(e.FRAMEBUFFER,a,l,n.get(o).__webglTexture,0,k(i)):(l===e.TEXTURE_2D||l>=e.TEXTURE_CUBE_MAP_POSITIVE_X&&l<=e.TEXTURE_CUBE_MAP_NEGATIVE_Z)&&e.framebufferTexture2D(e.FRAMEBUFFER,a,l,n.get(o).__webglTexture,0),r.bindFramebuffer(e.FRAMEBUFFER,null)}function N(t,r,n){if(e.bindRenderbuffer(e.RENDERBUFFER,t),r.depthBuffer&&!r.stencilBuffer){let i=e.DEPTH_COMPONENT16;if(n||F(r)){const t=r.depthTexture;t&&t.isDepthTexture&&(t.type===ve?i=e.DEPTH_COMPONENT32F:t.type===ye&&(i=e.DEPTH_COMPONENT24));const n=k(r);F(r)?h.renderbufferStorageMultisampleEXT(e.RENDERBUFFER,n,i,r.width,r.height):e.renderbufferStorageMultisample(e.RENDERBUFFER,n,i,r.width,r.height)}else e.renderbufferStorage(e.RENDERBUFFER,i,r.width,r.height);e.framebufferRenderbuffer(e.FRAMEBUFFER,e.DEPTH_ATTACHMENT,e.RENDERBUFFER,t)}else if(r.depthBuffer&&r.stencilBuffer){const i=k(r);n&&!1===F(r)?e.renderbufferStorageMultisample(e.RENDERBUFFER,i,e.DEPTH24_STENCIL8,r.width,r.height):F(r)?h.renderbufferStorageMultisampleEXT(e.RENDERBUFFER,i,e.DEPTH24_STENCIL8,r.width,r.height):e.renderbufferStorage(e.RENDERBUFFER,e.DEPTH_STENCIL,r.width,r.height),e.framebufferRenderbuffer(e.FRAMEBUFFER,e.DEPTH_STENCIL_ATTACHMENT,e.RENDERBUFFER,t)}else{const t=!0===r.isWebGLMultipleRenderTargets?r.texture:[r.texture];for(let i=0;i<t.length;i++){const o=t[i],a=s.convert(o.format,o.encoding),l=s.convert(o.type),c=w(o.internalFormat,a,l,o.encoding),u=k(r);n&&!1===F(r)?e.renderbufferStorageMultisample(e.RENDERBUFFER,u,c,r.width,r.height):F(r)?h.renderbufferStorageMultisampleEXT(e.RENDERBUFFER,u,c,r.width,r.height):e.renderbufferStorage(e.RENDERBUFFER,c,r.width,r.height)}}e.bindRenderbuffer(e.RENDERBUFFER,null)}function U(t){const i=n.get(t),s=!0===t.isWebGLCubeRenderTarget;if(t.depthTexture&&!i.__autoAllocateDepthBuffer){if(s)throw new Error("target.depthTexture not supported in Cube render targets");!function(t,i){if(i&&i.isWebGLCubeRenderTarget)throw new Error("Depth Texture with cube render targets is not supported");if(r.bindFramebuffer(e.FRAMEBUFFER,t),!i.depthTexture||!i.depthTexture.isDepthTexture)throw new Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");n.get(i.depthTexture).__webglTexture&&i.depthTexture.image.width===i.width&&i.depthTexture.image.height===i.height||(i.depthTexture.image.width=i.width,i.depthTexture.image.height=i.height,i.depthTexture.needsUpdate=!0),L(i.depthTexture,0);const s=n.get(i.depthTexture).__webglTexture,o=k(i);if(i.depthTexture.format===Ae)F(i)?h.framebufferTexture2DMultisampleEXT(e.FRAMEBUFFER,e.DEPTH_ATTACHMENT,e.TEXTURE_2D,s,0,o):e.framebufferTexture2D(e.FRAMEBUFFER,e.DEPTH_ATTACHMENT,e.TEXTURE_2D,s,0);else{if(i.depthTexture.format!==Ce)throw new Error("Unknown depthTexture format");F(i)?h.framebufferTexture2DMultisampleEXT(e.FRAMEBUFFER,e.DEPTH_STENCIL_ATTACHMENT,e.TEXTURE_2D,s,0,o):e.framebufferTexture2D(e.FRAMEBUFFER,e.DEPTH_STENCIL_ATTACHMENT,e.TEXTURE_2D,s,0)}}(i.__webglFramebuffer,t)}else if(s){i.__webglDepthbuffer=[];for(let n=0;n<6;n++)r.bindFramebuffer(e.FRAMEBUFFER,i.__webglFramebuffer[n]),i.__webglDepthbuffer[n]=e.createRenderbuffer(),N(i.__webglDepthbuffer[n],t,!1)}else r.bindFramebuffer(e.FRAMEBUFFER,i.__webglFramebuffer),i.__webglDepthbuffer=e.createRenderbuffer(),N(i.__webglDepthbuffer,t,!1);r.bindFramebuffer(e.FRAMEBUFFER,null)}function k(e){return Math.min(u,e.samples)}function F(e){const r=n.get(e);return a&&e.samples>0&&!0===t.has("WEBGL_multisampled_render_to_texture")&&!1!==r.__useRenderToTexture}function B(e,r){const n=e.encoding,i=e.format;e.type;return!0===e.isCompressedTexture||!0===e.isVideoTexture||e.format===Lt||n!==vt&&n===_t&&!1===a&&(!0===t.has("EXT_sRGB")&&i===Me?(e.format=Lt,e.minFilter=ce,e.generateMipmaps=!1):r=hr.sRGBToLinear(r)),r}this.allocateTextureUnit=function(){const e=C;return C+=1,e},this.resetTextureUnits=function(){C=0},this.setTexture2D=L,this.setTexture2DArray=function(t,i){const s=n.get(t);t.version>0&&s.__version!==t.version?D(s,t,i):r.bindTexture(e.TEXTURE_2D_ARRAY,s.__webglTexture,e.TEXTURE0+i)},this.setTexture3D=function(t,i){const s=n.get(t);t.version>0&&s.__version!==t.version?D(s,t,i):r.bindTexture(e.TEXTURE_3D,s.__webglTexture,e.TEXTURE0+i)},this.setTextureCube=function(t,i){const o=n.get(t);t.version>0&&o.__version!==t.version?function(t,i,o){if(6!==i.image.length)return;const c=I(t,i),u=i.source;r.bindTexture(e.TEXTURE_CUBE_MAP,t.__webglTexture,e.TEXTURE0+o);const h=n.get(u);if(u.version!==h.__version||!0===c){r.activeTexture(e.TEXTURE0+o),e.pixelStorei(e.UNPACK_FLIP_Y_WEBGL,i.flipY),e.pixelStorei(e.UNPACK_PREMULTIPLY_ALPHA_WEBGL,i.premultiplyAlpha),e.pixelStorei(e.UNPACK_ALIGNMENT,i.unpackAlignment),e.pixelStorei(e.UNPACK_COLORSPACE_CONVERSION_WEBGL,e.NONE);const t=i.isCompressedTexture||i.image[0].isCompressedTexture,n=i.image[0]&&i.image[0].isDataTexture,d=[];for(let e=0;e<6;e++)d[e]=t||n?n?i.image[e].image:i.image[e]:v(i.image[e],!1,!0,l),d[e]=B(i,d[e]);const p=d[0],f=_(p)||a,m=s.convert(i.format,i.encoding),g=s.convert(i.type),y=w(i.internalFormat,m,g,i.encoding),M=a&&!0!==i.isVideoTexture,T=void 0===h.__version||!0===c;let E,A=S(i,p,f);if(j(e.TEXTURE_CUBE_MAP,i,f),t){M&&T&&r.texStorage2D(e.TEXTURE_CUBE_MAP,A,y,p.width,p.height);for(let t=0;t<6;t++){E=d[t].mipmaps;for(let n=0;n<E.length;n++){const s=E[n];i.format!==Me?null!==m&&(M?r.compressedTexSubImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+t,n,0,0,s.width,s.height,m,s.data):r.compressedTexImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+t,n,y,s.width,s.height,0,s.data)):M?r.texSubImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+t,n,0,0,s.width,s.height,m,g,s.data):r.texImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+t,n,y,s.width,s.height,0,m,g,s.data)}}}else{E=i.mipmaps,M&&T&&(E.length>0&&A++,r.texStorage2D(e.TEXTURE_CUBE_MAP,A,y,d[0].width,d[0].height));for(let t=0;t<6;t++)if(n){M?r.texSubImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+t,0,0,0,d[t].width,d[t].height,m,g,d[t].data):r.texImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+t,0,y,d[t].width,d[t].height,0,m,g,d[t].data);for(let n=0;n<E.length;n++){const i=E[n].image[t].image;M?r.texSubImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+t,n+1,0,0,i.width,i.height,m,g,i.data):r.texImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+t,n+1,y,i.width,i.height,0,m,g,i.data)}}else{M?r.texSubImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+t,0,0,0,m,g,d[t]):r.texImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+t,0,y,m,g,d[t]);for(let n=0;n<E.length;n++){const i=E[n];M?r.texSubImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+t,n+1,0,0,m,g,i.image[t]):r.texImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+t,n+1,y,m,g,i.image[t])}}}x(i,f)&&b(e.TEXTURE_CUBE_MAP),h.__version=u.version,i.onUpdate&&i.onUpdate(i)}t.__version=i.version}(o,t,i):r.bindTexture(e.TEXTURE_CUBE_MAP,o.__webglTexture,e.TEXTURE0+i)},this.rebindTextures=function(t,r,i){const s=n.get(t);void 0!==r&&O(s.__webglFramebuffer,t,t.texture,e.COLOR_ATTACHMENT0,e.TEXTURE_2D),void 0!==i&&U(t)},this.setupRenderTarget=function(t){const l=t.texture,c=n.get(t),u=n.get(l);t.addEventListener("dispose",E),!0!==t.isWebGLMultipleRenderTargets&&(void 0===u.__webglTexture&&(u.__webglTexture=e.createTexture()),u.__version=l.version,o.memory.textures++);const h=!0===t.isWebGLCubeRenderTarget,d=!0===t.isWebGLMultipleRenderTargets,p=_(t)||a;if(h){c.__webglFramebuffer=[];for(let t=0;t<6;t++)c.__webglFramebuffer[t]=e.createFramebuffer()}else{if(c.__webglFramebuffer=e.createFramebuffer(),d&&i.drawBuffers){const r=t.texture;for(let t=0,i=r.length;t<i;t++){const i=n.get(r[t]);void 0===i.__webglTexture&&(i.__webglTexture=e.createTexture(),o.memory.textures++)}}if(a&&t.samples>0&&!1===F(t)){const n=d?l:[l];c.__webglMultisampledFramebuffer=e.createFramebuffer(),c.__webglColorRenderbuffer=[],r.bindFramebuffer(e.FRAMEBUFFER,c.__webglMultisampledFramebuffer);for(let r=0;r<n.length;r++){const i=n[r];c.__webglColorRenderbuffer[r]=e.createRenderbuffer(),e.bindRenderbuffer(e.RENDERBUFFER,c.__webglColorRenderbuffer[r]);const o=s.convert(i.format,i.encoding),a=s.convert(i.type),l=w(i.internalFormat,o,a,i.encoding,!0===t.isXRRenderTarget),u=k(t);e.renderbufferStorageMultisample(e.RENDERBUFFER,u,l,t.width,t.height),e.framebufferRenderbuffer(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0+r,e.RENDERBUFFER,c.__webglColorRenderbuffer[r])}e.bindRenderbuffer(e.RENDERBUFFER,null),t.depthBuffer&&(c.__webglDepthRenderbuffer=e.createRenderbuffer(),N(c.__webglDepthRenderbuffer,t,!0)),r.bindFramebuffer(e.FRAMEBUFFER,null)}}if(h){r.bindTexture(e.TEXTURE_CUBE_MAP,u.__webglTexture),j(e.TEXTURE_CUBE_MAP,l,p);for(let r=0;r<6;r++)O(c.__webglFramebuffer[r],t,l,e.COLOR_ATTACHMENT0,e.TEXTURE_CUBE_MAP_POSITIVE_X+r);x(l,p)&&b(e.TEXTURE_CUBE_MAP),r.unbindTexture()}else if(d){const i=t.texture;for(let s=0,o=i.length;s<o;s++){const o=i[s],a=n.get(o);r.bindTexture(e.TEXTURE_2D,a.__webglTexture),j(e.TEXTURE_2D,o,p),O(c.__webglFramebuffer,t,o,e.COLOR_ATTACHMENT0+s,e.TEXTURE_2D),x(o,p)&&b(e.TEXTURE_2D)}r.unbindTexture()}else{let n=e.TEXTURE_2D;(t.isWebGL3DRenderTarget||t.isWebGLArrayRenderTarget)&&a&&(n=t.isWebGL3DRenderTarget?e.TEXTURE_3D:e.TEXTURE_2D_ARRAY),r.bindTexture(n,u.__webglTexture),j(n,l,p),O(c.__webglFramebuffer,t,l,e.COLOR_ATTACHMENT0,n),x(l,p)&&b(n),r.unbindTexture()}t.depthBuffer&&U(t)},this.updateRenderTargetMipmap=function(t){const i=_(t)||a,s=!0===t.isWebGLMultipleRenderTargets?t.texture:[t.texture];for(let o=0,a=s.length;o<a;o++){const a=s[o];if(x(a,i)){const i=t.isWebGLCubeRenderTarget?e.TEXTURE_CUBE_MAP:e.TEXTURE_2D,s=n.get(a).__webglTexture;r.bindTexture(i,s),b(i),r.unbindTexture()}}},this.updateMultisampleRenderTarget=function(t){if(a&&t.samples>0&&!1===F(t)){const i=t.isWebGLMultipleRenderTargets?t.texture:[t.texture],s=t.width,o=t.height;let a=e.COLOR_BUFFER_BIT;const l=[],c=t.stencilBuffer?e.DEPTH_STENCIL_ATTACHMENT:e.DEPTH_ATTACHMENT,u=n.get(t),h=!0===t.isWebGLMultipleRenderTargets;if(h)for(let t=0;t<i.length;t++)r.bindFramebuffer(e.FRAMEBUFFER,u.__webglMultisampledFramebuffer),e.framebufferRenderbuffer(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0+t,e.RENDERBUFFER,null),r.bindFramebuffer(e.FRAMEBUFFER,u.__webglFramebuffer),e.framebufferTexture2D(e.DRAW_FRAMEBUFFER,e.COLOR_ATTACHMENT0+t,e.TEXTURE_2D,null,0);r.bindFramebuffer(e.READ_FRAMEBUFFER,u.__webglMultisampledFramebuffer),r.bindFramebuffer(e.DRAW_FRAMEBUFFER,u.__webglFramebuffer);for(let r=0;r<i.length;r++){l.push(e.COLOR_ATTACHMENT0+r),t.depthBuffer&&l.push(c);const p=void 0!==u.__ignoreDepthValues&&u.__ignoreDepthValues;if(!1===p&&(t.depthBuffer&&(a|=e.DEPTH_BUFFER_BIT),t.stencilBuffer&&(a|=e.STENCIL_BUFFER_BIT)),h&&e.framebufferRenderbuffer(e.READ_FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.RENDERBUFFER,u.__webglColorRenderbuffer[r]),!0===p&&(e.invalidateFramebuffer(e.READ_FRAMEBUFFER,[c]),e.invalidateFramebuffer(e.DRAW_FRAMEBUFFER,[c])),h){const t=n.get(i[r]).__webglTexture;e.framebufferTexture2D(e.DRAW_FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,t,0)}e.blitFramebuffer(0,0,s,o,0,0,s,o,a,e.NEAREST),d&&e.invalidateFramebuffer(e.READ_FRAMEBUFFER,l)}if(r.bindFramebuffer(e.READ_FRAMEBUFFER,null),r.bindFramebuffer(e.DRAW_FRAMEBUFFER,null),h)for(let t=0;t<i.length;t++){r.bindFramebuffer(e.FRAMEBUFFER,u.__webglMultisampledFramebuffer),e.framebufferRenderbuffer(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0+t,e.RENDERBUFFER,u.__webglColorRenderbuffer[t]);const s=n.get(i[t]).__webglTexture;r.bindFramebuffer(e.FRAMEBUFFER,u.__webglFramebuffer),e.framebufferTexture2D(e.DRAW_FRAMEBUFFER,e.COLOR_ATTACHMENT0+t,e.TEXTURE_2D,s,0)}r.bindFramebuffer(e.DRAW_FRAMEBUFFER,u.__webglMultisampledFramebuffer)}},this.setupDepthRenderbuffer=U,this.setupFrameBufferTexture=O,this.useMultisampledRTT=F}function la(e,t,r){const n=r.isWebGL2;return{convert:function(r,i=null){let s;if(r===de)return e.UNSIGNED_BYTE;if(r===xe)return e.UNSIGNED_SHORT_4_4_4_4;if(r===be)return e.UNSIGNED_SHORT_5_5_5_1;if(r===pe)return e.BYTE;if(r===fe)return e.SHORT;if(r===me)return e.UNSIGNED_SHORT;if(r===ge)return e.INT;if(r===ye)return e.UNSIGNED_INT;if(r===ve)return e.FLOAT;if(r===_e)return n?e.HALF_FLOAT:(s=t.get("OES_texture_half_float"),null!==s?s.HALF_FLOAT_OES:null);if(r===Se)return e.ALPHA;if(r===Me)return e.RGBA;if(r===Te)return e.LUMINANCE;if(r===Ee)return e.LUMINANCE_ALPHA;if(r===Ae)return e.DEPTH_COMPONENT;if(r===Ce)return e.DEPTH_STENCIL;if(r===Lt)return s=t.get("EXT_sRGB"),null!==s?s.SRGB_ALPHA_EXT:null;if(r===Le)return e.RED;if(r===Re)return e.RED_INTEGER;if(r===Pe)return e.RG;if(r===je)return e.RG_INTEGER;if(r===Ie)return e.RGBA_INTEGER;if(r===De||r===Oe||r===Ne||r===Ue)if(i===_t){if(s=t.get("WEBGL_compressed_texture_s3tc_srgb"),null===s)return null;if(r===De)return s.COMPRESSED_SRGB_S3TC_DXT1_EXT;if(r===Oe)return s.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT;if(r===Ne)return s.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT;if(r===Ue)return s.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT}else{if(s=t.get("WEBGL_compressed_texture_s3tc"),null===s)return null;if(r===De)return s.COMPRESSED_RGB_S3TC_DXT1_EXT;if(r===Oe)return s.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(r===Ne)return s.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(r===Ue)return s.COMPRESSED_RGBA_S3TC_DXT5_EXT}if(r===ke||r===Fe||r===Be||r===ze){if(s=t.get("WEBGL_compressed_texture_pvrtc"),null===s)return null;if(r===ke)return s.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(r===Fe)return s.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(r===Be)return s.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(r===ze)return s.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}if(r===Ge)return s=t.get("WEBGL_compressed_texture_etc1"),null!==s?s.COMPRESSED_RGB_ETC1_WEBGL:null;if(r===Ve||r===He){if(s=t.get("WEBGL_compressed_texture_etc"),null===s)return null;if(r===Ve)return i===_t?s.COMPRESSED_SRGB8_ETC2:s.COMPRESSED_RGB8_ETC2;if(r===He)return i===_t?s.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC:s.COMPRESSED_RGBA8_ETC2_EAC}if(r===We||r===Xe||r===qe||r===Ye||r===Ze||r===Je||r===Ke||r===Qe||r===$e||r===et||r===tt||r===rt||r===nt||r===it){if(s=t.get("WEBGL_compressed_texture_astc"),null===s)return null;if(r===We)return i===_t?s.COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR:s.COMPRESSED_RGBA_ASTC_4x4_KHR;if(r===Xe)return i===_t?s.COMPRESSED_SRGB8_ALPHA8_ASTC_5x4_KHR:s.COMPRESSED_RGBA_ASTC_5x4_KHR;if(r===qe)return i===_t?s.COMPRESSED_SRGB8_ALPHA8_ASTC_5x5_KHR:s.COMPRESSED_RGBA_ASTC_5x5_KHR;if(r===Ye)return i===_t?s.COMPRESSED_SRGB8_ALPHA8_ASTC_6x5_KHR:s.COMPRESSED_RGBA_ASTC_6x5_KHR;if(r===Ze)return i===_t?s.COMPRESSED_SRGB8_ALPHA8_ASTC_6x6_KHR:s.COMPRESSED_RGBA_ASTC_6x6_KHR;if(r===Je)return i===_t?s.COMPRESSED_SRGB8_ALPHA8_ASTC_8x5_KHR:s.COMPRESSED_RGBA_ASTC_8x5_KHR;if(r===Ke)return i===_t?s.COMPRESSED_SRGB8_ALPHA8_ASTC_8x6_KHR:s.COMPRESSED_RGBA_ASTC_8x6_KHR;if(r===Qe)return i===_t?s.COMPRESSED_SRGB8_ALPHA8_ASTC_8x8_KHR:s.COMPRESSED_RGBA_ASTC_8x8_KHR;if(r===$e)return i===_t?s.COMPRESSED_SRGB8_ALPHA8_ASTC_10x5_KHR:s.COMPRESSED_RGBA_ASTC_10x5_KHR;if(r===et)return i===_t?s.COMPRESSED_SRGB8_ALPHA8_ASTC_10x6_KHR:s.COMPRESSED_RGBA_ASTC_10x6_KHR;if(r===tt)return i===_t?s.COMPRESSED_SRGB8_ALPHA8_ASTC_10x8_KHR:s.COMPRESSED_RGBA_ASTC_10x8_KHR;if(r===rt)return i===_t?s.COMPRESSED_SRGB8_ALPHA8_ASTC_10x10_KHR:s.COMPRESSED_RGBA_ASTC_10x10_KHR;if(r===nt)return i===_t?s.COMPRESSED_SRGB8_ALPHA8_ASTC_12x10_KHR:s.COMPRESSED_RGBA_ASTC_12x10_KHR;if(r===it)return i===_t?s.COMPRESSED_SRGB8_ALPHA8_ASTC_12x12_KHR:s.COMPRESSED_RGBA_ASTC_12x12_KHR}if(r===st){if(s=t.get("EXT_texture_compression_bptc"),null===s)return null;if(r===st)return i===_t?s.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT:s.COMPRESSED_RGBA_BPTC_UNORM_EXT}if(r===ot||r===at||r===lt||r===ct){if(s=t.get("EXT_texture_compression_rgtc"),null===s)return null;if(r===st)return s.COMPRESSED_RED_RGTC1_EXT;if(r===at)return s.COMPRESSED_SIGNED_RED_RGTC1_EXT;if(r===lt)return s.COMPRESSED_RED_GREEN_RGTC2_EXT;if(r===ct)return s.COMPRESSED_SIGNED_RED_GREEN_RGTC2_EXT}return r===we?n?e.UNSIGNED_INT_24_8:(s=t.get("WEBGL_depth_texture"),null!==s?s.UNSIGNED_INT_24_8_WEBGL:null):void 0!==e[r]?e[r]:null}}}class ca extends Si{constructor(e=[]){super(),this.isArrayCamera=!0,this.cameras=e}}class ua extends _n{constructor(){super(),this.isGroup=!0,this.type="Group"}}const ha={type:"move"};class da{constructor(){this._targetRay=null,this._grip=null,this._hand=null}getHandSpace(){return null===this._hand&&(this._hand=new ua,this._hand.matrixAutoUpdate=!1,this._hand.visible=!1,this._hand.joints={},this._hand.inputState={pinching:!1}),this._hand}getTargetRaySpace(){return null===this._targetRay&&(this._targetRay=new ua,this._targetRay.matrixAutoUpdate=!1,this._targetRay.visible=!1,this._targetRay.hasLinearVelocity=!1,this._targetRay.linearVelocity=new $t,this._targetRay.hasAngularVelocity=!1,this._targetRay.angularVelocity=new $t),this._targetRay}getGripSpace(){return null===this._grip&&(this._grip=new ua,this._grip.matrixAutoUpdate=!1,this._grip.visible=!1,this._grip.hasLinearVelocity=!1,this._grip.linearVelocity=new $t,this._grip.hasAngularVelocity=!1,this._grip.angularVelocity=new $t),this._grip}dispatchEvent(e){return null!==this._targetRay&&this._targetRay.dispatchEvent(e),null!==this._grip&&this._grip.dispatchEvent(e),null!==this._hand&&this._hand.dispatchEvent(e),this}connect(e){if(e&&e.hand){const t=this._hand;if(t)for(const r of e.hand.values())this._getHandJoint(t,r)}return this.dispatchEvent({type:"connected",data:e}),this}disconnect(e){return this.dispatchEvent({type:"disconnected",data:e}),null!==this._targetRay&&(this._targetRay.visible=!1),null!==this._grip&&(this._grip.visible=!1),null!==this._hand&&(this._hand.visible=!1),this}update(e,t,r){let n=null,i=null,s=null;const o=this._targetRay,a=this._grip,l=this._hand;if(e&&"visible-blurred"!==t.session.visibilityState){if(l&&e.hand){s=!0;for(const n of e.hand.values()){const e=t.getJointPose(n,r),i=this._getHandJoint(l,n);null!==e&&(i.matrix.fromArray(e.transform.matrix),i.matrix.decompose(i.position,i.rotation,i.scale),i.jointRadius=e.radius),i.visible=null!==e}const n=l.joints["index-finger-tip"],i=l.joints["thumb-tip"],o=n.position.distanceTo(i.position),a=.02,c=.005;l.inputState.pinching&&o>a+c?(l.inputState.pinching=!1,this.dispatchEvent({type:"pinchend",handedness:e.handedness,target:this})):!l.inputState.pinching&&o<=a-c&&(l.inputState.pinching=!0,this.dispatchEvent({type:"pinchstart",handedness:e.handedness,target:this}))}else null!==a&&e.gripSpace&&(i=t.getPose(e.gripSpace,r),null!==i&&(a.matrix.fromArray(i.transform.matrix),a.matrix.decompose(a.position,a.rotation,a.scale),i.linearVelocity?(a.hasLinearVelocity=!0,a.linearVelocity.copy(i.linearVelocity)):a.hasLinearVelocity=!1,i.angularVelocity?(a.hasAngularVelocity=!0,a.angularVelocity.copy(i.angularVelocity)):a.hasAngularVelocity=!1));null!==o&&(n=t.getPose(e.targetRaySpace,r),null===n&&null!==i&&(n=i),null!==n&&(o.matrix.fromArray(n.transform.matrix),o.matrix.decompose(o.position,o.rotation,o.scale),n.linearVelocity?(o.hasLinearVelocity=!0,o.linearVelocity.copy(n.linearVelocity)):o.hasLinearVelocity=!1,n.angularVelocity?(o.hasAngularVelocity=!0,o.angularVelocity.copy(n.angularVelocity)):o.hasAngularVelocity=!1,this.dispatchEvent(ha)))}return null!==o&&(o.visible=null!==n),null!==a&&(a.visible=null!==i),null!==l&&(l.visible=null!==s),this}_getHandJoint(e,t){if(void 0===e.joints[t.jointName]){const r=new ua;r.matrixAutoUpdate=!1,r.visible=!1,e.joints[t.jointName]=r,e.add(r)}return e.joints[t.jointName]}}class pa extends mr{constructor(e,t,r,n,i,s,o,a,l,c){if((c=void 0!==c?c:Ae)!==Ae&&c!==Ce)throw new Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");void 0===r&&c===Ae&&(r=ye),void 0===r&&c===Ce&&(r=we),super(null,n,i,s,o,a,c,r,l),this.isDepthTexture=!0,this.image={width:e,height:t},this.magFilter=void 0!==o?o:oe,this.minFilter=void 0!==a?a:oe,this.flipY=!1,this.generateMipmaps=!1}}class fa extends Rt{constructor(e,t){super();const r=this;let n=null,i=1,s=null,o="local-floor",a=1,l=null,c=null,u=null,h=null,d=null,p=null;const f=t.getContextAttributes();let m=null,g=null;const y=[],v=[],_=new Set,x=new Map,b=new Si;b.layers.enable(1),b.viewport=new gr;const w=new Si;w.layers.enable(2),w.viewport=new gr;const S=[b,w],M=new ca;M.layers.enable(1),M.layers.enable(2);let T=null,E=null;function A(e){const t=v.indexOf(e.inputSource);if(-1===t)return;const r=y[t];void 0!==r&&r.dispatchEvent({type:e.type,data:e.inputSource})}function C(){n.removeEventListener("select",A),n.removeEventListener("selectstart",A),n.removeEventListener("selectend",A),n.removeEventListener("squeeze",A),n.removeEventListener("squeezestart",A),n.removeEventListener("squeezeend",A),n.removeEventListener("end",C),n.removeEventListener("inputsourceschange",L);for(let e=0;e<y.length;e++){const t=v[e];null!==t&&(v[e]=null,y[e].disconnect(t))}T=null,E=null,e.setRenderTarget(m),d=null,h=null,u=null,n=null,g=null,D.stop(),r.isPresenting=!1,r.dispatchEvent({type:"sessionend"})}function L(e){for(let t=0;t<e.removed.length;t++){const r=e.removed[t],n=v.indexOf(r);n>=0&&(v[n]=null,y[n].disconnect(r))}for(let t=0;t<e.added.length;t++){const r=e.added[t];let n=v.indexOf(r);if(-1===n){for(let e=0;e<y.length;e++){if(e>=v.length){v.push(r),n=e;break}if(null===v[e]){v[e]=r,n=e;break}}if(-1===n)break}const i=y[n];i&&i.connect(r)}}this.cameraAutoUpdate=!0,this.enabled=!1,this.isPresenting=!1,this.getController=function(e){let t=y[e];return void 0===t&&(t=new da,y[e]=t),t.getTargetRaySpace()},this.getControllerGrip=function(e){let t=y[e];return void 0===t&&(t=new da,y[e]=t),t.getGripSpace()},this.getHand=function(e){let t=y[e];return void 0===t&&(t=new da,y[e]=t),t.getHandSpace()},this.setFramebufferScaleFactor=function(e){i=e,r.isPresenting},this.setReferenceSpaceType=function(e){o=e,r.isPresenting},this.getReferenceSpace=function(){return l||s},this.setReferenceSpace=function(e){l=e},this.getBaseLayer=function(){return null!==h?h:d},this.getBinding=function(){return u},this.getFrame=function(){return p},this.getSession=function(){return n},this.setSession=async function(c){if(n=c,null!==n){if(m=e.getRenderTarget(),n.addEventListener("select",A),n.addEventListener("selectstart",A),n.addEventListener("selectend",A),n.addEventListener("squeeze",A),n.addEventListener("squeezestart",A),n.addEventListener("squeezeend",A),n.addEventListener("end",C),n.addEventListener("inputsourceschange",L),!0!==f.xrCompatible&&await t.makeXRCompatible(),void 0===n.renderState.layers||!1===e.capabilities.isWebGL2){const r={antialias:void 0!==n.renderState.layers||f.antialias,alpha:f.alpha,depth:f.depth,stencil:f.stencil,framebufferScaleFactor:i};d=new XRWebGLLayer(n,t,r),n.updateRenderState({baseLayer:d}),g=new yr(d.framebufferWidth,d.framebufferHeight,{format:Me,type:de,encoding:e.outputEncoding,stencilBuffer:f.stencil})}else{let r=null,s=null,o=null;f.depth&&(o=f.stencil?t.DEPTH24_STENCIL8:t.DEPTH_COMPONENT24,r=f.stencil?Ce:Ae,s=f.stencil?we:ye);const a={colorFormat:t.RGBA8,depthFormat:o,scaleFactor:i};u=new XRWebGLBinding(n,t),h=u.createProjectionLayer(a),n.updateRenderState({layers:[h]}),g=new yr(h.textureWidth,h.textureHeight,{format:Me,type:de,depthTexture:new pa(h.textureWidth,h.textureHeight,s,void 0,void 0,void 0,void 0,void 0,void 0,r),stencilBuffer:f.stencil,encoding:e.outputEncoding,samples:f.antialias?4:0});e.properties.get(g).__ignoreDepthValues=h.ignoreDepthValues}g.isXRRenderTarget=!0,this.setFoveation(a),l=null,s=await n.requestReferenceSpace(o),D.setContext(n),D.start(),r.isPresenting=!0,r.dispatchEvent({type:"sessionstart"})}};const R=new $t,P=new $t;function j(e,t){null===t?e.matrixWorld.copy(e.matrix):e.matrixWorld.multiplyMatrices(t.matrixWorld,e.matrix),e.matrixWorldInverse.copy(e.matrixWorld).invert()}this.updateCamera=function(e){if(null===n)return;M.near=w.near=b.near=e.near,M.far=w.far=b.far=e.far,T===M.near&&E===M.far||(n.updateRenderState({depthNear:M.near,depthFar:M.far}),T=M.near,E=M.far);const t=e.parent,r=M.cameras;j(M,t);for(let e=0;e<r.length;e++)j(r[e],t);M.matrixWorld.decompose(M.position,M.quaternion,M.scale),e.matrix.copy(M.matrix),e.matrix.decompose(e.position,e.quaternion,e.scale);const i=e.children;for(let e=0,t=i.length;e<t;e++)i[e].updateMatrixWorld(!0);2===r.length?function(e,t,r){R.setFromMatrixPosition(t.matrixWorld),P.setFromMatrixPosition(r.matrixWorld);const n=R.distanceTo(P),i=t.projectionMatrix.elements,s=r.projectionMatrix.elements,o=i[14]/(i[10]-1),a=i[14]/(i[10]+1),l=(i[9]+1)/i[5],c=(i[9]-1)/i[5],u=(i[8]-1)/i[0],h=(s[8]+1)/s[0],d=o*u,p=o*h,f=n/(-u+h),m=f*-u;t.matrixWorld.decompose(e.position,e.quaternion,e.scale),e.translateX(m),e.translateZ(f),e.matrixWorld.compose(e.position,e.quaternion,e.scale),e.matrixWorldInverse.copy(e.matrixWorld).invert();const g=o+f,y=a+f,v=d-m,_=p+(n-m),x=l*a/y*g,b=c*a/y*g;e.projectionMatrix.makePerspective(v,_,x,b,g,y)}(M,b,w):M.projectionMatrix.copy(b.projectionMatrix)},this.getCamera=function(){return M},this.getFoveation=function(){if(null!==h||null!==d)return a},this.setFoveation=function(e){a=e,null!==h&&(h.fixedFoveation=e),null!==d&&void 0!==d.fixedFoveation&&(d.fixedFoveation=e)},this.getPlanes=function(){return _};let I=null;const D=new Oi;D.setAnimationLoop((function(t,n){if(c=n.getViewerPose(l||s),p=n,null!==c){const t=c.views;null!==d&&(e.setRenderTargetFramebuffer(g,d.framebuffer),e.setRenderTarget(g));let r=!1;t.length!==M.cameras.length&&(M.cameras.length=0,r=!0);for(let n=0;n<t.length;n++){const i=t[n];let s=null;if(null!==d)s=d.getViewport(i);else{const t=u.getViewSubImage(h,i);s=t.viewport,0===n&&(e.setRenderTargetTextures(g,t.colorTexture,h.ignoreDepthValues?void 0:t.depthStencilTexture),e.setRenderTarget(g))}let o=S[n];void 0===o&&(o=new Si,o.layers.enable(n),o.viewport=new gr,S[n]=o),o.matrix.fromArray(i.transform.matrix),o.projectionMatrix.fromArray(i.projectionMatrix),o.viewport.set(s.x,s.y,s.width,s.height),0===n&&M.matrix.copy(o.matrix),!0===r&&M.cameras.push(o)}}for(let e=0;e<y.length;e++){const t=v[e],r=y[e];null!==t&&void 0!==r&&r.update(t,n,l||s)}if(I&&I(t,n),n.detectedPlanes){r.dispatchEvent({type:"planesdetected",data:n.detectedPlanes});let e=null;for(const t of _)n.detectedPlanes.has(t)||(null===e&&(e=[]),e.push(t));if(null!==e)for(const t of e)_.delete(t),x.delete(t),r.dispatchEvent({type:"planeremoved",data:t});for(const e of n.detectedPlanes)if(_.has(e)){const t=x.get(e);e.lastChangedTime>t&&(x.set(e,e.lastChangedTime),r.dispatchEvent({type:"planechanged",data:e}))}else _.add(e),x.set(e,n.lastChangedTime),r.dispatchEvent({type:"planeadded",data:e})}p=null})),this.setAnimationLoop=function(e){I=e},this.dispose=function(){}}}function ma(e,t){function r(r,n){r.opacity.value=n.opacity,n.color&&r.diffuse.value.copy(n.color),n.emissive&&r.emissive.value.copy(n.emissive).multiplyScalar(n.emissiveIntensity),n.map&&(r.map.value=n.map),n.alphaMap&&(r.alphaMap.value=n.alphaMap),n.bumpMap&&(r.bumpMap.value=n.bumpMap,r.bumpScale.value=n.bumpScale,n.side===u&&(r.bumpScale.value*=-1)),n.displacementMap&&(r.displacementMap.value=n.displacementMap,r.displacementScale.value=n.displacementScale,r.displacementBias.value=n.displacementBias),n.emissiveMap&&(r.emissiveMap.value=n.emissiveMap),n.normalMap&&(r.normalMap.value=n.normalMap,r.normalScale.value.copy(n.normalScale),n.side===u&&r.normalScale.value.negate()),n.specularMap&&(r.specularMap.value=n.specularMap),n.alphaTest>0&&(r.alphaTest.value=n.alphaTest);const i=t.get(n).envMap;if(i&&(r.envMap.value=i,r.flipEnvMap.value=i.isCubeTexture&&!1===i.isRenderTargetTexture?-1:1,r.reflectivity.value=n.reflectivity,r.ior.value=n.ior,r.refractionRatio.value=n.refractionRatio),n.lightMap){r.lightMap.value=n.lightMap;const t=!0===e.useLegacyLights?Math.PI:1;r.lightMapIntensity.value=n.lightMapIntensity*t}let s,o;n.aoMap&&(r.aoMap.value=n.aoMap,r.aoMapIntensity.value=n.aoMapIntensity),n.map?s=n.map:n.specularMap?s=n.specularMap:n.displacementMap?s=n.displacementMap:n.normalMap?s=n.normalMap:n.bumpMap?s=n.bumpMap:n.roughnessMap?s=n.roughnessMap:n.metalnessMap?s=n.metalnessMap:n.alphaMap?s=n.alphaMap:n.emissiveMap?s=n.emissiveMap:n.clearcoatMap?s=n.clearcoatMap:n.clearcoatNormalMap?s=n.clearcoatNormalMap:n.clearcoatRoughnessMap?s=n.clearcoatRoughnessMap:n.iridescenceMap?s=n.iridescenceMap:n.iridescenceThicknessMap?s=n.iridescenceThicknessMap:n.specularIntensityMap?s=n.specularIntensityMap:n.specularColorMap?s=n.specularColorMap:n.transmissionMap?s=n.transmissionMap:n.thicknessMap?s=n.thicknessMap:n.sheenColorMap?s=n.sheenColorMap:n.sheenRoughnessMap&&(s=n.sheenRoughnessMap),void 0!==s&&(s.isWebGLRenderTarget&&(s=s.texture),!0===s.matrixAutoUpdate&&s.updateMatrix(),r.uvTransform.value.copy(s.matrix)),n.aoMap?o=n.aoMap:n.lightMap&&(o=n.lightMap),void 0!==o&&(o.isWebGLRenderTarget&&(o=o.texture),!0===o.matrixAutoUpdate&&o.updateMatrix(),r.uv2Transform.value.copy(o.matrix))}return{refreshFogUniforms:function(t,r){r.color.getRGB(t.fogColor.value,_i(e)),r.isFog?(t.fogNear.value=r.near,t.fogFar.value=r.far):r.isFogExp2&&(t.fogDensity.value=r.density)},refreshMaterialUniforms:function(e,n,i,s,o){n.isMeshBasicMaterial||n.isMeshLambertMaterial?r(e,n):n.isMeshToonMaterial?(r(e,n),function(e,t){t.gradientMap&&(e.gradientMap.value=t.gradientMap)}(e,n)):n.isMeshPhongMaterial?(r(e,n),function(e,t){e.specular.value.copy(t.specular),e.shininess.value=Math.max(t.shininess,1e-4)}(e,n)):n.isMeshStandardMaterial?(r(e,n),function(e,r){e.roughness.value=r.roughness,e.metalness.value=r.metalness,r.roughnessMap&&(e.roughnessMap.value=r.roughnessMap);r.metalnessMap&&(e.metalnessMap.value=r.metalnessMap);const n=t.get(r).envMap;n&&(e.envMapIntensity.value=r.envMapIntensity)}(e,n),n.isMeshPhysicalMaterial&&function(e,t,r){e.ior.value=t.ior,t.sheen>0&&(e.sheenColor.value.copy(t.sheenColor).multiplyScalar(t.sheen),e.sheenRoughness.value=t.sheenRoughness,t.sheenColorMap&&(e.sheenColorMap.value=t.sheenColorMap),t.sheenRoughnessMap&&(e.sheenRoughnessMap.value=t.sheenRoughnessMap));t.clearcoat>0&&(e.clearcoat.value=t.clearcoat,e.clearcoatRoughness.value=t.clearcoatRoughness,t.clearcoatMap&&(e.clearcoatMap.value=t.clearcoatMap),t.clearcoatRoughnessMap&&(e.clearcoatRoughnessMap.value=t.clearcoatRoughnessMap),t.clearcoatNormalMap&&(e.clearcoatNormalScale.value.copy(t.clearcoatNormalScale),e.clearcoatNormalMap.value=t.clearcoatNormalMap,t.side===u&&e.clearcoatNormalScale.value.negate()));t.iridescence>0&&(e.iridescence.value=t.iridescence,e.iridescenceIOR.value=t.iridescenceIOR,e.iridescenceThicknessMinimum.value=t.iridescenceThicknessRange[0],e.iridescenceThicknessMaximum.value=t.iridescenceThicknessRange[1],t.iridescenceMap&&(e.iridescenceMap.value=t.iridescenceMap),t.iridescenceThicknessMap&&(e.iridescenceThicknessMap.value=t.iridescenceThicknessMap));t.transmission>0&&(e.transmission.value=t.transmission,e.transmissionSamplerMap.value=r.texture,e.transmissionSamplerSize.value.set(r.width,r.height),t.transmissionMap&&(e.transmissionMap.value=t.transmissionMap),e.thickness.value=t.thickness,t.thicknessMap&&(e.thicknessMap.value=t.thicknessMap),e.attenuationDistance.value=t.attenuationDistance,e.attenuationColor.value.copy(t.attenuationColor));e.specularIntensity.value=t.specularIntensity,e.specularColor.value.copy(t.specularColor),t.specularIntensityMap&&(e.specularIntensityMap.value=t.specularIntensityMap);t.specularColorMap&&(e.specularColorMap.value=t.specularColorMap)}(e,n,o)):n.isMeshMatcapMaterial?(r(e,n),function(e,t){t.matcap&&(e.matcap.value=t.matcap)}(e,n)):n.isMeshDepthMaterial?r(e,n):n.isMeshDistanceMaterial?(r(e,n),function(e,t){e.referencePosition.value.copy(t.referencePosition),e.nearDistance.value=t.nearDistance,e.farDistance.value=t.farDistance}(e,n)):n.isMeshNormalMaterial?r(e,n):n.isLineBasicMaterial?(function(e,t){e.diffuse.value.copy(t.color),e.opacity.value=t.opacity}(e,n),n.isLineDashedMaterial&&function(e,t){e.dashSize.value=t.dashSize,e.totalSize.value=t.dashSize+t.gapSize,e.scale.value=t.scale}(e,n)):n.isPointsMaterial?function(e,t,r,n){e.diffuse.value.copy(t.color),e.opacity.value=t.opacity,e.size.value=t.size*r,e.scale.value=.5*n,t.map&&(e.map.value=t.map);t.alphaMap&&(e.alphaMap.value=t.alphaMap);t.alphaTest>0&&(e.alphaTest.value=t.alphaTest);let i;t.map?i=t.map:t.alphaMap&&(i=t.alphaMap);void 0!==i&&(!0===i.matrixAutoUpdate&&i.updateMatrix(),e.uvTransform.value.copy(i.matrix))}(e,n,i,s):n.isSpriteMaterial?function(e,t){e.diffuse.value.copy(t.color),e.opacity.value=t.opacity,e.rotation.value=t.rotation,t.map&&(e.map.value=t.map);t.alphaMap&&(e.alphaMap.value=t.alphaMap);t.alphaTest>0&&(e.alphaTest.value=t.alphaTest);let r;t.map?r=t.map:t.alphaMap&&(r=t.alphaMap);void 0!==r&&(!0===r.matrixAutoUpdate&&r.updateMatrix(),e.uvTransform.value.copy(r.matrix))}(e,n):n.isShadowMaterial?(e.color.value.copy(n.color),e.opacity.value=n.opacity):n.isShaderMaterial&&(n.uniformsNeedUpdate=!1)}}}function ga(e,t,r,n){let i={},s={},o=[];const a=r.isWebGL2?e.getParameter(e.MAX_UNIFORM_BUFFER_BINDINGS):0;function l(e,t,r){const n=e.value;if(void 0===r[t]){if("number"==typeof n)r[t]=n;else{const e=Array.isArray(n)?n:[n],i=[];for(let t=0;t<e.length;t++)i.push(e[t].clone());r[t]=i}return!0}if("number"==typeof n){if(r[t]!==n)return r[t]=n,!0}else{const e=Array.isArray(r[t])?r[t]:[r[t]],i=Array.isArray(n)?n:[n];for(let t=0;t<e.length;t++){const r=e[t];if(!1===r.equals(i[t]))return r.copy(i[t]),!0}}return!1}function c(e){const t={boundary:0,storage:0};return"number"==typeof e?(t.boundary=4,t.storage=4):e.isVector2?(t.boundary=8,t.storage=8):e.isVector3||e.isColor?(t.boundary=16,t.storage=12):e.isVector4?(t.boundary=16,t.storage=16):e.isMatrix3?(t.boundary=48,t.storage=48):e.isMatrix4?(t.boundary=64,t.storage=64):e.isTexture,t}function u(t){const r=t.target;r.removeEventListener("dispose",u);const n=o.indexOf(r.__bindingPointIndex);o.splice(n,1),e.deleteBuffer(i[r.id]),delete i[r.id],delete s[r.id]}return{bind:function(e,t){const r=t.program;n.uniformBlockBinding(e,r)},update:function(r,h){let d=i[r.id];void 0===d&&(!function(e){const t=e.uniforms;let r=0;const n=16;let i=0;for(let e=0,s=t.length;e<s;e++){const s=t[e],o={boundary:0,storage:0},a=Array.isArray(s.value)?s.value:[s.value];for(let e=0,t=a.length;e<t;e++){const t=c(a[e]);o.boundary+=t.boundary,o.storage+=t.storage}if(s.__data=new Float32Array(o.storage/Float32Array.BYTES_PER_ELEMENT),s.__offset=r,e>0){i=r%n;0!==i&&n-i-o.boundary<0&&(r+=n-i,s.__offset=r)}r+=o.storage}i=r%n,i>0&&(r+=n-i);e.__size=r,e.__cache={}}(r),d=function(t){const r=function(){for(let e=0;e<a;e++)if(-1===o.indexOf(e))return o.push(e),e;return 0}();t.__bindingPointIndex=r;const n=e.createBuffer(),i=t.__size,s=t.usage;return e.bindBuffer(e.UNIFORM_BUFFER,n),e.bufferData(e.UNIFORM_BUFFER,i,s),e.bindBuffer(e.UNIFORM_BUFFER,null),e.bindBufferBase(e.UNIFORM_BUFFER,r,n),n}(r),i[r.id]=d,r.addEventListener("dispose",u));const p=h.program;n.updateUBOMapping(r,p);const f=t.render.frame;s[r.id]!==f&&(!function(t){const r=i[t.id],n=t.uniforms,s=t.__cache;e.bindBuffer(e.UNIFORM_BUFFER,r);for(let t=0,r=n.length;t<r;t++){const r=n[t];if(!0===l(r,t,s)){const t=r.__offset,n=Array.isArray(r.value)?r.value:[r.value];let i=0;for(let s=0;s<n.length;s++){const o=n[s],a=c(o);"number"==typeof o?(r.__data[0]=o,e.bufferSubData(e.UNIFORM_BUFFER,t+i,r.__data)):o.isMatrix3?(r.__data[0]=o.elements[0],r.__data[1]=o.elements[1],r.__data[2]=o.elements[2],r.__data[3]=o.elements[0],r.__data[4]=o.elements[3],r.__data[5]=o.elements[4],r.__data[6]=o.elements[5],r.__data[7]=o.elements[0],r.__data[8]=o.elements[6],r.__data[9]=o.elements[7],r.__data[10]=o.elements[8],r.__data[11]=o.elements[0]):(o.toArray(r.__data,i),i+=a.storage/Float32Array.BYTES_PER_ELEMENT)}e.bufferSubData(e.UNIFORM_BUFFER,t,r.__data)}}e.bindBuffer(e.UNIFORM_BUFFER,null)}(r),s[r.id]=f)},dispose:function(){for(const t in i)e.deleteBuffer(i[t]);o=[],i={},s={}}}}function ya(e={}){this.isWebGLRenderer=!0;const t=void 0!==e.canvas?e.canvas:function(){const e=Kt("canvas");return e.style.display="block",e}(),n=void 0!==e.context?e.context:null,i=void 0===e.depth||e.depth,s=void 0===e.stencil||e.stencil,o=void 0!==e.antialias&&e.antialias,a=void 0===e.premultipliedAlpha||e.premultipliedAlpha,l=void 0!==e.preserveDrawingBuffer&&e.preserveDrawingBuffer,d=void 0!==e.powerPreference?e.powerPreference:"default",p=void 0!==e.failIfMajorPerformanceCaveat&&e.failIfMajorPerformanceCaveat;let f;f=null!==n?n.getContextAttributes().alpha:void 0!==e.alpha&&e.alpha;let m=null,g=null;const y=[],v=[];this.domElement=t,this.debug={checkShaderErrors:!0},this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.sortObjects=!0,this.clippingPlanes=[],this.localClippingEnabled=!1,this.outputEncoding=vt,this.useLegacyLights=!0,this.toneMapping=W,this.toneMappingExposure=1;const _=this;let x=!1,b=0,w=0,S=null,M=-1,T=null;const E=new gr,A=new gr;let C=null,L=t.width,R=t.height,P=1,j=null,I=null;const D=new gr(0,0,L,R),O=new gr(0,0,L,R);let N=!1;const U=new Di;let k=!1,F=!1,B=null;const z=new qr,G=new $t,V={background:null,fog:null,environment:null,overrideMaterial:null,isScene:!0};function H(){return null===S?P:1}let X,q,Y,Z,J,K,Q,$,ee,te,re,ne,ie,se,oe,ae,le,ce,ue,pe,fe,me,ge,ye,xe=n;function be(e,r){for(let n=0;n<e.length;n++){const i=e[n],s=t.getContext(i,r);if(null!==s)return s}return null}try{const e={alpha:!0,depth:i,stencil:s,antialias:o,premultipliedAlpha:a,preserveDrawingBuffer:l,powerPreference:d,failIfMajorPerformanceCaveat:p};if("setAttribute"in t&&t.setAttribute("data-engine",`three.js r${r}`),t.addEventListener("webglcontextlost",Te,!1),t.addEventListener("webglcontextrestored",Ee,!1),t.addEventListener("webglcontextcreationerror",Ae,!1),null===xe){const t=["webgl2","webgl","experimental-webgl"];if(!0===_.isWebGL1Renderer&&t.shift(),xe=be(t,e),null===xe)throw be(t)?new Error("Error creating WebGL context with your selected attributes."):new Error("Error creating WebGL context.")}void 0===xe.getShaderPrecisionFormat&&(xe.getShaderPrecisionFormat=function(){return{rangeMin:1,rangeMax:1,precision:1}})}catch(e){throw e}function we(){X=new hs(xe),q=new Wi(xe,X,e),X.init(q),me=new la(xe,X,q),Y=new oa(xe,X,q),Z=new fs(xe),J=new Ho,K=new aa(xe,X,Y,J,q,me,Z),Q=new qi(_),$=new us(_),ee=new Ni(xe,q),ge=new Vi(xe,X,ee,q),te=new ds(xe,ee,Z,ge),re=new vs(xe,te,ee,Z),ue=new ys(xe,q,K),ae=new Xi(J),ne=new Vo(_,Q,$,X,q,ge,ae),ie=new ma(_,J),se=new Yo,oe=new ea(X,q),ce=new Gi(_,Q,$,Y,re,f,a),le=new sa(_,re,q),ye=new ga(xe,Z,q,Y),pe=new Hi(xe,X,Z,q),fe=new ps(xe,X,Z,q),Z.programs=ne.programs,_.capabilities=q,_.extensions=X,_.properties=J,_.renderLists=se,_.shadowMap=le,_.state=Y,_.info=Z}we();const Se=new fa(_,xe);function Te(e){e.preventDefault(),x=!0}function Ee(){x=!1;const e=Z.autoReset,t=le.enabled,r=le.autoUpdate,n=le.needsUpdate,i=le.type;we(),Z.autoReset=e,le.enabled=t,le.autoUpdate=r,le.needsUpdate=n,le.type=i}function Ae(e){}function Ce(e){const t=e.target;t.removeEventListener("dispose",Ce),function(e){(function(e){const t=J.get(e).programs;void 0!==t&&(t.forEach((function(e){ne.releaseProgram(e)})),e.isShaderMaterial&&ne.releaseShaderCache(e))})(e),J.remove(e)}(t)}this.xr=Se,this.getContext=function(){return xe},this.getContextAttributes=function(){return xe.getContextAttributes()},this.forceContextLoss=function(){const e=X.get("WEBGL_lose_context");e&&e.loseContext()},this.forceContextRestore=function(){const e=X.get("WEBGL_lose_context");e&&e.restoreContext()},this.getPixelRatio=function(){return P},this.setPixelRatio=function(e){void 0!==e&&(P=e,this.setSize(L,R,!1))},this.getSize=function(e){return e.set(L,R)},this.setSize=function(e,r,n=!0){Se.isPresenting||(L=e,R=r,t.width=Math.floor(e*P),t.height=Math.floor(r*P),!0===n&&(t.style.width=e+"px",t.style.height=r+"px"),this.setViewport(0,0,e,r))},this.getDrawingBufferSize=function(e){return e.set(L*P,R*P).floor()},this.setDrawingBufferSize=function(e,r,n){L=e,R=r,P=n,t.width=Math.floor(e*n),t.height=Math.floor(r*n),this.setViewport(0,0,e,r)},this.getCurrentViewport=function(e){return e.copy(E)},this.getViewport=function(e){return e.copy(D)},this.setViewport=function(e,t,r,n){e.isVector4?D.set(e.x,e.y,e.z,e.w):D.set(e,t,r,n),Y.viewport(E.copy(D).multiplyScalar(P).floor())},this.getScissor=function(e){return e.copy(O)},this.setScissor=function(e,t,r,n){e.isVector4?O.set(e.x,e.y,e.z,e.w):O.set(e,t,r,n),Y.scissor(A.copy(O).multiplyScalar(P).floor())},this.getScissorTest=function(){return N},this.setScissorTest=function(e){Y.setScissorTest(N=e)},this.setOpaqueSort=function(e){j=e},this.setTransparentSort=function(e){I=e},this.getClearColor=function(e){return e.copy(ce.getClearColor())},this.setClearColor=function(){ce.setClearColor.apply(ce,arguments)},this.getClearAlpha=function(){return ce.getClearAlpha()},this.setClearAlpha=function(){ce.setClearAlpha.apply(ce,arguments)},this.clear=function(e=!0,t=!0,r=!0){let n=0;e&&(n|=xe.COLOR_BUFFER_BIT),t&&(n|=xe.DEPTH_BUFFER_BIT),r&&(n|=xe.STENCIL_BUFFER_BIT),xe.clear(n)},this.clearColor=function(){this.clear(!0,!1,!1)},this.clearDepth=function(){this.clear(!1,!0,!1)},this.clearStencil=function(){this.clear(!1,!1,!0)},this.dispose=function(){t.removeEventListener("webglcontextlost",Te,!1),t.removeEventListener("webglcontextrestored",Ee,!1),t.removeEventListener("webglcontextcreationerror",Ae,!1),se.dispose(),oe.dispose(),J.dispose(),Q.dispose(),$.dispose(),re.dispose(),ge.dispose(),ye.dispose(),ne.dispose(),Se.dispose(),Se.removeEventListener("sessionstart",Re),Se.removeEventListener("sessionend",Pe),B&&(B.dispose(),B=null),je.stop()},this.renderBufferDirect=function(e,t,r,n,i,s){null===t&&(t=V);const o=i.isMesh&&i.matrixWorld.determinant()<0,a=function(e,t,r,n,i){!0!==t.isScene&&(t=V);K.resetTextureUnits();const s=t.fog,o=n.isMeshStandardMaterial?t.environment:null,a=null===S?_.outputEncoding:!0===S.isXRRenderTarget?S.texture.encoding:vt,l=(n.isMeshStandardMaterial?$:Q).get(n.envMap||o),c=!0===n.vertexColors&&!!r.attributes.color&&4===r.attributes.color.itemSize,u=!!n.normalMap&&!!r.attributes.tangent,h=!!r.morphAttributes.position,d=!!r.morphAttributes.normal,p=!!r.morphAttributes.color,f=n.toneMapped?_.toneMapping:W,m=r.morphAttributes.position||r.morphAttributes.normal||r.morphAttributes.color,y=void 0!==m?m.length:0,v=J.get(n),x=g.state.lights;if(!0===k&&(!0===F||e!==T)){const t=e===T&&n.id===M;ae.setState(n,e,t)}let b=!1;n.version===v.__version?v.needsLights&&v.lightsStateVersion!==x.state.version||v.outputEncoding!==a||i.isInstancedMesh&&!1===v.instancing?b=!0:i.isInstancedMesh||!0!==v.instancing?i.isSkinnedMesh&&!1===v.skinning?b=!0:i.isSkinnedMesh||!0!==v.skinning?v.envMap!==l||!0===n.fog&&v.fog!==s?b=!0:void 0===v.numClippingPlanes||v.numClippingPlanes===ae.numPlanes&&v.numIntersection===ae.numIntersection?(v.vertexAlphas!==c||v.vertexTangents!==u||v.morphTargets!==h||v.morphNormals!==d||v.morphColors!==p||v.toneMapping!==f||!0===q.isWebGL2&&v.morphTargetsCount!==y)&&(b=!0):b=!0:b=!0:b=!0:(b=!0,v.__version=n.version);let w=v.currentProgram;!0===b&&(w=Ue(n,t,i));let E=!1,A=!1,C=!1;const L=w.getUniforms(),j=v.uniforms;Y.useProgram(w.program)&&(E=!0,A=!0,C=!0);n.id!==M&&(M=n.id,A=!0);if(E||T!==e){if(L.setValue(xe,"projectionMatrix",e.projectionMatrix),q.logarithmicDepthBuffer&&L.setValue(xe,"logDepthBufFC",2/(Math.log(e.far+1)/Math.LN2)),T!==e&&(T=e,A=!0,C=!0),n.isShaderMaterial||n.isMeshPhongMaterial||n.isMeshToonMaterial||n.isMeshStandardMaterial||n.envMap){const t=L.map.cameraPosition;void 0!==t&&t.setValue(xe,G.setFromMatrixPosition(e.matrixWorld))}(n.isMeshPhongMaterial||n.isMeshToonMaterial||n.isMeshLambertMaterial||n.isMeshBasicMaterial||n.isMeshStandardMaterial||n.isShaderMaterial)&&L.setValue(xe,"isOrthographic",!0===e.isOrthographicCamera),(n.isMeshPhongMaterial||n.isMeshToonMaterial||n.isMeshLambertMaterial||n.isMeshBasicMaterial||n.isMeshStandardMaterial||n.isShaderMaterial||n.isShadowMaterial||i.isSkinnedMesh)&&L.setValue(xe,"viewMatrix",e.matrixWorldInverse)}if(i.isSkinnedMesh){L.setOptional(xe,i,"bindMatrix"),L.setOptional(xe,i,"bindMatrixInverse");const e=i.skeleton;e&&q.floatVertexTextures&&(null===e.boneTexture&&e.computeBoneTexture(),L.setValue(xe,"boneTexture",e.boneTexture,K),L.setValue(xe,"boneTextureSize",e.boneTextureSize))}const I=r.morphAttributes;(void 0!==I.position||void 0!==I.normal||void 0!==I.color&&!0===q.isWebGL2)&&ue.update(i,r,w);(A||v.receiveShadow!==i.receiveShadow)&&(v.receiveShadow=i.receiveShadow,L.setValue(xe,"receiveShadow",i.receiveShadow));n.isMeshGouraudMaterial&&null!==n.envMap&&(j.envMap.value=l,j.flipEnvMap.value=l.isCubeTexture&&!1===l.isRenderTargetTexture?-1:1);A&&(L.setValue(xe,"toneMappingExposure",_.toneMappingExposure),v.needsLights&&(O=C,(D=j).ambientLightColor.needsUpdate=O,D.lightProbe.needsUpdate=O,D.directionalLights.needsUpdate=O,D.directionalLightShadows.needsUpdate=O,D.pointLights.needsUpdate=O,D.pointLightShadows.needsUpdate=O,D.spotLights.needsUpdate=O,D.spotLightShadows.needsUpdate=O,D.rectAreaLights.needsUpdate=O,D.hemisphereLights.needsUpdate=O),s&&!0===n.fog&&ie.refreshFogUniforms(j,s),ie.refreshMaterialUniforms(j,n,P,R,B),So.upload(xe,v.uniformsList,j,K));var D,O;n.isShaderMaterial&&!0===n.uniformsNeedUpdate&&(So.upload(xe,v.uniformsList,j,K),n.uniformsNeedUpdate=!1);n.isSpriteMaterial&&L.setValue(xe,"center",i.center);if(L.setValue(xe,"modelViewMatrix",i.modelViewMatrix),L.setValue(xe,"normalMatrix",i.normalMatrix),L.setValue(xe,"modelMatrix",i.matrixWorld),n.isShaderMaterial||n.isRawShaderMaterial){const e=n.uniformsGroups;for(let t=0,r=e.length;t<r;t++)if(q.isWebGL2){const r=e[t];ye.update(r,w),ye.bind(r,w)}}return w}(e,t,r,n,i);Y.setMaterial(n,o);let l=r.index,c=1;!0===n.wireframe&&(l=te.getWireframeAttribute(r),c=2);const u=r.drawRange,h=r.attributes.position;let d=u.start*c,p=(u.start+u.count)*c;null!==s&&(d=Math.max(d,s.start*c),p=Math.min(p,(s.start+s.count)*c)),null!==l?(d=Math.max(d,0),p=Math.min(p,l.count)):null!=h&&(d=Math.max(d,0),p=Math.min(p,h.count));const f=p-d;if(f<0||f===1/0)return;let m;ge.setup(i,n,a,r,l);let y=pe;if(null!==l&&(m=ee.get(l),y=fe,y.setIndex(m)),i.isMesh)!0===n.wireframe?(Y.setLineWidth(n.wireframeLinewidth*H()),y.setMode(xe.LINES)):y.setMode(xe.TRIANGLES);else if(i.isLine){let e=n.linewidth;void 0===e&&(e=1),Y.setLineWidth(e*H()),i.isLineSegments?y.setMode(xe.LINES):i.isLineLoop?y.setMode(xe.LINE_LOOP):y.setMode(xe.LINE_STRIP)}else i.isPoints?y.setMode(xe.POINTS):i.isSprite&&y.setMode(xe.TRIANGLES);if(i.isInstancedMesh)y.renderInstances(d,f,i.count);else if(r.isInstancedBufferGeometry){const e=void 0!==r._maxInstanceCount?r._maxInstanceCount:1/0,t=Math.min(r.instanceCount,e);y.renderInstances(d,f,t)}else y.render(d,f)},this.compile=function(e,t){function r(e,t,r){!0===e.transparent&&e.side===h&&!1===e.forceSinglePass?(e.side=u,e.needsUpdate=!0,Ue(e,t,r),e.side=c,e.needsUpdate=!0,Ue(e,t,r),e.side=h):Ue(e,t,r)}g=oe.get(e),g.init(),v.push(g),e.traverseVisible((function(e){e.isLight&&e.layers.test(t.layers)&&(g.pushLight(e),e.castShadow&&g.pushShadow(e))})),g.setupLights(_.useLegacyLights),e.traverse((function(t){const n=t.material;if(n)if(Array.isArray(n))for(let i=0;i<n.length;i++){r(n[i],e,t)}else r(n,e,t)})),v.pop(),g=null};let Le=null;function Re(){je.stop()}function Pe(){je.start()}const je=new Oi;function Ie(e,t,r,n){if(!1===e.visible)return;if(e.layers.test(t.layers))if(e.isGroup)r=e.renderOrder;else if(e.isLOD)!0===e.autoUpdate&&e.update(t);else if(e.isLight)g.pushLight(e),e.castShadow&&g.pushShadow(e);else if(e.isSprite){if(!e.frustumCulled||U.intersectsSprite(e)){n&&G.setFromMatrixPosition(e.matrixWorld).applyMatrix4(z);const t=re.update(e),i=e.material;i.visible&&m.push(e,t,i,r,G.z,null)}}else if((e.isMesh||e.isLine||e.isPoints)&&(e.isSkinnedMesh&&e.skeleton.frame!==Z.render.frame&&(e.skeleton.update(),e.skeleton.frame=Z.render.frame),!e.frustumCulled||U.intersectsObject(e))){n&&G.setFromMatrixPosition(e.matrixWorld).applyMatrix4(z);const t=re.update(e),i=e.material;if(Array.isArray(i)){const n=t.groups;for(let s=0,o=n.length;s<o;s++){const o=n[s],a=i[o.materialIndex];a&&a.visible&&m.push(e,t,a,r,G.z,o)}}else i.visible&&m.push(e,t,i,r,G.z,null)}const i=e.children;for(let e=0,s=i.length;e<s;e++)Ie(i[e],t,r,n)}function De(e,t,r,n){const i=e.opaque,s=e.transmissive,a=e.transparent;g.setupLightsView(r),!0===k&&ae.setGlobalState(_.clippingPlanes,r),s.length>0&&function(e,t,r){const n=q.isWebGL2;null===B&&(B=new yr(1024,1024,{generateMipmaps:!0,type:X.has("EXT_color_buffer_half_float")?_e:de,minFilter:he,samples:n&&!0===o?4:0}));const i=_.getRenderTarget();_.setRenderTarget(B),_.clear();const s=_.toneMapping;_.toneMapping=W,Oe(e,t,r),_.toneMapping=s,K.updateMultisampleRenderTarget(B),K.updateRenderTargetMipmap(B),_.setRenderTarget(i)}(i,t,r),n&&Y.viewport(E.copy(n)),i.length>0&&Oe(i,t,r),s.length>0&&Oe(s,t,r),a.length>0&&Oe(a,t,r),Y.buffers.depth.setTest(!0),Y.buffers.depth.setMask(!0),Y.buffers.color.setMask(!0),Y.setPolygonOffset(!1)}function Oe(e,t,r){const n=!0===t.isScene?t.overrideMaterial:null;for(let i=0,s=e.length;i<s;i++){const s=e[i],o=s.object,a=s.geometry,l=null===n?s.material:n,c=s.group;o.layers.test(r.layers)&&Ne(o,t,r,a,l,c)}}function Ne(e,t,r,n,i,s){e.onBeforeRender(_,t,r,n,i,s),e.modelViewMatrix.multiplyMatrices(r.matrixWorldInverse,e.matrixWorld),e.normalMatrix.getNormalMatrix(e.modelViewMatrix),i.onBeforeRender(_,t,r,n,e,s),!0===i.transparent&&i.side===h&&!1===i.forceSinglePass?(i.side=u,i.needsUpdate=!0,_.renderBufferDirect(r,t,n,i,e,s),i.side=c,i.needsUpdate=!0,_.renderBufferDirect(r,t,n,i,e,s),i.side=h):_.renderBufferDirect(r,t,n,i,e,s),e.onAfterRender(_,t,r,n,i,s)}function Ue(e,t,r){!0!==t.isScene&&(t=V);const n=J.get(e),i=g.state.lights,s=g.state.shadowsArray,o=i.state.version,a=ne.getParameters(e,i.state,s,t,r),l=ne.getProgramCacheKey(a);let c=n.programs;n.environment=e.isMeshStandardMaterial?t.environment:null,n.fog=t.fog,n.envMap=(e.isMeshStandardMaterial?$:Q).get(e.envMap||n.environment),void 0===c&&(e.addEventListener("dispose",Ce),c=new Map,n.programs=c);let u=c.get(l);if(void 0!==u){if(n.currentProgram===u&&n.lightsStateVersion===o)return ke(e,a),u}else a.uniforms=ne.getUniforms(e),e.onBuild(r,a,_),e.onBeforeCompile(a,_),u=ne.acquireProgram(a,l),c.set(l,u),n.uniforms=a.uniforms;const h=n.uniforms;(e.isShaderMaterial||e.isRawShaderMaterial)&&!0!==e.clipping||(h.clippingPlanes=ae.uniform),ke(e,a),n.needsLights=function(e){return e.isMeshLambertMaterial||e.isMeshToonMaterial||e.isMeshPhongMaterial||e.isMeshStandardMaterial||e.isShadowMaterial||e.isShaderMaterial&&!0===e.lights}(e),n.lightsStateVersion=o,n.needsLights&&(h.ambientLightColor.value=i.state.ambient,h.lightProbe.value=i.state.probe,h.directionalLights.value=i.state.directional,h.directionalLightShadows.value=i.state.directionalShadow,h.spotLights.value=i.state.spot,h.spotLightShadows.value=i.state.spotShadow,h.rectAreaLights.value=i.state.rectArea,h.ltc_1.value=i.state.rectAreaLTC1,h.ltc_2.value=i.state.rectAreaLTC2,h.pointLights.value=i.state.point,h.pointLightShadows.value=i.state.pointShadow,h.hemisphereLights.value=i.state.hemi,h.directionalShadowMap.value=i.state.directionalShadowMap,h.directionalShadowMatrix.value=i.state.directionalShadowMatrix,h.spotShadowMap.value=i.state.spotShadowMap,h.spotLightMatrix.value=i.state.spotLightMatrix,h.spotLightMap.value=i.state.spotLightMap,h.pointShadowMap.value=i.state.pointShadowMap,h.pointShadowMatrix.value=i.state.pointShadowMatrix);const d=u.getUniforms(),p=So.seqWithValue(d.seq,h);return n.currentProgram=u,n.uniformsList=p,u}function ke(e,t){const r=J.get(e);r.outputEncoding=t.outputEncoding,r.instancing=t.instancing,r.skinning=t.skinning,r.morphTargets=t.morphTargets,r.morphNormals=t.morphNormals,r.morphColors=t.morphColors,r.morphTargetsCount=t.morphTargetsCount,r.numClippingPlanes=t.numClippingPlanes,r.numIntersection=t.numClipIntersection,r.vertexAlphas=t.vertexAlphas,r.vertexTangents=t.vertexTangents,r.toneMapping=t.toneMapping}je.setAnimationLoop((function(e){Le&&Le(e)})),"undefined"!=typeof self&&je.setContext(self),this.setAnimationLoop=function(e){Le=e,Se.setAnimationLoop(e),null===e?je.stop():je.start()},Se.addEventListener("sessionstart",Re),Se.addEventListener("sessionend",Pe),this.render=function(e,t){if(void 0!==t&&!0!==t.isCamera)return;if(!0===x)return;!0===e.matrixWorldAutoUpdate&&e.updateMatrixWorld(),null===t.parent&&!0===t.matrixWorldAutoUpdate&&t.updateMatrixWorld(),!0===Se.enabled&&!0===Se.isPresenting&&(!0===Se.cameraAutoUpdate&&Se.updateCamera(t),t=Se.getCamera()),!0===e.isScene&&e.onBeforeRender(_,e,t,S),g=oe.get(e,v.length),g.init(),v.push(g),z.multiplyMatrices(t.projectionMatrix,t.matrixWorldInverse),U.setFromProjectionMatrix(z),F=this.localClippingEnabled,k=ae.init(this.clippingPlanes,F),m=se.get(e,y.length),m.init(),y.push(m),Ie(e,t,0,_.sortObjects),m.finish(),!0===_.sortObjects&&m.sort(j,I),!0===k&&ae.beginShadows();const r=g.state.shadowsArray;if(le.render(r,e,t),!0===k&&ae.endShadows(),!0===this.info.autoReset&&this.info.reset(),ce.render(m,e),g.setupLights(_.useLegacyLights),t.isArrayCamera){const r=t.cameras;for(let t=0,n=r.length;t<n;t++){const n=r[t];De(m,e,n,n.viewport)}}else De(m,e,t);null!==S&&(K.updateMultisampleRenderTarget(S),K.updateRenderTargetMipmap(S)),!0===e.isScene&&e.onAfterRender(_,e,t),ge.resetDefaultState(),M=-1,T=null,v.pop(),g=v.length>0?v[v.length-1]:null,y.pop(),m=y.length>0?y[y.length-1]:null},this.getActiveCubeFace=function(){return b},this.getActiveMipmapLevel=function(){return w},this.getRenderTarget=function(){return S},this.setRenderTargetTextures=function(e,t,r){J.get(e.texture).__webglTexture=t,J.get(e.depthTexture).__webglTexture=r;const n=J.get(e);n.__hasExternalTextures=!0,n.__hasExternalTextures&&(n.__autoAllocateDepthBuffer=void 0===r,n.__autoAllocateDepthBuffer||!0===X.has("WEBGL_multisampled_render_to_texture")&&(n.__useRenderToTexture=!1))},this.setRenderTargetFramebuffer=function(e,t){const r=J.get(e);r.__webglFramebuffer=t,r.__useDefaultFramebuffer=void 0===t},this.setRenderTarget=function(e,t=0,r=0){S=e,b=t,w=r;let n=!0,i=null,s=!1,o=!1;if(e){const r=J.get(e);void 0!==r.__useDefaultFramebuffer?(Y.bindFramebuffer(xe.FRAMEBUFFER,null),n=!1):void 0===r.__webglFramebuffer?K.setupRenderTarget(e):r.__hasExternalTextures&&K.rebindTextures(e,J.get(e.texture).__webglTexture,J.get(e.depthTexture).__webglTexture);const a=e.texture;(a.isData3DTexture||a.isDataArrayTexture||a.isCompressedArrayTexture)&&(o=!0);const l=J.get(e).__webglFramebuffer;e.isWebGLCubeRenderTarget?(i=l[t],s=!0):i=q.isWebGL2&&e.samples>0&&!1===K.useMultisampledRTT(e)?J.get(e).__webglMultisampledFramebuffer:l,E.copy(e.viewport),A.copy(e.scissor),C=e.scissorTest}else E.copy(D).multiplyScalar(P).floor(),A.copy(O).multiplyScalar(P).floor(),C=N;if(Y.bindFramebuffer(xe.FRAMEBUFFER,i)&&q.drawBuffers&&n&&Y.drawBuffers(e,i),Y.viewport(E),Y.scissor(A),Y.setScissorTest(C),s){const n=J.get(e.texture);xe.framebufferTexture2D(xe.FRAMEBUFFER,xe.COLOR_ATTACHMENT0,xe.TEXTURE_CUBE_MAP_POSITIVE_X+t,n.__webglTexture,r)}else if(o){const n=J.get(e.texture),i=t||0;xe.framebufferTextureLayer(xe.FRAMEBUFFER,xe.COLOR_ATTACHMENT0,n.__webglTexture,r||0,i)}M=-1},this.readRenderTargetPixels=function(e,t,r,n,i,s,o){if(!e||!e.isWebGLRenderTarget)return;let a=J.get(e).__webglFramebuffer;if(e.isWebGLCubeRenderTarget&&void 0!==o&&(a=a[o]),a){Y.bindFramebuffer(xe.FRAMEBUFFER,a);try{const o=e.texture,a=o.format,l=o.type;if(a!==Me&&me.convert(a)!==xe.getParameter(xe.IMPLEMENTATION_COLOR_READ_FORMAT))return;const c=l===_e&&(X.has("EXT_color_buffer_half_float")||q.isWebGL2&&X.has("EXT_color_buffer_float"));if(!(l===de||me.convert(l)===xe.getParameter(xe.IMPLEMENTATION_COLOR_READ_TYPE)||l===ve&&(q.isWebGL2||X.has("OES_texture_float")||X.has("WEBGL_color_buffer_float"))||c))return;t>=0&&t<=e.width-n&&r>=0&&r<=e.height-i&&xe.readPixels(t,r,n,i,me.convert(a),me.convert(l),s)}finally{const e=null!==S?J.get(S).__webglFramebuffer:null;Y.bindFramebuffer(xe.FRAMEBUFFER,e)}}},this.copyFramebufferToTexture=function(e,t,r=0){const n=Math.pow(2,-r),i=Math.floor(t.image.width*n),s=Math.floor(t.image.height*n);K.setTexture2D(t,0),xe.copyTexSubImage2D(xe.TEXTURE_2D,r,0,0,e.x,e.y,i,s),Y.unbindTexture()},this.copyTextureToTexture=function(e,t,r,n=0){const i=t.image.width,s=t.image.height,o=me.convert(r.format),a=me.convert(r.type);K.setTexture2D(r,0),xe.pixelStorei(xe.UNPACK_FLIP_Y_WEBGL,r.flipY),xe.pixelStorei(xe.UNPACK_PREMULTIPLY_ALPHA_WEBGL,r.premultiplyAlpha),xe.pixelStorei(xe.UNPACK_ALIGNMENT,r.unpackAlignment),t.isDataTexture?xe.texSubImage2D(xe.TEXTURE_2D,n,e.x,e.y,i,s,o,a,t.image.data):t.isCompressedTexture?xe.compressedTexSubImage2D(xe.TEXTURE_2D,n,e.x,e.y,t.mipmaps[0].width,t.mipmaps[0].height,o,t.mipmaps[0].data):xe.texSubImage2D(xe.TEXTURE_2D,n,e.x,e.y,o,a,t.image),0===n&&r.generateMipmaps&&xe.generateMipmap(xe.TEXTURE_2D),Y.unbindTexture()},this.copyTextureToTexture3D=function(e,t,r,n,i=0){if(_.isWebGL1Renderer)return;const s=e.max.x-e.min.x+1,o=e.max.y-e.min.y+1,a=e.max.z-e.min.z+1,l=me.convert(n.format),c=me.convert(n.type);let u;if(n.isData3DTexture)K.setTexture3D(n,0),u=xe.TEXTURE_3D;else{if(!n.isDataArrayTexture)return;K.setTexture2DArray(n,0),u=xe.TEXTURE_2D_ARRAY}xe.pixelStorei(xe.UNPACK_FLIP_Y_WEBGL,n.flipY),xe.pixelStorei(xe.UNPACK_PREMULTIPLY_ALPHA_WEBGL,n.premultiplyAlpha),xe.pixelStorei(xe.UNPACK_ALIGNMENT,n.unpackAlignment);const h=xe.getParameter(xe.UNPACK_ROW_LENGTH),d=xe.getParameter(xe.UNPACK_IMAGE_HEIGHT),p=xe.getParameter(xe.UNPACK_SKIP_PIXELS),f=xe.getParameter(xe.UNPACK_SKIP_ROWS),m=xe.getParameter(xe.UNPACK_SKIP_IMAGES),g=r.isCompressedTexture?r.mipmaps[0]:r.image;xe.pixelStorei(xe.UNPACK_ROW_LENGTH,g.width),xe.pixelStorei(xe.UNPACK_IMAGE_HEIGHT,g.height),xe.pixelStorei(xe.UNPACK_SKIP_PIXELS,e.min.x),xe.pixelStorei(xe.UNPACK_SKIP_ROWS,e.min.y),xe.pixelStorei(xe.UNPACK_SKIP_IMAGES,e.min.z),r.isDataTexture||r.isData3DTexture?xe.texSubImage3D(u,i,t.x,t.y,t.z,s,o,a,l,c,g.data):r.isCompressedArrayTexture?xe.compressedTexSubImage3D(u,i,t.x,t.y,t.z,s,o,a,l,g.data):xe.texSubImage3D(u,i,t.x,t.y,t.z,s,o,a,l,c,g),xe.pixelStorei(xe.UNPACK_ROW_LENGTH,h),xe.pixelStorei(xe.UNPACK_IMAGE_HEIGHT,d),xe.pixelStorei(xe.UNPACK_SKIP_PIXELS,p),xe.pixelStorei(xe.UNPACK_SKIP_ROWS,f),xe.pixelStorei(xe.UNPACK_SKIP_IMAGES,m),0===i&&n.generateMipmaps&&xe.generateMipmap(u),Y.unbindTexture()},this.initTexture=function(e){e.isCubeTexture?K.setTextureCube(e,0):e.isData3DTexture?K.setTexture3D(e,0):e.isDataArrayTexture||e.isCompressedArrayTexture?K.setTexture2DArray(e,0):K.setTexture2D(e,0),Y.unbindTexture()},this.resetState=function(){b=0,w=0,S=null,Y.reset(),ge.reset()},"undefined"!=typeof __THREE_DEVTOOLS__&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}Object.defineProperties(ya.prototype,{physicallyCorrectLights:{get:function(){return!this.useLegacyLights},set:function(e){this.useLegacyLights=!e}}});class va extends ya{}va.prototype.isWebGL1Renderer=!0;class _a{constructor(e,t=25e-5){this.isFogExp2=!0,this.name="",this.color=new Un(e),this.density=t}clone(){return new _a(this.color,this.density)}toJSON(){return{type:"FogExp2",color:this.color.getHex(),density:this.density}}}class xa{constructor(e,t=1,r=1e3){this.isFog=!0,this.name="",this.color=new Un(e),this.near=t,this.far=r}clone(){return new xa(this.color,this.near,this.far)}toJSON(){return{type:"Fog",color:this.color.getHex(),near:this.near,far:this.far}}}class ba extends _n{constructor(){super(),this.isScene=!0,this.type="Scene",this.background=null,this.environment=null,this.fog=null,this.backgroundBlurriness=0,this.backgroundIntensity=1,this.overrideMaterial=null,"undefined"!=typeof __THREE_DEVTOOLS__&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}copy(e,t){return super.copy(e,t),null!==e.background&&(this.background=e.background.clone()),null!==e.environment&&(this.environment=e.environment.clone()),null!==e.fog&&(this.fog=e.fog.clone()),this.backgroundBlurriness=e.backgroundBlurriness,this.backgroundIntensity=e.backgroundIntensity,null!==e.overrideMaterial&&(this.overrideMaterial=e.overrideMaterial.clone()),this.matrixAutoUpdate=e.matrixAutoUpdate,this}toJSON(e){const t=super.toJSON(e);return null!==this.fog&&(t.object.fog=this.fog.toJSON()),this.backgroundBlurriness>0&&(t.object.backgroundBlurriness=this.backgroundBlurriness),1!==this.backgroundIntensity&&(t.object.backgroundIntensity=this.backgroundIntensity),t}get autoUpdate(){return this.matrixWorldAutoUpdate}set autoUpdate(e){this.matrixWorldAutoUpdate=e}}class wa{constructor(e,t){this.isInterleavedBuffer=!0,this.array=e,this.stride=t,this.count=void 0!==e?e.length/t:0,this.usage=At,this.updateRange={offset:0,count:-1},this.version=0,this.uuid=Ot()}onUploadCallback(){}set needsUpdate(e){!0===e&&this.version++}setUsage(e){return this.usage=e,this}copy(e){return this.array=new e.array.constructor(e.array),this.count=e.count,this.stride=e.stride,this.usage=e.usage,this}copyAt(e,t,r){e*=this.stride,r*=t.stride;for(let n=0,i=this.stride;n<i;n++)this.array[e+n]=t.array[r+n];return this}set(e,t=0){return this.array.set(e,t),this}clone(e){void 0===e.arrayBuffers&&(e.arrayBuffers={}),void 0===this.array.buffer._uuid&&(this.array.buffer._uuid=Ot()),void 0===e.arrayBuffers[this.array.buffer._uuid]&&(e.arrayBuffers[this.array.buffer._uuid]=this.array.slice(0).buffer);const t=new this.array.constructor(e.arrayBuffers[this.array.buffer._uuid]),r=new this.constructor(t,this.stride);return r.setUsage(this.usage),r}onUpload(e){return this.onUploadCallback=e,this}toJSON(e){return void 0===e.arrayBuffers&&(e.arrayBuffers={}),void 0===this.array.buffer._uuid&&(this.array.buffer._uuid=Ot()),void 0===e.arrayBuffers[this.array.buffer._uuid]&&(e.arrayBuffers[this.array.buffer._uuid]=Array.from(new Uint32Array(this.array.buffer))),{uuid:this.uuid,buffer:this.array.buffer._uuid,type:this.array.constructor.name,stride:this.stride}}}const Sa=new $t;class Ma{constructor(e,t,r,n=!1){this.isInterleavedBufferAttribute=!0,this.name="",this.data=e,this.itemSize=t,this.offset=r,this.normalized=n}get count(){return this.data.count}get array(){return this.data.array}set needsUpdate(e){this.data.needsUpdate=e}applyMatrix4(e){for(let t=0,r=this.data.count;t<r;t++)Sa.fromBufferAttribute(this,t),Sa.applyMatrix4(e),this.setXYZ(t,Sa.x,Sa.y,Sa.z);return this}applyNormalMatrix(e){for(let t=0,r=this.count;t<r;t++)Sa.fromBufferAttribute(this,t),Sa.applyNormalMatrix(e),this.setXYZ(t,Sa.x,Sa.y,Sa.z);return this}transformDirection(e){for(let t=0,r=this.count;t<r;t++)Sa.fromBufferAttribute(this,t),Sa.transformDirection(e),this.setXYZ(t,Sa.x,Sa.y,Sa.z);return this}setX(e,t){return this.normalized&&(t=Vt(t,this.array)),this.data.array[e*this.data.stride+this.offset]=t,this}setY(e,t){return this.normalized&&(t=Vt(t,this.array)),this.data.array[e*this.data.stride+this.offset+1]=t,this}setZ(e,t){return this.normalized&&(t=Vt(t,this.array)),this.data.array[e*this.data.stride+this.offset+2]=t,this}setW(e,t){return this.normalized&&(t=Vt(t,this.array)),this.data.array[e*this.data.stride+this.offset+3]=t,this}getX(e){let t=this.data.array[e*this.data.stride+this.offset];return this.normalized&&(t=Gt(t,this.array)),t}getY(e){let t=this.data.array[e*this.data.stride+this.offset+1];return this.normalized&&(t=Gt(t,this.array)),t}getZ(e){let t=this.data.array[e*this.data.stride+this.offset+2];return this.normalized&&(t=Gt(t,this.array)),t}getW(e){let t=this.data.array[e*this.data.stride+this.offset+3];return this.normalized&&(t=Gt(t,this.array)),t}setXY(e,t,r){return e=e*this.data.stride+this.offset,this.normalized&&(t=Vt(t,this.array),r=Vt(r,this.array)),this.data.array[e+0]=t,this.data.array[e+1]=r,this}setXYZ(e,t,r,n){return e=e*this.data.stride+this.offset,this.normalized&&(t=Vt(t,this.array),r=Vt(r,this.array),n=Vt(n,this.array)),this.data.array[e+0]=t,this.data.array[e+1]=r,this.data.array[e+2]=n,this}setXYZW(e,t,r,n,i){return e=e*this.data.stride+this.offset,this.normalized&&(t=Vt(t,this.array),r=Vt(r,this.array),n=Vt(n,this.array),i=Vt(i,this.array)),this.data.array[e+0]=t,this.data.array[e+1]=r,this.data.array[e+2]=n,this.data.array[e+3]=i,this}clone(e){if(void 0===e){const e=[];for(let t=0;t<this.count;t++){const r=t*this.data.stride+this.offset;for(let t=0;t<this.itemSize;t++)e.push(this.data.array[r+t])}return new Gn(new this.array.constructor(e),this.itemSize,this.normalized)}return void 0===e.interleavedBuffers&&(e.interleavedBuffers={}),void 0===e.interleavedBuffers[this.data.uuid]&&(e.interleavedBuffers[this.data.uuid]=this.data.clone(e)),new Ma(e.interleavedBuffers[this.data.uuid],this.itemSize,this.offset,this.normalized)}toJSON(e){if(void 0===e){const e=[];for(let t=0;t<this.count;t++){const r=t*this.data.stride+this.offset;for(let t=0;t<this.itemSize;t++)e.push(this.data.array[r+t])}return{itemSize:this.itemSize,type:this.array.constructor.name,array:e,normalized:this.normalized}}return void 0===e.interleavedBuffers&&(e.interleavedBuffers={}),void 0===e.interleavedBuffers[this.data.uuid]&&(e.interleavedBuffers[this.data.uuid]=this.data.toJSON(e)),{isInterleavedBufferAttribute:!0,itemSize:this.itemSize,data:this.data.uuid,offset:this.offset,normalized:this.normalized}}}class Ta extends jn{constructor(e){super(),this.isSpriteMaterial=!0,this.type="SpriteMaterial",this.color=new Un(16777215),this.map=null,this.alphaMap=null,this.rotation=0,this.sizeAttenuation=!0,this.transparent=!0,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.alphaMap=e.alphaMap,this.rotation=e.rotation,this.sizeAttenuation=e.sizeAttenuation,this.fog=e.fog,this}}let Ea;const Aa=new $t,Ca=new $t,La=new $t,Ra=new Wt,Pa=new Wt,ja=new qr,Ia=new $t,Da=new $t,Oa=new $t,Na=new Wt,Ua=new Wt,ka=new Wt;class Fa extends _n{constructor(e){if(super(),this.isSprite=!0,this.type="Sprite",void 0===Ea){Ea=new $n;const e=new Float32Array([-.5,-.5,0,0,0,.5,-.5,0,1,0,.5,.5,0,1,1,-.5,.5,0,0,1]),t=new wa(e,5);Ea.setIndex([0,1,2,0,2,3]),Ea.setAttribute("position",new Ma(t,3,0,!1)),Ea.setAttribute("uv",new Ma(t,2,3,!1))}this.geometry=Ea,this.material=void 0!==e?e:new Ta,this.center=new Wt(.5,.5)}raycast(e,t){e.camera,Ca.setFromMatrixScale(this.matrixWorld),ja.copy(e.camera.matrixWorld),this.modelViewMatrix.multiplyMatrices(e.camera.matrixWorldInverse,this.matrixWorld),La.setFromMatrixPosition(this.modelViewMatrix),e.camera.isPerspectiveCamera&&!1===this.material.sizeAttenuation&&Ca.multiplyScalar(-La.z);const r=this.material.rotation;let n,i;0!==r&&(i=Math.cos(r),n=Math.sin(r));const s=this.center;Ba(Ia.set(-.5,-.5,0),La,s,Ca,n,i),Ba(Da.set(.5,-.5,0),La,s,Ca,n,i),Ba(Oa.set(.5,.5,0),La,s,Ca,n,i),Na.set(0,0),Ua.set(1,0),ka.set(1,1);let o=e.ray.intersectTriangle(Ia,Da,Oa,!1,Aa);if(null===o&&(Ba(Da.set(-.5,.5,0),La,s,Ca,n,i),Ua.set(0,1),o=e.ray.intersectTriangle(Ia,Oa,Da,!1,Aa),null===o))return;const a=e.ray.origin.distanceTo(Aa);a<e.near||a>e.far||t.push({distance:a,point:Aa.clone(),uv:Rn.getUV(Aa,Ia,Da,Oa,Na,Ua,ka,new Wt),face:null,object:this})}copy(e,t){return super.copy(e,t),void 0!==e.center&&this.center.copy(e.center),this.material=e.material,this}}function Ba(e,t,r,n,i,s){Ra.subVectors(e,r).addScalar(.5).multiply(n),void 0!==i?(Pa.x=s*Ra.x-i*Ra.y,Pa.y=i*Ra.x+s*Ra.y):Pa.copy(Ra),e.copy(t),e.x+=Pa.x,e.y+=Pa.y,e.applyMatrix4(ja)}const za=new $t,Ga=new $t;class Va extends _n{constructor(){super(),this._currentLevel=0,this.type="LOD",Object.defineProperties(this,{levels:{enumerable:!0,value:[]},isLOD:{value:!0}}),this.autoUpdate=!0}copy(e){super.copy(e,!1);const t=e.levels;for(let e=0,r=t.length;e<r;e++){const r=t[e];this.addLevel(r.object.clone(),r.distance,r.hysteresis)}return this.autoUpdate=e.autoUpdate,this}addLevel(e,t=0,r=0){t=Math.abs(t);const n=this.levels;let i;for(i=0;i<n.length&&!(t<n[i].distance);i++);return n.splice(i,0,{distance:t,hysteresis:r,object:e}),this.add(e),this}getCurrentLevel(){return this._currentLevel}getObjectForDistance(e){const t=this.levels;if(t.length>0){let r,n;for(r=1,n=t.length;r<n;r++){let n=t[r].distance;if(t[r].object.visible&&(n-=n*t[r].hysteresis),e<n)break}return t[r-1].object}return null}raycast(e,t){if(this.levels.length>0){za.setFromMatrixPosition(this.matrixWorld);const r=e.ray.origin.distanceTo(za);this.getObjectForDistance(r).raycast(e,t)}}update(e){const t=this.levels;if(t.length>1){za.setFromMatrixPosition(e.matrixWorld),Ga.setFromMatrixPosition(this.matrixWorld);const r=za.distanceTo(Ga)/e.zoom;let n,i;for(t[0].object.visible=!0,n=1,i=t.length;n<i;n++){let e=t[n].distance;if(t[n].object.visible&&(e-=e*t[n].hysteresis),!(r>=e))break;t[n-1].object.visible=!1,t[n].object.visible=!0}for(this._currentLevel=n-1;n<i;n++)t[n].object.visible=!1}}toJSON(e){const t=super.toJSON(e);!1===this.autoUpdate&&(t.object.autoUpdate=!1),t.object.levels=[];const r=this.levels;for(let e=0,n=r.length;e<n;e++){const n=r[e];t.object.levels.push({object:n.object.uuid,distance:n.distance,hysteresis:n.hysteresis})}return t}}const Ha=new $t,Wa=new gr,Xa=new gr,qa=new $t,Ya=new qr;class Za extends fi{constructor(e,t){super(e,t),this.isSkinnedMesh=!0,this.type="SkinnedMesh",this.bindMode="attached",this.bindMatrix=new qr,this.bindMatrixInverse=new qr}copy(e,t){return super.copy(e,t),this.bindMode=e.bindMode,this.bindMatrix.copy(e.bindMatrix),this.bindMatrixInverse.copy(e.bindMatrixInverse),this.skeleton=e.skeleton,this}bind(e,t){this.skeleton=e,void 0===t&&(this.updateMatrixWorld(!0),this.skeleton.calculateInverses(),t=this.matrixWorld),this.bindMatrix.copy(t),this.bindMatrixInverse.copy(t).invert()}pose(){this.skeleton.pose()}normalizeSkinWeights(){const e=new gr,t=this.geometry.attributes.skinWeight;for(let r=0,n=t.count;r<n;r++){e.fromBufferAttribute(t,r);const n=1/e.manhattanLength();n!==1/0?e.multiplyScalar(n):e.set(1,0,0,0),t.setXYZW(r,e.x,e.y,e.z,e.w)}}updateMatrixWorld(e){super.updateMatrixWorld(e),"attached"===this.bindMode?this.bindMatrixInverse.copy(this.matrixWorld).invert():"detached"===this.bindMode&&this.bindMatrixInverse.copy(this.bindMatrix).invert()}boneTransform(e,t){const r=this.skeleton,n=this.geometry;Wa.fromBufferAttribute(n.attributes.skinIndex,e),Xa.fromBufferAttribute(n.attributes.skinWeight,e),Ha.copy(t).applyMatrix4(this.bindMatrix),t.set(0,0,0);for(let e=0;e<4;e++){const n=Xa.getComponent(e);if(0!==n){const i=Wa.getComponent(e);Ya.multiplyMatrices(r.bones[i].matrixWorld,r.boneInverses[i]),t.addScaledVector(qa.copy(Ha).applyMatrix4(Ya),n)}}return t.applyMatrix4(this.bindMatrixInverse)}}class Ja extends _n{constructor(){super(),this.isBone=!0,this.type="Bone"}}class Ka extends mr{constructor(e=null,t=1,r=1,n,i,s,o,a,l=oe,c=oe,u,h){super(null,s,o,a,l,c,n,i,u,h),this.isDataTexture=!0,this.image={data:e,width:t,height:r},this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}const Qa=new qr,$a=new qr;class el{constructor(e=[],t=[]){this.uuid=Ot(),this.bones=e.slice(0),this.boneInverses=t,this.boneMatrices=null,this.boneTexture=null,this.boneTextureSize=0,this.frame=-1,this.init()}init(){const e=this.bones,t=this.boneInverses;if(this.boneMatrices=new Float32Array(16*e.length),0===t.length)this.calculateInverses();else if(e.length!==t.length){this.boneInverses=[];for(let e=0,t=this.bones.length;e<t;e++)this.boneInverses.push(new qr)}}calculateInverses(){this.boneInverses.length=0;for(let e=0,t=this.bones.length;e<t;e++){const t=new qr;this.bones[e]&&t.copy(this.bones[e].matrixWorld).invert(),this.boneInverses.push(t)}}pose(){for(let e=0,t=this.bones.length;e<t;e++){const t=this.bones[e];t&&t.matrixWorld.copy(this.boneInverses[e]).invert()}for(let e=0,t=this.bones.length;e<t;e++){const t=this.bones[e];t&&(t.parent&&t.parent.isBone?(t.matrix.copy(t.parent.matrixWorld).invert(),t.matrix.multiply(t.matrixWorld)):t.matrix.copy(t.matrixWorld),t.matrix.decompose(t.position,t.quaternion,t.scale))}}update(){const e=this.bones,t=this.boneInverses,r=this.boneMatrices,n=this.boneTexture;for(let n=0,i=e.length;n<i;n++){const i=e[n]?e[n].matrixWorld:$a;Qa.multiplyMatrices(i,t[n]),Qa.toArray(r,16*n)}null!==n&&(n.needsUpdate=!0)}clone(){return new el(this.bones,this.boneInverses)}computeBoneTexture(){let e=Math.sqrt(4*this.bones.length);e=Bt(e),e=Math.max(e,4);const t=new Float32Array(e*e*4);t.set(this.boneMatrices);const r=new Ka(t,e,e,Me,ve);return r.needsUpdate=!0,this.boneMatrices=t,this.boneTexture=r,this.boneTextureSize=e,this}getBoneByName(e){for(let t=0,r=this.bones.length;t<r;t++){const r=this.bones[t];if(r.name===e)return r}}dispose(){null!==this.boneTexture&&(this.boneTexture.dispose(),this.boneTexture=null)}fromJSON(e,t){this.uuid=e.uuid;for(let r=0,n=e.bones.length;r<n;r++){let n=t[e.bones[r]];void 0===n&&(n=new Ja),this.bones.push(n),this.boneInverses.push((new qr).fromArray(e.boneInverses[r]))}return this.init(),this}toJSON(){const e={metadata:{version:4.5,type:"Skeleton",generator:"Skeleton.toJSON"},bones:[],boneInverses:[]};e.uuid=this.uuid;const t=this.bones,r=this.boneInverses;for(let n=0,i=t.length;n<i;n++){const i=t[n];e.bones.push(i.uuid);const s=r[n];e.boneInverses.push(s.toArray())}return e}}class tl extends Gn{constructor(e,t,r,n=1){super(e,t,r),this.isInstancedBufferAttribute=!0,this.meshPerAttribute=n}copy(e){return super.copy(e),this.meshPerAttribute=e.meshPerAttribute,this}toJSON(){const e=super.toJSON();return e.meshPerAttribute=this.meshPerAttribute,e.isInstancedBufferAttribute=!0,e}}const rl=new qr,nl=new qr,il=[],sl=new qr,ol=new fi;class al extends fi{constructor(e,t,r){super(e,t),this.isInstancedMesh=!0,this.instanceMatrix=new tl(new Float32Array(16*r),16),this.instanceColor=null,this.count=r,this.frustumCulled=!1;for(let e=0;e<r;e++)this.setMatrixAt(e,sl)}copy(e,t){return super.copy(e,t),this.instanceMatrix.copy(e.instanceMatrix),null!==e.instanceColor&&(this.instanceColor=e.instanceColor.clone()),this.count=e.count,this}getColorAt(e,t){t.fromArray(this.instanceColor.array,3*e)}getMatrixAt(e,t){t.fromArray(this.instanceMatrix.array,16*e)}raycast(e,t){const r=this.matrixWorld,n=this.count;if(ol.geometry=this.geometry,ol.material=this.material,void 0!==ol.material)for(let i=0;i<n;i++){this.getMatrixAt(i,rl),nl.multiplyMatrices(r,rl),ol.matrixWorld=nl,ol.raycast(e,il);for(let e=0,r=il.length;e<r;e++){const r=il[e];r.instanceId=i,r.object=this,t.push(r)}il.length=0}}setColorAt(e,t){null===this.instanceColor&&(this.instanceColor=new tl(new Float32Array(3*this.instanceMatrix.count),3)),t.toArray(this.instanceColor.array,3*e)}setMatrixAt(e,t){t.toArray(this.instanceMatrix.array,16*e)}updateMorphTargets(){}dispose(){this.dispatchEvent({type:"dispose"})}}class ll extends jn{constructor(e){super(),this.isLineBasicMaterial=!0,this.type="LineBasicMaterial",this.color=new Un(16777215),this.linewidth=1,this.linecap="round",this.linejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.linewidth=e.linewidth,this.linecap=e.linecap,this.linejoin=e.linejoin,this.fog=e.fog,this}}const cl=new $t,ul=new $t,hl=new qr,dl=new Xr,pl=new kr;class fl extends _n{constructor(e=new $n,t=new ll){super(),this.isLine=!0,this.type="Line",this.geometry=e,this.material=t,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),this.material=e.material,this.geometry=e.geometry,this}computeLineDistances(){const e=this.geometry;if(null===e.index){const t=e.attributes.position,r=[0];for(let e=1,n=t.count;e<n;e++)cl.fromBufferAttribute(t,e-1),ul.fromBufferAttribute(t,e),r[e]=r[e-1],r[e]+=cl.distanceTo(ul);e.setAttribute("lineDistance",new Wn(r,1))}return this}raycast(e,t){const r=this.geometry,n=this.matrixWorld,i=e.params.Line.threshold,s=r.drawRange;if(null===r.boundingSphere&&r.computeBoundingSphere(),pl.copy(r.boundingSphere),pl.applyMatrix4(n),pl.radius+=i,!1===e.ray.intersectsSphere(pl))return;hl.copy(n).invert(),dl.copy(e.ray).applyMatrix4(hl);const o=i/((this.scale.x+this.scale.y+this.scale.z)/3),a=o*o,l=new $t,c=new $t,u=new $t,h=new $t,d=this.isLineSegments?2:1,p=r.index,f=r.attributes.position;if(null!==p){for(let r=Math.max(0,s.start),n=Math.min(p.count,s.start+s.count)-1;r<n;r+=d){const n=p.getX(r),i=p.getX(r+1);l.fromBufferAttribute(f,n),c.fromBufferAttribute(f,i);if(dl.distanceSqToSegment(l,c,h,u)>a)continue;h.applyMatrix4(this.matrixWorld);const s=e.ray.origin.distanceTo(h);s<e.near||s>e.far||t.push({distance:s,point:u.clone().applyMatrix4(this.matrixWorld),index:r,face:null,faceIndex:null,object:this})}}else{for(let r=Math.max(0,s.start),n=Math.min(f.count,s.start+s.count)-1;r<n;r+=d){l.fromBufferAttribute(f,r),c.fromBufferAttribute(f,r+1);if(dl.distanceSqToSegment(l,c,h,u)>a)continue;h.applyMatrix4(this.matrixWorld);const n=e.ray.origin.distanceTo(h);n<e.near||n>e.far||t.push({distance:n,point:u.clone().applyMatrix4(this.matrixWorld),index:r,face:null,faceIndex:null,object:this})}}}updateMorphTargets(){const e=this.geometry.morphAttributes,t=Object.keys(e);if(t.length>0){const r=e[t[0]];if(void 0!==r){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let e=0,t=r.length;e<t;e++){const t=r[e].name||String(e);this.morphTargetInfluences.push(0),this.morphTargetDictionary[t]=e}}}}}const ml=new $t,gl=new $t;class yl extends fl{constructor(e,t){super(e,t),this.isLineSegments=!0,this.type="LineSegments"}computeLineDistances(){const e=this.geometry;if(null===e.index){const t=e.attributes.position,r=[];for(let e=0,n=t.count;e<n;e+=2)ml.fromBufferAttribute(t,e),gl.fromBufferAttribute(t,e+1),r[e]=0===e?0:r[e-1],r[e+1]=r[e]+ml.distanceTo(gl);e.setAttribute("lineDistance",new Wn(r,1))}return this}}class vl extends fl{constructor(e,t){super(e,t),this.isLineLoop=!0,this.type="LineLoop"}}class _l extends jn{constructor(e){super(),this.isPointsMaterial=!0,this.type="PointsMaterial",this.color=new Un(16777215),this.map=null,this.alphaMap=null,this.size=1,this.sizeAttenuation=!0,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.alphaMap=e.alphaMap,this.size=e.size,this.sizeAttenuation=e.sizeAttenuation,this.fog=e.fog,this}}const xl=new qr,bl=new Xr,wl=new kr,Sl=new $t;class Ml extends _n{constructor(e=new $n,t=new _l){super(),this.isPoints=!0,this.type="Points",this.geometry=e,this.material=t,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),this.material=e.material,this.geometry=e.geometry,this}raycast(e,t){const r=this.geometry,n=this.matrixWorld,i=e.params.Points.threshold,s=r.drawRange;if(null===r.boundingSphere&&r.computeBoundingSphere(),wl.copy(r.boundingSphere),wl.applyMatrix4(n),wl.radius+=i,!1===e.ray.intersectsSphere(wl))return;xl.copy(n).invert(),bl.copy(e.ray).applyMatrix4(xl);const o=i/((this.scale.x+this.scale.y+this.scale.z)/3),a=o*o,l=r.index,c=r.attributes.position;if(null!==l){for(let r=Math.max(0,s.start),i=Math.min(l.count,s.start+s.count);r<i;r++){const i=l.getX(r);Sl.fromBufferAttribute(c,i),Tl(Sl,i,a,n,e,t,this)}}else{for(let r=Math.max(0,s.start),i=Math.min(c.count,s.start+s.count);r<i;r++)Sl.fromBufferAttribute(c,r),Tl(Sl,r,a,n,e,t,this)}}updateMorphTargets(){const e=this.geometry.morphAttributes,t=Object.keys(e);if(t.length>0){const r=e[t[0]];if(void 0!==r){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let e=0,t=r.length;e<t;e++){const t=r[e].name||String(e);this.morphTargetInfluences.push(0),this.morphTargetDictionary[t]=e}}}}}function Tl(e,t,r,n,i,s,o){const a=bl.distanceSqToPoint(e);if(a<r){const r=new $t;bl.closestPointToPoint(e,r),r.applyMatrix4(n);const l=i.ray.origin.distanceTo(r);if(l<i.near||l>i.far)return;s.push({distance:l,distanceToRay:Math.sqrt(a),point:r,index:t,face:null,object:o})}}class El extends mr{constructor(e,t,r,n,i,s,o,a,l,c,u,h){super(null,s,o,a,l,c,n,i,u,h),this.isCompressedTexture=!0,this.image={width:t,height:r},this.mipmaps=e,this.flipY=!1,this.generateMipmaps=!1}}class Al{constructor(){this.type="Curve",this.arcLengthDivisions=200}getPoint(){return null}getPointAt(e,t){const r=this.getUtoTmapping(e);return this.getPoint(r,t)}getPoints(e=5){const t=[];for(let r=0;r<=e;r++)t.push(this.getPoint(r/e));return t}getSpacedPoints(e=5){const t=[];for(let r=0;r<=e;r++)t.push(this.getPointAt(r/e));return t}getLength(){const e=this.getLengths();return e[e.length-1]}getLengths(e=this.arcLengthDivisions){if(this.cacheArcLengths&&this.cacheArcLengths.length===e+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;const t=[];let r,n=this.getPoint(0),i=0;t.push(0);for(let s=1;s<=e;s++)r=this.getPoint(s/e),i+=r.distanceTo(n),t.push(i),n=r;return this.cacheArcLengths=t,t}updateArcLengths(){this.needsUpdate=!0,this.getLengths()}getUtoTmapping(e,t){const r=this.getLengths();let n=0;const i=r.length;let s;s=t||e*r[i-1];let o,a=0,l=i-1;for(;a<=l;)if(n=Math.floor(a+(l-a)/2),o=r[n]-s,o<0)a=n+1;else{if(!(o>0)){l=n;break}l=n-1}if(n=l,r[n]===s)return n/(i-1);const c=r[n];return(n+(s-c)/(r[n+1]-c))/(i-1)}getTangent(e,t){const r=1e-4;let n=e-r,i=e+r;n<0&&(n=0),i>1&&(i=1);const s=this.getPoint(n),o=this.getPoint(i),a=t||(s.isVector2?new Wt:new $t);return a.copy(o).sub(s).normalize(),a}getTangentAt(e,t){const r=this.getUtoTmapping(e);return this.getTangent(r,t)}computeFrenetFrames(e,t){const r=new $t,n=[],i=[],s=[],o=new $t,a=new qr;for(let t=0;t<=e;t++){const r=t/e;n[t]=this.getTangentAt(r,new $t)}i[0]=new $t,s[0]=new $t;let l=Number.MAX_VALUE;const c=Math.abs(n[0].x),u=Math.abs(n[0].y),h=Math.abs(n[0].z);c<=l&&(l=c,r.set(1,0,0)),u<=l&&(l=u,r.set(0,1,0)),h<=l&&r.set(0,0,1),o.crossVectors(n[0],r).normalize(),i[0].crossVectors(n[0],o),s[0].crossVectors(n[0],i[0]);for(let t=1;t<=e;t++){if(i[t]=i[t-1].clone(),s[t]=s[t-1].clone(),o.crossVectors(n[t-1],n[t]),o.length()>Number.EPSILON){o.normalize();const e=Math.acos(Nt(n[t-1].dot(n[t]),-1,1));i[t].applyMatrix4(a.makeRotationAxis(o,e))}s[t].crossVectors(n[t],i[t])}if(!0===t){let t=Math.acos(Nt(i[0].dot(i[e]),-1,1));t/=e,n[0].dot(o.crossVectors(i[0],i[e]))>0&&(t=-t);for(let r=1;r<=e;r++)i[r].applyMatrix4(a.makeRotationAxis(n[r],t*r)),s[r].crossVectors(n[r],i[r])}return{tangents:n,normals:i,binormals:s}}clone(){return(new this.constructor).copy(this)}copy(e){return this.arcLengthDivisions=e.arcLengthDivisions,this}toJSON(){const e={metadata:{version:4.5,type:"Curve",generator:"Curve.toJSON"}};return e.arcLengthDivisions=this.arcLengthDivisions,e.type=this.type,e}fromJSON(e){return this.arcLengthDivisions=e.arcLengthDivisions,this}}class Cl extends Al{constructor(e=0,t=0,r=1,n=1,i=0,s=2*Math.PI,o=!1,a=0){super(),this.isEllipseCurve=!0,this.type="EllipseCurve",this.aX=e,this.aY=t,this.xRadius=r,this.yRadius=n,this.aStartAngle=i,this.aEndAngle=s,this.aClockwise=o,this.aRotation=a}getPoint(e,t){const r=t||new Wt,n=2*Math.PI;let i=this.aEndAngle-this.aStartAngle;const s=Math.abs(i)<Number.EPSILON;for(;i<0;)i+=n;for(;i>n;)i-=n;i<Number.EPSILON&&(i=s?0:n),!0!==this.aClockwise||s||(i===n?i=-n:i-=n);const o=this.aStartAngle+e*i;let a=this.aX+this.xRadius*Math.cos(o),l=this.aY+this.yRadius*Math.sin(o);if(0!==this.aRotation){const e=Math.cos(this.aRotation),t=Math.sin(this.aRotation),r=a-this.aX,n=l-this.aY;a=r*e-n*t+this.aX,l=r*t+n*e+this.aY}return r.set(a,l)}copy(e){return super.copy(e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this}toJSON(){const e=super.toJSON();return e.aX=this.aX,e.aY=this.aY,e.xRadius=this.xRadius,e.yRadius=this.yRadius,e.aStartAngle=this.aStartAngle,e.aEndAngle=this.aEndAngle,e.aClockwise=this.aClockwise,e.aRotation=this.aRotation,e}fromJSON(e){return super.fromJSON(e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this}}class Ll extends Cl{constructor(e,t,r,n,i,s){super(e,t,r,r,n,i,s),this.isArcCurve=!0,this.type="ArcCurve"}}function Rl(){let e=0,t=0,r=0,n=0;function i(i,s,o,a){e=i,t=o,r=-3*i+3*s-2*o-a,n=2*i-2*s+o+a}return{initCatmullRom:function(e,t,r,n,s){i(t,r,s*(r-e),s*(n-t))},initNonuniformCatmullRom:function(e,t,r,n,s,o,a){let l=(t-e)/s-(r-e)/(s+o)+(r-t)/o,c=(r-t)/o-(n-t)/(o+a)+(n-r)/a;l*=o,c*=o,i(t,r,l,c)},calc:function(i){const s=i*i;return e+t*i+r*s+n*(s*i)}}}const Pl=new $t,jl=new Rl,Il=new Rl,Dl=new Rl;class Ol extends Al{constructor(e=[],t=!1,r="centripetal",n=.5){super(),this.isCatmullRomCurve3=!0,this.type="CatmullRomCurve3",this.points=e,this.closed=t,this.curveType=r,this.tension=n}getPoint(e,t=new $t){const r=t,n=this.points,i=n.length,s=(i-(this.closed?0:1))*e;let o,a,l=Math.floor(s),c=s-l;this.closed?l+=l>0?0:(Math.floor(Math.abs(l)/i)+1)*i:0===c&&l===i-1&&(l=i-2,c=1),this.closed||l>0?o=n[(l-1)%i]:(Pl.subVectors(n[0],n[1]).add(n[0]),o=Pl);const u=n[l%i],h=n[(l+1)%i];if(this.closed||l+2<i?a=n[(l+2)%i]:(Pl.subVectors(n[i-1],n[i-2]).add(n[i-1]),a=Pl),"centripetal"===this.curveType||"chordal"===this.curveType){const e="chordal"===this.curveType?.5:.25;let t=Math.pow(o.distanceToSquared(u),e),r=Math.pow(u.distanceToSquared(h),e),n=Math.pow(h.distanceToSquared(a),e);r<1e-4&&(r=1),t<1e-4&&(t=r),n<1e-4&&(n=r),jl.initNonuniformCatmullRom(o.x,u.x,h.x,a.x,t,r,n),Il.initNonuniformCatmullRom(o.y,u.y,h.y,a.y,t,r,n),Dl.initNonuniformCatmullRom(o.z,u.z,h.z,a.z,t,r,n)}else"catmullrom"===this.curveType&&(jl.initCatmullRom(o.x,u.x,h.x,a.x,this.tension),Il.initCatmullRom(o.y,u.y,h.y,a.y,this.tension),Dl.initCatmullRom(o.z,u.z,h.z,a.z,this.tension));return r.set(jl.calc(c),Il.calc(c),Dl.calc(c)),r}copy(e){super.copy(e),this.points=[];for(let t=0,r=e.points.length;t<r;t++){const r=e.points[t];this.points.push(r.clone())}return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this}toJSON(){const e=super.toJSON();e.points=[];for(let t=0,r=this.points.length;t<r;t++){const r=this.points[t];e.points.push(r.toArray())}return e.closed=this.closed,e.curveType=this.curveType,e.tension=this.tension,e}fromJSON(e){super.fromJSON(e),this.points=[];for(let t=0,r=e.points.length;t<r;t++){const r=e.points[t];this.points.push((new $t).fromArray(r))}return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this}}function Nl(e,t,r,n,i){const s=.5*(n-t),o=.5*(i-r),a=e*e;return(2*r-2*n+s+o)*(e*a)+(-3*r+3*n-2*s-o)*a+s*e+r}function Ul(e,t,r,n){return function(e,t){const r=1-e;return r*r*t}(e,t)+function(e,t){return 2*(1-e)*e*t}(e,r)+function(e,t){return e*e*t}(e,n)}function kl(e,t,r,n,i){return function(e,t){const r=1-e;return r*r*r*t}(e,t)+function(e,t){const r=1-e;return 3*r*r*e*t}(e,r)+function(e,t){return 3*(1-e)*e*e*t}(e,n)+function(e,t){return e*e*e*t}(e,i)}class Fl extends Al{constructor(e=new Wt,t=new Wt,r=new Wt,n=new Wt){super(),this.isCubicBezierCurve=!0,this.type="CubicBezierCurve",this.v0=e,this.v1=t,this.v2=r,this.v3=n}getPoint(e,t=new Wt){const r=t,n=this.v0,i=this.v1,s=this.v2,o=this.v3;return r.set(kl(e,n.x,i.x,s.x,o.x),kl(e,n.y,i.y,s.y,o.y)),r}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e.v3=this.v3.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this.v3.fromArray(e.v3),this}}class Bl extends Al{constructor(e=new $t,t=new $t,r=new $t,n=new $t){super(),this.isCubicBezierCurve3=!0,this.type="CubicBezierCurve3",this.v0=e,this.v1=t,this.v2=r,this.v3=n}getPoint(e,t=new $t){const r=t,n=this.v0,i=this.v1,s=this.v2,o=this.v3;return r.set(kl(e,n.x,i.x,s.x,o.x),kl(e,n.y,i.y,s.y,o.y),kl(e,n.z,i.z,s.z,o.z)),r}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e.v3=this.v3.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this.v3.fromArray(e.v3),this}}class zl extends Al{constructor(e=new Wt,t=new Wt){super(),this.isLineCurve=!0,this.type="LineCurve",this.v1=e,this.v2=t}getPoint(e,t=new Wt){const r=t;return 1===e?r.copy(this.v2):(r.copy(this.v2).sub(this.v1),r.multiplyScalar(e).add(this.v1)),r}getPointAt(e,t){return this.getPoint(e,t)}getTangent(e,t=new Wt){return t.subVectors(this.v2,this.v1).normalize()}getTangentAt(e,t){return this.getTangent(e,t)}copy(e){return super.copy(e),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class Gl extends Al{constructor(e=new $t,t=new $t){super(),this.isLineCurve3=!0,this.type="LineCurve3",this.v1=e,this.v2=t}getPoint(e,t=new $t){const r=t;return 1===e?r.copy(this.v2):(r.copy(this.v2).sub(this.v1),r.multiplyScalar(e).add(this.v1)),r}getPointAt(e,t){return this.getPoint(e,t)}getTangent(e,t=new $t){return t.subVectors(this.v2,this.v1).normalize()}getTangentAt(e,t){return this.getTangent(e,t)}copy(e){return super.copy(e),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class Vl extends Al{constructor(e=new Wt,t=new Wt,r=new Wt){super(),this.isQuadraticBezierCurve=!0,this.type="QuadraticBezierCurve",this.v0=e,this.v1=t,this.v2=r}getPoint(e,t=new Wt){const r=t,n=this.v0,i=this.v1,s=this.v2;return r.set(Ul(e,n.x,i.x,s.x),Ul(e,n.y,i.y,s.y)),r}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class Hl extends Al{constructor(e=new $t,t=new $t,r=new $t){super(),this.isQuadraticBezierCurve3=!0,this.type="QuadraticBezierCurve3",this.v0=e,this.v1=t,this.v2=r}getPoint(e,t=new $t){const r=t,n=this.v0,i=this.v1,s=this.v2;return r.set(Ul(e,n.x,i.x,s.x),Ul(e,n.y,i.y,s.y),Ul(e,n.z,i.z,s.z)),r}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class Wl extends Al{constructor(e=[]){super(),this.isSplineCurve=!0,this.type="SplineCurve",this.points=e}getPoint(e,t=new Wt){const r=t,n=this.points,i=(n.length-1)*e,s=Math.floor(i),o=i-s,a=n[0===s?s:s-1],l=n[s],c=n[s>n.length-2?n.length-1:s+1],u=n[s>n.length-3?n.length-1:s+2];return r.set(Nl(o,a.x,l.x,c.x,u.x),Nl(o,a.y,l.y,c.y,u.y)),r}copy(e){super.copy(e),this.points=[];for(let t=0,r=e.points.length;t<r;t++){const r=e.points[t];this.points.push(r.clone())}return this}toJSON(){const e=super.toJSON();e.points=[];for(let t=0,r=this.points.length;t<r;t++){const r=this.points[t];e.points.push(r.toArray())}return e}fromJSON(e){super.fromJSON(e),this.points=[];for(let t=0,r=e.points.length;t<r;t++){const r=e.points[t];this.points.push((new Wt).fromArray(r))}return this}}var Xl=Object.freeze({__proto__:null,ArcCurve:Ll,CatmullRomCurve3:Ol,CubicBezierCurve:Fl,CubicBezierCurve3:Bl,EllipseCurve:Cl,LineCurve:zl,LineCurve3:Gl,QuadraticBezierCurve:Vl,QuadraticBezierCurve3:Hl,SplineCurve:Wl});class ql extends Al{constructor(){super(),this.type="CurvePath",this.curves=[],this.autoClose=!1}add(e){this.curves.push(e)}closePath(){const e=this.curves[0].getPoint(0),t=this.curves[this.curves.length-1].getPoint(1);e.equals(t)||this.curves.push(new zl(t,e))}getPoint(e,t){const r=e*this.getLength(),n=this.getCurveLengths();let i=0;for(;i<n.length;){if(n[i]>=r){const e=n[i]-r,s=this.curves[i],o=s.getLength(),a=0===o?0:1-e/o;return s.getPointAt(a,t)}i++}return null}getLength(){const e=this.getCurveLengths();return e[e.length-1]}updateArcLengths(){this.needsUpdate=!0,this.cacheLengths=null,this.getCurveLengths()}getCurveLengths(){if(this.cacheLengths&&this.cacheLengths.length===this.curves.length)return this.cacheLengths;const e=[];let t=0;for(let r=0,n=this.curves.length;r<n;r++)t+=this.curves[r].getLength(),e.push(t);return this.cacheLengths=e,e}getSpacedPoints(e=40){const t=[];for(let r=0;r<=e;r++)t.push(this.getPoint(r/e));return this.autoClose&&t.push(t[0]),t}getPoints(e=12){const t=[];let r;for(let n=0,i=this.curves;n<i.length;n++){const s=i[n],o=s.isEllipseCurve?2*e:s.isLineCurve||s.isLineCurve3?1:s.isSplineCurve?e*s.points.length:e,a=s.getPoints(o);for(let e=0;e<a.length;e++){const n=a[e];r&&r.equals(n)||(t.push(n),r=n)}}return this.autoClose&&t.length>1&&!t[t.length-1].equals(t[0])&&t.push(t[0]),t}copy(e){super.copy(e),this.curves=[];for(let t=0,r=e.curves.length;t<r;t++){const r=e.curves[t];this.curves.push(r.clone())}return this.autoClose=e.autoClose,this}toJSON(){const e=super.toJSON();e.autoClose=this.autoClose,e.curves=[];for(let t=0,r=this.curves.length;t<r;t++){const r=this.curves[t];e.curves.push(r.toJSON())}return e}fromJSON(e){super.fromJSON(e),this.autoClose=e.autoClose,this.curves=[];for(let t=0,r=e.curves.length;t<r;t++){const r=e.curves[t];this.curves.push((new Xl[r.type]).fromJSON(r))}return this}}class Yl extends ql{constructor(e){super(),this.type="Path",this.currentPoint=new Wt,e&&this.setFromPoints(e)}setFromPoints(e){this.moveTo(e[0].x,e[0].y);for(let t=1,r=e.length;t<r;t++)this.lineTo(e[t].x,e[t].y);return this}moveTo(e,t){return this.currentPoint.set(e,t),this}lineTo(e,t){const r=new zl(this.currentPoint.clone(),new Wt(e,t));return this.curves.push(r),this.currentPoint.set(e,t),this}quadraticCurveTo(e,t,r,n){const i=new Vl(this.currentPoint.clone(),new Wt(e,t),new Wt(r,n));return this.curves.push(i),this.currentPoint.set(r,n),this}bezierCurveTo(e,t,r,n,i,s){const o=new Fl(this.currentPoint.clone(),new Wt(e,t),new Wt(r,n),new Wt(i,s));return this.curves.push(o),this.currentPoint.set(i,s),this}splineThru(e){const t=[this.currentPoint.clone()].concat(e),r=new Wl(t);return this.curves.push(r),this.currentPoint.copy(e[e.length-1]),this}arc(e,t,r,n,i,s){const o=this.currentPoint.x,a=this.currentPoint.y;return this.absarc(e+o,t+a,r,n,i,s),this}absarc(e,t,r,n,i,s){return this.absellipse(e,t,r,r,n,i,s),this}ellipse(e,t,r,n,i,s,o,a){const l=this.currentPoint.x,c=this.currentPoint.y;return this.absellipse(e+l,t+c,r,n,i,s,o,a),this}absellipse(e,t,r,n,i,s,o,a){const l=new Cl(e,t,r,n,i,s,o,a);if(this.curves.length>0){const e=l.getPoint(0);e.equals(this.currentPoint)||this.lineTo(e.x,e.y)}this.curves.push(l);const c=l.getPoint(1);return this.currentPoint.copy(c),this}copy(e){return super.copy(e),this.currentPoint.copy(e.currentPoint),this}toJSON(){const e=super.toJSON();return e.currentPoint=this.currentPoint.toArray(),e}fromJSON(e){return super.fromJSON(e),this.currentPoint.fromArray(e.currentPoint),this}}class Zl extends $n{constructor(e=[new Wt(0,-.5),new Wt(.5,0),new Wt(0,.5)],t=12,r=0,n=2*Math.PI){super(),this.type="LatheGeometry",this.parameters={points:e,segments:t,phiStart:r,phiLength:n},t=Math.floor(t),n=Nt(n,0,2*Math.PI);const i=[],s=[],o=[],a=[],l=[],c=1/t,u=new $t,h=new Wt,d=new $t,p=new $t,f=new $t;let m=0,g=0;for(let t=0;t<=e.length-1;t++)switch(t){case 0:m=e[t+1].x-e[t].x,g=e[t+1].y-e[t].y,d.x=1*g,d.y=-m,d.z=0*g,f.copy(d),d.normalize(),a.push(d.x,d.y,d.z);break;case e.length-1:a.push(f.x,f.y,f.z);break;default:m=e[t+1].x-e[t].x,g=e[t+1].y-e[t].y,d.x=1*g,d.y=-m,d.z=0*g,p.copy(d),d.x+=f.x,d.y+=f.y,d.z+=f.z,d.normalize(),a.push(d.x,d.y,d.z),f.copy(p)}for(let i=0;i<=t;i++){const d=r+i*c*n,p=Math.sin(d),f=Math.cos(d);for(let r=0;r<=e.length-1;r++){u.x=e[r].x*p,u.y=e[r].y,u.z=e[r].x*f,s.push(u.x,u.y,u.z),h.x=i/t,h.y=r/(e.length-1),o.push(h.x,h.y);const n=a[3*r+0]*p,c=a[3*r+1],d=a[3*r+0]*f;l.push(n,c,d)}}for(let r=0;r<t;r++)for(let t=0;t<e.length-1;t++){const n=t+r*e.length,s=n,o=n+e.length,a=n+e.length+1,l=n+1;i.push(s,o,l),i.push(a,l,o)}this.setIndex(i),this.setAttribute("position",new Wn(s,3)),this.setAttribute("uv",new Wn(o,2)),this.setAttribute("normal",new Wn(l,3))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new Zl(e.points,e.segments,e.phiStart,e.phiLength)}}class Jl extends Zl{constructor(e=1,t=1,r=4,n=8){const i=new Yl;i.absarc(0,-t/2,e,1.5*Math.PI,0),i.absarc(0,t/2,e,0,.5*Math.PI),super(i.getPoints(r),n),this.type="CapsuleGeometry",this.parameters={radius:e,height:t,capSegments:r,radialSegments:n}}static fromJSON(e){return new Jl(e.radius,e.length,e.capSegments,e.radialSegments)}}class Kl extends $n{constructor(e=1,t=32,r=0,n=2*Math.PI){super(),this.type="CircleGeometry",this.parameters={radius:e,segments:t,thetaStart:r,thetaLength:n},t=Math.max(3,t);const i=[],s=[],o=[],a=[],l=new $t,c=new Wt;s.push(0,0,0),o.push(0,0,1),a.push(.5,.5);for(let i=0,u=3;i<=t;i++,u+=3){const h=r+i/t*n;l.x=e*Math.cos(h),l.y=e*Math.sin(h),s.push(l.x,l.y,l.z),o.push(0,0,1),c.x=(s[u]/e+1)/2,c.y=(s[u+1]/e+1)/2,a.push(c.x,c.y)}for(let e=1;e<=t;e++)i.push(e,e+1,0);this.setIndex(i),this.setAttribute("position",new Wn(s,3)),this.setAttribute("normal",new Wn(o,3)),this.setAttribute("uv",new Wn(a,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new Kl(e.radius,e.segments,e.thetaStart,e.thetaLength)}}class Ql extends $n{constructor(e=1,t=1,r=1,n=32,i=1,s=!1,o=0,a=2*Math.PI){super(),this.type="CylinderGeometry",this.parameters={radiusTop:e,radiusBottom:t,height:r,radialSegments:n,heightSegments:i,openEnded:s,thetaStart:o,thetaLength:a};const l=this;n=Math.floor(n),i=Math.floor(i);const c=[],u=[],h=[],d=[];let p=0;const f=[],m=r/2;let g=0;function y(r){const i=p,s=new Wt,f=new $t;let y=0;const v=!0===r?e:t,_=!0===r?1:-1;for(let e=1;e<=n;e++)u.push(0,m*_,0),h.push(0,_,0),d.push(.5,.5),p++;const x=p;for(let e=0;e<=n;e++){const t=e/n*a+o,r=Math.cos(t),i=Math.sin(t);f.x=v*i,f.y=m*_,f.z=v*r,u.push(f.x,f.y,f.z),h.push(0,_,0),s.x=.5*r+.5,s.y=.5*i*_+.5,d.push(s.x,s.y),p++}for(let e=0;e<n;e++){const t=i+e,n=x+e;!0===r?c.push(n,n+1,t):c.push(n+1,n,t),y+=3}l.addGroup(g,y,!0===r?1:2),g+=y}!function(){const s=new $t,y=new $t;let v=0;const _=(t-e)/r;for(let l=0;l<=i;l++){const c=[],g=l/i,v=g*(t-e)+e;for(let e=0;e<=n;e++){const t=e/n,i=t*a+o,l=Math.sin(i),f=Math.cos(i);y.x=v*l,y.y=-g*r+m,y.z=v*f,u.push(y.x,y.y,y.z),s.set(l,_,f).normalize(),h.push(s.x,s.y,s.z),d.push(t,1-g),c.push(p++)}f.push(c)}for(let e=0;e<n;e++)for(let t=0;t<i;t++){const r=f[t][e],n=f[t+1][e],i=f[t+1][e+1],s=f[t][e+1];c.push(r,n,s),c.push(n,i,s),v+=6}l.addGroup(g,v,0),g+=v}(),!1===s&&(e>0&&y(!0),t>0&&y(!1)),this.setIndex(c),this.setAttribute("position",new Wn(u,3)),this.setAttribute("normal",new Wn(h,3)),this.setAttribute("uv",new Wn(d,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new Ql(e.radiusTop,e.radiusBottom,e.height,e.radialSegments,e.heightSegments,e.openEnded,e.thetaStart,e.thetaLength)}}class $l extends Ql{constructor(e=1,t=1,r=32,n=1,i=!1,s=0,o=2*Math.PI){super(0,e,t,r,n,i,s,o),this.type="ConeGeometry",this.parameters={radius:e,height:t,radialSegments:r,heightSegments:n,openEnded:i,thetaStart:s,thetaLength:o}}static fromJSON(e){return new $l(e.radius,e.height,e.radialSegments,e.heightSegments,e.openEnded,e.thetaStart,e.thetaLength)}}class ec extends $n{constructor(e=[],t=[],r=1,n=0){super(),this.type="PolyhedronGeometry",this.parameters={vertices:e,indices:t,radius:r,detail:n};const i=[],s=[];function o(e,t,r,n){const i=n+1,s=[];for(let n=0;n<=i;n++){s[n]=[];const o=e.clone().lerp(r,n/i),a=t.clone().lerp(r,n/i),l=i-n;for(let e=0;e<=l;e++)s[n][e]=0===e&&n===i?o:o.clone().lerp(a,e/l)}for(let e=0;e<i;e++)for(let t=0;t<2*(i-e)-1;t++){const r=Math.floor(t/2);t%2==0?(a(s[e][r+1]),a(s[e+1][r]),a(s[e][r])):(a(s[e][r+1]),a(s[e+1][r+1]),a(s[e+1][r]))}}function a(e){i.push(e.x,e.y,e.z)}function l(t,r){const n=3*t;r.x=e[n+0],r.y=e[n+1],r.z=e[n+2]}function c(e,t,r,n){n<0&&1===e.x&&(s[t]=e.x-1),0===r.x&&0===r.z&&(s[t]=n/2/Math.PI+.5)}function u(e){return Math.atan2(e.z,-e.x)}!function(e){const r=new $t,n=new $t,i=new $t;for(let s=0;s<t.length;s+=3)l(t[s+0],r),l(t[s+1],n),l(t[s+2],i),o(r,n,i,e)}(n),function(e){const t=new $t;for(let r=0;r<i.length;r+=3)t.x=i[r+0],t.y=i[r+1],t.z=i[r+2],t.normalize().multiplyScalar(e),i[r+0]=t.x,i[r+1]=t.y,i[r+2]=t.z}(r),function(){const e=new $t;for(let r=0;r<i.length;r+=3){e.x=i[r+0],e.y=i[r+1],e.z=i[r+2];const n=u(e)/2/Math.PI+.5,o=(t=e,Math.atan2(-t.y,Math.sqrt(t.x*t.x+t.z*t.z))/Math.PI+.5);s.push(n,1-o)}var t;(function(){const e=new $t,t=new $t,r=new $t,n=new $t,o=new Wt,a=new Wt,l=new Wt;for(let h=0,d=0;h<i.length;h+=9,d+=6){e.set(i[h+0],i[h+1],i[h+2]),t.set(i[h+3],i[h+4],i[h+5]),r.set(i[h+6],i[h+7],i[h+8]),o.set(s[d+0],s[d+1]),a.set(s[d+2],s[d+3]),l.set(s[d+4],s[d+5]),n.copy(e).add(t).add(r).divideScalar(3);const p=u(n);c(o,d+0,e,p),c(a,d+2,t,p),c(l,d+4,r,p)}})(),function(){for(let e=0;e<s.length;e+=6){const t=s[e+0],r=s[e+2],n=s[e+4],i=Math.max(t,r,n),o=Math.min(t,r,n);i>.9&&o<.1&&(t<.2&&(s[e+0]+=1),r<.2&&(s[e+2]+=1),n<.2&&(s[e+4]+=1))}}()}(),this.setAttribute("position",new Wn(i,3)),this.setAttribute("normal",new Wn(i.slice(),3)),this.setAttribute("uv",new Wn(s,2)),0===n?this.computeVertexNormals():this.normalizeNormals()}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new ec(e.vertices,e.indices,e.radius,e.details)}}class tc extends ec{constructor(e=1,t=0){const r=(1+Math.sqrt(5))/2,n=1/r;super([-1,-1,-1,-1,-1,1,-1,1,-1,-1,1,1,1,-1,-1,1,-1,1,1,1,-1,1,1,1,0,-n,-r,0,-n,r,0,n,-r,0,n,r,-n,-r,0,-n,r,0,n,-r,0,n,r,0,-r,0,-n,r,0,-n,-r,0,n,r,0,n],[3,11,7,3,7,15,3,15,13,7,19,17,7,17,6,7,6,15,17,4,8,17,8,10,17,10,6,8,0,16,8,16,2,8,2,10,0,12,1,0,1,18,0,18,16,6,10,2,6,2,13,6,13,15,2,16,18,2,18,3,2,3,13,18,1,9,18,9,11,18,11,3,4,14,12,4,12,0,4,0,8,11,9,5,11,5,19,11,19,7,19,5,14,19,14,4,19,4,17,1,12,14,1,14,5,1,5,9],e,t),this.type="DodecahedronGeometry",this.parameters={radius:e,detail:t}}static fromJSON(e){return new tc(e.radius,e.detail)}}const rc=new $t,nc=new $t,ic=new $t,sc=new Rn;class oc extends $n{constructor(e=null,t=1){if(super(),this.type="EdgesGeometry",this.parameters={geometry:e,thresholdAngle:t},null!==e){const r=4,n=Math.pow(10,r),i=Math.cos(It*t),s=e.getIndex(),o=e.getAttribute("position"),a=s?s.count:o.count,l=[0,0,0],c=["a","b","c"],u=new Array(3),h={},d=[];for(let e=0;e<a;e+=3){s?(l[0]=s.getX(e),l[1]=s.getX(e+1),l[2]=s.getX(e+2)):(l[0]=e,l[1]=e+1,l[2]=e+2);const{a:t,b:r,c:a}=sc;if(t.fromBufferAttribute(o,l[0]),r.fromBufferAttribute(o,l[1]),a.fromBufferAttribute(o,l[2]),sc.getNormal(ic),u[0]=`${Math.round(t.x*n)},${Math.round(t.y*n)},${Math.round(t.z*n)}`,u[1]=`${Math.round(r.x*n)},${Math.round(r.y*n)},${Math.round(r.z*n)}`,u[2]=`${Math.round(a.x*n)},${Math.round(a.y*n)},${Math.round(a.z*n)}`,u[0]!==u[1]&&u[1]!==u[2]&&u[2]!==u[0])for(let e=0;e<3;e++){const t=(e+1)%3,r=u[e],n=u[t],s=sc[c[e]],o=sc[c[t]],a=`${r}_${n}`,p=`${n}_${r}`;p in h&&h[p]?(ic.dot(h[p].normal)<=i&&(d.push(s.x,s.y,s.z),d.push(o.x,o.y,o.z)),h[p]=null):a in h||(h[a]={index0:l[e],index1:l[t],normal:ic.clone()})}}for(const e in h)if(h[e]){const{index0:t,index1:r}=h[e];rc.fromBufferAttribute(o,t),nc.fromBufferAttribute(o,r),d.push(rc.x,rc.y,rc.z),d.push(nc.x,nc.y,nc.z)}this.setAttribute("position",new Wn(d,3))}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}}class ac extends Yl{constructor(e){super(e),this.uuid=Ot(),this.type="Shape",this.holes=[]}getPointsHoles(e){const t=[];for(let r=0,n=this.holes.length;r<n;r++)t[r]=this.holes[r].getPoints(e);return t}extractPoints(e){return{shape:this.getPoints(e),holes:this.getPointsHoles(e)}}copy(e){super.copy(e),this.holes=[];for(let t=0,r=e.holes.length;t<r;t++){const r=e.holes[t];this.holes.push(r.clone())}return this}toJSON(){const e=super.toJSON();e.uuid=this.uuid,e.holes=[];for(let t=0,r=this.holes.length;t<r;t++){const r=this.holes[t];e.holes.push(r.toJSON())}return e}fromJSON(e){super.fromJSON(e),this.uuid=e.uuid,this.holes=[];for(let t=0,r=e.holes.length;t<r;t++){const r=e.holes[t];this.holes.push((new Yl).fromJSON(r))}return this}}const lc=function(e,t,r=2){const n=t&&t.length,i=n?t[0]*r:e.length;let s=cc(e,0,i,r,!0);const o=[];if(!s||s.next===s.prev)return o;let a,l,c,u,h,d,p;if(n&&(s=function(e,t,r,n){const i=[];let s,o,a,l,c;for(s=0,o=t.length;s<o;s++)a=t[s]*n,l=s<o-1?t[s+1]*n:e.length,c=cc(e,a,l,n,!1),c===c.next&&(c.steiner=!0),i.push(xc(c));for(i.sort(gc),s=0;s<i.length;s++)r=yc(i[s],r);return r}(e,t,s,r)),e.length>80*r){a=c=e[0],l=u=e[1];for(let t=r;t<i;t+=r)h=e[t],d=e[t+1],h<a&&(a=h),d<l&&(l=d),h>c&&(c=h),d>u&&(u=d);p=Math.max(c-a,u-l),p=0!==p?32767/p:0}return hc(s,o,r,a,l,p,0),o};function cc(e,t,r,n,i){let s,o;if(i===function(e,t,r,n){let i=0;for(let s=t,o=r-n;s<r;s+=n)i+=(e[o]-e[s])*(e[s+1]+e[o+1]),o=s;return i}(e,t,r,n)>0)for(s=t;s<r;s+=n)o=Rc(s,e[s],e[s+1],o);else for(s=r-n;s>=t;s-=n)o=Rc(s,e[s],e[s+1],o);return o&&Mc(o,o.next)&&(Pc(o),o=o.next),o}function uc(e,t){if(!e)return e;t||(t=e);let r,n=e;do{if(r=!1,n.steiner||!Mc(n,n.next)&&0!==Sc(n.prev,n,n.next))n=n.next;else{if(Pc(n),n=t=n.prev,n===n.next)break;r=!0}}while(r||n!==t);return t}function hc(e,t,r,n,i,s,o){if(!e)return;!o&&s&&function(e,t,r,n){let i=e;do{0===i.z&&(i.z=_c(i.x,i.y,t,r,n)),i.prevZ=i.prev,i.nextZ=i.next,i=i.next}while(i!==e);i.prevZ.nextZ=null,i.prevZ=null,function(e){let t,r,n,i,s,o,a,l,c=1;do{for(r=e,e=null,s=null,o=0;r;){for(o++,n=r,a=0,t=0;t<c&&(a++,n=n.nextZ,n);t++);for(l=c;a>0||l>0&&n;)0!==a&&(0===l||!n||r.z<=n.z)?(i=r,r=r.nextZ,a--):(i=n,n=n.nextZ,l--),s?s.nextZ=i:e=i,i.prevZ=s,s=i;r=n}s.nextZ=null,c*=2}while(o>1)}(i)}(e,n,i,s);let a,l,c=e;for(;e.prev!==e.next;)if(a=e.prev,l=e.next,s?pc(e,n,i,s):dc(e))t.push(a.i/r|0),t.push(e.i/r|0),t.push(l.i/r|0),Pc(e),e=l.next,c=l.next;else if((e=l)===c){o?1===o?hc(e=fc(uc(e),t,r),t,r,n,i,s,2):2===o&&mc(e,t,r,n,i,s):hc(uc(e),t,r,n,i,s,1);break}}function dc(e){const t=e.prev,r=e,n=e.next;if(Sc(t,r,n)>=0)return!1;const i=t.x,s=r.x,o=n.x,a=t.y,l=r.y,c=n.y,u=i<s?i<o?i:o:s<o?s:o,h=a<l?a<c?a:c:l<c?l:c,d=i>s?i>o?i:o:s>o?s:o,p=a>l?a>c?a:c:l>c?l:c;let f=n.next;for(;f!==t;){if(f.x>=u&&f.x<=d&&f.y>=h&&f.y<=p&&bc(i,a,s,l,o,c,f.x,f.y)&&Sc(f.prev,f,f.next)>=0)return!1;f=f.next}return!0}function pc(e,t,r,n){const i=e.prev,s=e,o=e.next;if(Sc(i,s,o)>=0)return!1;const a=i.x,l=s.x,c=o.x,u=i.y,h=s.y,d=o.y,p=a<l?a<c?a:c:l<c?l:c,f=u<h?u<d?u:d:h<d?h:d,m=a>l?a>c?a:c:l>c?l:c,g=u>h?u>d?u:d:h>d?h:d,y=_c(p,f,t,r,n),v=_c(m,g,t,r,n);let _=e.prevZ,x=e.nextZ;for(;_&&_.z>=y&&x&&x.z<=v;){if(_.x>=p&&_.x<=m&&_.y>=f&&_.y<=g&&_!==i&&_!==o&&bc(a,u,l,h,c,d,_.x,_.y)&&Sc(_.prev,_,_.next)>=0)return!1;if(_=_.prevZ,x.x>=p&&x.x<=m&&x.y>=f&&x.y<=g&&x!==i&&x!==o&&bc(a,u,l,h,c,d,x.x,x.y)&&Sc(x.prev,x,x.next)>=0)return!1;x=x.nextZ}for(;_&&_.z>=y;){if(_.x>=p&&_.x<=m&&_.y>=f&&_.y<=g&&_!==i&&_!==o&&bc(a,u,l,h,c,d,_.x,_.y)&&Sc(_.prev,_,_.next)>=0)return!1;_=_.prevZ}for(;x&&x.z<=v;){if(x.x>=p&&x.x<=m&&x.y>=f&&x.y<=g&&x!==i&&x!==o&&bc(a,u,l,h,c,d,x.x,x.y)&&Sc(x.prev,x,x.next)>=0)return!1;x=x.nextZ}return!0}function fc(e,t,r){let n=e;do{const i=n.prev,s=n.next.next;!Mc(i,s)&&Tc(i,n,n.next,s)&&Cc(i,s)&&Cc(s,i)&&(t.push(i.i/r|0),t.push(n.i/r|0),t.push(s.i/r|0),Pc(n),Pc(n.next),n=e=s),n=n.next}while(n!==e);return uc(n)}function mc(e,t,r,n,i,s){let o=e;do{let e=o.next.next;for(;e!==o.prev;){if(o.i!==e.i&&wc(o,e)){let a=Lc(o,e);return o=uc(o,o.next),a=uc(a,a.next),hc(o,t,r,n,i,s,0),void hc(a,t,r,n,i,s,0)}e=e.next}o=o.next}while(o!==e)}function gc(e,t){return e.x-t.x}function yc(e,t){const r=function(e,t){let r,n=t,i=-1/0;const s=e.x,o=e.y;do{if(o<=n.y&&o>=n.next.y&&n.next.y!==n.y){const e=n.x+(o-n.y)*(n.next.x-n.x)/(n.next.y-n.y);if(e<=s&&e>i&&(i=e,r=n.x<n.next.x?n:n.next,e===s))return r}n=n.next}while(n!==t);if(!r)return null;const a=r,l=r.x,c=r.y;let u,h=1/0;n=r;do{s>=n.x&&n.x>=l&&s!==n.x&&bc(o<c?s:i,o,l,c,o<c?i:s,o,n.x,n.y)&&(u=Math.abs(o-n.y)/(s-n.x),Cc(n,e)&&(u<h||u===h&&(n.x>r.x||n.x===r.x&&vc(r,n)))&&(r=n,h=u)),n=n.next}while(n!==a);return r}(e,t);if(!r)return t;const n=Lc(r,e);return uc(n,n.next),uc(r,r.next)}function vc(e,t){return Sc(e.prev,e,t.prev)<0&&Sc(t.next,e,e.next)<0}function _c(e,t,r,n,i){return(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=(e-r)*i|0)|e<<8))|e<<4))|e<<2))|e<<1))|(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=(t-n)*i|0)|t<<8))|t<<4))|t<<2))|t<<1))<<1}function xc(e){let t=e,r=e;do{(t.x<r.x||t.x===r.x&&t.y<r.y)&&(r=t),t=t.next}while(t!==e);return r}function bc(e,t,r,n,i,s,o,a){return(i-o)*(t-a)>=(e-o)*(s-a)&&(e-o)*(n-a)>=(r-o)*(t-a)&&(r-o)*(s-a)>=(i-o)*(n-a)}function wc(e,t){return e.next.i!==t.i&&e.prev.i!==t.i&&!function(e,t){let r=e;do{if(r.i!==e.i&&r.next.i!==e.i&&r.i!==t.i&&r.next.i!==t.i&&Tc(r,r.next,e,t))return!0;r=r.next}while(r!==e);return!1}(e,t)&&(Cc(e,t)&&Cc(t,e)&&function(e,t){let r=e,n=!1;const i=(e.x+t.x)/2,s=(e.y+t.y)/2;do{r.y>s!=r.next.y>s&&r.next.y!==r.y&&i<(r.next.x-r.x)*(s-r.y)/(r.next.y-r.y)+r.x&&(n=!n),r=r.next}while(r!==e);return n}(e,t)&&(Sc(e.prev,e,t.prev)||Sc(e,t.prev,t))||Mc(e,t)&&Sc(e.prev,e,e.next)>0&&Sc(t.prev,t,t.next)>0)}function Sc(e,t,r){return(t.y-e.y)*(r.x-t.x)-(t.x-e.x)*(r.y-t.y)}function Mc(e,t){return e.x===t.x&&e.y===t.y}function Tc(e,t,r,n){const i=Ac(Sc(e,t,r)),s=Ac(Sc(e,t,n)),o=Ac(Sc(r,n,e)),a=Ac(Sc(r,n,t));return i!==s&&o!==a||(!(0!==i||!Ec(e,r,t))||(!(0!==s||!Ec(e,n,t))||(!(0!==o||!Ec(r,e,n))||!(0!==a||!Ec(r,t,n)))))}function Ec(e,t,r){return t.x<=Math.max(e.x,r.x)&&t.x>=Math.min(e.x,r.x)&&t.y<=Math.max(e.y,r.y)&&t.y>=Math.min(e.y,r.y)}function Ac(e){return e>0?1:e<0?-1:0}function Cc(e,t){return Sc(e.prev,e,e.next)<0?Sc(e,t,e.next)>=0&&Sc(e,e.prev,t)>=0:Sc(e,t,e.prev)<0||Sc(e,e.next,t)<0}function Lc(e,t){const r=new jc(e.i,e.x,e.y),n=new jc(t.i,t.x,t.y),i=e.next,s=t.prev;return e.next=t,t.prev=e,r.next=i,i.prev=r,n.next=r,r.prev=n,s.next=n,n.prev=s,n}function Rc(e,t,r,n){const i=new jc(e,t,r);return n?(i.next=n.next,i.prev=n,n.next.prev=i,n.next=i):(i.prev=i,i.next=i),i}function Pc(e){e.next.prev=e.prev,e.prev.next=e.next,e.prevZ&&(e.prevZ.nextZ=e.nextZ),e.nextZ&&(e.nextZ.prevZ=e.prevZ)}function jc(e,t,r){this.i=e,this.x=t,this.y=r,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}class Ic{static area(e){const t=e.length;let r=0;for(let n=t-1,i=0;i<t;n=i++)r+=e[n].x*e[i].y-e[i].x*e[n].y;return.5*r}static isClockWise(e){return Ic.area(e)<0}static triangulateShape(e,t){const r=[],n=[],i=[];Dc(e),Oc(r,e);let s=e.length;t.forEach(Dc);for(let e=0;e<t.length;e++)n.push(s),s+=t[e].length,Oc(r,t[e]);const o=lc(r,n);for(let e=0;e<o.length;e+=3)i.push(o.slice(e,e+3));return i}}function Dc(e){const t=e.length;t>2&&e[t-1].equals(e[0])&&e.pop()}function Oc(e,t){for(let r=0;r<t.length;r++)e.push(t[r].x),e.push(t[r].y)}class Nc extends $n{constructor(e=new ac([new Wt(.5,.5),new Wt(-.5,.5),new Wt(-.5,-.5),new Wt(.5,-.5)]),t={}){super(),this.type="ExtrudeGeometry",this.parameters={shapes:e,options:t},e=Array.isArray(e)?e:[e];const r=this,n=[],i=[];for(let t=0,r=e.length;t<r;t++){s(e[t])}function s(e){const s=[],o=void 0!==t.curveSegments?t.curveSegments:12,a=void 0!==t.steps?t.steps:1,l=void 0!==t.depth?t.depth:1;let c=void 0===t.bevelEnabled||t.bevelEnabled,u=void 0!==t.bevelThickness?t.bevelThickness:.2,h=void 0!==t.bevelSize?t.bevelSize:u-.1,d=void 0!==t.bevelOffset?t.bevelOffset:0,p=void 0!==t.bevelSegments?t.bevelSegments:3;const f=t.extrudePath,m=void 0!==t.UVGenerator?t.UVGenerator:Uc;let g,y,v,_,x,b=!1;f&&(g=f.getSpacedPoints(a),b=!0,c=!1,y=f.computeFrenetFrames(a,!1),v=new $t,_=new $t,x=new $t),c||(p=0,u=0,h=0,d=0);const w=e.extractPoints(o);let S=w.shape;const M=w.holes;if(!Ic.isClockWise(S)){S=S.reverse();for(let e=0,t=M.length;e<t;e++){const t=M[e];Ic.isClockWise(t)&&(M[e]=t.reverse())}}const T=Ic.triangulateShape(S,M),E=S;for(let e=0,t=M.length;e<t;e++){const t=M[e];S=S.concat(t)}function A(e,t,r){return e.clone().addScaledVector(t,r)}const C=S.length,L=T.length;function R(e,t,r){let n,i,s;const o=e.x-t.x,a=e.y-t.y,l=r.x-e.x,c=r.y-e.y,u=o*o+a*a,h=o*c-a*l;if(Math.abs(h)>Number.EPSILON){const h=Math.sqrt(u),d=Math.sqrt(l*l+c*c),p=t.x-a/h,f=t.y+o/h,m=((r.x-c/d-p)*c-(r.y+l/d-f)*l)/(o*c-a*l);n=p+o*m-e.x,i=f+a*m-e.y;const g=n*n+i*i;if(g<=2)return new Wt(n,i);s=Math.sqrt(g/2)}else{let e=!1;o>Number.EPSILON?l>Number.EPSILON&&(e=!0):o<-Number.EPSILON?l<-Number.EPSILON&&(e=!0):Math.sign(a)===Math.sign(c)&&(e=!0),e?(n=-a,i=o,s=Math.sqrt(u)):(n=o,i=a,s=Math.sqrt(u/2))}return new Wt(n/s,i/s)}const P=[];for(let e=0,t=E.length,r=t-1,n=e+1;e<t;e++,r++,n++)r===t&&(r=0),n===t&&(n=0),P[e]=R(E[e],E[r],E[n]);const j=[];let I,D=P.concat();for(let e=0,t=M.length;e<t;e++){const t=M[e];I=[];for(let e=0,r=t.length,n=r-1,i=e+1;e<r;e++,n++,i++)n===r&&(n=0),i===r&&(i=0),I[e]=R(t[e],t[n],t[i]);j.push(I),D=D.concat(I)}for(let e=0;e<p;e++){const t=e/p,r=u*Math.cos(t*Math.PI/2),n=h*Math.sin(t*Math.PI/2)+d;for(let e=0,t=E.length;e<t;e++){const t=A(E[e],P[e],n);U(t.x,t.y,-r)}for(let e=0,t=M.length;e<t;e++){const t=M[e];I=j[e];for(let e=0,i=t.length;e<i;e++){const i=A(t[e],I[e],n);U(i.x,i.y,-r)}}}const O=h+d;for(let e=0;e<C;e++){const t=c?A(S[e],D[e],O):S[e];b?(_.copy(y.normals[0]).multiplyScalar(t.x),v.copy(y.binormals[0]).multiplyScalar(t.y),x.copy(g[0]).add(_).add(v),U(x.x,x.y,x.z)):U(t.x,t.y,0)}for(let e=1;e<=a;e++)for(let t=0;t<C;t++){const r=c?A(S[t],D[t],O):S[t];b?(_.copy(y.normals[e]).multiplyScalar(r.x),v.copy(y.binormals[e]).multiplyScalar(r.y),x.copy(g[e]).add(_).add(v),U(x.x,x.y,x.z)):U(r.x,r.y,l/a*e)}for(let e=p-1;e>=0;e--){const t=e/p,r=u*Math.cos(t*Math.PI/2),n=h*Math.sin(t*Math.PI/2)+d;for(let e=0,t=E.length;e<t;e++){const t=A(E[e],P[e],n);U(t.x,t.y,l+r)}for(let e=0,t=M.length;e<t;e++){const t=M[e];I=j[e];for(let e=0,i=t.length;e<i;e++){const i=A(t[e],I[e],n);b?U(i.x,i.y+g[a-1].y,g[a-1].x+r):U(i.x,i.y,l+r)}}}function N(e,t){let r=e.length;for(;--r>=0;){const n=r;let i=r-1;i<0&&(i=e.length-1);for(let e=0,r=a+2*p;e<r;e++){const r=C*e,s=C*(e+1);F(t+n+r,t+i+r,t+i+s,t+n+s)}}}function U(e,t,r){s.push(e),s.push(t),s.push(r)}function k(e,t,i){B(e),B(t),B(i);const s=n.length/3,o=m.generateTopUV(r,n,s-3,s-2,s-1);z(o[0]),z(o[1]),z(o[2])}function F(e,t,i,s){B(e),B(t),B(s),B(t),B(i),B(s);const o=n.length/3,a=m.generateSideWallUV(r,n,o-6,o-3,o-2,o-1);z(a[0]),z(a[1]),z(a[3]),z(a[1]),z(a[2]),z(a[3])}function B(e){n.push(s[3*e+0]),n.push(s[3*e+1]),n.push(s[3*e+2])}function z(e){i.push(e.x),i.push(e.y)}!function(){const e=n.length/3;if(c){let e=0,t=C*e;for(let e=0;e<L;e++){const r=T[e];k(r[2]+t,r[1]+t,r[0]+t)}e=a+2*p,t=C*e;for(let e=0;e<L;e++){const r=T[e];k(r[0]+t,r[1]+t,r[2]+t)}}else{for(let e=0;e<L;e++){const t=T[e];k(t[2],t[1],t[0])}for(let e=0;e<L;e++){const t=T[e];k(t[0]+C*a,t[1]+C*a,t[2]+C*a)}}r.addGroup(e,n.length/3-e,0)}(),function(){const e=n.length/3;let t=0;N(E,t),t+=E.length;for(let e=0,r=M.length;e<r;e++){const r=M[e];N(r,t),t+=r.length}r.addGroup(e,n.length/3-e,1)}()}this.setAttribute("position",new Wn(n,3)),this.setAttribute("uv",new Wn(i,2)),this.computeVertexNormals()}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}toJSON(){const e=super.toJSON();return function(e,t,r){if(r.shapes=[],Array.isArray(e))for(let t=0,n=e.length;t<n;t++){const n=e[t];r.shapes.push(n.uuid)}else r.shapes.push(e.uuid);r.options=Object.assign({},t),void 0!==t.extrudePath&&(r.options.extrudePath=t.extrudePath.toJSON());return r}(this.parameters.shapes,this.parameters.options,e)}static fromJSON(e,t){const r=[];for(let n=0,i=e.shapes.length;n<i;n++){const i=t[e.shapes[n]];r.push(i)}const n=e.options.extrudePath;return void 0!==n&&(e.options.extrudePath=(new Xl[n.type]).fromJSON(n)),new Nc(r,e.options)}}const Uc={generateTopUV:function(e,t,r,n,i){const s=t[3*r],o=t[3*r+1],a=t[3*n],l=t[3*n+1],c=t[3*i],u=t[3*i+1];return[new Wt(s,o),new Wt(a,l),new Wt(c,u)]},generateSideWallUV:function(e,t,r,n,i,s){const o=t[3*r],a=t[3*r+1],l=t[3*r+2],c=t[3*n],u=t[3*n+1],h=t[3*n+2],d=t[3*i],p=t[3*i+1],f=t[3*i+2],m=t[3*s],g=t[3*s+1],y=t[3*s+2];return Math.abs(a-u)<Math.abs(o-c)?[new Wt(o,1-l),new Wt(c,1-h),new Wt(d,1-f),new Wt(m,1-y)]:[new Wt(a,1-l),new Wt(u,1-h),new Wt(p,1-f),new Wt(g,1-y)]}};class kc extends ec{constructor(e=1,t=0){const r=(1+Math.sqrt(5))/2;super([-1,r,0,1,r,0,-1,-r,0,1,-r,0,0,-1,r,0,1,r,0,-1,-r,0,1,-r,r,0,-1,r,0,1,-r,0,-1,-r,0,1],[0,11,5,0,5,1,0,1,7,0,7,10,0,10,11,1,5,9,5,11,4,11,10,2,10,7,6,7,1,8,3,9,4,3,4,2,3,2,6,3,6,8,3,8,9,4,9,5,2,4,11,6,2,10,8,6,7,9,8,1],e,t),this.type="IcosahedronGeometry",this.parameters={radius:e,detail:t}}static fromJSON(e){return new kc(e.radius,e.detail)}}class Fc extends ec{constructor(e=1,t=0){super([1,0,0,-1,0,0,0,1,0,0,-1,0,0,0,1,0,0,-1],[0,2,4,0,4,3,0,3,5,0,5,2,1,2,5,1,5,3,1,3,4,1,4,2],e,t),this.type="OctahedronGeometry",this.parameters={radius:e,detail:t}}static fromJSON(e){return new Fc(e.radius,e.detail)}}class Bc extends $n{constructor(e=.5,t=1,r=32,n=1,i=0,s=2*Math.PI){super(),this.type="RingGeometry",this.parameters={innerRadius:e,outerRadius:t,thetaSegments:r,phiSegments:n,thetaStart:i,thetaLength:s},r=Math.max(3,r);const o=[],a=[],l=[],c=[];let u=e;const h=(t-e)/(n=Math.max(1,n)),d=new $t,p=new Wt;for(let e=0;e<=n;e++){for(let e=0;e<=r;e++){const n=i+e/r*s;d.x=u*Math.cos(n),d.y=u*Math.sin(n),a.push(d.x,d.y,d.z),l.push(0,0,1),p.x=(d.x/t+1)/2,p.y=(d.y/t+1)/2,c.push(p.x,p.y)}u+=h}for(let e=0;e<n;e++){const t=e*(r+1);for(let e=0;e<r;e++){const n=e+t,i=n,s=n+r+1,a=n+r+2,l=n+1;o.push(i,s,l),o.push(s,a,l)}}this.setIndex(o),this.setAttribute("position",new Wn(a,3)),this.setAttribute("normal",new Wn(l,3)),this.setAttribute("uv",new Wn(c,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new Bc(e.innerRadius,e.outerRadius,e.thetaSegments,e.phiSegments,e.thetaStart,e.thetaLength)}}class zc extends $n{constructor(e=new ac([new Wt(0,.5),new Wt(-.5,-.5),new Wt(.5,-.5)]),t=12){super(),this.type="ShapeGeometry",this.parameters={shapes:e,curveSegments:t};const r=[],n=[],i=[],s=[];let o=0,a=0;if(!1===Array.isArray(e))l(e);else for(let t=0;t<e.length;t++)l(e[t]),this.addGroup(o,a,t),o+=a,a=0;function l(e){const o=n.length/3,l=e.extractPoints(t);let c=l.shape;const u=l.holes;!1===Ic.isClockWise(c)&&(c=c.reverse());for(let e=0,t=u.length;e<t;e++){const t=u[e];!0===Ic.isClockWise(t)&&(u[e]=t.reverse())}const h=Ic.triangulateShape(c,u);for(let e=0,t=u.length;e<t;e++){const t=u[e];c=c.concat(t)}for(let e=0,t=c.length;e<t;e++){const t=c[e];n.push(t.x,t.y,0),i.push(0,0,1),s.push(t.x,t.y)}for(let e=0,t=h.length;e<t;e++){const t=h[e],n=t[0]+o,i=t[1]+o,s=t[2]+o;r.push(n,i,s),a+=3}}this.setIndex(r),this.setAttribute("position",new Wn(n,3)),this.setAttribute("normal",new Wn(i,3)),this.setAttribute("uv",new Wn(s,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}toJSON(){const e=super.toJSON();return function(e,t){if(t.shapes=[],Array.isArray(e))for(let r=0,n=e.length;r<n;r++){const n=e[r];t.shapes.push(n.uuid)}else t.shapes.push(e.uuid);return t}(this.parameters.shapes,e)}static fromJSON(e,t){const r=[];for(let n=0,i=e.shapes.length;n<i;n++){const i=t[e.shapes[n]];r.push(i)}return new zc(r,e.curveSegments)}}class Gc extends $n{constructor(e=1,t=32,r=16,n=0,i=2*Math.PI,s=0,o=Math.PI){super(),this.type="SphereGeometry",this.parameters={radius:e,widthSegments:t,heightSegments:r,phiStart:n,phiLength:i,thetaStart:s,thetaLength:o},t=Math.max(3,Math.floor(t)),r=Math.max(2,Math.floor(r));const a=Math.min(s+o,Math.PI);let l=0;const c=[],u=new $t,h=new $t,d=[],p=[],f=[],m=[];for(let d=0;d<=r;d++){const g=[],y=d/r;let v=0;0==d&&0==s?v=.5/t:d==r&&a==Math.PI&&(v=-.5/t);for(let r=0;r<=t;r++){const a=r/t;u.x=-e*Math.cos(n+a*i)*Math.sin(s+y*o),u.y=e*Math.cos(s+y*o),u.z=e*Math.sin(n+a*i)*Math.sin(s+y*o),p.push(u.x,u.y,u.z),h.copy(u).normalize(),f.push(h.x,h.y,h.z),m.push(a+v,1-y),g.push(l++)}c.push(g)}for(let e=0;e<r;e++)for(let n=0;n<t;n++){const t=c[e][n+1],i=c[e][n],o=c[e+1][n],l=c[e+1][n+1];(0!==e||s>0)&&d.push(t,i,l),(e!==r-1||a<Math.PI)&&d.push(i,o,l)}this.setIndex(d),this.setAttribute("position",new Wn(p,3)),this.setAttribute("normal",new Wn(f,3)),this.setAttribute("uv",new Wn(m,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new Gc(e.radius,e.widthSegments,e.heightSegments,e.phiStart,e.phiLength,e.thetaStart,e.thetaLength)}}class Vc extends ec{constructor(e=1,t=0){super([1,1,1,-1,-1,1,-1,1,-1,1,-1,-1],[2,1,0,0,3,2,1,3,0,2,3,1],e,t),this.type="TetrahedronGeometry",this.parameters={radius:e,detail:t}}static fromJSON(e){return new Vc(e.radius,e.detail)}}class Hc extends $n{constructor(e=1,t=.4,r=12,n=48,i=2*Math.PI){super(),this.type="TorusGeometry",this.parameters={radius:e,tube:t,radialSegments:r,tubularSegments:n,arc:i},r=Math.floor(r),n=Math.floor(n);const s=[],o=[],a=[],l=[],c=new $t,u=new $t,h=new $t;for(let s=0;s<=r;s++)for(let d=0;d<=n;d++){const p=d/n*i,f=s/r*Math.PI*2;u.x=(e+t*Math.cos(f))*Math.cos(p),u.y=(e+t*Math.cos(f))*Math.sin(p),u.z=t*Math.sin(f),o.push(u.x,u.y,u.z),c.x=e*Math.cos(p),c.y=e*Math.sin(p),h.subVectors(u,c).normalize(),a.push(h.x,h.y,h.z),l.push(d/n),l.push(s/r)}for(let e=1;e<=r;e++)for(let t=1;t<=n;t++){const r=(n+1)*e+t-1,i=(n+1)*(e-1)+t-1,o=(n+1)*(e-1)+t,a=(n+1)*e+t;s.push(r,i,a),s.push(i,o,a)}this.setIndex(s),this.setAttribute("position",new Wn(o,3)),this.setAttribute("normal",new Wn(a,3)),this.setAttribute("uv",new Wn(l,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new Hc(e.radius,e.tube,e.radialSegments,e.tubularSegments,e.arc)}}class Wc extends $n{constructor(e=1,t=.4,r=64,n=8,i=2,s=3){super(),this.type="TorusKnotGeometry",this.parameters={radius:e,tube:t,tubularSegments:r,radialSegments:n,p:i,q:s},r=Math.floor(r),n=Math.floor(n);const o=[],a=[],l=[],c=[],u=new $t,h=new $t,d=new $t,p=new $t,f=new $t,m=new $t,g=new $t;for(let o=0;o<=r;++o){const v=o/r*i*Math.PI*2;y(v,i,s,e,d),y(v+.01,i,s,e,p),m.subVectors(p,d),g.addVectors(p,d),f.crossVectors(m,g),g.crossVectors(f,m),f.normalize(),g.normalize();for(let e=0;e<=n;++e){const i=e/n*Math.PI*2,s=-t*Math.cos(i),p=t*Math.sin(i);u.x=d.x+(s*g.x+p*f.x),u.y=d.y+(s*g.y+p*f.y),u.z=d.z+(s*g.z+p*f.z),a.push(u.x,u.y,u.z),h.subVectors(u,d).normalize(),l.push(h.x,h.y,h.z),c.push(o/r),c.push(e/n)}}for(let e=1;e<=r;e++)for(let t=1;t<=n;t++){const r=(n+1)*(e-1)+(t-1),i=(n+1)*e+(t-1),s=(n+1)*e+t,a=(n+1)*(e-1)+t;o.push(r,i,a),o.push(i,s,a)}function y(e,t,r,n,i){const s=Math.cos(e),o=Math.sin(e),a=r/t*e,l=Math.cos(a);i.x=n*(2+l)*.5*s,i.y=n*(2+l)*o*.5,i.z=n*Math.sin(a)*.5}this.setIndex(o),this.setAttribute("position",new Wn(a,3)),this.setAttribute("normal",new Wn(l,3)),this.setAttribute("uv",new Wn(c,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new Wc(e.radius,e.tube,e.tubularSegments,e.radialSegments,e.p,e.q)}}class Xc extends $n{constructor(e=new Hl(new $t(-1,-1,0),new $t(-1,1,0),new $t(1,1,0)),t=64,r=1,n=8,i=!1){super(),this.type="TubeGeometry",this.parameters={path:e,tubularSegments:t,radius:r,radialSegments:n,closed:i};const s=e.computeFrenetFrames(t,i);this.tangents=s.tangents,this.normals=s.normals,this.binormals=s.binormals;const o=new $t,a=new $t,l=new Wt;let c=new $t;const u=[],h=[],d=[],p=[];function f(i){c=e.getPointAt(i/t,c);const l=s.normals[i],d=s.binormals[i];for(let e=0;e<=n;e++){const t=e/n*Math.PI*2,i=Math.sin(t),s=-Math.cos(t);a.x=s*l.x+i*d.x,a.y=s*l.y+i*d.y,a.z=s*l.z+i*d.z,a.normalize(),h.push(a.x,a.y,a.z),o.x=c.x+r*a.x,o.y=c.y+r*a.y,o.z=c.z+r*a.z,u.push(o.x,o.y,o.z)}}!function(){for(let e=0;e<t;e++)f(e);f(!1===i?t:0),function(){for(let e=0;e<=t;e++)for(let r=0;r<=n;r++)l.x=e/t,l.y=r/n,d.push(l.x,l.y)}(),function(){for(let e=1;e<=t;e++)for(let t=1;t<=n;t++){const r=(n+1)*(e-1)+(t-1),i=(n+1)*e+(t-1),s=(n+1)*e+t,o=(n+1)*(e-1)+t;p.push(r,i,o),p.push(i,s,o)}}()}(),this.setIndex(p),this.setAttribute("position",new Wn(u,3)),this.setAttribute("normal",new Wn(h,3)),this.setAttribute("uv",new Wn(d,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}toJSON(){const e=super.toJSON();return e.path=this.parameters.path.toJSON(),e}static fromJSON(e){return new Xc((new Xl[e.path.type]).fromJSON(e.path),e.tubularSegments,e.radius,e.radialSegments,e.closed)}}class qc extends $n{constructor(e=null){if(super(),this.type="WireframeGeometry",this.parameters={geometry:e},null!==e){const t=[],r=new Set,n=new $t,i=new $t;if(null!==e.index){const s=e.attributes.position,o=e.index;let a=e.groups;0===a.length&&(a=[{start:0,count:o.count,materialIndex:0}]);for(let e=0,l=a.length;e<l;++e){const l=a[e],c=l.start;for(let e=c,a=c+l.count;e<a;e+=3)for(let a=0;a<3;a++){const l=o.getX(e+a),c=o.getX(e+(a+1)%3);n.fromBufferAttribute(s,l),i.fromBufferAttribute(s,c),!0===Yc(n,i,r)&&(t.push(n.x,n.y,n.z),t.push(i.x,i.y,i.z))}}}else{const s=e.attributes.position;for(let e=0,o=s.count/3;e<o;e++)for(let o=0;o<3;o++){const a=3*e+o,l=3*e+(o+1)%3;n.fromBufferAttribute(s,a),i.fromBufferAttribute(s,l),!0===Yc(n,i,r)&&(t.push(n.x,n.y,n.z),t.push(i.x,i.y,i.z))}}this.setAttribute("position",new Wn(t,3))}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}}function Yc(e,t,r){const n=`${e.x},${e.y},${e.z}-${t.x},${t.y},${t.z}`,i=`${t.x},${t.y},${t.z}-${e.x},${e.y},${e.z}`;return!0!==r.has(n)&&!0!==r.has(i)&&(r.add(n),r.add(i),!0)}var Zc=Object.freeze({__proto__:null,BoxGeometry:gi,CapsuleGeometry:Jl,CircleGeometry:Kl,ConeGeometry:$l,CylinderGeometry:Ql,DodecahedronGeometry:tc,EdgesGeometry:oc,ExtrudeGeometry:Nc,IcosahedronGeometry:kc,LatheGeometry:Zl,OctahedronGeometry:Fc,PlaneGeometry:Ui,PolyhedronGeometry:ec,RingGeometry:Bc,ShapeGeometry:zc,SphereGeometry:Gc,TetrahedronGeometry:Vc,TorusGeometry:Hc,TorusKnotGeometry:Wc,TubeGeometry:Xc,WireframeGeometry:qc});class Jc extends jn{constructor(e){super(),this.isShadowMaterial=!0,this.type="ShadowMaterial",this.color=new Un(0),this.transparent=!0,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.fog=e.fog,this}}class Kc extends bi{constructor(e){super(e),this.isRawShaderMaterial=!0,this.type="RawShaderMaterial"}}class Qc extends jn{constructor(e){super(),this.isMeshStandardMaterial=!0,this.defines={STANDARD:""},this.type="MeshStandardMaterial",this.color=new Un(16777215),this.roughness=1,this.metalness=0,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Un(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=bt,this.normalScale=new Wt(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.roughnessMap=null,this.metalnessMap=null,this.alphaMap=null,this.envMap=null,this.envMapIntensity=1,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.defines={STANDARD:""},this.color.copy(e.color),this.roughness=e.roughness,this.metalness=e.metalness,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.roughnessMap=e.roughnessMap,this.metalnessMap=e.metalnessMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapIntensity=e.envMapIntensity,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}}class $c extends Qc{constructor(e){super(),this.isMeshPhysicalMaterial=!0,this.defines={STANDARD:"",PHYSICAL:""},this.type="MeshPhysicalMaterial",this.clearcoatMap=null,this.clearcoatRoughness=0,this.clearcoatRoughnessMap=null,this.clearcoatNormalScale=new Wt(1,1),this.clearcoatNormalMap=null,this.ior=1.5,Object.defineProperty(this,"reflectivity",{get:function(){return Nt(2.5*(this.ior-1)/(this.ior+1),0,1)},set:function(e){this.ior=(1+.4*e)/(1-.4*e)}}),this.iridescenceMap=null,this.iridescenceIOR=1.3,this.iridescenceThicknessRange=[100,400],this.iridescenceThicknessMap=null,this.sheenColor=new Un(0),this.sheenColorMap=null,this.sheenRoughness=1,this.sheenRoughnessMap=null,this.transmissionMap=null,this.thickness=0,this.thicknessMap=null,this.attenuationDistance=1/0,this.attenuationColor=new Un(1,1,1),this.specularIntensity=1,this.specularIntensityMap=null,this.specularColor=new Un(1,1,1),this.specularColorMap=null,this._sheen=0,this._clearcoat=0,this._iridescence=0,this._transmission=0,this.setValues(e)}get sheen(){return this._sheen}set sheen(e){this._sheen>0!=e>0&&this.version++,this._sheen=e}get clearcoat(){return this._clearcoat}set clearcoat(e){this._clearcoat>0!=e>0&&this.version++,this._clearcoat=e}get iridescence(){return this._iridescence}set iridescence(e){this._iridescence>0!=e>0&&this.version++,this._iridescence=e}get transmission(){return this._transmission}set transmission(e){this._transmission>0!=e>0&&this.version++,this._transmission=e}copy(e){return super.copy(e),this.defines={STANDARD:"",PHYSICAL:""},this.clearcoat=e.clearcoat,this.clearcoatMap=e.clearcoatMap,this.clearcoatRoughness=e.clearcoatRoughness,this.clearcoatRoughnessMap=e.clearcoatRoughnessMap,this.clearcoatNormalMap=e.clearcoatNormalMap,this.clearcoatNormalScale.copy(e.clearcoatNormalScale),this.ior=e.ior,this.iridescence=e.iridescence,this.iridescenceMap=e.iridescenceMap,this.iridescenceIOR=e.iridescenceIOR,this.iridescenceThicknessRange=[...e.iridescenceThicknessRange],this.iridescenceThicknessMap=e.iridescenceThicknessMap,this.sheen=e.sheen,this.sheenColor.copy(e.sheenColor),this.sheenColorMap=e.sheenColorMap,this.sheenRoughness=e.sheenRoughness,this.sheenRoughnessMap=e.sheenRoughnessMap,this.transmission=e.transmission,this.transmissionMap=e.transmissionMap,this.thickness=e.thickness,this.thicknessMap=e.thicknessMap,this.attenuationDistance=e.attenuationDistance,this.attenuationColor.copy(e.attenuationColor),this.specularIntensity=e.specularIntensity,this.specularIntensityMap=e.specularIntensityMap,this.specularColor.copy(e.specularColor),this.specularColorMap=e.specularColorMap,this}}class eu extends jn{constructor(e){super(),this.isMeshPhongMaterial=!0,this.type="MeshPhongMaterial",this.color=new Un(16777215),this.specular=new Un(1118481),this.shininess=30,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Un(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=bt,this.normalScale=new Wt(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=G,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.specular.copy(e.specular),this.shininess=e.shininess,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}}class tu extends jn{constructor(e){super(),this.isMeshToonMaterial=!0,this.defines={TOON:""},this.type="MeshToonMaterial",this.color=new Un(16777215),this.map=null,this.gradientMap=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Un(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=bt,this.normalScale=new Wt(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.gradientMap=e.gradientMap,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.alphaMap=e.alphaMap,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.fog=e.fog,this}}class ru extends jn{constructor(e){super(),this.isMeshNormalMaterial=!0,this.type="MeshNormalMaterial",this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=bt,this.normalScale=new Wt(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.flatShading=!1,this.setValues(e)}copy(e){return super.copy(e),this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.flatShading=e.flatShading,this}}class nu extends jn{constructor(e){super(),this.isMeshLambertMaterial=!0,this.type="MeshLambertMaterial",this.color=new Un(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Un(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=bt,this.normalScale=new Wt(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=G,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}}class iu extends jn{constructor(e){super(),this.isMeshMatcapMaterial=!0,this.defines={MATCAP:""},this.type="MeshMatcapMaterial",this.color=new Un(16777215),this.matcap=null,this.map=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=bt,this.normalScale=new Wt(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.defines={MATCAP:""},this.color.copy(e.color),this.matcap=e.matcap,this.map=e.map,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.alphaMap=e.alphaMap,this.flatShading=e.flatShading,this.fog=e.fog,this}}class su extends ll{constructor(e){super(),this.isLineDashedMaterial=!0,this.type="LineDashedMaterial",this.scale=1,this.dashSize=3,this.gapSize=1,this.setValues(e)}copy(e){return super.copy(e),this.scale=e.scale,this.dashSize=e.dashSize,this.gapSize=e.gapSize,this}}function ou(e,t,r){return lu(e)?new e.constructor(e.subarray(t,void 0!==r?r:e.length)):e.slice(t,r)}function au(e,t,r){return!e||!r&&e.constructor===t?e:"number"==typeof t.BYTES_PER_ELEMENT?new t(e):Array.prototype.slice.call(e)}function lu(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)}function cu(e){const t=e.length,r=new Array(t);for(let e=0;e!==t;++e)r[e]=e;return r.sort((function(t,r){return e[t]-e[r]})),r}function uu(e,t,r){const n=e.length,i=new e.constructor(n);for(let s=0,o=0;o!==n;++s){const n=r[s]*t;for(let r=0;r!==t;++r)i[o++]=e[n+r]}return i}function hu(e,t,r,n){let i=1,s=e[0];for(;void 0!==s&&void 0===s[n];)s=e[i++];if(void 0===s)return;let o=s[n];if(void 0!==o)if(Array.isArray(o))do{o=s[n],void 0!==o&&(t.push(s.time),r.push.apply(r,o)),s=e[i++]}while(void 0!==s);else if(void 0!==o.toArray)do{o=s[n],void 0!==o&&(t.push(s.time),o.toArray(r,r.length)),s=e[i++]}while(void 0!==s);else do{o=s[n],void 0!==o&&(t.push(s.time),r.push(o)),s=e[i++]}while(void 0!==s)}const du={arraySlice:ou,convertArray:au,isTypedArray:lu,getKeyframeOrder:cu,sortedArray:uu,flattenJSON:hu,subclip:function(e,t,r,n,i=30){const s=e.clone();s.name=t;const o=[];for(let e=0;e<s.tracks.length;++e){const t=s.tracks[e],a=t.getValueSize(),l=[],c=[];for(let e=0;e<t.times.length;++e){const s=t.times[e]*i;if(!(s<r||s>=n)){l.push(t.times[e]);for(let r=0;r<a;++r)c.push(t.values[e*a+r])}}0!==l.length&&(t.times=au(l,t.times.constructor),t.values=au(c,t.values.constructor),o.push(t))}s.tracks=o;let a=1/0;for(let e=0;e<s.tracks.length;++e)a>s.tracks[e].times[0]&&(a=s.tracks[e].times[0]);for(let e=0;e<s.tracks.length;++e)s.tracks[e].shift(-1*a);return s.resetDuration(),s},makeClipAdditive:function(e,t=0,r=e,n=30){n<=0&&(n=30);const i=r.tracks.length,s=t/n;for(let t=0;t<i;++t){const n=r.tracks[t],i=n.ValueTypeName;if("bool"===i||"string"===i)continue;const o=e.tracks.find((function(e){return e.name===n.name&&e.ValueTypeName===i}));if(void 0===o)continue;let a=0;const l=n.getValueSize();n.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline&&(a=l/3);let c=0;const u=o.getValueSize();o.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline&&(c=u/3);const h=n.times.length-1;let d;if(s<=n.times[0]){const e=a,t=l-a;d=ou(n.values,e,t)}else if(s>=n.times[h]){const e=h*l+a,t=e+l-a;d=ou(n.values,e,t)}else{const e=n.createInterpolant(),t=a,r=l-a;e.evaluate(s),d=ou(e.resultBuffer,t,r)}if("quaternion"===i){(new Qt).fromArray(d).normalize().conjugate().toArray(d)}const p=o.times.length;for(let e=0;e<p;++e){const t=e*u+c;if("quaternion"===i)Qt.multiplyQuaternionsFlat(o.values,t,d,0,o.values,t);else{const e=u-2*c;for(let r=0;r<e;++r)o.values[t+r]-=d[r]}}}return e.blendMode=yt,e}};class pu{constructor(e,t,r,n){this.parameterPositions=e,this._cachedIndex=0,this.resultBuffer=void 0!==n?n:new t.constructor(r),this.sampleValues=t,this.valueSize=r,this.settings=null,this.DefaultSettings_={}}evaluate(e){const t=this.parameterPositions;let r=this._cachedIndex,n=t[r],i=t[r-1];e:{t:{let s;r:{n:if(!(e<n)){for(let s=r+2;;){if(void 0===n){if(e<i)break n;return r=t.length,this._cachedIndex=r,this.copySampleValue_(r-1)}if(r===s)break;if(i=n,n=t[++r],e<n)break t}s=t.length;break r}if(e>=i)break e;{const o=t[1];e<o&&(r=2,i=o);for(let s=r-2;;){if(void 0===i)return this._cachedIndex=0,this.copySampleValue_(0);if(r===s)break;if(n=i,i=t[--r-1],e>=i)break t}s=r,r=0}}for(;r<s;){const n=r+s>>>1;e<t[n]?s=n:r=n+1}if(n=t[r],i=t[r-1],void 0===i)return this._cachedIndex=0,this.copySampleValue_(0);if(void 0===n)return r=t.length,this._cachedIndex=r,this.copySampleValue_(r-1)}this._cachedIndex=r,this.intervalChanged_(r,i,n)}return this.interpolate_(r,i,e,n)}getSettings_(){return this.settings||this.DefaultSettings_}copySampleValue_(e){const t=this.resultBuffer,r=this.sampleValues,n=this.valueSize,i=e*n;for(let e=0;e!==n;++e)t[e]=r[i+e];return t}interpolate_(){throw new Error("call to abstract method")}intervalChanged_(){}}class fu extends pu{constructor(e,t,r,n){super(e,t,r,n),this._weightPrev=-0,this._offsetPrev=-0,this._weightNext=-0,this._offsetNext=-0,this.DefaultSettings_={endingStart:pt,endingEnd:pt}}intervalChanged_(e,t,r){const n=this.parameterPositions;let i=e-2,s=e+1,o=n[i],a=n[s];if(void 0===o)switch(this.getSettings_().endingStart){case ft:i=e,o=2*t-r;break;case mt:i=n.length-2,o=t+n[i]-n[i+1];break;default:i=e,o=r}if(void 0===a)switch(this.getSettings_().endingEnd){case ft:s=e,a=2*r-t;break;case mt:s=1,a=r+n[1]-n[0];break;default:s=e-1,a=t}const l=.5*(r-t),c=this.valueSize;this._weightPrev=l/(t-o),this._weightNext=l/(a-r),this._offsetPrev=i*c,this._offsetNext=s*c}interpolate_(e,t,r,n){const i=this.resultBuffer,s=this.sampleValues,o=this.valueSize,a=e*o,l=a-o,c=this._offsetPrev,u=this._offsetNext,h=this._weightPrev,d=this._weightNext,p=(r-t)/(n-t),f=p*p,m=f*p,g=-h*m+2*h*f-h*p,y=(1+h)*m+(-1.5-2*h)*f+(-.5+h)*p+1,v=(-1-d)*m+(1.5+d)*f+.5*p,_=d*m-d*f;for(let e=0;e!==o;++e)i[e]=g*s[c+e]+y*s[l+e]+v*s[a+e]+_*s[u+e];return i}}class mu extends pu{constructor(e,t,r,n){super(e,t,r,n)}interpolate_(e,t,r,n){const i=this.resultBuffer,s=this.sampleValues,o=this.valueSize,a=e*o,l=a-o,c=(r-t)/(n-t),u=1-c;for(let e=0;e!==o;++e)i[e]=s[l+e]*u+s[a+e]*c;return i}}class gu extends pu{constructor(e,t,r,n){super(e,t,r,n)}interpolate_(e){return this.copySampleValue_(e-1)}}class yu{constructor(e,t,r,n){if(void 0===e)throw new Error("THREE.KeyframeTrack: track name is undefined");if(void 0===t||0===t.length)throw new Error("THREE.KeyframeTrack: no keyframes in track named "+e);this.name=e,this.times=au(t,this.TimeBufferType),this.values=au(r,this.ValueBufferType),this.setInterpolation(n||this.DefaultInterpolation)}static toJSON(e){const t=e.constructor;let r;if(t.toJSON!==this.toJSON)r=t.toJSON(e);else{r={name:e.name,times:au(e.times,Array),values:au(e.values,Array)};const t=e.getInterpolation();t!==e.DefaultInterpolation&&(r.interpolation=t)}return r.type=e.ValueTypeName,r}InterpolantFactoryMethodDiscrete(e){return new gu(this.times,this.values,this.getValueSize(),e)}InterpolantFactoryMethodLinear(e){return new mu(this.times,this.values,this.getValueSize(),e)}InterpolantFactoryMethodSmooth(e){return new fu(this.times,this.values,this.getValueSize(),e)}setInterpolation(e){let t;switch(e){case ut:t=this.InterpolantFactoryMethodDiscrete;break;case ht:t=this.InterpolantFactoryMethodLinear;break;case dt:t=this.InterpolantFactoryMethodSmooth}if(void 0===t){const t="unsupported interpolation for "+this.ValueTypeName+" keyframe track named "+this.name;if(void 0===this.createInterpolant){if(e===this.DefaultInterpolation)throw new Error(t);this.setInterpolation(this.DefaultInterpolation)}return this}return this.createInterpolant=t,this}getInterpolation(){switch(this.createInterpolant){case this.InterpolantFactoryMethodDiscrete:return ut;case this.InterpolantFactoryMethodLinear:return ht;case this.InterpolantFactoryMethodSmooth:return dt}}getValueSize(){return this.values.length/this.times.length}shift(e){if(0!==e){const t=this.times;for(let r=0,n=t.length;r!==n;++r)t[r]+=e}return this}scale(e){if(1!==e){const t=this.times;for(let r=0,n=t.length;r!==n;++r)t[r]*=e}return this}trim(e,t){const r=this.times,n=r.length;let i=0,s=n-1;for(;i!==n&&r[i]<e;)++i;for(;-1!==s&&r[s]>t;)--s;if(++s,0!==i||s!==n){i>=s&&(s=Math.max(s,1),i=s-1);const e=this.getValueSize();this.times=ou(r,i,s),this.values=ou(this.values,i*e,s*e)}return this}validate(){let e=!0;const t=this.getValueSize();t-Math.floor(t)!=0&&(e=!1);const r=this.times,n=this.values,i=r.length;0===i&&(e=!1);let s=null;for(let t=0;t!==i;t++){const n=r[t];if("number"==typeof n&&isNaN(n)){e=!1;break}if(null!==s&&s>n){e=!1;break}s=n}if(void 0!==n&&lu(n))for(let t=0,r=n.length;t!==r;++t){const r=n[t];if(isNaN(r)){e=!1;break}}return e}optimize(){const e=ou(this.times),t=ou(this.values),r=this.getValueSize(),n=this.getInterpolation()===dt,i=e.length-1;let s=1;for(let o=1;o<i;++o){let i=!1;const a=e[o];if(a!==e[o+1]&&(1!==o||a!==e[0]))if(n)i=!0;else{const e=o*r,n=e-r,s=e+r;for(let o=0;o!==r;++o){const r=t[e+o];if(r!==t[n+o]||r!==t[s+o]){i=!0;break}}}if(i){if(o!==s){e[s]=e[o];const n=o*r,i=s*r;for(let e=0;e!==r;++e)t[i+e]=t[n+e]}++s}}if(i>0){e[s]=e[i];for(let e=i*r,n=s*r,o=0;o!==r;++o)t[n+o]=t[e+o];++s}return s!==e.length?(this.times=ou(e,0,s),this.values=ou(t,0,s*r)):(this.times=e,this.values=t),this}clone(){const e=ou(this.times,0),t=ou(this.values,0),r=new(0,this.constructor)(this.name,e,t);return r.createInterpolant=this.createInterpolant,r}}yu.prototype.TimeBufferType=Float32Array,yu.prototype.ValueBufferType=Float32Array,yu.prototype.DefaultInterpolation=ht;class vu extends yu{}vu.prototype.ValueTypeName="bool",vu.prototype.ValueBufferType=Array,vu.prototype.DefaultInterpolation=ut,vu.prototype.InterpolantFactoryMethodLinear=void 0,vu.prototype.InterpolantFactoryMethodSmooth=void 0;class _u extends yu{}_u.prototype.ValueTypeName="color";class xu extends yu{}xu.prototype.ValueTypeName="number";class bu extends pu{constructor(e,t,r,n){super(e,t,r,n)}interpolate_(e,t,r,n){const i=this.resultBuffer,s=this.sampleValues,o=this.valueSize,a=(r-t)/(n-t);let l=e*o;for(let e=l+o;l!==e;l+=4)Qt.slerpFlat(i,0,s,l-o,s,l,a);return i}}class wu extends yu{InterpolantFactoryMethodLinear(e){return new bu(this.times,this.values,this.getValueSize(),e)}}wu.prototype.ValueTypeName="quaternion",wu.prototype.DefaultInterpolation=ht,wu.prototype.InterpolantFactoryMethodSmooth=void 0;class Su extends yu{}Su.prototype.ValueTypeName="string",Su.prototype.ValueBufferType=Array,Su.prototype.DefaultInterpolation=ut,Su.prototype.InterpolantFactoryMethodLinear=void 0,Su.prototype.InterpolantFactoryMethodSmooth=void 0;class Mu extends yu{}Mu.prototype.ValueTypeName="vector";class Tu{constructor(e,t=-1,r,n=2500){this.name=e,this.tracks=r,this.duration=t,this.blendMode=n,this.uuid=Ot(),this.duration<0&&this.resetDuration()}static parse(e){const t=[],r=e.tracks,n=1/(e.fps||1);for(let e=0,i=r.length;e!==i;++e)t.push(Eu(r[e]).scale(n));const i=new this(e.name,e.duration,t,e.blendMode);return i.uuid=e.uuid,i}static toJSON(e){const t=[],r=e.tracks,n={name:e.name,duration:e.duration,tracks:t,uuid:e.uuid,blendMode:e.blendMode};for(let e=0,n=r.length;e!==n;++e)t.push(yu.toJSON(r[e]));return n}static CreateFromMorphTargetSequence(e,t,r,n){const i=t.length,s=[];for(let e=0;e<i;e++){let o=[],a=[];o.push((e+i-1)%i,e,(e+1)%i),a.push(0,1,0);const l=cu(o);o=uu(o,1,l),a=uu(a,1,l),n||0!==o[0]||(o.push(i),a.push(a[0])),s.push(new xu(".morphTargetInfluences["+t[e].name+"]",o,a).scale(1/r))}return new this(e,-1,s)}static findByName(e,t){let r=e;if(!Array.isArray(e)){const t=e;r=t.geometry&&t.geometry.animations||t.animations}for(let e=0;e<r.length;e++)if(r[e].name===t)return r[e];return null}static CreateClipsFromMorphTargetSequences(e,t,r){const n={},i=/^([\w-]*?)([\d]+)$/;for(let t=0,r=e.length;t<r;t++){const r=e[t],s=r.name.match(i);if(s&&s.length>1){const e=s[1];let t=n[e];t||(n[e]=t=[]),t.push(r)}}const s=[];for(const e in n)s.push(this.CreateFromMorphTargetSequence(e,n[e],t,r));return s}static parseAnimation(e,t){if(!e)return null;const r=function(e,t,r,n,i){if(0!==r.length){const s=[],o=[];hu(r,s,o,n),0!==s.length&&i.push(new e(t,s,o))}},n=[],i=e.name||"default",s=e.fps||30,o=e.blendMode;let a=e.length||-1;const l=e.hierarchy||[];for(let e=0;e<l.length;e++){const i=l[e].keys;if(i&&0!==i.length)if(i[0].morphTargets){const e={};let t;for(t=0;t<i.length;t++)if(i[t].morphTargets)for(let r=0;r<i[t].morphTargets.length;r++)e[i[t].morphTargets[r]]=-1;for(const r in e){const e=[],s=[];for(let n=0;n!==i[t].morphTargets.length;++n){const n=i[t];e.push(n.time),s.push(n.morphTarget===r?1:0)}n.push(new xu(".morphTargetInfluence["+r+"]",e,s))}a=e.length*s}else{const s=".bones["+t[e].name+"]";r(Mu,s+".position",i,"pos",n),r(wu,s+".quaternion",i,"rot",n),r(Mu,s+".scale",i,"scl",n)}}if(0===n.length)return null;return new this(i,a,n,o)}resetDuration(){let e=0;for(let t=0,r=this.tracks.length;t!==r;++t){const r=this.tracks[t];e=Math.max(e,r.times[r.times.length-1])}return this.duration=e,this}trim(){for(let e=0;e<this.tracks.length;e++)this.tracks[e].trim(0,this.duration);return this}validate(){let e=!0;for(let t=0;t<this.tracks.length;t++)e=e&&this.tracks[t].validate();return e}optimize(){for(let e=0;e<this.tracks.length;e++)this.tracks[e].optimize();return this}clone(){const e=[];for(let t=0;t<this.tracks.length;t++)e.push(this.tracks[t].clone());return new this.constructor(this.name,this.duration,e,this.blendMode)}toJSON(){return this.constructor.toJSON(this)}}function Eu(e){if(void 0===e.type)throw new Error("THREE.KeyframeTrack: track type undefined, can not parse");const t=function(e){switch(e.toLowerCase()){case"scalar":case"double":case"float":case"number":case"integer":return xu;case"vector":case"vector2":case"vector3":case"vector4":return Mu;case"color":return _u;case"quaternion":return wu;case"bool":case"boolean":return vu;case"string":return Su}throw new Error("THREE.KeyframeTrack: Unsupported typeName: "+e)}(e.type);if(void 0===e.times){const t=[],r=[];hu(e.keys,t,r,"value"),e.times=t,e.values=r}return void 0!==t.parse?t.parse(e):new t(e.name,e.times,e.values,e.interpolation)}const Au={enabled:!1,files:{},add:function(e,t){!1!==this.enabled&&(this.files[e]=t)},get:function(e){if(!1!==this.enabled)return this.files[e]},remove:function(e){delete this.files[e]},clear:function(){this.files={}}};class Cu{constructor(e,t,r){const n=this;let i,s=!1,o=0,a=0;const l=[];this.onStart=void 0,this.onLoad=e,this.onProgress=t,this.onError=r,this.itemStart=function(e){a++,!1===s&&void 0!==n.onStart&&n.onStart(e,o,a),s=!0},this.itemEnd=function(e){o++,void 0!==n.onProgress&&n.onProgress(e,o,a),o===a&&(s=!1,void 0!==n.onLoad&&n.onLoad())},this.itemError=function(e){void 0!==n.onError&&n.onError(e)},this.resolveURL=function(e){return i?i(e):e},this.setURLModifier=function(e){return i=e,this},this.addHandler=function(e,t){return l.push(e,t),this},this.removeHandler=function(e){const t=l.indexOf(e);return-1!==t&&l.splice(t,2),this},this.getHandler=function(e){for(let t=0,r=l.length;t<r;t+=2){const r=l[t],n=l[t+1];if(r.global&&(r.lastIndex=0),r.test(e))return n}return null}}}const Lu=new Cu;class Ru{constructor(e){this.manager=void 0!==e?e:Lu,this.crossOrigin="anonymous",this.withCredentials=!1,this.path="",this.resourcePath="",this.requestHeader={}}load(){}loadAsync(e,t){const r=this;return new Promise((function(n,i){r.load(e,n,t,i)}))}parse(){}setCrossOrigin(e){return this.crossOrigin=e,this}setWithCredentials(e){return this.withCredentials=e,this}setPath(e){return this.path=e,this}setResourcePath(e){return this.resourcePath=e,this}setRequestHeader(e){return this.requestHeader=e,this}}const Pu={};class ju extends Error{constructor(e,t){super(e),this.response=t}}class Iu extends Ru{constructor(e){super(e)}load(e,t,r,n){void 0===e&&(e=""),void 0!==this.path&&(e=this.path+e),e=this.manager.resolveURL(e);const i=Au.get(e);if(void 0!==i)return this.manager.itemStart(e),setTimeout((()=>{t&&t(i),this.manager.itemEnd(e)}),0),i;if(void 0!==Pu[e])return void Pu[e].push({onLoad:t,onProgress:r,onError:n});Pu[e]=[],Pu[e].push({onLoad:t,onProgress:r,onError:n});const s=new Request(e,{headers:new Headers(this.requestHeader),credentials:this.withCredentials?"include":"same-origin"}),o=this.mimeType,a=this.responseType;fetch(s).then((t=>{if(200===t.status||0===t.status){if(t.status,"undefined"==typeof ReadableStream||void 0===t.body||void 0===t.body.getReader)return t;const r=Pu[e],n=t.body.getReader(),i=t.headers.get("Content-Length")||t.headers.get("X-File-Size"),s=i?parseInt(i):0,o=0!==s;let a=0;const l=new ReadableStream({start(e){!function t(){n.read().then((({done:n,value:i})=>{if(n)e.close();else{a+=i.byteLength;const n=new ProgressEvent("progress",{lengthComputable:o,loaded:a,total:s});for(let e=0,t=r.length;e<t;e++){const t=r[e];t.onProgress&&t.onProgress(n)}e.enqueue(i),t()}}))}()}});return new Response(l)}throw new ju(`fetch for "${t.url}" responded with ${t.status}: ${t.statusText}`,t)})).then((e=>{switch(a){case"arraybuffer":return e.arrayBuffer();case"blob":return e.blob();case"document":return e.text().then((e=>(new DOMParser).parseFromString(e,o)));case"json":return e.json();default:if(void 0===o)return e.text();{const t=/charset="?([^;"\s]*)"?/i.exec(o),r=t&&t[1]?t[1].toLowerCase():void 0,n=new TextDecoder(r);return e.arrayBuffer().then((e=>n.decode(e)))}}})).then((t=>{Au.add(e,t);const r=Pu[e];delete Pu[e];for(let e=0,n=r.length;e<n;e++){const n=r[e];n.onLoad&&n.onLoad(t)}})).catch((t=>{const r=Pu[e];if(void 0===r)throw this.manager.itemError(e),t;delete Pu[e];for(let e=0,n=r.length;e<n;e++){const n=r[e];n.onError&&n.onError(t)}this.manager.itemError(e)})).finally((()=>{this.manager.itemEnd(e)})),this.manager.itemStart(e)}setResponseType(e){return this.responseType=e,this}setMimeType(e){return this.mimeType=e,this}}class Du extends Ru{constructor(e){super(e)}load(e,t,r,n){void 0!==this.path&&(e=this.path+e),e=this.manager.resolveURL(e);const i=this,s=Au.get(e);if(void 0!==s)return i.manager.itemStart(e),setTimeout((function(){t&&t(s),i.manager.itemEnd(e)}),0),s;const o=Kt("img");function a(){c(),Au.add(e,this),t&&t(this),i.manager.itemEnd(e)}function l(t){c(),n&&n(t),i.manager.itemError(e),i.manager.itemEnd(e)}function c(){o.removeEventListener("load",a,!1),o.removeEventListener("error",l,!1)}return o.addEventListener("load",a,!1),o.addEventListener("error",l,!1),"data:"!==e.slice(0,5)&&void 0!==this.crossOrigin&&(o.crossOrigin=this.crossOrigin),i.manager.itemStart(e),o.src=e,o}}class Ou extends _n{constructor(e,t=1){super(),this.isLight=!0,this.type="Light",this.color=new Un(e),this.intensity=t}dispose(){}copy(e,t){return super.copy(e,t),this.color.copy(e.color),this.intensity=e.intensity,this}toJSON(e){const t=super.toJSON(e);return t.object.color=this.color.getHex(),t.object.intensity=this.intensity,void 0!==this.groundColor&&(t.object.groundColor=this.groundColor.getHex()),void 0!==this.distance&&(t.object.distance=this.distance),void 0!==this.angle&&(t.object.angle=this.angle),void 0!==this.decay&&(t.object.decay=this.decay),void 0!==this.penumbra&&(t.object.penumbra=this.penumbra),void 0!==this.shadow&&(t.object.shadow=this.shadow.toJSON()),t}}class Nu extends Ou{constructor(e,t,r){super(e,r),this.isHemisphereLight=!0,this.type="HemisphereLight",this.position.copy(_n.DEFAULT_UP),this.updateMatrix(),this.groundColor=new Un(t)}copy(e,t){return super.copy(e,t),this.groundColor.copy(e.groundColor),this}}const Uu=new qr,ku=new $t,Fu=new $t;class Bu{constructor(e){this.camera=e,this.bias=0,this.normalBias=0,this.radius=1,this.blurSamples=8,this.mapSize=new Wt(512,512),this.map=null,this.mapPass=null,this.matrix=new qr,this.autoUpdate=!0,this.needsUpdate=!1,this._frustum=new Di,this._frameExtents=new Wt(1,1),this._viewportCount=1,this._viewports=[new gr(0,0,1,1)]}getViewportCount(){return this._viewportCount}getFrustum(){return this._frustum}updateMatrices(e){const t=this.camera,r=this.matrix;ku.setFromMatrixPosition(e.matrixWorld),t.position.copy(ku),Fu.setFromMatrixPosition(e.target.matrixWorld),t.lookAt(Fu),t.updateMatrixWorld(),Uu.multiplyMatrices(t.projectionMatrix,t.matrixWorldInverse),this._frustum.setFromProjectionMatrix(Uu),r.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),r.multiply(Uu)}getViewport(e){return this._viewports[e]}getFrameExtents(){return this._frameExtents}dispose(){this.map&&this.map.dispose(),this.mapPass&&this.mapPass.dispose()}copy(e){return this.camera=e.camera.clone(),this.bias=e.bias,this.radius=e.radius,this.mapSize.copy(e.mapSize),this}clone(){return(new this.constructor).copy(this)}toJSON(){const e={};return 0!==this.bias&&(e.bias=this.bias),0!==this.normalBias&&(e.normalBias=this.normalBias),1!==this.radius&&(e.radius=this.radius),512===this.mapSize.x&&512===this.mapSize.y||(e.mapSize=this.mapSize.toArray()),e.camera=this.camera.toJSON(!1).object,delete e.camera.matrix,e}}class zu extends Bu{constructor(){super(new Si(50,1,.5,500)),this.isSpotLightShadow=!0,this.focus=1}updateMatrices(e){const t=this.camera,r=2*Dt*e.angle*this.focus,n=this.mapSize.width/this.mapSize.height,i=e.distance||t.far;r===t.fov&&n===t.aspect&&i===t.far||(t.fov=r,t.aspect=n,t.far=i,t.updateProjectionMatrix()),super.updateMatrices(e)}copy(e){return super.copy(e),this.focus=e.focus,this}}class Gu extends Ou{constructor(e,t,r=0,n=Math.PI/3,i=0,s=2){super(e,t),this.isSpotLight=!0,this.type="SpotLight",this.position.copy(_n.DEFAULT_UP),this.updateMatrix(),this.target=new _n,this.distance=r,this.angle=n,this.penumbra=i,this.decay=s,this.map=null,this.shadow=new zu}get power(){return this.intensity*Math.PI}set power(e){this.intensity=e/Math.PI}dispose(){this.shadow.dispose()}copy(e,t){return super.copy(e,t),this.distance=e.distance,this.angle=e.angle,this.penumbra=e.penumbra,this.decay=e.decay,this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}}const Vu=new qr,Hu=new $t,Wu=new $t;class Xu extends Bu{constructor(){super(new Si(90,1,.5,500)),this.isPointLightShadow=!0,this._frameExtents=new Wt(4,2),this._viewportCount=6,this._viewports=[new gr(2,1,1,1),new gr(0,1,1,1),new gr(3,1,1,1),new gr(1,1,1,1),new gr(3,0,1,1),new gr(1,0,1,1)],this._cubeDirections=[new $t(1,0,0),new $t(-1,0,0),new $t(0,0,1),new $t(0,0,-1),new $t(0,1,0),new $t(0,-1,0)],this._cubeUps=[new $t(0,1,0),new $t(0,1,0),new $t(0,1,0),new $t(0,1,0),new $t(0,0,1),new $t(0,0,-1)]}updateMatrices(e,t=0){const r=this.camera,n=this.matrix,i=e.distance||r.far;i!==r.far&&(r.far=i,r.updateProjectionMatrix()),Hu.setFromMatrixPosition(e.matrixWorld),r.position.copy(Hu),Wu.copy(r.position),Wu.add(this._cubeDirections[t]),r.up.copy(this._cubeUps[t]),r.lookAt(Wu),r.updateMatrixWorld(),n.makeTranslation(-Hu.x,-Hu.y,-Hu.z),Vu.multiplyMatrices(r.projectionMatrix,r.matrixWorldInverse),this._frustum.setFromProjectionMatrix(Vu)}}class qu extends Ou{constructor(e,t,r=0,n=2){super(e,t),this.isPointLight=!0,this.type="PointLight",this.distance=r,this.decay=n,this.shadow=new Xu}get power(){return 4*this.intensity*Math.PI}set power(e){this.intensity=e/(4*Math.PI)}dispose(){this.shadow.dispose()}copy(e,t){return super.copy(e,t),this.distance=e.distance,this.decay=e.decay,this.shadow=e.shadow.clone(),this}}class Yu extends Bu{constructor(){super(new Yi(-5,5,5,-5,.5,500)),this.isDirectionalLightShadow=!0}}class Zu extends Ou{constructor(e,t){super(e,t),this.isDirectionalLight=!0,this.type="DirectionalLight",this.position.copy(_n.DEFAULT_UP),this.updateMatrix(),this.target=new _n,this.shadow=new Yu}dispose(){this.shadow.dispose()}copy(e){return super.copy(e),this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}}class Ju extends Ou{constructor(e,t){super(e,t),this.isAmbientLight=!0,this.type="AmbientLight"}}class Ku extends Ou{constructor(e,t,r=10,n=10){super(e,t),this.isRectAreaLight=!0,this.type="RectAreaLight",this.width=r,this.height=n}get power(){return this.intensity*this.width*this.height*Math.PI}set power(e){this.intensity=e/(this.width*this.height*Math.PI)}copy(e){return super.copy(e),this.width=e.width,this.height=e.height,this}toJSON(e){const t=super.toJSON(e);return t.object.width=this.width,t.object.height=this.height,t}}class Qu{constructor(){this.isSphericalHarmonics3=!0,this.coefficients=[];for(let e=0;e<9;e++)this.coefficients.push(new $t)}set(e){for(let t=0;t<9;t++)this.coefficients[t].copy(e[t]);return this}zero(){for(let e=0;e<9;e++)this.coefficients[e].set(0,0,0);return this}getAt(e,t){const r=e.x,n=e.y,i=e.z,s=this.coefficients;return t.copy(s[0]).multiplyScalar(.282095),t.addScaledVector(s[1],.488603*n),t.addScaledVector(s[2],.488603*i),t.addScaledVector(s[3],.488603*r),t.addScaledVector(s[4],r*n*1.092548),t.addScaledVector(s[5],n*i*1.092548),t.addScaledVector(s[6],.315392*(3*i*i-1)),t.addScaledVector(s[7],r*i*1.092548),t.addScaledVector(s[8],.546274*(r*r-n*n)),t}getIrradianceAt(e,t){const r=e.x,n=e.y,i=e.z,s=this.coefficients;return t.copy(s[0]).multiplyScalar(.886227),t.addScaledVector(s[1],1.023328*n),t.addScaledVector(s[2],1.023328*i),t.addScaledVector(s[3],1.023328*r),t.addScaledVector(s[4],.858086*r*n),t.addScaledVector(s[5],.858086*n*i),t.addScaledVector(s[6],.743125*i*i-.247708),t.addScaledVector(s[7],.858086*r*i),t.addScaledVector(s[8],.429043*(r*r-n*n)),t}add(e){for(let t=0;t<9;t++)this.coefficients[t].add(e.coefficients[t]);return this}addScaledSH(e,t){for(let r=0;r<9;r++)this.coefficients[r].addScaledVector(e.coefficients[r],t);return this}scale(e){for(let t=0;t<9;t++)this.coefficients[t].multiplyScalar(e);return this}lerp(e,t){for(let r=0;r<9;r++)this.coefficients[r].lerp(e.coefficients[r],t);return this}equals(e){for(let t=0;t<9;t++)if(!this.coefficients[t].equals(e.coefficients[t]))return!1;return!0}copy(e){return this.set(e.coefficients)}clone(){return(new this.constructor).copy(this)}fromArray(e,t=0){const r=this.coefficients;for(let n=0;n<9;n++)r[n].fromArray(e,t+3*n);return this}toArray(e=[],t=0){const r=this.coefficients;for(let n=0;n<9;n++)r[n].toArray(e,t+3*n);return e}static getBasisAt(e,t){const r=e.x,n=e.y,i=e.z;t[0]=.282095,t[1]=.488603*n,t[2]=.488603*i,t[3]=.488603*r,t[4]=1.092548*r*n,t[5]=1.092548*n*i,t[6]=.315392*(3*i*i-1),t[7]=1.092548*r*i,t[8]=.546274*(r*r-n*n)}}class $u extends Ou{constructor(e=new Qu,t=1){super(void 0,t),this.isLightProbe=!0,this.sh=e}copy(e){return super.copy(e),this.sh.copy(e.sh),this}fromJSON(e){return this.intensity=e.intensity,this.sh.fromArray(e.sh),this}toJSON(e){const t=super.toJSON(e);return t.object.sh=this.sh.toArray(),t}}class eh extends Ru{constructor(e){super(e),this.textures={}}load(e,t,r,n){const i=this,s=new Iu(i.manager);s.setPath(i.path),s.setRequestHeader(i.requestHeader),s.setWithCredentials(i.withCredentials),s.load(e,(function(r){try{t(i.parse(JSON.parse(r)))}catch(t){n&&n(t),i.manager.itemError(e)}}),r,n)}parse(e){const t=this.textures;function r(e){return t[e],t[e]}const n=eh.createMaterialFromType(e.type);if(void 0!==e.uuid&&(n.uuid=e.uuid),void 0!==e.name&&(n.name=e.name),void 0!==e.color&&void 0!==n.color&&n.color.setHex(e.color),void 0!==e.roughness&&(n.roughness=e.roughness),void 0!==e.metalness&&(n.metalness=e.metalness),void 0!==e.sheen&&(n.sheen=e.sheen),void 0!==e.sheenColor&&(n.sheenColor=(new Un).setHex(e.sheenColor)),void 0!==e.sheenRoughness&&(n.sheenRoughness=e.sheenRoughness),void 0!==e.emissive&&void 0!==n.emissive&&n.emissive.setHex(e.emissive),void 0!==e.specular&&void 0!==n.specular&&n.specular.setHex(e.specular),void 0!==e.specularIntensity&&(n.specularIntensity=e.specularIntensity),void 0!==e.specularColor&&void 0!==n.specularColor&&n.specularColor.setHex(e.specularColor),void 0!==e.shininess&&(n.shininess=e.shininess),void 0!==e.clearcoat&&(n.clearcoat=e.clearcoat),void 0!==e.clearcoatRoughness&&(n.clearcoatRoughness=e.clearcoatRoughness),void 0!==e.iridescence&&(n.iridescence=e.iridescence),void 0!==e.iridescenceIOR&&(n.iridescenceIOR=e.iridescenceIOR),void 0!==e.iridescenceThicknessRange&&(n.iridescenceThicknessRange=e.iridescenceThicknessRange),void 0!==e.transmission&&(n.transmission=e.transmission),void 0!==e.thickness&&(n.thickness=e.thickness),void 0!==e.attenuationDistance&&(n.attenuationDistance=e.attenuationDistance),void 0!==e.attenuationColor&&void 0!==n.attenuationColor&&n.attenuationColor.setHex(e.attenuationColor),void 0!==e.fog&&(n.fog=e.fog),void 0!==e.flatShading&&(n.flatShading=e.flatShading),void 0!==e.blending&&(n.blending=e.blending),void 0!==e.combine&&(n.combine=e.combine),void 0!==e.side&&(n.side=e.side),void 0!==e.shadowSide&&(n.shadowSide=e.shadowSide),void 0!==e.opacity&&(n.opacity=e.opacity),void 0!==e.transparent&&(n.transparent=e.transparent),void 0!==e.alphaTest&&(n.alphaTest=e.alphaTest),void 0!==e.depthTest&&(n.depthTest=e.depthTest),void 0!==e.depthWrite&&(n.depthWrite=e.depthWrite),void 0!==e.colorWrite&&(n.colorWrite=e.colorWrite),void 0!==e.stencilWrite&&(n.stencilWrite=e.stencilWrite),void 0!==e.stencilWriteMask&&(n.stencilWriteMask=e.stencilWriteMask),void 0!==e.stencilFunc&&(n.stencilFunc=e.stencilFunc),void 0!==e.stencilRef&&(n.stencilRef=e.stencilRef),void 0!==e.stencilFuncMask&&(n.stencilFuncMask=e.stencilFuncMask),void 0!==e.stencilFail&&(n.stencilFail=e.stencilFail),void 0!==e.stencilZFail&&(n.stencilZFail=e.stencilZFail),void 0!==e.stencilZPass&&(n.stencilZPass=e.stencilZPass),void 0!==e.wireframe&&(n.wireframe=e.wireframe),void 0!==e.wireframeLinewidth&&(n.wireframeLinewidth=e.wireframeLinewidth),void 0!==e.wireframeLinecap&&(n.wireframeLinecap=e.wireframeLinecap),void 0!==e.wireframeLinejoin&&(n.wireframeLinejoin=e.wireframeLinejoin),void 0!==e.rotation&&(n.rotation=e.rotation),1!==e.linewidth&&(n.linewidth=e.linewidth),void 0!==e.dashSize&&(n.dashSize=e.dashSize),void 0!==e.gapSize&&(n.gapSize=e.gapSize),void 0!==e.scale&&(n.scale=e.scale),void 0!==e.polygonOffset&&(n.polygonOffset=e.polygonOffset),void 0!==e.polygonOffsetFactor&&(n.polygonOffsetFactor=e.polygonOffsetFactor),void 0!==e.polygonOffsetUnits&&(n.polygonOffsetUnits=e.polygonOffsetUnits),void 0!==e.dithering&&(n.dithering=e.dithering),void 0!==e.alphaToCoverage&&(n.alphaToCoverage=e.alphaToCoverage),void 0!==e.premultipliedAlpha&&(n.premultipliedAlpha=e.premultipliedAlpha),void 0!==e.forceSinglePass&&(n.forceSinglePass=e.forceSinglePass),void 0!==e.visible&&(n.visible=e.visible),void 0!==e.toneMapped&&(n.toneMapped=e.toneMapped),void 0!==e.userData&&(n.userData=e.userData),void 0!==e.vertexColors&&("number"==typeof e.vertexColors?n.vertexColors=e.vertexColors>0:n.vertexColors=e.vertexColors),void 0!==e.uniforms)for(const t in e.uniforms){const i=e.uniforms[t];switch(n.uniforms[t]={},i.type){case"t":n.uniforms[t].value=r(i.value);break;case"c":n.uniforms[t].value=(new Un).setHex(i.value);break;case"v2":n.uniforms[t].value=(new Wt).fromArray(i.value);break;case"v3":n.uniforms[t].value=(new $t).fromArray(i.value);break;case"v4":n.uniforms[t].value=(new gr).fromArray(i.value);break;case"m3":n.uniforms[t].value=(new Xt).fromArray(i.value);break;case"m4":n.uniforms[t].value=(new qr).fromArray(i.value);break;default:n.uniforms[t].value=i.value}}if(void 0!==e.defines&&(n.defines=e.defines),void 0!==e.vertexShader&&(n.vertexShader=e.vertexShader),void 0!==e.fragmentShader&&(n.fragmentShader=e.fragmentShader),void 0!==e.glslVersion&&(n.glslVersion=e.glslVersion),void 0!==e.extensions)for(const t in e.extensions)n.extensions[t]=e.extensions[t];if(void 0!==e.size&&(n.size=e.size),void 0!==e.sizeAttenuation&&(n.sizeAttenuation=e.sizeAttenuation),void 0!==e.map&&(n.map=r(e.map)),void 0!==e.matcap&&(n.matcap=r(e.matcap)),void 0!==e.alphaMap&&(n.alphaMap=r(e.alphaMap)),void 0!==e.bumpMap&&(n.bumpMap=r(e.bumpMap)),void 0!==e.bumpScale&&(n.bumpScale=e.bumpScale),void 0!==e.normalMap&&(n.normalMap=r(e.normalMap)),void 0!==e.normalMapType&&(n.normalMapType=e.normalMapType),void 0!==e.normalScale){let t=e.normalScale;!1===Array.isArray(t)&&(t=[t,t]),n.normalScale=(new Wt).fromArray(t)}return void 0!==e.displacementMap&&(n.displacementMap=r(e.displacementMap)),void 0!==e.displacementScale&&(n.displacementScale=e.displacementScale),void 0!==e.displacementBias&&(n.displacementBias=e.displacementBias),void 0!==e.roughnessMap&&(n.roughnessMap=r(e.roughnessMap)),void 0!==e.metalnessMap&&(n.metalnessMap=r(e.metalnessMap)),void 0!==e.emissiveMap&&(n.emissiveMap=r(e.emissiveMap)),void 0!==e.emissiveIntensity&&(n.emissiveIntensity=e.emissiveIntensity),void 0!==e.specularMap&&(n.specularMap=r(e.specularMap)),void 0!==e.specularIntensityMap&&(n.specularIntensityMap=r(e.specularIntensityMap)),void 0!==e.specularColorMap&&(n.specularColorMap=r(e.specularColorMap)),void 0!==e.envMap&&(n.envMap=r(e.envMap)),void 0!==e.envMapIntensity&&(n.envMapIntensity=e.envMapIntensity),void 0!==e.reflectivity&&(n.reflectivity=e.reflectivity),void 0!==e.refractionRatio&&(n.refractionRatio=e.refractionRatio),void 0!==e.lightMap&&(n.lightMap=r(e.lightMap)),void 0!==e.lightMapIntensity&&(n.lightMapIntensity=e.lightMapIntensity),void 0!==e.aoMap&&(n.aoMap=r(e.aoMap)),void 0!==e.aoMapIntensity&&(n.aoMapIntensity=e.aoMapIntensity),void 0!==e.gradientMap&&(n.gradientMap=r(e.gradientMap)),void 0!==e.clearcoatMap&&(n.clearcoatMap=r(e.clearcoatMap)),void 0!==e.clearcoatRoughnessMap&&(n.clearcoatRoughnessMap=r(e.clearcoatRoughnessMap)),void 0!==e.clearcoatNormalMap&&(n.clearcoatNormalMap=r(e.clearcoatNormalMap)),void 0!==e.clearcoatNormalScale&&(n.clearcoatNormalScale=(new Wt).fromArray(e.clearcoatNormalScale)),void 0!==e.iridescenceMap&&(n.iridescenceMap=r(e.iridescenceMap)),void 0!==e.iridescenceThicknessMap&&(n.iridescenceThicknessMap=r(e.iridescenceThicknessMap)),void 0!==e.transmissionMap&&(n.transmissionMap=r(e.transmissionMap)),void 0!==e.thicknessMap&&(n.thicknessMap=r(e.thicknessMap)),void 0!==e.sheenColorMap&&(n.sheenColorMap=r(e.sheenColorMap)),void 0!==e.sheenRoughnessMap&&(n.sheenRoughnessMap=r(e.sheenRoughnessMap)),n}setTextures(e){return this.textures=e,this}static createMaterialFromType(e){return new{ShadowMaterial:Jc,SpriteMaterial:Ta,RawShaderMaterial:Kc,ShaderMaterial:bi,PointsMaterial:_l,MeshPhysicalMaterial:$c,MeshStandardMaterial:Qc,MeshPhongMaterial:eu,MeshToonMaterial:tu,MeshNormalMaterial:ru,MeshLambertMaterial:nu,MeshDepthMaterial:ta,MeshDistanceMaterial:ra,MeshBasicMaterial:Fn,MeshMatcapMaterial:iu,LineDashedMaterial:su,LineBasicMaterial:ll,Material:jn}[e]}}class th{static decodeText(e){if("undefined"!=typeof TextDecoder)return(new TextDecoder).decode(e);let t="";for(let r=0,n=e.length;r<n;r++)t+=String.fromCharCode(e[r]);try{return decodeURIComponent(escape(t))}catch(e){return t}}static extractUrlBase(e){const t=e.lastIndexOf("/");return-1===t?"./":e.slice(0,t+1)}static resolveURL(e,t){return"string"!=typeof e||""===e?"":(/^https?:\/\//i.test(t)&&/^\//.test(e)&&(t=t.replace(/(^https?:\/\/[^\/]+).*/i,"$1")),/^(https?:)?\/\//i.test(e)||/^data:.*,.*$/i.test(e)||/^blob:.*$/i.test(e)?e:t+e)}}class rh extends $n{constructor(){super(),this.isInstancedBufferGeometry=!0,this.type="InstancedBufferGeometry",this.instanceCount=1/0}copy(e){return super.copy(e),this.instanceCount=e.instanceCount,this}toJSON(){const e=super.toJSON();return e.instanceCount=this.instanceCount,e.isInstancedBufferGeometry=!0,e}}class nh extends Ru{constructor(e){super(e)}load(e,t,r,n){const i=this,s=new Iu(i.manager);s.setPath(i.path),s.setRequestHeader(i.requestHeader),s.setWithCredentials(i.withCredentials),s.load(e,(function(r){try{t(i.parse(JSON.parse(r)))}catch(t){n&&n(t),i.manager.itemError(e)}}),r,n)}parse(e){const t={},r={};function n(e,n){if(void 0!==t[n])return t[n];const i=e.interleavedBuffers[n],s=function(e,t){if(void 0!==r[t])return r[t];const n=e.arrayBuffers,i=n[t],s=new Uint32Array(i).buffer;return r[t]=s,s}(e,i.buffer),o=Jt(i.type,s),a=new wa(o,i.stride);return a.uuid=i.uuid,t[n]=a,a}const i=e.isInstancedBufferGeometry?new rh:new $n,s=e.data.index;if(void 0!==s){const e=Jt(s.type,s.array);i.setIndex(new Gn(e,1))}const o=e.data.attributes;for(const t in o){const r=o[t];let s;if(r.isInterleavedBufferAttribute){const t=n(e.data,r.data);s=new Ma(t,r.itemSize,r.offset,r.normalized)}else{const e=Jt(r.type,r.array);s=new(r.isInstancedBufferAttribute?tl:Gn)(e,r.itemSize,r.normalized)}void 0!==r.name&&(s.name=r.name),void 0!==r.usage&&s.setUsage(r.usage),void 0!==r.updateRange&&(s.updateRange.offset=r.updateRange.offset,s.updateRange.count=r.updateRange.count),i.setAttribute(t,s)}const a=e.data.morphAttributes;if(a)for(const t in a){const r=a[t],s=[];for(let t=0,i=r.length;t<i;t++){const i=r[t];let o;if(i.isInterleavedBufferAttribute){const t=n(e.data,i.data);o=new Ma(t,i.itemSize,i.offset,i.normalized)}else{const e=Jt(i.type,i.array);o=new Gn(e,i.itemSize,i.normalized)}void 0!==i.name&&(o.name=i.name),s.push(o)}i.morphAttributes[t]=s}e.data.morphTargetsRelative&&(i.morphTargetsRelative=!0);const l=e.data.groups||e.data.drawcalls||e.data.offsets;if(void 0!==l)for(let e=0,t=l.length;e!==t;++e){const t=l[e];i.addGroup(t.start,t.count,t.materialIndex)}const c=e.data.boundingSphere;if(void 0!==c){const e=new $t;void 0!==c.center&&e.fromArray(c.center),i.boundingSphere=new kr(e,c.radius)}return e.name&&(i.name=e.name),e.userData&&(i.userData=e.userData),i}}const ih={UVMapping:K,CubeReflectionMapping:Q,CubeRefractionMapping:$,EquirectangularReflectionMapping:ee,EquirectangularRefractionMapping:te,CubeUVReflectionMapping:re},sh={RepeatWrapping:ne,ClampToEdgeWrapping:ie,MirroredRepeatWrapping:se},oh={NearestFilter:oe,NearestMipmapNearestFilter:ae,NearestMipmapLinearFilter:le,LinearFilter:ce,LinearMipmapNearestFilter:ue,LinearMipmapLinearFilter:he};let ah;class lh{static getContext(){return void 0===ah&&(ah=new(window.AudioContext||window.webkitAudioContext)),ah}static setContext(e){ah=e}}const ch=new qr,uh=new qr,hh=new qr;class dh{constructor(e=!0){this.autoStart=e,this.startTime=0,this.oldTime=0,this.elapsedTime=0,this.running=!1}start(){this.startTime=ph(),this.oldTime=this.startTime,this.elapsedTime=0,this.running=!0}stop(){this.getElapsedTime(),this.running=!1,this.autoStart=!1}getElapsedTime(){return this.getDelta(),this.elapsedTime}getDelta(){let e=0;if(this.autoStart&&!this.running)return this.start(),0;if(this.running){const t=ph();e=(t-this.oldTime)/1e3,this.oldTime=t,this.elapsedTime+=e}return e}}function ph(){return("undefined"==typeof performance?Date:performance).now()}const fh=new $t,mh=new Qt,gh=new $t,yh=new $t;class vh extends _n{constructor(e){super(),this.type="Audio",this.listener=e,this.context=e.context,this.gain=this.context.createGain(),this.gain.connect(e.getInput()),this.autoplay=!1,this.buffer=null,this.detune=0,this.loop=!1,this.loopStart=0,this.loopEnd=0,this.offset=0,this.duration=void 0,this.playbackRate=1,this.isPlaying=!1,this.hasPlaybackControl=!0,this.source=null,this.sourceType="empty",this._startedAt=0,this._progress=0,this._connected=!1,this.filters=[]}getOutput(){return this.gain}setNodeSource(e){return this.hasPlaybackControl=!1,this.sourceType="audioNode",this.source=e,this.connect(),this}setMediaElementSource(e){return this.hasPlaybackControl=!1,this.sourceType="mediaNode",this.source=this.context.createMediaElementSource(e),this.connect(),this}setMediaStreamSource(e){return this.hasPlaybackControl=!1,this.sourceType="mediaStreamNode",this.source=this.context.createMediaStreamSource(e),this.connect(),this}setBuffer(e){return this.buffer=e,this.sourceType="buffer",this.autoplay&&this.play(),this}play(e=0){if(!0===this.isPlaying)return;if(!1===this.hasPlaybackControl)return;this._startedAt=this.context.currentTime+e;const t=this.context.createBufferSource();return t.buffer=this.buffer,t.loop=this.loop,t.loopStart=this.loopStart,t.loopEnd=this.loopEnd,t.onended=this.onEnded.bind(this),t.start(this._startedAt,this._progress+this.offset,this.duration),this.isPlaying=!0,this.source=t,this.setDetune(this.detune),this.setPlaybackRate(this.playbackRate),this.connect()}pause(){if(!1!==this.hasPlaybackControl)return!0===this.isPlaying&&(this._progress+=Math.max(this.context.currentTime-this._startedAt,0)*this.playbackRate,!0===this.loop&&(this._progress=this._progress%(this.duration||this.buffer.duration)),this.source.stop(),this.source.onended=null,this.isPlaying=!1),this}stop(){if(!1!==this.hasPlaybackControl)return this._progress=0,null!==this.source&&(this.source.stop(),this.source.onended=null),this.isPlaying=!1,this}connect(){if(this.filters.length>0){this.source.connect(this.filters[0]);for(let e=1,t=this.filters.length;e<t;e++)this.filters[e-1].connect(this.filters[e]);this.filters[this.filters.length-1].connect(this.getOutput())}else this.source.connect(this.getOutput());return this._connected=!0,this}disconnect(){if(this.filters.length>0){this.source.disconnect(this.filters[0]);for(let e=1,t=this.filters.length;e<t;e++)this.filters[e-1].disconnect(this.filters[e]);this.filters[this.filters.length-1].disconnect(this.getOutput())}else this.source.disconnect(this.getOutput());return this._connected=!1,this}getFilters(){return this.filters}setFilters(e){return e||(e=[]),!0===this._connected?(this.disconnect(),this.filters=e.slice(),this.connect()):this.filters=e.slice(),this}setDetune(e){if(this.detune=e,void 0!==this.source.detune)return!0===this.isPlaying&&this.source.detune.setTargetAtTime(this.detune,this.context.currentTime,.01),this}getDetune(){return this.detune}getFilter(){return this.getFilters()[0]}setFilter(e){return this.setFilters(e?[e]:[])}setPlaybackRate(e){if(!1!==this.hasPlaybackControl)return this.playbackRate=e,!0===this.isPlaying&&this.source.playbackRate.setTargetAtTime(this.playbackRate,this.context.currentTime,.01),this}getPlaybackRate(){return this.playbackRate}onEnded(){this.isPlaying=!1}getLoop(){return!1!==this.hasPlaybackControl&&this.loop}setLoop(e){if(!1!==this.hasPlaybackControl)return this.loop=e,!0===this.isPlaying&&(this.source.loop=this.loop),this}setLoopStart(e){return this.loopStart=e,this}setLoopEnd(e){return this.loopEnd=e,this}getVolume(){return this.gain.gain.value}setVolume(e){return this.gain.gain.setTargetAtTime(e,this.context.currentTime,.01),this}}const _h=new $t,xh=new Qt,bh=new $t,wh=new $t;class Sh{constructor(e,t,r){let n,i,s;switch(this.binding=e,this.valueSize=r,t){case"quaternion":n=this._slerp,i=this._slerpAdditive,s=this._setAdditiveIdentityQuaternion,this.buffer=new Float64Array(6*r),this._workIndex=5;break;case"string":case"bool":n=this._select,i=this._select,s=this._setAdditiveIdentityOther,this.buffer=new Array(5*r);break;default:n=this._lerp,i=this._lerpAdditive,s=this._setAdditiveIdentityNumeric,this.buffer=new Float64Array(5*r)}this._mixBufferRegion=n,this._mixBufferRegionAdditive=i,this._setIdentity=s,this._origIndex=3,this._addIndex=4,this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,this.useCount=0,this.referenceCount=0}accumulate(e,t){const r=this.buffer,n=this.valueSize,i=e*n+n;let s=this.cumulativeWeight;if(0===s){for(let e=0;e!==n;++e)r[i+e]=r[e];s=t}else{s+=t;const e=t/s;this._mixBufferRegion(r,i,0,e,n)}this.cumulativeWeight=s}accumulateAdditive(e){const t=this.buffer,r=this.valueSize,n=r*this._addIndex;0===this.cumulativeWeightAdditive&&this._setIdentity(),this._mixBufferRegionAdditive(t,n,0,e,r),this.cumulativeWeightAdditive+=e}apply(e){const t=this.valueSize,r=this.buffer,n=e*t+t,i=this.cumulativeWeight,s=this.cumulativeWeightAdditive,o=this.binding;if(this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,i<1){const e=t*this._origIndex;this._mixBufferRegion(r,n,e,1-i,t)}s>0&&this._mixBufferRegionAdditive(r,n,this._addIndex*t,1,t);for(let e=t,i=t+t;e!==i;++e)if(r[e]!==r[e+t]){o.setValue(r,n);break}}saveOriginalState(){const e=this.binding,t=this.buffer,r=this.valueSize,n=r*this._origIndex;e.getValue(t,n);for(let e=r,i=n;e!==i;++e)t[e]=t[n+e%r];this._setIdentity(),this.cumulativeWeight=0,this.cumulativeWeightAdditive=0}restoreOriginalState(){const e=3*this.valueSize;this.binding.setValue(this.buffer,e)}_setAdditiveIdentityNumeric(){const e=this._addIndex*this.valueSize,t=e+this.valueSize;for(let r=e;r<t;r++)this.buffer[r]=0}_setAdditiveIdentityQuaternion(){this._setAdditiveIdentityNumeric(),this.buffer[this._addIndex*this.valueSize+3]=1}_setAdditiveIdentityOther(){const e=this._origIndex*this.valueSize,t=this._addIndex*this.valueSize;for(let r=0;r<this.valueSize;r++)this.buffer[t+r]=this.buffer[e+r]}_select(e,t,r,n,i){if(n>=.5)for(let n=0;n!==i;++n)e[t+n]=e[r+n]}_slerp(e,t,r,n){Qt.slerpFlat(e,t,e,t,e,r,n)}_slerpAdditive(e,t,r,n,i){const s=this._workIndex*i;Qt.multiplyQuaternionsFlat(e,s,e,t,e,r),Qt.slerpFlat(e,t,e,t,e,s,n)}_lerp(e,t,r,n,i){const s=1-n;for(let o=0;o!==i;++o){const i=t+o;e[i]=e[i]*s+e[r+o]*n}}_lerpAdditive(e,t,r,n,i){for(let s=0;s!==i;++s){const i=t+s;e[i]=e[i]+e[r+s]*n}}}const Mh="\\[\\]\\.:\\/",Th=new RegExp("["+Mh+"]","g"),Eh="[^"+Mh+"]",Ah="[^"+Mh.replace("\\.","")+"]",Ch=new RegExp("^"+/((?:WC+[\/:])*)/.source.replace("WC",Eh)+/(WCOD+)?/.source.replace("WCOD",Ah)+/(?:\.(WC+)(?:\[(.+)\])?)?/.source.replace("WC",Eh)+/\.(WC+)(?:\[(.+)\])?/.source.replace("WC",Eh)+"$"),Lh=["material","materials","bones","map"];class Rh{constructor(e,t,r){this.path=t,this.parsedPath=r||Rh.parseTrackName(t),this.node=Rh.findNode(e,this.parsedPath.nodeName),this.rootNode=e,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}static create(e,t,r){return e&&e.isAnimationObjectGroup?new Rh.Composite(e,t,r):new Rh(e,t,r)}static sanitizeNodeName(e){return e.replace(/\s/g,"_").replace(Th,"")}static parseTrackName(e){const t=Ch.exec(e);if(null===t)throw new Error("PropertyBinding: Cannot parse trackName: "+e);const r={nodeName:t[2],objectName:t[3],objectIndex:t[4],propertyName:t[5],propertyIndex:t[6]},n=r.nodeName&&r.nodeName.lastIndexOf(".");if(void 0!==n&&-1!==n){const e=r.nodeName.substring(n+1);-1!==Lh.indexOf(e)&&(r.nodeName=r.nodeName.substring(0,n),r.objectName=e)}if(null===r.propertyName||0===r.propertyName.length)throw new Error("PropertyBinding: can not parse propertyName from trackName: "+e);return r}static findNode(e,t){if(void 0===t||""===t||"."===t||-1===t||t===e.name||t===e.uuid)return e;if(e.skeleton){const r=e.skeleton.getBoneByName(t);if(void 0!==r)return r}if(e.children){const r=function(e){for(let n=0;n<e.length;n++){const i=e[n];if(i.name===t||i.uuid===t)return i;const s=r(i.children);if(s)return s}return null},n=r(e.children);if(n)return n}return null}_getValue_unavailable(){}_setValue_unavailable(){}_getValue_direct(e,t){e[t]=this.targetObject[this.propertyName]}_getValue_array(e,t){const r=this.resolvedProperty;for(let n=0,i=r.length;n!==i;++n)e[t++]=r[n]}_getValue_arrayElement(e,t){e[t]=this.resolvedProperty[this.propertyIndex]}_getValue_toArray(e,t){this.resolvedProperty.toArray(e,t)}_setValue_direct(e,t){this.targetObject[this.propertyName]=e[t]}_setValue_direct_setNeedsUpdate(e,t){this.targetObject[this.propertyName]=e[t],this.targetObject.needsUpdate=!0}_setValue_direct_setMatrixWorldNeedsUpdate(e,t){this.targetObject[this.propertyName]=e[t],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_array(e,t){const r=this.resolvedProperty;for(let n=0,i=r.length;n!==i;++n)r[n]=e[t++]}_setValue_array_setNeedsUpdate(e,t){const r=this.resolvedProperty;for(let n=0,i=r.length;n!==i;++n)r[n]=e[t++];this.targetObject.needsUpdate=!0}_setValue_array_setMatrixWorldNeedsUpdate(e,t){const r=this.resolvedProperty;for(let n=0,i=r.length;n!==i;++n)r[n]=e[t++];this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_arrayElement(e,t){this.resolvedProperty[this.propertyIndex]=e[t]}_setValue_arrayElement_setNeedsUpdate(e,t){this.resolvedProperty[this.propertyIndex]=e[t],this.targetObject.needsUpdate=!0}_setValue_arrayElement_setMatrixWorldNeedsUpdate(e,t){this.resolvedProperty[this.propertyIndex]=e[t],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_fromArray(e,t){this.resolvedProperty.fromArray(e,t)}_setValue_fromArray_setNeedsUpdate(e,t){this.resolvedProperty.fromArray(e,t),this.targetObject.needsUpdate=!0}_setValue_fromArray_setMatrixWorldNeedsUpdate(e,t){this.resolvedProperty.fromArray(e,t),this.targetObject.matrixWorldNeedsUpdate=!0}_getValue_unbound(e,t){this.bind(),this.getValue(e,t)}_setValue_unbound(e,t){this.bind(),this.setValue(e,t)}bind(){let e=this.node;const t=this.parsedPath,r=t.objectName,n=t.propertyName;let i=t.propertyIndex;if(e||(e=Rh.findNode(this.rootNode,t.nodeName),this.node=e),this.getValue=this._getValue_unavailable,this.setValue=this._setValue_unavailable,!e)return;if(r){let n=t.objectIndex;switch(r){case"materials":if(!e.material)return;if(!e.material.materials)return;e=e.material.materials;break;case"bones":if(!e.skeleton)return;e=e.skeleton.bones;for(let t=0;t<e.length;t++)if(e[t].name===n){n=t;break}break;case"map":if("map"in e){e=e.map;break}if(!e.material)return;if(!e.material.map)return;e=e.material.map;break;default:if(void 0===e[r])return;e=e[r]}if(void 0!==n){if(void 0===e[n])return;e=e[n]}}const s=e[n];if(void 0===s){t.nodeName;return}let o=this.Versioning.None;this.targetObject=e,void 0!==e.needsUpdate?o=this.Versioning.NeedsUpdate:void 0!==e.matrixWorldNeedsUpdate&&(o=this.Versioning.MatrixWorldNeedsUpdate);let a=this.BindingType.Direct;if(void 0!==i){if("morphTargetInfluences"===n){if(!e.geometry)return;if(!e.geometry.morphAttributes)return;void 0!==e.morphTargetDictionary[i]&&(i=e.morphTargetDictionary[i])}a=this.BindingType.ArrayElement,this.resolvedProperty=s,this.propertyIndex=i}else void 0!==s.fromArray&&void 0!==s.toArray?(a=this.BindingType.HasFromToArray,this.resolvedProperty=s):Array.isArray(s)?(a=this.BindingType.EntireArray,this.resolvedProperty=s):this.propertyName=n;this.getValue=this.GetterByBindingType[a],this.setValue=this.SetterByBindingTypeAndVersioning[a][o]}unbind(){this.node=null,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}}Rh.Composite=class{constructor(e,t,r){const n=r||Rh.parseTrackName(t);this._targetGroup=e,this._bindings=e.subscribe_(t,n)}getValue(e,t){this.bind();const r=this._targetGroup.nCachedObjects_,n=this._bindings[r];void 0!==n&&n.getValue(e,t)}setValue(e,t){const r=this._bindings;for(let n=this._targetGroup.nCachedObjects_,i=r.length;n!==i;++n)r[n].setValue(e,t)}bind(){const e=this._bindings;for(let t=this._targetGroup.nCachedObjects_,r=e.length;t!==r;++t)e[t].bind()}unbind(){const e=this._bindings;for(let t=this._targetGroup.nCachedObjects_,r=e.length;t!==r;++t)e[t].unbind()}},Rh.prototype.BindingType={Direct:0,EntireArray:1,ArrayElement:2,HasFromToArray:3},Rh.prototype.Versioning={None:0,NeedsUpdate:1,MatrixWorldNeedsUpdate:2},Rh.prototype.GetterByBindingType=[Rh.prototype._getValue_direct,Rh.prototype._getValue_array,Rh.prototype._getValue_arrayElement,Rh.prototype._getValue_toArray],Rh.prototype.SetterByBindingTypeAndVersioning=[[Rh.prototype._setValue_direct,Rh.prototype._setValue_direct_setNeedsUpdate,Rh.prototype._setValue_direct_setMatrixWorldNeedsUpdate],[Rh.prototype._setValue_array,Rh.prototype._setValue_array_setNeedsUpdate,Rh.prototype._setValue_array_setMatrixWorldNeedsUpdate],[Rh.prototype._setValue_arrayElement,Rh.prototype._setValue_arrayElement_setNeedsUpdate,Rh.prototype._setValue_arrayElement_setMatrixWorldNeedsUpdate],[Rh.prototype._setValue_fromArray,Rh.prototype._setValue_fromArray_setNeedsUpdate,Rh.prototype._setValue_fromArray_setMatrixWorldNeedsUpdate]];class Ph{constructor(e,t,r=null,n=t.blendMode){this._mixer=e,this._clip=t,this._localRoot=r,this.blendMode=n;const i=t.tracks,s=i.length,o=new Array(s),a={endingStart:pt,endingEnd:pt};for(let e=0;e!==s;++e){const t=i[e].createInterpolant(null);o[e]=t,t.settings=a}this._interpolantSettings=a,this._interpolants=o,this._propertyBindings=new Array(s),this._cacheIndex=null,this._byClipCacheIndex=null,this._timeScaleInterpolant=null,this._weightInterpolant=null,this.loop=2201,this._loopCount=-1,this._startTime=null,this.time=0,this.timeScale=1,this._effectiveTimeScale=1,this.weight=1,this._effectiveWeight=1,this.repetitions=1/0,this.paused=!1,this.enabled=!0,this.clampWhenFinished=!1,this.zeroSlopeAtStart=!0,this.zeroSlopeAtEnd=!0}play(){return this._mixer._activateAction(this),this}stop(){return this._mixer._deactivateAction(this),this.reset()}reset(){return this.paused=!1,this.enabled=!0,this.time=0,this._loopCount=-1,this._startTime=null,this.stopFading().stopWarping()}isRunning(){return this.enabled&&!this.paused&&0!==this.timeScale&&null===this._startTime&&this._mixer._isActiveAction(this)}isScheduled(){return this._mixer._isActiveAction(this)}startAt(e){return this._startTime=e,this}setLoop(e,t){return this.loop=e,this.repetitions=t,this}setEffectiveWeight(e){return this.weight=e,this._effectiveWeight=this.enabled?e:0,this.stopFading()}getEffectiveWeight(){return this._effectiveWeight}fadeIn(e){return this._scheduleFading(e,0,1)}fadeOut(e){return this._scheduleFading(e,1,0)}crossFadeFrom(e,t,r){if(e.fadeOut(t),this.fadeIn(t),r){const r=this._clip.duration,n=e._clip.duration,i=n/r,s=r/n;e.warp(1,i,t),this.warp(s,1,t)}return this}crossFadeTo(e,t,r){return e.crossFadeFrom(this,t,r)}stopFading(){const e=this._weightInterpolant;return null!==e&&(this._weightInterpolant=null,this._mixer._takeBackControlInterpolant(e)),this}setEffectiveTimeScale(e){return this.timeScale=e,this._effectiveTimeScale=this.paused?0:e,this.stopWarping()}getEffectiveTimeScale(){return this._effectiveTimeScale}setDuration(e){return this.timeScale=this._clip.duration/e,this.stopWarping()}syncWith(e){return this.time=e.time,this.timeScale=e.timeScale,this.stopWarping()}halt(e){return this.warp(this._effectiveTimeScale,0,e)}warp(e,t,r){const n=this._mixer,i=n.time,s=this.timeScale;let o=this._timeScaleInterpolant;null===o&&(o=n._lendControlInterpolant(),this._timeScaleInterpolant=o);const a=o.parameterPositions,l=o.sampleValues;return a[0]=i,a[1]=i+r,l[0]=e/s,l[1]=t/s,this}stopWarping(){const e=this._timeScaleInterpolant;return null!==e&&(this._timeScaleInterpolant=null,this._mixer._takeBackControlInterpolant(e)),this}getMixer(){return this._mixer}getClip(){return this._clip}getRoot(){return this._localRoot||this._mixer._root}_update(e,t,r,n){if(!this.enabled)return void this._updateWeight(e);const i=this._startTime;if(null!==i){const n=(e-i)*r;n<0||0===r?t=0:(this._startTime=null,t=r*n)}t*=this._updateTimeScale(e);const s=this._updateTime(t),o=this._updateWeight(e);if(o>0){const e=this._interpolants,t=this._propertyBindings;if(this.blendMode===yt)for(let r=0,n=e.length;r!==n;++r)e[r].evaluate(s),t[r].accumulateAdditive(o);else for(let r=0,i=e.length;r!==i;++r)e[r].evaluate(s),t[r].accumulate(n,o)}}_updateWeight(e){let t=0;if(this.enabled){t=this.weight;const r=this._weightInterpolant;if(null!==r){const n=r.evaluate(e)[0];t*=n,e>r.parameterPositions[1]&&(this.stopFading(),0===n&&(this.enabled=!1))}}return this._effectiveWeight=t,t}_updateTimeScale(e){let t=0;if(!this.paused){t=this.timeScale;const r=this._timeScaleInterpolant;if(null!==r){t*=r.evaluate(e)[0],e>r.parameterPositions[1]&&(this.stopWarping(),0===t?this.paused=!0:this.timeScale=t)}}return this._effectiveTimeScale=t,t}_updateTime(e){const t=this._clip.duration,r=this.loop;let n=this.time+e,i=this._loopCount;const s=2202===r;if(0===e)return-1===i?n:s&&1==(1&i)?t-n:n;if(2200===r){-1===i&&(this._loopCount=0,this._setEndings(!0,!0,!1));e:{if(n>=t)n=t;else{if(!(n<0)){this.time=n;break e}n=0}this.clampWhenFinished?this.paused=!0:this.enabled=!1,this.time=n,this._mixer.dispatchEvent({type:"finished",action:this,direction:e<0?-1:1})}}else{if(-1===i&&(e>=0?(i=0,this._setEndings(!0,0===this.repetitions,s)):this._setEndings(0===this.repetitions,!0,s)),n>=t||n<0){const r=Math.floor(n/t);n-=t*r,i+=Math.abs(r);const o=this.repetitions-i;if(o<=0)this.clampWhenFinished?this.paused=!0:this.enabled=!1,n=e>0?t:0,this.time=n,this._mixer.dispatchEvent({type:"finished",action:this,direction:e>0?1:-1});else{if(1===o){const t=e<0;this._setEndings(t,!t,s)}else this._setEndings(!1,!1,s);this._loopCount=i,this.time=n,this._mixer.dispatchEvent({type:"loop",action:this,loopDelta:r})}}else this.time=n;if(s&&1==(1&i))return t-n}return n}_setEndings(e,t,r){const n=this._interpolantSettings;r?(n.endingStart=ft,n.endingEnd=ft):(n.endingStart=e?this.zeroSlopeAtStart?ft:pt:mt,n.endingEnd=t?this.zeroSlopeAtEnd?ft:pt:mt)}_scheduleFading(e,t,r){const n=this._mixer,i=n.time;let s=this._weightInterpolant;null===s&&(s=n._lendControlInterpolant(),this._weightInterpolant=s);const o=s.parameterPositions,a=s.sampleValues;return o[0]=i,a[0]=t,o[1]=i+e,a[1]=r,this}}const jh=new Float32Array(1);class Ih{constructor(e){this.value=e}clone(){return new Ih(void 0===this.value.clone?this.value:this.value.clone())}}let Dh=0;function Oh(e,t){return e.distance-t.distance}function Nh(e,t,r,n){if(e.layers.test(t.layers)&&e.raycast(t,r),!0===n){const n=e.children;for(let e=0,i=n.length;e<i;e++)Nh(n[e],t,r,!0)}}const Uh=new Wt;const kh=new $t,Fh=new $t;const Bh=new $t;const zh=new $t,Gh=new qr,Vh=new qr;function Hh(e){const t=[];!0===e.isBone&&t.push(e);for(let r=0;r<e.children.length;r++)t.push.apply(t,Hh(e.children[r]));return t}const Wh=new $t,Xh=new Un,qh=new Un;const Yh=new $t,Zh=new $t,Jh=new $t;const Kh=new $t,Qh=new wi;function $h(e,t,r,n,i,s,o){Kh.set(i,s,o).unproject(n);const a=t[e];if(void 0!==a){const e=r.getAttribute("position");for(let t=0,r=a.length;t<r;t++)e.setXYZ(a[t],Kh.x,Kh.y,Kh.z)}}const ed=new xr;const td=new $t;let rd,nd;const id=sd();function sd(){const e=new ArrayBuffer(4),t=new Float32Array(e),r=new Uint32Array(e),n=new Uint32Array(512),i=new Uint32Array(512);for(let e=0;e<256;++e){const t=e-127;t<-27?(n[e]=0,n[256|e]=32768,i[e]=24,i[256|e]=24):t<-14?(n[e]=1024>>-t-14,n[256|e]=1024>>-t-14|32768,i[e]=-t-1,i[256|e]=-t-1):t<=15?(n[e]=t+15<<10,n[256|e]=t+15<<10|32768,i[e]=13,i[256|e]=13):t<128?(n[e]=31744,n[256|e]=64512,i[e]=24,i[256|e]=24):(n[e]=31744,n[256|e]=64512,i[e]=13,i[256|e]=13)}const s=new Uint32Array(2048),o=new Uint32Array(64),a=new Uint32Array(64);for(let e=1;e<1024;++e){let t=e<<13,r=0;for(;0==(8388608&t);)t<<=1,r-=8388608;t&=-8388609,r+=947912704,s[e]=t|r}for(let e=1024;e<2048;++e)s[e]=939524096+(e-1024<<13);for(let e=1;e<31;++e)o[e]=e<<23;o[31]=1199570944,o[32]=2147483648;for(let e=33;e<63;++e)o[e]=2147483648+(e-32<<23);o[63]=3347054592;for(let e=1;e<64;++e)32!==e&&(a[e]=1024);return{floatView:t,uint32View:r,baseTable:n,shiftTable:i,mantissaTable:s,exponentTable:o,offsetTable:a}}const od={toHalfFloat:function(e){Math.abs(e),e=Nt(e,-65504,65504),id.floatView[0]=e;const t=id.uint32View[0],r=t>>23&511;return id.baseTable[r]+((8388607&t)>>id.shiftTable[r])},fromHalfFloat:function(e){const t=e>>10;return id.uint32View[0]=id.mantissaTable[id.offsetTable[t]+(1023&e)]+id.exponentTable[t],id.floatView[0]}};"undefined"!=typeof __THREE_DEVTOOLS__&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("register",{detail:{revision:r}})),"undefined"!=typeof window&&(window.__THREE__||(window.__THREE__=r)),t.ACESFilmicToneMapping=Z,t.AddEquation=v,t.AddOperation=H,t.AdditiveAnimationBlendMode=yt,t.AdditiveBlending=f,t.AlphaFormat=Se,t.AlwaysDepth=O,t.AlwaysStencilFunc=519,t.AmbientLight=Ju,t.AmbientLightProbe=class extends $u{constructor(e,t=1){super(void 0,t),this.isAmbientLightProbe=!0;const r=(new Un).set(e);this.sh.coefficients[0].set(r.r,r.g,r.b).multiplyScalar(2*Math.sqrt(Math.PI))}},t.AnimationClip=Tu,t.AnimationLoader=class extends Ru{constructor(e){super(e)}load(e,t,r,n){const i=this,s=new Iu(this.manager);s.setPath(this.path),s.setRequestHeader(this.requestHeader),s.setWithCredentials(this.withCredentials),s.load(e,(function(r){try{t(i.parse(JSON.parse(r)))}catch(t){n&&n(t),i.manager.itemError(e)}}),r,n)}parse(e){const t=[];for(let r=0;r<e.length;r++){const n=Tu.parse(e[r]);t.push(n)}return t}},t.AnimationMixer=class extends Rt{constructor(e){super(),this._root=e,this._initMemoryManager(),this._accuIndex=0,this.time=0,this.timeScale=1}_bindAction(e,t){const r=e._localRoot||this._root,n=e._clip.tracks,i=n.length,s=e._propertyBindings,o=e._interpolants,a=r.uuid,l=this._bindingsByRootAndName;let c=l[a];void 0===c&&(c={},l[a]=c);for(let e=0;e!==i;++e){const i=n[e],l=i.name;let u=c[l];if(void 0!==u)++u.referenceCount,s[e]=u;else{if(u=s[e],void 0!==u){null===u._cacheIndex&&(++u.referenceCount,this._addInactiveBinding(u,a,l));continue}const n=t&&t._propertyBindings[e].binding.parsedPath;u=new Sh(Rh.create(r,l,n),i.ValueTypeName,i.getValueSize()),++u.referenceCount,this._addInactiveBinding(u,a,l),s[e]=u}o[e].resultBuffer=u.buffer}}_activateAction(e){if(!this._isActiveAction(e)){if(null===e._cacheIndex){const t=(e._localRoot||this._root).uuid,r=e._clip.uuid,n=this._actionsByClip[r];this._bindAction(e,n&&n.knownActions[0]),this._addInactiveAction(e,r,t)}const t=e._propertyBindings;for(let e=0,r=t.length;e!==r;++e){const r=t[e];0==r.useCount++&&(this._lendBinding(r),r.saveOriginalState())}this._lendAction(e)}}_deactivateAction(e){if(this._isActiveAction(e)){const t=e._propertyBindings;for(let e=0,r=t.length;e!==r;++e){const r=t[e];0==--r.useCount&&(r.restoreOriginalState(),this._takeBackBinding(r))}this._takeBackAction(e)}}_initMemoryManager(){this._actions=[],this._nActiveActions=0,this._actionsByClip={},this._bindings=[],this._nActiveBindings=0,this._bindingsByRootAndName={},this._controlInterpolants=[],this._nActiveControlInterpolants=0;const e=this;this.stats={actions:{get total(){return e._actions.length},get inUse(){return e._nActiveActions}},bindings:{get total(){return e._bindings.length},get inUse(){return e._nActiveBindings}},controlInterpolants:{get total(){return e._controlInterpolants.length},get inUse(){return e._nActiveControlInterpolants}}}}_isActiveAction(e){const t=e._cacheIndex;return null!==t&&t<this._nActiveActions}_addInactiveAction(e,t,r){const n=this._actions,i=this._actionsByClip;let s=i[t];if(void 0===s)s={knownActions:[e],actionByRoot:{}},e._byClipCacheIndex=0,i[t]=s;else{const t=s.knownActions;e._byClipCacheIndex=t.length,t.push(e)}e._cacheIndex=n.length,n.push(e),s.actionByRoot[r]=e}_removeInactiveAction(e){const t=this._actions,r=t[t.length-1],n=e._cacheIndex;r._cacheIndex=n,t[n]=r,t.pop(),e._cacheIndex=null;const i=e._clip.uuid,s=this._actionsByClip,o=s[i],a=o.knownActions,l=a[a.length-1],c=e._byClipCacheIndex;l._byClipCacheIndex=c,a[c]=l,a.pop(),e._byClipCacheIndex=null;delete o.actionByRoot[(e._localRoot||this._root).uuid],0===a.length&&delete s[i],this._removeInactiveBindingsForAction(e)}_removeInactiveBindingsForAction(e){const t=e._propertyBindings;for(let e=0,r=t.length;e!==r;++e){const r=t[e];0==--r.referenceCount&&this._removeInactiveBinding(r)}}_lendAction(e){const t=this._actions,r=e._cacheIndex,n=this._nActiveActions++,i=t[n];e._cacheIndex=n,t[n]=e,i._cacheIndex=r,t[r]=i}_takeBackAction(e){const t=this._actions,r=e._cacheIndex,n=--this._nActiveActions,i=t[n];e._cacheIndex=n,t[n]=e,i._cacheIndex=r,t[r]=i}_addInactiveBinding(e,t,r){const n=this._bindingsByRootAndName,i=this._bindings;let s=n[t];void 0===s&&(s={},n[t]=s),s[r]=e,e._cacheIndex=i.length,i.push(e)}_removeInactiveBinding(e){const t=this._bindings,r=e.binding,n=r.rootNode.uuid,i=r.path,s=this._bindingsByRootAndName,o=s[n],a=t[t.length-1],l=e._cacheIndex;a._cacheIndex=l,t[l]=a,t.pop(),delete o[i],0===Object.keys(o).length&&delete s[n]}_lendBinding(e){const t=this._bindings,r=e._cacheIndex,n=this._nActiveBindings++,i=t[n];e._cacheIndex=n,t[n]=e,i._cacheIndex=r,t[r]=i}_takeBackBinding(e){const t=this._bindings,r=e._cacheIndex,n=--this._nActiveBindings,i=t[n];e._cacheIndex=n,t[n]=e,i._cacheIndex=r,t[r]=i}_lendControlInterpolant(){const e=this._controlInterpolants,t=this._nActiveControlInterpolants++;let r=e[t];return void 0===r&&(r=new mu(new Float32Array(2),new Float32Array(2),1,jh),r.__cacheIndex=t,e[t]=r),r}_takeBackControlInterpolant(e){const t=this._controlInterpolants,r=e.__cacheIndex,n=--this._nActiveControlInterpolants,i=t[n];e.__cacheIndex=n,t[n]=e,i.__cacheIndex=r,t[r]=i}clipAction(e,t,r){const n=t||this._root,i=n.uuid;let s="string"==typeof e?Tu.findByName(n,e):e;const o=null!==s?s.uuid:e,a=this._actionsByClip[o];let l=null;if(void 0===r&&(r=null!==s?s.blendMode:gt),void 0!==a){const e=a.actionByRoot[i];if(void 0!==e&&e.blendMode===r)return e;l=a.knownActions[0],null===s&&(s=l._clip)}if(null===s)return null;const c=new Ph(this,s,t,r);return this._bindAction(c,l),this._addInactiveAction(c,o,i),c}existingAction(e,t){const r=t||this._root,n=r.uuid,i="string"==typeof e?Tu.findByName(r,e):e,s=i?i.uuid:e,o=this._actionsByClip[s];return void 0!==o&&o.actionByRoot[n]||null}stopAllAction(){const e=this._actions;for(let t=this._nActiveActions-1;t>=0;--t)e[t].stop();return this}update(e){e*=this.timeScale;const t=this._actions,r=this._nActiveActions,n=this.time+=e,i=Math.sign(e),s=this._accuIndex^=1;for(let o=0;o!==r;++o){t[o]._update(n,e,i,s)}const o=this._bindings,a=this._nActiveBindings;for(let e=0;e!==a;++e)o[e].apply(s);return this}setTime(e){this.time=0;for(let e=0;e<this._actions.length;e++)this._actions[e].time=0;return this.update(e)}getRoot(){return this._root}uncacheClip(e){const t=this._actions,r=e.uuid,n=this._actionsByClip,i=n[r];if(void 0!==i){const e=i.knownActions;for(let r=0,n=e.length;r!==n;++r){const n=e[r];this._deactivateAction(n);const i=n._cacheIndex,s=t[t.length-1];n._cacheIndex=null,n._byClipCacheIndex=null,s._cacheIndex=i,t[i]=s,t.pop(),this._removeInactiveBindingsForAction(n)}delete n[r]}}uncacheRoot(e){const t=e.uuid,r=this._actionsByClip;for(const e in r){const n=r[e].actionByRoot[t];void 0!==n&&(this._deactivateAction(n),this._removeInactiveAction(n))}const n=this._bindingsByRootAndName[t];if(void 0!==n)for(const e in n){const t=n[e];t.restoreOriginalState(),this._removeInactiveBinding(t)}}uncacheAction(e,t){const r=this.existingAction(e,t);null!==r&&(this._deactivateAction(r),this._removeInactiveAction(r))}},t.AnimationObjectGroup=class{constructor(){this.isAnimationObjectGroup=!0,this.uuid=Ot(),this._objects=Array.prototype.slice.call(arguments),this.nCachedObjects_=0;const e={};this._indicesByUUID=e;for(let t=0,r=arguments.length;t!==r;++t)e[arguments[t].uuid]=t;this._paths=[],this._parsedPaths=[],this._bindings=[],this._bindingsIndicesByPath={};const t=this;this.stats={objects:{get total(){return t._objects.length},get inUse(){return this.total-t.nCachedObjects_}},get bindingsPerObject(){return t._bindings.length}}}add(){const e=this._objects,t=this._indicesByUUID,r=this._paths,n=this._parsedPaths,i=this._bindings,s=i.length;let o,a=e.length,l=this.nCachedObjects_;for(let c=0,u=arguments.length;c!==u;++c){const u=arguments[c],h=u.uuid;let d=t[h];if(void 0===d){d=a++,t[h]=d,e.push(u);for(let e=0,t=s;e!==t;++e)i[e].push(new Rh(u,r[e],n[e]))}else if(d<l){o=e[d];const a=--l,c=e[a];t[c.uuid]=d,e[d]=c,t[h]=a,e[a]=u;for(let e=0,t=s;e!==t;++e){const t=i[e],s=t[a];let o=t[d];t[d]=s,void 0===o&&(o=new Rh(u,r[e],n[e])),t[a]=o}}else e[d]}this.nCachedObjects_=l}remove(){const e=this._objects,t=this._indicesByUUID,r=this._bindings,n=r.length;let i=this.nCachedObjects_;for(let s=0,o=arguments.length;s!==o;++s){const o=arguments[s],a=o.uuid,l=t[a];if(void 0!==l&&l>=i){const s=i++,c=e[s];t[c.uuid]=l,e[l]=c,t[a]=s,e[s]=o;for(let e=0,t=n;e!==t;++e){const t=r[e],n=t[s],i=t[l];t[l]=n,t[s]=i}}}this.nCachedObjects_=i}uncache(){const e=this._objects,t=this._indicesByUUID,r=this._bindings,n=r.length;let i=this.nCachedObjects_,s=e.length;for(let o=0,a=arguments.length;o!==a;++o){const a=arguments[o].uuid,l=t[a];if(void 0!==l)if(delete t[a],l<i){const o=--i,a=e[o],c=--s,u=e[c];t[a.uuid]=l,e[l]=a,t[u.uuid]=o,e[o]=u,e.pop();for(let e=0,t=n;e!==t;++e){const t=r[e],n=t[o],i=t[c];t[l]=n,t[o]=i,t.pop()}}else{const i=--s,o=e[i];i>0&&(t[o.uuid]=l),e[l]=o,e.pop();for(let e=0,t=n;e!==t;++e){const t=r[e];t[l]=t[i],t.pop()}}}this.nCachedObjects_=i}subscribe_(e,t){const r=this._bindingsIndicesByPath;let n=r[e];const i=this._bindings;if(void 0!==n)return i[n];const s=this._paths,o=this._parsedPaths,a=this._objects,l=a.length,c=this.nCachedObjects_,u=new Array(l);n=i.length,r[e]=n,s.push(e),o.push(t),i.push(u);for(let r=c,n=a.length;r!==n;++r){const n=a[r];u[r]=new Rh(n,e,t)}return u}unsubscribe_(e){const t=this._bindingsIndicesByPath,r=t[e];if(void 0!==r){const n=this._paths,i=this._parsedPaths,s=this._bindings,o=s.length-1,a=s[o];t[e[o]]=r,s[r]=a,s.pop(),i[r]=i[o],i.pop(),n[r]=n[o],n.pop()}}},t.AnimationUtils=du,t.ArcCurve=Ll,t.ArrayCamera=ca,t.ArrowHelper=class extends _n{constructor(e=new $t(0,0,1),t=new $t(0,0,0),r=1,n=16776960,i=.2*r,s=.2*i){super(),this.type="ArrowHelper",void 0===rd&&(rd=new $n,rd.setAttribute("position",new Wn([0,0,0,0,1,0],3)),nd=new Ql(0,.5,1,5,1),nd.translate(0,-.5,0)),this.position.copy(t),this.line=new fl(rd,new ll({color:n,toneMapped:!1})),this.line.matrixAutoUpdate=!1,this.add(this.line),this.cone=new fi(nd,new Fn({color:n,toneMapped:!1})),this.cone.matrixAutoUpdate=!1,this.add(this.cone),this.setDirection(e),this.setLength(r,i,s)}setDirection(e){if(e.y>.99999)this.quaternion.set(0,0,0,1);else if(e.y<-.99999)this.quaternion.set(1,0,0,0);else{td.set(e.z,0,-e.x).normalize();const t=Math.acos(e.y);this.quaternion.setFromAxisAngle(td,t)}}setLength(e,t=.2*e,r=.2*t){this.line.scale.set(1,Math.max(1e-4,e-t),1),this.line.updateMatrix(),this.cone.scale.set(r,t,r),this.cone.position.y=e,this.cone.updateMatrix()}setColor(e){this.line.material.color.set(e),this.cone.material.color.set(e)}copy(e){return super.copy(e,!1),this.line.copy(e.line),this.cone.copy(e.cone),this}dispose(){this.line.geometry.dispose(),this.line.material.dispose(),this.cone.geometry.dispose(),this.cone.material.dispose()}},t.Audio=vh,t.AudioAnalyser=class{constructor(e,t=2048){this.analyser=e.context.createAnalyser(),this.analyser.fftSize=t,this.data=new Uint8Array(this.analyser.frequencyBinCount),e.getOutput().connect(this.analyser)}getFrequencyData(){return this.analyser.getByteFrequencyData(this.data),this.data}getAverageFrequency(){let e=0;const t=this.getFrequencyData();for(let r=0;r<t.length;r++)e+=t[r];return e/t.length}},t.AudioContext=lh,t.AudioListener=class extends _n{constructor(){super(),this.type="AudioListener",this.context=lh.getContext(),this.gain=this.context.createGain(),this.gain.connect(this.context.destination),this.filter=null,this.timeDelta=0,this._clock=new dh}getInput(){return this.gain}removeFilter(){return null!==this.filter&&(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination),this.gain.connect(this.context.destination),this.filter=null),this}getFilter(){return this.filter}setFilter(e){return null!==this.filter?(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination)):this.gain.disconnect(this.context.destination),this.filter=e,this.gain.connect(this.filter),this.filter.connect(this.context.destination),this}getMasterVolume(){return this.gain.gain.value}setMasterVolume(e){return this.gain.gain.setTargetAtTime(e,this.context.currentTime,.01),this}updateMatrixWorld(e){super.updateMatrixWorld(e);const t=this.context.listener,r=this.up;if(this.timeDelta=this._clock.getDelta(),this.matrixWorld.decompose(fh,mh,gh),yh.set(0,0,-1).applyQuaternion(mh),t.positionX){const e=this.context.currentTime+this.timeDelta;t.positionX.linearRampToValueAtTime(fh.x,e),t.positionY.linearRampToValueAtTime(fh.y,e),t.positionZ.linearRampToValueAtTime(fh.z,e),t.forwardX.linearRampToValueAtTime(yh.x,e),t.forwardY.linearRampToValueAtTime(yh.y,e),t.forwardZ.linearRampToValueAtTime(yh.z,e),t.upX.linearRampToValueAtTime(r.x,e),t.upY.linearRampToValueAtTime(r.y,e),t.upZ.linearRampToValueAtTime(r.z,e)}else t.setPosition(fh.x,fh.y,fh.z),t.setOrientation(yh.x,yh.y,yh.z,r.x,r.y,r.z)}},t.AudioLoader=class extends Ru{constructor(e){super(e)}load(e,t,r,n){const i=this,s=new Iu(this.manager);s.setResponseType("arraybuffer"),s.setPath(this.path),s.setRequestHeader(this.requestHeader),s.setWithCredentials(this.withCredentials),s.load(e,(function(r){try{const e=r.slice(0);lh.getContext().decodeAudioData(e,(function(e){t(e)}))}catch(t){n&&n(t),i.manager.itemError(e)}}),r,n)}},t.AxesHelper=class extends yl{constructor(e=1){const t=[0,0,0,e,0,0,0,0,0,0,e,0,0,0,0,0,0,e],r=new $n;r.setAttribute("position",new Wn(t,3)),r.setAttribute("color",new Wn([1,0,0,1,.6,0,0,1,0,.6,1,0,0,0,1,0,.6,1],3));super(r,new ll({vertexColors:!0,toneMapped:!1})),this.type="AxesHelper"}setColors(e,t,r){const n=new Un,i=this.geometry.attributes.color.array;return n.set(e),n.toArray(i,0),n.toArray(i,3),n.set(t),n.toArray(i,6),n.toArray(i,9),n.set(r),n.toArray(i,12),n.toArray(i,15),this.geometry.attributes.color.needsUpdate=!0,this}dispose(){this.geometry.dispose(),this.material.dispose()}},t.BackSide=u,t.BasicDepthPacking=3200,t.BasicShadowMap=0,t.Bone=Ja,t.BooleanKeyframeTrack=vu,t.Box2=class{constructor(e=new Wt(1/0,1/0),t=new Wt(-1/0,-1/0)){this.isBox2=!0,this.min=e,this.max=t}set(e,t){return this.min.copy(e),this.max.copy(t),this}setFromPoints(e){this.makeEmpty();for(let t=0,r=e.length;t<r;t++)this.expandByPoint(e[t]);return this}setFromCenterAndSize(e,t){const r=Uh.copy(t).multiplyScalar(.5);return this.min.copy(e).sub(r),this.max.copy(e).add(r),this}clone(){return(new this.constructor).copy(this)}copy(e){return this.min.copy(e.min),this.max.copy(e.max),this}makeEmpty(){return this.min.x=this.min.y=1/0,this.max.x=this.max.y=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y}getCenter(e){return this.isEmpty()?e.set(0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(e){return this.isEmpty()?e.set(0,0):e.subVectors(this.max,this.min)}expandByPoint(e){return this.min.min(e),this.max.max(e),this}expandByVector(e){return this.min.sub(e),this.max.add(e),this}expandByScalar(e){return this.min.addScalar(-e),this.max.addScalar(e),this}containsPoint(e){return!(e.x<this.min.x||e.x>this.max.x||e.y<this.min.y||e.y>this.max.y)}containsBox(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y}getParameter(e,t){return t.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y))}intersectsBox(e){return!(e.max.x<this.min.x||e.min.x>this.max.x||e.max.y<this.min.y||e.min.y>this.max.y)}clampPoint(e,t){return t.copy(e).clamp(this.min,this.max)}distanceToPoint(e){return this.clampPoint(e,Uh).distanceTo(e)}intersect(e){return this.min.max(e.min),this.max.min(e.max),this.isEmpty()&&this.makeEmpty(),this}union(e){return this.min.min(e.min),this.max.max(e.max),this}translate(e){return this.min.add(e),this.max.add(e),this}equals(e){return e.min.equals(this.min)&&e.max.equals(this.max)}},t.Box3=xr,t.Box3Helper=class extends yl{constructor(e,t=16776960){const r=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),n=new $n;n.setIndex(new Gn(r,1)),n.setAttribute("position",new Wn([1,1,1,-1,1,1,-1,-1,1,1,-1,1,1,1,-1,-1,1,-1,-1,-1,-1,1,-1,-1],3)),super(n,new ll({color:t,toneMapped:!1})),this.box=e,this.type="Box3Helper",this.geometry.computeBoundingSphere()}updateMatrixWorld(e){const t=this.box;t.isEmpty()||(t.getCenter(this.position),t.getSize(this.scale),this.scale.multiplyScalar(.5),super.updateMatrixWorld(e))}dispose(){this.geometry.dispose(),this.material.dispose()}},t.BoxBufferGeometry=class extends gi{constructor(e,t,r,n,i,s){super(e,t,r,n,i,s)}},t.BoxGeometry=gi,t.BoxHelper=class extends yl{constructor(e,t=16776960){const r=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),n=new Float32Array(24),i=new $n;i.setIndex(new Gn(r,1)),i.setAttribute("position",new Gn(n,3)),super(i,new ll({color:t,toneMapped:!1})),this.object=e,this.type="BoxHelper",this.matrixAutoUpdate=!1,this.update()}update(e){if(void 0!==this.object&&ed.setFromObject(this.object),ed.isEmpty())return;const t=ed.min,r=ed.max,n=this.geometry.attributes.position,i=n.array;i[0]=r.x,i[1]=r.y,i[2]=r.z,i[3]=t.x,i[4]=r.y,i[5]=r.z,i[6]=t.x,i[7]=t.y,i[8]=r.z,i[9]=r.x,i[10]=t.y,i[11]=r.z,i[12]=r.x,i[13]=r.y,i[14]=t.z,i[15]=t.x,i[16]=r.y,i[17]=t.z,i[18]=t.x,i[19]=t.y,i[20]=t.z,i[21]=r.x,i[22]=t.y,i[23]=t.z,n.needsUpdate=!0,this.geometry.computeBoundingSphere()}setFromObject(e){return this.object=e,this.update(),this}copy(e,t){return super.copy(e,t),this.object=e.object,this}dispose(){this.geometry.dispose(),this.material.dispose()}},t.BufferAttribute=Gn,t.BufferGeometry=$n,t.BufferGeometryLoader=nh,t.ByteType=pe,t.Cache=Au,t.Camera=wi,t.CameraHelper=class extends yl{constructor(e){const t=new $n,r=new ll({color:16777215,vertexColors:!0,toneMapped:!1}),n=[],i=[],s={};function o(e,t){a(e),a(t)}function a(e){n.push(0,0,0),i.push(0,0,0),void 0===s[e]&&(s[e]=[]),s[e].push(n.length/3-1)}o("n1","n2"),o("n2","n4"),o("n4","n3"),o("n3","n1"),o("f1","f2"),o("f2","f4"),o("f4","f3"),o("f3","f1"),o("n1","f1"),o("n2","f2"),o("n3","f3"),o("n4","f4"),o("p","n1"),o("p","n2"),o("p","n3"),o("p","n4"),o("u1","u2"),o("u2","u3"),o("u3","u1"),o("c","t"),o("p","c"),o("cn1","cn2"),o("cn3","cn4"),o("cf1","cf2"),o("cf3","cf4"),t.setAttribute("position",new Wn(n,3)),t.setAttribute("color",new Wn(i,3)),super(t,r),this.type="CameraHelper",this.camera=e,this.camera.updateProjectionMatrix&&this.camera.updateProjectionMatrix(),this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.pointMap=s,this.update();const l=new Un(16755200),c=new Un(16711680),u=new Un(43775),h=new Un(16777215),d=new Un(3355443);this.setColors(l,c,u,h,d)}setColors(e,t,r,n,i){const s=this.geometry.getAttribute("color");s.setXYZ(0,e.r,e.g,e.b),s.setXYZ(1,e.r,e.g,e.b),s.setXYZ(2,e.r,e.g,e.b),s.setXYZ(3,e.r,e.g,e.b),s.setXYZ(4,e.r,e.g,e.b),s.setXYZ(5,e.r,e.g,e.b),s.setXYZ(6,e.r,e.g,e.b),s.setXYZ(7,e.r,e.g,e.b),s.setXYZ(8,e.r,e.g,e.b),s.setXYZ(9,e.r,e.g,e.b),s.setXYZ(10,e.r,e.g,e.b),s.setXYZ(11,e.r,e.g,e.b),s.setXYZ(12,e.r,e.g,e.b),s.setXYZ(13,e.r,e.g,e.b),s.setXYZ(14,e.r,e.g,e.b),s.setXYZ(15,e.r,e.g,e.b),s.setXYZ(16,e.r,e.g,e.b),s.setXYZ(17,e.r,e.g,e.b),s.setXYZ(18,e.r,e.g,e.b),s.setXYZ(19,e.r,e.g,e.b),s.setXYZ(20,e.r,e.g,e.b),s.setXYZ(21,e.r,e.g,e.b),s.setXYZ(22,e.r,e.g,e.b),s.setXYZ(23,e.r,e.g,e.b),s.setXYZ(24,t.r,t.g,t.b),s.setXYZ(25,t.r,t.g,t.b),s.setXYZ(26,t.r,t.g,t.b),s.setXYZ(27,t.r,t.g,t.b),s.setXYZ(28,t.r,t.g,t.b),s.setXYZ(29,t.r,t.g,t.b),s.setXYZ(30,t.r,t.g,t.b),s.setXYZ(31,t.r,t.g,t.b),s.setXYZ(32,r.r,r.g,r.b),s.setXYZ(33,r.r,r.g,r.b),s.setXYZ(34,r.r,r.g,r.b),s.setXYZ(35,r.r,r.g,r.b),s.setXYZ(36,r.r,r.g,r.b),s.setXYZ(37,r.r,r.g,r.b),s.setXYZ(38,n.r,n.g,n.b),s.setXYZ(39,n.r,n.g,n.b),s.setXYZ(40,i.r,i.g,i.b),s.setXYZ(41,i.r,i.g,i.b),s.setXYZ(42,i.r,i.g,i.b),s.setXYZ(43,i.r,i.g,i.b),s.setXYZ(44,i.r,i.g,i.b),s.setXYZ(45,i.r,i.g,i.b),s.setXYZ(46,i.r,i.g,i.b),s.setXYZ(47,i.r,i.g,i.b),s.setXYZ(48,i.r,i.g,i.b),s.setXYZ(49,i.r,i.g,i.b),s.needsUpdate=!0}update(){const e=this.geometry,t=this.pointMap;Qh.projectionMatrixInverse.copy(this.camera.projectionMatrixInverse),$h("c",t,e,Qh,0,0,-1),$h("t",t,e,Qh,0,0,1),$h("n1",t,e,Qh,-1,-1,-1),$h("n2",t,e,Qh,1,-1,-1),$h("n3",t,e,Qh,-1,1,-1),$h("n4",t,e,Qh,1,1,-1),$h("f1",t,e,Qh,-1,-1,1),$h("f2",t,e,Qh,1,-1,1),$h("f3",t,e,Qh,-1,1,1),$h("f4",t,e,Qh,1,1,1),$h("u1",t,e,Qh,.7,1.1,-1),$h("u2",t,e,Qh,-.7,1.1,-1),$h("u3",t,e,Qh,0,2,-1),$h("cf1",t,e,Qh,-1,0,1),$h("cf2",t,e,Qh,1,0,1),$h("cf3",t,e,Qh,0,-1,1),$h("cf4",t,e,Qh,0,1,1),$h("cn1",t,e,Qh,-1,0,-1),$h("cn2",t,e,Qh,1,0,-1),$h("cn3",t,e,Qh,0,-1,-1),$h("cn4",t,e,Qh,0,1,-1),e.getAttribute("position").needsUpdate=!0}dispose(){this.geometry.dispose(),this.material.dispose()}},t.CanvasTexture=class extends mr{constructor(e,t,r,n,i,s,o,a,l){super(e,t,r,n,i,s,o,a,l),this.isCanvasTexture=!0,this.needsUpdate=!0}},t.CapsuleBufferGeometry=class extends Jl{constructor(e,t,r,n){super(e,t,r,n)}},t.CapsuleGeometry=Jl,t.CatmullRomCurve3=Ol,t.CineonToneMapping=Y,t.CircleBufferGeometry=class extends Kl{constructor(e,t,r,n){super(e,t,r,n)}},t.CircleGeometry=Kl,t.ClampToEdgeWrapping=ie,t.Clock=dh,t.Color=Un,t.ColorKeyframeTrack=_u,t.ColorManagement=cr,t.CompressedArrayTexture=class extends El{constructor(e,t,r,n,i,s){super(e,t,r,i,s),this.isCompressedArrayTexture=!0,this.image.depth=n,this.wrapR=ie}},t.CompressedTexture=El,t.CompressedTextureLoader=class extends Ru{constructor(e){super(e)}load(e,t,r,n){const i=this,s=[],o=new El,a=new Iu(this.manager);a.setPath(this.path),a.setResponseType("arraybuffer"),a.setRequestHeader(this.requestHeader),a.setWithCredentials(i.withCredentials);let l=0;function c(c){a.load(e[c],(function(e){const r=i.parse(e,!0);s[c]={width:r.width,height:r.height,format:r.format,mipmaps:r.mipmaps},l+=1,6===l&&(1===r.mipmapCount&&(o.minFilter=ce),o.image=s,o.format=r.format,o.needsUpdate=!0,t&&t(o))}),r,n)}if(Array.isArray(e))for(let t=0,r=e.length;t<r;++t)c(t);else a.load(e,(function(e){const r=i.parse(e,!0);if(r.isCubemap){const e=r.mipmaps.length/r.mipmapCount;for(let t=0;t<e;t++){s[t]={mipmaps:[]};for(let e=0;e<r.mipmapCount;e++)s[t].mipmaps.push(r.mipmaps[t*r.mipmapCount+e]),s[t].format=r.format,s[t].width=r.width,s[t].height=r.height}o.image=s}else o.image.width=r.width,o.image.height=r.height,o.mipmaps=r.mipmaps;1===r.mipmapCount&&(o.minFilter=ce),o.format=r.format,o.needsUpdate=!0,t&&t(o)}),r,n);return o}},t.ConeBufferGeometry=class extends $l{constructor(e,t,r,n,i,s,o){super(e,t,r,n,i,s,o)}},t.ConeGeometry=$l,t.CubeCamera=Ti,t.CubeReflectionMapping=Q,t.CubeRefractionMapping=$,t.CubeTexture=Ei,t.CubeTextureLoader=class extends Ru{constructor(e){super(e)}load(e,t,r,n){const i=new Ei,s=new Du(this.manager);s.setCrossOrigin(this.crossOrigin),s.setPath(this.path);let o=0;function a(r){s.load(e[r],(function(e){i.images[r]=e,o++,6===o&&(i.needsUpdate=!0,t&&t(i))}),void 0,n)}for(let t=0;t<e.length;++t)a(t);return i}},t.CubeUVReflectionMapping=re,t.CubicBezierCurve=Fl,t.CubicBezierCurve3=Bl,t.CubicInterpolant=fu,t.CullFaceBack=i,t.CullFaceFront=s,t.CullFaceFrontBack=3,t.CullFaceNone=n,t.Curve=Al,t.CurvePath=ql,t.CustomBlending=y,t.CustomToneMapping=J,t.CylinderBufferGeometry=class extends Ql{constructor(e,t,r,n,i,s,o,a){super(e,t,r,n,i,s,o,a)}},t.CylinderGeometry=Ql,t.Cylindrical=class{constructor(e=1,t=0,r=0){return this.radius=e,this.theta=t,this.y=r,this}set(e,t,r){return this.radius=e,this.theta=t,this.y=r,this}copy(e){return this.radius=e.radius,this.theta=e.theta,this.y=e.y,this}setFromVector3(e){return this.setFromCartesianCoords(e.x,e.y,e.z)}setFromCartesianCoords(e,t,r){return this.radius=Math.sqrt(e*e+r*r),this.theta=Math.atan2(e,r),this.y=t,this}clone(){return(new this.constructor).copy(this)}},t.Data3DTexture=_r,t.DataArrayTexture=vr,t.DataTexture=Ka,t.DataTextureLoader=class extends Ru{constructor(e){super(e)}load(e,t,r,n){const i=this,s=new Ka,o=new Iu(this.manager);return o.setResponseType("arraybuffer"),o.setRequestHeader(this.requestHeader),o.setPath(this.path),o.setWithCredentials(i.withCredentials),o.load(e,(function(e){const r=i.parse(e);r&&(void 0!==r.image?s.image=r.image:void 0!==r.data&&(s.image.width=r.width,s.image.height=r.height,s.image.data=r.data),s.wrapS=void 0!==r.wrapS?r.wrapS:ie,s.wrapT=void 0!==r.wrapT?r.wrapT:ie,s.magFilter=void 0!==r.magFilter?r.magFilter:ce,s.minFilter=void 0!==r.minFilter?r.minFilter:ce,s.anisotropy=void 0!==r.anisotropy?r.anisotropy:1,void 0!==r.encoding&&(s.encoding=r.encoding),void 0!==r.flipY&&(s.flipY=r.flipY),void 0!==r.format&&(s.format=r.format),void 0!==r.type&&(s.type=r.type),void 0!==r.mipmaps&&(s.mipmaps=r.mipmaps,s.minFilter=he),1===r.mipmapCount&&(s.minFilter=ce),void 0!==r.generateMipmaps&&(s.generateMipmaps=r.generateMipmaps),s.needsUpdate=!0,t&&t(s,r))}),r,n),s}},t.DataUtils=od,t.DecrementStencilOp=7683,t.DecrementWrapStencilOp=34056,t.DefaultLoadingManager=Lu,t.DepthFormat=Ae,t.DepthStencilFormat=Ce,t.DepthTexture=pa,t.DirectionalLight=Zu,t.DirectionalLightHelper=class extends _n{constructor(e,t,r){super(),this.light=e,this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.color=r,this.type="DirectionalLightHelper",void 0===t&&(t=1);let n=new $n;n.setAttribute("position",new Wn([-t,t,0,t,t,0,t,-t,0,-t,-t,0,-t,t,0],3));const i=new ll({fog:!1,toneMapped:!1});this.lightPlane=new fl(n,i),this.add(this.lightPlane),n=new $n,n.setAttribute("position",new Wn([0,0,0,0,0,1],3)),this.targetLine=new fl(n,i),this.add(this.targetLine),this.update()}dispose(){this.lightPlane.geometry.dispose(),this.lightPlane.material.dispose(),this.targetLine.geometry.dispose(),this.targetLine.material.dispose()}update(){this.light.updateWorldMatrix(!0,!1),this.light.target.updateWorldMatrix(!0,!1),Yh.setFromMatrixPosition(this.light.matrixWorld),Zh.setFromMatrixPosition(this.light.target.matrixWorld),Jh.subVectors(Zh,Yh),this.lightPlane.lookAt(Zh),void 0!==this.color?(this.lightPlane.material.color.set(this.color),this.targetLine.material.color.set(this.color)):(this.lightPlane.material.color.copy(this.light.color),this.targetLine.material.color.copy(this.light.color)),this.targetLine.lookAt(Zh),this.targetLine.scale.z=Jh.length()}},t.DiscreteInterpolant=gu,t.DisplayP3ColorSpace=Tt,t.DodecahedronBufferGeometry=class extends tc{constructor(e,t){super(e,t)}},t.DodecahedronGeometry=tc,t.DoubleSide=h,t.DstAlphaFactor=L,t.DstColorFactor=P,t.DynamicCopyUsage=35050,t.DynamicDrawUsage=35048,t.DynamicReadUsage=35049,t.EdgesGeometry=oc,t.EllipseCurve=Cl,t.EqualDepth=k,t.EqualStencilFunc=514,t.EquirectangularReflectionMapping=ee,t.EquirectangularRefractionMapping=te,t.Euler=nn,t.EventDispatcher=Rt,t.ExtrudeBufferGeometry=class extends Nc{constructor(e,t){super(e,t)}},t.ExtrudeGeometry=Nc,t.FileLoader=Iu,t.Float16BufferAttribute=class extends Gn{constructor(e,t,r){super(new Uint16Array(e),t,r),this.isFloat16BufferAttribute=!0}},t.Float32BufferAttribute=Wn,t.Float64BufferAttribute=class extends Gn{constructor(e,t,r){super(new Float64Array(e),t,r)}},t.FloatType=ve,t.Fog=xa,t.FogExp2=_a,t.FramebufferTexture=class extends mr{constructor(e,t,r){super({width:e,height:t}),this.isFramebufferTexture=!0,this.format=r,this.magFilter=oe,this.minFilter=oe,this.generateMipmaps=!1,this.needsUpdate=!0}},t.FrontSide=c,t.Frustum=Di,t.GLBufferAttribute=class{constructor(e,t,r,n,i){this.isGLBufferAttribute=!0,this.name="",this.buffer=e,this.type=t,this.itemSize=r,this.elementSize=n,this.count=i,this.version=0}set needsUpdate(e){!0===e&&this.version++}setBuffer(e){return this.buffer=e,this}setType(e,t){return this.type=e,this.elementSize=t,this}setItemSize(e){return this.itemSize=e,this}setCount(e){return this.count=e,this}},t.GLSL1="100",t.GLSL3=Ct,t.GreaterDepth=B,t.GreaterEqualDepth=F,t.GreaterEqualStencilFunc=518,t.GreaterStencilFunc=516,t.GridHelper=class extends yl{constructor(e=10,t=10,r=4473924,n=8947848){r=new Un(r),n=new Un(n);const i=t/2,s=e/t,o=e/2,a=[],l=[];for(let e=0,c=0,u=-o;e<=t;e++,u+=s){a.push(-o,0,u,o,0,u),a.push(u,0,-o,u,0,o);const t=e===i?r:n;t.toArray(l,c),c+=3,t.toArray(l,c),c+=3,t.toArray(l,c),c+=3,t.toArray(l,c),c+=3}const c=new $n;c.setAttribute("position",new Wn(a,3)),c.setAttribute("color",new Wn(l,3));super(c,new ll({vertexColors:!0,toneMapped:!1})),this.type="GridHelper"}dispose(){this.geometry.dispose(),this.material.dispose()}},t.Group=ua,t.HalfFloatType=_e,t.HemisphereLight=Nu,t.HemisphereLightHelper=class extends _n{constructor(e,t,r){super(),this.light=e,this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.color=r,this.type="HemisphereLightHelper";const n=new Fc(t);n.rotateY(.5*Math.PI),this.material=new Fn({wireframe:!0,fog:!1,toneMapped:!1}),void 0===this.color&&(this.material.vertexColors=!0);const i=n.getAttribute("position"),s=new Float32Array(3*i.count);n.setAttribute("color",new Gn(s,3)),this.add(new fi(n,this.material)),this.update()}dispose(){this.children[0].geometry.dispose(),this.children[0].material.dispose()}update(){const e=this.children[0];if(void 0!==this.color)this.material.color.set(this.color);else{const t=e.geometry.getAttribute("color");Xh.copy(this.light.color),qh.copy(this.light.groundColor);for(let e=0,r=t.count;e<r;e++){const n=e<r/2?Xh:qh;t.setXYZ(e,n.r,n.g,n.b)}t.needsUpdate=!0}this.light.updateWorldMatrix(!0,!1),e.lookAt(Wh.setFromMatrixPosition(this.light.matrixWorld).negate())}},t.HemisphereLightProbe=class extends $u{constructor(e,t,r=1){super(void 0,r),this.isHemisphereLightProbe=!0;const n=(new Un).set(e),i=(new Un).set(t),s=new $t(n.r,n.g,n.b),o=new $t(i.r,i.g,i.b),a=Math.sqrt(Math.PI),l=a*Math.sqrt(.75);this.sh.coefficients[0].copy(s).add(o).multiplyScalar(a),this.sh.coefficients[1].copy(s).sub(o).multiplyScalar(l)}},t.IcosahedronBufferGeometry=class extends kc{constructor(e,t){super(e,t)}},t.IcosahedronGeometry=kc,t.ImageBitmapLoader=class extends Ru{constructor(e){super(e),this.isImageBitmapLoader=!0,this.options={premultiplyAlpha:"none"}}setOptions(e){return this.options=e,this}load(e,t,r,n){void 0===e&&(e=""),void 0!==this.path&&(e=this.path+e),e=this.manager.resolveURL(e);const i=this,s=Au.get(e);if(void 0!==s)return i.manager.itemStart(e),setTimeout((function(){t&&t(s),i.manager.itemEnd(e)}),0),s;const o={};o.credentials="anonymous"===this.crossOrigin?"same-origin":"include",o.headers=this.requestHeader,fetch(e,o).then((function(e){return e.blob()})).then((function(e){return createImageBitmap(e,Object.assign(i.options,{colorSpaceConversion:"none"}))})).then((function(r){Au.add(e,r),t&&t(r),i.manager.itemEnd(e)})).catch((function(t){n&&n(t),i.manager.itemError(e),i.manager.itemEnd(e)})),i.manager.itemStart(e)}},t.ImageLoader=Du,t.ImageUtils=hr,t.IncrementStencilOp=7682,t.IncrementWrapStencilOp=34055,t.InstancedBufferAttribute=tl,t.InstancedBufferGeometry=rh,t.InstancedInterleavedBuffer=class extends wa{constructor(e,t,r=1){super(e,t),this.isInstancedInterleavedBuffer=!0,this.meshPerAttribute=r}copy(e){return super.copy(e),this.meshPerAttribute=e.meshPerAttribute,this}clone(e){const t=super.clone(e);return t.meshPerAttribute=this.meshPerAttribute,t}toJSON(e){const t=super.toJSON(e);return t.isInstancedInterleavedBuffer=!0,t.meshPerAttribute=this.meshPerAttribute,t}},t.InstancedMesh=al,t.Int16BufferAttribute=class extends Gn{constructor(e,t,r){super(new Int16Array(e),t,r)}},t.Int32BufferAttribute=class extends Gn{constructor(e,t,r){super(new Int32Array(e),t,r)}},t.Int8BufferAttribute=class extends Gn{constructor(e,t,r){super(new Int8Array(e),t,r)}},t.IntType=ge,t.InterleavedBuffer=wa,t.InterleavedBufferAttribute=Ma,t.Interpolant=pu,t.InterpolateDiscrete=ut,t.InterpolateLinear=ht,t.InterpolateSmooth=dt,t.InvertStencilOp=5386,t.KeepStencilOp=Et,t.KeyframeTrack=yu,t.LOD=Va,t.LatheBufferGeometry=class extends Zl{constructor(e,t,r,n){super(e,t,r,n)}},t.LatheGeometry=Zl,t.Layers=sn,t.LessDepth=N,t.LessEqualDepth=U,t.LessEqualStencilFunc=515,t.LessStencilFunc=513,t.Light=Ou,t.LightProbe=$u,t.Line=fl,t.Line3=class{constructor(e=new $t,t=new $t){this.start=e,this.end=t}set(e,t){return this.start.copy(e),this.end.copy(t),this}copy(e){return this.start.copy(e.start),this.end.copy(e.end),this}getCenter(e){return e.addVectors(this.start,this.end).multiplyScalar(.5)}delta(e){return e.subVectors(this.end,this.start)}distanceSq(){return this.start.distanceToSquared(this.end)}distance(){return this.start.distanceTo(this.end)}at(e,t){return this.delta(t).multiplyScalar(e).add(this.start)}closestPointToPointParameter(e,t){kh.subVectors(e,this.start),Fh.subVectors(this.end,this.start);const r=Fh.dot(Fh);let n=Fh.dot(kh)/r;return t&&(n=Nt(n,0,1)),n}closestPointToPoint(e,t,r){const n=this.closestPointToPointParameter(e,t);return this.delta(r).multiplyScalar(n).add(this.start)}applyMatrix4(e){return this.start.applyMatrix4(e),this.end.applyMatrix4(e),this}equals(e){return e.start.equals(this.start)&&e.end.equals(this.end)}clone(){return(new this.constructor).copy(this)}},t.LineBasicMaterial=ll,t.LineCurve=zl,t.LineCurve3=Gl,t.LineDashedMaterial=su,t.LineLoop=vl,t.LineSegments=yl,t.LinearEncoding=vt,t.LinearFilter=ce,t.LinearInterpolant=mu,t.LinearMipMapLinearFilter=1008,t.LinearMipMapNearestFilter=1007,t.LinearMipmapLinearFilter=he,t.LinearMipmapNearestFilter=ue,t.LinearSRGBColorSpace=Mt,t.LinearToneMapping=X,t.Loader=Ru,t.LoaderUtils=th,t.LoadingManager=Cu,t.LoopOnce=2200,t.LoopPingPong=2202,t.LoopRepeat=2201,t.LuminanceAlphaFormat=Ee,t.LuminanceFormat=Te,t.MOUSE={LEFT:0,MIDDLE:1,RIGHT:2,ROTATE:0,DOLLY:1,PAN:2},t.Material=jn,t.MaterialLoader=eh,t.MathUtils=Ht,t.Matrix3=Xt,t.Matrix4=qr,t.MaxEquation=w,t.Mesh=fi,t.MeshBasicMaterial=Fn,t.MeshDepthMaterial=ta,t.MeshDistanceMaterial=ra,t.MeshLambertMaterial=nu,t.MeshMatcapMaterial=iu,t.MeshNormalMaterial=ru,t.MeshPhongMaterial=eu,t.MeshPhysicalMaterial=$c,t.MeshStandardMaterial=Qc,t.MeshToonMaterial=tu,t.MinEquation=b,t.MirroredRepeatWrapping=se,t.MixOperation=V,t.MultiplyBlending=g,t.MultiplyOperation=G,t.NearestFilter=oe,t.NearestMipMapLinearFilter=1005,t.NearestMipMapNearestFilter=1004,t.NearestMipmapLinearFilter=le,t.NearestMipmapNearestFilter=ae,t.NeverDepth=D,t.NeverStencilFunc=512,t.NoBlending=d,t.NoColorSpace="",t.NoToneMapping=W,t.NormalAnimationBlendMode=gt,t.NormalBlending=p,t.NotEqualDepth=z,t.NotEqualStencilFunc=517,t.NumberKeyframeTrack=xu,t.Object3D=_n,t.ObjectLoader=class extends Ru{constructor(e){super(e)}load(e,t,r,n){const i=this,s=""===this.path?th.extractUrlBase(e):this.path;this.resourcePath=this.resourcePath||s;const o=new Iu(this.manager);o.setPath(this.path),o.setRequestHeader(this.requestHeader),o.setWithCredentials(this.withCredentials),o.load(e,(function(r){let s=null;try{s=JSON.parse(r)}catch(e){return void(void 0!==n&&n(e))}const o=s.metadata;void 0!==o&&void 0!==o.type&&"geometry"!==o.type.toLowerCase()?i.parse(s,t):void 0!==n&&n(new Error("THREE.ObjectLoader: Can't load "+e))}),r,n)}async loadAsync(e,t){const r=""===this.path?th.extractUrlBase(e):this.path;this.resourcePath=this.resourcePath||r;const n=new Iu(this.manager);n.setPath(this.path),n.setRequestHeader(this.requestHeader),n.setWithCredentials(this.withCredentials);const i=await n.loadAsync(e,t),s=JSON.parse(i),o=s.metadata;if(void 0===o||void 0===o.type||"geometry"===o.type.toLowerCase())throw new Error("THREE.ObjectLoader: Can't load "+e);return await this.parseAsync(s)}parse(e,t){const r=this.parseAnimations(e.animations),n=this.parseShapes(e.shapes),i=this.parseGeometries(e.geometries,n),s=this.parseImages(e.images,(function(){void 0!==t&&t(l)})),o=this.parseTextures(e.textures,s),a=this.parseMaterials(e.materials,o),l=this.parseObject(e.object,i,a,o,r),c=this.parseSkeletons(e.skeletons,l);if(this.bindSkeletons(l,c),void 0!==t){let e=!1;for(const t in s)if(s[t].data instanceof HTMLImageElement){e=!0;break}!1===e&&t(l)}return l}async parseAsync(e){const t=this.parseAnimations(e.animations),r=this.parseShapes(e.shapes),n=this.parseGeometries(e.geometries,r),i=await this.parseImagesAsync(e.images),s=this.parseTextures(e.textures,i),o=this.parseMaterials(e.materials,s),a=this.parseObject(e.object,n,o,s,t),l=this.parseSkeletons(e.skeletons,a);return this.bindSkeletons(a,l),a}parseShapes(e){const t={};if(void 0!==e)for(let r=0,n=e.length;r<n;r++){const n=(new ac).fromJSON(e[r]);t[n.uuid]=n}return t}parseSkeletons(e,t){const r={},n={};if(t.traverse((function(e){e.isBone&&(n[e.uuid]=e)})),void 0!==e)for(let t=0,i=e.length;t<i;t++){const i=(new el).fromJSON(e[t],n);r[i.uuid]=i}return r}parseGeometries(e,t){const r={};if(void 0!==e){const n=new nh;for(let i=0,s=e.length;i<s;i++){let s;const o=e[i];switch(o.type){case"BufferGeometry":case"InstancedBufferGeometry":s=n.parse(o);break;default:o.type in Zc&&(s=Zc[o.type].fromJSON(o,t))}s.uuid=o.uuid,void 0!==o.name&&(s.name=o.name),void 0!==o.userData&&(s.userData=o.userData),r[o.uuid]=s}}return r}parseMaterials(e,t){const r={},n={};if(void 0!==e){const i=new eh;i.setTextures(t);for(let t=0,s=e.length;t<s;t++){const s=e[t];void 0===r[s.uuid]&&(r[s.uuid]=i.parse(s)),n[s.uuid]=r[s.uuid]}}return n}parseAnimations(e){const t={};if(void 0!==e)for(let r=0;r<e.length;r++){const n=e[r],i=Tu.parse(n);t[i.uuid]=i}return t}parseImages(e,t){const r=this,n={};let i;function s(e){if("string"==typeof e){const t=e;return function(e){return r.manager.itemStart(e),i.load(e,(function(){r.manager.itemEnd(e)}),void 0,(function(){r.manager.itemError(e),r.manager.itemEnd(e)}))}(/^(\/\/)|([a-z]+:(\/\/)?)/i.test(t)?t:r.resourcePath+t)}return e.data?{data:Jt(e.type,e.data),width:e.width,height:e.height}:null}if(void 0!==e&&e.length>0){const r=new Cu(t);i=new Du(r),i.setCrossOrigin(this.crossOrigin);for(let t=0,r=e.length;t<r;t++){const r=e[t],i=r.url;if(Array.isArray(i)){const e=[];for(let t=0,r=i.length;t<r;t++){const r=s(i[t]);null!==r&&(r instanceof HTMLImageElement?e.push(r):e.push(new Ka(r.data,r.width,r.height)))}n[r.uuid]=new dr(e)}else{const e=s(r.url);n[r.uuid]=new dr(e)}}}return n}async parseImagesAsync(e){const t=this,r={};let n;async function i(e){if("string"==typeof e){const r=e,i=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(r)?r:t.resourcePath+r;return await n.loadAsync(i)}return e.data?{data:Jt(e.type,e.data),width:e.width,height:e.height}:null}if(void 0!==e&&e.length>0){n=new Du(this.manager),n.setCrossOrigin(this.crossOrigin);for(let t=0,n=e.length;t<n;t++){const n=e[t],s=n.url;if(Array.isArray(s)){const e=[];for(let t=0,r=s.length;t<r;t++){const r=s[t],n=await i(r);null!==n&&(n instanceof HTMLImageElement?e.push(n):e.push(new Ka(n.data,n.width,n.height)))}r[n.uuid]=new dr(e)}else{const e=await i(n.url);r[n.uuid]=new dr(e)}}}return r}parseTextures(e,t){function r(e,t){return"number"==typeof e?e:t[e]}const n={};if(void 0!==e)for(let i=0,s=e.length;i<s;i++){const s=e[i];s.image,t[s.image];const o=t[s.image],a=o.data;let l;Array.isArray(a)?(l=new Ei,6===a.length&&(l.needsUpdate=!0)):(l=a&&a.data?new Ka:new mr,a&&(l.needsUpdate=!0)),l.source=o,l.uuid=s.uuid,void 0!==s.name&&(l.name=s.name),void 0!==s.mapping&&(l.mapping=r(s.mapping,ih)),void 0!==s.offset&&l.offset.fromArray(s.offset),void 0!==s.repeat&&l.repeat.fromArray(s.repeat),void 0!==s.center&&l.center.fromArray(s.center),void 0!==s.rotation&&(l.rotation=s.rotation),void 0!==s.wrap&&(l.wrapS=r(s.wrap[0],sh),l.wrapT=r(s.wrap[1],sh)),void 0!==s.format&&(l.format=s.format),void 0!==s.internalFormat&&(l.internalFormat=s.internalFormat),void 0!==s.type&&(l.type=s.type),void 0!==s.encoding&&(l.encoding=s.encoding),void 0!==s.minFilter&&(l.minFilter=r(s.minFilter,oh)),void 0!==s.magFilter&&(l.magFilter=r(s.magFilter,oh)),void 0!==s.anisotropy&&(l.anisotropy=s.anisotropy),void 0!==s.flipY&&(l.flipY=s.flipY),void 0!==s.generateMipmaps&&(l.generateMipmaps=s.generateMipmaps),void 0!==s.premultiplyAlpha&&(l.premultiplyAlpha=s.premultiplyAlpha),void 0!==s.unpackAlignment&&(l.unpackAlignment=s.unpackAlignment),void 0!==s.userData&&(l.userData=s.userData),n[s.uuid]=l}return n}parseObject(e,t,r,n,i){let s,o,a;function l(e){return t[e],t[e]}function c(e){if(void 0!==e){if(Array.isArray(e)){const t=[];for(let n=0,i=e.length;n<i;n++){const i=e[n];r[i],t.push(r[i])}return t}return r[e],r[e]}}function u(e){return n[e],n[e]}switch(e.type){case"Scene":s=new ba,void 0!==e.background&&(Number.isInteger(e.background)?s.background=new Un(e.background):s.background=u(e.background)),void 0!==e.environment&&(s.environment=u(e.environment)),void 0!==e.fog&&("Fog"===e.fog.type?s.fog=new xa(e.fog.color,e.fog.near,e.fog.far):"FogExp2"===e.fog.type&&(s.fog=new _a(e.fog.color,e.fog.density))),void 0!==e.backgroundBlurriness&&(s.backgroundBlurriness=e.backgroundBlurriness),void 0!==e.backgroundIntensity&&(s.backgroundIntensity=e.backgroundIntensity);break;case"PerspectiveCamera":s=new Si(e.fov,e.aspect,e.near,e.far),void 0!==e.focus&&(s.focus=e.focus),void 0!==e.zoom&&(s.zoom=e.zoom),void 0!==e.filmGauge&&(s.filmGauge=e.filmGauge),void 0!==e.filmOffset&&(s.filmOffset=e.filmOffset),void 0!==e.view&&(s.view=Object.assign({},e.view));break;case"OrthographicCamera":s=new Yi(e.left,e.right,e.top,e.bottom,e.near,e.far),void 0!==e.zoom&&(s.zoom=e.zoom),void 0!==e.view&&(s.view=Object.assign({},e.view));break;case"AmbientLight":s=new Ju(e.color,e.intensity);break;case"DirectionalLight":s=new Zu(e.color,e.intensity);break;case"PointLight":s=new qu(e.color,e.intensity,e.distance,e.decay);break;case"RectAreaLight":s=new Ku(e.color,e.intensity,e.width,e.height);break;case"SpotLight":s=new Gu(e.color,e.intensity,e.distance,e.angle,e.penumbra,e.decay);break;case"HemisphereLight":s=new Nu(e.color,e.groundColor,e.intensity);break;case"LightProbe":s=(new $u).fromJSON(e);break;case"SkinnedMesh":o=l(e.geometry),a=c(e.material),s=new Za(o,a),void 0!==e.bindMode&&(s.bindMode=e.bindMode),void 0!==e.bindMatrix&&s.bindMatrix.fromArray(e.bindMatrix),void 0!==e.skeleton&&(s.skeleton=e.skeleton);break;case"Mesh":o=l(e.geometry),a=c(e.material),s=new fi(o,a);break;case"InstancedMesh":o=l(e.geometry),a=c(e.material);const t=e.count,r=e.instanceMatrix,n=e.instanceColor;s=new al(o,a,t),s.instanceMatrix=new tl(new Float32Array(r.array),16),void 0!==n&&(s.instanceColor=new tl(new Float32Array(n.array),n.itemSize));break;case"LOD":s=new Va;break;case"Line":s=new fl(l(e.geometry),c(e.material));break;case"LineLoop":s=new vl(l(e.geometry),c(e.material));break;case"LineSegments":s=new yl(l(e.geometry),c(e.material));break;case"PointCloud":case"Points":s=new Ml(l(e.geometry),c(e.material));break;case"Sprite":s=new Fa(c(e.material));break;case"Group":s=new ua;break;case"Bone":s=new Ja;break;default:s=new _n}if(s.uuid=e.uuid,void 0!==e.name&&(s.name=e.name),void 0!==e.matrix?(s.matrix.fromArray(e.matrix),void 0!==e.matrixAutoUpdate&&(s.matrixAutoUpdate=e.matrixAutoUpdate),s.matrixAutoUpdate&&s.matrix.decompose(s.position,s.quaternion,s.scale)):(void 0!==e.position&&s.position.fromArray(e.position),void 0!==e.rotation&&s.rotation.fromArray(e.rotation),void 0!==e.quaternion&&s.quaternion.fromArray(e.quaternion),void 0!==e.scale&&s.scale.fromArray(e.scale)),void 0!==e.castShadow&&(s.castShadow=e.castShadow),void 0!==e.receiveShadow&&(s.receiveShadow=e.receiveShadow),e.shadow&&(void 0!==e.shadow.bias&&(s.shadow.bias=e.shadow.bias),void 0!==e.shadow.normalBias&&(s.shadow.normalBias=e.shadow.normalBias),void 0!==e.shadow.radius&&(s.shadow.radius=e.shadow.radius),void 0!==e.shadow.mapSize&&s.shadow.mapSize.fromArray(e.shadow.mapSize),void 0!==e.shadow.camera&&(s.shadow.camera=this.parseObject(e.shadow.camera))),void 0!==e.visible&&(s.visible=e.visible),void 0!==e.frustumCulled&&(s.frustumCulled=e.frustumCulled),void 0!==e.renderOrder&&(s.renderOrder=e.renderOrder),void 0!==e.userData&&(s.userData=e.userData),void 0!==e.layers&&(s.layers.mask=e.layers),void 0!==e.children){const o=e.children;for(let e=0;e<o.length;e++)s.add(this.parseObject(o[e],t,r,n,i))}if(void 0!==e.animations){const t=e.animations;for(let e=0;e<t.length;e++){const r=t[e];s.animations.push(i[r])}}if("LOD"===e.type){void 0!==e.autoUpdate&&(s.autoUpdate=e.autoUpdate);const t=e.levels;for(let e=0;e<t.length;e++){const r=t[e],n=s.getObjectByProperty("uuid",r.object);void 0!==n&&s.addLevel(n,r.distance,r.hysteresis)}}return s}bindSkeletons(e,t){0!==Object.keys(t).length&&e.traverse((function(e){if(!0===e.isSkinnedMesh&&void 0!==e.skeleton){const r=t[e.skeleton];void 0===r||e.bind(r,e.bindMatrix)}}))}},t.ObjectSpaceNormalMap=wt,t.OctahedronBufferGeometry=class extends Fc{constructor(e,t){super(e,t)}},t.OctahedronGeometry=Fc,t.OneFactor=M,t.OneMinusDstAlphaFactor=R,t.OneMinusDstColorFactor=j,t.OneMinusSrcAlphaFactor=C,t.OneMinusSrcColorFactor=E,t.OrthographicCamera=Yi,t.PCFShadowMap=o,t.PCFSoftShadowMap=a,t.PMREMGenerator=is,t.Path=Yl,t.PerspectiveCamera=Si,t.Plane=Pi,t.PlaneBufferGeometry=class extends Ui{constructor(e,t,r,n){super(e,t,r,n)}},t.PlaneGeometry=Ui,t.PlaneHelper=class extends fl{constructor(e,t=1,r=16776960){const n=r,i=new $n;i.setAttribute("position",new Wn([1,-1,0,-1,1,0,-1,-1,0,1,1,0,-1,1,0,-1,-1,0,1,-1,0,1,1,0],3)),i.computeBoundingSphere(),super(i,new ll({color:n,toneMapped:!1})),this.type="PlaneHelper",this.plane=e,this.size=t;const s=new $n;s.setAttribute("position",new Wn([1,1,0,-1,1,0,-1,-1,0,1,1,0,-1,-1,0,1,-1,0],3)),s.computeBoundingSphere(),this.add(new fi(s,new Fn({color:n,opacity:.2,transparent:!0,depthWrite:!1,toneMapped:!1})))}updateMatrixWorld(e){this.position.set(0,0,0),this.scale.set(.5*this.size,.5*this.size,1),this.lookAt(this.plane.normal),this.translateZ(-this.plane.constant),super.updateMatrixWorld(e)}dispose(){this.geometry.dispose(),this.material.dispose(),this.children[0].geometry.dispose(),this.children[0].material.dispose()}},t.PointLight=qu,t.PointLightHelper=class extends fi{constructor(e,t,r){super(new Gc(t,4,2),new Fn({wireframe:!0,fog:!1,toneMapped:!1})),this.light=e,this.color=r,this.type="PointLightHelper",this.matrix=this.light.matrixWorld,this.matrixAutoUpdate=!1,this.update()}dispose(){this.geometry.dispose(),this.material.dispose()}update(){this.light.updateWorldMatrix(!0,!1),void 0!==this.color?this.material.color.set(this.color):this.material.color.copy(this.light.color)}},t.Points=Ml,t.PointsMaterial=_l,t.PolarGridHelper=class extends yl{constructor(e=10,t=16,r=8,n=64,i=4473924,s=8947848){i=new Un(i),s=new Un(s);const o=[],a=[];if(t>1)for(let r=0;r<t;r++){const n=r/t*(2*Math.PI),l=Math.sin(n)*e,c=Math.cos(n)*e;o.push(0,0,0),o.push(l,0,c);const u=1&r?i:s;a.push(u.r,u.g,u.b),a.push(u.r,u.g,u.b)}for(let t=0;t<r;t++){const l=1&t?i:s,c=e-e/r*t;for(let e=0;e<n;e++){let t=e/n*(2*Math.PI),r=Math.sin(t)*c,i=Math.cos(t)*c;o.push(r,0,i),a.push(l.r,l.g,l.b),t=(e+1)/n*(2*Math.PI),r=Math.sin(t)*c,i=Math.cos(t)*c,o.push(r,0,i),a.push(l.r,l.g,l.b)}}const l=new $n;l.setAttribute("position",new Wn(o,3)),l.setAttribute("color",new Wn(a,3));super(l,new ll({vertexColors:!0,toneMapped:!1})),this.type="PolarGridHelper"}dispose(){this.geometry.dispose(),this.material.dispose()}},t.PolyhedronBufferGeometry=class extends ec{constructor(e,t,r,n){super(e,t,r,n)}},t.PolyhedronGeometry=ec,t.PositionalAudio=class extends vh{constructor(e){super(e),this.panner=this.context.createPanner(),this.panner.panningModel="HRTF",this.panner.connect(this.gain)}disconnect(){super.disconnect(),this.panner.disconnect(this.gain)}getOutput(){return this.panner}getRefDistance(){return this.panner.refDistance}setRefDistance(e){return this.panner.refDistance=e,this}getRolloffFactor(){return this.panner.rolloffFactor}setRolloffFactor(e){return this.panner.rolloffFactor=e,this}getDistanceModel(){return this.panner.distanceModel}setDistanceModel(e){return this.panner.distanceModel=e,this}getMaxDistance(){return this.panner.maxDistance}setMaxDistance(e){return this.panner.maxDistance=e,this}setDirectionalCone(e,t,r){return this.panner.coneInnerAngle=e,this.panner.coneOuterAngle=t,this.panner.coneOuterGain=r,this}updateMatrixWorld(e){if(super.updateMatrixWorld(e),!0===this.hasPlaybackControl&&!1===this.isPlaying)return;this.matrixWorld.decompose(_h,xh,bh),wh.set(0,0,1).applyQuaternion(xh);const t=this.panner;if(t.positionX){const e=this.context.currentTime+this.listener.timeDelta;t.positionX.linearRampToValueAtTime(_h.x,e),t.positionY.linearRampToValueAtTime(_h.y,e),t.positionZ.linearRampToValueAtTime(_h.z,e),t.orientationX.linearRampToValueAtTime(wh.x,e),t.orientationY.linearRampToValueAtTime(wh.y,e),t.orientationZ.linearRampToValueAtTime(wh.z,e)}else t.setPosition(_h.x,_h.y,_h.z),t.setOrientation(wh.x,wh.y,wh.z)}},t.PropertyBinding=Rh,t.PropertyMixer=Sh,t.QuadraticBezierCurve=Vl,t.QuadraticBezierCurve3=Hl,t.Quaternion=Qt,t.QuaternionKeyframeTrack=wu,t.QuaternionLinearInterpolant=bu,t.RED_GREEN_RGTC2_Format=lt,t.RED_RGTC1_Format=ot,t.REVISION=r,t.RGBADepthPacking=xt,t.RGBAFormat=Me,t.RGBAIntegerFormat=Ie,t.RGBA_ASTC_10x10_Format=rt,t.RGBA_ASTC_10x5_Format=$e,t.RGBA_ASTC_10x6_Format=et,t.RGBA_ASTC_10x8_Format=tt,t.RGBA_ASTC_12x10_Format=nt,t.RGBA_ASTC_12x12_Format=it,t.RGBA_ASTC_4x4_Format=We,t.RGBA_ASTC_5x4_Format=Xe,t.RGBA_ASTC_5x5_Format=qe,t.RGBA_ASTC_6x5_Format=Ye,t.RGBA_ASTC_6x6_Format=Ze,t.RGBA_ASTC_8x5_Format=Je,t.RGBA_ASTC_8x6_Format=Ke,t.RGBA_ASTC_8x8_Format=Qe,t.RGBA_BPTC_Format=st,t.RGBA_ETC2_EAC_Format=He,t.RGBA_PVRTC_2BPPV1_Format=ze,t.RGBA_PVRTC_4BPPV1_Format=Be,t.RGBA_S3TC_DXT1_Format=Oe,t.RGBA_S3TC_DXT3_Format=Ne,t.RGBA_S3TC_DXT5_Format=Ue,t.RGB_ETC1_Format=Ge,t.RGB_ETC2_Format=Ve,t.RGB_PVRTC_2BPPV1_Format=Fe,t.RGB_PVRTC_4BPPV1_Format=ke,t.RGB_S3TC_DXT1_Format=De,t.RGFormat=Pe,t.RGIntegerFormat=je,t.RawShaderMaterial=Kc,t.Ray=Xr,t.Raycaster=class{constructor(e,t,r=0,n=1/0){this.ray=new Xr(e,t),this.near=r,this.far=n,this.camera=null,this.layers=new sn,this.params={Mesh:{},Line:{threshold:1},LOD:{},Points:{threshold:1},Sprite:{}}}set(e,t){this.ray.set(e,t)}setFromCamera(e,t){t.isPerspectiveCamera?(this.ray.origin.setFromMatrixPosition(t.matrixWorld),this.ray.direction.set(e.x,e.y,.5).unproject(t).sub(this.ray.origin).normalize(),this.camera=t):t.isOrthographicCamera&&(this.ray.origin.set(e.x,e.y,(t.near+t.far)/(t.near-t.far)).unproject(t),this.ray.direction.set(0,0,-1).transformDirection(t.matrixWorld),this.camera=t)}intersectObject(e,t=!0,r=[]){return Nh(e,this,r,t),r.sort(Oh),r}intersectObjects(e,t=!0,r=[]){for(let n=0,i=e.length;n<i;n++)Nh(e[n],this,r,t);return r.sort(Oh),r}},t.RectAreaLight=Ku,t.RedFormat=Le,t.RedIntegerFormat=Re,t.ReinhardToneMapping=q,t.RepeatWrapping=ne,t.ReplaceStencilOp=7681,t.ReverseSubtractEquation=x,t.RingBufferGeometry=class extends Bc{constructor(e,t,r,n,i,s){super(e,t,r,n,i,s)}},t.RingGeometry=Bc,t.SIGNED_RED_GREEN_RGTC2_Format=ct,t.SIGNED_RED_RGTC1_Format=at,t.SRGBColorSpace=St,t.Scene=ba,t.ShaderChunk=ki,t.ShaderLib=Bi,t.ShaderMaterial=bi,t.ShadowMaterial=Jc,t.Shape=ac,t.ShapeBufferGeometry=class extends zc{constructor(e,t){super(e,t)}},t.ShapeGeometry=zc,t.ShapePath=class{constructor(){this.type="ShapePath",this.color=new Un,this.subPaths=[],this.currentPath=null}moveTo(e,t){return this.currentPath=new Yl,this.subPaths.push(this.currentPath),this.currentPath.moveTo(e,t),this}lineTo(e,t){return this.currentPath.lineTo(e,t),this}quadraticCurveTo(e,t,r,n){return this.currentPath.quadraticCurveTo(e,t,r,n),this}bezierCurveTo(e,t,r,n,i,s){return this.currentPath.bezierCurveTo(e,t,r,n,i,s),this}splineThru(e){return this.currentPath.splineThru(e),this}toShapes(e){function t(e,t){const r=t.length;let n=!1;for(let i=r-1,s=0;s<r;i=s++){let r=t[i],o=t[s],a=o.x-r.x,l=o.y-r.y;if(Math.abs(l)>Number.EPSILON){if(l<0&&(r=t[s],a=-a,o=t[i],l=-l),e.y<r.y||e.y>o.y)continue;if(e.y===r.y){if(e.x===r.x)return!0}else{const t=l*(e.x-r.x)-a*(e.y-r.y);if(0===t)return!0;if(t<0)continue;n=!n}}else{if(e.y!==r.y)continue;if(o.x<=e.x&&e.x<=r.x||r.x<=e.x&&e.x<=o.x)return!0}}return n}const r=Ic.isClockWise,n=this.subPaths;if(0===n.length)return[];let i,s,o;const a=[];if(1===n.length)return s=n[0],o=new ac,o.curves=s.curves,a.push(o),a;let l=!r(n[0].getPoints());l=e?!l:l;const c=[],u=[];let h,d,p=[],f=0;u[f]=void 0,p[f]=[];for(let t=0,o=n.length;t<o;t++)s=n[t],h=s.getPoints(),i=r(h),i=e?!i:i,i?(!l&&u[f]&&f++,u[f]={s:new ac,p:h},u[f].s.curves=s.curves,l&&f++,p[f]=[]):p[f].push({h:s,p:h[0]});if(!u[0])return function(e){const t=[];for(let r=0,n=e.length;r<n;r++){const n=e[r],i=new ac;i.curves=n.curves,t.push(i)}return t}(n);if(u.length>1){let e=!1,r=0;for(let e=0,t=u.length;e<t;e++)c[e]=[];for(let n=0,i=u.length;n<i;n++){const i=p[n];for(let s=0;s<i.length;s++){const o=i[s];let a=!0;for(let i=0;i<u.length;i++)t(o.p,u[i].p)&&(n!==i&&r++,a?(a=!1,c[i].push(o)):e=!0);a&&c[n].push(o)}}r>0&&!1===e&&(p=c)}for(let e=0,t=u.length;e<t;e++){o=u[e].s,a.push(o),d=p[e];for(let e=0,t=d.length;e<t;e++)o.holes.push(d[e].h)}return a}},t.ShapeUtils=Ic,t.ShortType=fe,t.Skeleton=el,t.SkeletonHelper=class extends yl{constructor(e){const t=Hh(e),r=new $n,n=[],i=[],s=new Un(0,0,1),o=new Un(0,1,0);for(let e=0;e<t.length;e++){const r=t[e];r.parent&&r.parent.isBone&&(n.push(0,0,0),n.push(0,0,0),i.push(s.r,s.g,s.b),i.push(o.r,o.g,o.b))}r.setAttribute("position",new Wn(n,3)),r.setAttribute("color",new Wn(i,3));super(r,new ll({vertexColors:!0,depthTest:!1,depthWrite:!1,toneMapped:!1,transparent:!0})),this.isSkeletonHelper=!0,this.type="SkeletonHelper",this.root=e,this.bones=t,this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1}updateMatrixWorld(e){const t=this.bones,r=this.geometry,n=r.getAttribute("position");Vh.copy(this.root.matrixWorld).invert();for(let e=0,r=0;e<t.length;e++){const i=t[e];i.parent&&i.parent.isBone&&(Gh.multiplyMatrices(Vh,i.matrixWorld),zh.setFromMatrixPosition(Gh),n.setXYZ(r,zh.x,zh.y,zh.z),Gh.multiplyMatrices(Vh,i.parent.matrixWorld),zh.setFromMatrixPosition(Gh),n.setXYZ(r+1,zh.x,zh.y,zh.z),r+=2)}r.getAttribute("position").needsUpdate=!0,super.updateMatrixWorld(e)}dispose(){this.geometry.dispose(),this.material.dispose()}},t.SkinnedMesh=Za,t.Source=dr,t.Sphere=kr,t.SphereBufferGeometry=class extends Gc{constructor(e,t,r,n,i,s,o){super(e,t,r,n,i,s,o)}},t.SphereGeometry=Gc,t.Spherical=class{constructor(e=1,t=0,r=0){return this.radius=e,this.phi=t,this.theta=r,this}set(e,t,r){return this.radius=e,this.phi=t,this.theta=r,this}copy(e){return this.radius=e.radius,this.phi=e.phi,this.theta=e.theta,this}makeSafe(){const e=1e-6;return this.phi=Math.max(e,Math.min(Math.PI-e,this.phi)),this}setFromVector3(e){return this.setFromCartesianCoords(e.x,e.y,e.z)}setFromCartesianCoords(e,t,r){return this.radius=Math.sqrt(e*e+t*t+r*r),0===this.radius?(this.theta=0,this.phi=0):(this.theta=Math.atan2(e,r),this.phi=Math.acos(Nt(t/this.radius,-1,1))),this}clone(){return(new this.constructor).copy(this)}},t.SphericalHarmonics3=Qu,t.SplineCurve=Wl,t.SpotLight=Gu,t.SpotLightHelper=class extends _n{constructor(e,t){super(),this.light=e,this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.color=t,this.type="SpotLightHelper";const r=new $n,n=[0,0,0,0,0,1,0,0,0,1,0,1,0,0,0,-1,0,1,0,0,0,0,1,1,0,0,0,0,-1,1];for(let e=0,t=1,r=32;e<r;e++,t++){const i=e/r*Math.PI*2,s=t/r*Math.PI*2;n.push(Math.cos(i),Math.sin(i),1,Math.cos(s),Math.sin(s),1)}r.setAttribute("position",new Wn(n,3));const i=new ll({fog:!1,toneMapped:!1});this.cone=new yl(r,i),this.add(this.cone),this.update()}dispose(){this.cone.geometry.dispose(),this.cone.material.dispose()}update(){this.light.updateWorldMatrix(!0,!1),this.light.target.updateWorldMatrix(!0,!1);const e=this.light.distance?this.light.distance:1e3,t=e*Math.tan(this.light.angle);this.cone.scale.set(t,t,e),Bh.setFromMatrixPosition(this.light.target.matrixWorld),this.cone.lookAt(Bh),void 0!==this.color?this.cone.material.color.set(this.color):this.cone.material.color.copy(this.light.color)}},t.Sprite=Fa,t.SpriteMaterial=Ta,t.SrcAlphaFactor=A,t.SrcAlphaSaturateFactor=I,t.SrcColorFactor=T,t.StaticCopyUsage=35046,t.StaticDrawUsage=At,t.StaticReadUsage=35045,t.StereoCamera=class{constructor(){this.type="StereoCamera",this.aspect=1,this.eyeSep=.064,this.cameraL=new Si,this.cameraL.layers.enable(1),this.cameraL.matrixAutoUpdate=!1,this.cameraR=new Si,this.cameraR.layers.enable(2),this.cameraR.matrixAutoUpdate=!1,this._cache={focus:null,fov:null,aspect:null,near:null,far:null,zoom:null,eyeSep:null}}update(e){const t=this._cache;if(t.focus!==e.focus||t.fov!==e.fov||t.aspect!==e.aspect*this.aspect||t.near!==e.near||t.far!==e.far||t.zoom!==e.zoom||t.eyeSep!==this.eyeSep){t.focus=e.focus,t.fov=e.fov,t.aspect=e.aspect*this.aspect,t.near=e.near,t.far=e.far,t.zoom=e.zoom,t.eyeSep=this.eyeSep,hh.copy(e.projectionMatrix);const r=t.eyeSep/2,n=r*t.near/t.focus,i=t.near*Math.tan(It*t.fov*.5)/t.zoom;let s,o;uh.elements[12]=-r,ch.elements[12]=r,s=-i*t.aspect+n,o=i*t.aspect+n,hh.elements[0]=2*t.near/(o-s),hh.elements[8]=(o+s)/(o-s),this.cameraL.projectionMatrix.copy(hh),s=-i*t.aspect-n,o=i*t.aspect-n,hh.elements[0]=2*t.near/(o-s),hh.elements[8]=(o+s)/(o-s),this.cameraR.projectionMatrix.copy(hh)}this.cameraL.matrixWorld.copy(e.matrixWorld).multiply(uh),this.cameraR.matrixWorld.copy(e.matrixWorld).multiply(ch)}},t.StreamCopyUsage=35042,t.StreamDrawUsage=35040,t.StreamReadUsage=35041,t.StringKeyframeTrack=Su,t.SubtractEquation=_,t.SubtractiveBlending=m,t.TOUCH={ROTATE:0,PAN:1,DOLLY_PAN:2,DOLLY_ROTATE:3},t.TangentSpaceNormalMap=bt,t.TetrahedronBufferGeometry=class extends Vc{constructor(e,t){super(e,t)}},t.TetrahedronGeometry=Vc,t.Texture=mr,t.TextureLoader=class extends Ru{constructor(e){super(e)}load(e,t,r,n){const i=new mr,s=new Du(this.manager);return s.setCrossOrigin(this.crossOrigin),s.setPath(this.path),s.load(e,(function(e){i.image=e,i.needsUpdate=!0,void 0!==t&&t(i)}),r,n),i}},t.TorusBufferGeometry=class extends Hc{constructor(e,t,r,n,i){super(e,t,r,n,i)}},t.TorusGeometry=Hc,t.TorusKnotBufferGeometry=class extends Wc{constructor(e,t,r,n,i,s){super(e,t,r,n,i,s)}},t.TorusKnotGeometry=Wc,t.Triangle=Rn,t.TriangleFanDrawMode=2,t.TriangleStripDrawMode=1,t.TrianglesDrawMode=0,t.TubeBufferGeometry=class extends Xc{constructor(e,t,r,n,i){super(e,t,r,n,i)}},t.TubeGeometry=Xc,t.TwoPassDoubleSide=2,t.UVMapping=K,t.Uint16BufferAttribute=Vn,t.Uint32BufferAttribute=Hn,t.Uint8BufferAttribute=class extends Gn{constructor(e,t,r){super(new Uint8Array(e),t,r)}},t.Uint8ClampedBufferAttribute=class extends Gn{constructor(e,t,r){super(new Uint8ClampedArray(e),t,r)}},t.Uniform=Ih,t.UniformsGroup=class extends Rt{constructor(){super(),this.isUniformsGroup=!0,Object.defineProperty(this,"id",{value:Dh++}),this.name="",this.usage=At,this.uniforms=[]}add(e){return this.uniforms.push(e),this}remove(e){const t=this.uniforms.indexOf(e);return-1!==t&&this.uniforms.splice(t,1),this}setName(e){return this.name=e,this}setUsage(e){return this.usage=e,this}dispose(){return this.dispatchEvent({type:"dispose"}),this}copy(e){this.name=e.name,this.usage=e.usage;const t=e.uniforms;this.uniforms.length=0;for(let e=0,r=t.length;e<r;e++)this.uniforms.push(t[e].clone());return this}clone(){return(new this.constructor).copy(this)}},t.UniformsLib=Fi,t.UniformsUtils=xi,t.UnsignedByteType=de,t.UnsignedInt248Type=we,t.UnsignedIntType=ye,t.UnsignedShort4444Type=xe,t.UnsignedShort5551Type=be,t.UnsignedShortType=me,t.VSMShadowMap=l,t.Vector2=Wt,t.Vector3=$t,t.Vector4=gr,t.VectorKeyframeTrack=Mu,t.VideoTexture=class extends mr{constructor(e,t,r,n,i,s,o,a,l){super(e,t,r,n,i,s,o,a,l),this.isVideoTexture=!0,this.minFilter=void 0!==s?s:ce,this.magFilter=void 0!==i?i:ce,this.generateMipmaps=!1;const c=this;"requestVideoFrameCallback"in e&&e.requestVideoFrameCallback((function t(){c.needsUpdate=!0,e.requestVideoFrameCallback(t)}))}clone(){return new this.constructor(this.image).copy(this)}update(){const e=this.image;!1==="requestVideoFrameCallback"in e&&e.readyState>=e.HAVE_CURRENT_DATA&&(this.needsUpdate=!0)}},t.WebGL1Renderer=va,t.WebGL3DRenderTarget=class extends yr{constructor(e=1,t=1,r=1){super(e,t),this.isWebGL3DRenderTarget=!0,this.depth=r,this.texture=new _r(null,e,t,r),this.texture.isRenderTargetTexture=!0}},t.WebGLArrayRenderTarget=class extends yr{constructor(e=1,t=1,r=1){super(e,t),this.isWebGLArrayRenderTarget=!0,this.depth=r,this.texture=new vr(null,e,t,r),this.texture.isRenderTargetTexture=!0}},t.WebGLCubeRenderTarget=Ai,t.WebGLMultipleRenderTargets=class extends yr{constructor(e=1,t=1,r=1,n={}){super(e,t,n),this.isWebGLMultipleRenderTargets=!0;const i=this.texture;this.texture=[];for(let e=0;e<r;e++)this.texture[e]=i.clone(),this.texture[e].isRenderTargetTexture=!0}setSize(e,t,r=1){if(this.width!==e||this.height!==t||this.depth!==r){this.width=e,this.height=t,this.depth=r;for(let n=0,i=this.texture.length;n<i;n++)this.texture[n].image.width=e,this.texture[n].image.height=t,this.texture[n].image.depth=r;this.dispose()}return this.viewport.set(0,0,e,t),this.scissor.set(0,0,e,t),this}copy(e){this.dispose(),this.width=e.width,this.height=e.height,this.depth=e.depth,this.viewport.set(0,0,this.width,this.height),this.scissor.set(0,0,this.width,this.height),this.depthBuffer=e.depthBuffer,this.stencilBuffer=e.stencilBuffer,null!==e.depthTexture&&(this.depthTexture=e.depthTexture.clone()),this.texture.length=0;for(let t=0,r=e.texture.length;t<r;t++)this.texture[t]=e.texture[t].clone(),this.texture[t].isRenderTargetTexture=!0;return this}},t.WebGLRenderTarget=yr,t.WebGLRenderer=ya,t.WebGLUtils=la,t.WireframeGeometry=qc,t.WrapAroundEnding=mt,t.ZeroCurvatureEnding=pt,t.ZeroFactor=S,t.ZeroSlopeEnding=ft,t.ZeroStencilOp=0,t._SRGBAFormat=Lt,t.sRGBEncoding=_t},6075:(e,t,r)=>{"use strict";r.d(t,{$V:()=>Mc,CP7:()=>ba,D1R:()=>pe,DvJ:()=>xi,EJi:()=>fl,F5T:()=>Nn,FM8:()=>Kt,Ilk:()=>zn,Kj0:()=>vi,M8C:()=>Jt,Mig:()=>sc,N$j:()=>Ia,NMF:()=>ft,OdW:()=>Ua,OoA:()=>ae,Ox3:()=>ic,PMe:()=>Kl,Pa4:()=>nr,QRU:()=>ac,QmN:()=>s,RsA:()=>i,SPe:()=>Ha,SUY:()=>lc,Syv:()=>pt,TUv:()=>ja,TlE:()=>Xn,Tme:()=>Sn,TyD:()=>le,UY4:()=>rl,UlW:()=>wt,Wid:()=>pl,Wl3:()=>d,WwZ:()=>bt,Xcj:()=>xc,YBo:()=>ml,YLQ:()=>ce,ZAu:()=>fa,Zp0:()=>oc,ZzF:()=>Mr,_12:()=>zi,_C8:()=>wl,_fP:()=>rr,_iA:()=>c,aH4:()=>ue,aLr:()=>Gr,aNw:()=>Fl,b_z:()=>ul,blk:()=>tl,cPb:()=>Ai,cek:()=>rc,dUE:()=>Ll,dpR:()=>Hl,ehD:()=>f,ejS:()=>el,fHI:()=>cl,hH6:()=>Gl,iKG:()=>Qi,iLg:()=>Pl,iMs:()=>bc,iUV:()=>yc,jAl:()=>dt,kB5:()=>Ea,knz:()=>Tt,m7l:()=>Dl,nls:()=>Wa,o8S:()=>hl,pBf:()=>Nt,qyh:()=>de,rpg:()=>se,u9r:()=>ni,uWy:()=>oe,vBJ:()=>Vn,vpT:()=>Ma,wem:()=>he,woe:()=>al,x12:()=>Ka,xEZ:()=>_r,xo$:()=>dl,xsS:()=>Sa,yC1:()=>Il,yGw:()=>Kr,ybr:()=>wa,z$h:()=>St});const n="150",i={LEFT:0,MIDDLE:1,RIGHT:2,ROTATE:0,DOLLY:1,PAN:2},s={ROTATE:0,PAN:1,DOLLY_PAN:2,DOLLY_ROTATE:3},o=0,a=1,l=2,c=1,u=2,h=3,d=0,p=1,f=2,m=0,g=1,y=2,v=3,_=4,x=5,b=100,w=101,S=102,M=103,T=104,E=200,A=201,C=202,L=203,R=204,P=205,j=206,I=207,D=208,O=209,N=210,U=0,k=1,F=2,B=3,z=4,G=5,V=6,H=7,W=0,X=1,q=2,Y=0,Z=1,J=2,K=3,Q=4,$=5,ee=301,te=302,re=303,ne=304,ie=306,se=1e3,oe=1001,ae=1002,le=1003,ce=1004,ue=1005,he=1006,de=1007,pe=1008,fe=1009,me=1010,ge=1011,ye=1012,ve=1013,_e=1014,xe=1015,be=1016,we=1017,Se=1018,Me=1020,Te=1021,Ee=1023,Ae=1024,Ce=1025,Le=1026,Re=1027,Pe=1028,je=1029,Ie=1030,De=1031,Oe=1033,Ne=33776,Ue=33777,ke=33778,Fe=33779,Be=35840,ze=35841,Ge=35842,Ve=35843,He=36196,We=37492,Xe=37496,qe=37808,Ye=37809,Ze=37810,Je=37811,Ke=37812,Qe=37813,$e=37814,et=37815,tt=37816,rt=37817,nt=37818,it=37819,st=37820,ot=37821,at=36492,lt=36283,ct=36284,ut=36285,ht=36286,dt=2200,pt=2300,ft=2301,mt=2302,gt=2400,yt=2401,vt=2402,_t=2500,xt=2501,bt=0,wt=1,St=2,Mt=3e3,Tt=3001,Et=3201,At=0,Ct=1,Lt="srgb",Rt="srgb-linear",Pt="display-p3",jt=7680,It=35044,Dt="300 es",Ot=1035;class Nt{addEventListener(e,t){void 0===this._listeners&&(this._listeners={});const r=this._listeners;void 0===r[e]&&(r[e]=[]),-1===r[e].indexOf(t)&&r[e].push(t)}hasEventListener(e,t){if(void 0===this._listeners)return!1;const r=this._listeners;return void 0!==r[e]&&-1!==r[e].indexOf(t)}removeEventListener(e,t){if(void 0===this._listeners)return;const r=this._listeners[e];if(void 0!==r){const e=r.indexOf(t);-1!==e&&r.splice(e,1)}}dispatchEvent(e){if(void 0===this._listeners)return;const t=this._listeners[e.type];if(void 0!==t){e.target=this;const r=t.slice(0);for(let t=0,n=r.length;t<n;t++)r[t].call(this,e);e.target=null}}}const Ut=["00","01","02","03","04","05","06","07","08","09","0a","0b","0c","0d","0e","0f","10","11","12","13","14","15","16","17","18","19","1a","1b","1c","1d","1e","1f","20","21","22","23","24","25","26","27","28","29","2a","2b","2c","2d","2e","2f","30","31","32","33","34","35","36","37","38","39","3a","3b","3c","3d","3e","3f","40","41","42","43","44","45","46","47","48","49","4a","4b","4c","4d","4e","4f","50","51","52","53","54","55","56","57","58","59","5a","5b","5c","5d","5e","5f","60","61","62","63","64","65","66","67","68","69","6a","6b","6c","6d","6e","6f","70","71","72","73","74","75","76","77","78","79","7a","7b","7c","7d","7e","7f","80","81","82","83","84","85","86","87","88","89","8a","8b","8c","8d","8e","8f","90","91","92","93","94","95","96","97","98","99","9a","9b","9c","9d","9e","9f","a0","a1","a2","a3","a4","a5","a6","a7","a8","a9","aa","ab","ac","ad","ae","af","b0","b1","b2","b3","b4","b5","b6","b7","b8","b9","ba","bb","bc","bd","be","bf","c0","c1","c2","c3","c4","c5","c6","c7","c8","c9","ca","cb","cc","cd","ce","cf","d0","d1","d2","d3","d4","d5","d6","d7","d8","d9","da","db","dc","dd","de","df","e0","e1","e2","e3","e4","e5","e6","e7","e8","e9","ea","eb","ec","ed","ee","ef","f0","f1","f2","f3","f4","f5","f6","f7","f8","f9","fa","fb","fc","fd","fe","ff"];let kt=1234567;const Ft=Math.PI/180,Bt=180/Math.PI;function zt(){const e=4294967295*Math.random()|0,t=4294967295*Math.random()|0,r=4294967295*Math.random()|0,n=4294967295*Math.random()|0;return(Ut[255&e]+Ut[e>>8&255]+Ut[e>>16&255]+Ut[e>>24&255]+"-"+Ut[255&t]+Ut[t>>8&255]+"-"+Ut[t>>16&15|64]+Ut[t>>24&255]+"-"+Ut[63&r|128]+Ut[r>>8&255]+"-"+Ut[r>>16&255]+Ut[r>>24&255]+Ut[255&n]+Ut[n>>8&255]+Ut[n>>16&255]+Ut[n>>24&255]).toLowerCase()}function Gt(e,t,r){return Math.max(t,Math.min(r,e))}function Vt(e,t){return(e%t+t)%t}function Ht(e,t,r){return(1-r)*e+r*t}function Wt(e){return 0==(e&e-1)&&0!==e}function Xt(e){return Math.pow(2,Math.ceil(Math.log(e)/Math.LN2))}function qt(e){return Math.pow(2,Math.floor(Math.log(e)/Math.LN2))}function Yt(e,t){switch(t.constructor){case Float32Array:return e;case Uint16Array:return e/65535;case Uint8Array:return e/255;case Int16Array:return Math.max(e/32767,-1);case Int8Array:return Math.max(e/127,-1);default:throw new Error("Invalid component type.")}}function Zt(e,t){switch(t.constructor){case Float32Array:return e;case Uint16Array:return Math.round(65535*e);case Uint8Array:return Math.round(255*e);case Int16Array:return Math.round(32767*e);case Int8Array:return Math.round(127*e);default:throw new Error("Invalid component type.")}}const Jt={DEG2RAD:Ft,RAD2DEG:Bt,generateUUID:zt,clamp:Gt,euclideanModulo:Vt,mapLinear:function(e,t,r,n,i){return n+(e-t)*(i-n)/(r-t)},inverseLerp:function(e,t,r){return e!==t?(r-e)/(t-e):0},lerp:Ht,damp:function(e,t,r,n){return Ht(e,t,1-Math.exp(-r*n))},pingpong:function(e,t=1){return t-Math.abs(Vt(e,2*t)-t)},smoothstep:function(e,t,r){return e<=t?0:e>=r?1:(e=(e-t)/(r-t))*e*(3-2*e)},smootherstep:function(e,t,r){return e<=t?0:e>=r?1:(e=(e-t)/(r-t))*e*e*(e*(6*e-15)+10)},randInt:function(e,t){return e+Math.floor(Math.random()*(t-e+1))},randFloat:function(e,t){return e+Math.random()*(t-e)},randFloatSpread:function(e){return e*(.5-Math.random())},seededRandom:function(e){void 0!==e&&(kt=e);let t=kt+=1831565813;return t=Math.imul(t^t>>>15,1|t),t^=t+Math.imul(t^t>>>7,61|t),((t^t>>>14)>>>0)/4294967296},degToRad:function(e){return e*Ft},radToDeg:function(e){return e*Bt},isPowerOfTwo:Wt,ceilPowerOfTwo:Xt,floorPowerOfTwo:qt,setQuaternionFromProperEuler:function(e,t,r,n,i){const s=Math.cos,o=Math.sin,a=s(r/2),l=o(r/2),c=s((t+n)/2),u=o((t+n)/2),h=s((t-n)/2),d=o((t-n)/2),p=s((n-t)/2),f=o((n-t)/2);switch(i){case"XYX":e.set(a*u,l*h,l*d,a*c);break;case"YZY":e.set(l*d,a*u,l*h,a*c);break;case"ZXZ":e.set(l*h,l*d,a*u,a*c);break;case"XZX":e.set(a*u,l*f,l*p,a*c);break;case"YXY":e.set(l*p,a*u,l*f,a*c);break;case"ZYZ":e.set(l*f,l*p,a*u,a*c)}},normalize:Zt,denormalize:Yt};class Kt{constructor(e=0,t=0){Kt.prototype.isVector2=!0,this.x=e,this.y=t}get width(){return this.x}set width(e){this.x=e}get height(){return this.y}set height(e){this.y=e}set(e,t){return this.x=e,this.y=t,this}setScalar(e){return this.x=e,this.y=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y)}copy(e){return this.x=e.x,this.y=e.y,this}add(e){return this.x+=e.x,this.y+=e.y,this}addScalar(e){return this.x+=e,this.y+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this}subScalar(e){return this.x-=e,this.y-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this}multiply(e){return this.x*=e.x,this.y*=e.y,this}multiplyScalar(e){return this.x*=e,this.y*=e,this}divide(e){return this.x/=e.x,this.y/=e.y,this}divideScalar(e){return this.multiplyScalar(1/e)}applyMatrix3(e){const t=this.x,r=this.y,n=e.elements;return this.x=n[0]*t+n[3]*r+n[6],this.y=n[1]*t+n[4]*r+n[7],this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this}clampLength(e,t){const r=this.length();return this.divideScalar(r||1).multiplyScalar(Math.max(e,Math.min(t,r)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this}negate(){return this.x=-this.x,this.y=-this.y,this}dot(e){return this.x*e.x+this.y*e.y}cross(e){return this.x*e.y-this.y*e.x}lengthSq(){return this.x*this.x+this.y*this.y}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)}normalize(){return this.divideScalar(this.length()||1)}angle(){return Math.atan2(-this.y,-this.x)+Math.PI}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const t=this.x-e.x,r=this.y-e.y;return t*t+r*r}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this}lerpVectors(e,t,r){return this.x=e.x+(t.x-e.x)*r,this.y=e.y+(t.y-e.y)*r,this}equals(e){return e.x===this.x&&e.y===this.y}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this}rotateAround(e,t){const r=Math.cos(t),n=Math.sin(t),i=this.x-e.x,s=this.y-e.y;return this.x=i*r-s*n+e.x,this.y=i*n+s*r+e.y,this}random(){return this.x=Math.random(),this.y=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y}}class Qt{constructor(){Qt.prototype.isMatrix3=!0,this.elements=[1,0,0,0,1,0,0,0,1]}set(e,t,r,n,i,s,o,a,l){const c=this.elements;return c[0]=e,c[1]=n,c[2]=o,c[3]=t,c[4]=i,c[5]=a,c[6]=r,c[7]=s,c[8]=l,this}identity(){return this.set(1,0,0,0,1,0,0,0,1),this}copy(e){const t=this.elements,r=e.elements;return t[0]=r[0],t[1]=r[1],t[2]=r[2],t[3]=r[3],t[4]=r[4],t[5]=r[5],t[6]=r[6],t[7]=r[7],t[8]=r[8],this}extractBasis(e,t,r){return e.setFromMatrix3Column(this,0),t.setFromMatrix3Column(this,1),r.setFromMatrix3Column(this,2),this}setFromMatrix4(e){const t=e.elements;return this.set(t[0],t[4],t[8],t[1],t[5],t[9],t[2],t[6],t[10]),this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,t){const r=e.elements,n=t.elements,i=this.elements,s=r[0],o=r[3],a=r[6],l=r[1],c=r[4],u=r[7],h=r[2],d=r[5],p=r[8],f=n[0],m=n[3],g=n[6],y=n[1],v=n[4],_=n[7],x=n[2],b=n[5],w=n[8];return i[0]=s*f+o*y+a*x,i[3]=s*m+o*v+a*b,i[6]=s*g+o*_+a*w,i[1]=l*f+c*y+u*x,i[4]=l*m+c*v+u*b,i[7]=l*g+c*_+u*w,i[2]=h*f+d*y+p*x,i[5]=h*m+d*v+p*b,i[8]=h*g+d*_+p*w,this}multiplyScalar(e){const t=this.elements;return t[0]*=e,t[3]*=e,t[6]*=e,t[1]*=e,t[4]*=e,t[7]*=e,t[2]*=e,t[5]*=e,t[8]*=e,this}determinant(){const e=this.elements,t=e[0],r=e[1],n=e[2],i=e[3],s=e[4],o=e[5],a=e[6],l=e[7],c=e[8];return t*s*c-t*o*l-r*i*c+r*o*a+n*i*l-n*s*a}invert(){const e=this.elements,t=e[0],r=e[1],n=e[2],i=e[3],s=e[4],o=e[5],a=e[6],l=e[7],c=e[8],u=c*s-o*l,h=o*a-c*i,d=l*i-s*a,p=t*u+r*h+n*d;if(0===p)return this.set(0,0,0,0,0,0,0,0,0);const f=1/p;return e[0]=u*f,e[1]=(n*l-c*r)*f,e[2]=(o*r-n*s)*f,e[3]=h*f,e[4]=(c*t-n*a)*f,e[5]=(n*i-o*t)*f,e[6]=d*f,e[7]=(r*a-l*t)*f,e[8]=(s*t-r*i)*f,this}transpose(){let e;const t=this.elements;return e=t[1],t[1]=t[3],t[3]=e,e=t[2],t[2]=t[6],t[6]=e,e=t[5],t[5]=t[7],t[7]=e,this}getNormalMatrix(e){return this.setFromMatrix4(e).invert().transpose()}transposeIntoArray(e){const t=this.elements;return e[0]=t[0],e[1]=t[3],e[2]=t[6],e[3]=t[1],e[4]=t[4],e[5]=t[7],e[6]=t[2],e[7]=t[5],e[8]=t[8],this}setUvTransform(e,t,r,n,i,s,o){const a=Math.cos(i),l=Math.sin(i);return this.set(r*a,r*l,-r*(a*s+l*o)+s+e,-n*l,n*a,-n*(-l*s+a*o)+o+t,0,0,1),this}scale(e,t){return this.premultiply($t.makeScale(e,t)),this}rotate(e){return this.premultiply($t.makeRotation(-e)),this}translate(e,t){return this.premultiply($t.makeTranslation(e,t)),this}makeTranslation(e,t){return this.set(1,0,e,0,1,t,0,0,1),this}makeRotation(e){const t=Math.cos(e),r=Math.sin(e);return this.set(t,-r,0,r,t,0,0,0,1),this}makeScale(e,t){return this.set(e,0,0,0,t,0,0,0,1),this}equals(e){const t=this.elements,r=e.elements;for(let e=0;e<9;e++)if(t[e]!==r[e])return!1;return!0}fromArray(e,t=0){for(let r=0;r<9;r++)this.elements[r]=e[r+t];return this}toArray(e=[],t=0){const r=this.elements;return e[t]=r[0],e[t+1]=r[1],e[t+2]=r[2],e[t+3]=r[3],e[t+4]=r[4],e[t+5]=r[5],e[t+6]=r[6],e[t+7]=r[7],e[t+8]=r[8],e}clone(){return(new this.constructor).fromArray(this.elements)}}const $t=new Qt;function er(e){for(let t=e.length-1;t>=0;--t)if(e[t]>=65535)return!0;return!1}Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array;function tr(e){return document.createElementNS("http://www.w3.org/1999/xhtml",e)}class rr{constructor(e=0,t=0,r=0,n=1){this.isQuaternion=!0,this._x=e,this._y=t,this._z=r,this._w=n}static slerpFlat(e,t,r,n,i,s,o){let a=r[n+0],l=r[n+1],c=r[n+2],u=r[n+3];const h=i[s+0],d=i[s+1],p=i[s+2],f=i[s+3];if(0===o)return e[t+0]=a,e[t+1]=l,e[t+2]=c,void(e[t+3]=u);if(1===o)return e[t+0]=h,e[t+1]=d,e[t+2]=p,void(e[t+3]=f);if(u!==f||a!==h||l!==d||c!==p){let e=1-o;const t=a*h+l*d+c*p+u*f,r=t>=0?1:-1,n=1-t*t;if(n>Number.EPSILON){const i=Math.sqrt(n),s=Math.atan2(i,t*r);e=Math.sin(e*s)/i,o=Math.sin(o*s)/i}const i=o*r;if(a=a*e+h*i,l=l*e+d*i,c=c*e+p*i,u=u*e+f*i,e===1-o){const e=1/Math.sqrt(a*a+l*l+c*c+u*u);a*=e,l*=e,c*=e,u*=e}}e[t]=a,e[t+1]=l,e[t+2]=c,e[t+3]=u}static multiplyQuaternionsFlat(e,t,r,n,i,s){const o=r[n],a=r[n+1],l=r[n+2],c=r[n+3],u=i[s],h=i[s+1],d=i[s+2],p=i[s+3];return e[t]=o*p+c*u+a*d-l*h,e[t+1]=a*p+c*h+l*u-o*d,e[t+2]=l*p+c*d+o*h-a*u,e[t+3]=c*p-o*u-a*h-l*d,e}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get w(){return this._w}set w(e){this._w=e,this._onChangeCallback()}set(e,t,r,n){return this._x=e,this._y=t,this._z=r,this._w=n,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._w)}copy(e){return this._x=e.x,this._y=e.y,this._z=e.z,this._w=e.w,this._onChangeCallback(),this}setFromEuler(e,t){const r=e._x,n=e._y,i=e._z,s=e._order,o=Math.cos,a=Math.sin,l=o(r/2),c=o(n/2),u=o(i/2),h=a(r/2),d=a(n/2),p=a(i/2);switch(s){case"XYZ":this._x=h*c*u+l*d*p,this._y=l*d*u-h*c*p,this._z=l*c*p+h*d*u,this._w=l*c*u-h*d*p;break;case"YXZ":this._x=h*c*u+l*d*p,this._y=l*d*u-h*c*p,this._z=l*c*p-h*d*u,this._w=l*c*u+h*d*p;break;case"ZXY":this._x=h*c*u-l*d*p,this._y=l*d*u+h*c*p,this._z=l*c*p+h*d*u,this._w=l*c*u-h*d*p;break;case"ZYX":this._x=h*c*u-l*d*p,this._y=l*d*u+h*c*p,this._z=l*c*p-h*d*u,this._w=l*c*u+h*d*p;break;case"YZX":this._x=h*c*u+l*d*p,this._y=l*d*u+h*c*p,this._z=l*c*p-h*d*u,this._w=l*c*u-h*d*p;break;case"XZY":this._x=h*c*u-l*d*p,this._y=l*d*u-h*c*p,this._z=l*c*p+h*d*u,this._w=l*c*u+h*d*p}return!1!==t&&this._onChangeCallback(),this}setFromAxisAngle(e,t){const r=t/2,n=Math.sin(r);return this._x=e.x*n,this._y=e.y*n,this._z=e.z*n,this._w=Math.cos(r),this._onChangeCallback(),this}setFromRotationMatrix(e){const t=e.elements,r=t[0],n=t[4],i=t[8],s=t[1],o=t[5],a=t[9],l=t[2],c=t[6],u=t[10],h=r+o+u;if(h>0){const e=.5/Math.sqrt(h+1);this._w=.25/e,this._x=(c-a)*e,this._y=(i-l)*e,this._z=(s-n)*e}else if(r>o&&r>u){const e=2*Math.sqrt(1+r-o-u);this._w=(c-a)/e,this._x=.25*e,this._y=(n+s)/e,this._z=(i+l)/e}else if(o>u){const e=2*Math.sqrt(1+o-r-u);this._w=(i-l)/e,this._x=(n+s)/e,this._y=.25*e,this._z=(a+c)/e}else{const e=2*Math.sqrt(1+u-r-o);this._w=(s-n)/e,this._x=(i+l)/e,this._y=(a+c)/e,this._z=.25*e}return this._onChangeCallback(),this}setFromUnitVectors(e,t){let r=e.dot(t)+1;return r<Number.EPSILON?(r=0,Math.abs(e.x)>Math.abs(e.z)?(this._x=-e.y,this._y=e.x,this._z=0,this._w=r):(this._x=0,this._y=-e.z,this._z=e.y,this._w=r)):(this._x=e.y*t.z-e.z*t.y,this._y=e.z*t.x-e.x*t.z,this._z=e.x*t.y-e.y*t.x,this._w=r),this.normalize()}angleTo(e){return 2*Math.acos(Math.abs(Gt(this.dot(e),-1,1)))}rotateTowards(e,t){const r=this.angleTo(e);if(0===r)return this;const n=Math.min(1,t/r);return this.slerp(e,n),this}identity(){return this.set(0,0,0,1)}invert(){return this.conjugate()}conjugate(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this}dot(e){return this._x*e._x+this._y*e._y+this._z*e._z+this._w*e._w}lengthSq(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w}length(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)}normalize(){let e=this.length();return 0===e?(this._x=0,this._y=0,this._z=0,this._w=1):(e=1/e,this._x=this._x*e,this._y=this._y*e,this._z=this._z*e,this._w=this._w*e),this._onChangeCallback(),this}multiply(e){return this.multiplyQuaternions(this,e)}premultiply(e){return this.multiplyQuaternions(e,this)}multiplyQuaternions(e,t){const r=e._x,n=e._y,i=e._z,s=e._w,o=t._x,a=t._y,l=t._z,c=t._w;return this._x=r*c+s*o+n*l-i*a,this._y=n*c+s*a+i*o-r*l,this._z=i*c+s*l+r*a-n*o,this._w=s*c-r*o-n*a-i*l,this._onChangeCallback(),this}slerp(e,t){if(0===t)return this;if(1===t)return this.copy(e);const r=this._x,n=this._y,i=this._z,s=this._w;let o=s*e._w+r*e._x+n*e._y+i*e._z;if(o<0?(this._w=-e._w,this._x=-e._x,this._y=-e._y,this._z=-e._z,o=-o):this.copy(e),o>=1)return this._w=s,this._x=r,this._y=n,this._z=i,this;const a=1-o*o;if(a<=Number.EPSILON){const e=1-t;return this._w=e*s+t*this._w,this._x=e*r+t*this._x,this._y=e*n+t*this._y,this._z=e*i+t*this._z,this.normalize(),this._onChangeCallback(),this}const l=Math.sqrt(a),c=Math.atan2(l,o),u=Math.sin((1-t)*c)/l,h=Math.sin(t*c)/l;return this._w=s*u+this._w*h,this._x=r*u+this._x*h,this._y=n*u+this._y*h,this._z=i*u+this._z*h,this._onChangeCallback(),this}slerpQuaternions(e,t,r){return this.copy(e).slerp(t,r)}random(){const e=Math.random(),t=Math.sqrt(1-e),r=Math.sqrt(e),n=2*Math.PI*Math.random(),i=2*Math.PI*Math.random();return this.set(t*Math.cos(n),r*Math.sin(i),r*Math.cos(i),t*Math.sin(n))}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._w===this._w}fromArray(e,t=0){return this._x=e[t],this._y=e[t+1],this._z=e[t+2],this._w=e[t+3],this._onChangeCallback(),this}toArray(e=[],t=0){return e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._w,e}fromBufferAttribute(e,t){return this._x=e.getX(t),this._y=e.getY(t),this._z=e.getZ(t),this._w=e.getW(t),this}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._w}}class nr{constructor(e=0,t=0,r=0){nr.prototype.isVector3=!0,this.x=e,this.y=t,this.z=r}set(e,t,r){return void 0===r&&(r=this.z),this.x=e,this.y=t,this.z=r,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this}multiplyVectors(e,t){return this.x=e.x*t.x,this.y=e.y*t.y,this.z=e.z*t.z,this}applyEuler(e){return this.applyQuaternion(sr.setFromEuler(e))}applyAxisAngle(e,t){return this.applyQuaternion(sr.setFromAxisAngle(e,t))}applyMatrix3(e){const t=this.x,r=this.y,n=this.z,i=e.elements;return this.x=i[0]*t+i[3]*r+i[6]*n,this.y=i[1]*t+i[4]*r+i[7]*n,this.z=i[2]*t+i[5]*r+i[8]*n,this}applyNormalMatrix(e){return this.applyMatrix3(e).normalize()}applyMatrix4(e){const t=this.x,r=this.y,n=this.z,i=e.elements,s=1/(i[3]*t+i[7]*r+i[11]*n+i[15]);return this.x=(i[0]*t+i[4]*r+i[8]*n+i[12])*s,this.y=(i[1]*t+i[5]*r+i[9]*n+i[13])*s,this.z=(i[2]*t+i[6]*r+i[10]*n+i[14])*s,this}applyQuaternion(e){const t=this.x,r=this.y,n=this.z,i=e.x,s=e.y,o=e.z,a=e.w,l=a*t+s*n-o*r,c=a*r+o*t-i*n,u=a*n+i*r-s*t,h=-i*t-s*r-o*n;return this.x=l*a+h*-i+c*-o-u*-s,this.y=c*a+h*-s+u*-i-l*-o,this.z=u*a+h*-o+l*-s-c*-i,this}project(e){return this.applyMatrix4(e.matrixWorldInverse).applyMatrix4(e.projectionMatrix)}unproject(e){return this.applyMatrix4(e.projectionMatrixInverse).applyMatrix4(e.matrixWorld)}transformDirection(e){const t=this.x,r=this.y,n=this.z,i=e.elements;return this.x=i[0]*t+i[4]*r+i[8]*n,this.y=i[1]*t+i[5]*r+i[9]*n,this.z=i[2]*t+i[6]*r+i[10]*n,this.normalize()}divide(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this}divideScalar(e){return this.multiplyScalar(1/e)}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this.z=Math.max(e.z,Math.min(t.z,this.z)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this.z=Math.max(e,Math.min(t,this.z)),this}clampLength(e,t){const r=this.length();return this.divideScalar(r||1).multiplyScalar(Math.max(e,Math.min(t,r)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this}lerpVectors(e,t,r){return this.x=e.x+(t.x-e.x)*r,this.y=e.y+(t.y-e.y)*r,this.z=e.z+(t.z-e.z)*r,this}cross(e){return this.crossVectors(this,e)}crossVectors(e,t){const r=e.x,n=e.y,i=e.z,s=t.x,o=t.y,a=t.z;return this.x=n*a-i*o,this.y=i*s-r*a,this.z=r*o-n*s,this}projectOnVector(e){const t=e.lengthSq();if(0===t)return this.set(0,0,0);const r=e.dot(this)/t;return this.copy(e).multiplyScalar(r)}projectOnPlane(e){return ir.copy(this).projectOnVector(e),this.sub(ir)}reflect(e){return this.sub(ir.copy(e).multiplyScalar(2*this.dot(e)))}angleTo(e){const t=Math.sqrt(this.lengthSq()*e.lengthSq());if(0===t)return Math.PI/2;const r=this.dot(e)/t;return Math.acos(Gt(r,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const t=this.x-e.x,r=this.y-e.y,n=this.z-e.z;return t*t+r*r+n*n}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)+Math.abs(this.z-e.z)}setFromSpherical(e){return this.setFromSphericalCoords(e.radius,e.phi,e.theta)}setFromSphericalCoords(e,t,r){const n=Math.sin(t)*e;return this.x=n*Math.sin(r),this.y=Math.cos(t)*e,this.z=n*Math.cos(r),this}setFromCylindrical(e){return this.setFromCylindricalCoords(e.radius,e.theta,e.y)}setFromCylindricalCoords(e,t,r){return this.x=e*Math.sin(t),this.y=r,this.z=e*Math.cos(t),this}setFromMatrixPosition(e){const t=e.elements;return this.x=t[12],this.y=t[13],this.z=t[14],this}setFromMatrixScale(e){const t=this.setFromMatrixColumn(e,0).length(),r=this.setFromMatrixColumn(e,1).length(),n=this.setFromMatrixColumn(e,2).length();return this.x=t,this.y=r,this.z=n,this}setFromMatrixColumn(e,t){return this.fromArray(e.elements,4*t)}setFromMatrix3Column(e,t){return this.fromArray(e.elements,3*t)}setFromEuler(e){return this.x=e._x,this.y=e._y,this.z=e._z,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this.z=e[t+2],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this}randomDirection(){const e=2*(Math.random()-.5),t=Math.random()*Math.PI*2,r=Math.sqrt(1-e**2);return this.x=r*Math.cos(t),this.y=r*Math.sin(t),this.z=e,this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z}}const ir=new nr,sr=new rr;function or(e){return e<.04045?.0773993808*e:Math.pow(.9478672986*e+.0521327014,2.4)}function ar(e){return e<.0031308?12.92*e:1.055*Math.pow(e,.41666)-.055}const lr=(new Qt).fromArray([.8224621,.0331941,.0170827,.177538,.9668058,.0723974,-1e-7,1e-7,.9105199]),cr=(new Qt).fromArray([1.2249401,-.0420569,-.0196376,-.2249404,1.0420571,-.0786361,1e-7,0,1.0982735]),ur=new nr;const hr={[Rt]:e=>e,[Lt]:e=>e.convertSRGBToLinear(),[Pt]:function(e){return e.convertSRGBToLinear(),ur.set(e.r,e.g,e.b).applyMatrix3(cr),e.setRGB(ur.x,ur.y,ur.z)}},dr={[Rt]:e=>e,[Lt]:e=>e.convertLinearToSRGB(),[Pt]:function(e){return ur.set(e.r,e.g,e.b).applyMatrix3(lr),e.setRGB(ur.x,ur.y,ur.z).convertLinearToSRGB()}},pr={enabled:!1,get legacyMode(){return!this.enabled},set legacyMode(e){this.enabled=!e},get workingColorSpace(){return Rt},set workingColorSpace(e){},convert:function(e,t,r){if(!1===this.enabled||t===r||!t||!r)return e;const n=hr[t],i=dr[r];if(void 0===n||void 0===i)throw new Error(`Unsupported color space conversion, "${t}" to "${r}".`);return i(n(e))},fromWorkingColorSpace:function(e,t){return this.convert(e,this.workingColorSpace,t)},toWorkingColorSpace:function(e,t){return this.convert(e,t,this.workingColorSpace)}};let fr;class mr{static getDataURL(e){if(/^data:/i.test(e.src))return e.src;if("undefined"==typeof HTMLCanvasElement)return e.src;let t;if(e instanceof HTMLCanvasElement)t=e;else{void 0===fr&&(fr=tr("canvas")),fr.width=e.width,fr.height=e.height;const r=fr.getContext("2d");e instanceof ImageData?r.putImageData(e,0,0):r.drawImage(e,0,0,e.width,e.height),t=fr}return t.width>2048||t.height>2048?t.toDataURL("image/jpeg",.6):t.toDataURL("image/png")}static sRGBToLinear(e){if("undefined"!=typeof HTMLImageElement&&e instanceof HTMLImageElement||"undefined"!=typeof HTMLCanvasElement&&e instanceof HTMLCanvasElement||"undefined"!=typeof ImageBitmap&&e instanceof ImageBitmap){const t=tr("canvas");t.width=e.width,t.height=e.height;const r=t.getContext("2d");r.drawImage(e,0,0,e.width,e.height);const n=r.getImageData(0,0,e.width,e.height),i=n.data;for(let e=0;e<i.length;e++)i[e]=255*or(i[e]/255);return r.putImageData(n,0,0),t}if(e.data){const t=e.data.slice(0);for(let e=0;e<t.length;e++)t instanceof Uint8Array||t instanceof Uint8ClampedArray?t[e]=Math.floor(255*or(t[e]/255)):t[e]=or(t[e]);return{data:t,width:e.width,height:e.height}}return e}}class gr{constructor(e=null){this.isSource=!0,this.uuid=zt(),this.data=e,this.version=0}set needsUpdate(e){!0===e&&this.version++}toJSON(e){const t=void 0===e||"string"==typeof e;if(!t&&void 0!==e.images[this.uuid])return e.images[this.uuid];const r={uuid:this.uuid,url:""},n=this.data;if(null!==n){let e;if(Array.isArray(n)){e=[];for(let t=0,r=n.length;t<r;t++)n[t].isDataTexture?e.push(yr(n[t].image)):e.push(yr(n[t]))}else e=yr(n);r.url=e}return t||(e.images[this.uuid]=r),r}}function yr(e){return"undefined"!=typeof HTMLImageElement&&e instanceof HTMLImageElement||"undefined"!=typeof HTMLCanvasElement&&e instanceof HTMLCanvasElement||"undefined"!=typeof ImageBitmap&&e instanceof ImageBitmap?mr.getDataURL(e):e.data?{data:Array.from(e.data),width:e.width,height:e.height,type:e.data.constructor.name}:{}}let vr=0;class _r extends Nt{constructor(e=_r.DEFAULT_IMAGE,t=_r.DEFAULT_MAPPING,r=oe,n=oe,i=he,s=pe,o=Ee,a=fe,l=_r.DEFAULT_ANISOTROPY,c=Mt){super(),this.isTexture=!0,Object.defineProperty(this,"id",{value:vr++}),this.uuid=zt(),this.name="",this.source=new gr(e),this.mipmaps=[],this.mapping=t,this.wrapS=r,this.wrapT=n,this.magFilter=i,this.minFilter=s,this.anisotropy=l,this.format=o,this.internalFormat=null,this.type=a,this.offset=new Kt(0,0),this.repeat=new Kt(1,1),this.center=new Kt(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new Qt,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,this.encoding=c,this.userData={},this.version=0,this.onUpdate=null,this.isRenderTargetTexture=!1,this.needsPMREMUpdate=!1}get image(){return this.source.data}set image(e=null){this.source.data=e}updateMatrix(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)}clone(){return(new this.constructor).copy(this)}copy(e){return this.name=e.name,this.source=e.source,this.mipmaps=e.mipmaps.slice(0),this.mapping=e.mapping,this.wrapS=e.wrapS,this.wrapT=e.wrapT,this.magFilter=e.magFilter,this.minFilter=e.minFilter,this.anisotropy=e.anisotropy,this.format=e.format,this.internalFormat=e.internalFormat,this.type=e.type,this.offset.copy(e.offset),this.repeat.copy(e.repeat),this.center.copy(e.center),this.rotation=e.rotation,this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrix.copy(e.matrix),this.generateMipmaps=e.generateMipmaps,this.premultiplyAlpha=e.premultiplyAlpha,this.flipY=e.flipY,this.unpackAlignment=e.unpackAlignment,this.encoding=e.encoding,this.userData=JSON.parse(JSON.stringify(e.userData)),this.needsUpdate=!0,this}toJSON(e){const t=void 0===e||"string"==typeof e;if(!t&&void 0!==e.textures[this.uuid])return e.textures[this.uuid];const r={metadata:{version:4.5,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,image:this.source.toJSON(e).uuid,mapping:this.mapping,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,internalFormat:this.internalFormat,type:this.type,encoding:this.encoding,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,generateMipmaps:this.generateMipmaps,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};return Object.keys(this.userData).length>0&&(r.userData=this.userData),t||(e.textures[this.uuid]=r),r}dispose(){this.dispatchEvent({type:"dispose"})}transformUv(e){if(300!==this.mapping)return e;if(e.applyMatrix3(this.matrix),e.x<0||e.x>1)switch(this.wrapS){case se:e.x=e.x-Math.floor(e.x);break;case oe:e.x=e.x<0?0:1;break;case ae:1===Math.abs(Math.floor(e.x)%2)?e.x=Math.ceil(e.x)-e.x:e.x=e.x-Math.floor(e.x)}if(e.y<0||e.y>1)switch(this.wrapT){case se:e.y=e.y-Math.floor(e.y);break;case oe:e.y=e.y<0?0:1;break;case ae:1===Math.abs(Math.floor(e.y)%2)?e.y=Math.ceil(e.y)-e.y:e.y=e.y-Math.floor(e.y)}return this.flipY&&(e.y=1-e.y),e}set needsUpdate(e){!0===e&&(this.version++,this.source.needsUpdate=!0)}}_r.DEFAULT_IMAGE=null,_r.DEFAULT_MAPPING=300,_r.DEFAULT_ANISOTROPY=1;class xr{constructor(e=0,t=0,r=0,n=1){xr.prototype.isVector4=!0,this.x=e,this.y=t,this.z=r,this.w=n}get width(){return this.z}set width(e){this.z=e}get height(){return this.w}set height(e){this.w=e}set(e,t,r,n){return this.x=e,this.y=t,this.z=r,this.w=n,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this.w=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setW(e){return this.w=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;case 3:this.w=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z,this.w)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this.w=void 0!==e.w?e.w:1,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this.w+=e.w,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this.w+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this.w=e.w+t.w,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this.w+=e.w*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this.w-=e.w,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this.w-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this.w=e.w-t.w,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this.w*=e.w,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this.w*=e,this}applyMatrix4(e){const t=this.x,r=this.y,n=this.z,i=this.w,s=e.elements;return this.x=s[0]*t+s[4]*r+s[8]*n+s[12]*i,this.y=s[1]*t+s[5]*r+s[9]*n+s[13]*i,this.z=s[2]*t+s[6]*r+s[10]*n+s[14]*i,this.w=s[3]*t+s[7]*r+s[11]*n+s[15]*i,this}divideScalar(e){return this.multiplyScalar(1/e)}setAxisAngleFromQuaternion(e){this.w=2*Math.acos(e.w);const t=Math.sqrt(1-e.w*e.w);return t<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=e.x/t,this.y=e.y/t,this.z=e.z/t),this}setAxisAngleFromRotationMatrix(e){let t,r,n,i;const s=.01,o=.1,a=e.elements,l=a[0],c=a[4],u=a[8],h=a[1],d=a[5],p=a[9],f=a[2],m=a[6],g=a[10];if(Math.abs(c-h)<s&&Math.abs(u-f)<s&&Math.abs(p-m)<s){if(Math.abs(c+h)<o&&Math.abs(u+f)<o&&Math.abs(p+m)<o&&Math.abs(l+d+g-3)<o)return this.set(1,0,0,0),this;t=Math.PI;const e=(l+1)/2,a=(d+1)/2,y=(g+1)/2,v=(c+h)/4,_=(u+f)/4,x=(p+m)/4;return e>a&&e>y?e<s?(r=0,n=.707106781,i=.707106781):(r=Math.sqrt(e),n=v/r,i=_/r):a>y?a<s?(r=.707106781,n=0,i=.707106781):(n=Math.sqrt(a),r=v/n,i=x/n):y<s?(r=.707106781,n=.707106781,i=0):(i=Math.sqrt(y),r=_/i,n=x/i),this.set(r,n,i,t),this}let y=Math.sqrt((m-p)*(m-p)+(u-f)*(u-f)+(h-c)*(h-c));return Math.abs(y)<.001&&(y=1),this.x=(m-p)/y,this.y=(u-f)/y,this.z=(h-c)/y,this.w=Math.acos((l+d+g-1)/2),this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this.w=Math.min(this.w,e.w),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this.w=Math.max(this.w,e.w),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this.z=Math.max(e.z,Math.min(t.z,this.z)),this.w=Math.max(e.w,Math.min(t.w,this.w)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this.z=Math.max(e,Math.min(t,this.z)),this.w=Math.max(e,Math.min(t,this.w)),this}clampLength(e,t){const r=this.length();return this.divideScalar(r||1).multiplyScalar(Math.max(e,Math.min(t,r)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this.w=this.w<0?Math.ceil(this.w):Math.floor(this.w),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z+this.w*e.w}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this.w+=(e.w-this.w)*t,this}lerpVectors(e,t,r){return this.x=e.x+(t.x-e.x)*r,this.y=e.y+(t.y-e.y)*r,this.z=e.z+(t.z-e.z)*r,this.w=e.w+(t.w-e.w)*r,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z&&e.w===this.w}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this.z=e[t+2],this.w=e[t+3],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e[t+3]=this.w,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this.w=e.getW(t),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this.w=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z,yield this.w}}class br extends Nt{constructor(e=1,t=1,r={}){super(),this.isWebGLRenderTarget=!0,this.width=e,this.height=t,this.depth=1,this.scissor=new xr(0,0,e,t),this.scissorTest=!1,this.viewport=new xr(0,0,e,t);const n={width:e,height:t,depth:1};this.texture=new _r(n,r.mapping,r.wrapS,r.wrapT,r.magFilter,r.minFilter,r.format,r.type,r.anisotropy,r.encoding),this.texture.isRenderTargetTexture=!0,this.texture.flipY=!1,this.texture.generateMipmaps=void 0!==r.generateMipmaps&&r.generateMipmaps,this.texture.internalFormat=void 0!==r.internalFormat?r.internalFormat:null,this.texture.minFilter=void 0!==r.minFilter?r.minFilter:he,this.depthBuffer=void 0===r.depthBuffer||r.depthBuffer,this.stencilBuffer=void 0!==r.stencilBuffer&&r.stencilBuffer,this.depthTexture=void 0!==r.depthTexture?r.depthTexture:null,this.samples=void 0!==r.samples?r.samples:0}setSize(e,t,r=1){this.width===e&&this.height===t&&this.depth===r||(this.width=e,this.height=t,this.depth=r,this.texture.image.width=e,this.texture.image.height=t,this.texture.image.depth=r,this.dispose()),this.viewport.set(0,0,e,t),this.scissor.set(0,0,e,t)}clone(){return(new this.constructor).copy(this)}copy(e){this.width=e.width,this.height=e.height,this.depth=e.depth,this.viewport.copy(e.viewport),this.texture=e.texture.clone(),this.texture.isRenderTargetTexture=!0;const t=Object.assign({},e.texture.image);return this.texture.source=new gr(t),this.depthBuffer=e.depthBuffer,this.stencilBuffer=e.stencilBuffer,null!==e.depthTexture&&(this.depthTexture=e.depthTexture.clone()),this.samples=e.samples,this}dispose(){this.dispatchEvent({type:"dispose"})}}class wr extends _r{constructor(e=null,t=1,r=1,n=1){super(null),this.isDataArrayTexture=!0,this.image={data:e,width:t,height:r,depth:n},this.magFilter=le,this.minFilter=le,this.wrapR=oe,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}class Sr extends _r{constructor(e=null,t=1,r=1,n=1){super(null),this.isData3DTexture=!0,this.image={data:e,width:t,height:r,depth:n},this.magFilter=le,this.minFilter=le,this.wrapR=oe,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}class Mr{constructor(e=new nr(1/0,1/0,1/0),t=new nr(-1/0,-1/0,-1/0)){this.isBox3=!0,this.min=e,this.max=t}set(e,t){return this.min.copy(e),this.max.copy(t),this}setFromArray(e){let t=1/0,r=1/0,n=1/0,i=-1/0,s=-1/0,o=-1/0;for(let a=0,l=e.length;a<l;a+=3){const l=e[a],c=e[a+1],u=e[a+2];l<t&&(t=l),c<r&&(r=c),u<n&&(n=u),l>i&&(i=l),c>s&&(s=c),u>o&&(o=u)}return this.min.set(t,r,n),this.max.set(i,s,o),this}setFromBufferAttribute(e){let t=1/0,r=1/0,n=1/0,i=-1/0,s=-1/0,o=-1/0;for(let a=0,l=e.count;a<l;a++){const l=e.getX(a),c=e.getY(a),u=e.getZ(a);l<t&&(t=l),c<r&&(r=c),u<n&&(n=u),l>i&&(i=l),c>s&&(s=c),u>o&&(o=u)}return this.min.set(t,r,n),this.max.set(i,s,o),this}setFromPoints(e){this.makeEmpty();for(let t=0,r=e.length;t<r;t++)this.expandByPoint(e[t]);return this}setFromCenterAndSize(e,t){const r=Er.copy(t).multiplyScalar(.5);return this.min.copy(e).sub(r),this.max.copy(e).add(r),this}setFromObject(e,t=!1){return this.makeEmpty(),this.expandByObject(e,t)}clone(){return(new this.constructor).copy(this)}copy(e){return this.min.copy(e.min),this.max.copy(e.max),this}makeEmpty(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z}getCenter(e){return this.isEmpty()?e.set(0,0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(e){return this.isEmpty()?e.set(0,0,0):e.subVectors(this.max,this.min)}expandByPoint(e){return this.min.min(e),this.max.max(e),this}expandByVector(e){return this.min.sub(e),this.max.add(e),this}expandByScalar(e){return this.min.addScalar(-e),this.max.addScalar(e),this}expandByObject(e,t=!1){e.updateWorldMatrix(!1,!1);const r=e.geometry;if(void 0!==r)if(t&&null!=r.attributes&&void 0!==r.attributes.position){const t=r.attributes.position;for(let r=0,n=t.count;r<n;r++)Er.fromBufferAttribute(t,r).applyMatrix4(e.matrixWorld),this.expandByPoint(Er)}else null===r.boundingBox&&r.computeBoundingBox(),Ar.copy(r.boundingBox),Ar.applyMatrix4(e.matrixWorld),this.union(Ar);const n=e.children;for(let e=0,r=n.length;e<r;e++)this.expandByObject(n[e],t);return this}containsPoint(e){return!(e.x<this.min.x||e.x>this.max.x||e.y<this.min.y||e.y>this.max.y||e.z<this.min.z||e.z>this.max.z)}containsBox(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y&&this.min.z<=e.min.z&&e.max.z<=this.max.z}getParameter(e,t){return t.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y),(e.z-this.min.z)/(this.max.z-this.min.z))}intersectsBox(e){return!(e.max.x<this.min.x||e.min.x>this.max.x||e.max.y<this.min.y||e.min.y>this.max.y||e.max.z<this.min.z||e.min.z>this.max.z)}intersectsSphere(e){return this.clampPoint(e.center,Er),Er.distanceToSquared(e.center)<=e.radius*e.radius}intersectsPlane(e){let t,r;return e.normal.x>0?(t=e.normal.x*this.min.x,r=e.normal.x*this.max.x):(t=e.normal.x*this.max.x,r=e.normal.x*this.min.x),e.normal.y>0?(t+=e.normal.y*this.min.y,r+=e.normal.y*this.max.y):(t+=e.normal.y*this.max.y,r+=e.normal.y*this.min.y),e.normal.z>0?(t+=e.normal.z*this.min.z,r+=e.normal.z*this.max.z):(t+=e.normal.z*this.max.z,r+=e.normal.z*this.min.z),t<=-e.constant&&r>=-e.constant}intersectsTriangle(e){if(this.isEmpty())return!1;this.getCenter(Dr),Or.subVectors(this.max,Dr),Cr.subVectors(e.a,Dr),Lr.subVectors(e.b,Dr),Rr.subVectors(e.c,Dr),Pr.subVectors(Lr,Cr),jr.subVectors(Rr,Lr),Ir.subVectors(Cr,Rr);let t=[0,-Pr.z,Pr.y,0,-jr.z,jr.y,0,-Ir.z,Ir.y,Pr.z,0,-Pr.x,jr.z,0,-jr.x,Ir.z,0,-Ir.x,-Pr.y,Pr.x,0,-jr.y,jr.x,0,-Ir.y,Ir.x,0];return!!kr(t,Cr,Lr,Rr,Or)&&(t=[1,0,0,0,1,0,0,0,1],!!kr(t,Cr,Lr,Rr,Or)&&(Nr.crossVectors(Pr,jr),t=[Nr.x,Nr.y,Nr.z],kr(t,Cr,Lr,Rr,Or)))}clampPoint(e,t){return t.copy(e).clamp(this.min,this.max)}distanceToPoint(e){return this.clampPoint(e,Er).distanceTo(e)}getBoundingSphere(e){return this.isEmpty()?e.makeEmpty():(this.getCenter(e.center),e.radius=.5*this.getSize(Er).length()),e}intersect(e){return this.min.max(e.min),this.max.min(e.max),this.isEmpty()&&this.makeEmpty(),this}union(e){return this.min.min(e.min),this.max.max(e.max),this}applyMatrix4(e){return this.isEmpty()||(Tr[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(e),Tr[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(e),Tr[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(e),Tr[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(e),Tr[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(e),Tr[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(e),Tr[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(e),Tr[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(e),this.setFromPoints(Tr)),this}translate(e){return this.min.add(e),this.max.add(e),this}equals(e){return e.min.equals(this.min)&&e.max.equals(this.max)}}const Tr=[new nr,new nr,new nr,new nr,new nr,new nr,new nr,new nr],Er=new nr,Ar=new Mr,Cr=new nr,Lr=new nr,Rr=new nr,Pr=new nr,jr=new nr,Ir=new nr,Dr=new nr,Or=new nr,Nr=new nr,Ur=new nr;function kr(e,t,r,n,i){for(let s=0,o=e.length-3;s<=o;s+=3){Ur.fromArray(e,s);const o=i.x*Math.abs(Ur.x)+i.y*Math.abs(Ur.y)+i.z*Math.abs(Ur.z),a=t.dot(Ur),l=r.dot(Ur),c=n.dot(Ur);if(Math.max(-Math.max(a,l,c),Math.min(a,l,c))>o)return!1}return!0}const Fr=new Mr,Br=new nr,zr=new nr;class Gr{constructor(e=new nr,t=-1){this.center=e,this.radius=t}set(e,t){return this.center.copy(e),this.radius=t,this}setFromPoints(e,t){const r=this.center;void 0!==t?r.copy(t):Fr.setFromPoints(e).getCenter(r);let n=0;for(let t=0,i=e.length;t<i;t++)n=Math.max(n,r.distanceToSquared(e[t]));return this.radius=Math.sqrt(n),this}copy(e){return this.center.copy(e.center),this.radius=e.radius,this}isEmpty(){return this.radius<0}makeEmpty(){return this.center.set(0,0,0),this.radius=-1,this}containsPoint(e){return e.distanceToSquared(this.center)<=this.radius*this.radius}distanceToPoint(e){return e.distanceTo(this.center)-this.radius}intersectsSphere(e){const t=this.radius+e.radius;return e.center.distanceToSquared(this.center)<=t*t}intersectsBox(e){return e.intersectsSphere(this)}intersectsPlane(e){return Math.abs(e.distanceToPoint(this.center))<=this.radius}clampPoint(e,t){const r=this.center.distanceToSquared(e);return t.copy(e),r>this.radius*this.radius&&(t.sub(this.center).normalize(),t.multiplyScalar(this.radius).add(this.center)),t}getBoundingBox(e){return this.isEmpty()?(e.makeEmpty(),e):(e.set(this.center,this.center),e.expandByScalar(this.radius),e)}applyMatrix4(e){return this.center.applyMatrix4(e),this.radius=this.radius*e.getMaxScaleOnAxis(),this}translate(e){return this.center.add(e),this}expandByPoint(e){if(this.isEmpty())return this.center.copy(e),this.radius=0,this;Br.subVectors(e,this.center);const t=Br.lengthSq();if(t>this.radius*this.radius){const e=Math.sqrt(t),r=.5*(e-this.radius);this.center.addScaledVector(Br,r/e),this.radius+=r}return this}union(e){return e.isEmpty()?this:this.isEmpty()?(this.copy(e),this):(!0===this.center.equals(e.center)?this.radius=Math.max(this.radius,e.radius):(zr.subVectors(e.center,this.center).setLength(e.radius),this.expandByPoint(Br.copy(e.center).add(zr)),this.expandByPoint(Br.copy(e.center).sub(zr))),this)}equals(e){return e.center.equals(this.center)&&e.radius===this.radius}clone(){return(new this.constructor).copy(this)}}const Vr=new nr,Hr=new nr,Wr=new nr,Xr=new nr,qr=new nr,Yr=new nr,Zr=new nr;class Jr{constructor(e=new nr,t=new nr(0,0,-1)){this.origin=e,this.direction=t}set(e,t){return this.origin.copy(e),this.direction.copy(t),this}copy(e){return this.origin.copy(e.origin),this.direction.copy(e.direction),this}at(e,t){return t.copy(this.origin).addScaledVector(this.direction,e)}lookAt(e){return this.direction.copy(e).sub(this.origin).normalize(),this}recast(e){return this.origin.copy(this.at(e,Vr)),this}closestPointToPoint(e,t){t.subVectors(e,this.origin);const r=t.dot(this.direction);return r<0?t.copy(this.origin):t.copy(this.origin).addScaledVector(this.direction,r)}distanceToPoint(e){return Math.sqrt(this.distanceSqToPoint(e))}distanceSqToPoint(e){const t=Vr.subVectors(e,this.origin).dot(this.direction);return t<0?this.origin.distanceToSquared(e):(Vr.copy(this.origin).addScaledVector(this.direction,t),Vr.distanceToSquared(e))}distanceSqToSegment(e,t,r,n){Hr.copy(e).add(t).multiplyScalar(.5),Wr.copy(t).sub(e).normalize(),Xr.copy(this.origin).sub(Hr);const i=.5*e.distanceTo(t),s=-this.direction.dot(Wr),o=Xr.dot(this.direction),a=-Xr.dot(Wr),l=Xr.lengthSq(),c=Math.abs(1-s*s);let u,h,d,p;if(c>0)if(u=s*a-o,h=s*o-a,p=i*c,u>=0)if(h>=-p)if(h<=p){const e=1/c;u*=e,h*=e,d=u*(u+s*h+2*o)+h*(s*u+h+2*a)+l}else h=i,u=Math.max(0,-(s*h+o)),d=-u*u+h*(h+2*a)+l;else h=-i,u=Math.max(0,-(s*h+o)),d=-u*u+h*(h+2*a)+l;else h<=-p?(u=Math.max(0,-(-s*i+o)),h=u>0?-i:Math.min(Math.max(-i,-a),i),d=-u*u+h*(h+2*a)+l):h<=p?(u=0,h=Math.min(Math.max(-i,-a),i),d=h*(h+2*a)+l):(u=Math.max(0,-(s*i+o)),h=u>0?i:Math.min(Math.max(-i,-a),i),d=-u*u+h*(h+2*a)+l);else h=s>0?-i:i,u=Math.max(0,-(s*h+o)),d=-u*u+h*(h+2*a)+l;return r&&r.copy(this.origin).addScaledVector(this.direction,u),n&&n.copy(Hr).addScaledVector(Wr,h),d}intersectSphere(e,t){Vr.subVectors(e.center,this.origin);const r=Vr.dot(this.direction),n=Vr.dot(Vr)-r*r,i=e.radius*e.radius;if(n>i)return null;const s=Math.sqrt(i-n),o=r-s,a=r+s;return a<0?null:o<0?this.at(a,t):this.at(o,t)}intersectsSphere(e){return this.distanceSqToPoint(e.center)<=e.radius*e.radius}distanceToPlane(e){const t=e.normal.dot(this.direction);if(0===t)return 0===e.distanceToPoint(this.origin)?0:null;const r=-(this.origin.dot(e.normal)+e.constant)/t;return r>=0?r:null}intersectPlane(e,t){const r=this.distanceToPlane(e);return null===r?null:this.at(r,t)}intersectsPlane(e){const t=e.distanceToPoint(this.origin);if(0===t)return!0;return e.normal.dot(this.direction)*t<0}intersectBox(e,t){let r,n,i,s,o,a;const l=1/this.direction.x,c=1/this.direction.y,u=1/this.direction.z,h=this.origin;return l>=0?(r=(e.min.x-h.x)*l,n=(e.max.x-h.x)*l):(r=(e.max.x-h.x)*l,n=(e.min.x-h.x)*l),c>=0?(i=(e.min.y-h.y)*c,s=(e.max.y-h.y)*c):(i=(e.max.y-h.y)*c,s=(e.min.y-h.y)*c),r>s||i>n?null:((i>r||isNaN(r))&&(r=i),(s<n||isNaN(n))&&(n=s),u>=0?(o=(e.min.z-h.z)*u,a=(e.max.z-h.z)*u):(o=(e.max.z-h.z)*u,a=(e.min.z-h.z)*u),r>a||o>n?null:((o>r||r!=r)&&(r=o),(a<n||n!=n)&&(n=a),n<0?null:this.at(r>=0?r:n,t)))}intersectsBox(e){return null!==this.intersectBox(e,Vr)}intersectTriangle(e,t,r,n,i){qr.subVectors(t,e),Yr.subVectors(r,e),Zr.crossVectors(qr,Yr);let s,o=this.direction.dot(Zr);if(o>0){if(n)return null;s=1}else{if(!(o<0))return null;s=-1,o=-o}Xr.subVectors(this.origin,e);const a=s*this.direction.dot(Yr.crossVectors(Xr,Yr));if(a<0)return null;const l=s*this.direction.dot(qr.cross(Xr));if(l<0)return null;if(a+l>o)return null;const c=-s*Xr.dot(Zr);return c<0?null:this.at(c/o,i)}applyMatrix4(e){return this.origin.applyMatrix4(e),this.direction.transformDirection(e),this}equals(e){return e.origin.equals(this.origin)&&e.direction.equals(this.direction)}clone(){return(new this.constructor).copy(this)}}class Kr{constructor(){Kr.prototype.isMatrix4=!0,this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}set(e,t,r,n,i,s,o,a,l,c,u,h,d,p,f,m){const g=this.elements;return g[0]=e,g[4]=t,g[8]=r,g[12]=n,g[1]=i,g[5]=s,g[9]=o,g[13]=a,g[2]=l,g[6]=c,g[10]=u,g[14]=h,g[3]=d,g[7]=p,g[11]=f,g[15]=m,this}identity(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this}clone(){return(new Kr).fromArray(this.elements)}copy(e){const t=this.elements,r=e.elements;return t[0]=r[0],t[1]=r[1],t[2]=r[2],t[3]=r[3],t[4]=r[4],t[5]=r[5],t[6]=r[6],t[7]=r[7],t[8]=r[8],t[9]=r[9],t[10]=r[10],t[11]=r[11],t[12]=r[12],t[13]=r[13],t[14]=r[14],t[15]=r[15],this}copyPosition(e){const t=this.elements,r=e.elements;return t[12]=r[12],t[13]=r[13],t[14]=r[14],this}setFromMatrix3(e){const t=e.elements;return this.set(t[0],t[3],t[6],0,t[1],t[4],t[7],0,t[2],t[5],t[8],0,0,0,0,1),this}extractBasis(e,t,r){return e.setFromMatrixColumn(this,0),t.setFromMatrixColumn(this,1),r.setFromMatrixColumn(this,2),this}makeBasis(e,t,r){return this.set(e.x,t.x,r.x,0,e.y,t.y,r.y,0,e.z,t.z,r.z,0,0,0,0,1),this}extractRotation(e){const t=this.elements,r=e.elements,n=1/Qr.setFromMatrixColumn(e,0).length(),i=1/Qr.setFromMatrixColumn(e,1).length(),s=1/Qr.setFromMatrixColumn(e,2).length();return t[0]=r[0]*n,t[1]=r[1]*n,t[2]=r[2]*n,t[3]=0,t[4]=r[4]*i,t[5]=r[5]*i,t[6]=r[6]*i,t[7]=0,t[8]=r[8]*s,t[9]=r[9]*s,t[10]=r[10]*s,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}makeRotationFromEuler(e){const t=this.elements,r=e.x,n=e.y,i=e.z,s=Math.cos(r),o=Math.sin(r),a=Math.cos(n),l=Math.sin(n),c=Math.cos(i),u=Math.sin(i);if("XYZ"===e.order){const e=s*c,r=s*u,n=o*c,i=o*u;t[0]=a*c,t[4]=-a*u,t[8]=l,t[1]=r+n*l,t[5]=e-i*l,t[9]=-o*a,t[2]=i-e*l,t[6]=n+r*l,t[10]=s*a}else if("YXZ"===e.order){const e=a*c,r=a*u,n=l*c,i=l*u;t[0]=e+i*o,t[4]=n*o-r,t[8]=s*l,t[1]=s*u,t[5]=s*c,t[9]=-o,t[2]=r*o-n,t[6]=i+e*o,t[10]=s*a}else if("ZXY"===e.order){const e=a*c,r=a*u,n=l*c,i=l*u;t[0]=e-i*o,t[4]=-s*u,t[8]=n+r*o,t[1]=r+n*o,t[5]=s*c,t[9]=i-e*o,t[2]=-s*l,t[6]=o,t[10]=s*a}else if("ZYX"===e.order){const e=s*c,r=s*u,n=o*c,i=o*u;t[0]=a*c,t[4]=n*l-r,t[8]=e*l+i,t[1]=a*u,t[5]=i*l+e,t[9]=r*l-n,t[2]=-l,t[6]=o*a,t[10]=s*a}else if("YZX"===e.order){const e=s*a,r=s*l,n=o*a,i=o*l;t[0]=a*c,t[4]=i-e*u,t[8]=n*u+r,t[1]=u,t[5]=s*c,t[9]=-o*c,t[2]=-l*c,t[6]=r*u+n,t[10]=e-i*u}else if("XZY"===e.order){const e=s*a,r=s*l,n=o*a,i=o*l;t[0]=a*c,t[4]=-u,t[8]=l*c,t[1]=e*u+i,t[5]=s*c,t[9]=r*u-n,t[2]=n*u-r,t[6]=o*c,t[10]=i*u+e}return t[3]=0,t[7]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}makeRotationFromQuaternion(e){return this.compose(en,e,tn)}lookAt(e,t,r){const n=this.elements;return sn.subVectors(e,t),0===sn.lengthSq()&&(sn.z=1),sn.normalize(),rn.crossVectors(r,sn),0===rn.lengthSq()&&(1===Math.abs(r.z)?sn.x+=1e-4:sn.z+=1e-4,sn.normalize(),rn.crossVectors(r,sn)),rn.normalize(),nn.crossVectors(sn,rn),n[0]=rn.x,n[4]=nn.x,n[8]=sn.x,n[1]=rn.y,n[5]=nn.y,n[9]=sn.y,n[2]=rn.z,n[6]=nn.z,n[10]=sn.z,this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,t){const r=e.elements,n=t.elements,i=this.elements,s=r[0],o=r[4],a=r[8],l=r[12],c=r[1],u=r[5],h=r[9],d=r[13],p=r[2],f=r[6],m=r[10],g=r[14],y=r[3],v=r[7],_=r[11],x=r[15],b=n[0],w=n[4],S=n[8],M=n[12],T=n[1],E=n[5],A=n[9],C=n[13],L=n[2],R=n[6],P=n[10],j=n[14],I=n[3],D=n[7],O=n[11],N=n[15];return i[0]=s*b+o*T+a*L+l*I,i[4]=s*w+o*E+a*R+l*D,i[8]=s*S+o*A+a*P+l*O,i[12]=s*M+o*C+a*j+l*N,i[1]=c*b+u*T+h*L+d*I,i[5]=c*w+u*E+h*R+d*D,i[9]=c*S+u*A+h*P+d*O,i[13]=c*M+u*C+h*j+d*N,i[2]=p*b+f*T+m*L+g*I,i[6]=p*w+f*E+m*R+g*D,i[10]=p*S+f*A+m*P+g*O,i[14]=p*M+f*C+m*j+g*N,i[3]=y*b+v*T+_*L+x*I,i[7]=y*w+v*E+_*R+x*D,i[11]=y*S+v*A+_*P+x*O,i[15]=y*M+v*C+_*j+x*N,this}multiplyScalar(e){const t=this.elements;return t[0]*=e,t[4]*=e,t[8]*=e,t[12]*=e,t[1]*=e,t[5]*=e,t[9]*=e,t[13]*=e,t[2]*=e,t[6]*=e,t[10]*=e,t[14]*=e,t[3]*=e,t[7]*=e,t[11]*=e,t[15]*=e,this}determinant(){const e=this.elements,t=e[0],r=e[4],n=e[8],i=e[12],s=e[1],o=e[5],a=e[9],l=e[13],c=e[2],u=e[6],h=e[10],d=e[14];return e[3]*(+i*a*u-n*l*u-i*o*h+r*l*h+n*o*d-r*a*d)+e[7]*(+t*a*d-t*l*h+i*s*h-n*s*d+n*l*c-i*a*c)+e[11]*(+t*l*u-t*o*d-i*s*u+r*s*d+i*o*c-r*l*c)+e[15]*(-n*o*c-t*a*u+t*o*h+n*s*u-r*s*h+r*a*c)}transpose(){const e=this.elements;let t;return t=e[1],e[1]=e[4],e[4]=t,t=e[2],e[2]=e[8],e[8]=t,t=e[6],e[6]=e[9],e[9]=t,t=e[3],e[3]=e[12],e[12]=t,t=e[7],e[7]=e[13],e[13]=t,t=e[11],e[11]=e[14],e[14]=t,this}setPosition(e,t,r){const n=this.elements;return e.isVector3?(n[12]=e.x,n[13]=e.y,n[14]=e.z):(n[12]=e,n[13]=t,n[14]=r),this}invert(){const e=this.elements,t=e[0],r=e[1],n=e[2],i=e[3],s=e[4],o=e[5],a=e[6],l=e[7],c=e[8],u=e[9],h=e[10],d=e[11],p=e[12],f=e[13],m=e[14],g=e[15],y=u*m*l-f*h*l+f*a*d-o*m*d-u*a*g+o*h*g,v=p*h*l-c*m*l-p*a*d+s*m*d+c*a*g-s*h*g,_=c*f*l-p*u*l+p*o*d-s*f*d-c*o*g+s*u*g,x=p*u*a-c*f*a-p*o*h+s*f*h+c*o*m-s*u*m,b=t*y+r*v+n*_+i*x;if(0===b)return this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);const w=1/b;return e[0]=y*w,e[1]=(f*h*i-u*m*i-f*n*d+r*m*d+u*n*g-r*h*g)*w,e[2]=(o*m*i-f*a*i+f*n*l-r*m*l-o*n*g+r*a*g)*w,e[3]=(u*a*i-o*h*i-u*n*l+r*h*l+o*n*d-r*a*d)*w,e[4]=v*w,e[5]=(c*m*i-p*h*i+p*n*d-t*m*d-c*n*g+t*h*g)*w,e[6]=(p*a*i-s*m*i-p*n*l+t*m*l+s*n*g-t*a*g)*w,e[7]=(s*h*i-c*a*i+c*n*l-t*h*l-s*n*d+t*a*d)*w,e[8]=_*w,e[9]=(p*u*i-c*f*i-p*r*d+t*f*d+c*r*g-t*u*g)*w,e[10]=(s*f*i-p*o*i+p*r*l-t*f*l-s*r*g+t*o*g)*w,e[11]=(c*o*i-s*u*i-c*r*l+t*u*l+s*r*d-t*o*d)*w,e[12]=x*w,e[13]=(c*f*n-p*u*n+p*r*h-t*f*h-c*r*m+t*u*m)*w,e[14]=(p*o*n-s*f*n-p*r*a+t*f*a+s*r*m-t*o*m)*w,e[15]=(s*u*n-c*o*n+c*r*a-t*u*a-s*r*h+t*o*h)*w,this}scale(e){const t=this.elements,r=e.x,n=e.y,i=e.z;return t[0]*=r,t[4]*=n,t[8]*=i,t[1]*=r,t[5]*=n,t[9]*=i,t[2]*=r,t[6]*=n,t[10]*=i,t[3]*=r,t[7]*=n,t[11]*=i,this}getMaxScaleOnAxis(){const e=this.elements,t=e[0]*e[0]+e[1]*e[1]+e[2]*e[2],r=e[4]*e[4]+e[5]*e[5]+e[6]*e[6],n=e[8]*e[8]+e[9]*e[9]+e[10]*e[10];return Math.sqrt(Math.max(t,r,n))}makeTranslation(e,t,r){return this.set(1,0,0,e,0,1,0,t,0,0,1,r,0,0,0,1),this}makeRotationX(e){const t=Math.cos(e),r=Math.sin(e);return this.set(1,0,0,0,0,t,-r,0,0,r,t,0,0,0,0,1),this}makeRotationY(e){const t=Math.cos(e),r=Math.sin(e);return this.set(t,0,r,0,0,1,0,0,-r,0,t,0,0,0,0,1),this}makeRotationZ(e){const t=Math.cos(e),r=Math.sin(e);return this.set(t,-r,0,0,r,t,0,0,0,0,1,0,0,0,0,1),this}makeRotationAxis(e,t){const r=Math.cos(t),n=Math.sin(t),i=1-r,s=e.x,o=e.y,a=e.z,l=i*s,c=i*o;return this.set(l*s+r,l*o-n*a,l*a+n*o,0,l*o+n*a,c*o+r,c*a-n*s,0,l*a-n*o,c*a+n*s,i*a*a+r,0,0,0,0,1),this}makeScale(e,t,r){return this.set(e,0,0,0,0,t,0,0,0,0,r,0,0,0,0,1),this}makeShear(e,t,r,n,i,s){return this.set(1,r,i,0,e,1,s,0,t,n,1,0,0,0,0,1),this}compose(e,t,r){const n=this.elements,i=t._x,s=t._y,o=t._z,a=t._w,l=i+i,c=s+s,u=o+o,h=i*l,d=i*c,p=i*u,f=s*c,m=s*u,g=o*u,y=a*l,v=a*c,_=a*u,x=r.x,b=r.y,w=r.z;return n[0]=(1-(f+g))*x,n[1]=(d+_)*x,n[2]=(p-v)*x,n[3]=0,n[4]=(d-_)*b,n[5]=(1-(h+g))*b,n[6]=(m+y)*b,n[7]=0,n[8]=(p+v)*w,n[9]=(m-y)*w,n[10]=(1-(h+f))*w,n[11]=0,n[12]=e.x,n[13]=e.y,n[14]=e.z,n[15]=1,this}decompose(e,t,r){const n=this.elements;let i=Qr.set(n[0],n[1],n[2]).length();const s=Qr.set(n[4],n[5],n[6]).length(),o=Qr.set(n[8],n[9],n[10]).length();this.determinant()<0&&(i=-i),e.x=n[12],e.y=n[13],e.z=n[14],$r.copy(this);const a=1/i,l=1/s,c=1/o;return $r.elements[0]*=a,$r.elements[1]*=a,$r.elements[2]*=a,$r.elements[4]*=l,$r.elements[5]*=l,$r.elements[6]*=l,$r.elements[8]*=c,$r.elements[9]*=c,$r.elements[10]*=c,t.setFromRotationMatrix($r),r.x=i,r.y=s,r.z=o,this}makePerspective(e,t,r,n,i,s){const o=this.elements,a=2*i/(t-e),l=2*i/(r-n),c=(t+e)/(t-e),u=(r+n)/(r-n),h=-(s+i)/(s-i),d=-2*s*i/(s-i);return o[0]=a,o[4]=0,o[8]=c,o[12]=0,o[1]=0,o[5]=l,o[9]=u,o[13]=0,o[2]=0,o[6]=0,o[10]=h,o[14]=d,o[3]=0,o[7]=0,o[11]=-1,o[15]=0,this}makeOrthographic(e,t,r,n,i,s){const o=this.elements,a=1/(t-e),l=1/(r-n),c=1/(s-i),u=(t+e)*a,h=(r+n)*l,d=(s+i)*c;return o[0]=2*a,o[4]=0,o[8]=0,o[12]=-u,o[1]=0,o[5]=2*l,o[9]=0,o[13]=-h,o[2]=0,o[6]=0,o[10]=-2*c,o[14]=-d,o[3]=0,o[7]=0,o[11]=0,o[15]=1,this}equals(e){const t=this.elements,r=e.elements;for(let e=0;e<16;e++)if(t[e]!==r[e])return!1;return!0}fromArray(e,t=0){for(let r=0;r<16;r++)this.elements[r]=e[r+t];return this}toArray(e=[],t=0){const r=this.elements;return e[t]=r[0],e[t+1]=r[1],e[t+2]=r[2],e[t+3]=r[3],e[t+4]=r[4],e[t+5]=r[5],e[t+6]=r[6],e[t+7]=r[7],e[t+8]=r[8],e[t+9]=r[9],e[t+10]=r[10],e[t+11]=r[11],e[t+12]=r[12],e[t+13]=r[13],e[t+14]=r[14],e[t+15]=r[15],e}}const Qr=new nr,$r=new Kr,en=new nr(0,0,0),tn=new nr(1,1,1),rn=new nr,nn=new nr,sn=new nr,on=new Kr,an=new rr;class ln{constructor(e=0,t=0,r=0,n=ln.DEFAULT_ORDER){this.isEuler=!0,this._x=e,this._y=t,this._z=r,this._order=n}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get order(){return this._order}set order(e){this._order=e,this._onChangeCallback()}set(e,t,r,n=this._order){return this._x=e,this._y=t,this._z=r,this._order=n,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._order)}copy(e){return this._x=e._x,this._y=e._y,this._z=e._z,this._order=e._order,this._onChangeCallback(),this}setFromRotationMatrix(e,t=this._order,r=!0){const n=e.elements,i=n[0],s=n[4],o=n[8],a=n[1],l=n[5],c=n[9],u=n[2],h=n[6],d=n[10];switch(t){case"XYZ":this._y=Math.asin(Gt(o,-1,1)),Math.abs(o)<.9999999?(this._x=Math.atan2(-c,d),this._z=Math.atan2(-s,i)):(this._x=Math.atan2(h,l),this._z=0);break;case"YXZ":this._x=Math.asin(-Gt(c,-1,1)),Math.abs(c)<.9999999?(this._y=Math.atan2(o,d),this._z=Math.atan2(a,l)):(this._y=Math.atan2(-u,i),this._z=0);break;case"ZXY":this._x=Math.asin(Gt(h,-1,1)),Math.abs(h)<.9999999?(this._y=Math.atan2(-u,d),this._z=Math.atan2(-s,l)):(this._y=0,this._z=Math.atan2(a,i));break;case"ZYX":this._y=Math.asin(-Gt(u,-1,1)),Math.abs(u)<.9999999?(this._x=Math.atan2(h,d),this._z=Math.atan2(a,i)):(this._x=0,this._z=Math.atan2(-s,l));break;case"YZX":this._z=Math.asin(Gt(a,-1,1)),Math.abs(a)<.9999999?(this._x=Math.atan2(-c,l),this._y=Math.atan2(-u,i)):(this._x=0,this._y=Math.atan2(o,d));break;case"XZY":this._z=Math.asin(-Gt(s,-1,1)),Math.abs(s)<.9999999?(this._x=Math.atan2(h,l),this._y=Math.atan2(o,i)):(this._x=Math.atan2(-c,d),this._y=0)}return this._order=t,!0===r&&this._onChangeCallback(),this}setFromQuaternion(e,t,r){return on.makeRotationFromQuaternion(e),this.setFromRotationMatrix(on,t,r)}setFromVector3(e,t=this._order){return this.set(e.x,e.y,e.z,t)}reorder(e){return an.setFromEuler(this),this.setFromQuaternion(an,e)}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._order===this._order}fromArray(e){return this._x=e[0],this._y=e[1],this._z=e[2],void 0!==e[3]&&(this._order=e[3]),this._onChangeCallback(),this}toArray(e=[],t=0){return e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._order,e}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._order}}ln.DEFAULT_ORDER="XYZ";class cn{constructor(){this.mask=1}set(e){this.mask=(1<<e|0)>>>0}enable(e){this.mask|=1<<e|0}enableAll(){this.mask=-1}toggle(e){this.mask^=1<<e|0}disable(e){this.mask&=~(1<<e|0)}disableAll(){this.mask=0}test(e){return 0!=(this.mask&e.mask)}isEnabled(e){return 0!=(this.mask&(1<<e|0))}}let un=0;const hn=new nr,dn=new rr,pn=new Kr,fn=new nr,mn=new nr,gn=new nr,yn=new rr,vn=new nr(1,0,0),_n=new nr(0,1,0),xn=new nr(0,0,1),bn={type:"added"},wn={type:"removed"};class Sn extends Nt{constructor(){super(),this.isObject3D=!0,Object.defineProperty(this,"id",{value:un++}),this.uuid=zt(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=Sn.DEFAULT_UP.clone();const e=new nr,t=new ln,r=new rr,n=new nr(1,1,1);t._onChange((function(){r.setFromEuler(t,!1)})),r._onChange((function(){t.setFromQuaternion(r,void 0,!1)})),Object.defineProperties(this,{position:{configurable:!0,enumerable:!0,value:e},rotation:{configurable:!0,enumerable:!0,value:t},quaternion:{configurable:!0,enumerable:!0,value:r},scale:{configurable:!0,enumerable:!0,value:n},modelViewMatrix:{value:new Kr},normalMatrix:{value:new Qt}}),this.matrix=new Kr,this.matrixWorld=new Kr,this.matrixAutoUpdate=Sn.DEFAULT_MATRIX_AUTO_UPDATE,this.matrixWorldNeedsUpdate=!1,this.matrixWorldAutoUpdate=Sn.DEFAULT_MATRIX_WORLD_AUTO_UPDATE,this.layers=new cn,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.animations=[],this.userData={}}onBeforeRender(){}onAfterRender(){}applyMatrix4(e){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(e),this.matrix.decompose(this.position,this.quaternion,this.scale)}applyQuaternion(e){return this.quaternion.premultiply(e),this}setRotationFromAxisAngle(e,t){this.quaternion.setFromAxisAngle(e,t)}setRotationFromEuler(e){this.quaternion.setFromEuler(e,!0)}setRotationFromMatrix(e){this.quaternion.setFromRotationMatrix(e)}setRotationFromQuaternion(e){this.quaternion.copy(e)}rotateOnAxis(e,t){return dn.setFromAxisAngle(e,t),this.quaternion.multiply(dn),this}rotateOnWorldAxis(e,t){return dn.setFromAxisAngle(e,t),this.quaternion.premultiply(dn),this}rotateX(e){return this.rotateOnAxis(vn,e)}rotateY(e){return this.rotateOnAxis(_n,e)}rotateZ(e){return this.rotateOnAxis(xn,e)}translateOnAxis(e,t){return hn.copy(e).applyQuaternion(this.quaternion),this.position.add(hn.multiplyScalar(t)),this}translateX(e){return this.translateOnAxis(vn,e)}translateY(e){return this.translateOnAxis(_n,e)}translateZ(e){return this.translateOnAxis(xn,e)}localToWorld(e){return this.updateWorldMatrix(!0,!1),e.applyMatrix4(this.matrixWorld)}worldToLocal(e){return this.updateWorldMatrix(!0,!1),e.applyMatrix4(pn.copy(this.matrixWorld).invert())}lookAt(e,t,r){e.isVector3?fn.copy(e):fn.set(e,t,r);const n=this.parent;this.updateWorldMatrix(!0,!1),mn.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?pn.lookAt(mn,fn,this.up):pn.lookAt(fn,mn,this.up),this.quaternion.setFromRotationMatrix(pn),n&&(pn.extractRotation(n.matrixWorld),dn.setFromRotationMatrix(pn),this.quaternion.premultiply(dn.invert()))}add(e){if(arguments.length>1){for(let e=0;e<arguments.length;e++)this.add(arguments[e]);return this}return e===this||e&&e.isObject3D&&(null!==e.parent&&e.parent.remove(e),e.parent=this,this.children.push(e),e.dispatchEvent(bn)),this}remove(e){if(arguments.length>1){for(let e=0;e<arguments.length;e++)this.remove(arguments[e]);return this}const t=this.children.indexOf(e);return-1!==t&&(e.parent=null,this.children.splice(t,1),e.dispatchEvent(wn)),this}removeFromParent(){const e=this.parent;return null!==e&&e.remove(this),this}clear(){for(let e=0;e<this.children.length;e++){const t=this.children[e];t.parent=null,t.dispatchEvent(wn)}return this.children.length=0,this}attach(e){return this.updateWorldMatrix(!0,!1),pn.copy(this.matrixWorld).invert(),null!==e.parent&&(e.parent.updateWorldMatrix(!0,!1),pn.multiply(e.parent.matrixWorld)),e.applyMatrix4(pn),this.add(e),e.updateWorldMatrix(!1,!0),this}getObjectById(e){return this.getObjectByProperty("id",e)}getObjectByName(e){return this.getObjectByProperty("name",e)}getObjectByProperty(e,t){if(this[e]===t)return this;for(let r=0,n=this.children.length;r<n;r++){const n=this.children[r].getObjectByProperty(e,t);if(void 0!==n)return n}}getObjectsByProperty(e,t){let r=[];this[e]===t&&r.push(this);for(let n=0,i=this.children.length;n<i;n++){const i=this.children[n].getObjectsByProperty(e,t);i.length>0&&(r=r.concat(i))}return r}getWorldPosition(e){return this.updateWorldMatrix(!0,!1),e.setFromMatrixPosition(this.matrixWorld)}getWorldQuaternion(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(mn,e,gn),e}getWorldScale(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(mn,yn,e),e}getWorldDirection(e){this.updateWorldMatrix(!0,!1);const t=this.matrixWorld.elements;return e.set(t[8],t[9],t[10]).normalize()}raycast(){}traverse(e){e(this);const t=this.children;for(let r=0,n=t.length;r<n;r++)t[r].traverse(e)}traverseVisible(e){if(!1===this.visible)return;e(this);const t=this.children;for(let r=0,n=t.length;r<n;r++)t[r].traverseVisible(e)}traverseAncestors(e){const t=this.parent;null!==t&&(e(t),t.traverseAncestors(e))}updateMatrix(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0}updateMatrixWorld(e){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||e)&&(null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),this.matrixWorldNeedsUpdate=!1,e=!0);const t=this.children;for(let r=0,n=t.length;r<n;r++){const n=t[r];!0!==n.matrixWorldAutoUpdate&&!0!==e||n.updateMatrixWorld(e)}}updateWorldMatrix(e,t){const r=this.parent;if(!0===e&&null!==r&&!0===r.matrixWorldAutoUpdate&&r.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),!0===t){const e=this.children;for(let t=0,r=e.length;t<r;t++){const r=e[t];!0===r.matrixWorldAutoUpdate&&r.updateWorldMatrix(!1,!0)}}}toJSON(e){const t=void 0===e||"string"==typeof e,r={};t&&(e={geometries:{},materials:{},textures:{},images:{},shapes:{},skeletons:{},animations:{},nodes:{}},r.metadata={version:4.5,type:"Object",generator:"Object3D.toJSON"});const n={};function i(t,r){return void 0===t[r.uuid]&&(t[r.uuid]=r.toJSON(e)),r.uuid}if(n.uuid=this.uuid,n.type=this.type,""!==this.name&&(n.name=this.name),!0===this.castShadow&&(n.castShadow=!0),!0===this.receiveShadow&&(n.receiveShadow=!0),!1===this.visible&&(n.visible=!1),!1===this.frustumCulled&&(n.frustumCulled=!1),0!==this.renderOrder&&(n.renderOrder=this.renderOrder),Object.keys(this.userData).length>0&&(n.userData=this.userData),n.layers=this.layers.mask,n.matrix=this.matrix.toArray(),!1===this.matrixAutoUpdate&&(n.matrixAutoUpdate=!1),this.isInstancedMesh&&(n.type="InstancedMesh",n.count=this.count,n.instanceMatrix=this.instanceMatrix.toJSON(),null!==this.instanceColor&&(n.instanceColor=this.instanceColor.toJSON())),this.isScene)this.background&&(this.background.isColor?n.background=this.background.toJSON():this.background.isTexture&&(n.background=this.background.toJSON(e).uuid)),this.environment&&this.environment.isTexture&&!0!==this.environment.isRenderTargetTexture&&(n.environment=this.environment.toJSON(e).uuid);else if(this.isMesh||this.isLine||this.isPoints){n.geometry=i(e.geometries,this.geometry);const t=this.geometry.parameters;if(void 0!==t&&void 0!==t.shapes){const r=t.shapes;if(Array.isArray(r))for(let t=0,n=r.length;t<n;t++){const n=r[t];i(e.shapes,n)}else i(e.shapes,r)}}if(this.isSkinnedMesh&&(n.bindMode=this.bindMode,n.bindMatrix=this.bindMatrix.toArray(),void 0!==this.skeleton&&(i(e.skeletons,this.skeleton),n.skeleton=this.skeleton.uuid)),void 0!==this.material)if(Array.isArray(this.material)){const t=[];for(let r=0,n=this.material.length;r<n;r++)t.push(i(e.materials,this.material[r]));n.material=t}else n.material=i(e.materials,this.material);if(this.children.length>0){n.children=[];for(let t=0;t<this.children.length;t++)n.children.push(this.children[t].toJSON(e).object)}if(this.animations.length>0){n.animations=[];for(let t=0;t<this.animations.length;t++){const r=this.animations[t];n.animations.push(i(e.animations,r))}}if(t){const t=s(e.geometries),n=s(e.materials),i=s(e.textures),o=s(e.images),a=s(e.shapes),l=s(e.skeletons),c=s(e.animations),u=s(e.nodes);t.length>0&&(r.geometries=t),n.length>0&&(r.materials=n),i.length>0&&(r.textures=i),o.length>0&&(r.images=o),a.length>0&&(r.shapes=a),l.length>0&&(r.skeletons=l),c.length>0&&(r.animations=c),u.length>0&&(r.nodes=u)}return r.object=n,r;function s(e){const t=[];for(const r in e){const n=e[r];delete n.metadata,t.push(n)}return t}}clone(e){return(new this.constructor).copy(this,e)}copy(e,t=!0){if(this.name=e.name,this.up.copy(e.up),this.position.copy(e.position),this.rotation.order=e.rotation.order,this.quaternion.copy(e.quaternion),this.scale.copy(e.scale),this.matrix.copy(e.matrix),this.matrixWorld.copy(e.matrixWorld),this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrixWorldNeedsUpdate=e.matrixWorldNeedsUpdate,this.matrixWorldAutoUpdate=e.matrixWorldAutoUpdate,this.layers.mask=e.layers.mask,this.visible=e.visible,this.castShadow=e.castShadow,this.receiveShadow=e.receiveShadow,this.frustumCulled=e.frustumCulled,this.renderOrder=e.renderOrder,this.userData=JSON.parse(JSON.stringify(e.userData)),!0===t)for(let t=0;t<e.children.length;t++){const r=e.children[t];this.add(r.clone())}return this}}Sn.DEFAULT_UP=new nr(0,1,0),Sn.DEFAULT_MATRIX_AUTO_UPDATE=!0,Sn.DEFAULT_MATRIX_WORLD_AUTO_UPDATE=!0;const Mn=new nr,Tn=new nr,En=new nr,An=new nr,Cn=new nr,Ln=new nr,Rn=new nr,Pn=new nr,jn=new nr,In=new nr;class Dn{constructor(e=new nr,t=new nr,r=new nr){this.a=e,this.b=t,this.c=r}static getNormal(e,t,r,n){n.subVectors(r,t),Mn.subVectors(e,t),n.cross(Mn);const i=n.lengthSq();return i>0?n.multiplyScalar(1/Math.sqrt(i)):n.set(0,0,0)}static getBarycoord(e,t,r,n,i){Mn.subVectors(n,t),Tn.subVectors(r,t),En.subVectors(e,t);const s=Mn.dot(Mn),o=Mn.dot(Tn),a=Mn.dot(En),l=Tn.dot(Tn),c=Tn.dot(En),u=s*l-o*o;if(0===u)return i.set(-2,-1,-1);const h=1/u,d=(l*a-o*c)*h,p=(s*c-o*a)*h;return i.set(1-d-p,p,d)}static containsPoint(e,t,r,n){return this.getBarycoord(e,t,r,n,An),An.x>=0&&An.y>=0&&An.x+An.y<=1}static getUV(e,t,r,n,i,s,o,a){return this.getBarycoord(e,t,r,n,An),a.set(0,0),a.addScaledVector(i,An.x),a.addScaledVector(s,An.y),a.addScaledVector(o,An.z),a}static isFrontFacing(e,t,r,n){return Mn.subVectors(r,t),Tn.subVectors(e,t),Mn.cross(Tn).dot(n)<0}set(e,t,r){return this.a.copy(e),this.b.copy(t),this.c.copy(r),this}setFromPointsAndIndices(e,t,r,n){return this.a.copy(e[t]),this.b.copy(e[r]),this.c.copy(e[n]),this}setFromAttributeAndIndices(e,t,r,n){return this.a.fromBufferAttribute(e,t),this.b.fromBufferAttribute(e,r),this.c.fromBufferAttribute(e,n),this}clone(){return(new this.constructor).copy(this)}copy(e){return this.a.copy(e.a),this.b.copy(e.b),this.c.copy(e.c),this}getArea(){return Mn.subVectors(this.c,this.b),Tn.subVectors(this.a,this.b),.5*Mn.cross(Tn).length()}getMidpoint(e){return e.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)}getNormal(e){return Dn.getNormal(this.a,this.b,this.c,e)}getPlane(e){return e.setFromCoplanarPoints(this.a,this.b,this.c)}getBarycoord(e,t){return Dn.getBarycoord(e,this.a,this.b,this.c,t)}getUV(e,t,r,n,i){return Dn.getUV(e,this.a,this.b,this.c,t,r,n,i)}containsPoint(e){return Dn.containsPoint(e,this.a,this.b,this.c)}isFrontFacing(e){return Dn.isFrontFacing(this.a,this.b,this.c,e)}intersectsBox(e){return e.intersectsTriangle(this)}closestPointToPoint(e,t){const r=this.a,n=this.b,i=this.c;let s,o;Cn.subVectors(n,r),Ln.subVectors(i,r),Pn.subVectors(e,r);const a=Cn.dot(Pn),l=Ln.dot(Pn);if(a<=0&&l<=0)return t.copy(r);jn.subVectors(e,n);const c=Cn.dot(jn),u=Ln.dot(jn);if(c>=0&&u<=c)return t.copy(n);const h=a*u-c*l;if(h<=0&&a>=0&&c<=0)return s=a/(a-c),t.copy(r).addScaledVector(Cn,s);In.subVectors(e,i);const d=Cn.dot(In),p=Ln.dot(In);if(p>=0&&d<=p)return t.copy(i);const f=d*l-a*p;if(f<=0&&l>=0&&p<=0)return o=l/(l-p),t.copy(r).addScaledVector(Ln,o);const m=c*p-d*u;if(m<=0&&u-c>=0&&d-p>=0)return Rn.subVectors(i,n),o=(u-c)/(u-c+(d-p)),t.copy(n).addScaledVector(Rn,o);const g=1/(m+f+h);return s=f*g,o=h*g,t.copy(r).addScaledVector(Cn,s).addScaledVector(Ln,o)}equals(e){return e.a.equals(this.a)&&e.b.equals(this.b)&&e.c.equals(this.c)}}let On=0;class Nn extends Nt{constructor(){super(),this.isMaterial=!0,Object.defineProperty(this,"id",{value:On++}),this.uuid=zt(),this.name="",this.type="Material",this.blending=g,this.side=d,this.vertexColors=!1,this.opacity=1,this.transparent=!1,this.blendSrc=R,this.blendDst=P,this.blendEquation=b,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.depthFunc=B,this.depthTest=!0,this.depthWrite=!0,this.stencilWriteMask=255,this.stencilFunc=519,this.stencilRef=0,this.stencilFuncMask=255,this.stencilFail=jt,this.stencilZFail=jt,this.stencilZPass=jt,this.stencilWrite=!1,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.shadowSide=null,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.dithering=!1,this.alphaToCoverage=!1,this.premultipliedAlpha=!1,this.forceSinglePass=!1,this.visible=!0,this.toneMapped=!0,this.userData={},this.version=0,this._alphaTest=0}get alphaTest(){return this._alphaTest}set alphaTest(e){this._alphaTest>0!=e>0&&this.version++,this._alphaTest=e}onBuild(){}onBeforeRender(){}onBeforeCompile(){}customProgramCacheKey(){return this.onBeforeCompile.toString()}setValues(e){if(void 0!==e)for(const t in e){const r=e[t];if(void 0===r)continue;const n=this[t];void 0!==n&&(n&&n.isColor?n.set(r):n&&n.isVector3&&r&&r.isVector3?n.copy(r):this[t]=r)}}toJSON(e){const t=void 0===e||"string"==typeof e;t&&(e={textures:{},images:{}});const r={metadata:{version:4.5,type:"Material",generator:"Material.toJSON"}};function n(e){const t=[];for(const r in e){const n=e[r];delete n.metadata,t.push(n)}return t}if(r.uuid=this.uuid,r.type=this.type,""!==this.name&&(r.name=this.name),this.color&&this.color.isColor&&(r.color=this.color.getHex()),void 0!==this.roughness&&(r.roughness=this.roughness),void 0!==this.metalness&&(r.metalness=this.metalness),void 0!==this.sheen&&(r.sheen=this.sheen),this.sheenColor&&this.sheenColor.isColor&&(r.sheenColor=this.sheenColor.getHex()),void 0!==this.sheenRoughness&&(r.sheenRoughness=this.sheenRoughness),this.emissive&&this.emissive.isColor&&(r.emissive=this.emissive.getHex()),this.emissiveIntensity&&1!==this.emissiveIntensity&&(r.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(r.specular=this.specular.getHex()),void 0!==this.specularIntensity&&(r.specularIntensity=this.specularIntensity),this.specularColor&&this.specularColor.isColor&&(r.specularColor=this.specularColor.getHex()),void 0!==this.shininess&&(r.shininess=this.shininess),void 0!==this.clearcoat&&(r.clearcoat=this.clearcoat),void 0!==this.clearcoatRoughness&&(r.clearcoatRoughness=this.clearcoatRoughness),this.clearcoatMap&&this.clearcoatMap.isTexture&&(r.clearcoatMap=this.clearcoatMap.toJSON(e).uuid),this.clearcoatRoughnessMap&&this.clearcoatRoughnessMap.isTexture&&(r.clearcoatRoughnessMap=this.clearcoatRoughnessMap.toJSON(e).uuid),this.clearcoatNormalMap&&this.clearcoatNormalMap.isTexture&&(r.clearcoatNormalMap=this.clearcoatNormalMap.toJSON(e).uuid,r.clearcoatNormalScale=this.clearcoatNormalScale.toArray()),void 0!==this.iridescence&&(r.iridescence=this.iridescence),void 0!==this.iridescenceIOR&&(r.iridescenceIOR=this.iridescenceIOR),void 0!==this.iridescenceThicknessRange&&(r.iridescenceThicknessRange=this.iridescenceThicknessRange),this.iridescenceMap&&this.iridescenceMap.isTexture&&(r.iridescenceMap=this.iridescenceMap.toJSON(e).uuid),this.iridescenceThicknessMap&&this.iridescenceThicknessMap.isTexture&&(r.iridescenceThicknessMap=this.iridescenceThicknessMap.toJSON(e).uuid),this.map&&this.map.isTexture&&(r.map=this.map.toJSON(e).uuid),this.matcap&&this.matcap.isTexture&&(r.matcap=this.matcap.toJSON(e).uuid),this.alphaMap&&this.alphaMap.isTexture&&(r.alphaMap=this.alphaMap.toJSON(e).uuid),this.lightMap&&this.lightMap.isTexture&&(r.lightMap=this.lightMap.toJSON(e).uuid,r.lightMapIntensity=this.lightMapIntensity),this.aoMap&&this.aoMap.isTexture&&(r.aoMap=this.aoMap.toJSON(e).uuid,r.aoMapIntensity=this.aoMapIntensity),this.bumpMap&&this.bumpMap.isTexture&&(r.bumpMap=this.bumpMap.toJSON(e).uuid,r.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(r.normalMap=this.normalMap.toJSON(e).uuid,r.normalMapType=this.normalMapType,r.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(r.displacementMap=this.displacementMap.toJSON(e).uuid,r.displacementScale=this.displacementScale,r.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(r.roughnessMap=this.roughnessMap.toJSON(e).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(r.metalnessMap=this.metalnessMap.toJSON(e).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(r.emissiveMap=this.emissiveMap.toJSON(e).uuid),this.specularMap&&this.specularMap.isTexture&&(r.specularMap=this.specularMap.toJSON(e).uuid),this.specularIntensityMap&&this.specularIntensityMap.isTexture&&(r.specularIntensityMap=this.specularIntensityMap.toJSON(e).uuid),this.specularColorMap&&this.specularColorMap.isTexture&&(r.specularColorMap=this.specularColorMap.toJSON(e).uuid),this.envMap&&this.envMap.isTexture&&(r.envMap=this.envMap.toJSON(e).uuid,void 0!==this.combine&&(r.combine=this.combine)),void 0!==this.envMapIntensity&&(r.envMapIntensity=this.envMapIntensity),void 0!==this.reflectivity&&(r.reflectivity=this.reflectivity),void 0!==this.refractionRatio&&(r.refractionRatio=this.refractionRatio),this.gradientMap&&this.gradientMap.isTexture&&(r.gradientMap=this.gradientMap.toJSON(e).uuid),void 0!==this.transmission&&(r.transmission=this.transmission),this.transmissionMap&&this.transmissionMap.isTexture&&(r.transmissionMap=this.transmissionMap.toJSON(e).uuid),void 0!==this.thickness&&(r.thickness=this.thickness),this.thicknessMap&&this.thicknessMap.isTexture&&(r.thicknessMap=this.thicknessMap.toJSON(e).uuid),void 0!==this.attenuationDistance&&this.attenuationDistance!==1/0&&(r.attenuationDistance=this.attenuationDistance),void 0!==this.attenuationColor&&(r.attenuationColor=this.attenuationColor.getHex()),void 0!==this.size&&(r.size=this.size),null!==this.shadowSide&&(r.shadowSide=this.shadowSide),void 0!==this.sizeAttenuation&&(r.sizeAttenuation=this.sizeAttenuation),this.blending!==g&&(r.blending=this.blending),this.side!==d&&(r.side=this.side),this.vertexColors&&(r.vertexColors=!0),this.opacity<1&&(r.opacity=this.opacity),!0===this.transparent&&(r.transparent=this.transparent),r.depthFunc=this.depthFunc,r.depthTest=this.depthTest,r.depthWrite=this.depthWrite,r.colorWrite=this.colorWrite,r.stencilWrite=this.stencilWrite,r.stencilWriteMask=this.stencilWriteMask,r.stencilFunc=this.stencilFunc,r.stencilRef=this.stencilRef,r.stencilFuncMask=this.stencilFuncMask,r.stencilFail=this.stencilFail,r.stencilZFail=this.stencilZFail,r.stencilZPass=this.stencilZPass,void 0!==this.rotation&&0!==this.rotation&&(r.rotation=this.rotation),!0===this.polygonOffset&&(r.polygonOffset=!0),0!==this.polygonOffsetFactor&&(r.polygonOffsetFactor=this.polygonOffsetFactor),0!==this.polygonOffsetUnits&&(r.polygonOffsetUnits=this.polygonOffsetUnits),void 0!==this.linewidth&&1!==this.linewidth&&(r.linewidth=this.linewidth),void 0!==this.dashSize&&(r.dashSize=this.dashSize),void 0!==this.gapSize&&(r.gapSize=this.gapSize),void 0!==this.scale&&(r.scale=this.scale),!0===this.dithering&&(r.dithering=!0),this.alphaTest>0&&(r.alphaTest=this.alphaTest),!0===this.alphaToCoverage&&(r.alphaToCoverage=this.alphaToCoverage),!0===this.premultipliedAlpha&&(r.premultipliedAlpha=this.premultipliedAlpha),!0===this.forceSinglePass&&(r.forceSinglePass=this.forceSinglePass),!0===this.wireframe&&(r.wireframe=this.wireframe),this.wireframeLinewidth>1&&(r.wireframeLinewidth=this.wireframeLinewidth),"round"!==this.wireframeLinecap&&(r.wireframeLinecap=this.wireframeLinecap),"round"!==this.wireframeLinejoin&&(r.wireframeLinejoin=this.wireframeLinejoin),!0===this.flatShading&&(r.flatShading=this.flatShading),!1===this.visible&&(r.visible=!1),!1===this.toneMapped&&(r.toneMapped=!1),!1===this.fog&&(r.fog=!1),Object.keys(this.userData).length>0&&(r.userData=this.userData),t){const t=n(e.textures),i=n(e.images);t.length>0&&(r.textures=t),i.length>0&&(r.images=i)}return r}clone(){return(new this.constructor).copy(this)}copy(e){this.name=e.name,this.blending=e.blending,this.side=e.side,this.vertexColors=e.vertexColors,this.opacity=e.opacity,this.transparent=e.transparent,this.blendSrc=e.blendSrc,this.blendDst=e.blendDst,this.blendEquation=e.blendEquation,this.blendSrcAlpha=e.blendSrcAlpha,this.blendDstAlpha=e.blendDstAlpha,this.blendEquationAlpha=e.blendEquationAlpha,this.depthFunc=e.depthFunc,this.depthTest=e.depthTest,this.depthWrite=e.depthWrite,this.stencilWriteMask=e.stencilWriteMask,this.stencilFunc=e.stencilFunc,this.stencilRef=e.stencilRef,this.stencilFuncMask=e.stencilFuncMask,this.stencilFail=e.stencilFail,this.stencilZFail=e.stencilZFail,this.stencilZPass=e.stencilZPass,this.stencilWrite=e.stencilWrite;const t=e.clippingPlanes;let r=null;if(null!==t){const e=t.length;r=new Array(e);for(let n=0;n!==e;++n)r[n]=t[n].clone()}return this.clippingPlanes=r,this.clipIntersection=e.clipIntersection,this.clipShadows=e.clipShadows,this.shadowSide=e.shadowSide,this.colorWrite=e.colorWrite,this.precision=e.precision,this.polygonOffset=e.polygonOffset,this.polygonOffsetFactor=e.polygonOffsetFactor,this.polygonOffsetUnits=e.polygonOffsetUnits,this.dithering=e.dithering,this.alphaTest=e.alphaTest,this.alphaToCoverage=e.alphaToCoverage,this.premultipliedAlpha=e.premultipliedAlpha,this.forceSinglePass=e.forceSinglePass,this.visible=e.visible,this.toneMapped=e.toneMapped,this.userData=JSON.parse(JSON.stringify(e.userData)),this}dispose(){this.dispatchEvent({type:"dispose"})}set needsUpdate(e){!0===e&&this.version++}}const Un={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},kn={h:0,s:0,l:0},Fn={h:0,s:0,l:0};function Bn(e,t,r){return r<0&&(r+=1),r>1&&(r-=1),r<1/6?e+6*(t-e)*r:r<.5?t:r<2/3?e+6*(t-e)*(2/3-r):e}class zn{constructor(e,t,r){return this.isColor=!0,this.r=1,this.g=1,this.b=1,void 0===t&&void 0===r?this.set(e):this.setRGB(e,t,r)}set(e){return e&&e.isColor?this.copy(e):"number"==typeof e?this.setHex(e):"string"==typeof e&&this.setStyle(e),this}setScalar(e){return this.r=e,this.g=e,this.b=e,this}setHex(e,t=Lt){return e=Math.floor(e),this.r=(e>>16&255)/255,this.g=(e>>8&255)/255,this.b=(255&e)/255,pr.toWorkingColorSpace(this,t),this}setRGB(e,t,r,n=pr.workingColorSpace){return this.r=e,this.g=t,this.b=r,pr.toWorkingColorSpace(this,n),this}setHSL(e,t,r,n=pr.workingColorSpace){if(e=Vt(e,1),t=Gt(t,0,1),r=Gt(r,0,1),0===t)this.r=this.g=this.b=r;else{const n=r<=.5?r*(1+t):r+t-r*t,i=2*r-n;this.r=Bn(i,n,e+1/3),this.g=Bn(i,n,e),this.b=Bn(i,n,e-1/3)}return pr.toWorkingColorSpace(this,n),this}setStyle(e,t=Lt){function r(e){void 0!==e&&parseFloat(e)}let n;if(n=/^(\w+)\(([^\)]*)\)/.exec(e)){let e;const i=n[1],s=n[2];switch(i){case"rgb":case"rgba":if(e=/^\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(s))return this.r=Math.min(255,parseInt(e[1],10))/255,this.g=Math.min(255,parseInt(e[2],10))/255,this.b=Math.min(255,parseInt(e[3],10))/255,pr.toWorkingColorSpace(this,t),r(e[4]),this;if(e=/^\s*(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(s))return this.r=Math.min(100,parseInt(e[1],10))/100,this.g=Math.min(100,parseInt(e[2],10))/100,this.b=Math.min(100,parseInt(e[3],10))/100,pr.toWorkingColorSpace(this,t),r(e[4]),this;break;case"hsl":case"hsla":if(e=/^\s*(\d*\.?\d+)\s*,\s*(\d*\.?\d+)\%\s*,\s*(\d*\.?\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(s)){const n=parseFloat(e[1])/360,i=parseFloat(e[2])/100,s=parseFloat(e[3])/100;return r(e[4]),this.setHSL(n,i,s,t)}}}else if(n=/^\#([A-Fa-f\d]+)$/.exec(e)){const e=n[1],r=e.length;if(3===r)return this.r=parseInt(e.charAt(0)+e.charAt(0),16)/255,this.g=parseInt(e.charAt(1)+e.charAt(1),16)/255,this.b=parseInt(e.charAt(2)+e.charAt(2),16)/255,pr.toWorkingColorSpace(this,t),this;if(6===r)return this.r=parseInt(e.charAt(0)+e.charAt(1),16)/255,this.g=parseInt(e.charAt(2)+e.charAt(3),16)/255,this.b=parseInt(e.charAt(4)+e.charAt(5),16)/255,pr.toWorkingColorSpace(this,t),this}else if(e&&e.length>0)return this.setColorName(e,t);return this}setColorName(e,t=Lt){const r=Un[e.toLowerCase()];return void 0!==r&&this.setHex(r,t),this}clone(){return new this.constructor(this.r,this.g,this.b)}copy(e){return this.r=e.r,this.g=e.g,this.b=e.b,this}copySRGBToLinear(e){return this.r=or(e.r),this.g=or(e.g),this.b=or(e.b),this}copyLinearToSRGB(e){return this.r=ar(e.r),this.g=ar(e.g),this.b=ar(e.b),this}convertSRGBToLinear(){return this.copySRGBToLinear(this),this}convertLinearToSRGB(){return this.copyLinearToSRGB(this),this}getHex(e=Lt){return pr.fromWorkingColorSpace(Gn.copy(this),e),Gt(255*Gn.r,0,255)<<16^Gt(255*Gn.g,0,255)<<8^Gt(255*Gn.b,0,255)<<0}getHexString(e=Lt){return("000000"+this.getHex(e).toString(16)).slice(-6)}getHSL(e,t=pr.workingColorSpace){pr.fromWorkingColorSpace(Gn.copy(this),t);const r=Gn.r,n=Gn.g,i=Gn.b,s=Math.max(r,n,i),o=Math.min(r,n,i);let a,l;const c=(o+s)/2;if(o===s)a=0,l=0;else{const e=s-o;switch(l=c<=.5?e/(s+o):e/(2-s-o),s){case r:a=(n-i)/e+(n<i?6:0);break;case n:a=(i-r)/e+2;break;case i:a=(r-n)/e+4}a/=6}return e.h=a,e.s=l,e.l=c,e}getRGB(e,t=pr.workingColorSpace){return pr.fromWorkingColorSpace(Gn.copy(this),t),e.r=Gn.r,e.g=Gn.g,e.b=Gn.b,e}getStyle(e=Lt){pr.fromWorkingColorSpace(Gn.copy(this),e);const t=Gn.r,r=Gn.g,n=Gn.b;return e!==Lt?`color(${e} ${t.toFixed(3)} ${r.toFixed(3)} ${n.toFixed(3)})`:`rgb(${255*t|0},${255*r|0},${255*n|0})`}offsetHSL(e,t,r){return this.getHSL(kn),kn.h+=e,kn.s+=t,kn.l+=r,this.setHSL(kn.h,kn.s,kn.l),this}add(e){return this.r+=e.r,this.g+=e.g,this.b+=e.b,this}addColors(e,t){return this.r=e.r+t.r,this.g=e.g+t.g,this.b=e.b+t.b,this}addScalar(e){return this.r+=e,this.g+=e,this.b+=e,this}sub(e){return this.r=Math.max(0,this.r-e.r),this.g=Math.max(0,this.g-e.g),this.b=Math.max(0,this.b-e.b),this}multiply(e){return this.r*=e.r,this.g*=e.g,this.b*=e.b,this}multiplyScalar(e){return this.r*=e,this.g*=e,this.b*=e,this}lerp(e,t){return this.r+=(e.r-this.r)*t,this.g+=(e.g-this.g)*t,this.b+=(e.b-this.b)*t,this}lerpColors(e,t,r){return this.r=e.r+(t.r-e.r)*r,this.g=e.g+(t.g-e.g)*r,this.b=e.b+(t.b-e.b)*r,this}lerpHSL(e,t){this.getHSL(kn),e.getHSL(Fn);const r=Ht(kn.h,Fn.h,t),n=Ht(kn.s,Fn.s,t),i=Ht(kn.l,Fn.l,t);return this.setHSL(r,n,i),this}equals(e){return e.r===this.r&&e.g===this.g&&e.b===this.b}fromArray(e,t=0){return this.r=e[t],this.g=e[t+1],this.b=e[t+2],this}toArray(e=[],t=0){return e[t]=this.r,e[t+1]=this.g,e[t+2]=this.b,e}fromBufferAttribute(e,t){return this.r=e.getX(t),this.g=e.getY(t),this.b=e.getZ(t),this}toJSON(){return this.getHex()}*[Symbol.iterator](){yield this.r,yield this.g,yield this.b}}const Gn=new zn;zn.NAMES=Un;class Vn extends Nn{constructor(e){super(),this.isMeshBasicMaterial=!0,this.type="MeshBasicMaterial",this.color=new zn(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=W,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.fog=e.fog,this}}const Hn=new nr,Wn=new Kt;class Xn{constructor(e,t,r=!1){if(Array.isArray(e))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.isBufferAttribute=!0,this.name="",this.array=e,this.itemSize=t,this.count=void 0!==e?e.length/t:0,this.normalized=r,this.usage=It,this.updateRange={offset:0,count:-1},this.version=0}onUploadCallback(){}set needsUpdate(e){!0===e&&this.version++}setUsage(e){return this.usage=e,this}copy(e){return this.name=e.name,this.array=new e.array.constructor(e.array),this.itemSize=e.itemSize,this.count=e.count,this.normalized=e.normalized,this.usage=e.usage,this}copyAt(e,t,r){e*=this.itemSize,r*=t.itemSize;for(let n=0,i=this.itemSize;n<i;n++)this.array[e+n]=t.array[r+n];return this}copyArray(e){return this.array.set(e),this}applyMatrix3(e){if(2===this.itemSize)for(let t=0,r=this.count;t<r;t++)Wn.fromBufferAttribute(this,t),Wn.applyMatrix3(e),this.setXY(t,Wn.x,Wn.y);else if(3===this.itemSize)for(let t=0,r=this.count;t<r;t++)Hn.fromBufferAttribute(this,t),Hn.applyMatrix3(e),this.setXYZ(t,Hn.x,Hn.y,Hn.z);return this}applyMatrix4(e){for(let t=0,r=this.count;t<r;t++)Hn.fromBufferAttribute(this,t),Hn.applyMatrix4(e),this.setXYZ(t,Hn.x,Hn.y,Hn.z);return this}applyNormalMatrix(e){for(let t=0,r=this.count;t<r;t++)Hn.fromBufferAttribute(this,t),Hn.applyNormalMatrix(e),this.setXYZ(t,Hn.x,Hn.y,Hn.z);return this}transformDirection(e){for(let t=0,r=this.count;t<r;t++)Hn.fromBufferAttribute(this,t),Hn.transformDirection(e),this.setXYZ(t,Hn.x,Hn.y,Hn.z);return this}set(e,t=0){return this.array.set(e,t),this}getX(e){let t=this.array[e*this.itemSize];return this.normalized&&(t=Yt(t,this.array)),t}setX(e,t){return this.normalized&&(t=Zt(t,this.array)),this.array[e*this.itemSize]=t,this}getY(e){let t=this.array[e*this.itemSize+1];return this.normalized&&(t=Yt(t,this.array)),t}setY(e,t){return this.normalized&&(t=Zt(t,this.array)),this.array[e*this.itemSize+1]=t,this}getZ(e){let t=this.array[e*this.itemSize+2];return this.normalized&&(t=Yt(t,this.array)),t}setZ(e,t){return this.normalized&&(t=Zt(t,this.array)),this.array[e*this.itemSize+2]=t,this}getW(e){let t=this.array[e*this.itemSize+3];return this.normalized&&(t=Yt(t,this.array)),t}setW(e,t){return this.normalized&&(t=Zt(t,this.array)),this.array[e*this.itemSize+3]=t,this}setXY(e,t,r){return e*=this.itemSize,this.normalized&&(t=Zt(t,this.array),r=Zt(r,this.array)),this.array[e+0]=t,this.array[e+1]=r,this}setXYZ(e,t,r,n){return e*=this.itemSize,this.normalized&&(t=Zt(t,this.array),r=Zt(r,this.array),n=Zt(n,this.array)),this.array[e+0]=t,this.array[e+1]=r,this.array[e+2]=n,this}setXYZW(e,t,r,n,i){return e*=this.itemSize,this.normalized&&(t=Zt(t,this.array),r=Zt(r,this.array),n=Zt(n,this.array),i=Zt(i,this.array)),this.array[e+0]=t,this.array[e+1]=r,this.array[e+2]=n,this.array[e+3]=i,this}onUpload(e){return this.onUploadCallback=e,this}clone(){return new this.constructor(this.array,this.itemSize).copy(this)}toJSON(){const e={itemSize:this.itemSize,type:this.array.constructor.name,array:Array.from(this.array),normalized:this.normalized};return""!==this.name&&(e.name=this.name),this.usage!==It&&(e.usage=this.usage),0===this.updateRange.offset&&-1===this.updateRange.count||(e.updateRange=this.updateRange),e}copyColorsArray(){}copyVector2sArray(){}copyVector3sArray(){}copyVector4sArray(){}}class qn extends Xn{constructor(e,t,r){super(new Uint16Array(e),t,r)}}class Yn extends Xn{constructor(e,t,r){super(new Uint32Array(e),t,r)}}class Zn extends Xn{constructor(e,t,r){super(new Float32Array(e),t,r)}}let Jn=0;const Kn=new Kr,Qn=new Sn,$n=new nr,ei=new Mr,ti=new Mr,ri=new nr;class ni extends Nt{constructor(){super(),this.isBufferGeometry=!0,Object.defineProperty(this,"id",{value:Jn++}),this.uuid=zt(),this.name="",this.type="BufferGeometry",this.index=null,this.attributes={},this.morphAttributes={},this.morphTargetsRelative=!1,this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0},this.userData={}}getIndex(){return this.index}setIndex(e){return Array.isArray(e)?this.index=new(er(e)?Yn:qn)(e,1):this.index=e,this}getAttribute(e){return this.attributes[e]}setAttribute(e,t){return this.attributes[e]=t,this}deleteAttribute(e){return delete this.attributes[e],this}hasAttribute(e){return void 0!==this.attributes[e]}addGroup(e,t,r=0){this.groups.push({start:e,count:t,materialIndex:r})}clearGroups(){this.groups=[]}setDrawRange(e,t){this.drawRange.start=e,this.drawRange.count=t}applyMatrix4(e){const t=this.attributes.position;void 0!==t&&(t.applyMatrix4(e),t.needsUpdate=!0);const r=this.attributes.normal;if(void 0!==r){const t=(new Qt).getNormalMatrix(e);r.applyNormalMatrix(t),r.needsUpdate=!0}const n=this.attributes.tangent;return void 0!==n&&(n.transformDirection(e),n.needsUpdate=!0),null!==this.boundingBox&&this.computeBoundingBox(),null!==this.boundingSphere&&this.computeBoundingSphere(),this}applyQuaternion(e){return Kn.makeRotationFromQuaternion(e),this.applyMatrix4(Kn),this}rotateX(e){return Kn.makeRotationX(e),this.applyMatrix4(Kn),this}rotateY(e){return Kn.makeRotationY(e),this.applyMatrix4(Kn),this}rotateZ(e){return Kn.makeRotationZ(e),this.applyMatrix4(Kn),this}translate(e,t,r){return Kn.makeTranslation(e,t,r),this.applyMatrix4(Kn),this}scale(e,t,r){return Kn.makeScale(e,t,r),this.applyMatrix4(Kn),this}lookAt(e){return Qn.lookAt(e),Qn.updateMatrix(),this.applyMatrix4(Qn.matrix),this}center(){return this.computeBoundingBox(),this.boundingBox.getCenter($n).negate(),this.translate($n.x,$n.y,$n.z),this}setFromPoints(e){const t=[];for(let r=0,n=e.length;r<n;r++){const n=e[r];t.push(n.x,n.y,n.z||0)}return this.setAttribute("position",new Zn(t,3)),this}computeBoundingBox(){null===this.boundingBox&&(this.boundingBox=new Mr);const e=this.attributes.position,t=this.morphAttributes.position;if(e&&e.isGLBufferAttribute)this.boundingBox.set(new nr(-1/0,-1/0,-1/0),new nr(1/0,1/0,1/0));else{if(void 0!==e){if(this.boundingBox.setFromBufferAttribute(e),t)for(let e=0,r=t.length;e<r;e++){const r=t[e];ei.setFromBufferAttribute(r),this.morphTargetsRelative?(ri.addVectors(this.boundingBox.min,ei.min),this.boundingBox.expandByPoint(ri),ri.addVectors(this.boundingBox.max,ei.max),this.boundingBox.expandByPoint(ri)):(this.boundingBox.expandByPoint(ei.min),this.boundingBox.expandByPoint(ei.max))}}else this.boundingBox.makeEmpty();isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z)}}computeBoundingSphere(){null===this.boundingSphere&&(this.boundingSphere=new Gr);const e=this.attributes.position,t=this.morphAttributes.position;if(e&&e.isGLBufferAttribute)this.boundingSphere.set(new nr,1/0);else if(e){const r=this.boundingSphere.center;if(ei.setFromBufferAttribute(e),t)for(let e=0,r=t.length;e<r;e++){const r=t[e];ti.setFromBufferAttribute(r),this.morphTargetsRelative?(ri.addVectors(ei.min,ti.min),ei.expandByPoint(ri),ri.addVectors(ei.max,ti.max),ei.expandByPoint(ri)):(ei.expandByPoint(ti.min),ei.expandByPoint(ti.max))}ei.getCenter(r);let n=0;for(let t=0,i=e.count;t<i;t++)ri.fromBufferAttribute(e,t),n=Math.max(n,r.distanceToSquared(ri));if(t)for(let i=0,s=t.length;i<s;i++){const s=t[i],o=this.morphTargetsRelative;for(let t=0,i=s.count;t<i;t++)ri.fromBufferAttribute(s,t),o&&($n.fromBufferAttribute(e,t),ri.add($n)),n=Math.max(n,r.distanceToSquared(ri))}this.boundingSphere.radius=Math.sqrt(n),isNaN(this.boundingSphere.radius)}}computeTangents(){const e=this.index,t=this.attributes;if(null===e||void 0===t.position||void 0===t.normal||void 0===t.uv)return;const r=e.array,n=t.position.array,i=t.normal.array,s=t.uv.array,o=n.length/3;!1===this.hasAttribute("tangent")&&this.setAttribute("tangent",new Xn(new Float32Array(4*o),4));const a=this.getAttribute("tangent").array,l=[],c=[];for(let e=0;e<o;e++)l[e]=new nr,c[e]=new nr;const u=new nr,h=new nr,d=new nr,p=new Kt,f=new Kt,m=new Kt,g=new nr,y=new nr;function v(e,t,r){u.fromArray(n,3*e),h.fromArray(n,3*t),d.fromArray(n,3*r),p.fromArray(s,2*e),f.fromArray(s,2*t),m.fromArray(s,2*r),h.sub(u),d.sub(u),f.sub(p),m.sub(p);const i=1/(f.x*m.y-m.x*f.y);isFinite(i)&&(g.copy(h).multiplyScalar(m.y).addScaledVector(d,-f.y).multiplyScalar(i),y.copy(d).multiplyScalar(f.x).addScaledVector(h,-m.x).multiplyScalar(i),l[e].add(g),l[t].add(g),l[r].add(g),c[e].add(y),c[t].add(y),c[r].add(y))}let _=this.groups;0===_.length&&(_=[{start:0,count:r.length}]);for(let e=0,t=_.length;e<t;++e){const t=_[e],n=t.start;for(let e=n,i=n+t.count;e<i;e+=3)v(r[e+0],r[e+1],r[e+2])}const x=new nr,b=new nr,w=new nr,S=new nr;function M(e){w.fromArray(i,3*e),S.copy(w);const t=l[e];x.copy(t),x.sub(w.multiplyScalar(w.dot(t))).normalize(),b.crossVectors(S,t);const r=b.dot(c[e])<0?-1:1;a[4*e]=x.x,a[4*e+1]=x.y,a[4*e+2]=x.z,a[4*e+3]=r}for(let e=0,t=_.length;e<t;++e){const t=_[e],n=t.start;for(let e=n,i=n+t.count;e<i;e+=3)M(r[e+0]),M(r[e+1]),M(r[e+2])}}computeVertexNormals(){const e=this.index,t=this.getAttribute("position");if(void 0!==t){let r=this.getAttribute("normal");if(void 0===r)r=new Xn(new Float32Array(3*t.count),3),this.setAttribute("normal",r);else for(let e=0,t=r.count;e<t;e++)r.setXYZ(e,0,0,0);const n=new nr,i=new nr,s=new nr,o=new nr,a=new nr,l=new nr,c=new nr,u=new nr;if(e)for(let h=0,d=e.count;h<d;h+=3){const d=e.getX(h+0),p=e.getX(h+1),f=e.getX(h+2);n.fromBufferAttribute(t,d),i.fromBufferAttribute(t,p),s.fromBufferAttribute(t,f),c.subVectors(s,i),u.subVectors(n,i),c.cross(u),o.fromBufferAttribute(r,d),a.fromBufferAttribute(r,p),l.fromBufferAttribute(r,f),o.add(c),a.add(c),l.add(c),r.setXYZ(d,o.x,o.y,o.z),r.setXYZ(p,a.x,a.y,a.z),r.setXYZ(f,l.x,l.y,l.z)}else for(let e=0,o=t.count;e<o;e+=3)n.fromBufferAttribute(t,e+0),i.fromBufferAttribute(t,e+1),s.fromBufferAttribute(t,e+2),c.subVectors(s,i),u.subVectors(n,i),c.cross(u),r.setXYZ(e+0,c.x,c.y,c.z),r.setXYZ(e+1,c.x,c.y,c.z),r.setXYZ(e+2,c.x,c.y,c.z);this.normalizeNormals(),r.needsUpdate=!0}}merge(){return this}normalizeNormals(){const e=this.attributes.normal;for(let t=0,r=e.count;t<r;t++)ri.fromBufferAttribute(e,t),ri.normalize(),e.setXYZ(t,ri.x,ri.y,ri.z)}toNonIndexed(){function e(e,t){const r=e.array,n=e.itemSize,i=e.normalized,s=new r.constructor(t.length*n);let o=0,a=0;for(let i=0,l=t.length;i<l;i++){o=e.isInterleavedBufferAttribute?t[i]*e.data.stride+e.offset:t[i]*n;for(let e=0;e<n;e++)s[a++]=r[o++]}return new Xn(s,n,i)}if(null===this.index)return this;const t=new ni,r=this.index.array,n=this.attributes;for(const i in n){const s=e(n[i],r);t.setAttribute(i,s)}const i=this.morphAttributes;for(const n in i){const s=[],o=i[n];for(let t=0,n=o.length;t<n;t++){const n=e(o[t],r);s.push(n)}t.morphAttributes[n]=s}t.morphTargetsRelative=this.morphTargetsRelative;const s=this.groups;for(let e=0,r=s.length;e<r;e++){const r=s[e];t.addGroup(r.start,r.count,r.materialIndex)}return t}toJSON(){const e={metadata:{version:4.5,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(e.uuid=this.uuid,e.type=this.type,""!==this.name&&(e.name=this.name),Object.keys(this.userData).length>0&&(e.userData=this.userData),void 0!==this.parameters){const t=this.parameters;for(const r in t)void 0!==t[r]&&(e[r]=t[r]);return e}e.data={attributes:{}};const t=this.index;null!==t&&(e.data.index={type:t.array.constructor.name,array:Array.prototype.slice.call(t.array)});const r=this.attributes;for(const t in r){const n=r[t];e.data.attributes[t]=n.toJSON(e.data)}const n={};let i=!1;for(const t in this.morphAttributes){const r=this.morphAttributes[t],s=[];for(let t=0,n=r.length;t<n;t++){const n=r[t];s.push(n.toJSON(e.data))}s.length>0&&(n[t]=s,i=!0)}i&&(e.data.morphAttributes=n,e.data.morphTargetsRelative=this.morphTargetsRelative);const s=this.groups;s.length>0&&(e.data.groups=JSON.parse(JSON.stringify(s)));const o=this.boundingSphere;return null!==o&&(e.data.boundingSphere={center:o.center.toArray(),radius:o.radius}),e}clone(){return(new this.constructor).copy(this)}copy(e){this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null;const t={};this.name=e.name;const r=e.index;null!==r&&this.setIndex(r.clone(t));const n=e.attributes;for(const e in n){const r=n[e];this.setAttribute(e,r.clone(t))}const i=e.morphAttributes;for(const e in i){const r=[],n=i[e];for(let e=0,i=n.length;e<i;e++)r.push(n[e].clone(t));this.morphAttributes[e]=r}this.morphTargetsRelative=e.morphTargetsRelative;const s=e.groups;for(let e=0,t=s.length;e<t;e++){const t=s[e];this.addGroup(t.start,t.count,t.materialIndex)}const o=e.boundingBox;null!==o&&(this.boundingBox=o.clone());const a=e.boundingSphere;return null!==a&&(this.boundingSphere=a.clone()),this.drawRange.start=e.drawRange.start,this.drawRange.count=e.drawRange.count,this.userData=e.userData,this}dispose(){this.dispatchEvent({type:"dispose"})}}const ii=new Kr,si=new Jr,oi=new Gr,ai=new nr,li=new nr,ci=new nr,ui=new nr,hi=new nr,di=new nr,pi=new Kt,fi=new Kt,mi=new Kt,gi=new nr,yi=new nr;class vi extends Sn{constructor(e=new ni,t=new Vn){super(),this.isMesh=!0,this.type="Mesh",this.geometry=e,this.material=t,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),void 0!==e.morphTargetInfluences&&(this.morphTargetInfluences=e.morphTargetInfluences.slice()),void 0!==e.morphTargetDictionary&&(this.morphTargetDictionary=Object.assign({},e.morphTargetDictionary)),this.material=e.material,this.geometry=e.geometry,this}updateMorphTargets(){const e=this.geometry.morphAttributes,t=Object.keys(e);if(t.length>0){const r=e[t[0]];if(void 0!==r){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let e=0,t=r.length;e<t;e++){const t=r[e].name||String(e);this.morphTargetInfluences.push(0),this.morphTargetDictionary[t]=e}}}}getVertexPosition(e,t){const r=this.geometry,n=r.attributes.position,i=r.morphAttributes.position,s=r.morphTargetsRelative;t.fromBufferAttribute(n,e);const o=this.morphTargetInfluences;if(i&&o){di.set(0,0,0);for(let r=0,n=i.length;r<n;r++){const n=o[r],a=i[r];0!==n&&(hi.fromBufferAttribute(a,e),s?di.addScaledVector(hi,n):di.addScaledVector(hi.sub(t),n))}t.add(di)}return this.isSkinnedMesh&&this.boneTransform(e,t),t}raycast(e,t){const r=this.geometry,n=this.material,i=this.matrixWorld;if(void 0===n)return;if(null===r.boundingSphere&&r.computeBoundingSphere(),oi.copy(r.boundingSphere),oi.applyMatrix4(i),si.copy(e.ray).recast(e.near),!1===oi.containsPoint(si.origin)){if(null===si.intersectSphere(oi,ai))return;if(si.origin.distanceToSquared(ai)>(e.far-e.near)**2)return}if(ii.copy(i).invert(),si.copy(e.ray).applyMatrix4(ii),null!==r.boundingBox&&!1===si.intersectsBox(r.boundingBox))return;let s;const o=r.index,a=r.attributes.position,l=r.attributes.uv,c=r.attributes.uv2,u=r.groups,h=r.drawRange;if(null!==o)if(Array.isArray(n))for(let r=0,i=u.length;r<i;r++){const i=u[r],a=n[i.materialIndex];for(let r=Math.max(i.start,h.start),n=Math.min(o.count,Math.min(i.start+i.count,h.start+h.count));r<n;r+=3){const n=o.getX(r),u=o.getX(r+1),h=o.getX(r+2);s=_i(this,a,e,si,l,c,n,u,h),s&&(s.faceIndex=Math.floor(r/3),s.face.materialIndex=i.materialIndex,t.push(s))}}else{for(let r=Math.max(0,h.start),i=Math.min(o.count,h.start+h.count);r<i;r+=3){const i=o.getX(r),a=o.getX(r+1),u=o.getX(r+2);s=_i(this,n,e,si,l,c,i,a,u),s&&(s.faceIndex=Math.floor(r/3),t.push(s))}}else if(void 0!==a)if(Array.isArray(n))for(let r=0,i=u.length;r<i;r++){const i=u[r],o=n[i.materialIndex];for(let r=Math.max(i.start,h.start),n=Math.min(a.count,Math.min(i.start+i.count,h.start+h.count));r<n;r+=3){s=_i(this,o,e,si,l,c,r,r+1,r+2),s&&(s.faceIndex=Math.floor(r/3),s.face.materialIndex=i.materialIndex,t.push(s))}}else{for(let r=Math.max(0,h.start),i=Math.min(a.count,h.start+h.count);r<i;r+=3){s=_i(this,n,e,si,l,c,r,r+1,r+2),s&&(s.faceIndex=Math.floor(r/3),t.push(s))}}}}function _i(e,t,r,n,i,s,o,a,l){e.getVertexPosition(o,li),e.getVertexPosition(a,ci),e.getVertexPosition(l,ui);const c=function(e,t,r,n,i,s,o,a){let l;if(l=t.side===p?n.intersectTriangle(o,s,i,!0,a):n.intersectTriangle(i,s,o,t.side===d,a),null===l)return null;yi.copy(a),yi.applyMatrix4(e.matrixWorld);const c=r.ray.origin.distanceTo(yi);return c<r.near||c>r.far?null:{distance:c,point:yi.clone(),object:e}}(e,t,r,n,li,ci,ui,gi);if(c){i&&(pi.fromBufferAttribute(i,o),fi.fromBufferAttribute(i,a),mi.fromBufferAttribute(i,l),c.uv=Dn.getUV(gi,li,ci,ui,pi,fi,mi,new Kt)),s&&(pi.fromBufferAttribute(s,o),fi.fromBufferAttribute(s,a),mi.fromBufferAttribute(s,l),c.uv2=Dn.getUV(gi,li,ci,ui,pi,fi,mi,new Kt));const e={a:o,b:a,c:l,normal:new nr,materialIndex:0};Dn.getNormal(li,ci,ui,e.normal),c.face=e}return c}class xi extends ni{constructor(e=1,t=1,r=1,n=1,i=1,s=1){super(),this.type="BoxGeometry",this.parameters={width:e,height:t,depth:r,widthSegments:n,heightSegments:i,depthSegments:s};const o=this;n=Math.floor(n),i=Math.floor(i),s=Math.floor(s);const a=[],l=[],c=[],u=[];let h=0,d=0;function p(e,t,r,n,i,s,p,f,m,g,y){const v=s/m,_=p/g,x=s/2,b=p/2,w=f/2,S=m+1,M=g+1;let T=0,E=0;const A=new nr;for(let s=0;s<M;s++){const o=s*_-b;for(let a=0;a<S;a++){const h=a*v-x;A[e]=h*n,A[t]=o*i,A[r]=w,l.push(A.x,A.y,A.z),A[e]=0,A[t]=0,A[r]=f>0?1:-1,c.push(A.x,A.y,A.z),u.push(a/m),u.push(1-s/g),T+=1}}for(let e=0;e<g;e++)for(let t=0;t<m;t++){const r=h+t+S*e,n=h+t+S*(e+1),i=h+(t+1)+S*(e+1),s=h+(t+1)+S*e;a.push(r,n,s),a.push(n,i,s),E+=6}o.addGroup(d,E,y),d+=E,h+=T}p("z","y","x",-1,-1,r,t,e,s,i,0),p("z","y","x",1,-1,r,t,-e,s,i,1),p("x","z","y",1,1,e,r,t,n,s,2),p("x","z","y",1,-1,e,r,-t,n,s,3),p("x","y","z",1,-1,e,t,r,n,i,4),p("x","y","z",-1,-1,e,t,-r,n,i,5),this.setIndex(a),this.setAttribute("position",new Zn(l,3)),this.setAttribute("normal",new Zn(c,3)),this.setAttribute("uv",new Zn(u,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new xi(e.width,e.height,e.depth,e.widthSegments,e.heightSegments,e.depthSegments)}}function bi(e){const t={};for(const r in e){t[r]={};for(const n in e[r]){const i=e[r][n];i&&(i.isColor||i.isMatrix3||i.isMatrix4||i.isVector2||i.isVector3||i.isVector4||i.isTexture||i.isQuaternion)?t[r][n]=i.clone():Array.isArray(i)?t[r][n]=i.slice():t[r][n]=i}}return t}function wi(e){const t={};for(let r=0;r<e.length;r++){const n=bi(e[r]);for(const e in n)t[e]=n[e]}return t}function Si(e){return null===e.getRenderTarget()&&e.outputEncoding===Tt?Lt:Rt}const Mi={clone:bi,merge:wi};class Ti extends Nn{constructor(e){super(),this.isShaderMaterial=!0,this.type="ShaderMaterial",this.defines={},this.uniforms={},this.uniformsGroups=[],this.vertexShader="void main() {\n\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}",this.fragmentShader="void main() {\n\tgl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );\n}",this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.clipping=!1,this.extensions={derivatives:!1,fragDepth:!1,drawBuffers:!1,shaderTextureLOD:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv2:[0,0]},this.index0AttributeName=void 0,this.uniformsNeedUpdate=!1,this.glslVersion=null,void 0!==e&&this.setValues(e)}copy(e){return super.copy(e),this.fragmentShader=e.fragmentShader,this.vertexShader=e.vertexShader,this.uniforms=bi(e.uniforms),this.uniformsGroups=function(e){const t=[];for(let r=0;r<e.length;r++)t.push(e[r].clone());return t}(e.uniformsGroups),this.defines=Object.assign({},e.defines),this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.fog=e.fog,this.lights=e.lights,this.clipping=e.clipping,this.extensions=Object.assign({},e.extensions),this.glslVersion=e.glslVersion,this}toJSON(e){const t=super.toJSON(e);t.glslVersion=this.glslVersion,t.uniforms={};for(const r in this.uniforms){const n=this.uniforms[r].value;n&&n.isTexture?t.uniforms[r]={type:"t",value:n.toJSON(e).uuid}:n&&n.isColor?t.uniforms[r]={type:"c",value:n.getHex()}:n&&n.isVector2?t.uniforms[r]={type:"v2",value:n.toArray()}:n&&n.isVector3?t.uniforms[r]={type:"v3",value:n.toArray()}:n&&n.isVector4?t.uniforms[r]={type:"v4",value:n.toArray()}:n&&n.isMatrix3?t.uniforms[r]={type:"m3",value:n.toArray()}:n&&n.isMatrix4?t.uniforms[r]={type:"m4",value:n.toArray()}:t.uniforms[r]={value:n}}Object.keys(this.defines).length>0&&(t.defines=this.defines),t.vertexShader=this.vertexShader,t.fragmentShader=this.fragmentShader;const r={};for(const e in this.extensions)!0===this.extensions[e]&&(r[e]=!0);return Object.keys(r).length>0&&(t.extensions=r),t}}class Ei extends Sn{constructor(){super(),this.isCamera=!0,this.type="Camera",this.matrixWorldInverse=new Kr,this.projectionMatrix=new Kr,this.projectionMatrixInverse=new Kr}copy(e,t){return super.copy(e,t),this.matrixWorldInverse.copy(e.matrixWorldInverse),this.projectionMatrix.copy(e.projectionMatrix),this.projectionMatrixInverse.copy(e.projectionMatrixInverse),this}getWorldDirection(e){this.updateWorldMatrix(!0,!1);const t=this.matrixWorld.elements;return e.set(-t[8],-t[9],-t[10]).normalize()}updateMatrixWorld(e){super.updateMatrixWorld(e),this.matrixWorldInverse.copy(this.matrixWorld).invert()}updateWorldMatrix(e,t){super.updateWorldMatrix(e,t),this.matrixWorldInverse.copy(this.matrixWorld).invert()}clone(){return(new this.constructor).copy(this)}}class Ai extends Ei{constructor(e=50,t=1,r=.1,n=2e3){super(),this.isPerspectiveCamera=!0,this.type="PerspectiveCamera",this.fov=e,this.zoom=1,this.near=r,this.far=n,this.focus=10,this.aspect=t,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}copy(e,t){return super.copy(e,t),this.fov=e.fov,this.zoom=e.zoom,this.near=e.near,this.far=e.far,this.focus=e.focus,this.aspect=e.aspect,this.view=null===e.view?null:Object.assign({},e.view),this.filmGauge=e.filmGauge,this.filmOffset=e.filmOffset,this}setFocalLength(e){const t=.5*this.getFilmHeight()/e;this.fov=2*Bt*Math.atan(t),this.updateProjectionMatrix()}getFocalLength(){const e=Math.tan(.5*Ft*this.fov);return.5*this.getFilmHeight()/e}getEffectiveFOV(){return 2*Bt*Math.atan(Math.tan(.5*Ft*this.fov)/this.zoom)}getFilmWidth(){return this.filmGauge*Math.min(this.aspect,1)}getFilmHeight(){return this.filmGauge/Math.max(this.aspect,1)}setViewOffset(e,t,r,n,i,s){this.aspect=e/t,null===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=r,this.view.offsetY=n,this.view.width=i,this.view.height=s,this.updateProjectionMatrix()}clearViewOffset(){null!==this.view&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const e=this.near;let t=e*Math.tan(.5*Ft*this.fov)/this.zoom,r=2*t,n=this.aspect*r,i=-.5*n;const s=this.view;if(null!==this.view&&this.view.enabled){const e=s.fullWidth,o=s.fullHeight;i+=s.offsetX*n/e,t-=s.offsetY*r/o,n*=s.width/e,r*=s.height/o}const o=this.filmOffset;0!==o&&(i+=e*o/this.getFilmWidth()),this.projectionMatrix.makePerspective(i,i+n,t,t-r,e,this.far),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){const t=super.toJSON(e);return t.object.fov=this.fov,t.object.zoom=this.zoom,t.object.near=this.near,t.object.far=this.far,t.object.focus=this.focus,t.object.aspect=this.aspect,null!==this.view&&(t.object.view=Object.assign({},this.view)),t.object.filmGauge=this.filmGauge,t.object.filmOffset=this.filmOffset,t}}const Ci=-90;class Li extends Sn{constructor(e,t,r){super(),this.type="CubeCamera",this.renderTarget=r;const n=new Ai(Ci,1,e,t);n.layers=this.layers,n.up.set(0,1,0),n.lookAt(1,0,0),this.add(n);const i=new Ai(Ci,1,e,t);i.layers=this.layers,i.up.set(0,1,0),i.lookAt(-1,0,0),this.add(i);const s=new Ai(Ci,1,e,t);s.layers=this.layers,s.up.set(0,0,-1),s.lookAt(0,1,0),this.add(s);const o=new Ai(Ci,1,e,t);o.layers=this.layers,o.up.set(0,0,1),o.lookAt(0,-1,0),this.add(o);const a=new Ai(Ci,1,e,t);a.layers=this.layers,a.up.set(0,1,0),a.lookAt(0,0,1),this.add(a);const l=new Ai(Ci,1,e,t);l.layers=this.layers,l.up.set(0,1,0),l.lookAt(0,0,-1),this.add(l)}update(e,t){null===this.parent&&this.updateMatrixWorld();const r=this.renderTarget,[n,i,s,o,a,l]=this.children,c=e.getRenderTarget(),u=e.toneMapping,h=e.xr.enabled;e.toneMapping=Y,e.xr.enabled=!1;const d=r.texture.generateMipmaps;r.texture.generateMipmaps=!1,e.setRenderTarget(r,0),e.render(t,n),e.setRenderTarget(r,1),e.render(t,i),e.setRenderTarget(r,2),e.render(t,s),e.setRenderTarget(r,3),e.render(t,o),e.setRenderTarget(r,4),e.render(t,a),r.texture.generateMipmaps=d,e.setRenderTarget(r,5),e.render(t,l),e.setRenderTarget(c),e.toneMapping=u,e.xr.enabled=h,r.texture.needsPMREMUpdate=!0}}class Ri extends _r{constructor(e,t,r,n,i,s,o,a,l,c){super(e=void 0!==e?e:[],t=void 0!==t?t:ee,r,n,i,s,o,a,l,c),this.isCubeTexture=!0,this.flipY=!1}get images(){return this.image}set images(e){this.image=e}}class Pi extends br{constructor(e=1,t={}){super(e,e,t),this.isWebGLCubeRenderTarget=!0;const r={width:e,height:e,depth:1},n=[r,r,r,r,r,r];this.texture=new Ri(n,t.mapping,t.wrapS,t.wrapT,t.magFilter,t.minFilter,t.format,t.type,t.anisotropy,t.encoding),this.texture.isRenderTargetTexture=!0,this.texture.generateMipmaps=void 0!==t.generateMipmaps&&t.generateMipmaps,this.texture.minFilter=void 0!==t.minFilter?t.minFilter:he}fromEquirectangularTexture(e,t){this.texture.type=t.type,this.texture.encoding=t.encoding,this.texture.generateMipmaps=t.generateMipmaps,this.texture.minFilter=t.minFilter,this.texture.magFilter=t.magFilter;const r={uniforms:{tEquirect:{value:null}},vertexShader:"\n\n\t\t\t\tvarying vec3 vWorldDirection;\n\n\t\t\t\tvec3 transformDirection( in vec3 dir, in mat4 matrix ) {\n\n\t\t\t\t\treturn normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );\n\n\t\t\t\t}\n\n\t\t\t\tvoid main() {\n\n\t\t\t\t\tvWorldDirection = transformDirection( position, modelMatrix );\n\n\t\t\t\t\t#include <begin_vertex>\n\t\t\t\t\t#include <project_vertex>\n\n\t\t\t\t}\n\t\t\t",fragmentShader:"\n\n\t\t\t\tuniform sampler2D tEquirect;\n\n\t\t\t\tvarying vec3 vWorldDirection;\n\n\t\t\t\t#include <common>\n\n\t\t\t\tvoid main() {\n\n\t\t\t\t\tvec3 direction = normalize( vWorldDirection );\n\n\t\t\t\t\tvec2 sampleUV = equirectUv( direction );\n\n\t\t\t\t\tgl_FragColor = texture2D( tEquirect, sampleUV );\n\n\t\t\t\t}\n\t\t\t"},n=new xi(5,5,5),i=new Ti({name:"CubemapFromEquirect",uniforms:bi(r.uniforms),vertexShader:r.vertexShader,fragmentShader:r.fragmentShader,side:p,blending:m});i.uniforms.tEquirect.value=t;const s=new vi(n,i),o=t.minFilter;t.minFilter===pe&&(t.minFilter=he);return new Li(1,10,this).update(e,s),t.minFilter=o,s.geometry.dispose(),s.material.dispose(),this}clear(e,t,r,n){const i=e.getRenderTarget();for(let i=0;i<6;i++)e.setRenderTarget(this,i),e.clear(t,r,n);e.setRenderTarget(i)}}const ji=new nr,Ii=new nr,Di=new Qt;class Oi{constructor(e=new nr(1,0,0),t=0){this.isPlane=!0,this.normal=e,this.constant=t}set(e,t){return this.normal.copy(e),this.constant=t,this}setComponents(e,t,r,n){return this.normal.set(e,t,r),this.constant=n,this}setFromNormalAndCoplanarPoint(e,t){return this.normal.copy(e),this.constant=-t.dot(this.normal),this}setFromCoplanarPoints(e,t,r){const n=ji.subVectors(r,t).cross(Ii.subVectors(e,t)).normalize();return this.setFromNormalAndCoplanarPoint(n,e),this}copy(e){return this.normal.copy(e.normal),this.constant=e.constant,this}normalize(){const e=1/this.normal.length();return this.normal.multiplyScalar(e),this.constant*=e,this}negate(){return this.constant*=-1,this.normal.negate(),this}distanceToPoint(e){return this.normal.dot(e)+this.constant}distanceToSphere(e){return this.distanceToPoint(e.center)-e.radius}projectPoint(e,t){return t.copy(e).addScaledVector(this.normal,-this.distanceToPoint(e))}intersectLine(e,t){const r=e.delta(ji),n=this.normal.dot(r);if(0===n)return 0===this.distanceToPoint(e.start)?t.copy(e.start):null;const i=-(e.start.dot(this.normal)+this.constant)/n;return i<0||i>1?null:t.copy(e.start).addScaledVector(r,i)}intersectsLine(e){const t=this.distanceToPoint(e.start),r=this.distanceToPoint(e.end);return t<0&&r>0||r<0&&t>0}intersectsBox(e){return e.intersectsPlane(this)}intersectsSphere(e){return e.intersectsPlane(this)}coplanarPoint(e){return e.copy(this.normal).multiplyScalar(-this.constant)}applyMatrix4(e,t){const r=t||Di.getNormalMatrix(e),n=this.coplanarPoint(ji).applyMatrix4(e),i=this.normal.applyMatrix3(r).normalize();return this.constant=-n.dot(i),this}translate(e){return this.constant-=e.dot(this.normal),this}equals(e){return e.normal.equals(this.normal)&&e.constant===this.constant}clone(){return(new this.constructor).copy(this)}}const Ni=new Gr,Ui=new nr;class ki{constructor(e=new Oi,t=new Oi,r=new Oi,n=new Oi,i=new Oi,s=new Oi){this.planes=[e,t,r,n,i,s]}set(e,t,r,n,i,s){const o=this.planes;return o[0].copy(e),o[1].copy(t),o[2].copy(r),o[3].copy(n),o[4].copy(i),o[5].copy(s),this}copy(e){const t=this.planes;for(let r=0;r<6;r++)t[r].copy(e.planes[r]);return this}setFromProjectionMatrix(e){const t=this.planes,r=e.elements,n=r[0],i=r[1],s=r[2],o=r[3],a=r[4],l=r[5],c=r[6],u=r[7],h=r[8],d=r[9],p=r[10],f=r[11],m=r[12],g=r[13],y=r[14],v=r[15];return t[0].setComponents(o-n,u-a,f-h,v-m).normalize(),t[1].setComponents(o+n,u+a,f+h,v+m).normalize(),t[2].setComponents(o+i,u+l,f+d,v+g).normalize(),t[3].setComponents(o-i,u-l,f-d,v-g).normalize(),t[4].setComponents(o-s,u-c,f-p,v-y).normalize(),t[5].setComponents(o+s,u+c,f+p,v+y).normalize(),this}intersectsObject(e){const t=e.geometry;return null===t.boundingSphere&&t.computeBoundingSphere(),Ni.copy(t.boundingSphere).applyMatrix4(e.matrixWorld),this.intersectsSphere(Ni)}intersectsSprite(e){return Ni.center.set(0,0,0),Ni.radius=.7071067811865476,Ni.applyMatrix4(e.matrixWorld),this.intersectsSphere(Ni)}intersectsSphere(e){const t=this.planes,r=e.center,n=-e.radius;for(let e=0;e<6;e++){if(t[e].distanceToPoint(r)<n)return!1}return!0}intersectsBox(e){const t=this.planes;for(let r=0;r<6;r++){const n=t[r];if(Ui.x=n.normal.x>0?e.max.x:e.min.x,Ui.y=n.normal.y>0?e.max.y:e.min.y,Ui.z=n.normal.z>0?e.max.z:e.min.z,n.distanceToPoint(Ui)<0)return!1}return!0}containsPoint(e){const t=this.planes;for(let r=0;r<6;r++)if(t[r].distanceToPoint(e)<0)return!1;return!0}clone(){return(new this.constructor).copy(this)}}function Fi(){let e=null,t=!1,r=null,n=null;function i(t,s){r(t,s),n=e.requestAnimationFrame(i)}return{start:function(){!0!==t&&null!==r&&(n=e.requestAnimationFrame(i),t=!0)},stop:function(){e.cancelAnimationFrame(n),t=!1},setAnimationLoop:function(e){r=e},setContext:function(t){e=t}}}function Bi(e,t){const r=t.isWebGL2,n=new WeakMap;return{get:function(e){return e.isInterleavedBufferAttribute&&(e=e.data),n.get(e)},remove:function(t){t.isInterleavedBufferAttribute&&(t=t.data);const r=n.get(t);r&&(e.deleteBuffer(r.buffer),n.delete(t))},update:function(t,i){if(t.isGLBufferAttribute){const e=n.get(t);return void((!e||e.version<t.version)&&n.set(t,{buffer:t.buffer,type:t.type,bytesPerElement:t.elementSize,version:t.version}))}t.isInterleavedBufferAttribute&&(t=t.data);const s=n.get(t);void 0===s?n.set(t,function(t,n){const i=t.array,s=t.usage,o=e.createBuffer();let a;if(e.bindBuffer(n,o),e.bufferData(n,i,s),t.onUploadCallback(),i instanceof Float32Array)a=5126;else if(i instanceof Uint16Array)if(t.isFloat16BufferAttribute){if(!r)throw new Error("THREE.WebGLAttributes: Usage of Float16BufferAttribute requires WebGL2.");a=5131}else a=5123;else if(i instanceof Int16Array)a=5122;else if(i instanceof Uint32Array)a=5125;else if(i instanceof Int32Array)a=5124;else if(i instanceof Int8Array)a=5120;else if(i instanceof Uint8Array)a=5121;else{if(!(i instanceof Uint8ClampedArray))throw new Error("THREE.WebGLAttributes: Unsupported buffer data format: "+i);a=5121}return{buffer:o,type:a,bytesPerElement:i.BYTES_PER_ELEMENT,version:t.version}}(t,i)):s.version<t.version&&(!function(t,n,i){const s=n.array,o=n.updateRange;e.bindBuffer(i,t),-1===o.count?e.bufferSubData(i,0,s):(r?e.bufferSubData(i,o.offset*s.BYTES_PER_ELEMENT,s,o.offset,o.count):e.bufferSubData(i,o.offset*s.BYTES_PER_ELEMENT,s.subarray(o.offset,o.offset+o.count)),o.count=-1),n.onUploadCallback()}(s.buffer,t,i),s.version=t.version)}}}class zi extends ni{constructor(e=1,t=1,r=1,n=1){super(),this.type="PlaneGeometry",this.parameters={width:e,height:t,widthSegments:r,heightSegments:n};const i=e/2,s=t/2,o=Math.floor(r),a=Math.floor(n),l=o+1,c=a+1,u=e/o,h=t/a,d=[],p=[],f=[],m=[];for(let e=0;e<c;e++){const t=e*h-s;for(let r=0;r<l;r++){const n=r*u-i;p.push(n,-t,0),f.push(0,0,1),m.push(r/o),m.push(1-e/a)}}for(let e=0;e<a;e++)for(let t=0;t<o;t++){const r=t+l*e,n=t+l*(e+1),i=t+1+l*(e+1),s=t+1+l*e;d.push(r,n,s),d.push(n,i,s)}this.setIndex(d),this.setAttribute("position",new Zn(p,3)),this.setAttribute("normal",new Zn(f,3)),this.setAttribute("uv",new Zn(m,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new zi(e.width,e.height,e.widthSegments,e.heightSegments)}}const Gi={alphamap_fragment:"#ifdef USE_ALPHAMAP\n\tdiffuseColor.a *= texture2D( alphaMap, vUv ).g;\n#endif",alphamap_pars_fragment:"#ifdef USE_ALPHAMAP\n\tuniform sampler2D alphaMap;\n#endif",alphatest_fragment:"#ifdef USE_ALPHATEST\n\tif ( diffuseColor.a < alphaTest ) discard;\n#endif",alphatest_pars_fragment:"#ifdef USE_ALPHATEST\n\tuniform float alphaTest;\n#endif",aomap_fragment:"#ifdef USE_AOMAP\n\tfloat ambientOcclusion = ( texture2D( aoMap, vUv2 ).r - 1.0 ) * aoMapIntensity + 1.0;\n\treflectedLight.indirectDiffuse *= ambientOcclusion;\n\t#if defined( USE_ENVMAP ) && defined( STANDARD )\n\t\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n\t\treflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.roughness );\n\t#endif\n#endif",aomap_pars_fragment:"#ifdef USE_AOMAP\n\tuniform sampler2D aoMap;\n\tuniform float aoMapIntensity;\n#endif",begin_vertex:"vec3 transformed = vec3( position );",beginnormal_vertex:"vec3 objectNormal = vec3( normal );\n#ifdef USE_TANGENT\n\tvec3 objectTangent = vec3( tangent.xyz );\n#endif",bsdfs:"vec3 BRDF_Lambert( const in vec3 diffuseColor ) {\n\treturn RECIPROCAL_PI * diffuseColor;\n}\nvec3 F_Schlick( const in vec3 f0, const in float f90, const in float dotVH ) {\n\tfloat fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );\n\treturn f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );\n}\nfloat F_Schlick( const in float f0, const in float f90, const in float dotVH ) {\n\tfloat fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );\n\treturn f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );\n}\nvec3 Schlick_to_F0( const in vec3 f, const in float f90, const in float dotVH ) {\n    float x = clamp( 1.0 - dotVH, 0.0, 1.0 );\n    float x2 = x * x;\n    float x5 = clamp( x * x2 * x2, 0.0, 0.9999 );\n    return ( f - vec3( f90 ) * x5 ) / ( 1.0 - x5 );\n}\nfloat V_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {\n\tfloat a2 = pow2( alpha );\n\tfloat gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );\n\tfloat gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );\n\treturn 0.5 / max( gv + gl, EPSILON );\n}\nfloat D_GGX( const in float alpha, const in float dotNH ) {\n\tfloat a2 = pow2( alpha );\n\tfloat denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;\n\treturn RECIPROCAL_PI * a2 / pow2( denom );\n}\nvec3 BRDF_GGX( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 f0, const in float f90, const in float roughness ) {\n\tfloat alpha = pow2( roughness );\n\tvec3 halfDir = normalize( lightDir + viewDir );\n\tfloat dotNL = saturate( dot( normal, lightDir ) );\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\tfloat dotVH = saturate( dot( viewDir, halfDir ) );\n\tvec3 F = F_Schlick( f0, f90, dotVH );\n\tfloat V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );\n\tfloat D = D_GGX( alpha, dotNH );\n\treturn F * ( V * D );\n}\n#ifdef USE_IRIDESCENCE\n\tvec3 BRDF_GGX_Iridescence( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 f0, const in float f90, const in float iridescence, const in vec3 iridescenceFresnel, const in float roughness ) {\n\t\tfloat alpha = pow2( roughness );\n\t\tvec3 halfDir = normalize( lightDir + viewDir );\n\t\tfloat dotNL = saturate( dot( normal, lightDir ) );\n\t\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\t\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\t\tfloat dotVH = saturate( dot( viewDir, halfDir ) );\n\t\tvec3 F = mix( F_Schlick( f0, f90, dotVH ), iridescenceFresnel, iridescence );\n\t\tfloat V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );\n\t\tfloat D = D_GGX( alpha, dotNH );\n\t\treturn F * ( V * D );\n\t}\n#endif\nvec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {\n\tconst float LUT_SIZE = 64.0;\n\tconst float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;\n\tconst float LUT_BIAS = 0.5 / LUT_SIZE;\n\tfloat dotNV = saturate( dot( N, V ) );\n\tvec2 uv = vec2( roughness, sqrt( 1.0 - dotNV ) );\n\tuv = uv * LUT_SCALE + LUT_BIAS;\n\treturn uv;\n}\nfloat LTC_ClippedSphereFormFactor( const in vec3 f ) {\n\tfloat l = length( f );\n\treturn max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );\n}\nvec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {\n\tfloat x = dot( v1, v2 );\n\tfloat y = abs( x );\n\tfloat a = 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;\n\tfloat b = 3.4175940 + ( 4.1616724 + y ) * y;\n\tfloat v = a / b;\n\tfloat theta_sintheta = ( x > 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;\n\treturn cross( v1, v2 ) * theta_sintheta;\n}\nvec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {\n\tvec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];\n\tvec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];\n\tvec3 lightNormal = cross( v1, v2 );\n\tif( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );\n\tvec3 T1, T2;\n\tT1 = normalize( V - N * dot( V, N ) );\n\tT2 = - cross( N, T1 );\n\tmat3 mat = mInv * transposeMat3( mat3( T1, T2, N ) );\n\tvec3 coords[ 4 ];\n\tcoords[ 0 ] = mat * ( rectCoords[ 0 ] - P );\n\tcoords[ 1 ] = mat * ( rectCoords[ 1 ] - P );\n\tcoords[ 2 ] = mat * ( rectCoords[ 2 ] - P );\n\tcoords[ 3 ] = mat * ( rectCoords[ 3 ] - P );\n\tcoords[ 0 ] = normalize( coords[ 0 ] );\n\tcoords[ 1 ] = normalize( coords[ 1 ] );\n\tcoords[ 2 ] = normalize( coords[ 2 ] );\n\tcoords[ 3 ] = normalize( coords[ 3 ] );\n\tvec3 vectorFormFactor = vec3( 0.0 );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );\n\tfloat result = LTC_ClippedSphereFormFactor( vectorFormFactor );\n\treturn vec3( result );\n}\nfloat G_BlinnPhong_Implicit( ) {\n\treturn 0.25;\n}\nfloat D_BlinnPhong( const in float shininess, const in float dotNH ) {\n\treturn RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );\n}\nvec3 BRDF_BlinnPhong( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float shininess ) {\n\tvec3 halfDir = normalize( lightDir + viewDir );\n\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\tfloat dotVH = saturate( dot( viewDir, halfDir ) );\n\tvec3 F = F_Schlick( specularColor, 1.0, dotVH );\n\tfloat G = G_BlinnPhong_Implicit( );\n\tfloat D = D_BlinnPhong( shininess, dotNH );\n\treturn F * ( G * D );\n}\n#if defined( USE_SHEEN )\nfloat D_Charlie( float roughness, float dotNH ) {\n\tfloat alpha = pow2( roughness );\n\tfloat invAlpha = 1.0 / alpha;\n\tfloat cos2h = dotNH * dotNH;\n\tfloat sin2h = max( 1.0 - cos2h, 0.0078125 );\n\treturn ( 2.0 + invAlpha ) * pow( sin2h, invAlpha * 0.5 ) / ( 2.0 * PI );\n}\nfloat V_Neubelt( float dotNV, float dotNL ) {\n\treturn saturate( 1.0 / ( 4.0 * ( dotNL + dotNV - dotNL * dotNV ) ) );\n}\nvec3 BRDF_Sheen( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, vec3 sheenColor, const in float sheenRoughness ) {\n\tvec3 halfDir = normalize( lightDir + viewDir );\n\tfloat dotNL = saturate( dot( normal, lightDir ) );\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\tfloat D = D_Charlie( sheenRoughness, dotNH );\n\tfloat V = V_Neubelt( dotNV, dotNL );\n\treturn sheenColor * ( D * V );\n}\n#endif",iridescence_fragment:"#ifdef USE_IRIDESCENCE\n\tconst mat3 XYZ_TO_REC709 = mat3(\n\t\t 3.2404542, -0.9692660,  0.0556434,\n\t\t-1.5371385,  1.8760108, -0.2040259,\n\t\t-0.4985314,  0.0415560,  1.0572252\n\t);\n\tvec3 Fresnel0ToIor( vec3 fresnel0 ) {\n\t\tvec3 sqrtF0 = sqrt( fresnel0 );\n\t\treturn ( vec3( 1.0 ) + sqrtF0 ) / ( vec3( 1.0 ) - sqrtF0 );\n\t}\n\tvec3 IorToFresnel0( vec3 transmittedIor, float incidentIor ) {\n\t\treturn pow2( ( transmittedIor - vec3( incidentIor ) ) / ( transmittedIor + vec3( incidentIor ) ) );\n\t}\n\tfloat IorToFresnel0( float transmittedIor, float incidentIor ) {\n\t\treturn pow2( ( transmittedIor - incidentIor ) / ( transmittedIor + incidentIor ));\n\t}\n\tvec3 evalSensitivity( float OPD, vec3 shift ) {\n\t\tfloat phase = 2.0 * PI * OPD * 1.0e-9;\n\t\tvec3 val = vec3( 5.4856e-13, 4.4201e-13, 5.2481e-13 );\n\t\tvec3 pos = vec3( 1.6810e+06, 1.7953e+06, 2.2084e+06 );\n\t\tvec3 var = vec3( 4.3278e+09, 9.3046e+09, 6.6121e+09 );\n\t\tvec3 xyz = val * sqrt( 2.0 * PI * var ) * cos( pos * phase + shift ) * exp( - pow2( phase ) * var );\n\t\txyz.x += 9.7470e-14 * sqrt( 2.0 * PI * 4.5282e+09 ) * cos( 2.2399e+06 * phase + shift[ 0 ] ) * exp( - 4.5282e+09 * pow2( phase ) );\n\t\txyz /= 1.0685e-7;\n\t\tvec3 rgb = XYZ_TO_REC709 * xyz;\n\t\treturn rgb;\n\t}\n\tvec3 evalIridescence( float outsideIOR, float eta2, float cosTheta1, float thinFilmThickness, vec3 baseF0 ) {\n\t\tvec3 I;\n\t\tfloat iridescenceIOR = mix( outsideIOR, eta2, smoothstep( 0.0, 0.03, thinFilmThickness ) );\n\t\tfloat sinTheta2Sq = pow2( outsideIOR / iridescenceIOR ) * ( 1.0 - pow2( cosTheta1 ) );\n\t\tfloat cosTheta2Sq = 1.0 - sinTheta2Sq;\n\t\tif ( cosTheta2Sq < 0.0 ) {\n\t\t\t return vec3( 1.0 );\n\t\t}\n\t\tfloat cosTheta2 = sqrt( cosTheta2Sq );\n\t\tfloat R0 = IorToFresnel0( iridescenceIOR, outsideIOR );\n\t\tfloat R12 = F_Schlick( R0, 1.0, cosTheta1 );\n\t\tfloat R21 = R12;\n\t\tfloat T121 = 1.0 - R12;\n\t\tfloat phi12 = 0.0;\n\t\tif ( iridescenceIOR < outsideIOR ) phi12 = PI;\n\t\tfloat phi21 = PI - phi12;\n\t\tvec3 baseIOR = Fresnel0ToIor( clamp( baseF0, 0.0, 0.9999 ) );\t\tvec3 R1 = IorToFresnel0( baseIOR, iridescenceIOR );\n\t\tvec3 R23 = F_Schlick( R1, 1.0, cosTheta2 );\n\t\tvec3 phi23 = vec3( 0.0 );\n\t\tif ( baseIOR[ 0 ] < iridescenceIOR ) phi23[ 0 ] = PI;\n\t\tif ( baseIOR[ 1 ] < iridescenceIOR ) phi23[ 1 ] = PI;\n\t\tif ( baseIOR[ 2 ] < iridescenceIOR ) phi23[ 2 ] = PI;\n\t\tfloat OPD = 2.0 * iridescenceIOR * thinFilmThickness * cosTheta2;\n\t\tvec3 phi = vec3( phi21 ) + phi23;\n\t\tvec3 R123 = clamp( R12 * R23, 1e-5, 0.9999 );\n\t\tvec3 r123 = sqrt( R123 );\n\t\tvec3 Rs = pow2( T121 ) * R23 / ( vec3( 1.0 ) - R123 );\n\t\tvec3 C0 = R12 + Rs;\n\t\tI = C0;\n\t\tvec3 Cm = Rs - T121;\n\t\tfor ( int m = 1; m <= 2; ++ m ) {\n\t\t\tCm *= r123;\n\t\t\tvec3 Sm = 2.0 * evalSensitivity( float( m ) * OPD, float( m ) * phi );\n\t\t\tI += Cm * Sm;\n\t\t}\n\t\treturn max( I, vec3( 0.0 ) );\n\t}\n#endif",bumpmap_pars_fragment:"#ifdef USE_BUMPMAP\n\tuniform sampler2D bumpMap;\n\tuniform float bumpScale;\n\tvec2 dHdxy_fwd() {\n\t\tvec2 dSTdx = dFdx( vUv );\n\t\tvec2 dSTdy = dFdy( vUv );\n\t\tfloat Hll = bumpScale * texture2D( bumpMap, vUv ).x;\n\t\tfloat dBx = bumpScale * texture2D( bumpMap, vUv + dSTdx ).x - Hll;\n\t\tfloat dBy = bumpScale * texture2D( bumpMap, vUv + dSTdy ).x - Hll;\n\t\treturn vec2( dBx, dBy );\n\t}\n\tvec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy, float faceDirection ) {\n\t\tvec3 vSigmaX = dFdx( surf_pos.xyz );\n\t\tvec3 vSigmaY = dFdy( surf_pos.xyz );\n\t\tvec3 vN = surf_norm;\n\t\tvec3 R1 = cross( vSigmaY, vN );\n\t\tvec3 R2 = cross( vN, vSigmaX );\n\t\tfloat fDet = dot( vSigmaX, R1 ) * faceDirection;\n\t\tvec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );\n\t\treturn normalize( abs( fDet ) * surf_norm - vGrad );\n\t}\n#endif",clipping_planes_fragment:"#if NUM_CLIPPING_PLANES > 0\n\tvec4 plane;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {\n\t\tplane = clippingPlanes[ i ];\n\t\tif ( dot( vClipPosition, plane.xyz ) > plane.w ) discard;\n\t}\n\t#pragma unroll_loop_end\n\t#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES\n\t\tbool clipped = true;\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {\n\t\t\tplane = clippingPlanes[ i ];\n\t\t\tclipped = ( dot( vClipPosition, plane.xyz ) > plane.w ) && clipped;\n\t\t}\n\t\t#pragma unroll_loop_end\n\t\tif ( clipped ) discard;\n\t#endif\n#endif",clipping_planes_pars_fragment:"#if NUM_CLIPPING_PLANES > 0\n\tvarying vec3 vClipPosition;\n\tuniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];\n#endif",clipping_planes_pars_vertex:"#if NUM_CLIPPING_PLANES > 0\n\tvarying vec3 vClipPosition;\n#endif",clipping_planes_vertex:"#if NUM_CLIPPING_PLANES > 0\n\tvClipPosition = - mvPosition.xyz;\n#endif",color_fragment:"#if defined( USE_COLOR_ALPHA )\n\tdiffuseColor *= vColor;\n#elif defined( USE_COLOR )\n\tdiffuseColor.rgb *= vColor;\n#endif",color_pars_fragment:"#if defined( USE_COLOR_ALPHA )\n\tvarying vec4 vColor;\n#elif defined( USE_COLOR )\n\tvarying vec3 vColor;\n#endif",color_pars_vertex:"#if defined( USE_COLOR_ALPHA )\n\tvarying vec4 vColor;\n#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )\n\tvarying vec3 vColor;\n#endif",color_vertex:"#if defined( USE_COLOR_ALPHA )\n\tvColor = vec4( 1.0 );\n#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )\n\tvColor = vec3( 1.0 );\n#endif\n#ifdef USE_COLOR\n\tvColor *= color;\n#endif\n#ifdef USE_INSTANCING_COLOR\n\tvColor.xyz *= instanceColor.xyz;\n#endif",common:"#define PI 3.141592653589793\n#define PI2 6.283185307179586\n#define PI_HALF 1.5707963267948966\n#define RECIPROCAL_PI 0.3183098861837907\n#define RECIPROCAL_PI2 0.15915494309189535\n#define EPSILON 1e-6\n#ifndef saturate\n#define saturate( a ) clamp( a, 0.0, 1.0 )\n#endif\n#define whiteComplement( a ) ( 1.0 - saturate( a ) )\nfloat pow2( const in float x ) { return x*x; }\nvec3 pow2( const in vec3 x ) { return x*x; }\nfloat pow3( const in float x ) { return x*x*x; }\nfloat pow4( const in float x ) { float x2 = x*x; return x2*x2; }\nfloat max3( const in vec3 v ) { return max( max( v.x, v.y ), v.z ); }\nfloat average( const in vec3 v ) { return dot( v, vec3( 0.3333333 ) ); }\nhighp float rand( const in vec2 uv ) {\n\tconst highp float a = 12.9898, b = 78.233, c = 43758.5453;\n\thighp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );\n\treturn fract( sin( sn ) * c );\n}\n#ifdef HIGH_PRECISION\n\tfloat precisionSafeLength( vec3 v ) { return length( v ); }\n#else\n\tfloat precisionSafeLength( vec3 v ) {\n\t\tfloat maxComponent = max3( abs( v ) );\n\t\treturn length( v / maxComponent ) * maxComponent;\n\t}\n#endif\nstruct IncidentLight {\n\tvec3 color;\n\tvec3 direction;\n\tbool visible;\n};\nstruct ReflectedLight {\n\tvec3 directDiffuse;\n\tvec3 directSpecular;\n\tvec3 indirectDiffuse;\n\tvec3 indirectSpecular;\n};\nstruct GeometricContext {\n\tvec3 position;\n\tvec3 normal;\n\tvec3 viewDir;\n#ifdef USE_CLEARCOAT\n\tvec3 clearcoatNormal;\n#endif\n};\nvec3 transformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );\n}\nvec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );\n}\nmat3 transposeMat3( const in mat3 m ) {\n\tmat3 tmp;\n\ttmp[ 0 ] = vec3( m[ 0 ].x, m[ 1 ].x, m[ 2 ].x );\n\ttmp[ 1 ] = vec3( m[ 0 ].y, m[ 1 ].y, m[ 2 ].y );\n\ttmp[ 2 ] = vec3( m[ 0 ].z, m[ 1 ].z, m[ 2 ].z );\n\treturn tmp;\n}\nfloat luminance( const in vec3 rgb ) {\n\tconst vec3 weights = vec3( 0.2126729, 0.7151522, 0.0721750 );\n\treturn dot( weights, rgb );\n}\nbool isPerspectiveMatrix( mat4 m ) {\n\treturn m[ 2 ][ 3 ] == - 1.0;\n}\nvec2 equirectUv( in vec3 dir ) {\n\tfloat u = atan( dir.z, dir.x ) * RECIPROCAL_PI2 + 0.5;\n\tfloat v = asin( clamp( dir.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;\n\treturn vec2( u, v );\n}",cube_uv_reflection_fragment:"#ifdef ENVMAP_TYPE_CUBE_UV\n\t#define cubeUV_minMipLevel 4.0\n\t#define cubeUV_minTileSize 16.0\n\tfloat getFace( vec3 direction ) {\n\t\tvec3 absDirection = abs( direction );\n\t\tfloat face = - 1.0;\n\t\tif ( absDirection.x > absDirection.z ) {\n\t\t\tif ( absDirection.x > absDirection.y )\n\t\t\t\tface = direction.x > 0.0 ? 0.0 : 3.0;\n\t\t\telse\n\t\t\t\tface = direction.y > 0.0 ? 1.0 : 4.0;\n\t\t} else {\n\t\t\tif ( absDirection.z > absDirection.y )\n\t\t\t\tface = direction.z > 0.0 ? 2.0 : 5.0;\n\t\t\telse\n\t\t\t\tface = direction.y > 0.0 ? 1.0 : 4.0;\n\t\t}\n\t\treturn face;\n\t}\n\tvec2 getUV( vec3 direction, float face ) {\n\t\tvec2 uv;\n\t\tif ( face == 0.0 ) {\n\t\t\tuv = vec2( direction.z, direction.y ) / abs( direction.x );\n\t\t} else if ( face == 1.0 ) {\n\t\t\tuv = vec2( - direction.x, - direction.z ) / abs( direction.y );\n\t\t} else if ( face == 2.0 ) {\n\t\t\tuv = vec2( - direction.x, direction.y ) / abs( direction.z );\n\t\t} else if ( face == 3.0 ) {\n\t\t\tuv = vec2( - direction.z, direction.y ) / abs( direction.x );\n\t\t} else if ( face == 4.0 ) {\n\t\t\tuv = vec2( - direction.x, direction.z ) / abs( direction.y );\n\t\t} else {\n\t\t\tuv = vec2( direction.x, direction.y ) / abs( direction.z );\n\t\t}\n\t\treturn 0.5 * ( uv + 1.0 );\n\t}\n\tvec3 bilinearCubeUV( sampler2D envMap, vec3 direction, float mipInt ) {\n\t\tfloat face = getFace( direction );\n\t\tfloat filterInt = max( cubeUV_minMipLevel - mipInt, 0.0 );\n\t\tmipInt = max( mipInt, cubeUV_minMipLevel );\n\t\tfloat faceSize = exp2( mipInt );\n\t\thighp vec2 uv = getUV( direction, face ) * ( faceSize - 2.0 ) + 1.0;\n\t\tif ( face > 2.0 ) {\n\t\t\tuv.y += faceSize;\n\t\t\tface -= 3.0;\n\t\t}\n\t\tuv.x += face * faceSize;\n\t\tuv.x += filterInt * 3.0 * cubeUV_minTileSize;\n\t\tuv.y += 4.0 * ( exp2( CUBEUV_MAX_MIP ) - faceSize );\n\t\tuv.x *= CUBEUV_TEXEL_WIDTH;\n\t\tuv.y *= CUBEUV_TEXEL_HEIGHT;\n\t\t#ifdef texture2DGradEXT\n\t\t\treturn texture2DGradEXT( envMap, uv, vec2( 0.0 ), vec2( 0.0 ) ).rgb;\n\t\t#else\n\t\t\treturn texture2D( envMap, uv ).rgb;\n\t\t#endif\n\t}\n\t#define cubeUV_r0 1.0\n\t#define cubeUV_v0 0.339\n\t#define cubeUV_m0 - 2.0\n\t#define cubeUV_r1 0.8\n\t#define cubeUV_v1 0.276\n\t#define cubeUV_m1 - 1.0\n\t#define cubeUV_r4 0.4\n\t#define cubeUV_v4 0.046\n\t#define cubeUV_m4 2.0\n\t#define cubeUV_r5 0.305\n\t#define cubeUV_v5 0.016\n\t#define cubeUV_m5 3.0\n\t#define cubeUV_r6 0.21\n\t#define cubeUV_v6 0.0038\n\t#define cubeUV_m6 4.0\n\tfloat roughnessToMip( float roughness ) {\n\t\tfloat mip = 0.0;\n\t\tif ( roughness >= cubeUV_r1 ) {\n\t\t\tmip = ( cubeUV_r0 - roughness ) * ( cubeUV_m1 - cubeUV_m0 ) / ( cubeUV_r0 - cubeUV_r1 ) + cubeUV_m0;\n\t\t} else if ( roughness >= cubeUV_r4 ) {\n\t\t\tmip = ( cubeUV_r1 - roughness ) * ( cubeUV_m4 - cubeUV_m1 ) / ( cubeUV_r1 - cubeUV_r4 ) + cubeUV_m1;\n\t\t} else if ( roughness >= cubeUV_r5 ) {\n\t\t\tmip = ( cubeUV_r4 - roughness ) * ( cubeUV_m5 - cubeUV_m4 ) / ( cubeUV_r4 - cubeUV_r5 ) + cubeUV_m4;\n\t\t} else if ( roughness >= cubeUV_r6 ) {\n\t\t\tmip = ( cubeUV_r5 - roughness ) * ( cubeUV_m6 - cubeUV_m5 ) / ( cubeUV_r5 - cubeUV_r6 ) + cubeUV_m5;\n\t\t} else {\n\t\t\tmip = - 2.0 * log2( 1.16 * roughness );\t\t}\n\t\treturn mip;\n\t}\n\tvec4 textureCubeUV( sampler2D envMap, vec3 sampleDir, float roughness ) {\n\t\tfloat mip = clamp( roughnessToMip( roughness ), cubeUV_m0, CUBEUV_MAX_MIP );\n\t\tfloat mipF = fract( mip );\n\t\tfloat mipInt = floor( mip );\n\t\tvec3 color0 = bilinearCubeUV( envMap, sampleDir, mipInt );\n\t\tif ( mipF == 0.0 ) {\n\t\t\treturn vec4( color0, 1.0 );\n\t\t} else {\n\t\t\tvec3 color1 = bilinearCubeUV( envMap, sampleDir, mipInt + 1.0 );\n\t\t\treturn vec4( mix( color0, color1, mipF ), 1.0 );\n\t\t}\n\t}\n#endif",defaultnormal_vertex:"vec3 transformedNormal = objectNormal;\n#ifdef USE_INSTANCING\n\tmat3 m = mat3( instanceMatrix );\n\ttransformedNormal /= vec3( dot( m[ 0 ], m[ 0 ] ), dot( m[ 1 ], m[ 1 ] ), dot( m[ 2 ], m[ 2 ] ) );\n\ttransformedNormal = m * transformedNormal;\n#endif\ntransformedNormal = normalMatrix * transformedNormal;\n#ifdef FLIP_SIDED\n\ttransformedNormal = - transformedNormal;\n#endif\n#ifdef USE_TANGENT\n\tvec3 transformedTangent = ( modelViewMatrix * vec4( objectTangent, 0.0 ) ).xyz;\n\t#ifdef FLIP_SIDED\n\t\ttransformedTangent = - transformedTangent;\n\t#endif\n#endif",displacementmap_pars_vertex:"#ifdef USE_DISPLACEMENTMAP\n\tuniform sampler2D displacementMap;\n\tuniform float displacementScale;\n\tuniform float displacementBias;\n#endif",displacementmap_vertex:"#ifdef USE_DISPLACEMENTMAP\n\ttransformed += normalize( objectNormal ) * ( texture2D( displacementMap, vUv ).x * displacementScale + displacementBias );\n#endif",emissivemap_fragment:"#ifdef USE_EMISSIVEMAP\n\tvec4 emissiveColor = texture2D( emissiveMap, vUv );\n\ttotalEmissiveRadiance *= emissiveColor.rgb;\n#endif",emissivemap_pars_fragment:"#ifdef USE_EMISSIVEMAP\n\tuniform sampler2D emissiveMap;\n#endif",encodings_fragment:"gl_FragColor = linearToOutputTexel( gl_FragColor );",encodings_pars_fragment:"vec4 LinearToLinear( in vec4 value ) {\n\treturn value;\n}\nvec4 LinearTosRGB( in vec4 value ) {\n\treturn vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.a );\n}",envmap_fragment:"#ifdef USE_ENVMAP\n\t#ifdef ENV_WORLDPOS\n\t\tvec3 cameraToFrag;\n\t\tif ( isOrthographic ) {\n\t\t\tcameraToFrag = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );\n\t\t} else {\n\t\t\tcameraToFrag = normalize( vWorldPosition - cameraPosition );\n\t\t}\n\t\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvec3 reflectVec = reflect( cameraToFrag, worldNormal );\n\t\t#else\n\t\t\tvec3 reflectVec = refract( cameraToFrag, worldNormal, refractionRatio );\n\t\t#endif\n\t#else\n\t\tvec3 reflectVec = vReflect;\n\t#endif\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tvec4 envColor = textureCube( envMap, vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );\n\t#else\n\t\tvec4 envColor = vec4( 0.0 );\n\t#endif\n\t#ifdef ENVMAP_BLENDING_MULTIPLY\n\t\toutgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_MIX )\n\t\toutgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_ADD )\n\t\toutgoingLight += envColor.xyz * specularStrength * reflectivity;\n\t#endif\n#endif",envmap_common_pars_fragment:"#ifdef USE_ENVMAP\n\tuniform float envMapIntensity;\n\tuniform float flipEnvMap;\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tuniform samplerCube envMap;\n\t#else\n\t\tuniform sampler2D envMap;\n\t#endif\n\t\n#endif",envmap_pars_fragment:"#ifdef USE_ENVMAP\n\tuniform float reflectivity;\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )\n\t\t#define ENV_WORLDPOS\n\t#endif\n\t#ifdef ENV_WORLDPOS\n\t\tvarying vec3 vWorldPosition;\n\t\tuniform float refractionRatio;\n\t#else\n\t\tvarying vec3 vReflect;\n\t#endif\n#endif",envmap_pars_vertex:"#ifdef USE_ENVMAP\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )\n\t\t#define ENV_WORLDPOS\n\t#endif\n\t#ifdef ENV_WORLDPOS\n\t\t\n\t\tvarying vec3 vWorldPosition;\n\t#else\n\t\tvarying vec3 vReflect;\n\t\tuniform float refractionRatio;\n\t#endif\n#endif",envmap_physical_pars_fragment:"#if defined( USE_ENVMAP )\n\tvec3 getIBLIrradiance( const in vec3 normal ) {\n\t\t#if defined( ENVMAP_TYPE_CUBE_UV )\n\t\t\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\t\t\tvec4 envMapColor = textureCubeUV( envMap, worldNormal, 1.0 );\n\t\t\treturn PI * envMapColor.rgb * envMapIntensity;\n\t\t#else\n\t\t\treturn vec3( 0.0 );\n\t\t#endif\n\t}\n\tvec3 getIBLRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness ) {\n\t\t#if defined( ENVMAP_TYPE_CUBE_UV )\n\t\t\tvec3 reflectVec = reflect( - viewDir, normal );\n\t\t\treflectVec = normalize( mix( reflectVec, normal, roughness * roughness) );\n\t\t\treflectVec = inverseTransformDirection( reflectVec, viewMatrix );\n\t\t\tvec4 envMapColor = textureCubeUV( envMap, reflectVec, roughness );\n\t\t\treturn envMapColor.rgb * envMapIntensity;\n\t\t#else\n\t\t\treturn vec3( 0.0 );\n\t\t#endif\n\t}\n#endif",envmap_vertex:"#ifdef USE_ENVMAP\n\t#ifdef ENV_WORLDPOS\n\t\tvWorldPosition = worldPosition.xyz;\n\t#else\n\t\tvec3 cameraToVertex;\n\t\tif ( isOrthographic ) {\n\t\t\tcameraToVertex = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );\n\t\t} else {\n\t\t\tcameraToVertex = normalize( worldPosition.xyz - cameraPosition );\n\t\t}\n\t\tvec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvReflect = reflect( cameraToVertex, worldNormal );\n\t\t#else\n\t\t\tvReflect = refract( cameraToVertex, worldNormal, refractionRatio );\n\t\t#endif\n\t#endif\n#endif",fog_vertex:"#ifdef USE_FOG\n\tvFogDepth = - mvPosition.z;\n#endif",fog_pars_vertex:"#ifdef USE_FOG\n\tvarying float vFogDepth;\n#endif",fog_fragment:"#ifdef USE_FOG\n\t#ifdef FOG_EXP2\n\t\tfloat fogFactor = 1.0 - exp( - fogDensity * fogDensity * vFogDepth * vFogDepth );\n\t#else\n\t\tfloat fogFactor = smoothstep( fogNear, fogFar, vFogDepth );\n\t#endif\n\tgl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );\n#endif",fog_pars_fragment:"#ifdef USE_FOG\n\tuniform vec3 fogColor;\n\tvarying float vFogDepth;\n\t#ifdef FOG_EXP2\n\t\tuniform float fogDensity;\n\t#else\n\t\tuniform float fogNear;\n\t\tuniform float fogFar;\n\t#endif\n#endif",gradientmap_pars_fragment:"#ifdef USE_GRADIENTMAP\n\tuniform sampler2D gradientMap;\n#endif\nvec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {\n\tfloat dotNL = dot( normal, lightDirection );\n\tvec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );\n\t#ifdef USE_GRADIENTMAP\n\t\treturn vec3( texture2D( gradientMap, coord ).r );\n\t#else\n\t\tvec2 fw = fwidth( coord ) * 0.5;\n\t\treturn mix( vec3( 0.7 ), vec3( 1.0 ), smoothstep( 0.7 - fw.x, 0.7 + fw.x, coord.x ) );\n\t#endif\n}",lightmap_fragment:"#ifdef USE_LIGHTMAP\n\tvec4 lightMapTexel = texture2D( lightMap, vUv2 );\n\tvec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;\n\treflectedLight.indirectDiffuse += lightMapIrradiance;\n#endif",lightmap_pars_fragment:"#ifdef USE_LIGHTMAP\n\tuniform sampler2D lightMap;\n\tuniform float lightMapIntensity;\n#endif",lights_lambert_fragment:"LambertMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;\nmaterial.specularStrength = specularStrength;",lights_lambert_pars_fragment:"varying vec3 vViewPosition;\nstruct LambertMaterial {\n\tvec3 diffuseColor;\n\tfloat specularStrength;\n};\nvoid RE_Direct_Lambert( const in IncidentLight directLight, const in GeometricContext geometry, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometry.normal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectDiffuse_Lambert( const in vec3 irradiance, const in GeometricContext geometry, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_Lambert\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Lambert",lights_pars_begin:"uniform bool receiveShadow;\nuniform vec3 ambientLightColor;\nuniform vec3 lightProbe[ 9 ];\nvec3 shGetIrradianceAt( in vec3 normal, in vec3 shCoefficients[ 9 ] ) {\n\tfloat x = normal.x, y = normal.y, z = normal.z;\n\tvec3 result = shCoefficients[ 0 ] * 0.886227;\n\tresult += shCoefficients[ 1 ] * 2.0 * 0.511664 * y;\n\tresult += shCoefficients[ 2 ] * 2.0 * 0.511664 * z;\n\tresult += shCoefficients[ 3 ] * 2.0 * 0.511664 * x;\n\tresult += shCoefficients[ 4 ] * 2.0 * 0.429043 * x * y;\n\tresult += shCoefficients[ 5 ] * 2.0 * 0.429043 * y * z;\n\tresult += shCoefficients[ 6 ] * ( 0.743125 * z * z - 0.247708 );\n\tresult += shCoefficients[ 7 ] * 2.0 * 0.429043 * x * z;\n\tresult += shCoefficients[ 8 ] * 0.429043 * ( x * x - y * y );\n\treturn result;\n}\nvec3 getLightProbeIrradiance( const in vec3 lightProbe[ 9 ], const in vec3 normal ) {\n\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\tvec3 irradiance = shGetIrradianceAt( worldNormal, lightProbe );\n\treturn irradiance;\n}\nvec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {\n\tvec3 irradiance = ambientLightColor;\n\treturn irradiance;\n}\nfloat getDistanceAttenuation( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {\n\t#if defined ( LEGACY_LIGHTS )\n\t\tif ( cutoffDistance > 0.0 && decayExponent > 0.0 ) {\n\t\t\treturn pow( saturate( - lightDistance / cutoffDistance + 1.0 ), decayExponent );\n\t\t}\n\t\treturn 1.0;\n\t#else\n\t\tfloat distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );\n\t\tif ( cutoffDistance > 0.0 ) {\n\t\t\tdistanceFalloff *= pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );\n\t\t}\n\t\treturn distanceFalloff;\n\t#endif\n}\nfloat getSpotAttenuation( const in float coneCosine, const in float penumbraCosine, const in float angleCosine ) {\n\treturn smoothstep( coneCosine, penumbraCosine, angleCosine );\n}\n#if NUM_DIR_LIGHTS > 0\n\tstruct DirectionalLight {\n\t\tvec3 direction;\n\t\tvec3 color;\n\t};\n\tuniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];\n\tvoid getDirectionalLightInfo( const in DirectionalLight directionalLight, const in GeometricContext geometry, out IncidentLight light ) {\n\t\tlight.color = directionalLight.color;\n\t\tlight.direction = directionalLight.direction;\n\t\tlight.visible = true;\n\t}\n#endif\n#if NUM_POINT_LIGHTS > 0\n\tstruct PointLight {\n\t\tvec3 position;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t};\n\tuniform PointLight pointLights[ NUM_POINT_LIGHTS ];\n\tvoid getPointLightInfo( const in PointLight pointLight, const in GeometricContext geometry, out IncidentLight light ) {\n\t\tvec3 lVector = pointLight.position - geometry.position;\n\t\tlight.direction = normalize( lVector );\n\t\tfloat lightDistance = length( lVector );\n\t\tlight.color = pointLight.color;\n\t\tlight.color *= getDistanceAttenuation( lightDistance, pointLight.distance, pointLight.decay );\n\t\tlight.visible = ( light.color != vec3( 0.0 ) );\n\t}\n#endif\n#if NUM_SPOT_LIGHTS > 0\n\tstruct SpotLight {\n\t\tvec3 position;\n\t\tvec3 direction;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t\tfloat coneCos;\n\t\tfloat penumbraCos;\n\t};\n\tuniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];\n\tvoid getSpotLightInfo( const in SpotLight spotLight, const in GeometricContext geometry, out IncidentLight light ) {\n\t\tvec3 lVector = spotLight.position - geometry.position;\n\t\tlight.direction = normalize( lVector );\n\t\tfloat angleCos = dot( light.direction, spotLight.direction );\n\t\tfloat spotAttenuation = getSpotAttenuation( spotLight.coneCos, spotLight.penumbraCos, angleCos );\n\t\tif ( spotAttenuation > 0.0 ) {\n\t\t\tfloat lightDistance = length( lVector );\n\t\t\tlight.color = spotLight.color * spotAttenuation;\n\t\t\tlight.color *= getDistanceAttenuation( lightDistance, spotLight.distance, spotLight.decay );\n\t\t\tlight.visible = ( light.color != vec3( 0.0 ) );\n\t\t} else {\n\t\t\tlight.color = vec3( 0.0 );\n\t\t\tlight.visible = false;\n\t\t}\n\t}\n#endif\n#if NUM_RECT_AREA_LIGHTS > 0\n\tstruct RectAreaLight {\n\t\tvec3 color;\n\t\tvec3 position;\n\t\tvec3 halfWidth;\n\t\tvec3 halfHeight;\n\t};\n\tuniform sampler2D ltc_1;\tuniform sampler2D ltc_2;\n\tuniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];\n#endif\n#if NUM_HEMI_LIGHTS > 0\n\tstruct HemisphereLight {\n\t\tvec3 direction;\n\t\tvec3 skyColor;\n\t\tvec3 groundColor;\n\t};\n\tuniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];\n\tvec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in vec3 normal ) {\n\t\tfloat dotNL = dot( normal, hemiLight.direction );\n\t\tfloat hemiDiffuseWeight = 0.5 * dotNL + 0.5;\n\t\tvec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );\n\t\treturn irradiance;\n\t}\n#endif",lights_toon_fragment:"ToonMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;",lights_toon_pars_fragment:"varying vec3 vViewPosition;\nstruct ToonMaterial {\n\tvec3 diffuseColor;\n};\nvoid RE_Direct_Toon( const in IncidentLight directLight, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {\n\tvec3 irradiance = getGradientIrradiance( geometry.normal, directLight.direction ) * directLight.color;\n\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectDiffuse_Toon( const in vec3 irradiance, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_Toon\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Toon",lights_phong_fragment:"BlinnPhongMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;\nmaterial.specularColor = specular;\nmaterial.specularShininess = shininess;\nmaterial.specularStrength = specularStrength;",lights_phong_pars_fragment:"varying vec3 vViewPosition;\nstruct BlinnPhongMaterial {\n\tvec3 diffuseColor;\n\tvec3 specularColor;\n\tfloat specularShininess;\n\tfloat specularStrength;\n};\nvoid RE_Direct_BlinnPhong( const in IncidentLight directLight, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometry.normal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n\treflectedLight.directSpecular += irradiance * BRDF_BlinnPhong( directLight.direction, geometry.viewDir, geometry.normal, material.specularColor, material.specularShininess ) * material.specularStrength;\n}\nvoid RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_BlinnPhong\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_BlinnPhong",lights_physical_fragment:"PhysicalMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );\nvec3 dxy = max( abs( dFdx( geometryNormal ) ), abs( dFdy( geometryNormal ) ) );\nfloat geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );\nmaterial.roughness = max( roughnessFactor, 0.0525 );material.roughness += geometryRoughness;\nmaterial.roughness = min( material.roughness, 1.0 );\n#ifdef IOR\n\tmaterial.ior = ior;\n\t#ifdef SPECULAR\n\t\tfloat specularIntensityFactor = specularIntensity;\n\t\tvec3 specularColorFactor = specularColor;\n\t\t#ifdef USE_SPECULARINTENSITYMAP\n\t\t\tspecularIntensityFactor *= texture2D( specularIntensityMap, vUv ).a;\n\t\t#endif\n\t\t#ifdef USE_SPECULARCOLORMAP\n\t\t\tspecularColorFactor *= texture2D( specularColorMap, vUv ).rgb;\n\t\t#endif\n\t\tmaterial.specularF90 = mix( specularIntensityFactor, 1.0, metalnessFactor );\n\t#else\n\t\tfloat specularIntensityFactor = 1.0;\n\t\tvec3 specularColorFactor = vec3( 1.0 );\n\t\tmaterial.specularF90 = 1.0;\n\t#endif\n\tmaterial.specularColor = mix( min( pow2( ( material.ior - 1.0 ) / ( material.ior + 1.0 ) ) * specularColorFactor, vec3( 1.0 ) ) * specularIntensityFactor, diffuseColor.rgb, metalnessFactor );\n#else\n\tmaterial.specularColor = mix( vec3( 0.04 ), diffuseColor.rgb, metalnessFactor );\n\tmaterial.specularF90 = 1.0;\n#endif\n#ifdef USE_CLEARCOAT\n\tmaterial.clearcoat = clearcoat;\n\tmaterial.clearcoatRoughness = clearcoatRoughness;\n\tmaterial.clearcoatF0 = vec3( 0.04 );\n\tmaterial.clearcoatF90 = 1.0;\n\t#ifdef USE_CLEARCOATMAP\n\t\tmaterial.clearcoat *= texture2D( clearcoatMap, vUv ).x;\n\t#endif\n\t#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\t\tmaterial.clearcoatRoughness *= texture2D( clearcoatRoughnessMap, vUv ).y;\n\t#endif\n\tmaterial.clearcoat = saturate( material.clearcoat );\tmaterial.clearcoatRoughness = max( material.clearcoatRoughness, 0.0525 );\n\tmaterial.clearcoatRoughness += geometryRoughness;\n\tmaterial.clearcoatRoughness = min( material.clearcoatRoughness, 1.0 );\n#endif\n#ifdef USE_IRIDESCENCE\n\tmaterial.iridescence = iridescence;\n\tmaterial.iridescenceIOR = iridescenceIOR;\n\t#ifdef USE_IRIDESCENCEMAP\n\t\tmaterial.iridescence *= texture2D( iridescenceMap, vUv ).r;\n\t#endif\n\t#ifdef USE_IRIDESCENCE_THICKNESSMAP\n\t\tmaterial.iridescenceThickness = (iridescenceThicknessMaximum - iridescenceThicknessMinimum) * texture2D( iridescenceThicknessMap, vUv ).g + iridescenceThicknessMinimum;\n\t#else\n\t\tmaterial.iridescenceThickness = iridescenceThicknessMaximum;\n\t#endif\n#endif\n#ifdef USE_SHEEN\n\tmaterial.sheenColor = sheenColor;\n\t#ifdef USE_SHEENCOLORMAP\n\t\tmaterial.sheenColor *= texture2D( sheenColorMap, vUv ).rgb;\n\t#endif\n\tmaterial.sheenRoughness = clamp( sheenRoughness, 0.07, 1.0 );\n\t#ifdef USE_SHEENROUGHNESSMAP\n\t\tmaterial.sheenRoughness *= texture2D( sheenRoughnessMap, vUv ).a;\n\t#endif\n#endif",lights_physical_pars_fragment:"struct PhysicalMaterial {\n\tvec3 diffuseColor;\n\tfloat roughness;\n\tvec3 specularColor;\n\tfloat specularF90;\n\t#ifdef USE_CLEARCOAT\n\t\tfloat clearcoat;\n\t\tfloat clearcoatRoughness;\n\t\tvec3 clearcoatF0;\n\t\tfloat clearcoatF90;\n\t#endif\n\t#ifdef USE_IRIDESCENCE\n\t\tfloat iridescence;\n\t\tfloat iridescenceIOR;\n\t\tfloat iridescenceThickness;\n\t\tvec3 iridescenceFresnel;\n\t\tvec3 iridescenceF0;\n\t#endif\n\t#ifdef USE_SHEEN\n\t\tvec3 sheenColor;\n\t\tfloat sheenRoughness;\n\t#endif\n\t#ifdef IOR\n\t\tfloat ior;\n\t#endif\n\t#ifdef USE_TRANSMISSION\n\t\tfloat transmission;\n\t\tfloat transmissionAlpha;\n\t\tfloat thickness;\n\t\tfloat attenuationDistance;\n\t\tvec3 attenuationColor;\n\t#endif\n};\nvec3 clearcoatSpecular = vec3( 0.0 );\nvec3 sheenSpecular = vec3( 0.0 );\nfloat IBLSheenBRDF( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tfloat r2 = roughness * roughness;\n\tfloat a = roughness < 0.25 ? -339.2 * r2 + 161.4 * roughness - 25.9 : -8.48 * r2 + 14.3 * roughness - 9.95;\n\tfloat b = roughness < 0.25 ? 44.0 * r2 - 23.7 * roughness + 3.26 : 1.97 * r2 - 3.27 * roughness + 0.72;\n\tfloat DG = exp( a * dotNV + b ) + ( roughness < 0.25 ? 0.0 : 0.1 * ( roughness - 0.25 ) );\n\treturn saturate( DG * RECIPROCAL_PI );\n}\nvec2 DFGApprox( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tconst vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );\n\tconst vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );\n\tvec4 r = roughness * c0 + c1;\n\tfloat a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;\n\tvec2 fab = vec2( - 1.04, 1.04 ) * a004 + r.zw;\n\treturn fab;\n}\nvec3 EnvironmentBRDF( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness ) {\n\tvec2 fab = DFGApprox( normal, viewDir, roughness );\n\treturn specularColor * fab.x + specularF90 * fab.y;\n}\n#ifdef USE_IRIDESCENCE\nvoid computeMultiscatteringIridescence( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float iridescence, const in vec3 iridescenceF0, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {\n#else\nvoid computeMultiscattering( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {\n#endif\n\tvec2 fab = DFGApprox( normal, viewDir, roughness );\n\t#ifdef USE_IRIDESCENCE\n\t\tvec3 Fr = mix( specularColor, iridescenceF0, iridescence );\n\t#else\n\t\tvec3 Fr = specularColor;\n\t#endif\n\tvec3 FssEss = Fr * fab.x + specularF90 * fab.y;\n\tfloat Ess = fab.x + fab.y;\n\tfloat Ems = 1.0 - Ess;\n\tvec3 Favg = Fr + ( 1.0 - Fr ) * 0.047619;\tvec3 Fms = FssEss * Favg / ( 1.0 - Ems * Favg );\n\tsingleScatter += FssEss;\n\tmultiScatter += Fms * Ems;\n}\n#if NUM_RECT_AREA_LIGHTS > 0\n\tvoid RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\t\tvec3 normal = geometry.normal;\n\t\tvec3 viewDir = geometry.viewDir;\n\t\tvec3 position = geometry.position;\n\t\tvec3 lightPos = rectAreaLight.position;\n\t\tvec3 halfWidth = rectAreaLight.halfWidth;\n\t\tvec3 halfHeight = rectAreaLight.halfHeight;\n\t\tvec3 lightColor = rectAreaLight.color;\n\t\tfloat roughness = material.roughness;\n\t\tvec3 rectCoords[ 4 ];\n\t\trectCoords[ 0 ] = lightPos + halfWidth - halfHeight;\t\trectCoords[ 1 ] = lightPos - halfWidth - halfHeight;\n\t\trectCoords[ 2 ] = lightPos - halfWidth + halfHeight;\n\t\trectCoords[ 3 ] = lightPos + halfWidth + halfHeight;\n\t\tvec2 uv = LTC_Uv( normal, viewDir, roughness );\n\t\tvec4 t1 = texture2D( ltc_1, uv );\n\t\tvec4 t2 = texture2D( ltc_2, uv );\n\t\tmat3 mInv = mat3(\n\t\t\tvec3( t1.x, 0, t1.y ),\n\t\t\tvec3(    0, 1,    0 ),\n\t\t\tvec3( t1.z, 0, t1.w )\n\t\t);\n\t\tvec3 fresnel = ( material.specularColor * t2.x + ( vec3( 1.0 ) - material.specularColor ) * t2.y );\n\t\treflectedLight.directSpecular += lightColor * fresnel * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );\n\t\treflectedLight.directDiffuse += lightColor * material.diffuseColor * LTC_Evaluate( normal, viewDir, position, mat3( 1.0 ), rectCoords );\n\t}\n#endif\nvoid RE_Direct_Physical( const in IncidentLight directLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometry.normal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\t#ifdef USE_CLEARCOAT\n\t\tfloat dotNLcc = saturate( dot( geometry.clearcoatNormal, directLight.direction ) );\n\t\tvec3 ccIrradiance = dotNLcc * directLight.color;\n\t\tclearcoatSpecular += ccIrradiance * BRDF_GGX( directLight.direction, geometry.viewDir, geometry.clearcoatNormal, material.clearcoatF0, material.clearcoatF90, material.clearcoatRoughness );\n\t#endif\n\t#ifdef USE_SHEEN\n\t\tsheenSpecular += irradiance * BRDF_Sheen( directLight.direction, geometry.viewDir, geometry.normal, material.sheenColor, material.sheenRoughness );\n\t#endif\n\t#ifdef USE_IRIDESCENCE\n\t\treflectedLight.directSpecular += irradiance * BRDF_GGX_Iridescence( directLight.direction, geometry.viewDir, geometry.normal, material.specularColor, material.specularF90, material.iridescence, material.iridescenceFresnel, material.roughness );\n\t#else\n\t\treflectedLight.directSpecular += irradiance * BRDF_GGX( directLight.direction, geometry.viewDir, geometry.normal, material.specularColor, material.specularF90, material.roughness );\n\t#endif\n\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 irradiance, const in vec3 clearcoatRadiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight) {\n\t#ifdef USE_CLEARCOAT\n\t\tclearcoatSpecular += clearcoatRadiance * EnvironmentBRDF( geometry.clearcoatNormal, geometry.viewDir, material.clearcoatF0, material.clearcoatF90, material.clearcoatRoughness );\n\t#endif\n\t#ifdef USE_SHEEN\n\t\tsheenSpecular += irradiance * material.sheenColor * IBLSheenBRDF( geometry.normal, geometry.viewDir, material.sheenRoughness );\n\t#endif\n\tvec3 singleScattering = vec3( 0.0 );\n\tvec3 multiScattering = vec3( 0.0 );\n\tvec3 cosineWeightedIrradiance = irradiance * RECIPROCAL_PI;\n\t#ifdef USE_IRIDESCENCE\n\t\tcomputeMultiscatteringIridescence( geometry.normal, geometry.viewDir, material.specularColor, material.specularF90, material.iridescence, material.iridescenceFresnel, material.roughness, singleScattering, multiScattering );\n\t#else\n\t\tcomputeMultiscattering( geometry.normal, geometry.viewDir, material.specularColor, material.specularF90, material.roughness, singleScattering, multiScattering );\n\t#endif\n\tvec3 totalScattering = singleScattering + multiScattering;\n\tvec3 diffuse = material.diffuseColor * ( 1.0 - max( max( totalScattering.r, totalScattering.g ), totalScattering.b ) );\n\treflectedLight.indirectSpecular += radiance * singleScattering;\n\treflectedLight.indirectSpecular += multiScattering * cosineWeightedIrradiance;\n\treflectedLight.indirectDiffuse += diffuse * cosineWeightedIrradiance;\n}\n#define RE_Direct\t\t\t\tRE_Direct_Physical\n#define RE_Direct_RectArea\t\tRE_Direct_RectArea_Physical\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Physical\n#define RE_IndirectSpecular\t\tRE_IndirectSpecular_Physical\nfloat computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {\n\treturn saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );\n}",lights_fragment_begin:"\nGeometricContext geometry;\ngeometry.position = - vViewPosition;\ngeometry.normal = normal;\ngeometry.viewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( vViewPosition );\n#ifdef USE_CLEARCOAT\n\tgeometry.clearcoatNormal = clearcoatNormal;\n#endif\n#ifdef USE_IRIDESCENCE\n\tfloat dotNVi = saturate( dot( normal, geometry.viewDir ) );\n\tif ( material.iridescenceThickness == 0.0 ) {\n\t\tmaterial.iridescence = 0.0;\n\t} else {\n\t\tmaterial.iridescence = saturate( material.iridescence );\n\t}\n\tif ( material.iridescence > 0.0 ) {\n\t\tmaterial.iridescenceFresnel = evalIridescence( 1.0, material.iridescenceIOR, dotNVi, material.iridescenceThickness, material.specularColor );\n\t\tmaterial.iridescenceF0 = Schlick_to_F0( material.iridescenceFresnel, 1.0, dotNVi );\n\t}\n#endif\nIncidentLight directLight;\n#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )\n\tPointLight pointLight;\n\t#if defined( USE_SHADOWMAP ) && NUM_POINT_LIGHT_SHADOWS > 0\n\tPointLightShadow pointLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tpointLight = pointLights[ i ];\n\t\tgetPointLightInfo( pointLight, geometry, directLight );\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_POINT_LIGHT_SHADOWS )\n\t\tpointLightShadow = pointLightShadows[ i ];\n\t\tdirectLight.color *= ( directLight.visible && receiveShadow ) ? getPointShadow( pointShadowMap[ i ], pointLightShadow.shadowMapSize, pointLightShadow.shadowBias, pointLightShadow.shadowRadius, vPointShadowCoord[ i ], pointLightShadow.shadowCameraNear, pointLightShadow.shadowCameraFar ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )\n\tSpotLight spotLight;\n\tvec4 spotColor;\n\tvec3 spotLightCoord;\n\tbool inSpotLightMap;\n\t#if defined( USE_SHADOWMAP ) && NUM_SPOT_LIGHT_SHADOWS > 0\n\tSpotLightShadow spotLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tspotLight = spotLights[ i ];\n\t\tgetSpotLightInfo( spotLight, geometry, directLight );\n\t\t#if ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )\n\t\t#define SPOT_LIGHT_MAP_INDEX UNROLLED_LOOP_INDEX\n\t\t#elif ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )\n\t\t#define SPOT_LIGHT_MAP_INDEX NUM_SPOT_LIGHT_MAPS\n\t\t#else\n\t\t#define SPOT_LIGHT_MAP_INDEX ( UNROLLED_LOOP_INDEX - NUM_SPOT_LIGHT_SHADOWS + NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )\n\t\t#endif\n\t\t#if ( SPOT_LIGHT_MAP_INDEX < NUM_SPOT_LIGHT_MAPS )\n\t\t\tspotLightCoord = vSpotLightCoord[ i ].xyz / vSpotLightCoord[ i ].w;\n\t\t\tinSpotLightMap = all( lessThan( abs( spotLightCoord * 2. - 1. ), vec3( 1.0 ) ) );\n\t\t\tspotColor = texture2D( spotLightMap[ SPOT_LIGHT_MAP_INDEX ], spotLightCoord.xy );\n\t\t\tdirectLight.color = inSpotLightMap ? directLight.color * spotColor.rgb : directLight.color;\n\t\t#endif\n\t\t#undef SPOT_LIGHT_MAP_INDEX\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )\n\t\tspotLightShadow = spotLightShadows[ i ];\n\t\tdirectLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( spotShadowMap[ i ], spotLightShadow.shadowMapSize, spotLightShadow.shadowBias, spotLightShadow.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )\n\tDirectionalLight directionalLight;\n\t#if defined( USE_SHADOWMAP ) && NUM_DIR_LIGHT_SHADOWS > 0\n\tDirectionalLightShadow directionalLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tdirectionalLight = directionalLights[ i ];\n\t\tgetDirectionalLightInfo( directionalLight, geometry, directLight );\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_DIR_LIGHT_SHADOWS )\n\t\tdirectionalLightShadow = directionalLightShadows[ i ];\n\t\tdirectLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( directionalShadowMap[ i ], directionalLightShadow.shadowMapSize, directionalLightShadow.shadowBias, directionalLightShadow.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )\n\tRectAreaLight rectAreaLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {\n\t\trectAreaLight = rectAreaLights[ i ];\n\t\tRE_Direct_RectArea( rectAreaLight, geometry, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if defined( RE_IndirectDiffuse )\n\tvec3 iblIrradiance = vec3( 0.0 );\n\tvec3 irradiance = getAmbientLightIrradiance( ambientLightColor );\n\tirradiance += getLightProbeIrradiance( lightProbe, geometry.normal );\n\t#if ( NUM_HEMI_LIGHTS > 0 )\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {\n\t\t\tirradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry.normal );\n\t\t}\n\t\t#pragma unroll_loop_end\n\t#endif\n#endif\n#if defined( RE_IndirectSpecular )\n\tvec3 radiance = vec3( 0.0 );\n\tvec3 clearcoatRadiance = vec3( 0.0 );\n#endif",lights_fragment_maps:"#if defined( RE_IndirectDiffuse )\n\t#ifdef USE_LIGHTMAP\n\t\tvec4 lightMapTexel = texture2D( lightMap, vUv2 );\n\t\tvec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;\n\t\tirradiance += lightMapIrradiance;\n\t#endif\n\t#if defined( USE_ENVMAP ) && defined( STANDARD ) && defined( ENVMAP_TYPE_CUBE_UV )\n\t\tiblIrradiance += getIBLIrradiance( geometry.normal );\n\t#endif\n#endif\n#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )\n\tradiance += getIBLRadiance( geometry.viewDir, geometry.normal, material.roughness );\n\t#ifdef USE_CLEARCOAT\n\t\tclearcoatRadiance += getIBLRadiance( geometry.viewDir, geometry.clearcoatNormal, material.clearcoatRoughness );\n\t#endif\n#endif",lights_fragment_end:"#if defined( RE_IndirectDiffuse )\n\tRE_IndirectDiffuse( irradiance, geometry, material, reflectedLight );\n#endif\n#if defined( RE_IndirectSpecular )\n\tRE_IndirectSpecular( radiance, iblIrradiance, clearcoatRadiance, geometry, material, reflectedLight );\n#endif",logdepthbuf_fragment:"#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )\n\tgl_FragDepthEXT = vIsPerspective == 0.0 ? gl_FragCoord.z : log2( vFragDepth ) * logDepthBufFC * 0.5;\n#endif",logdepthbuf_pars_fragment:"#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )\n\tuniform float logDepthBufFC;\n\tvarying float vFragDepth;\n\tvarying float vIsPerspective;\n#endif",logdepthbuf_pars_vertex:"#ifdef USE_LOGDEPTHBUF\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tvarying float vFragDepth;\n\t\tvarying float vIsPerspective;\n\t#else\n\t\tuniform float logDepthBufFC;\n\t#endif\n#endif",logdepthbuf_vertex:"#ifdef USE_LOGDEPTHBUF\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tvFragDepth = 1.0 + gl_Position.w;\n\t\tvIsPerspective = float( isPerspectiveMatrix( projectionMatrix ) );\n\t#else\n\t\tif ( isPerspectiveMatrix( projectionMatrix ) ) {\n\t\t\tgl_Position.z = log2( max( EPSILON, gl_Position.w + 1.0 ) ) * logDepthBufFC - 1.0;\n\t\t\tgl_Position.z *= gl_Position.w;\n\t\t}\n\t#endif\n#endif",map_fragment:"#ifdef USE_MAP\n\tvec4 sampledDiffuseColor = texture2D( map, vUv );\n\t#ifdef DECODE_VIDEO_TEXTURE\n\t\tsampledDiffuseColor = vec4( mix( pow( sampledDiffuseColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), sampledDiffuseColor.rgb * 0.0773993808, vec3( lessThanEqual( sampledDiffuseColor.rgb, vec3( 0.04045 ) ) ) ), sampledDiffuseColor.w );\n\t#endif\n\tdiffuseColor *= sampledDiffuseColor;\n#endif",map_pars_fragment:"#ifdef USE_MAP\n\tuniform sampler2D map;\n#endif",map_particle_fragment:"#if defined( USE_MAP ) || defined( USE_ALPHAMAP )\n\tvec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;\n#endif\n#ifdef USE_MAP\n\tdiffuseColor *= texture2D( map, uv );\n#endif\n#ifdef USE_ALPHAMAP\n\tdiffuseColor.a *= texture2D( alphaMap, uv ).g;\n#endif",map_particle_pars_fragment:"#if defined( USE_MAP ) || defined( USE_ALPHAMAP )\n\tuniform mat3 uvTransform;\n#endif\n#ifdef USE_MAP\n\tuniform sampler2D map;\n#endif\n#ifdef USE_ALPHAMAP\n\tuniform sampler2D alphaMap;\n#endif",metalnessmap_fragment:"float metalnessFactor = metalness;\n#ifdef USE_METALNESSMAP\n\tvec4 texelMetalness = texture2D( metalnessMap, vUv );\n\tmetalnessFactor *= texelMetalness.b;\n#endif",metalnessmap_pars_fragment:"#ifdef USE_METALNESSMAP\n\tuniform sampler2D metalnessMap;\n#endif",morphcolor_vertex:"#if defined( USE_MORPHCOLORS ) && defined( MORPHTARGETS_TEXTURE )\n\tvColor *= morphTargetBaseInfluence;\n\tfor ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {\n\t\t#if defined( USE_COLOR_ALPHA )\n\t\t\tif ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ) * morphTargetInfluences[ i ];\n\t\t#elif defined( USE_COLOR )\n\t\t\tif ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ).rgb * morphTargetInfluences[ i ];\n\t\t#endif\n\t}\n#endif",morphnormal_vertex:"#ifdef USE_MORPHNORMALS\n\tobjectNormal *= morphTargetBaseInfluence;\n\t#ifdef MORPHTARGETS_TEXTURE\n\t\tfor ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {\n\t\t\tif ( morphTargetInfluences[ i ] != 0.0 ) objectNormal += getMorph( gl_VertexID, i, 1 ).xyz * morphTargetInfluences[ i ];\n\t\t}\n\t#else\n\t\tobjectNormal += morphNormal0 * morphTargetInfluences[ 0 ];\n\t\tobjectNormal += morphNormal1 * morphTargetInfluences[ 1 ];\n\t\tobjectNormal += morphNormal2 * morphTargetInfluences[ 2 ];\n\t\tobjectNormal += morphNormal3 * morphTargetInfluences[ 3 ];\n\t#endif\n#endif",morphtarget_pars_vertex:"#ifdef USE_MORPHTARGETS\n\tuniform float morphTargetBaseInfluence;\n\t#ifdef MORPHTARGETS_TEXTURE\n\t\tuniform float morphTargetInfluences[ MORPHTARGETS_COUNT ];\n\t\tuniform sampler2DArray morphTargetsTexture;\n\t\tuniform ivec2 morphTargetsTextureSize;\n\t\tvec4 getMorph( const in int vertexIndex, const in int morphTargetIndex, const in int offset ) {\n\t\t\tint texelIndex = vertexIndex * MORPHTARGETS_TEXTURE_STRIDE + offset;\n\t\t\tint y = texelIndex / morphTargetsTextureSize.x;\n\t\t\tint x = texelIndex - y * morphTargetsTextureSize.x;\n\t\t\tivec3 morphUV = ivec3( x, y, morphTargetIndex );\n\t\t\treturn texelFetch( morphTargetsTexture, morphUV, 0 );\n\t\t}\n\t#else\n\t\t#ifndef USE_MORPHNORMALS\n\t\t\tuniform float morphTargetInfluences[ 8 ];\n\t\t#else\n\t\t\tuniform float morphTargetInfluences[ 4 ];\n\t\t#endif\n\t#endif\n#endif",morphtarget_vertex:"#ifdef USE_MORPHTARGETS\n\ttransformed *= morphTargetBaseInfluence;\n\t#ifdef MORPHTARGETS_TEXTURE\n\t\tfor ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {\n\t\t\tif ( morphTargetInfluences[ i ] != 0.0 ) transformed += getMorph( gl_VertexID, i, 0 ).xyz * morphTargetInfluences[ i ];\n\t\t}\n\t#else\n\t\ttransformed += morphTarget0 * morphTargetInfluences[ 0 ];\n\t\ttransformed += morphTarget1 * morphTargetInfluences[ 1 ];\n\t\ttransformed += morphTarget2 * morphTargetInfluences[ 2 ];\n\t\ttransformed += morphTarget3 * morphTargetInfluences[ 3 ];\n\t\t#ifndef USE_MORPHNORMALS\n\t\t\ttransformed += morphTarget4 * morphTargetInfluences[ 4 ];\n\t\t\ttransformed += morphTarget5 * morphTargetInfluences[ 5 ];\n\t\t\ttransformed += morphTarget6 * morphTargetInfluences[ 6 ];\n\t\t\ttransformed += morphTarget7 * morphTargetInfluences[ 7 ];\n\t\t#endif\n\t#endif\n#endif",normal_fragment_begin:"float faceDirection = gl_FrontFacing ? 1.0 : - 1.0;\n#ifdef FLAT_SHADED\n\tvec3 fdx = dFdx( vViewPosition );\n\tvec3 fdy = dFdy( vViewPosition );\n\tvec3 normal = normalize( cross( fdx, fdy ) );\n#else\n\tvec3 normal = normalize( vNormal );\n\t#ifdef DOUBLE_SIDED\n\t\tnormal = normal * faceDirection;\n\t#endif\n\t#ifdef USE_TANGENT\n\t\tvec3 tangent = normalize( vTangent );\n\t\tvec3 bitangent = normalize( vBitangent );\n\t\t#ifdef DOUBLE_SIDED\n\t\t\ttangent = tangent * faceDirection;\n\t\t\tbitangent = bitangent * faceDirection;\n\t\t#endif\n\t\t#if defined( TANGENTSPACE_NORMALMAP ) || defined( USE_CLEARCOAT_NORMALMAP )\n\t\t\tmat3 vTBN = mat3( tangent, bitangent, normal );\n\t\t#endif\n\t#endif\n#endif\nvec3 geometryNormal = normal;",normal_fragment_maps:"#ifdef OBJECTSPACE_NORMALMAP\n\tnormal = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;\n\t#ifdef FLIP_SIDED\n\t\tnormal = - normal;\n\t#endif\n\t#ifdef DOUBLE_SIDED\n\t\tnormal = normal * faceDirection;\n\t#endif\n\tnormal = normalize( normalMatrix * normal );\n#elif defined( TANGENTSPACE_NORMALMAP )\n\tvec3 mapN = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;\n\tmapN.xy *= normalScale;\n\t#ifdef USE_TANGENT\n\t\tnormal = normalize( vTBN * mapN );\n\t#else\n\t\tnormal = perturbNormal2Arb( - vViewPosition, normal, mapN, faceDirection );\n\t#endif\n#elif defined( USE_BUMPMAP )\n\tnormal = perturbNormalArb( - vViewPosition, normal, dHdxy_fwd(), faceDirection );\n#endif",normal_pars_fragment:"#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif",normal_pars_vertex:"#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif",normal_vertex:"#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n\t#ifdef USE_TANGENT\n\t\tvTangent = normalize( transformedTangent );\n\t\tvBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );\n\t#endif\n#endif",normalmap_pars_fragment:"#ifdef USE_NORMALMAP\n\tuniform sampler2D normalMap;\n\tuniform vec2 normalScale;\n#endif\n#ifdef OBJECTSPACE_NORMALMAP\n\tuniform mat3 normalMatrix;\n#endif\n#if ! defined ( USE_TANGENT ) && ( defined ( TANGENTSPACE_NORMALMAP ) || defined ( USE_CLEARCOAT_NORMALMAP ) )\n\tvec3 perturbNormal2Arb( vec3 eye_pos, vec3 surf_norm, vec3 mapN, float faceDirection ) {\n\t\tvec3 q0 = dFdx( eye_pos.xyz );\n\t\tvec3 q1 = dFdy( eye_pos.xyz );\n\t\tvec2 st0 = dFdx( vUv.st );\n\t\tvec2 st1 = dFdy( vUv.st );\n\t\tvec3 N = surf_norm;\n\t\tvec3 q1perp = cross( q1, N );\n\t\tvec3 q0perp = cross( N, q0 );\n\t\tvec3 T = q1perp * st0.x + q0perp * st1.x;\n\t\tvec3 B = q1perp * st0.y + q0perp * st1.y;\n\t\tfloat det = max( dot( T, T ), dot( B, B ) );\n\t\tfloat scale = ( det == 0.0 ) ? 0.0 : faceDirection * inversesqrt( det );\n\t\treturn normalize( T * ( mapN.x * scale ) + B * ( mapN.y * scale ) + N * mapN.z );\n\t}\n#endif",clearcoat_normal_fragment_begin:"#ifdef USE_CLEARCOAT\n\tvec3 clearcoatNormal = geometryNormal;\n#endif",clearcoat_normal_fragment_maps:"#ifdef USE_CLEARCOAT_NORMALMAP\n\tvec3 clearcoatMapN = texture2D( clearcoatNormalMap, vUv ).xyz * 2.0 - 1.0;\n\tclearcoatMapN.xy *= clearcoatNormalScale;\n\t#ifdef USE_TANGENT\n\t\tclearcoatNormal = normalize( vTBN * clearcoatMapN );\n\t#else\n\t\tclearcoatNormal = perturbNormal2Arb( - vViewPosition, clearcoatNormal, clearcoatMapN, faceDirection );\n\t#endif\n#endif",clearcoat_pars_fragment:"#ifdef USE_CLEARCOATMAP\n\tuniform sampler2D clearcoatMap;\n#endif\n#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\tuniform sampler2D clearcoatRoughnessMap;\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n\tuniform sampler2D clearcoatNormalMap;\n\tuniform vec2 clearcoatNormalScale;\n#endif",iridescence_pars_fragment:"#ifdef USE_IRIDESCENCEMAP\n\tuniform sampler2D iridescenceMap;\n#endif\n#ifdef USE_IRIDESCENCE_THICKNESSMAP\n\tuniform sampler2D iridescenceThicknessMap;\n#endif",output_fragment:"#ifdef OPAQUE\ndiffuseColor.a = 1.0;\n#endif\n#ifdef USE_TRANSMISSION\ndiffuseColor.a *= material.transmissionAlpha + 0.1;\n#endif\ngl_FragColor = vec4( outgoingLight, diffuseColor.a );",packing:"vec3 packNormalToRGB( const in vec3 normal ) {\n\treturn normalize( normal ) * 0.5 + 0.5;\n}\nvec3 unpackRGBToNormal( const in vec3 rgb ) {\n\treturn 2.0 * rgb.xyz - 1.0;\n}\nconst float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;\nconst vec3 PackFactors = vec3( 256. * 256. * 256., 256. * 256., 256. );\nconst vec4 UnpackFactors = UnpackDownscale / vec4( PackFactors, 1. );\nconst float ShiftRight8 = 1. / 256.;\nvec4 packDepthToRGBA( const in float v ) {\n\tvec4 r = vec4( fract( v * PackFactors ), v );\n\tr.yzw -= r.xyz * ShiftRight8;\treturn r * PackUpscale;\n}\nfloat unpackRGBAToDepth( const in vec4 v ) {\n\treturn dot( v, UnpackFactors );\n}\nvec2 packDepthToRG( in highp float v ) {\n\treturn packDepthToRGBA( v ).yx;\n}\nfloat unpackRGToDepth( const in highp vec2 v ) {\n\treturn unpackRGBAToDepth( vec4( v.xy, 0.0, 0.0 ) );\n}\nvec4 pack2HalfToRGBA( vec2 v ) {\n\tvec4 r = vec4( v.x, fract( v.x * 255.0 ), v.y, fract( v.y * 255.0 ) );\n\treturn vec4( r.x - r.y / 255.0, r.y, r.z - r.w / 255.0, r.w );\n}\nvec2 unpackRGBATo2Half( vec4 v ) {\n\treturn vec2( v.x + ( v.y / 255.0 ), v.z + ( v.w / 255.0 ) );\n}\nfloat viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {\n\treturn ( viewZ + near ) / ( near - far );\n}\nfloat orthographicDepthToViewZ( const in float linearClipZ, const in float near, const in float far ) {\n\treturn linearClipZ * ( near - far ) - near;\n}\nfloat viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {\n\treturn ( ( near + viewZ ) * far ) / ( ( far - near ) * viewZ );\n}\nfloat perspectiveDepthToViewZ( const in float invClipZ, const in float near, const in float far ) {\n\treturn ( near * far ) / ( ( far - near ) * invClipZ - far );\n}",premultiplied_alpha_fragment:"#ifdef PREMULTIPLIED_ALPHA\n\tgl_FragColor.rgb *= gl_FragColor.a;\n#endif",project_vertex:"vec4 mvPosition = vec4( transformed, 1.0 );\n#ifdef USE_INSTANCING\n\tmvPosition = instanceMatrix * mvPosition;\n#endif\nmvPosition = modelViewMatrix * mvPosition;\ngl_Position = projectionMatrix * mvPosition;",dithering_fragment:"#ifdef DITHERING\n\tgl_FragColor.rgb = dithering( gl_FragColor.rgb );\n#endif",dithering_pars_fragment:"#ifdef DITHERING\n\tvec3 dithering( vec3 color ) {\n\t\tfloat grid_position = rand( gl_FragCoord.xy );\n\t\tvec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );\n\t\tdither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );\n\t\treturn color + dither_shift_RGB;\n\t}\n#endif",roughnessmap_fragment:"float roughnessFactor = roughness;\n#ifdef USE_ROUGHNESSMAP\n\tvec4 texelRoughness = texture2D( roughnessMap, vUv );\n\troughnessFactor *= texelRoughness.g;\n#endif",roughnessmap_pars_fragment:"#ifdef USE_ROUGHNESSMAP\n\tuniform sampler2D roughnessMap;\n#endif",shadowmap_pars_fragment:"#if NUM_SPOT_LIGHT_COORDS > 0\n\tvarying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];\n#endif\n#if NUM_SPOT_LIGHT_MAPS > 0\n\tuniform sampler2D spotLightMap[ NUM_SPOT_LIGHT_MAPS ];\n#endif\n#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tstruct DirectionalLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];\n\t\tstruct SpotLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tstruct PointLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t\tfloat shadowCameraNear;\n\t\t\tfloat shadowCameraFar;\n\t\t};\n\t\tuniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];\n\t#endif\n\tfloat texture2DCompare( sampler2D depths, vec2 uv, float compare ) {\n\t\treturn step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );\n\t}\n\tvec2 texture2DDistribution( sampler2D shadow, vec2 uv ) {\n\t\treturn unpackRGBATo2Half( texture2D( shadow, uv ) );\n\t}\n\tfloat VSMShadow (sampler2D shadow, vec2 uv, float compare ){\n\t\tfloat occlusion = 1.0;\n\t\tvec2 distribution = texture2DDistribution( shadow, uv );\n\t\tfloat hard_shadow = step( compare , distribution.x );\n\t\tif (hard_shadow != 1.0 ) {\n\t\t\tfloat distance = compare - distribution.x ;\n\t\t\tfloat variance = max( 0.00000, distribution.y * distribution.y );\n\t\t\tfloat softness_probability = variance / (variance + distance * distance );\t\t\tsoftness_probability = clamp( ( softness_probability - 0.3 ) / ( 0.95 - 0.3 ), 0.0, 1.0 );\t\t\tocclusion = clamp( max( hard_shadow, softness_probability ), 0.0, 1.0 );\n\t\t}\n\t\treturn occlusion;\n\t}\n\tfloat getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord ) {\n\t\tfloat shadow = 1.0;\n\t\tshadowCoord.xyz /= shadowCoord.w;\n\t\tshadowCoord.z += shadowBias;\n\t\tbool inFrustum = shadowCoord.x >= 0.0 && shadowCoord.x <= 1.0 && shadowCoord.y >= 0.0 && shadowCoord.y <= 1.0;\n\t\tbool frustumTest = inFrustum && shadowCoord.z <= 1.0;\n\t\tif ( frustumTest ) {\n\t\t#if defined( SHADOWMAP_TYPE_PCF )\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx0 = - texelSize.x * shadowRadius;\n\t\t\tfloat dy0 = - texelSize.y * shadowRadius;\n\t\t\tfloat dx1 = + texelSize.x * shadowRadius;\n\t\t\tfloat dy1 = + texelSize.y * shadowRadius;\n\t\t\tfloat dx2 = dx0 / 2.0;\n\t\t\tfloat dy2 = dy0 / 2.0;\n\t\t\tfloat dx3 = dx1 / 2.0;\n\t\t\tfloat dy3 = dy1 / 2.0;\n\t\t\tshadow = (\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )\n\t\t\t) * ( 1.0 / 17.0 );\n\t\t#elif defined( SHADOWMAP_TYPE_PCF_SOFT )\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx = texelSize.x;\n\t\t\tfloat dy = texelSize.y;\n\t\t\tvec2 uv = shadowCoord.xy;\n\t\t\tvec2 f = fract( uv * shadowMapSize + 0.5 );\n\t\t\tuv -= f * texelSize;\n\t\t\tshadow = (\n\t\t\t\ttexture2DCompare( shadowMap, uv, shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + vec2( dx, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + vec2( 0.0, dy ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + texelSize, shadowCoord.z ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( -dx, 0.0 ), shadowCoord.z ),\n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 0.0 ), shadowCoord.z ),\n\t\t\t\t\t f.x ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( -dx, dy ), shadowCoord.z ),\n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, dy ), shadowCoord.z ),\n\t\t\t\t\t f.x ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( 0.0, -dy ), shadowCoord.z ),\n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 0.0, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t f.y ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( dx, -dy ), shadowCoord.z ),\n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( dx, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t f.y ) +\n\t\t\t\tmix( mix( texture2DCompare( shadowMap, uv + vec2( -dx, -dy ), shadowCoord.z ),\n\t\t\t\t\t\t  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, -dy ), shadowCoord.z ),\n\t\t\t\t\t\t  f.x ),\n\t\t\t\t\t mix( texture2DCompare( shadowMap, uv + vec2( -dx, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t\t  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t\t  f.x ),\n\t\t\t\t\t f.y )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#elif defined( SHADOWMAP_TYPE_VSM )\n\t\t\tshadow = VSMShadow( shadowMap, shadowCoord.xy, shadowCoord.z );\n\t\t#else\n\t\t\tshadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );\n\t\t#endif\n\t\t}\n\t\treturn shadow;\n\t}\n\tvec2 cubeToUV( vec3 v, float texelSizeY ) {\n\t\tvec3 absV = abs( v );\n\t\tfloat scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );\n\t\tabsV *= scaleToCube;\n\t\tv *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );\n\t\tvec2 planar = v.xy;\n\t\tfloat almostATexel = 1.5 * texelSizeY;\n\t\tfloat almostOne = 1.0 - almostATexel;\n\t\tif ( absV.z >= almostOne ) {\n\t\t\tif ( v.z > 0.0 )\n\t\t\t\tplanar.x = 4.0 - v.x;\n\t\t} else if ( absV.x >= almostOne ) {\n\t\t\tfloat signX = sign( v.x );\n\t\t\tplanar.x = v.z * signX + 2.0 * signX;\n\t\t} else if ( absV.y >= almostOne ) {\n\t\t\tfloat signY = sign( v.y );\n\t\t\tplanar.x = v.x + 2.0 * signY + 2.0;\n\t\t\tplanar.y = v.z * signY - 2.0;\n\t\t}\n\t\treturn vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );\n\t}\n\tfloat getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {\n\t\tvec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );\n\t\tvec3 lightToPosition = shadowCoord.xyz;\n\t\tfloat dp = ( length( lightToPosition ) - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear );\t\tdp += shadowBias;\n\t\tvec3 bd3D = normalize( lightToPosition );\n\t\t#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT ) || defined( SHADOWMAP_TYPE_VSM )\n\t\t\tvec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;\n\t\t\treturn (\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#else\n\t\t\treturn texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );\n\t\t#endif\n\t}\n#endif",shadowmap_pars_vertex:"#if NUM_SPOT_LIGHT_COORDS > 0\n\tuniform mat4 spotLightMatrix[ NUM_SPOT_LIGHT_COORDS ];\n\tvarying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];\n#endif\n#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t\tuniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tstruct DirectionalLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\t\tstruct SpotLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t\tuniform mat4 pointShadowMatrix[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tstruct PointLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t\tfloat shadowCameraNear;\n\t\t\tfloat shadowCameraFar;\n\t\t};\n\t\tuniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];\n\t#endif\n#endif",shadowmap_vertex:"#if ( defined( USE_SHADOWMAP ) && ( NUM_DIR_LIGHT_SHADOWS > 0 || NUM_POINT_LIGHT_SHADOWS > 0 ) ) || ( NUM_SPOT_LIGHT_COORDS > 0 )\n\tvec3 shadowWorldNormal = inverseTransformDirection( transformedNormal, viewMatrix );\n\tvec4 shadowWorldPosition;\n#endif\n#if defined( USE_SHADOWMAP )\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {\n\t\t\tshadowWorldPosition = worldPosition + vec4( shadowWorldNormal * directionalLightShadows[ i ].shadowNormalBias, 0 );\n\t\t\tvDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * shadowWorldPosition;\n\t\t}\n\t\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {\n\t\t\tshadowWorldPosition = worldPosition + vec4( shadowWorldNormal * pointLightShadows[ i ].shadowNormalBias, 0 );\n\t\t\tvPointShadowCoord[ i ] = pointShadowMatrix[ i ] * shadowWorldPosition;\n\t\t}\n\t\t#pragma unroll_loop_end\n\t#endif\n#endif\n#if NUM_SPOT_LIGHT_COORDS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHT_COORDS; i ++ ) {\n\t\tshadowWorldPosition = worldPosition;\n\t\t#if ( defined( USE_SHADOWMAP ) && UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )\n\t\t\tshadowWorldPosition.xyz += shadowWorldNormal * spotLightShadows[ i ].shadowNormalBias;\n\t\t#endif\n\t\tvSpotLightCoord[ i ] = spotLightMatrix[ i ] * shadowWorldPosition;\n\t}\n\t#pragma unroll_loop_end\n#endif",shadowmask_pars_fragment:"float getShadowMask() {\n\tfloat shadow = 1.0;\n\t#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\tDirectionalLightShadow directionalLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {\n\t\tdirectionalLight = directionalLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\tSpotLightShadow spotLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {\n\t\tspotLight = spotLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\tPointLightShadow pointLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {\n\t\tpointLight = pointLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#endif\n\treturn shadow;\n}",skinbase_vertex:"#ifdef USE_SKINNING\n\tmat4 boneMatX = getBoneMatrix( skinIndex.x );\n\tmat4 boneMatY = getBoneMatrix( skinIndex.y );\n\tmat4 boneMatZ = getBoneMatrix( skinIndex.z );\n\tmat4 boneMatW = getBoneMatrix( skinIndex.w );\n#endif",skinning_pars_vertex:"#ifdef USE_SKINNING\n\tuniform mat4 bindMatrix;\n\tuniform mat4 bindMatrixInverse;\n\tuniform highp sampler2D boneTexture;\n\tuniform int boneTextureSize;\n\tmat4 getBoneMatrix( const in float i ) {\n\t\tfloat j = i * 4.0;\n\t\tfloat x = mod( j, float( boneTextureSize ) );\n\t\tfloat y = floor( j / float( boneTextureSize ) );\n\t\tfloat dx = 1.0 / float( boneTextureSize );\n\t\tfloat dy = 1.0 / float( boneTextureSize );\n\t\ty = dy * ( y + 0.5 );\n\t\tvec4 v1 = texture2D( boneTexture, vec2( dx * ( x + 0.5 ), y ) );\n\t\tvec4 v2 = texture2D( boneTexture, vec2( dx * ( x + 1.5 ), y ) );\n\t\tvec4 v3 = texture2D( boneTexture, vec2( dx * ( x + 2.5 ), y ) );\n\t\tvec4 v4 = texture2D( boneTexture, vec2( dx * ( x + 3.5 ), y ) );\n\t\tmat4 bone = mat4( v1, v2, v3, v4 );\n\t\treturn bone;\n\t}\n#endif",skinning_vertex:"#ifdef USE_SKINNING\n\tvec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );\n\tvec4 skinned = vec4( 0.0 );\n\tskinned += boneMatX * skinVertex * skinWeight.x;\n\tskinned += boneMatY * skinVertex * skinWeight.y;\n\tskinned += boneMatZ * skinVertex * skinWeight.z;\n\tskinned += boneMatW * skinVertex * skinWeight.w;\n\ttransformed = ( bindMatrixInverse * skinned ).xyz;\n#endif",skinnormal_vertex:"#ifdef USE_SKINNING\n\tmat4 skinMatrix = mat4( 0.0 );\n\tskinMatrix += skinWeight.x * boneMatX;\n\tskinMatrix += skinWeight.y * boneMatY;\n\tskinMatrix += skinWeight.z * boneMatZ;\n\tskinMatrix += skinWeight.w * boneMatW;\n\tskinMatrix = bindMatrixInverse * skinMatrix * bindMatrix;\n\tobjectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;\n\t#ifdef USE_TANGENT\n\t\tobjectTangent = vec4( skinMatrix * vec4( objectTangent, 0.0 ) ).xyz;\n\t#endif\n#endif",specularmap_fragment:"float specularStrength;\n#ifdef USE_SPECULARMAP\n\tvec4 texelSpecular = texture2D( specularMap, vUv );\n\tspecularStrength = texelSpecular.r;\n#else\n\tspecularStrength = 1.0;\n#endif",specularmap_pars_fragment:"#ifdef USE_SPECULARMAP\n\tuniform sampler2D specularMap;\n#endif",tonemapping_fragment:"#if defined( TONE_MAPPING )\n\tgl_FragColor.rgb = toneMapping( gl_FragColor.rgb );\n#endif",tonemapping_pars_fragment:"#ifndef saturate\n#define saturate( a ) clamp( a, 0.0, 1.0 )\n#endif\nuniform float toneMappingExposure;\nvec3 LinearToneMapping( vec3 color ) {\n\treturn toneMappingExposure * color;\n}\nvec3 ReinhardToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\treturn saturate( color / ( vec3( 1.0 ) + color ) );\n}\nvec3 OptimizedCineonToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\tcolor = max( vec3( 0.0 ), color - 0.004 );\n\treturn pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );\n}\nvec3 RRTAndODTFit( vec3 v ) {\n\tvec3 a = v * ( v + 0.0245786 ) - 0.000090537;\n\tvec3 b = v * ( 0.983729 * v + 0.4329510 ) + 0.238081;\n\treturn a / b;\n}\nvec3 ACESFilmicToneMapping( vec3 color ) {\n\tconst mat3 ACESInputMat = mat3(\n\t\tvec3( 0.59719, 0.07600, 0.02840 ),\t\tvec3( 0.35458, 0.90834, 0.13383 ),\n\t\tvec3( 0.04823, 0.01566, 0.83777 )\n\t);\n\tconst mat3 ACESOutputMat = mat3(\n\t\tvec3(  1.60475, -0.10208, -0.00327 ),\t\tvec3( -0.53108,  1.10813, -0.07276 ),\n\t\tvec3( -0.07367, -0.00605,  1.07602 )\n\t);\n\tcolor *= toneMappingExposure / 0.6;\n\tcolor = ACESInputMat * color;\n\tcolor = RRTAndODTFit( color );\n\tcolor = ACESOutputMat * color;\n\treturn saturate( color );\n}\nvec3 CustomToneMapping( vec3 color ) { return color; }",transmission_fragment:"#ifdef USE_TRANSMISSION\n\tmaterial.transmission = transmission;\n\tmaterial.transmissionAlpha = 1.0;\n\tmaterial.thickness = thickness;\n\tmaterial.attenuationDistance = attenuationDistance;\n\tmaterial.attenuationColor = attenuationColor;\n\t#ifdef USE_TRANSMISSIONMAP\n\t\tmaterial.transmission *= texture2D( transmissionMap, vUv ).r;\n\t#endif\n\t#ifdef USE_THICKNESSMAP\n\t\tmaterial.thickness *= texture2D( thicknessMap, vUv ).g;\n\t#endif\n\tvec3 pos = vWorldPosition;\n\tvec3 v = normalize( cameraPosition - pos );\n\tvec3 n = inverseTransformDirection( normal, viewMatrix );\n\tvec4 transmission = getIBLVolumeRefraction(\n\t\tn, v, material.roughness, material.diffuseColor, material.specularColor, material.specularF90,\n\t\tpos, modelMatrix, viewMatrix, projectionMatrix, material.ior, material.thickness,\n\t\tmaterial.attenuationColor, material.attenuationDistance );\n\tmaterial.transmissionAlpha = mix( material.transmissionAlpha, transmission.a, material.transmission );\n\ttotalDiffuse = mix( totalDiffuse, transmission.rgb, material.transmission );\n#endif",transmission_pars_fragment:"#ifdef USE_TRANSMISSION\n\tuniform float transmission;\n\tuniform float thickness;\n\tuniform float attenuationDistance;\n\tuniform vec3 attenuationColor;\n\t#ifdef USE_TRANSMISSIONMAP\n\t\tuniform sampler2D transmissionMap;\n\t#endif\n\t#ifdef USE_THICKNESSMAP\n\t\tuniform sampler2D thicknessMap;\n\t#endif\n\tuniform vec2 transmissionSamplerSize;\n\tuniform sampler2D transmissionSamplerMap;\n\tuniform mat4 modelMatrix;\n\tuniform mat4 projectionMatrix;\n\tvarying vec3 vWorldPosition;\n\tfloat w0( float a ) {\n\t\treturn ( 1.0 / 6.0 ) * ( a * ( a * ( - a + 3.0 ) - 3.0 ) + 1.0 );\n\t}\n\tfloat w1( float a ) {\n\t\treturn ( 1.0 / 6.0 ) * ( a *  a * ( 3.0 * a - 6.0 ) + 4.0 );\n\t}\n\tfloat w2( float a ){\n\t\treturn ( 1.0 / 6.0 ) * ( a * ( a * ( - 3.0 * a + 3.0 ) + 3.0 ) + 1.0 );\n\t}\n\tfloat w3( float a ) {\n\t\treturn ( 1.0 / 6.0 ) * ( a * a * a );\n\t}\n\tfloat g0( float a ) {\n\t\treturn w0( a ) + w1( a );\n\t}\n\tfloat g1( float a ) {\n\t\treturn w2( a ) + w3( a );\n\t}\n\tfloat h0( float a ) {\n\t\treturn - 1.0 + w1( a ) / ( w0( a ) + w1( a ) );\n\t}\n\tfloat h1( float a ) {\n\t\treturn 1.0 + w3( a ) / ( w2( a ) + w3( a ) );\n\t}\n\tvec4 bicubic( sampler2D tex, vec2 uv, vec4 texelSize, vec2 fullSize, float lod ) {\n\t\tuv = uv * texelSize.zw + 0.5;\n\t\tvec2 iuv = floor( uv );\n\t\tvec2 fuv = fract( uv );\n\t\tfloat g0x = g0( fuv.x );\n\t\tfloat g1x = g1( fuv.x );\n\t\tfloat h0x = h0( fuv.x );\n\t\tfloat h1x = h1( fuv.x );\n\t\tfloat h0y = h0( fuv.y );\n\t\tfloat h1y = h1( fuv.y );\n\t\tvec2 p0 = ( vec2( iuv.x + h0x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;\n\t\tvec2 p1 = ( vec2( iuv.x + h1x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;\n\t\tvec2 p2 = ( vec2( iuv.x + h0x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;\n\t\tvec2 p3 = ( vec2( iuv.x + h1x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;\n\t\t\n\t\tvec2 lodFudge = pow( 1.95, lod ) / fullSize;\n\t\treturn g0( fuv.y ) * ( g0x * textureLod( tex, p0, lod ) + g1x * textureLod( tex, p1, lod ) ) +\n\t\t\tg1( fuv.y ) * ( g0x * textureLod( tex, p2, lod ) + g1x * textureLod( tex, p3, lod ) );\n\t}\n\tvec4 textureBicubic( sampler2D sampler, vec2 uv, float lod ) {\n\t\tvec2 fLodSize = vec2( textureSize( sampler, int( lod ) ) );\n\t\tvec2 cLodSize = vec2( textureSize( sampler, int( lod + 1.0 ) ) );\n\t\tvec2 fLodSizeInv = 1.0 / fLodSize;\n\t\tvec2 cLodSizeInv = 1.0 / cLodSize;\n\t\tvec2 fullSize = vec2( textureSize( sampler, 0 ) );\n\t\tvec4 fSample = bicubic( sampler, uv, vec4( fLodSizeInv, fLodSize ), fullSize, floor( lod ) );\n\t\tvec4 cSample = bicubic( sampler, uv, vec4( cLodSizeInv, cLodSize ), fullSize, ceil( lod ) );\n\t\treturn mix( fSample, cSample, fract( lod ) );\n\t}\n\tvec3 getVolumeTransmissionRay( const in vec3 n, const in vec3 v, const in float thickness, const in float ior, const in mat4 modelMatrix ) {\n\t\tvec3 refractionVector = refract( - v, normalize( n ), 1.0 / ior );\n\t\tvec3 modelScale;\n\t\tmodelScale.x = length( vec3( modelMatrix[ 0 ].xyz ) );\n\t\tmodelScale.y = length( vec3( modelMatrix[ 1 ].xyz ) );\n\t\tmodelScale.z = length( vec3( modelMatrix[ 2 ].xyz ) );\n\t\treturn normalize( refractionVector ) * thickness * modelScale;\n\t}\n\tfloat applyIorToRoughness( const in float roughness, const in float ior ) {\n\t\treturn roughness * clamp( ior * 2.0 - 2.0, 0.0, 1.0 );\n\t}\n\tvec4 getTransmissionSample( const in vec2 fragCoord, const in float roughness, const in float ior ) {\n\t\tfloat lod = log2( transmissionSamplerSize.x ) * applyIorToRoughness( roughness, ior );\n\t\treturn textureBicubic( transmissionSamplerMap, fragCoord.xy, lod );\n\t}\n\tvec3 applyVolumeAttenuation( const in vec3 radiance, const in float transmissionDistance, const in vec3 attenuationColor, const in float attenuationDistance ) {\n\t\tif ( isinf( attenuationDistance ) ) {\n\t\t\treturn radiance;\n\t\t} else {\n\t\t\tvec3 attenuationCoefficient = -log( attenuationColor ) / attenuationDistance;\n\t\t\tvec3 transmittance = exp( - attenuationCoefficient * transmissionDistance );\t\t\treturn transmittance * radiance;\n\t\t}\n\t}\n\tvec4 getIBLVolumeRefraction( const in vec3 n, const in vec3 v, const in float roughness, const in vec3 diffuseColor,\n\t\tconst in vec3 specularColor, const in float specularF90, const in vec3 position, const in mat4 modelMatrix,\n\t\tconst in mat4 viewMatrix, const in mat4 projMatrix, const in float ior, const in float thickness,\n\t\tconst in vec3 attenuationColor, const in float attenuationDistance ) {\n\t\tvec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, ior, modelMatrix );\n\t\tvec3 refractedRayExit = position + transmissionRay;\n\t\tvec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );\n\t\tvec2 refractionCoords = ndcPos.xy / ndcPos.w;\n\t\trefractionCoords += 1.0;\n\t\trefractionCoords /= 2.0;\n\t\tvec4 transmittedLight = getTransmissionSample( refractionCoords, roughness, ior );\n\t\tvec3 attenuatedColor = applyVolumeAttenuation( transmittedLight.rgb, length( transmissionRay ), attenuationColor, attenuationDistance );\n\t\tvec3 F = EnvironmentBRDF( n, v, specularColor, specularF90, roughness );\n\t\treturn vec4( ( 1.0 - F ) * attenuatedColor * diffuseColor, transmittedLight.a );\n\t}\n#endif",uv_pars_fragment:"#if ( defined( USE_UV ) && ! defined( UVS_VERTEX_ONLY ) )\n\tvarying vec2 vUv;\n#endif",uv_pars_vertex:"#ifdef USE_UV\n\t#ifdef UVS_VERTEX_ONLY\n\t\tvec2 vUv;\n\t#else\n\t\tvarying vec2 vUv;\n\t#endif\n\tuniform mat3 uvTransform;\n#endif",uv_vertex:"#ifdef USE_UV\n\tvUv = ( uvTransform * vec3( uv, 1 ) ).xy;\n#endif",uv2_pars_fragment:"#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tvarying vec2 vUv2;\n#endif",uv2_pars_vertex:"#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tattribute vec2 uv2;\n\tvarying vec2 vUv2;\n\tuniform mat3 uv2Transform;\n#endif",uv2_vertex:"#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tvUv2 = ( uv2Transform * vec3( uv2, 1 ) ).xy;\n#endif",worldpos_vertex:"#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP ) || defined ( USE_TRANSMISSION ) || NUM_SPOT_LIGHT_COORDS > 0\n\tvec4 worldPosition = vec4( transformed, 1.0 );\n\t#ifdef USE_INSTANCING\n\t\tworldPosition = instanceMatrix * worldPosition;\n\t#endif\n\tworldPosition = modelMatrix * worldPosition;\n#endif",background_vert:"varying vec2 vUv;\nuniform mat3 uvTransform;\nvoid main() {\n\tvUv = ( uvTransform * vec3( uv, 1 ) ).xy;\n\tgl_Position = vec4( position.xy, 1.0, 1.0 );\n}",background_frag:"uniform sampler2D t2D;\nuniform float backgroundIntensity;\nvarying vec2 vUv;\nvoid main() {\n\tvec4 texColor = texture2D( t2D, vUv );\n\t#ifdef DECODE_VIDEO_TEXTURE\n\t\ttexColor = vec4( mix( pow( texColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), texColor.rgb * 0.0773993808, vec3( lessThanEqual( texColor.rgb, vec3( 0.04045 ) ) ) ), texColor.w );\n\t#endif\n\ttexColor.rgb *= backgroundIntensity;\n\tgl_FragColor = texColor;\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n}",backgroundCube_vert:"varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\tgl_Position.z = gl_Position.w;\n}",backgroundCube_frag:"#ifdef ENVMAP_TYPE_CUBE\n\tuniform samplerCube envMap;\n#elif defined( ENVMAP_TYPE_CUBE_UV )\n\tuniform sampler2D envMap;\n#endif\nuniform float flipEnvMap;\nuniform float backgroundBlurriness;\nuniform float backgroundIntensity;\nvarying vec3 vWorldDirection;\n#include <cube_uv_reflection_fragment>\nvoid main() {\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tvec4 texColor = textureCube( envMap, vec3( flipEnvMap * vWorldDirection.x, vWorldDirection.yz ) );\n\t#elif defined( ENVMAP_TYPE_CUBE_UV )\n\t\tvec4 texColor = textureCubeUV( envMap, vWorldDirection, backgroundBlurriness );\n\t#else\n\t\tvec4 texColor = vec4( 0.0, 0.0, 0.0, 1.0 );\n\t#endif\n\ttexColor.rgb *= backgroundIntensity;\n\tgl_FragColor = texColor;\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n}",cube_vert:"varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\tgl_Position.z = gl_Position.w;\n}",cube_frag:"uniform samplerCube tCube;\nuniform float tFlip;\nuniform float opacity;\nvarying vec3 vWorldDirection;\nvoid main() {\n\tvec4 texColor = textureCube( tCube, vec3( tFlip * vWorldDirection.x, vWorldDirection.yz ) );\n\tgl_FragColor = texColor;\n\tgl_FragColor.a *= opacity;\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n}",depth_vert:"#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvarying vec2 vHighPrecisionZW;\nvoid main() {\n\t#include <uv_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_DISPLACEMENTMAP\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvHighPrecisionZW = gl_Position.zw;\n}",depth_frag:"#if DEPTH_PACKING == 3200\n\tuniform float opacity;\n#endif\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvarying vec2 vHighPrecisionZW;\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( 1.0 );\n\t#if DEPTH_PACKING == 3200\n\t\tdiffuseColor.a = opacity;\n\t#endif\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <logdepthbuf_fragment>\n\tfloat fragCoordZ = 0.5 * vHighPrecisionZW[0] / vHighPrecisionZW[1] + 0.5;\n\t#if DEPTH_PACKING == 3200\n\t\tgl_FragColor = vec4( vec3( 1.0 - fragCoordZ ), opacity );\n\t#elif DEPTH_PACKING == 3201\n\t\tgl_FragColor = packDepthToRGBA( fragCoordZ );\n\t#endif\n}",distanceRGBA_vert:"#define DISTANCE\nvarying vec3 vWorldPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_DISPLACEMENTMAP\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <worldpos_vertex>\n\t#include <clipping_planes_vertex>\n\tvWorldPosition = worldPosition.xyz;\n}",distanceRGBA_frag:"#define DISTANCE\nuniform vec3 referencePosition;\nuniform float nearDistance;\nuniform float farDistance;\nvarying vec3 vWorldPosition;\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main () {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( 1.0 );\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\tfloat dist = length( vWorldPosition - referencePosition );\n\tdist = ( dist - nearDistance ) / ( farDistance - nearDistance );\n\tdist = saturate( dist );\n\tgl_FragColor = packDepthToRGBA( dist );\n}",equirect_vert:"varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n}",equirect_frag:"uniform sampler2D tEquirect;\nvarying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvec3 direction = normalize( vWorldDirection );\n\tvec2 sampleUV = equirectUv( direction );\n\tgl_FragColor = texture2D( tEquirect, sampleUV );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n}",linedashed_vert:"uniform float scale;\nattribute float lineDistance;\nvarying float vLineDistance;\n#include <common>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\tvLineDistance = scale * lineDistance;\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n}",linedashed_frag:"uniform vec3 diffuse;\nuniform float opacity;\nuniform float dashSize;\nuniform float totalSize;\nvarying float vLineDistance;\n#include <common>\n#include <color_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tif ( mod( vLineDistance, totalSize ) > dashSize ) {\n\t\tdiscard;\n\t}\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <color_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n}",meshbasic_vert:"#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#if defined ( USE_ENVMAP ) || defined ( USE_SKINNING )\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinbase_vertex>\n\t\t#include <skinnormal_vertex>\n\t\t#include <defaultnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <fog_vertex>\n}",meshbasic_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\t#ifdef USE_LIGHTMAP\n\t\tvec4 lightMapTexel = texture2D( lightMap, vUv2 );\n\t\treflectedLight.indirectDiffuse += lightMapTexel.rgb * lightMapIntensity * RECIPROCAL_PI;\n\t#else\n\t\treflectedLight.indirectDiffuse += vec3( 1.0 );\n\t#endif\n\t#include <aomap_fragment>\n\treflectedLight.indirectDiffuse *= diffuseColor.rgb;\n\tvec3 outgoingLight = reflectedLight.indirectDiffuse;\n\t#include <envmap_fragment>\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshlambert_vert:"#define LAMBERT\nvarying vec3 vViewPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshlambert_frag:"#define LAMBERT\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_lambert_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_lambert_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;\n\t#include <envmap_fragment>\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshmatcap_vert:"#define MATCAP\nvarying vec3 vViewPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <color_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n\tvViewPosition = - mvPosition.xyz;\n}",meshmatcap_frag:"#define MATCAP\nuniform vec3 diffuse;\nuniform float opacity;\nuniform sampler2D matcap;\nvarying vec3 vViewPosition;\n#include <common>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <fog_pars_fragment>\n#include <normal_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\tvec3 viewDir = normalize( vViewPosition );\n\tvec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );\n\tvec3 y = cross( viewDir, x );\n\tvec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5;\n\t#ifdef USE_MATCAP\n\t\tvec4 matcapColor = texture2D( matcap, uv );\n\t#else\n\t\tvec4 matcapColor = vec4( vec3( mix( 0.2, 0.8, uv.y ) ), 1.0 );\n\t#endif\n\tvec3 outgoingLight = diffuseColor.rgb * matcapColor.rgb;\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshnormal_vert:"#define NORMAL\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )\n\tvarying vec3 vViewPosition;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )\n\tvViewPosition = - mvPosition.xyz;\n#endif\n}",meshnormal_frag:"#define NORMAL\nuniform float opacity;\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )\n\tvarying vec3 vViewPosition;\n#endif\n#include <packing>\n#include <uv_pars_fragment>\n#include <normal_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\t#include <logdepthbuf_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\tgl_FragColor = vec4( packNormalToRGB( normal ), opacity );\n\t#ifdef OPAQUE\n\t\tgl_FragColor.a = 1.0;\n\t#endif\n}",meshphong_vert:"#define PHONG\nvarying vec3 vViewPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshphong_frag:"#define PHONG\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform vec3 specular;\nuniform float shininess;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_phong_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_phong_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;\n\t#include <envmap_fragment>\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshphysical_vert:"#define STANDARD\nvarying vec3 vViewPosition;\n#ifdef USE_TRANSMISSION\n\tvarying vec3 vWorldPosition;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n#ifdef USE_TRANSMISSION\n\tvWorldPosition = worldPosition.xyz;\n#endif\n}",meshphysical_frag:"#define STANDARD\n#ifdef PHYSICAL\n\t#define IOR\n\t#define SPECULAR\n#endif\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float roughness;\nuniform float metalness;\nuniform float opacity;\n#ifdef IOR\n\tuniform float ior;\n#endif\n#ifdef SPECULAR\n\tuniform float specularIntensity;\n\tuniform vec3 specularColor;\n\t#ifdef USE_SPECULARINTENSITYMAP\n\t\tuniform sampler2D specularIntensityMap;\n\t#endif\n\t#ifdef USE_SPECULARCOLORMAP\n\t\tuniform sampler2D specularColorMap;\n\t#endif\n#endif\n#ifdef USE_CLEARCOAT\n\tuniform float clearcoat;\n\tuniform float clearcoatRoughness;\n#endif\n#ifdef USE_IRIDESCENCE\n\tuniform float iridescence;\n\tuniform float iridescenceIOR;\n\tuniform float iridescenceThicknessMinimum;\n\tuniform float iridescenceThicknessMaximum;\n#endif\n#ifdef USE_SHEEN\n\tuniform vec3 sheenColor;\n\tuniform float sheenRoughness;\n\t#ifdef USE_SHEENCOLORMAP\n\t\tuniform sampler2D sheenColorMap;\n\t#endif\n\t#ifdef USE_SHEENROUGHNESSMAP\n\t\tuniform sampler2D sheenRoughnessMap;\n\t#endif\n#endif\nvarying vec3 vViewPosition;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <bsdfs>\n#include <iridescence_fragment>\n#include <cube_uv_reflection_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_physical_pars_fragment>\n#include <fog_pars_fragment>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_physical_pars_fragment>\n#include <transmission_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <clearcoat_pars_fragment>\n#include <iridescence_pars_fragment>\n#include <roughnessmap_pars_fragment>\n#include <metalnessmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <roughnessmap_fragment>\n\t#include <metalnessmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <clearcoat_normal_fragment_begin>\n\t#include <clearcoat_normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_physical_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 totalDiffuse = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse;\n\tvec3 totalSpecular = reflectedLight.directSpecular + reflectedLight.indirectSpecular;\n\t#include <transmission_fragment>\n\tvec3 outgoingLight = totalDiffuse + totalSpecular + totalEmissiveRadiance;\n\t#ifdef USE_SHEEN\n\t\tfloat sheenEnergyComp = 1.0 - 0.157 * max3( material.sheenColor );\n\t\toutgoingLight = outgoingLight * sheenEnergyComp + sheenSpecular;\n\t#endif\n\t#ifdef USE_CLEARCOAT\n\t\tfloat dotNVcc = saturate( dot( geometry.clearcoatNormal, geometry.viewDir ) );\n\t\tvec3 Fcc = F_Schlick( material.clearcoatF0, material.clearcoatF90, dotNVcc );\n\t\toutgoingLight = outgoingLight * ( 1.0 - material.clearcoat * Fcc ) + clearcoatSpecular * material.clearcoat;\n\t#endif\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshtoon_vert:"#define TOON\nvarying vec3 vViewPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshtoon_frag:"#define TOON\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <gradientmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_toon_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_toon_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",points_vert:"uniform float size;\nuniform float scale;\n#include <common>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <project_vertex>\n\tgl_PointSize = size;\n\t#ifdef USE_SIZEATTENUATION\n\t\tbool isPerspective = isPerspectiveMatrix( projectionMatrix );\n\t\tif ( isPerspective ) gl_PointSize *= ( scale / - mvPosition.z );\n\t#endif\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <fog_vertex>\n}",points_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#include <common>\n#include <color_pars_fragment>\n#include <map_particle_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_particle_fragment>\n\t#include <color_fragment>\n\t#include <alphatest_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n}",shadow_vert:"#include <common>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <shadowmap_pars_vertex>\nvoid main() {\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",shadow_frag:"uniform vec3 color;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <logdepthbuf_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <shadowmask_pars_fragment>\nvoid main() {\n\t#include <logdepthbuf_fragment>\n\tgl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}",sprite_vert:"uniform float rotation;\nuniform vec2 center;\n#include <common>\n#include <uv_pars_vertex>\n#include <fog_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\tvec4 mvPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );\n\tvec2 scale;\n\tscale.x = length( vec3( modelMatrix[ 0 ].x, modelMatrix[ 0 ].y, modelMatrix[ 0 ].z ) );\n\tscale.y = length( vec3( modelMatrix[ 1 ].x, modelMatrix[ 1 ].y, modelMatrix[ 1 ].z ) );\n\t#ifndef USE_SIZEATTENUATION\n\t\tbool isPerspective = isPerspectiveMatrix( projectionMatrix );\n\t\tif ( isPerspective ) scale *= - mvPosition.z;\n\t#endif\n\tvec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale;\n\tvec2 rotatedPosition;\n\trotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;\n\trotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;\n\tmvPosition.xy += rotatedPosition;\n\tgl_Position = projectionMatrix * mvPosition;\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n}",sprite_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#include <common>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}"},Vi={common:{diffuse:{value:new zn(16777215)},opacity:{value:1},map:{value:null},uvTransform:{value:new Qt},uv2Transform:{value:new Qt},alphaMap:{value:null},alphaTest:{value:0}},specularmap:{specularMap:{value:null}},envmap:{envMap:{value:null},flipEnvMap:{value:-1},reflectivity:{value:1},ior:{value:1.5},refractionRatio:{value:.98}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1}},emissivemap:{emissiveMap:{value:null}},bumpmap:{bumpMap:{value:null},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalScale:{value:new Kt(1,1)}},displacementmap:{displacementMap:{value:null},displacementScale:{value:1},displacementBias:{value:0}},roughnessmap:{roughnessMap:{value:null}},metalnessmap:{metalnessMap:{value:null}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:25e-5},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new zn(16777215)}},lights:{ambientLightColor:{value:[]},lightProbe:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{}}},directionalLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{}}},spotLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},spotLightMap:{value:[]},spotShadowMap:{value:[]},spotLightMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{}}},pointLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{},shadowCameraNear:{},shadowCameraFar:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}},ltc_1:{value:null},ltc_2:{value:null}},points:{diffuse:{value:new zn(16777215)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},alphaMap:{value:null},alphaTest:{value:0},uvTransform:{value:new Qt}},sprite:{diffuse:{value:new zn(16777215)},opacity:{value:1},center:{value:new Kt(.5,.5)},rotation:{value:0},map:{value:null},alphaMap:{value:null},alphaTest:{value:0},uvTransform:{value:new Qt}}},Hi={basic:{uniforms:wi([Vi.common,Vi.specularmap,Vi.envmap,Vi.aomap,Vi.lightmap,Vi.fog]),vertexShader:Gi.meshbasic_vert,fragmentShader:Gi.meshbasic_frag},lambert:{uniforms:wi([Vi.common,Vi.specularmap,Vi.envmap,Vi.aomap,Vi.lightmap,Vi.emissivemap,Vi.bumpmap,Vi.normalmap,Vi.displacementmap,Vi.fog,Vi.lights,{emissive:{value:new zn(0)}}]),vertexShader:Gi.meshlambert_vert,fragmentShader:Gi.meshlambert_frag},phong:{uniforms:wi([Vi.common,Vi.specularmap,Vi.envmap,Vi.aomap,Vi.lightmap,Vi.emissivemap,Vi.bumpmap,Vi.normalmap,Vi.displacementmap,Vi.fog,Vi.lights,{emissive:{value:new zn(0)},specular:{value:new zn(1118481)},shininess:{value:30}}]),vertexShader:Gi.meshphong_vert,fragmentShader:Gi.meshphong_frag},standard:{uniforms:wi([Vi.common,Vi.envmap,Vi.aomap,Vi.lightmap,Vi.emissivemap,Vi.bumpmap,Vi.normalmap,Vi.displacementmap,Vi.roughnessmap,Vi.metalnessmap,Vi.fog,Vi.lights,{emissive:{value:new zn(0)},roughness:{value:1},metalness:{value:0},envMapIntensity:{value:1}}]),vertexShader:Gi.meshphysical_vert,fragmentShader:Gi.meshphysical_frag},toon:{uniforms:wi([Vi.common,Vi.aomap,Vi.lightmap,Vi.emissivemap,Vi.bumpmap,Vi.normalmap,Vi.displacementmap,Vi.gradientmap,Vi.fog,Vi.lights,{emissive:{value:new zn(0)}}]),vertexShader:Gi.meshtoon_vert,fragmentShader:Gi.meshtoon_frag},matcap:{uniforms:wi([Vi.common,Vi.bumpmap,Vi.normalmap,Vi.displacementmap,Vi.fog,{matcap:{value:null}}]),vertexShader:Gi.meshmatcap_vert,fragmentShader:Gi.meshmatcap_frag},points:{uniforms:wi([Vi.points,Vi.fog]),vertexShader:Gi.points_vert,fragmentShader:Gi.points_frag},dashed:{uniforms:wi([Vi.common,Vi.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:Gi.linedashed_vert,fragmentShader:Gi.linedashed_frag},depth:{uniforms:wi([Vi.common,Vi.displacementmap]),vertexShader:Gi.depth_vert,fragmentShader:Gi.depth_frag},normal:{uniforms:wi([Vi.common,Vi.bumpmap,Vi.normalmap,Vi.displacementmap,{opacity:{value:1}}]),vertexShader:Gi.meshnormal_vert,fragmentShader:Gi.meshnormal_frag},sprite:{uniforms:wi([Vi.sprite,Vi.fog]),vertexShader:Gi.sprite_vert,fragmentShader:Gi.sprite_frag},background:{uniforms:{uvTransform:{value:new Qt},t2D:{value:null},backgroundIntensity:{value:1}},vertexShader:Gi.background_vert,fragmentShader:Gi.background_frag},backgroundCube:{uniforms:{envMap:{value:null},flipEnvMap:{value:-1},backgroundBlurriness:{value:0},backgroundIntensity:{value:1}},vertexShader:Gi.backgroundCube_vert,fragmentShader:Gi.backgroundCube_frag},cube:{uniforms:{tCube:{value:null},tFlip:{value:-1},opacity:{value:1}},vertexShader:Gi.cube_vert,fragmentShader:Gi.cube_frag},equirect:{uniforms:{tEquirect:{value:null}},vertexShader:Gi.equirect_vert,fragmentShader:Gi.equirect_frag},distanceRGBA:{uniforms:wi([Vi.common,Vi.displacementmap,{referencePosition:{value:new nr},nearDistance:{value:1},farDistance:{value:1e3}}]),vertexShader:Gi.distanceRGBA_vert,fragmentShader:Gi.distanceRGBA_frag},shadow:{uniforms:wi([Vi.lights,Vi.fog,{color:{value:new zn(0)},opacity:{value:1}}]),vertexShader:Gi.shadow_vert,fragmentShader:Gi.shadow_frag}};Hi.physical={uniforms:wi([Hi.standard.uniforms,{clearcoat:{value:0},clearcoatMap:{value:null},clearcoatRoughness:{value:0},clearcoatRoughnessMap:{value:null},clearcoatNormalScale:{value:new Kt(1,1)},clearcoatNormalMap:{value:null},iridescence:{value:0},iridescenceMap:{value:null},iridescenceIOR:{value:1.3},iridescenceThicknessMinimum:{value:100},iridescenceThicknessMaximum:{value:400},iridescenceThicknessMap:{value:null},sheen:{value:0},sheenColor:{value:new zn(0)},sheenColorMap:{value:null},sheenRoughness:{value:1},sheenRoughnessMap:{value:null},transmission:{value:0},transmissionMap:{value:null},transmissionSamplerSize:{value:new Kt},transmissionSamplerMap:{value:null},thickness:{value:0},thicknessMap:{value:null},attenuationDistance:{value:0},attenuationColor:{value:new zn(0)},specularIntensity:{value:1},specularIntensityMap:{value:null},specularColor:{value:new zn(1,1,1)},specularColorMap:{value:null}}]),vertexShader:Gi.meshphysical_vert,fragmentShader:Gi.meshphysical_frag};const Wi={r:0,b:0,g:0};function Xi(e,t,r,n,i,s,o){const a=new zn(0);let l,c,u=!0===s?0:1,h=null,f=0,m=null;function g(t,r){t.getRGB(Wi,Si(e)),n.buffers.color.setClear(Wi.r,Wi.g,Wi.b,r,o)}return{getClearColor:function(){return a},setClearColor:function(e,t=1){a.set(e),u=t,g(a,u)},getClearAlpha:function(){return u},setClearAlpha:function(e){u=e,g(a,u)},render:function(n,s){let o=!1,y=!0===s.isScene?s.background:null;if(y&&y.isTexture){y=(s.backgroundBlurriness>0?r:t).get(y)}const v=e.xr,_=v.getSession&&v.getSession();_&&"additive"===_.environmentBlendMode&&(y=null),null===y?g(a,u):y&&y.isColor&&(g(y,1),o=!0),(e.autoClear||o)&&e.clear(e.autoClearColor,e.autoClearDepth,e.autoClearStencil),y&&(y.isCubeTexture||y.mapping===ie)?(void 0===c&&(c=new vi(new xi(1,1,1),new Ti({name:"BackgroundCubeMaterial",uniforms:bi(Hi.backgroundCube.uniforms),vertexShader:Hi.backgroundCube.vertexShader,fragmentShader:Hi.backgroundCube.fragmentShader,side:p,depthTest:!1,depthWrite:!1,fog:!1})),c.geometry.deleteAttribute("normal"),c.geometry.deleteAttribute("uv"),c.onBeforeRender=function(e,t,r){this.matrixWorld.copyPosition(r.matrixWorld)},Object.defineProperty(c.material,"envMap",{get:function(){return this.uniforms.envMap.value}}),i.update(c)),c.material.uniforms.envMap.value=y,c.material.uniforms.flipEnvMap.value=y.isCubeTexture&&!1===y.isRenderTargetTexture?-1:1,c.material.uniforms.backgroundBlurriness.value=s.backgroundBlurriness,c.material.uniforms.backgroundIntensity.value=s.backgroundIntensity,c.material.toneMapped=y.encoding!==Tt,h===y&&f===y.version&&m===e.toneMapping||(c.material.needsUpdate=!0,h=y,f=y.version,m=e.toneMapping),c.layers.enableAll(),n.unshift(c,c.geometry,c.material,0,0,null)):y&&y.isTexture&&(void 0===l&&(l=new vi(new zi(2,2),new Ti({name:"BackgroundMaterial",uniforms:bi(Hi.background.uniforms),vertexShader:Hi.background.vertexShader,fragmentShader:Hi.background.fragmentShader,side:d,depthTest:!1,depthWrite:!1,fog:!1})),l.geometry.deleteAttribute("normal"),Object.defineProperty(l.material,"map",{get:function(){return this.uniforms.t2D.value}}),i.update(l)),l.material.uniforms.t2D.value=y,l.material.uniforms.backgroundIntensity.value=s.backgroundIntensity,l.material.toneMapped=y.encoding!==Tt,!0===y.matrixAutoUpdate&&y.updateMatrix(),l.material.uniforms.uvTransform.value.copy(y.matrix),h===y&&f===y.version&&m===e.toneMapping||(l.material.needsUpdate=!0,h=y,f=y.version,m=e.toneMapping),l.layers.enableAll(),n.unshift(l,l.geometry,l.material,0,0,null))}}}function qi(e,t,r,n){const i=e.getParameter(34921),s=n.isWebGL2?null:t.get("OES_vertex_array_object"),o=n.isWebGL2||null!==s,a={},l=p(null);let c=l,u=!1;function h(t){return n.isWebGL2?e.bindVertexArray(t):s.bindVertexArrayOES(t)}function d(t){return n.isWebGL2?e.deleteVertexArray(t):s.deleteVertexArrayOES(t)}function p(e){const t=[],r=[],n=[];for(let e=0;e<i;e++)t[e]=0,r[e]=0,n[e]=0;return{geometry:null,program:null,wireframe:!1,newAttributes:t,enabledAttributes:r,attributeDivisors:n,object:e,attributes:{},index:null}}function f(){const e=c.newAttributes;for(let t=0,r=e.length;t<r;t++)e[t]=0}function m(e){g(e,0)}function g(r,i){const s=c.newAttributes,o=c.enabledAttributes,a=c.attributeDivisors;if(s[r]=1,0===o[r]&&(e.enableVertexAttribArray(r),o[r]=1),a[r]!==i){(n.isWebGL2?e:t.get("ANGLE_instanced_arrays"))[n.isWebGL2?"vertexAttribDivisor":"vertexAttribDivisorANGLE"](r,i),a[r]=i}}function y(){const t=c.newAttributes,r=c.enabledAttributes;for(let n=0,i=r.length;n<i;n++)r[n]!==t[n]&&(e.disableVertexAttribArray(n),r[n]=0)}function v(t,r,i,s,o,a){!0!==n.isWebGL2||5124!==i&&5125!==i?e.vertexAttribPointer(t,r,i,s,o,a):e.vertexAttribIPointer(t,r,i,o,a)}function _(){x(),u=!0,c!==l&&(c=l,h(c.object))}function x(){l.geometry=null,l.program=null,l.wireframe=!1}return{setup:function(i,l,d,_,x){let b=!1;if(o){const t=function(t,r,i){const o=!0===i.wireframe;let l=a[t.id];void 0===l&&(l={},a[t.id]=l);let c=l[r.id];void 0===c&&(c={},l[r.id]=c);let u=c[o];void 0===u&&(u=p(n.isWebGL2?e.createVertexArray():s.createVertexArrayOES()),c[o]=u);return u}(_,d,l);c!==t&&(c=t,h(c.object)),b=function(e,t,r,n){const i=c.attributes,s=t.attributes;let o=0;const a=r.getAttributes();for(const t in a){if(a[t].location>=0){const r=i[t];let n=s[t];if(void 0===n&&("instanceMatrix"===t&&e.instanceMatrix&&(n=e.instanceMatrix),"instanceColor"===t&&e.instanceColor&&(n=e.instanceColor)),void 0===r)return!0;if(r.attribute!==n)return!0;if(n&&r.data!==n.data)return!0;o++}}return c.attributesNum!==o||c.index!==n}(i,_,d,x),b&&function(e,t,r,n){const i={},s=t.attributes;let o=0;const a=r.getAttributes();for(const t in a){if(a[t].location>=0){let r=s[t];void 0===r&&("instanceMatrix"===t&&e.instanceMatrix&&(r=e.instanceMatrix),"instanceColor"===t&&e.instanceColor&&(r=e.instanceColor));const n={};n.attribute=r,r&&r.data&&(n.data=r.data),i[t]=n,o++}}c.attributes=i,c.attributesNum=o,c.index=n}(i,_,d,x)}else{const e=!0===l.wireframe;c.geometry===_.id&&c.program===d.id&&c.wireframe===e||(c.geometry=_.id,c.program=d.id,c.wireframe=e,b=!0)}null!==x&&r.update(x,34963),(b||u)&&(u=!1,function(i,s,o,a){if(!1===n.isWebGL2&&(i.isInstancedMesh||a.isInstancedBufferGeometry)&&null===t.get("ANGLE_instanced_arrays"))return;f();const l=a.attributes,c=o.getAttributes(),u=s.defaultAttributeValues;for(const t in c){const n=c[t];if(n.location>=0){let s=l[t];if(void 0===s&&("instanceMatrix"===t&&i.instanceMatrix&&(s=i.instanceMatrix),"instanceColor"===t&&i.instanceColor&&(s=i.instanceColor)),void 0!==s){const t=s.normalized,o=s.itemSize,l=r.get(s);if(void 0===l)continue;const c=l.buffer,u=l.type,h=l.bytesPerElement;if(s.isInterleavedBufferAttribute){const r=s.data,l=r.stride,d=s.offset;if(r.isInstancedInterleavedBuffer){for(let e=0;e<n.locationSize;e++)g(n.location+e,r.meshPerAttribute);!0!==i.isInstancedMesh&&void 0===a._maxInstanceCount&&(a._maxInstanceCount=r.meshPerAttribute*r.count)}else for(let e=0;e<n.locationSize;e++)m(n.location+e);e.bindBuffer(34962,c);for(let e=0;e<n.locationSize;e++)v(n.location+e,o/n.locationSize,u,t,l*h,(d+o/n.locationSize*e)*h)}else{if(s.isInstancedBufferAttribute){for(let e=0;e<n.locationSize;e++)g(n.location+e,s.meshPerAttribute);!0!==i.isInstancedMesh&&void 0===a._maxInstanceCount&&(a._maxInstanceCount=s.meshPerAttribute*s.count)}else for(let e=0;e<n.locationSize;e++)m(n.location+e);e.bindBuffer(34962,c);for(let e=0;e<n.locationSize;e++)v(n.location+e,o/n.locationSize,u,t,o*h,o/n.locationSize*e*h)}}else if(void 0!==u){const r=u[t];if(void 0!==r)switch(r.length){case 2:e.vertexAttrib2fv(n.location,r);break;case 3:e.vertexAttrib3fv(n.location,r);break;case 4:e.vertexAttrib4fv(n.location,r);break;default:e.vertexAttrib1fv(n.location,r)}}}}y()}(i,l,d,_),null!==x&&e.bindBuffer(34963,r.get(x).buffer))},reset:_,resetDefaultState:x,dispose:function(){_();for(const e in a){const t=a[e];for(const e in t){const r=t[e];for(const e in r)d(r[e].object),delete r[e];delete t[e]}delete a[e]}},releaseStatesOfGeometry:function(e){if(void 0===a[e.id])return;const t=a[e.id];for(const e in t){const r=t[e];for(const e in r)d(r[e].object),delete r[e];delete t[e]}delete a[e.id]},releaseStatesOfProgram:function(e){for(const t in a){const r=a[t];if(void 0===r[e.id])continue;const n=r[e.id];for(const e in n)d(n[e].object),delete n[e];delete r[e.id]}},initAttributes:f,enableAttribute:m,disableUnusedAttributes:y}}function Yi(e,t,r,n){const i=n.isWebGL2;let s;this.setMode=function(e){s=e},this.render=function(t,n){e.drawArrays(s,t,n),r.update(n,s,1)},this.renderInstances=function(n,o,a){if(0===a)return;let l,c;if(i)l=e,c="drawArraysInstanced";else if(l=t.get("ANGLE_instanced_arrays"),c="drawArraysInstancedANGLE",null===l)return;l[c](s,n,o,a),r.update(o,s,a)}}function Zi(e,t,r){let n;function i(t){if("highp"===t){if(e.getShaderPrecisionFormat(35633,36338).precision>0&&e.getShaderPrecisionFormat(35632,36338).precision>0)return"highp";t="mediump"}return"mediump"===t&&e.getShaderPrecisionFormat(35633,36337).precision>0&&e.getShaderPrecisionFormat(35632,36337).precision>0?"mediump":"lowp"}const s="undefined"!=typeof WebGL2RenderingContext&&e instanceof WebGL2RenderingContext;let o=void 0!==r.precision?r.precision:"highp";const a=i(o);a!==o&&(o=a);const l=s||t.has("WEBGL_draw_buffers"),c=!0===r.logarithmicDepthBuffer,u=e.getParameter(34930),h=e.getParameter(35660),d=e.getParameter(3379),p=e.getParameter(34076),f=e.getParameter(34921),m=e.getParameter(36347),g=e.getParameter(36348),y=e.getParameter(36349),v=h>0,_=s||t.has("OES_texture_float");return{isWebGL2:s,drawBuffers:l,getMaxAnisotropy:function(){if(void 0!==n)return n;if(!0===t.has("EXT_texture_filter_anisotropic")){const r=t.get("EXT_texture_filter_anisotropic");n=e.getParameter(r.MAX_TEXTURE_MAX_ANISOTROPY_EXT)}else n=0;return n},getMaxPrecision:i,precision:o,logarithmicDepthBuffer:c,maxTextures:u,maxVertexTextures:h,maxTextureSize:d,maxCubemapSize:p,maxAttributes:f,maxVertexUniforms:m,maxVaryings:g,maxFragmentUniforms:y,vertexTextures:v,floatFragmentTextures:_,floatVertexTextures:v&&_,maxSamples:s?e.getParameter(36183):0}}function Ji(e){const t=this;let r=null,n=0,i=!1,s=!1;const o=new Oi,a=new Qt,l={value:null,needsUpdate:!1};function c(e,r,n,i){const s=null!==e?e.length:0;let c=null;if(0!==s){if(c=l.value,!0!==i||null===c){const t=n+4*s,i=r.matrixWorldInverse;a.getNormalMatrix(i),(null===c||c.length<t)&&(c=new Float32Array(t));for(let t=0,r=n;t!==s;++t,r+=4)o.copy(e[t]).applyMatrix4(i,a),o.normal.toArray(c,r),c[r+3]=o.constant}l.value=c,l.needsUpdate=!0}return t.numPlanes=s,t.numIntersection=0,c}this.uniform=l,this.numPlanes=0,this.numIntersection=0,this.init=function(e,t){const r=0!==e.length||t||0!==n||i;return i=t,n=e.length,r},this.beginShadows=function(){s=!0,c(null)},this.endShadows=function(){s=!1},this.setGlobalState=function(e,t){r=c(e,t,0)},this.setState=function(o,a,u){const h=o.clippingPlanes,d=o.clipIntersection,p=o.clipShadows,f=e.get(o);if(!i||null===h||0===h.length||s&&!p)s?c(null):function(){l.value!==r&&(l.value=r,l.needsUpdate=n>0);t.numPlanes=n,t.numIntersection=0}();else{const e=s?0:n,t=4*e;let i=f.clippingState||null;l.value=i,i=c(h,a,t,u);for(let e=0;e!==t;++e)i[e]=r[e];f.clippingState=i,this.numIntersection=d?this.numPlanes:0,this.numPlanes+=e}}}function Ki(e){let t=new WeakMap;function r(e,t){return t===re?e.mapping=ee:t===ne&&(e.mapping=te),e}function n(e){const r=e.target;r.removeEventListener("dispose",n);const i=t.get(r);void 0!==i&&(t.delete(r),i.dispose())}return{get:function(i){if(i&&i.isTexture&&!1===i.isRenderTargetTexture){const s=i.mapping;if(s===re||s===ne){if(t.has(i)){return r(t.get(i).texture,i.mapping)}{const s=i.image;if(s&&s.height>0){const o=new Pi(s.height/2);return o.fromEquirectangularTexture(e,i),t.set(i,o),i.addEventListener("dispose",n),r(o.texture,i.mapping)}return null}}}return i},dispose:function(){t=new WeakMap}}}class Qi extends Ei{constructor(e=-1,t=1,r=1,n=-1,i=.1,s=2e3){super(),this.isOrthographicCamera=!0,this.type="OrthographicCamera",this.zoom=1,this.view=null,this.left=e,this.right=t,this.top=r,this.bottom=n,this.near=i,this.far=s,this.updateProjectionMatrix()}copy(e,t){return super.copy(e,t),this.left=e.left,this.right=e.right,this.top=e.top,this.bottom=e.bottom,this.near=e.near,this.far=e.far,this.zoom=e.zoom,this.view=null===e.view?null:Object.assign({},e.view),this}setViewOffset(e,t,r,n,i,s){null===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=r,this.view.offsetY=n,this.view.width=i,this.view.height=s,this.updateProjectionMatrix()}clearViewOffset(){null!==this.view&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const e=(this.right-this.left)/(2*this.zoom),t=(this.top-this.bottom)/(2*this.zoom),r=(this.right+this.left)/2,n=(this.top+this.bottom)/2;let i=r-e,s=r+e,o=n+t,a=n-t;if(null!==this.view&&this.view.enabled){const e=(this.right-this.left)/this.view.fullWidth/this.zoom,t=(this.top-this.bottom)/this.view.fullHeight/this.zoom;i+=e*this.view.offsetX,s=i+e*this.view.width,o-=t*this.view.offsetY,a=o-t*this.view.height}this.projectionMatrix.makeOrthographic(i,s,o,a,this.near,this.far),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){const t=super.toJSON(e);return t.object.zoom=this.zoom,t.object.left=this.left,t.object.right=this.right,t.object.top=this.top,t.object.bottom=this.bottom,t.object.near=this.near,t.object.far=this.far,null!==this.view&&(t.object.view=Object.assign({},this.view)),t}}const $i=4,es=[.125,.215,.35,.446,.526,.582],ts=20,rs=new Qi,ns=new zn;let is=null;const ss=(1+Math.sqrt(5))/2,os=1/ss,as=[new nr(1,1,1),new nr(-1,1,1),new nr(1,1,-1),new nr(-1,1,-1),new nr(0,ss,os),new nr(0,ss,-os),new nr(os,0,ss),new nr(-os,0,ss),new nr(ss,os,0),new nr(-ss,os,0)];class ls{constructor(e){this._renderer=e,this._pingPongRenderTarget=null,this._lodMax=0,this._cubeSize=0,this._lodPlanes=[],this._sizeLods=[],this._sigmas=[],this._blurMaterial=null,this._cubemapMaterial=null,this._equirectMaterial=null,this._compileMaterial(this._blurMaterial)}fromScene(e,t=0,r=.1,n=100){is=this._renderer.getRenderTarget(),this._setSize(256);const i=this._allocateTargets();return i.depthBuffer=!0,this._sceneToCubeUV(e,r,n,i),t>0&&this._blur(i,0,0,t),this._applyPMREM(i),this._cleanup(i),i}fromEquirectangular(e,t=null){return this._fromTexture(e,t)}fromCubemap(e,t=null){return this._fromTexture(e,t)}compileCubemapShader(){null===this._cubemapMaterial&&(this._cubemapMaterial=ds(),this._compileMaterial(this._cubemapMaterial))}compileEquirectangularShader(){null===this._equirectMaterial&&(this._equirectMaterial=hs(),this._compileMaterial(this._equirectMaterial))}dispose(){this._dispose(),null!==this._cubemapMaterial&&this._cubemapMaterial.dispose(),null!==this._equirectMaterial&&this._equirectMaterial.dispose()}_setSize(e){this._lodMax=Math.floor(Math.log2(e)),this._cubeSize=Math.pow(2,this._lodMax)}_dispose(){null!==this._blurMaterial&&this._blurMaterial.dispose(),null!==this._pingPongRenderTarget&&this._pingPongRenderTarget.dispose();for(let e=0;e<this._lodPlanes.length;e++)this._lodPlanes[e].dispose()}_cleanup(e){this._renderer.setRenderTarget(is),e.scissorTest=!1,us(e,0,0,e.width,e.height)}_fromTexture(e,t){e.mapping===ee||e.mapping===te?this._setSize(0===e.image.length?16:e.image[0].width||e.image[0].image.width):this._setSize(e.image.width/4),is=this._renderer.getRenderTarget();const r=t||this._allocateTargets();return this._textureToCubeUV(e,r),this._applyPMREM(r),this._cleanup(r),r}_allocateTargets(){const e=3*Math.max(this._cubeSize,112),t=4*this._cubeSize,r={magFilter:he,minFilter:he,generateMipmaps:!1,type:be,format:Ee,encoding:Mt,depthBuffer:!1},n=cs(e,t,r);if(null===this._pingPongRenderTarget||this._pingPongRenderTarget.width!==e||this._pingPongRenderTarget.height!==t){null!==this._pingPongRenderTarget&&this._dispose(),this._pingPongRenderTarget=cs(e,t,r);const{_lodMax:n}=this;({sizeLods:this._sizeLods,lodPlanes:this._lodPlanes,sigmas:this._sigmas}=function(e){const t=[],r=[],n=[];let i=e;const s=e-$i+1+es.length;for(let o=0;o<s;o++){const s=Math.pow(2,i);r.push(s);let a=1/s;o>e-$i?a=es[o-e+$i-1]:0===o&&(a=0),n.push(a);const l=1/(s-2),c=-l,u=1+l,h=[c,c,u,c,u,u,c,c,u,u,c,u],d=6,p=6,f=3,m=2,g=1,y=new Float32Array(f*p*d),v=new Float32Array(m*p*d),_=new Float32Array(g*p*d);for(let e=0;e<d;e++){const t=e%3*2/3-1,r=e>2?0:-1,n=[t,r,0,t+2/3,r,0,t+2/3,r+1,0,t,r,0,t+2/3,r+1,0,t,r+1,0];y.set(n,f*p*e),v.set(h,m*p*e);const i=[e,e,e,e,e,e];_.set(i,g*p*e)}const x=new ni;x.setAttribute("position",new Xn(y,f)),x.setAttribute("uv",new Xn(v,m)),x.setAttribute("faceIndex",new Xn(_,g)),t.push(x),i>$i&&i--}return{lodPlanes:t,sizeLods:r,sigmas:n}}(n)),this._blurMaterial=function(e,t,r){const n=new Float32Array(ts),i=new nr(0,1,0),s=new Ti({name:"SphericalGaussianBlur",defines:{n:ts,CUBEUV_TEXEL_WIDTH:1/t,CUBEUV_TEXEL_HEIGHT:1/r,CUBEUV_MAX_MIP:`${e}.0`},uniforms:{envMap:{value:null},samples:{value:1},weights:{value:n},latitudinal:{value:!1},dTheta:{value:0},mipInt:{value:0},poleAxis:{value:i}},vertexShader:ps(),fragmentShader:"\n\n\t\t\tprecision mediump float;\n\t\t\tprecision mediump int;\n\n\t\t\tvarying vec3 vOutputDirection;\n\n\t\t\tuniform sampler2D envMap;\n\t\t\tuniform int samples;\n\t\t\tuniform float weights[ n ];\n\t\t\tuniform bool latitudinal;\n\t\t\tuniform float dTheta;\n\t\t\tuniform float mipInt;\n\t\t\tuniform vec3 poleAxis;\n\n\t\t\t#define ENVMAP_TYPE_CUBE_UV\n\t\t\t#include <cube_uv_reflection_fragment>\n\n\t\t\tvec3 getSample( float theta, vec3 axis ) {\n\n\t\t\t\tfloat cosTheta = cos( theta );\n\t\t\t\t// Rodrigues' axis-angle rotation\n\t\t\t\tvec3 sampleDirection = vOutputDirection * cosTheta\n\t\t\t\t\t+ cross( axis, vOutputDirection ) * sin( theta )\n\t\t\t\t\t+ axis * dot( axis, vOutputDirection ) * ( 1.0 - cosTheta );\n\n\t\t\t\treturn bilinearCubeUV( envMap, sampleDirection, mipInt );\n\n\t\t\t}\n\n\t\t\tvoid main() {\n\n\t\t\t\tvec3 axis = latitudinal ? poleAxis : cross( poleAxis, vOutputDirection );\n\n\t\t\t\tif ( all( equal( axis, vec3( 0.0 ) ) ) ) {\n\n\t\t\t\t\taxis = vec3( vOutputDirection.z, 0.0, - vOutputDirection.x );\n\n\t\t\t\t}\n\n\t\t\t\taxis = normalize( axis );\n\n\t\t\t\tgl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );\n\t\t\t\tgl_FragColor.rgb += weights[ 0 ] * getSample( 0.0, axis );\n\n\t\t\t\tfor ( int i = 1; i < n; i++ ) {\n\n\t\t\t\t\tif ( i >= samples ) {\n\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t}\n\n\t\t\t\t\tfloat theta = dTheta * float( i );\n\t\t\t\t\tgl_FragColor.rgb += weights[ i ] * getSample( -1.0 * theta, axis );\n\t\t\t\t\tgl_FragColor.rgb += weights[ i ] * getSample( theta, axis );\n\n\t\t\t\t}\n\n\t\t\t}\n\t\t",blending:m,depthTest:!1,depthWrite:!1});return s}(n,e,t)}return n}_compileMaterial(e){const t=new vi(this._lodPlanes[0],e);this._renderer.compile(t,rs)}_sceneToCubeUV(e,t,r,n){const i=new Ai(90,1,t,r),s=[1,-1,1,1,1,1],o=[1,1,1,-1,-1,-1],a=this._renderer,l=a.autoClear,c=a.toneMapping;a.getClearColor(ns),a.toneMapping=Y,a.autoClear=!1;const u=new Vn({name:"PMREM.Background",side:p,depthWrite:!1,depthTest:!1}),h=new vi(new xi,u);let d=!1;const f=e.background;f?f.isColor&&(u.color.copy(f),e.background=null,d=!0):(u.color.copy(ns),d=!0);for(let t=0;t<6;t++){const r=t%3;0===r?(i.up.set(0,s[t],0),i.lookAt(o[t],0,0)):1===r?(i.up.set(0,0,s[t]),i.lookAt(0,o[t],0)):(i.up.set(0,s[t],0),i.lookAt(0,0,o[t]));const l=this._cubeSize;us(n,r*l,t>2?l:0,l,l),a.setRenderTarget(n),d&&a.render(h,i),a.render(e,i)}h.geometry.dispose(),h.material.dispose(),a.toneMapping=c,a.autoClear=l,e.background=f}_textureToCubeUV(e,t){const r=this._renderer,n=e.mapping===ee||e.mapping===te;n?(null===this._cubemapMaterial&&(this._cubemapMaterial=ds()),this._cubemapMaterial.uniforms.flipEnvMap.value=!1===e.isRenderTargetTexture?-1:1):null===this._equirectMaterial&&(this._equirectMaterial=hs());const i=n?this._cubemapMaterial:this._equirectMaterial,s=new vi(this._lodPlanes[0],i);i.uniforms.envMap.value=e;const o=this._cubeSize;us(t,0,0,3*o,2*o),r.setRenderTarget(t),r.render(s,rs)}_applyPMREM(e){const t=this._renderer,r=t.autoClear;t.autoClear=!1;for(let t=1;t<this._lodPlanes.length;t++){const r=Math.sqrt(this._sigmas[t]*this._sigmas[t]-this._sigmas[t-1]*this._sigmas[t-1]),n=as[(t-1)%as.length];this._blur(e,t-1,t,r,n)}t.autoClear=r}_blur(e,t,r,n,i){const s=this._pingPongRenderTarget;this._halfBlur(e,s,t,r,n,"latitudinal",i),this._halfBlur(s,e,r,r,n,"longitudinal",i)}_halfBlur(e,t,r,n,i,s,o){const a=this._renderer,l=this._blurMaterial,c=new vi(this._lodPlanes[n],l),u=l.uniforms,h=this._sizeLods[r]-1,d=isFinite(i)?Math.PI/(2*h):2*Math.PI/(2*ts-1),p=i/d,f=isFinite(i)?1+Math.floor(3*p):ts,m=[];let g=0;for(let e=0;e<ts;++e){const t=e/p,r=Math.exp(-t*t/2);m.push(r),0===e?g+=r:e<f&&(g+=2*r)}for(let e=0;e<m.length;e++)m[e]=m[e]/g;u.envMap.value=e.texture,u.samples.value=f,u.weights.value=m,u.latitudinal.value="latitudinal"===s,o&&(u.poleAxis.value=o);const{_lodMax:y}=this;u.dTheta.value=d,u.mipInt.value=y-r;const v=this._sizeLods[n];us(t,3*v*(n>y-$i?n-y+$i:0),4*(this._cubeSize-v),3*v,2*v),a.setRenderTarget(t),a.render(c,rs)}}function cs(e,t,r){const n=new br(e,t,r);return n.texture.mapping=ie,n.texture.name="PMREM.cubeUv",n.scissorTest=!0,n}function us(e,t,r,n,i){e.viewport.set(t,r,n,i),e.scissor.set(t,r,n,i)}function hs(){return new Ti({name:"EquirectangularToCubeUV",uniforms:{envMap:{value:null}},vertexShader:ps(),fragmentShader:"\n\n\t\t\tprecision mediump float;\n\t\t\tprecision mediump int;\n\n\t\t\tvarying vec3 vOutputDirection;\n\n\t\t\tuniform sampler2D envMap;\n\n\t\t\t#include <common>\n\n\t\t\tvoid main() {\n\n\t\t\t\tvec3 outputDirection = normalize( vOutputDirection );\n\t\t\t\tvec2 uv = equirectUv( outputDirection );\n\n\t\t\t\tgl_FragColor = vec4( texture2D ( envMap, uv ).rgb, 1.0 );\n\n\t\t\t}\n\t\t",blending:m,depthTest:!1,depthWrite:!1})}function ds(){return new Ti({name:"CubemapToCubeUV",uniforms:{envMap:{value:null},flipEnvMap:{value:-1}},vertexShader:ps(),fragmentShader:"\n\n\t\t\tprecision mediump float;\n\t\t\tprecision mediump int;\n\n\t\t\tuniform float flipEnvMap;\n\n\t\t\tvarying vec3 vOutputDirection;\n\n\t\t\tuniform samplerCube envMap;\n\n\t\t\tvoid main() {\n\n\t\t\t\tgl_FragColor = textureCube( envMap, vec3( flipEnvMap * vOutputDirection.x, vOutputDirection.yz ) );\n\n\t\t\t}\n\t\t",blending:m,depthTest:!1,depthWrite:!1})}function ps(){return"\n\n\t\tprecision mediump float;\n\t\tprecision mediump int;\n\n\t\tattribute float faceIndex;\n\n\t\tvarying vec3 vOutputDirection;\n\n\t\t// RH coordinate system; PMREM face-indexing convention\n\t\tvec3 getDirection( vec2 uv, float face ) {\n\n\t\t\tuv = 2.0 * uv - 1.0;\n\n\t\t\tvec3 direction = vec3( uv, 1.0 );\n\n\t\t\tif ( face == 0.0 ) {\n\n\t\t\t\tdirection = direction.zyx; // ( 1, v, u ) pos x\n\n\t\t\t} else if ( face == 1.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xz *= -1.0; // ( -u, 1, -v ) pos y\n\n\t\t\t} else if ( face == 2.0 ) {\n\n\t\t\t\tdirection.x *= -1.0; // ( -u, v, 1 ) pos z\n\n\t\t\t} else if ( face == 3.0 ) {\n\n\t\t\t\tdirection = direction.zyx;\n\t\t\t\tdirection.xz *= -1.0; // ( -1, v, -u ) neg x\n\n\t\t\t} else if ( face == 4.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xy *= -1.0; // ( -u, -1, v ) neg y\n\n\t\t\t} else if ( face == 5.0 ) {\n\n\t\t\t\tdirection.z *= -1.0; // ( u, v, -1 ) neg z\n\n\t\t\t}\n\n\t\t\treturn direction;\n\n\t\t}\n\n\t\tvoid main() {\n\n\t\t\tvOutputDirection = getDirection( uv, faceIndex );\n\t\t\tgl_Position = vec4( position, 1.0 );\n\n\t\t}\n\t"}function fs(e){let t=new WeakMap,r=null;function n(e){const r=e.target;r.removeEventListener("dispose",n);const i=t.get(r);void 0!==i&&(t.delete(r),i.dispose())}return{get:function(i){if(i&&i.isTexture){const s=i.mapping,o=s===re||s===ne,a=s===ee||s===te;if(o||a){if(i.isRenderTargetTexture&&!0===i.needsPMREMUpdate){i.needsPMREMUpdate=!1;let n=t.get(i);return null===r&&(r=new ls(e)),n=o?r.fromEquirectangular(i,n):r.fromCubemap(i,n),t.set(i,n),n.texture}if(t.has(i))return t.get(i).texture;{const s=i.image;if(o&&s&&s.height>0||a&&s&&function(e){let t=0;const r=6;for(let n=0;n<r;n++)void 0!==e[n]&&t++;return t===r}(s)){null===r&&(r=new ls(e));const s=o?r.fromEquirectangular(i):r.fromCubemap(i);return t.set(i,s),i.addEventListener("dispose",n),s.texture}return null}}}return i},dispose:function(){t=new WeakMap,null!==r&&(r.dispose(),r=null)}}}function ms(e){const t={};function r(r){if(void 0!==t[r])return t[r];let n;switch(r){case"WEBGL_depth_texture":n=e.getExtension("WEBGL_depth_texture")||e.getExtension("MOZ_WEBGL_depth_texture")||e.getExtension("WEBKIT_WEBGL_depth_texture");break;case"EXT_texture_filter_anisotropic":n=e.getExtension("EXT_texture_filter_anisotropic")||e.getExtension("MOZ_EXT_texture_filter_anisotropic")||e.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":n=e.getExtension("WEBGL_compressed_texture_s3tc")||e.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||e.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":n=e.getExtension("WEBGL_compressed_texture_pvrtc")||e.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;default:n=e.getExtension(r)}return t[r]=n,n}return{has:function(e){return null!==r(e)},init:function(e){e.isWebGL2?r("EXT_color_buffer_float"):(r("WEBGL_depth_texture"),r("OES_texture_float"),r("OES_texture_half_float"),r("OES_texture_half_float_linear"),r("OES_standard_derivatives"),r("OES_element_index_uint"),r("OES_vertex_array_object"),r("ANGLE_instanced_arrays")),r("OES_texture_float_linear"),r("EXT_color_buffer_half_float"),r("WEBGL_multisampled_render_to_texture")},get:function(e){const t=r(e);return t}}}function gs(e,t,r,n){const i={},s=new WeakMap;function o(e){const a=e.target;null!==a.index&&t.remove(a.index);for(const e in a.attributes)t.remove(a.attributes[e]);a.removeEventListener("dispose",o),delete i[a.id];const l=s.get(a);l&&(t.remove(l),s.delete(a)),n.releaseStatesOfGeometry(a),!0===a.isInstancedBufferGeometry&&delete a._maxInstanceCount,r.memory.geometries--}function a(e){const r=[],n=e.index,i=e.attributes.position;let o=0;if(null!==n){const e=n.array;o=n.version;for(let t=0,n=e.length;t<n;t+=3){const n=e[t+0],i=e[t+1],s=e[t+2];r.push(n,i,i,s,s,n)}}else{const e=i.array;o=i.version;for(let t=0,n=e.length/3-1;t<n;t+=3){const e=t+0,n=t+1,i=t+2;r.push(e,n,n,i,i,e)}}const a=new(er(r)?Yn:qn)(r,1);a.version=o;const l=s.get(e);l&&t.remove(l),s.set(e,a)}return{get:function(e,t){return!0===i[t.id]||(t.addEventListener("dispose",o),i[t.id]=!0,r.memory.geometries++),t},update:function(e){const r=e.attributes;for(const e in r)t.update(r[e],34962);const n=e.morphAttributes;for(const e in n){const r=n[e];for(let e=0,n=r.length;e<n;e++)t.update(r[e],34962)}},getWireframeAttribute:function(e){const t=s.get(e);if(t){const r=e.index;null!==r&&t.version<r.version&&a(e)}else a(e);return s.get(e)}}}function ys(e,t,r,n){const i=n.isWebGL2;let s,o,a;this.setMode=function(e){s=e},this.setIndex=function(e){o=e.type,a=e.bytesPerElement},this.render=function(t,n){e.drawElements(s,n,o,t*a),r.update(n,s,1)},this.renderInstances=function(n,l,c){if(0===c)return;let u,h;if(i)u=e,h="drawElementsInstanced";else if(u=t.get("ANGLE_instanced_arrays"),h="drawElementsInstancedANGLE",null===u)return;u[h](s,l,o,n*a,c),r.update(l,s,c)}}function vs(e){const t={frame:0,calls:0,triangles:0,points:0,lines:0};return{memory:{geometries:0,textures:0},render:t,programs:null,autoReset:!0,reset:function(){t.frame++,t.calls=0,t.triangles=0,t.points=0,t.lines=0},update:function(e,r,n){switch(t.calls++,r){case 4:t.triangles+=n*(e/3);break;case 1:t.lines+=n*(e/2);break;case 3:t.lines+=n*(e-1);break;case 2:t.lines+=n*e;break;case 0:t.points+=n*e}}}}function _s(e,t){return e[0]-t[0]}function xs(e,t){return Math.abs(t[1])-Math.abs(e[1])}function bs(e,t,r){const n={},i=new Float32Array(8),s=new WeakMap,o=new xr,a=[];for(let e=0;e<8;e++)a[e]=[e,0];return{update:function(l,c,u){const h=l.morphTargetInfluences;if(!0===t.isWebGL2){const d=c.morphAttributes.position||c.morphAttributes.normal||c.morphAttributes.color,p=void 0!==d?d.length:0;let f=s.get(c);if(void 0===f||f.count!==p){void 0!==f&&f.texture.dispose();const y=void 0!==c.morphAttributes.position,v=void 0!==c.morphAttributes.normal,_=void 0!==c.morphAttributes.color,x=c.morphAttributes.position||[],b=c.morphAttributes.normal||[],w=c.morphAttributes.color||[];let S=0;!0===y&&(S=1),!0===v&&(S=2),!0===_&&(S=3);let M=c.attributes.position.count*S,T=1;M>t.maxTextureSize&&(T=Math.ceil(M/t.maxTextureSize),M=t.maxTextureSize);const E=new Float32Array(M*T*4*p),A=new wr(E,M,T,p);A.type=xe,A.needsUpdate=!0;const C=4*S;for(let R=0;R<p;R++){const P=x[R],j=b[R],I=w[R],D=M*T*4*R;for(let O=0;O<P.count;O++){const N=O*C;!0===y&&(o.fromBufferAttribute(P,O),E[D+N+0]=o.x,E[D+N+1]=o.y,E[D+N+2]=o.z,E[D+N+3]=0),!0===v&&(o.fromBufferAttribute(j,O),E[D+N+4]=o.x,E[D+N+5]=o.y,E[D+N+6]=o.z,E[D+N+7]=0),!0===_&&(o.fromBufferAttribute(I,O),E[D+N+8]=o.x,E[D+N+9]=o.y,E[D+N+10]=o.z,E[D+N+11]=4===I.itemSize?o.w:1)}}function L(){A.dispose(),s.delete(c),c.removeEventListener("dispose",L)}f={count:p,texture:A,size:new Kt(M,T)},s.set(c,f),c.addEventListener("dispose",L)}let m=0;for(let U=0;U<h.length;U++)m+=h[U];const g=c.morphTargetsRelative?1:1-m;u.getUniforms().setValue(e,"morphTargetBaseInfluence",g),u.getUniforms().setValue(e,"morphTargetInfluences",h),u.getUniforms().setValue(e,"morphTargetsTexture",f.texture,r),u.getUniforms().setValue(e,"morphTargetsTextureSize",f.size)}else{const k=void 0===h?0:h.length;let F=n[c.id];if(void 0===F||F.length!==k){F=[];for(let H=0;H<k;H++)F[H]=[H,0];n[c.id]=F}for(let W=0;W<k;W++){const X=F[W];X[0]=W,X[1]=h[W]}F.sort(xs);for(let q=0;q<8;q++)q<k&&F[q][1]?(a[q][0]=F[q][0],a[q][1]=F[q][1]):(a[q][0]=Number.MAX_SAFE_INTEGER,a[q][1]=0);a.sort(_s);const B=c.morphAttributes.position,z=c.morphAttributes.normal;let G=0;for(let Y=0;Y<8;Y++){const Z=a[Y],J=Z[0],K=Z[1];J!==Number.MAX_SAFE_INTEGER&&K?(B&&c.getAttribute("morphTarget"+Y)!==B[J]&&c.setAttribute("morphTarget"+Y,B[J]),z&&c.getAttribute("morphNormal"+Y)!==z[J]&&c.setAttribute("morphNormal"+Y,z[J]),i[Y]=K,G+=K):(B&&!0===c.hasAttribute("morphTarget"+Y)&&c.deleteAttribute("morphTarget"+Y),z&&!0===c.hasAttribute("morphNormal"+Y)&&c.deleteAttribute("morphNormal"+Y),i[Y]=0)}const V=c.morphTargetsRelative?1:1-G;u.getUniforms().setValue(e,"morphTargetBaseInfluence",V),u.getUniforms().setValue(e,"morphTargetInfluences",i)}}}}function ws(e,t,r,n){let i=new WeakMap;function s(e){const t=e.target;t.removeEventListener("dispose",s),r.remove(t.instanceMatrix),null!==t.instanceColor&&r.remove(t.instanceColor)}return{update:function(e){const o=n.render.frame,a=e.geometry,l=t.get(e,a);return i.get(l)!==o&&(t.update(l),i.set(l,o)),e.isInstancedMesh&&(!1===e.hasEventListener("dispose",s)&&e.addEventListener("dispose",s),r.update(e.instanceMatrix,34962),null!==e.instanceColor&&r.update(e.instanceColor,34962)),l},dispose:function(){i=new WeakMap}}}const Ss=new _r,Ms=new wr,Ts=new Sr,Es=new Ri,As=[],Cs=[],Ls=new Float32Array(16),Rs=new Float32Array(9),Ps=new Float32Array(4);function js(e,t,r){const n=e[0];if(n<=0||n>0)return e;const i=t*r;let s=As[i];if(void 0===s&&(s=new Float32Array(i),As[i]=s),0!==t){n.toArray(s,0);for(let n=1,i=0;n!==t;++n)i+=r,e[n].toArray(s,i)}return s}function Is(e,t){if(e.length!==t.length)return!1;for(let r=0,n=e.length;r<n;r++)if(e[r]!==t[r])return!1;return!0}function Ds(e,t){for(let r=0,n=t.length;r<n;r++)e[r]=t[r]}function Os(e,t){let r=Cs[t];void 0===r&&(r=new Int32Array(t),Cs[t]=r);for(let n=0;n!==t;++n)r[n]=e.allocateTextureUnit();return r}function Ns(e,t){const r=this.cache;r[0]!==t&&(e.uniform1f(this.addr,t),r[0]=t)}function Us(e,t){const r=this.cache;if(void 0!==t.x)r[0]===t.x&&r[1]===t.y||(e.uniform2f(this.addr,t.x,t.y),r[0]=t.x,r[1]=t.y);else{if(Is(r,t))return;e.uniform2fv(this.addr,t),Ds(r,t)}}function ks(e,t){const r=this.cache;if(void 0!==t.x)r[0]===t.x&&r[1]===t.y&&r[2]===t.z||(e.uniform3f(this.addr,t.x,t.y,t.z),r[0]=t.x,r[1]=t.y,r[2]=t.z);else if(void 0!==t.r)r[0]===t.r&&r[1]===t.g&&r[2]===t.b||(e.uniform3f(this.addr,t.r,t.g,t.b),r[0]=t.r,r[1]=t.g,r[2]=t.b);else{if(Is(r,t))return;e.uniform3fv(this.addr,t),Ds(r,t)}}function Fs(e,t){const r=this.cache;if(void 0!==t.x)r[0]===t.x&&r[1]===t.y&&r[2]===t.z&&r[3]===t.w||(e.uniform4f(this.addr,t.x,t.y,t.z,t.w),r[0]=t.x,r[1]=t.y,r[2]=t.z,r[3]=t.w);else{if(Is(r,t))return;e.uniform4fv(this.addr,t),Ds(r,t)}}function Bs(e,t){const r=this.cache,n=t.elements;if(void 0===n){if(Is(r,t))return;e.uniformMatrix2fv(this.addr,!1,t),Ds(r,t)}else{if(Is(r,n))return;Ps.set(n),e.uniformMatrix2fv(this.addr,!1,Ps),Ds(r,n)}}function zs(e,t){const r=this.cache,n=t.elements;if(void 0===n){if(Is(r,t))return;e.uniformMatrix3fv(this.addr,!1,t),Ds(r,t)}else{if(Is(r,n))return;Rs.set(n),e.uniformMatrix3fv(this.addr,!1,Rs),Ds(r,n)}}function Gs(e,t){const r=this.cache,n=t.elements;if(void 0===n){if(Is(r,t))return;e.uniformMatrix4fv(this.addr,!1,t),Ds(r,t)}else{if(Is(r,n))return;Ls.set(n),e.uniformMatrix4fv(this.addr,!1,Ls),Ds(r,n)}}function Vs(e,t){const r=this.cache;r[0]!==t&&(e.uniform1i(this.addr,t),r[0]=t)}function Hs(e,t){const r=this.cache;if(void 0!==t.x)r[0]===t.x&&r[1]===t.y||(e.uniform2i(this.addr,t.x,t.y),r[0]=t.x,r[1]=t.y);else{if(Is(r,t))return;e.uniform2iv(this.addr,t),Ds(r,t)}}function Ws(e,t){const r=this.cache;if(void 0!==t.x)r[0]===t.x&&r[1]===t.y&&r[2]===t.z||(e.uniform3i(this.addr,t.x,t.y,t.z),r[0]=t.x,r[1]=t.y,r[2]=t.z);else{if(Is(r,t))return;e.uniform3iv(this.addr,t),Ds(r,t)}}function Xs(e,t){const r=this.cache;if(void 0!==t.x)r[0]===t.x&&r[1]===t.y&&r[2]===t.z&&r[3]===t.w||(e.uniform4i(this.addr,t.x,t.y,t.z,t.w),r[0]=t.x,r[1]=t.y,r[2]=t.z,r[3]=t.w);else{if(Is(r,t))return;e.uniform4iv(this.addr,t),Ds(r,t)}}function qs(e,t){const r=this.cache;r[0]!==t&&(e.uniform1ui(this.addr,t),r[0]=t)}function Ys(e,t){const r=this.cache;if(void 0!==t.x)r[0]===t.x&&r[1]===t.y||(e.uniform2ui(this.addr,t.x,t.y),r[0]=t.x,r[1]=t.y);else{if(Is(r,t))return;e.uniform2uiv(this.addr,t),Ds(r,t)}}function Zs(e,t){const r=this.cache;if(void 0!==t.x)r[0]===t.x&&r[1]===t.y&&r[2]===t.z||(e.uniform3ui(this.addr,t.x,t.y,t.z),r[0]=t.x,r[1]=t.y,r[2]=t.z);else{if(Is(r,t))return;e.uniform3uiv(this.addr,t),Ds(r,t)}}function Js(e,t){const r=this.cache;if(void 0!==t.x)r[0]===t.x&&r[1]===t.y&&r[2]===t.z&&r[3]===t.w||(e.uniform4ui(this.addr,t.x,t.y,t.z,t.w),r[0]=t.x,r[1]=t.y,r[2]=t.z,r[3]=t.w);else{if(Is(r,t))return;e.uniform4uiv(this.addr,t),Ds(r,t)}}function Ks(e,t,r){const n=this.cache,i=r.allocateTextureUnit();n[0]!==i&&(e.uniform1i(this.addr,i),n[0]=i),r.setTexture2D(t||Ss,i)}function Qs(e,t,r){const n=this.cache,i=r.allocateTextureUnit();n[0]!==i&&(e.uniform1i(this.addr,i),n[0]=i),r.setTexture3D(t||Ts,i)}function $s(e,t,r){const n=this.cache,i=r.allocateTextureUnit();n[0]!==i&&(e.uniform1i(this.addr,i),n[0]=i),r.setTextureCube(t||Es,i)}function eo(e,t,r){const n=this.cache,i=r.allocateTextureUnit();n[0]!==i&&(e.uniform1i(this.addr,i),n[0]=i),r.setTexture2DArray(t||Ms,i)}function to(e,t){e.uniform1fv(this.addr,t)}function ro(e,t){const r=js(t,this.size,2);e.uniform2fv(this.addr,r)}function no(e,t){const r=js(t,this.size,3);e.uniform3fv(this.addr,r)}function io(e,t){const r=js(t,this.size,4);e.uniform4fv(this.addr,r)}function so(e,t){const r=js(t,this.size,4);e.uniformMatrix2fv(this.addr,!1,r)}function oo(e,t){const r=js(t,this.size,9);e.uniformMatrix3fv(this.addr,!1,r)}function ao(e,t){const r=js(t,this.size,16);e.uniformMatrix4fv(this.addr,!1,r)}function lo(e,t){e.uniform1iv(this.addr,t)}function co(e,t){e.uniform2iv(this.addr,t)}function uo(e,t){e.uniform3iv(this.addr,t)}function ho(e,t){e.uniform4iv(this.addr,t)}function po(e,t){e.uniform1uiv(this.addr,t)}function fo(e,t){e.uniform2uiv(this.addr,t)}function mo(e,t){e.uniform3uiv(this.addr,t)}function go(e,t){e.uniform4uiv(this.addr,t)}function yo(e,t,r){const n=this.cache,i=t.length,s=Os(r,i);Is(n,s)||(e.uniform1iv(this.addr,s),Ds(n,s));for(let e=0;e!==i;++e)r.setTexture2D(t[e]||Ss,s[e])}function vo(e,t,r){const n=this.cache,i=t.length,s=Os(r,i);Is(n,s)||(e.uniform1iv(this.addr,s),Ds(n,s));for(let e=0;e!==i;++e)r.setTexture3D(t[e]||Ts,s[e])}function _o(e,t,r){const n=this.cache,i=t.length,s=Os(r,i);Is(n,s)||(e.uniform1iv(this.addr,s),Ds(n,s));for(let e=0;e!==i;++e)r.setTextureCube(t[e]||Es,s[e])}function xo(e,t,r){const n=this.cache,i=t.length,s=Os(r,i);Is(n,s)||(e.uniform1iv(this.addr,s),Ds(n,s));for(let e=0;e!==i;++e)r.setTexture2DArray(t[e]||Ms,s[e])}class bo{constructor(e,t,r){this.id=e,this.addr=r,this.cache=[],this.setValue=function(e){switch(e){case 5126:return Ns;case 35664:return Us;case 35665:return ks;case 35666:return Fs;case 35674:return Bs;case 35675:return zs;case 35676:return Gs;case 5124:case 35670:return Vs;case 35667:case 35671:return Hs;case 35668:case 35672:return Ws;case 35669:case 35673:return Xs;case 5125:return qs;case 36294:return Ys;case 36295:return Zs;case 36296:return Js;case 35678:case 36198:case 36298:case 36306:case 35682:return Ks;case 35679:case 36299:case 36307:return Qs;case 35680:case 36300:case 36308:case 36293:return $s;case 36289:case 36303:case 36311:case 36292:return eo}}(t.type)}}class wo{constructor(e,t,r){this.id=e,this.addr=r,this.cache=[],this.size=t.size,this.setValue=function(e){switch(e){case 5126:return to;case 35664:return ro;case 35665:return no;case 35666:return io;case 35674:return so;case 35675:return oo;case 35676:return ao;case 5124:case 35670:return lo;case 35667:case 35671:return co;case 35668:case 35672:return uo;case 35669:case 35673:return ho;case 5125:return po;case 36294:return fo;case 36295:return mo;case 36296:return go;case 35678:case 36198:case 36298:case 36306:case 35682:return yo;case 35679:case 36299:case 36307:return vo;case 35680:case 36300:case 36308:case 36293:return _o;case 36289:case 36303:case 36311:case 36292:return xo}}(t.type)}}class So{constructor(e){this.id=e,this.seq=[],this.map={}}setValue(e,t,r){const n=this.seq;for(let i=0,s=n.length;i!==s;++i){const s=n[i];s.setValue(e,t[s.id],r)}}}const Mo=/(\w+)(\])?(\[|\.)?/g;function To(e,t){e.seq.push(t),e.map[t.id]=t}function Eo(e,t,r){const n=e.name,i=n.length;for(Mo.lastIndex=0;;){const s=Mo.exec(n),o=Mo.lastIndex;let a=s[1];const l="]"===s[2],c=s[3];if(l&&(a|=0),void 0===c||"["===c&&o+2===i){To(r,void 0===c?new bo(a,e,t):new wo(a,e,t));break}{let e=r.map[a];void 0===e&&(e=new So(a),To(r,e)),r=e}}}class Ao{constructor(e,t){this.seq=[],this.map={};const r=e.getProgramParameter(t,35718);for(let n=0;n<r;++n){const r=e.getActiveUniform(t,n);Eo(r,e.getUniformLocation(t,r.name),this)}}setValue(e,t,r,n){const i=this.map[t];void 0!==i&&i.setValue(e,r,n)}setOptional(e,t,r){const n=t[r];void 0!==n&&this.setValue(e,r,n)}static upload(e,t,r,n){for(let i=0,s=t.length;i!==s;++i){const s=t[i],o=r[s.id];!1!==o.needsUpdate&&s.setValue(e,o.value,n)}}static seqWithValue(e,t){const r=[];for(let n=0,i=e.length;n!==i;++n){const i=e[n];i.id in t&&r.push(i)}return r}}function Co(e,t,r){const n=e.createShader(t);return e.shaderSource(n,r),e.compileShader(n),n}let Lo=0;function Ro(e,t,r){const n=e.getShaderParameter(t,35713),i=e.getShaderInfoLog(t).trim();if(n&&""===i)return"";const s=/ERROR: 0:(\d+)/.exec(i);if(s){const n=parseInt(s[1]);return r.toUpperCase()+"\n\n"+i+"\n\n"+function(e,t){const r=e.split("\n"),n=[],i=Math.max(t-6,0),s=Math.min(t+6,r.length);for(let e=i;e<s;e++){const i=e+1;n.push(`${i===t?">":" "} ${i}: ${r[e]}`)}return n.join("\n")}(e.getShaderSource(t),n)}return i}function Po(e,t){const r=function(e){switch(e){case Mt:return["Linear","( value )"];case Tt:return["sRGB","( value )"];default:return["Linear","( value )"]}}(t);return"vec4 "+e+"( vec4 value ) { return LinearTo"+r[0]+r[1]+"; }"}function jo(e,t){let r;switch(t){case Z:r="Linear";break;case J:r="Reinhard";break;case K:r="OptimizedCineon";break;case Q:r="ACESFilmic";break;case $:r="Custom";break;default:r="Linear"}return"vec3 "+e+"( vec3 color ) { return "+r+"ToneMapping( color ); }"}function Io(e){return""!==e}function Do(e,t){const r=t.numSpotLightShadows+t.numSpotLightMaps-t.numSpotLightShadowsWithMaps;return e.replace(/NUM_DIR_LIGHTS/g,t.numDirLights).replace(/NUM_SPOT_LIGHTS/g,t.numSpotLights).replace(/NUM_SPOT_LIGHT_MAPS/g,t.numSpotLightMaps).replace(/NUM_SPOT_LIGHT_COORDS/g,r).replace(/NUM_RECT_AREA_LIGHTS/g,t.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,t.numPointLights).replace(/NUM_HEMI_LIGHTS/g,t.numHemiLights).replace(/NUM_DIR_LIGHT_SHADOWS/g,t.numDirLightShadows).replace(/NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS/g,t.numSpotLightShadowsWithMaps).replace(/NUM_SPOT_LIGHT_SHADOWS/g,t.numSpotLightShadows).replace(/NUM_POINT_LIGHT_SHADOWS/g,t.numPointLightShadows)}function Oo(e,t){return e.replace(/NUM_CLIPPING_PLANES/g,t.numClippingPlanes).replace(/UNION_CLIPPING_PLANES/g,t.numClippingPlanes-t.numClipIntersection)}const No=/^[ \t]*#include +<([\w\d./]+)>/gm;function Uo(e){return e.replace(No,ko)}function ko(e,t){const r=Gi[t];if(void 0===r)throw new Error("Can not resolve #include <"+t+">");return Uo(r)}const Fo=/#pragma unroll_loop_start\s+for\s*\(\s*int\s+i\s*=\s*(\d+)\s*;\s*i\s*<\s*(\d+)\s*;\s*i\s*\+\+\s*\)\s*{([\s\S]+?)}\s+#pragma unroll_loop_end/g;function Bo(e){return e.replace(Fo,zo)}function zo(e,t,r,n){let i="";for(let e=parseInt(t);e<parseInt(r);e++)i+=n.replace(/\[\s*i\s*\]/g,"[ "+e+" ]").replace(/UNROLLED_LOOP_INDEX/g,e);return i}function Go(e){let t="precision "+e.precision+" float;\nprecision "+e.precision+" int;";return"highp"===e.precision?t+="\n#define HIGH_PRECISION":"mediump"===e.precision?t+="\n#define MEDIUM_PRECISION":"lowp"===e.precision&&(t+="\n#define LOW_PRECISION"),t}function Vo(e,t,r,n){const i=e.getContext(),s=r.defines;let o=r.vertexShader,a=r.fragmentShader;const l=function(e){let t="SHADOWMAP_TYPE_BASIC";return e.shadowMapType===c?t="SHADOWMAP_TYPE_PCF":e.shadowMapType===u?t="SHADOWMAP_TYPE_PCF_SOFT":e.shadowMapType===h&&(t="SHADOWMAP_TYPE_VSM"),t}(r),d=function(e){let t="ENVMAP_TYPE_CUBE";if(e.envMap)switch(e.envMapMode){case ee:case te:t="ENVMAP_TYPE_CUBE";break;case ie:t="ENVMAP_TYPE_CUBE_UV"}return t}(r),p=function(e){let t="ENVMAP_MODE_REFLECTION";e.envMap&&e.envMapMode===te&&(t="ENVMAP_MODE_REFRACTION");return t}(r),f=function(e){let t="ENVMAP_BLENDING_NONE";if(e.envMap)switch(e.combine){case W:t="ENVMAP_BLENDING_MULTIPLY";break;case X:t="ENVMAP_BLENDING_MIX";break;case q:t="ENVMAP_BLENDING_ADD"}return t}(r),m=function(e){const t=e.envMapCubeUVHeight;if(null===t)return null;const r=Math.log2(t)-2,n=1/t;return{texelWidth:1/(3*Math.max(Math.pow(2,r),112)),texelHeight:n,maxMip:r}}(r),g=r.isWebGL2?"":function(e){return[e.extensionDerivatives||e.envMapCubeUVHeight||e.bumpMap||e.tangentSpaceNormalMap||e.clearcoatNormalMap||e.flatShading||"physical"===e.shaderID?"#extension GL_OES_standard_derivatives : enable":"",(e.extensionFragDepth||e.logarithmicDepthBuffer)&&e.rendererExtensionFragDepth?"#extension GL_EXT_frag_depth : enable":"",e.extensionDrawBuffers&&e.rendererExtensionDrawBuffers?"#extension GL_EXT_draw_buffers : require":"",(e.extensionShaderTextureLOD||e.envMap||e.transmission)&&e.rendererExtensionShaderTextureLod?"#extension GL_EXT_shader_texture_lod : enable":""].filter(Io).join("\n")}(r),y=function(e){const t=[];for(const r in e){const n=e[r];!1!==n&&t.push("#define "+r+" "+n)}return t.join("\n")}(s),v=i.createProgram();let _,x,b=r.glslVersion?"#version "+r.glslVersion+"\n":"";r.isRawShaderMaterial?(_=[y].filter(Io).join("\n"),_.length>0&&(_+="\n"),x=[g,y].filter(Io).join("\n"),x.length>0&&(x+="\n")):(_=[Go(r),"#define SHADER_NAME "+r.shaderName,y,r.instancing?"#define USE_INSTANCING":"",r.instancingColor?"#define USE_INSTANCING_COLOR":"",r.supportsVertexTextures?"#define VERTEX_TEXTURES":"",r.useFog&&r.fog?"#define USE_FOG":"",r.useFog&&r.fogExp2?"#define FOG_EXP2":"",r.map?"#define USE_MAP":"",r.envMap?"#define USE_ENVMAP":"",r.envMap?"#define "+p:"",r.lightMap?"#define USE_LIGHTMAP":"",r.aoMap?"#define USE_AOMAP":"",r.emissiveMap?"#define USE_EMISSIVEMAP":"",r.bumpMap?"#define USE_BUMPMAP":"",r.normalMap?"#define USE_NORMALMAP":"",r.normalMap&&r.objectSpaceNormalMap?"#define OBJECTSPACE_NORMALMAP":"",r.normalMap&&r.tangentSpaceNormalMap?"#define TANGENTSPACE_NORMALMAP":"",r.clearcoatMap?"#define USE_CLEARCOATMAP":"",r.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",r.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",r.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",r.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",r.displacementMap&&r.supportsVertexTextures?"#define USE_DISPLACEMENTMAP":"",r.specularMap?"#define USE_SPECULARMAP":"",r.specularIntensityMap?"#define USE_SPECULARINTENSITYMAP":"",r.specularColorMap?"#define USE_SPECULARCOLORMAP":"",r.roughnessMap?"#define USE_ROUGHNESSMAP":"",r.metalnessMap?"#define USE_METALNESSMAP":"",r.alphaMap?"#define USE_ALPHAMAP":"",r.transmission?"#define USE_TRANSMISSION":"",r.transmissionMap?"#define USE_TRANSMISSIONMAP":"",r.thicknessMap?"#define USE_THICKNESSMAP":"",r.sheenColorMap?"#define USE_SHEENCOLORMAP":"",r.sheenRoughnessMap?"#define USE_SHEENROUGHNESSMAP":"",r.vertexTangents?"#define USE_TANGENT":"",r.vertexColors?"#define USE_COLOR":"",r.vertexAlphas?"#define USE_COLOR_ALPHA":"",r.vertexUvs?"#define USE_UV":"",r.uvsVertexOnly?"#define UVS_VERTEX_ONLY":"",r.flatShading?"#define FLAT_SHADED":"",r.skinning?"#define USE_SKINNING":"",r.morphTargets?"#define USE_MORPHTARGETS":"",r.morphNormals&&!1===r.flatShading?"#define USE_MORPHNORMALS":"",r.morphColors&&r.isWebGL2?"#define USE_MORPHCOLORS":"",r.morphTargetsCount>0&&r.isWebGL2?"#define MORPHTARGETS_TEXTURE":"",r.morphTargetsCount>0&&r.isWebGL2?"#define MORPHTARGETS_TEXTURE_STRIDE "+r.morphTextureStride:"",r.morphTargetsCount>0&&r.isWebGL2?"#define MORPHTARGETS_COUNT "+r.morphTargetsCount:"",r.doubleSided?"#define DOUBLE_SIDED":"",r.flipSided?"#define FLIP_SIDED":"",r.shadowMapEnabled?"#define USE_SHADOWMAP":"",r.shadowMapEnabled?"#define "+l:"",r.sizeAttenuation?"#define USE_SIZEATTENUATION":"",r.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",r.logarithmicDepthBuffer&&r.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;","#ifdef USE_INSTANCING","\tattribute mat4 instanceMatrix;","#endif","#ifdef USE_INSTANCING_COLOR","\tattribute vec3 instanceColor;","#endif","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_TANGENT","\tattribute vec4 tangent;","#endif","#if defined( USE_COLOR_ALPHA )","\tattribute vec4 color;","#elif defined( USE_COLOR )","\tattribute vec3 color;","#endif","#if ( defined( USE_MORPHTARGETS ) && ! defined( MORPHTARGETS_TEXTURE ) )","\tattribute vec3 morphTarget0;","\tattribute vec3 morphTarget1;","\tattribute vec3 morphTarget2;","\tattribute vec3 morphTarget3;","\t#ifdef USE_MORPHNORMALS","\t\tattribute vec3 morphNormal0;","\t\tattribute vec3 morphNormal1;","\t\tattribute vec3 morphNormal2;","\t\tattribute vec3 morphNormal3;","\t#else","\t\tattribute vec3 morphTarget4;","\t\tattribute vec3 morphTarget5;","\t\tattribute vec3 morphTarget6;","\t\tattribute vec3 morphTarget7;","\t#endif","#endif","#ifdef USE_SKINNING","\tattribute vec4 skinIndex;","\tattribute vec4 skinWeight;","#endif","\n"].filter(Io).join("\n"),x=[g,Go(r),"#define SHADER_NAME "+r.shaderName,y,r.useFog&&r.fog?"#define USE_FOG":"",r.useFog&&r.fogExp2?"#define FOG_EXP2":"",r.map?"#define USE_MAP":"",r.matcap?"#define USE_MATCAP":"",r.envMap?"#define USE_ENVMAP":"",r.envMap?"#define "+d:"",r.envMap?"#define "+p:"",r.envMap?"#define "+f:"",m?"#define CUBEUV_TEXEL_WIDTH "+m.texelWidth:"",m?"#define CUBEUV_TEXEL_HEIGHT "+m.texelHeight:"",m?"#define CUBEUV_MAX_MIP "+m.maxMip+".0":"",r.lightMap?"#define USE_LIGHTMAP":"",r.aoMap?"#define USE_AOMAP":"",r.emissiveMap?"#define USE_EMISSIVEMAP":"",r.bumpMap?"#define USE_BUMPMAP":"",r.normalMap?"#define USE_NORMALMAP":"",r.normalMap&&r.objectSpaceNormalMap?"#define OBJECTSPACE_NORMALMAP":"",r.normalMap&&r.tangentSpaceNormalMap?"#define TANGENTSPACE_NORMALMAP":"",r.clearcoat?"#define USE_CLEARCOAT":"",r.clearcoatMap?"#define USE_CLEARCOATMAP":"",r.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",r.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",r.iridescence?"#define USE_IRIDESCENCE":"",r.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",r.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",r.specularMap?"#define USE_SPECULARMAP":"",r.specularIntensityMap?"#define USE_SPECULARINTENSITYMAP":"",r.specularColorMap?"#define USE_SPECULARCOLORMAP":"",r.roughnessMap?"#define USE_ROUGHNESSMAP":"",r.metalnessMap?"#define USE_METALNESSMAP":"",r.alphaMap?"#define USE_ALPHAMAP":"",r.alphaTest?"#define USE_ALPHATEST":"",r.sheen?"#define USE_SHEEN":"",r.sheenColorMap?"#define USE_SHEENCOLORMAP":"",r.sheenRoughnessMap?"#define USE_SHEENROUGHNESSMAP":"",r.transmission?"#define USE_TRANSMISSION":"",r.transmissionMap?"#define USE_TRANSMISSIONMAP":"",r.thicknessMap?"#define USE_THICKNESSMAP":"",r.decodeVideoTexture?"#define DECODE_VIDEO_TEXTURE":"",r.vertexTangents?"#define USE_TANGENT":"",r.vertexColors||r.instancingColor?"#define USE_COLOR":"",r.vertexAlphas?"#define USE_COLOR_ALPHA":"",r.vertexUvs?"#define USE_UV":"",r.uvsVertexOnly?"#define UVS_VERTEX_ONLY":"",r.gradientMap?"#define USE_GRADIENTMAP":"",r.flatShading?"#define FLAT_SHADED":"",r.doubleSided?"#define DOUBLE_SIDED":"",r.flipSided?"#define FLIP_SIDED":"",r.shadowMapEnabled?"#define USE_SHADOWMAP":"",r.shadowMapEnabled?"#define "+l:"",r.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",r.useLegacyLights?"#define LEGACY_LIGHTS":"",r.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",r.logarithmicDepthBuffer&&r.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;",r.toneMapping!==Y?"#define TONE_MAPPING":"",r.toneMapping!==Y?Gi.tonemapping_pars_fragment:"",r.toneMapping!==Y?jo("toneMapping",r.toneMapping):"",r.dithering?"#define DITHERING":"",r.opaque?"#define OPAQUE":"",Gi.encodings_pars_fragment,Po("linearToOutputTexel",r.outputEncoding),r.useDepthPacking?"#define DEPTH_PACKING "+r.depthPacking:"","\n"].filter(Io).join("\n")),o=Uo(o),o=Do(o,r),o=Oo(o,r),a=Uo(a),a=Do(a,r),a=Oo(a,r),o=Bo(o),a=Bo(a),r.isWebGL2&&!0!==r.isRawShaderMaterial&&(b="#version 300 es\n",_=["precision mediump sampler2DArray;","#define attribute in","#define varying out","#define texture2D texture"].join("\n")+"\n"+_,x=["#define varying in",r.glslVersion===Dt?"":"layout(location = 0) out highp vec4 pc_fragColor;",r.glslVersion===Dt?"":"#define gl_FragColor pc_fragColor","#define gl_FragDepthEXT gl_FragDepth","#define texture2D texture","#define textureCube texture","#define texture2DProj textureProj","#define texture2DLodEXT textureLod","#define texture2DProjLodEXT textureProjLod","#define textureCubeLodEXT textureLod","#define texture2DGradEXT textureGrad","#define texture2DProjGradEXT textureProjGrad","#define textureCubeGradEXT textureGrad"].join("\n")+"\n"+x);const w=b+x+a,S=Co(i,35633,b+_+o),M=Co(i,35632,w);if(i.attachShader(v,S),i.attachShader(v,M),void 0!==r.index0AttributeName?i.bindAttribLocation(v,0,r.index0AttributeName):!0===r.morphTargets&&i.bindAttribLocation(v,0,"position"),i.linkProgram(v),e.debug.checkShaderErrors){const e=i.getProgramInfoLog(v).trim(),t=i.getShaderInfoLog(S).trim(),r=i.getShaderInfoLog(M).trim();let n=!0,s=!0;if(!1===i.getProgramParameter(v,35714)){n=!1;Ro(i,S,"vertex"),Ro(i,M,"fragment")}else""!==e||""!==t&&""!==r||(s=!1);s&&(this.diagnostics={runnable:n,programLog:e,vertexShader:{log:t,prefix:_},fragmentShader:{log:r,prefix:x}})}let T,E;return i.deleteShader(S),i.deleteShader(M),this.getUniforms=function(){return void 0===T&&(T=new Ao(i,v)),T},this.getAttributes=function(){return void 0===E&&(E=function(e,t){const r={},n=e.getProgramParameter(t,35721);for(let i=0;i<n;i++){const n=e.getActiveAttrib(t,i),s=n.name;let o=1;35674===n.type&&(o=2),35675===n.type&&(o=3),35676===n.type&&(o=4),r[s]={type:n.type,location:e.getAttribLocation(t,s),locationSize:o}}return r}(i,v)),E},this.destroy=function(){n.releaseStatesOfProgram(this),i.deleteProgram(v),this.program=void 0},this.name=r.shaderName,this.id=Lo++,this.cacheKey=t,this.usedTimes=1,this.program=v,this.vertexShader=S,this.fragmentShader=M,this}let Ho=0;class Wo{constructor(){this.shaderCache=new Map,this.materialCache=new Map}update(e){const t=e.vertexShader,r=e.fragmentShader,n=this._getShaderStage(t),i=this._getShaderStage(r),s=this._getShaderCacheForMaterial(e);return!1===s.has(n)&&(s.add(n),n.usedTimes++),!1===s.has(i)&&(s.add(i),i.usedTimes++),this}remove(e){const t=this.materialCache.get(e);for(const e of t)e.usedTimes--,0===e.usedTimes&&this.shaderCache.delete(e.code);return this.materialCache.delete(e),this}getVertexShaderID(e){return this._getShaderStage(e.vertexShader).id}getFragmentShaderID(e){return this._getShaderStage(e.fragmentShader).id}dispose(){this.shaderCache.clear(),this.materialCache.clear()}_getShaderCacheForMaterial(e){const t=this.materialCache;let r=t.get(e);return void 0===r&&(r=new Set,t.set(e,r)),r}_getShaderStage(e){const t=this.shaderCache;let r=t.get(e);return void 0===r&&(r=new Xo(e),t.set(e,r)),r}}class Xo{constructor(e){this.id=Ho++,this.code=e,this.usedTimes=0}}function qo(e,t,r,n,i,s,o){const a=new cn,l=new Wo,c=[],u=i.isWebGL2,h=i.logarithmicDepthBuffer,d=i.vertexTextures;let m=i.precision;const y={MeshDepthMaterial:"depth",MeshDistanceMaterial:"distanceRGBA",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"toon",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",MeshMatcapMaterial:"matcap",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points",ShadowMaterial:"shadow",SpriteMaterial:"sprite"};return{getParameters:function(s,a,c,v,_){const x=v.fog,b=_.geometry,w=s.isMeshStandardMaterial?v.environment:null,S=(s.isMeshStandardMaterial?r:t).get(s.envMap||w),M=S&&S.mapping===ie?S.image.height:null,T=y[s.type];null!==s.precision&&(m=i.getMaxPrecision(s.precision),s.precision);const E=b.morphAttributes.position||b.morphAttributes.normal||b.morphAttributes.color,A=void 0!==E?E.length:0;let C,L,R,P,j=0;if(void 0!==b.morphAttributes.position&&(j=1),void 0!==b.morphAttributes.normal&&(j=2),void 0!==b.morphAttributes.color&&(j=3),T){const e=Hi[T];C=e.vertexShader,L=e.fragmentShader}else C=s.vertexShader,L=s.fragmentShader,l.update(s),R=l.getVertexShaderID(s),P=l.getFragmentShaderID(s);const I=e.getRenderTarget(),D=s.alphaTest>0,O=s.clearcoat>0,N=s.iridescence>0;return{isWebGL2:u,shaderID:T,shaderName:s.type,vertexShader:C,fragmentShader:L,defines:s.defines,customVertexShaderID:R,customFragmentShaderID:P,isRawShaderMaterial:!0===s.isRawShaderMaterial,glslVersion:s.glslVersion,precision:m,instancing:!0===_.isInstancedMesh,instancingColor:!0===_.isInstancedMesh&&null!==_.instanceColor,supportsVertexTextures:d,outputEncoding:null===I?e.outputEncoding:!0===I.isXRRenderTarget?I.texture.encoding:Mt,map:!!s.map,matcap:!!s.matcap,envMap:!!S,envMapMode:S&&S.mapping,envMapCubeUVHeight:M,lightMap:!!s.lightMap,aoMap:!!s.aoMap,emissiveMap:!!s.emissiveMap,bumpMap:!!s.bumpMap,normalMap:!!s.normalMap,objectSpaceNormalMap:s.normalMapType===Ct,tangentSpaceNormalMap:s.normalMapType===At,decodeVideoTexture:!!s.map&&!0===s.map.isVideoTexture&&s.map.encoding===Tt,clearcoat:O,clearcoatMap:O&&!!s.clearcoatMap,clearcoatRoughnessMap:O&&!!s.clearcoatRoughnessMap,clearcoatNormalMap:O&&!!s.clearcoatNormalMap,iridescence:N,iridescenceMap:N&&!!s.iridescenceMap,iridescenceThicknessMap:N&&!!s.iridescenceThicknessMap,displacementMap:!!s.displacementMap,roughnessMap:!!s.roughnessMap,metalnessMap:!!s.metalnessMap,specularMap:!!s.specularMap,specularIntensityMap:!!s.specularIntensityMap,specularColorMap:!!s.specularColorMap,opaque:!1===s.transparent&&s.blending===g,alphaMap:!!s.alphaMap,alphaTest:D,gradientMap:!!s.gradientMap,sheen:s.sheen>0,sheenColorMap:!!s.sheenColorMap,sheenRoughnessMap:!!s.sheenRoughnessMap,transmission:s.transmission>0,transmissionMap:!!s.transmissionMap,thicknessMap:!!s.thicknessMap,combine:s.combine,vertexTangents:!!s.normalMap&&!!b.attributes.tangent,vertexColors:s.vertexColors,vertexAlphas:!0===s.vertexColors&&!!b.attributes.color&&4===b.attributes.color.itemSize,vertexUvs:!!(s.map||s.bumpMap||s.normalMap||s.specularMap||s.alphaMap||s.emissiveMap||s.roughnessMap||s.metalnessMap||s.clearcoatMap||s.clearcoatRoughnessMap||s.clearcoatNormalMap||s.iridescenceMap||s.iridescenceThicknessMap||s.displacementMap||s.transmissionMap||s.thicknessMap||s.specularIntensityMap||s.specularColorMap||s.sheenColorMap||s.sheenRoughnessMap),uvsVertexOnly:!(s.map||s.bumpMap||s.normalMap||s.specularMap||s.alphaMap||s.emissiveMap||s.roughnessMap||s.metalnessMap||s.clearcoatNormalMap||s.iridescenceMap||s.iridescenceThicknessMap||s.transmission>0||s.transmissionMap||s.thicknessMap||s.specularIntensityMap||s.specularColorMap||s.sheen>0||s.sheenColorMap||s.sheenRoughnessMap||!s.displacementMap),fog:!!x,useFog:!0===s.fog,fogExp2:x&&x.isFogExp2,flatShading:!!s.flatShading,sizeAttenuation:s.sizeAttenuation,logarithmicDepthBuffer:h,skinning:!0===_.isSkinnedMesh,morphTargets:void 0!==b.morphAttributes.position,morphNormals:void 0!==b.morphAttributes.normal,morphColors:void 0!==b.morphAttributes.color,morphTargetsCount:A,morphTextureStride:j,numDirLights:a.directional.length,numPointLights:a.point.length,numSpotLights:a.spot.length,numSpotLightMaps:a.spotLightMap.length,numRectAreaLights:a.rectArea.length,numHemiLights:a.hemi.length,numDirLightShadows:a.directionalShadowMap.length,numPointLightShadows:a.pointShadowMap.length,numSpotLightShadows:a.spotShadowMap.length,numSpotLightShadowsWithMaps:a.numSpotLightShadowsWithMaps,numClippingPlanes:o.numPlanes,numClipIntersection:o.numIntersection,dithering:s.dithering,shadowMapEnabled:e.shadowMap.enabled&&c.length>0,shadowMapType:e.shadowMap.type,toneMapping:s.toneMapped?e.toneMapping:Y,useLegacyLights:e.useLegacyLights,premultipliedAlpha:s.premultipliedAlpha,doubleSided:s.side===f,flipSided:s.side===p,useDepthPacking:!!s.depthPacking,depthPacking:s.depthPacking||0,index0AttributeName:s.index0AttributeName,extensionDerivatives:s.extensions&&s.extensions.derivatives,extensionFragDepth:s.extensions&&s.extensions.fragDepth,extensionDrawBuffers:s.extensions&&s.extensions.drawBuffers,extensionShaderTextureLOD:s.extensions&&s.extensions.shaderTextureLOD,rendererExtensionFragDepth:u||n.has("EXT_frag_depth"),rendererExtensionDrawBuffers:u||n.has("WEBGL_draw_buffers"),rendererExtensionShaderTextureLod:u||n.has("EXT_shader_texture_lod"),customProgramCacheKey:s.customProgramCacheKey()}},getProgramCacheKey:function(t){const r=[];if(t.shaderID?r.push(t.shaderID):(r.push(t.customVertexShaderID),r.push(t.customFragmentShaderID)),void 0!==t.defines)for(const e in t.defines)r.push(e),r.push(t.defines[e]);return!1===t.isRawShaderMaterial&&(!function(e,t){e.push(t.precision),e.push(t.outputEncoding),e.push(t.envMapMode),e.push(t.envMapCubeUVHeight),e.push(t.combine),e.push(t.vertexUvs),e.push(t.fogExp2),e.push(t.sizeAttenuation),e.push(t.morphTargetsCount),e.push(t.morphAttributeCount),e.push(t.numDirLights),e.push(t.numPointLights),e.push(t.numSpotLights),e.push(t.numSpotLightMaps),e.push(t.numHemiLights),e.push(t.numRectAreaLights),e.push(t.numDirLightShadows),e.push(t.numPointLightShadows),e.push(t.numSpotLightShadows),e.push(t.numSpotLightShadowsWithMaps),e.push(t.shadowMapType),e.push(t.toneMapping),e.push(t.numClippingPlanes),e.push(t.numClipIntersection),e.push(t.depthPacking)}(r,t),function(e,t){a.disableAll(),t.isWebGL2&&a.enable(0);t.supportsVertexTextures&&a.enable(1);t.instancing&&a.enable(2);t.instancingColor&&a.enable(3);t.map&&a.enable(4);t.matcap&&a.enable(5);t.envMap&&a.enable(6);t.lightMap&&a.enable(7);t.aoMap&&a.enable(8);t.emissiveMap&&a.enable(9);t.bumpMap&&a.enable(10);t.normalMap&&a.enable(11);t.objectSpaceNormalMap&&a.enable(12);t.tangentSpaceNormalMap&&a.enable(13);t.clearcoat&&a.enable(14);t.clearcoatMap&&a.enable(15);t.clearcoatRoughnessMap&&a.enable(16);t.clearcoatNormalMap&&a.enable(17);t.iridescence&&a.enable(18);t.iridescenceMap&&a.enable(19);t.iridescenceThicknessMap&&a.enable(20);t.displacementMap&&a.enable(21);t.specularMap&&a.enable(22);t.roughnessMap&&a.enable(23);t.metalnessMap&&a.enable(24);t.gradientMap&&a.enable(25);t.alphaMap&&a.enable(26);t.alphaTest&&a.enable(27);t.vertexColors&&a.enable(28);t.vertexAlphas&&a.enable(29);t.vertexUvs&&a.enable(30);t.vertexTangents&&a.enable(31);t.uvsVertexOnly&&a.enable(32);e.push(a.mask),a.disableAll(),t.fog&&a.enable(0);t.useFog&&a.enable(1);t.flatShading&&a.enable(2);t.logarithmicDepthBuffer&&a.enable(3);t.skinning&&a.enable(4);t.morphTargets&&a.enable(5);t.morphNormals&&a.enable(6);t.morphColors&&a.enable(7);t.premultipliedAlpha&&a.enable(8);t.shadowMapEnabled&&a.enable(9);t.useLegacyLights&&a.enable(10);t.doubleSided&&a.enable(11);t.flipSided&&a.enable(12);t.useDepthPacking&&a.enable(13);t.dithering&&a.enable(14);t.specularIntensityMap&&a.enable(15);t.specularColorMap&&a.enable(16);t.transmission&&a.enable(17);t.transmissionMap&&a.enable(18);t.thicknessMap&&a.enable(19);t.sheen&&a.enable(20);t.sheenColorMap&&a.enable(21);t.sheenRoughnessMap&&a.enable(22);t.decodeVideoTexture&&a.enable(23);t.opaque&&a.enable(24);e.push(a.mask)}(r,t),r.push(e.outputEncoding)),r.push(t.customProgramCacheKey),r.join()},getUniforms:function(e){const t=y[e.type];let r;if(t){const e=Hi[t];r=Mi.clone(e.uniforms)}else r=e.uniforms;return r},acquireProgram:function(t,r){let n;for(let e=0,t=c.length;e<t;e++){const t=c[e];if(t.cacheKey===r){n=t,++n.usedTimes;break}}return void 0===n&&(n=new Vo(e,r,t,s),c.push(n)),n},releaseProgram:function(e){if(0==--e.usedTimes){const t=c.indexOf(e);c[t]=c[c.length-1],c.pop(),e.destroy()}},releaseShaderCache:function(e){l.remove(e)},programs:c,dispose:function(){l.dispose()}}}function Yo(){let e=new WeakMap;return{get:function(t){let r=e.get(t);return void 0===r&&(r={},e.set(t,r)),r},remove:function(t){e.delete(t)},update:function(t,r,n){e.get(t)[r]=n},dispose:function(){e=new WeakMap}}}function Zo(e,t){return e.groupOrder!==t.groupOrder?e.groupOrder-t.groupOrder:e.renderOrder!==t.renderOrder?e.renderOrder-t.renderOrder:e.material.id!==t.material.id?e.material.id-t.material.id:e.z!==t.z?e.z-t.z:e.id-t.id}function Jo(e,t){return e.groupOrder!==t.groupOrder?e.groupOrder-t.groupOrder:e.renderOrder!==t.renderOrder?e.renderOrder-t.renderOrder:e.z!==t.z?t.z-e.z:e.id-t.id}function Ko(){const e=[];let t=0;const r=[],n=[],i=[];function s(r,n,i,s,o,a){let l=e[t];return void 0===l?(l={id:r.id,object:r,geometry:n,material:i,groupOrder:s,renderOrder:r.renderOrder,z:o,group:a},e[t]=l):(l.id=r.id,l.object=r,l.geometry=n,l.material=i,l.groupOrder=s,l.renderOrder=r.renderOrder,l.z=o,l.group=a),t++,l}return{opaque:r,transmissive:n,transparent:i,init:function(){t=0,r.length=0,n.length=0,i.length=0},push:function(e,t,o,a,l,c){const u=s(e,t,o,a,l,c);o.transmission>0?n.push(u):!0===o.transparent?i.push(u):r.push(u)},unshift:function(e,t,o,a,l,c){const u=s(e,t,o,a,l,c);o.transmission>0?n.unshift(u):!0===o.transparent?i.unshift(u):r.unshift(u)},finish:function(){for(let r=t,n=e.length;r<n;r++){const t=e[r];if(null===t.id)break;t.id=null,t.object=null,t.geometry=null,t.material=null,t.group=null}},sort:function(e,t){r.length>1&&r.sort(e||Zo),n.length>1&&n.sort(t||Jo),i.length>1&&i.sort(t||Jo)}}}function Qo(){let e=new WeakMap;return{get:function(t,r){const n=e.get(t);let i;return void 0===n?(i=new Ko,e.set(t,[i])):r>=n.length?(i=new Ko,n.push(i)):i=n[r],i},dispose:function(){e=new WeakMap}}}function $o(){const e={};return{get:function(t){if(void 0!==e[t.id])return e[t.id];let r;switch(t.type){case"DirectionalLight":r={direction:new nr,color:new zn};break;case"SpotLight":r={position:new nr,direction:new nr,color:new zn,distance:0,coneCos:0,penumbraCos:0,decay:0};break;case"PointLight":r={position:new nr,color:new zn,distance:0,decay:0};break;case"HemisphereLight":r={direction:new nr,skyColor:new zn,groundColor:new zn};break;case"RectAreaLight":r={color:new zn,position:new nr,halfWidth:new nr,halfHeight:new nr}}return e[t.id]=r,r}}}let ea=0;function ta(e,t){return(t.castShadow?2:0)-(e.castShadow?2:0)+(t.map?1:0)-(e.map?1:0)}function ra(e,t){const r=new $o,n=function(){const e={};return{get:function(t){if(void 0!==e[t.id])return e[t.id];let r;switch(t.type){case"DirectionalLight":case"SpotLight":r={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new Kt};break;case"PointLight":r={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new Kt,shadowCameraNear:1,shadowCameraFar:1e3}}return e[t.id]=r,r}}}(),i={version:0,hash:{directionalLength:-1,pointLength:-1,spotLength:-1,rectAreaLength:-1,hemiLength:-1,numDirectionalShadows:-1,numPointShadows:-1,numSpotShadows:-1,numSpotMaps:-1},ambient:[0,0,0],probe:[],directional:[],directionalShadow:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotLightMap:[],spotShadow:[],spotShadowMap:[],spotLightMatrix:[],rectArea:[],rectAreaLTC1:null,rectAreaLTC2:null,point:[],pointShadow:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[],numSpotLightShadowsWithMaps:0};for(let e=0;e<9;e++)i.probe.push(new nr);const s=new nr,o=new Kr,a=new Kr;return{setup:function(s,o){let a=0,l=0,c=0;for(let e=0;e<9;e++)i.probe[e].set(0,0,0);let u=0,h=0,d=0,p=0,f=0,m=0,g=0,y=0,v=0,_=0;s.sort(ta);const x=!0===o?Math.PI:1;for(let e=0,t=s.length;e<t;e++){const t=s[e],o=t.color,b=t.intensity,w=t.distance,S=t.shadow&&t.shadow.map?t.shadow.map.texture:null;if(t.isAmbientLight)a+=o.r*b*x,l+=o.g*b*x,c+=o.b*b*x;else if(t.isLightProbe)for(let e=0;e<9;e++)i.probe[e].addScaledVector(t.sh.coefficients[e],b);else if(t.isDirectionalLight){const e=r.get(t);if(e.color.copy(t.color).multiplyScalar(t.intensity*x),t.castShadow){const e=t.shadow,r=n.get(t);r.shadowBias=e.bias,r.shadowNormalBias=e.normalBias,r.shadowRadius=e.radius,r.shadowMapSize=e.mapSize,i.directionalShadow[u]=r,i.directionalShadowMap[u]=S,i.directionalShadowMatrix[u]=t.shadow.matrix,m++}i.directional[u]=e,u++}else if(t.isSpotLight){const e=r.get(t);e.position.setFromMatrixPosition(t.matrixWorld),e.color.copy(o).multiplyScalar(b*x),e.distance=w,e.coneCos=Math.cos(t.angle),e.penumbraCos=Math.cos(t.angle*(1-t.penumbra)),e.decay=t.decay,i.spot[d]=e;const s=t.shadow;if(t.map&&(i.spotLightMap[v]=t.map,v++,s.updateMatrices(t),t.castShadow&&_++),i.spotLightMatrix[d]=s.matrix,t.castShadow){const e=n.get(t);e.shadowBias=s.bias,e.shadowNormalBias=s.normalBias,e.shadowRadius=s.radius,e.shadowMapSize=s.mapSize,i.spotShadow[d]=e,i.spotShadowMap[d]=S,y++}d++}else if(t.isRectAreaLight){const e=r.get(t);e.color.copy(o).multiplyScalar(b),e.halfWidth.set(.5*t.width,0,0),e.halfHeight.set(0,.5*t.height,0),i.rectArea[p]=e,p++}else if(t.isPointLight){const e=r.get(t);if(e.color.copy(t.color).multiplyScalar(t.intensity*x),e.distance=t.distance,e.decay=t.decay,t.castShadow){const e=t.shadow,r=n.get(t);r.shadowBias=e.bias,r.shadowNormalBias=e.normalBias,r.shadowRadius=e.radius,r.shadowMapSize=e.mapSize,r.shadowCameraNear=e.camera.near,r.shadowCameraFar=e.camera.far,i.pointShadow[h]=r,i.pointShadowMap[h]=S,i.pointShadowMatrix[h]=t.shadow.matrix,g++}i.point[h]=e,h++}else if(t.isHemisphereLight){const e=r.get(t);e.skyColor.copy(t.color).multiplyScalar(b*x),e.groundColor.copy(t.groundColor).multiplyScalar(b*x),i.hemi[f]=e,f++}}p>0&&(t.isWebGL2||!0===e.has("OES_texture_float_linear")?(i.rectAreaLTC1=Vi.LTC_FLOAT_1,i.rectAreaLTC2=Vi.LTC_FLOAT_2):!0===e.has("OES_texture_half_float_linear")&&(i.rectAreaLTC1=Vi.LTC_HALF_1,i.rectAreaLTC2=Vi.LTC_HALF_2)),i.ambient[0]=a,i.ambient[1]=l,i.ambient[2]=c;const b=i.hash;b.directionalLength===u&&b.pointLength===h&&b.spotLength===d&&b.rectAreaLength===p&&b.hemiLength===f&&b.numDirectionalShadows===m&&b.numPointShadows===g&&b.numSpotShadows===y&&b.numSpotMaps===v||(i.directional.length=u,i.spot.length=d,i.rectArea.length=p,i.point.length=h,i.hemi.length=f,i.directionalShadow.length=m,i.directionalShadowMap.length=m,i.pointShadow.length=g,i.pointShadowMap.length=g,i.spotShadow.length=y,i.spotShadowMap.length=y,i.directionalShadowMatrix.length=m,i.pointShadowMatrix.length=g,i.spotLightMatrix.length=y+v-_,i.spotLightMap.length=v,i.numSpotLightShadowsWithMaps=_,b.directionalLength=u,b.pointLength=h,b.spotLength=d,b.rectAreaLength=p,b.hemiLength=f,b.numDirectionalShadows=m,b.numPointShadows=g,b.numSpotShadows=y,b.numSpotMaps=v,i.version=ea++)},setupView:function(e,t){let r=0,n=0,l=0,c=0,u=0;const h=t.matrixWorldInverse;for(let t=0,d=e.length;t<d;t++){const d=e[t];if(d.isDirectionalLight){const e=i.directional[r];e.direction.setFromMatrixPosition(d.matrixWorld),s.setFromMatrixPosition(d.target.matrixWorld),e.direction.sub(s),e.direction.transformDirection(h),r++}else if(d.isSpotLight){const e=i.spot[l];e.position.setFromMatrixPosition(d.matrixWorld),e.position.applyMatrix4(h),e.direction.setFromMatrixPosition(d.matrixWorld),s.setFromMatrixPosition(d.target.matrixWorld),e.direction.sub(s),e.direction.transformDirection(h),l++}else if(d.isRectAreaLight){const e=i.rectArea[c];e.position.setFromMatrixPosition(d.matrixWorld),e.position.applyMatrix4(h),a.identity(),o.copy(d.matrixWorld),o.premultiply(h),a.extractRotation(o),e.halfWidth.set(.5*d.width,0,0),e.halfHeight.set(0,.5*d.height,0),e.halfWidth.applyMatrix4(a),e.halfHeight.applyMatrix4(a),c++}else if(d.isPointLight){const e=i.point[n];e.position.setFromMatrixPosition(d.matrixWorld),e.position.applyMatrix4(h),n++}else if(d.isHemisphereLight){const e=i.hemi[u];e.direction.setFromMatrixPosition(d.matrixWorld),e.direction.transformDirection(h),u++}}},state:i}}function na(e,t){const r=new ra(e,t),n=[],i=[];return{init:function(){n.length=0,i.length=0},state:{lightsArray:n,shadowsArray:i,lights:r},setupLights:function(e){r.setup(n,e)},setupLightsView:function(e){r.setupView(n,e)},pushLight:function(e){n.push(e)},pushShadow:function(e){i.push(e)}}}function ia(e,t){let r=new WeakMap;return{get:function(n,i=0){const s=r.get(n);let o;return void 0===s?(o=new na(e,t),r.set(n,[o])):i>=s.length?(o=new na(e,t),s.push(o)):o=s[i],o},dispose:function(){r=new WeakMap}}}class sa extends Nn{constructor(e){super(),this.isMeshDepthMaterial=!0,this.type="MeshDepthMaterial",this.depthPacking=3200,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.setValues(e)}copy(e){return super.copy(e),this.depthPacking=e.depthPacking,this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this}}class oa extends Nn{constructor(e){super(),this.isMeshDistanceMaterial=!0,this.type="MeshDistanceMaterial",this.referencePosition=new nr,this.nearDistance=1,this.farDistance=1e3,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.setValues(e)}copy(e){return super.copy(e),this.referencePosition.copy(e.referencePosition),this.nearDistance=e.nearDistance,this.farDistance=e.farDistance,this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this}}const aa="void main() {\n\tgl_Position = vec4( position, 1.0 );\n}",la="uniform sampler2D shadow_pass;\nuniform vec2 resolution;\nuniform float radius;\n#include <packing>\nvoid main() {\n\tconst float samples = float( VSM_SAMPLES );\n\tfloat mean = 0.0;\n\tfloat squared_mean = 0.0;\n\tfloat uvStride = samples <= 1.0 ? 0.0 : 2.0 / ( samples - 1.0 );\n\tfloat uvStart = samples <= 1.0 ? 0.0 : - 1.0;\n\tfor ( float i = 0.0; i < samples; i ++ ) {\n\t\tfloat uvOffset = uvStart + i * uvStride;\n\t\t#ifdef HORIZONTAL_PASS\n\t\t\tvec2 distribution = unpackRGBATo2Half( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( uvOffset, 0.0 ) * radius ) / resolution ) );\n\t\t\tmean += distribution.x;\n\t\t\tsquared_mean += distribution.y * distribution.y + distribution.x * distribution.x;\n\t\t#else\n\t\t\tfloat depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( 0.0, uvOffset ) * radius ) / resolution ) );\n\t\t\tmean += depth;\n\t\t\tsquared_mean += depth * depth;\n\t\t#endif\n\t}\n\tmean = mean / samples;\n\tsquared_mean = squared_mean / samples;\n\tfloat std_dev = sqrt( squared_mean - mean * mean );\n\tgl_FragColor = pack2HalfToRGBA( vec2( mean, std_dev ) );\n}";function ca(e,t,r){let n=new ki;const i=new Kt,s=new Kt,o=new xr,a=new sa({depthPacking:Et}),l=new oa,u={},g=r.maxTextureSize,y={[d]:p,[p]:d,[f]:f},v=new Ti({defines:{VSM_SAMPLES:8},uniforms:{shadow_pass:{value:null},resolution:{value:new Kt},radius:{value:4}},vertexShader:aa,fragmentShader:la}),_=v.clone();_.defines.HORIZONTAL_PASS=1;const x=new ni;x.setAttribute("position",new Xn(new Float32Array([-1,-1,.5,3,-1,.5,-1,3,.5]),3));const b=new vi(x,v),w=this;function S(r,n){const s=t.update(b);v.defines.VSM_SAMPLES!==r.blurSamples&&(v.defines.VSM_SAMPLES=r.blurSamples,_.defines.VSM_SAMPLES=r.blurSamples,v.needsUpdate=!0,_.needsUpdate=!0),null===r.mapPass&&(r.mapPass=new br(i.x,i.y)),v.uniforms.shadow_pass.value=r.map.texture,v.uniforms.resolution.value=r.mapSize,v.uniforms.radius.value=r.radius,e.setRenderTarget(r.mapPass),e.clear(),e.renderBufferDirect(n,null,s,v,b,null),_.uniforms.shadow_pass.value=r.mapPass.texture,_.uniforms.resolution.value=r.mapSize,_.uniforms.radius.value=r.radius,e.setRenderTarget(r.map),e.clear(),e.renderBufferDirect(n,null,s,_,b,null)}function M(t,r,n,i,s,o){let c=null;const d=!0===n.isPointLight?t.customDistanceMaterial:t.customDepthMaterial;if(void 0!==d)c=d;else if(c=!0===n.isPointLight?l:a,e.localClippingEnabled&&!0===r.clipShadows&&Array.isArray(r.clippingPlanes)&&0!==r.clippingPlanes.length||r.displacementMap&&0!==r.displacementScale||r.alphaMap&&r.alphaTest>0||r.map&&r.alphaTest>0){const e=c.uuid,t=r.uuid;let n=u[e];void 0===n&&(n={},u[e]=n);let i=n[t];void 0===i&&(i=c.clone(),n[t]=i),c=i}return c.visible=r.visible,c.wireframe=r.wireframe,c.side=o===h?null!==r.shadowSide?r.shadowSide:r.side:null!==r.shadowSide?r.shadowSide:y[r.side],c.alphaMap=r.alphaMap,c.alphaTest=r.alphaTest,c.map=r.map,c.clipShadows=r.clipShadows,c.clippingPlanes=r.clippingPlanes,c.clipIntersection=r.clipIntersection,c.displacementMap=r.displacementMap,c.displacementScale=r.displacementScale,c.displacementBias=r.displacementBias,c.wireframeLinewidth=r.wireframeLinewidth,c.linewidth=r.linewidth,!0===n.isPointLight&&!0===c.isMeshDistanceMaterial&&(c.referencePosition.setFromMatrixPosition(n.matrixWorld),c.nearDistance=i,c.farDistance=s),c}function T(r,i,s,o,a){if(!1===r.visible)return;if(r.layers.test(i.layers)&&(r.isMesh||r.isLine||r.isPoints)&&(r.castShadow||r.receiveShadow&&a===h)&&(!r.frustumCulled||n.intersectsObject(r))){r.modelViewMatrix.multiplyMatrices(s.matrixWorldInverse,r.matrixWorld);const n=t.update(r),i=r.material;if(Array.isArray(i)){const t=n.groups;for(let l=0,c=t.length;l<c;l++){const c=t[l],u=i[c.materialIndex];if(u&&u.visible){const t=M(r,u,o,s.near,s.far,a);e.renderBufferDirect(s,null,n,t,r,c)}}}else if(i.visible){const t=M(r,i,o,s.near,s.far,a);e.renderBufferDirect(s,null,n,t,r,null)}}const l=r.children;for(let e=0,t=l.length;e<t;e++)T(l[e],i,s,o,a)}this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=c,this.render=function(t,r,a){if(!1===w.enabled)return;if(!1===w.autoUpdate&&!1===w.needsUpdate)return;if(0===t.length)return;const l=e.getRenderTarget(),c=e.getActiveCubeFace(),u=e.getActiveMipmapLevel(),d=e.state;d.setBlending(m),d.buffers.color.setClear(1,1,1,1),d.buffers.depth.setTest(!0),d.setScissorTest(!1);for(let l=0,c=t.length;l<c;l++){const c=t[l],u=c.shadow;if(void 0===u)continue;if(!1===u.autoUpdate&&!1===u.needsUpdate)continue;i.copy(u.mapSize);const p=u.getFrameExtents();if(i.multiply(p),s.copy(u.mapSize),(i.x>g||i.y>g)&&(i.x>g&&(s.x=Math.floor(g/p.x),i.x=s.x*p.x,u.mapSize.x=s.x),i.y>g&&(s.y=Math.floor(g/p.y),i.y=s.y*p.y,u.mapSize.y=s.y)),null===u.map){const e=this.type!==h?{minFilter:le,magFilter:le}:{};u.map=new br(i.x,i.y,e),u.map.texture.name=c.name+".shadowMap",u.camera.updateProjectionMatrix()}e.setRenderTarget(u.map),e.clear();const f=u.getViewportCount();for(let e=0;e<f;e++){const t=u.getViewport(e);o.set(s.x*t.x,s.y*t.y,s.x*t.z,s.y*t.w),d.viewport(o),u.updateMatrices(c,e),n=u.getFrustum(),T(r,a,u.camera,c,this.type)}!0!==u.isPointLightShadow&&this.type===h&&S(u,a),u.needsUpdate=!1}w.needsUpdate=!1,e.setRenderTarget(l,c,u)}}function ua(e,t,r){const n=r.isWebGL2;const i=new function(){let t=!1;const r=new xr;let n=null;const i=new xr(0,0,0,0);return{setMask:function(r){n===r||t||(e.colorMask(r,r,r,r),n=r)},setLocked:function(e){t=e},setClear:function(t,n,s,o,a){!0===a&&(t*=o,n*=o,s*=o),r.set(t,n,s,o),!1===i.equals(r)&&(e.clearColor(t,n,s,o),i.copy(r))},reset:function(){t=!1,n=null,i.set(-1,0,0,0)}}},s=new function(){let t=!1,r=null,n=null,i=null;return{setTest:function(e){e?be(2929):we(2929)},setMask:function(n){r===n||t||(e.depthMask(n),r=n)},setFunc:function(t){if(n!==t){switch(t){case U:e.depthFunc(512);break;case k:e.depthFunc(519);break;case F:e.depthFunc(513);break;case B:e.depthFunc(515);break;case z:e.depthFunc(514);break;case G:e.depthFunc(518);break;case V:e.depthFunc(516);break;case H:e.depthFunc(517);break;default:e.depthFunc(515)}n=t}},setLocked:function(e){t=e},setClear:function(t){i!==t&&(e.clearDepth(t),i=t)},reset:function(){t=!1,r=null,n=null,i=null}}},c=new function(){let t=!1,r=null,n=null,i=null,s=null,o=null,a=null,l=null,c=null;return{setTest:function(e){t||(e?be(2960):we(2960))},setMask:function(n){r===n||t||(e.stencilMask(n),r=n)},setFunc:function(t,r,o){n===t&&i===r&&s===o||(e.stencilFunc(t,r,o),n=t,i=r,s=o)},setOp:function(t,r,n){o===t&&a===r&&l===n||(e.stencilOp(t,r,n),o=t,a=r,l=n)},setLocked:function(e){t=e},setClear:function(t){c!==t&&(e.clearStencil(t),c=t)},reset:function(){t=!1,r=null,n=null,i=null,s=null,o=null,a=null,l=null,c=null}}},u=new WeakMap,h=new WeakMap;let d={},W={},X=new WeakMap,q=[],Y=null,Z=!1,J=null,K=null,Q=null,$=null,ee=null,te=null,re=null,ne=!1,ie=null,se=null,oe=null,ae=null,le=null;const ce=e.getParameter(35661);let ue=!1,he=0;const de=e.getParameter(7938);-1!==de.indexOf("WebGL")?(he=parseFloat(/^WebGL (\d)/.exec(de)[1]),ue=he>=1):-1!==de.indexOf("OpenGL ES")&&(he=parseFloat(/^OpenGL ES (\d)/.exec(de)[1]),ue=he>=2);let pe=null,fe={};const me=e.getParameter(3088),ge=e.getParameter(2978),ye=(new xr).fromArray(me),ve=(new xr).fromArray(ge);function _e(t,r,n){const i=new Uint8Array(4),s=e.createTexture();e.bindTexture(t,s),e.texParameteri(t,10241,9728),e.texParameteri(t,10240,9728);for(let t=0;t<n;t++)e.texImage2D(r+t,0,6408,1,1,0,6408,5121,i);return s}const xe={};function be(t){!0!==d[t]&&(e.enable(t),d[t]=!0)}function we(t){!1!==d[t]&&(e.disable(t),d[t]=!1)}xe[3553]=_e(3553,3553,1),xe[34067]=_e(34067,34069,6),i.setClear(0,0,0,1),s.setClear(1),c.setClear(0),be(2929),s.setFunc(B),Ee(!1),Ae(a),be(2884),Te(m);const Se={[b]:32774,[w]:32778,[S]:32779};if(n)Se[M]=32775,Se[T]=32776;else{const e=t.get("EXT_blend_minmax");null!==e&&(Se[M]=e.MIN_EXT,Se[T]=e.MAX_EXT)}const Me={[E]:0,[A]:1,[C]:768,[R]:770,[N]:776,[D]:774,[j]:772,[L]:769,[P]:771,[O]:775,[I]:773};function Te(t,r,n,i,s,o,a,l){if(t!==m){if(!1===Z&&(be(3042),Z=!0),t===x)s=s||r,o=o||n,a=a||i,r===K&&s===ee||(e.blendEquationSeparate(Se[r],Se[s]),K=r,ee=s),n===Q&&i===$&&o===te&&a===re||(e.blendFuncSeparate(Me[n],Me[i],Me[o],Me[a]),Q=n,$=i,te=o,re=a),J=t,ne=!1;else if(t!==J||l!==ne){if(K===b&&ee===b||(e.blendEquation(32774),K=b,ee=b),l)switch(t){case g:e.blendFuncSeparate(1,771,1,771);break;case y:e.blendFunc(1,1);break;case v:e.blendFuncSeparate(0,769,0,1);break;case _:e.blendFuncSeparate(0,768,0,770)}else switch(t){case g:e.blendFuncSeparate(770,771,1,771);break;case y:e.blendFunc(770,1);break;case v:e.blendFuncSeparate(0,769,0,1);break;case _:e.blendFunc(0,768)}Q=null,$=null,te=null,re=null,J=t,ne=l}}else!0===Z&&(we(3042),Z=!1)}function Ee(t){ie!==t&&(t?e.frontFace(2304):e.frontFace(2305),ie=t)}function Ae(t){t!==o?(be(2884),t!==se&&(t===a?e.cullFace(1029):t===l?e.cullFace(1028):e.cullFace(1032))):we(2884),se=t}function Ce(t,r,n){t?(be(32823),ae===r&&le===n||(e.polygonOffset(r,n),ae=r,le=n)):we(32823)}return{buffers:{color:i,depth:s,stencil:c},enable:be,disable:we,bindFramebuffer:function(t,r){return W[t]!==r&&(e.bindFramebuffer(t,r),W[t]=r,n&&(36009===t&&(W[36160]=r),36160===t&&(W[36009]=r)),!0)},drawBuffers:function(n,i){let s=q,o=!1;if(n)if(s=X.get(i),void 0===s&&(s=[],X.set(i,s)),n.isWebGLMultipleRenderTargets){const e=n.texture;if(s.length!==e.length||36064!==s[0]){for(let t=0,r=e.length;t<r;t++)s[t]=36064+t;s.length=e.length,o=!0}}else 36064!==s[0]&&(s[0]=36064,o=!0);else 1029!==s[0]&&(s[0]=1029,o=!0);o&&(r.isWebGL2?e.drawBuffers(s):t.get("WEBGL_draw_buffers").drawBuffersWEBGL(s))},useProgram:function(t){return Y!==t&&(e.useProgram(t),Y=t,!0)},setBlending:Te,setMaterial:function(e,t){e.side===f?we(2884):be(2884);let r=e.side===p;t&&(r=!r),Ee(r),e.blending===g&&!1===e.transparent?Te(m):Te(e.blending,e.blendEquation,e.blendSrc,e.blendDst,e.blendEquationAlpha,e.blendSrcAlpha,e.blendDstAlpha,e.premultipliedAlpha),s.setFunc(e.depthFunc),s.setTest(e.depthTest),s.setMask(e.depthWrite),i.setMask(e.colorWrite);const n=e.stencilWrite;c.setTest(n),n&&(c.setMask(e.stencilWriteMask),c.setFunc(e.stencilFunc,e.stencilRef,e.stencilFuncMask),c.setOp(e.stencilFail,e.stencilZFail,e.stencilZPass)),Ce(e.polygonOffset,e.polygonOffsetFactor,e.polygonOffsetUnits),!0===e.alphaToCoverage?be(32926):we(32926)},setFlipSided:Ee,setCullFace:Ae,setLineWidth:function(t){t!==oe&&(ue&&e.lineWidth(t),oe=t)},setPolygonOffset:Ce,setScissorTest:function(e){e?be(3089):we(3089)},activeTexture:function(t){void 0===t&&(t=33984+ce-1),pe!==t&&(e.activeTexture(t),pe=t)},bindTexture:function(t,r,n){void 0===n&&(n=null===pe?33984+ce-1:pe);let i=fe[n];void 0===i&&(i={type:void 0,texture:void 0},fe[n]=i),i.type===t&&i.texture===r||(pe!==n&&(e.activeTexture(n),pe=n),e.bindTexture(t,r||xe[t]),i.type=t,i.texture=r)},unbindTexture:function(){const t=fe[pe];void 0!==t&&void 0!==t.type&&(e.bindTexture(t.type,null),t.type=void 0,t.texture=void 0)},compressedTexImage2D:function(){try{e.compressedTexImage2D.apply(e,arguments)}catch(e){}},compressedTexImage3D:function(){try{e.compressedTexImage3D.apply(e,arguments)}catch(e){}},texImage2D:function(){try{e.texImage2D.apply(e,arguments)}catch(e){}},texImage3D:function(){try{e.texImage3D.apply(e,arguments)}catch(e){}},updateUBOMapping:function(t,r){let n=h.get(r);void 0===n&&(n=new WeakMap,h.set(r,n));let i=n.get(t);void 0===i&&(i=e.getUniformBlockIndex(r,t.name),n.set(t,i))},uniformBlockBinding:function(t,r){const n=h.get(r).get(t);u.get(r)!==n&&(e.uniformBlockBinding(r,n,t.__bindingPointIndex),u.set(r,n))},texStorage2D:function(){try{e.texStorage2D.apply(e,arguments)}catch(e){}},texStorage3D:function(){try{e.texStorage3D.apply(e,arguments)}catch(e){}},texSubImage2D:function(){try{e.texSubImage2D.apply(e,arguments)}catch(e){}},texSubImage3D:function(){try{e.texSubImage3D.apply(e,arguments)}catch(e){}},compressedTexSubImage2D:function(){try{e.compressedTexSubImage2D.apply(e,arguments)}catch(e){}},compressedTexSubImage3D:function(){try{e.compressedTexSubImage3D.apply(e,arguments)}catch(e){}},scissor:function(t){!1===ye.equals(t)&&(e.scissor(t.x,t.y,t.z,t.w),ye.copy(t))},viewport:function(t){!1===ve.equals(t)&&(e.viewport(t.x,t.y,t.z,t.w),ve.copy(t))},reset:function(){e.disable(3042),e.disable(2884),e.disable(2929),e.disable(32823),e.disable(3089),e.disable(2960),e.disable(32926),e.blendEquation(32774),e.blendFunc(1,0),e.blendFuncSeparate(1,0,1,0),e.colorMask(!0,!0,!0,!0),e.clearColor(0,0,0,0),e.depthMask(!0),e.depthFunc(513),e.clearDepth(1),e.stencilMask(4294967295),e.stencilFunc(519,0,4294967295),e.stencilOp(7680,7680,7680),e.clearStencil(0),e.cullFace(1029),e.frontFace(2305),e.polygonOffset(0,0),e.activeTexture(33984),e.bindFramebuffer(36160,null),!0===n&&(e.bindFramebuffer(36009,null),e.bindFramebuffer(36008,null)),e.useProgram(null),e.lineWidth(1),e.scissor(0,0,e.canvas.width,e.canvas.height),e.viewport(0,0,e.canvas.width,e.canvas.height),d={},pe=null,fe={},W={},X=new WeakMap,q=[],Y=null,Z=!1,J=null,K=null,Q=null,$=null,ee=null,te=null,re=null,ne=!1,ie=null,se=null,oe=null,ae=null,le=null,ye.set(0,0,e.canvas.width,e.canvas.height),ve.set(0,0,e.canvas.width,e.canvas.height),i.reset(),s.reset(),c.reset()}}}function ha(e,t,r,n,i,s,o){const a=i.isWebGL2,l=(i.maxTextures,i.maxCubemapSize),c=i.maxTextureSize,u=i.maxSamples,h=t.has("WEBGL_multisampled_render_to_texture")?t.get("WEBGL_multisampled_render_to_texture"):null,d="undefined"!=typeof navigator&&/OculusBrowser/g.test(navigator.userAgent),p=new WeakMap;let f;const m=new WeakMap;let g=!1;try{g="undefined"!=typeof OffscreenCanvas&&null!==new OffscreenCanvas(1,1).getContext("2d")}catch(e){}function y(e,t){return g?new OffscreenCanvas(e,t):tr("canvas")}function v(e,t,r,n){let i=1;if((e.width>n||e.height>n)&&(i=n/Math.max(e.width,e.height)),i<1||!0===t){if("undefined"!=typeof HTMLImageElement&&e instanceof HTMLImageElement||"undefined"!=typeof HTMLCanvasElement&&e instanceof HTMLCanvasElement||"undefined"!=typeof ImageBitmap&&e instanceof ImageBitmap){const n=t?qt:Math.floor,s=n(i*e.width),o=n(i*e.height);void 0===f&&(f=y(s,o));const a=r?y(s,o):f;a.width=s,a.height=o;return a.getContext("2d").drawImage(e,0,0,s,o),a}return e}return e}function _(e){return Wt(e.width)&&Wt(e.height)}function x(e,t){return e.generateMipmaps&&t&&e.minFilter!==le&&e.minFilter!==he}function b(t){e.generateMipmap(t)}function w(r,n,i,s,o=!1){if(!1===a)return n;if(null!==r&&void 0!==e[r])return e[r];let l=n;return 6403===n&&(5126===i&&(l=33326),5131===i&&(l=33325),5121===i&&(l=33321)),33319===n&&(5126===i&&(l=33328),5131===i&&(l=33327),5121===i&&(l=33323)),6408===n&&(5126===i&&(l=34836),5131===i&&(l=34842),5121===i&&(l=s===Tt&&!1===o?35907:32856),32819===i&&(l=32854),32820===i&&(l=32855)),33325!==l&&33326!==l&&33327!==l&&33328!==l&&34842!==l&&34836!==l||t.get("EXT_color_buffer_float"),l}function S(e,t,r){return!0===x(e,r)||e.isFramebufferTexture&&e.minFilter!==le&&e.minFilter!==he?Math.log2(Math.max(t.width,t.height))+1:void 0!==e.mipmaps&&e.mipmaps.length>0?e.mipmaps.length:e.isCompressedTexture&&Array.isArray(e.image)?t.mipmaps.length:1}function M(e){return e===le||e===ce||e===ue?9728:9729}function T(e){const t=e.target;t.removeEventListener("dispose",T),function(e){const t=n.get(e);if(void 0===t.__webglInit)return;const r=e.source,i=m.get(r);if(i){const n=i[t.__cacheKey];n.usedTimes--,0===n.usedTimes&&A(e),0===Object.keys(i).length&&m.delete(r)}n.remove(e)}(t),t.isVideoTexture&&p.delete(t)}function E(t){const r=t.target;r.removeEventListener("dispose",E),function(t){const r=t.texture,i=n.get(t),s=n.get(r);void 0!==s.__webglTexture&&(e.deleteTexture(s.__webglTexture),o.memory.textures--);t.depthTexture&&t.depthTexture.dispose();if(t.isWebGLCubeRenderTarget)for(let t=0;t<6;t++)e.deleteFramebuffer(i.__webglFramebuffer[t]),i.__webglDepthbuffer&&e.deleteRenderbuffer(i.__webglDepthbuffer[t]);else{if(e.deleteFramebuffer(i.__webglFramebuffer),i.__webglDepthbuffer&&e.deleteRenderbuffer(i.__webglDepthbuffer),i.__webglMultisampledFramebuffer&&e.deleteFramebuffer(i.__webglMultisampledFramebuffer),i.__webglColorRenderbuffer)for(let t=0;t<i.__webglColorRenderbuffer.length;t++)i.__webglColorRenderbuffer[t]&&e.deleteRenderbuffer(i.__webglColorRenderbuffer[t]);i.__webglDepthRenderbuffer&&e.deleteRenderbuffer(i.__webglDepthRenderbuffer)}if(t.isWebGLMultipleRenderTargets)for(let t=0,i=r.length;t<i;t++){const i=n.get(r[t]);i.__webglTexture&&(e.deleteTexture(i.__webglTexture),o.memory.textures--),n.remove(r[t])}n.remove(r),n.remove(t)}(r)}function A(t){const r=n.get(t);e.deleteTexture(r.__webglTexture);const i=t.source;delete m.get(i)[r.__cacheKey],o.memory.textures--}let C=0;function L(e,t){const i=n.get(e);if(e.isVideoTexture&&function(e){const t=o.render.frame;p.get(e)!==t&&(p.set(e,t),e.update())}(e),!1===e.isRenderTargetTexture&&e.version>0&&i.__version!==e.version){const r=e.image;if(null===r);else if(!1!==r.complete)return void D(i,e,t)}r.bindTexture(3553,i.__webglTexture,33984+t)}const R={[se]:10497,[oe]:33071,[ae]:33648},P={[le]:9728,[ce]:9984,[ue]:9986,[he]:9729,[de]:9985,[pe]:9987};function j(r,s,o){if(o?(e.texParameteri(r,10242,R[s.wrapS]),e.texParameteri(r,10243,R[s.wrapT]),32879!==r&&35866!==r||e.texParameteri(r,32882,R[s.wrapR]),e.texParameteri(r,10240,P[s.magFilter]),e.texParameteri(r,10241,P[s.minFilter])):(e.texParameteri(r,10242,33071),e.texParameteri(r,10243,33071),32879!==r&&35866!==r||e.texParameteri(r,32882,33071),s.wrapS!==oe||s.wrapT,e.texParameteri(r,10240,M(s.magFilter)),e.texParameteri(r,10241,M(s.minFilter)),s.minFilter!==le&&s.minFilter),!0===t.has("EXT_texture_filter_anisotropic")){const o=t.get("EXT_texture_filter_anisotropic");if(s.magFilter===le)return;if(s.minFilter!==ue&&s.minFilter!==pe)return;if(s.type===xe&&!1===t.has("OES_texture_float_linear"))return;if(!1===a&&s.type===be&&!1===t.has("OES_texture_half_float_linear"))return;(s.anisotropy>1||n.get(s).__currentAnisotropy)&&(e.texParameterf(r,o.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(s.anisotropy,i.getMaxAnisotropy())),n.get(s).__currentAnisotropy=s.anisotropy)}}function I(t,r){let n=!1;void 0===t.__webglInit&&(t.__webglInit=!0,r.addEventListener("dispose",T));const i=r.source;let s=m.get(i);void 0===s&&(s={},m.set(i,s));const a=function(e){const t=[];return t.push(e.wrapS),t.push(e.wrapT),t.push(e.wrapR||0),t.push(e.magFilter),t.push(e.minFilter),t.push(e.anisotropy),t.push(e.internalFormat),t.push(e.format),t.push(e.type),t.push(e.generateMipmaps),t.push(e.premultiplyAlpha),t.push(e.flipY),t.push(e.unpackAlignment),t.push(e.encoding),t.join()}(r);if(a!==t.__cacheKey){void 0===s[a]&&(s[a]={texture:e.createTexture(),usedTimes:0},o.memory.textures++,n=!0),s[a].usedTimes++;const i=s[t.__cacheKey];void 0!==i&&(s[t.__cacheKey].usedTimes--,0===i.usedTimes&&A(r)),t.__cacheKey=a,t.__webglTexture=s[a].texture}return n}function D(t,i,o){let l=3553;(i.isDataArrayTexture||i.isCompressedArrayTexture)&&(l=35866),i.isData3DTexture&&(l=32879);const u=I(t,i),h=i.source;r.bindTexture(l,t.__webglTexture,33984+o);const d=n.get(h);if(h.version!==d.__version||!0===u){r.activeTexture(33984+o),e.pixelStorei(37440,i.flipY),e.pixelStorei(37441,i.premultiplyAlpha),e.pixelStorei(3317,i.unpackAlignment),e.pixelStorei(37443,0);const t=function(e){return!a&&(e.wrapS!==oe||e.wrapT!==oe||e.minFilter!==le&&e.minFilter!==he)}(i)&&!1===_(i.image);let n=v(i.image,t,!1,c);n=B(i,n);const p=_(n)||a,f=s.convert(i.format,i.encoding);let m,g=s.convert(i.type),y=w(i.internalFormat,f,g,i.encoding,i.isVideoTexture);j(l,i,p);const M=i.mipmaps,T=a&&!0!==i.isVideoTexture,E=void 0===d.__version||!0===u,A=S(i,n,p);if(i.isDepthTexture)y=6402,a?y=i.type===xe?36012:i.type===_e?33190:i.type===Me?35056:33189:i.type,i.format===Le&&6402===y&&i.type!==ye&&i.type!==_e&&(i.type=_e,g=s.convert(i.type)),i.format===Re&&6402===y&&(y=34041,i.type!==Me&&(i.type=Me,g=s.convert(i.type))),E&&(T?r.texStorage2D(3553,1,y,n.width,n.height):r.texImage2D(3553,0,y,n.width,n.height,0,f,g,null));else if(i.isDataTexture)if(M.length>0&&p){T&&E&&r.texStorage2D(3553,A,y,M[0].width,M[0].height);for(let e=0,t=M.length;e<t;e++)m=M[e],T?r.texSubImage2D(3553,e,0,0,m.width,m.height,f,g,m.data):r.texImage2D(3553,e,y,m.width,m.height,0,f,g,m.data);i.generateMipmaps=!1}else T?(E&&r.texStorage2D(3553,A,y,n.width,n.height),r.texSubImage2D(3553,0,0,0,n.width,n.height,f,g,n.data)):r.texImage2D(3553,0,y,n.width,n.height,0,f,g,n.data);else if(i.isCompressedTexture)if(i.isCompressedArrayTexture){T&&E&&r.texStorage3D(35866,A,y,M[0].width,M[0].height,n.depth);for(let e=0,t=M.length;e<t;e++)m=M[e],i.format!==Ee?null!==f&&(T?r.compressedTexSubImage3D(35866,e,0,0,0,m.width,m.height,n.depth,f,m.data,0,0):r.compressedTexImage3D(35866,e,y,m.width,m.height,n.depth,0,m.data,0,0)):T?r.texSubImage3D(35866,e,0,0,0,m.width,m.height,n.depth,f,g,m.data):r.texImage3D(35866,e,y,m.width,m.height,n.depth,0,f,g,m.data)}else{T&&E&&r.texStorage2D(3553,A,y,M[0].width,M[0].height);for(let e=0,t=M.length;e<t;e++)m=M[e],i.format!==Ee?null!==f&&(T?r.compressedTexSubImage2D(3553,e,0,0,m.width,m.height,f,m.data):r.compressedTexImage2D(3553,e,y,m.width,m.height,0,m.data)):T?r.texSubImage2D(3553,e,0,0,m.width,m.height,f,g,m.data):r.texImage2D(3553,e,y,m.width,m.height,0,f,g,m.data)}else if(i.isDataArrayTexture)T?(E&&r.texStorage3D(35866,A,y,n.width,n.height,n.depth),r.texSubImage3D(35866,0,0,0,0,n.width,n.height,n.depth,f,g,n.data)):r.texImage3D(35866,0,y,n.width,n.height,n.depth,0,f,g,n.data);else if(i.isData3DTexture)T?(E&&r.texStorage3D(32879,A,y,n.width,n.height,n.depth),r.texSubImage3D(32879,0,0,0,0,n.width,n.height,n.depth,f,g,n.data)):r.texImage3D(32879,0,y,n.width,n.height,n.depth,0,f,g,n.data);else if(i.isFramebufferTexture){if(E)if(T)r.texStorage2D(3553,A,y,n.width,n.height);else{let e=n.width,t=n.height;for(let n=0;n<A;n++)r.texImage2D(3553,n,y,e,t,0,f,g,null),e>>=1,t>>=1}}else if(M.length>0&&p){T&&E&&r.texStorage2D(3553,A,y,M[0].width,M[0].height);for(let e=0,t=M.length;e<t;e++)m=M[e],T?r.texSubImage2D(3553,e,0,0,f,g,m):r.texImage2D(3553,e,y,f,g,m);i.generateMipmaps=!1}else T?(E&&r.texStorage2D(3553,A,y,n.width,n.height),r.texSubImage2D(3553,0,0,0,f,g,n)):r.texImage2D(3553,0,y,f,g,n);x(i,p)&&b(l),d.__version=h.version,i.onUpdate&&i.onUpdate(i)}t.__version=i.version}function O(t,i,o,a,l){const c=s.convert(o.format,o.encoding),u=s.convert(o.type),d=w(o.internalFormat,c,u,o.encoding);n.get(i).__hasExternalTextures||(32879===l||35866===l?r.texImage3D(l,0,d,i.width,i.height,i.depth,0,c,u,null):r.texImage2D(l,0,d,i.width,i.height,0,c,u,null)),r.bindFramebuffer(36160,t),F(i)?h.framebufferTexture2DMultisampleEXT(36160,a,l,n.get(o).__webglTexture,0,k(i)):(3553===l||l>=34069&&l<=34074)&&e.framebufferTexture2D(36160,a,l,n.get(o).__webglTexture,0),r.bindFramebuffer(36160,null)}function N(t,r,n){if(e.bindRenderbuffer(36161,t),r.depthBuffer&&!r.stencilBuffer){let i=33189;if(n||F(r)){const t=r.depthTexture;t&&t.isDepthTexture&&(t.type===xe?i=36012:t.type===_e&&(i=33190));const n=k(r);F(r)?h.renderbufferStorageMultisampleEXT(36161,n,i,r.width,r.height):e.renderbufferStorageMultisample(36161,n,i,r.width,r.height)}else e.renderbufferStorage(36161,i,r.width,r.height);e.framebufferRenderbuffer(36160,36096,36161,t)}else if(r.depthBuffer&&r.stencilBuffer){const i=k(r);n&&!1===F(r)?e.renderbufferStorageMultisample(36161,i,35056,r.width,r.height):F(r)?h.renderbufferStorageMultisampleEXT(36161,i,35056,r.width,r.height):e.renderbufferStorage(36161,34041,r.width,r.height),e.framebufferRenderbuffer(36160,33306,36161,t)}else{const t=!0===r.isWebGLMultipleRenderTargets?r.texture:[r.texture];for(let i=0;i<t.length;i++){const o=t[i],a=s.convert(o.format,o.encoding),l=s.convert(o.type),c=w(o.internalFormat,a,l,o.encoding),u=k(r);n&&!1===F(r)?e.renderbufferStorageMultisample(36161,u,c,r.width,r.height):F(r)?h.renderbufferStorageMultisampleEXT(36161,u,c,r.width,r.height):e.renderbufferStorage(36161,c,r.width,r.height)}}e.bindRenderbuffer(36161,null)}function U(t){const i=n.get(t),s=!0===t.isWebGLCubeRenderTarget;if(t.depthTexture&&!i.__autoAllocateDepthBuffer){if(s)throw new Error("target.depthTexture not supported in Cube render targets");!function(t,i){if(i&&i.isWebGLCubeRenderTarget)throw new Error("Depth Texture with cube render targets is not supported");if(r.bindFramebuffer(36160,t),!i.depthTexture||!i.depthTexture.isDepthTexture)throw new Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");n.get(i.depthTexture).__webglTexture&&i.depthTexture.image.width===i.width&&i.depthTexture.image.height===i.height||(i.depthTexture.image.width=i.width,i.depthTexture.image.height=i.height,i.depthTexture.needsUpdate=!0),L(i.depthTexture,0);const s=n.get(i.depthTexture).__webglTexture,o=k(i);if(i.depthTexture.format===Le)F(i)?h.framebufferTexture2DMultisampleEXT(36160,36096,3553,s,0,o):e.framebufferTexture2D(36160,36096,3553,s,0);else{if(i.depthTexture.format!==Re)throw new Error("Unknown depthTexture format");F(i)?h.framebufferTexture2DMultisampleEXT(36160,33306,3553,s,0,o):e.framebufferTexture2D(36160,33306,3553,s,0)}}(i.__webglFramebuffer,t)}else if(s){i.__webglDepthbuffer=[];for(let n=0;n<6;n++)r.bindFramebuffer(36160,i.__webglFramebuffer[n]),i.__webglDepthbuffer[n]=e.createRenderbuffer(),N(i.__webglDepthbuffer[n],t,!1)}else r.bindFramebuffer(36160,i.__webglFramebuffer),i.__webglDepthbuffer=e.createRenderbuffer(),N(i.__webglDepthbuffer,t,!1);r.bindFramebuffer(36160,null)}function k(e){return Math.min(u,e.samples)}function F(e){const r=n.get(e);return a&&e.samples>0&&!0===t.has("WEBGL_multisampled_render_to_texture")&&!1!==r.__useRenderToTexture}function B(e,r){const n=e.encoding,i=e.format;e.type;return!0===e.isCompressedTexture||!0===e.isVideoTexture||e.format===Ot||n!==Mt&&n===Tt&&!1===a&&(!0===t.has("EXT_sRGB")&&i===Ee?(e.format=Ot,e.minFilter=he,e.generateMipmaps=!1):r=mr.sRGBToLinear(r)),r}this.allocateTextureUnit=function(){const e=C;return C+=1,e},this.resetTextureUnits=function(){C=0},this.setTexture2D=L,this.setTexture2DArray=function(e,t){const i=n.get(e);e.version>0&&i.__version!==e.version?D(i,e,t):r.bindTexture(35866,i.__webglTexture,33984+t)},this.setTexture3D=function(e,t){const i=n.get(e);e.version>0&&i.__version!==e.version?D(i,e,t):r.bindTexture(32879,i.__webglTexture,33984+t)},this.setTextureCube=function(t,i){const o=n.get(t);t.version>0&&o.__version!==t.version?function(t,i,o){if(6!==i.image.length)return;const c=I(t,i),u=i.source;r.bindTexture(34067,t.__webglTexture,33984+o);const h=n.get(u);if(u.version!==h.__version||!0===c){r.activeTexture(33984+o),e.pixelStorei(37440,i.flipY),e.pixelStorei(37441,i.premultiplyAlpha),e.pixelStorei(3317,i.unpackAlignment),e.pixelStorei(37443,0);const t=i.isCompressedTexture||i.image[0].isCompressedTexture,n=i.image[0]&&i.image[0].isDataTexture,d=[];for(let e=0;e<6;e++)d[e]=t||n?n?i.image[e].image:i.image[e]:v(i.image[e],!1,!0,l),d[e]=B(i,d[e]);const p=d[0],f=_(p)||a,m=s.convert(i.format,i.encoding),g=s.convert(i.type),y=w(i.internalFormat,m,g,i.encoding),M=a&&!0!==i.isVideoTexture,T=void 0===h.__version||!0===c;let E,A=S(i,p,f);if(j(34067,i,f),t){M&&T&&r.texStorage2D(34067,A,y,p.width,p.height);for(let e=0;e<6;e++){E=d[e].mipmaps;for(let t=0;t<E.length;t++){const n=E[t];i.format!==Ee?null!==m&&(M?r.compressedTexSubImage2D(34069+e,t,0,0,n.width,n.height,m,n.data):r.compressedTexImage2D(34069+e,t,y,n.width,n.height,0,n.data)):M?r.texSubImage2D(34069+e,t,0,0,n.width,n.height,m,g,n.data):r.texImage2D(34069+e,t,y,n.width,n.height,0,m,g,n.data)}}}else{E=i.mipmaps,M&&T&&(E.length>0&&A++,r.texStorage2D(34067,A,y,d[0].width,d[0].height));for(let e=0;e<6;e++)if(n){M?r.texSubImage2D(34069+e,0,0,0,d[e].width,d[e].height,m,g,d[e].data):r.texImage2D(34069+e,0,y,d[e].width,d[e].height,0,m,g,d[e].data);for(let t=0;t<E.length;t++){const n=E[t].image[e].image;M?r.texSubImage2D(34069+e,t+1,0,0,n.width,n.height,m,g,n.data):r.texImage2D(34069+e,t+1,y,n.width,n.height,0,m,g,n.data)}}else{M?r.texSubImage2D(34069+e,0,0,0,m,g,d[e]):r.texImage2D(34069+e,0,y,m,g,d[e]);for(let t=0;t<E.length;t++){const n=E[t];M?r.texSubImage2D(34069+e,t+1,0,0,m,g,n.image[e]):r.texImage2D(34069+e,t+1,y,m,g,n.image[e])}}}x(i,f)&&b(34067),h.__version=u.version,i.onUpdate&&i.onUpdate(i)}t.__version=i.version}(o,t,i):r.bindTexture(34067,o.__webglTexture,33984+i)},this.rebindTextures=function(e,t,r){const i=n.get(e);void 0!==t&&O(i.__webglFramebuffer,e,e.texture,36064,3553),void 0!==r&&U(e)},this.setupRenderTarget=function(t){const l=t.texture,c=n.get(t),u=n.get(l);t.addEventListener("dispose",E),!0!==t.isWebGLMultipleRenderTargets&&(void 0===u.__webglTexture&&(u.__webglTexture=e.createTexture()),u.__version=l.version,o.memory.textures++);const h=!0===t.isWebGLCubeRenderTarget,d=!0===t.isWebGLMultipleRenderTargets,p=_(t)||a;if(h){c.__webglFramebuffer=[];for(let t=0;t<6;t++)c.__webglFramebuffer[t]=e.createFramebuffer()}else{if(c.__webglFramebuffer=e.createFramebuffer(),d&&i.drawBuffers){const r=t.texture;for(let t=0,i=r.length;t<i;t++){const i=n.get(r[t]);void 0===i.__webglTexture&&(i.__webglTexture=e.createTexture(),o.memory.textures++)}}if(a&&t.samples>0&&!1===F(t)){const n=d?l:[l];c.__webglMultisampledFramebuffer=e.createFramebuffer(),c.__webglColorRenderbuffer=[],r.bindFramebuffer(36160,c.__webglMultisampledFramebuffer);for(let r=0;r<n.length;r++){const i=n[r];c.__webglColorRenderbuffer[r]=e.createRenderbuffer(),e.bindRenderbuffer(36161,c.__webglColorRenderbuffer[r]);const o=s.convert(i.format,i.encoding),a=s.convert(i.type),l=w(i.internalFormat,o,a,i.encoding,!0===t.isXRRenderTarget),u=k(t);e.renderbufferStorageMultisample(36161,u,l,t.width,t.height),e.framebufferRenderbuffer(36160,36064+r,36161,c.__webglColorRenderbuffer[r])}e.bindRenderbuffer(36161,null),t.depthBuffer&&(c.__webglDepthRenderbuffer=e.createRenderbuffer(),N(c.__webglDepthRenderbuffer,t,!0)),r.bindFramebuffer(36160,null)}}if(h){r.bindTexture(34067,u.__webglTexture),j(34067,l,p);for(let e=0;e<6;e++)O(c.__webglFramebuffer[e],t,l,36064,34069+e);x(l,p)&&b(34067),r.unbindTexture()}else if(d){const e=t.texture;for(let i=0,s=e.length;i<s;i++){const s=e[i],o=n.get(s);r.bindTexture(3553,o.__webglTexture),j(3553,s,p),O(c.__webglFramebuffer,t,s,36064+i,3553),x(s,p)&&b(3553)}r.unbindTexture()}else{let e=3553;(t.isWebGL3DRenderTarget||t.isWebGLArrayRenderTarget)&&a&&(e=t.isWebGL3DRenderTarget?32879:35866),r.bindTexture(e,u.__webglTexture),j(e,l,p),O(c.__webglFramebuffer,t,l,36064,e),x(l,p)&&b(e),r.unbindTexture()}t.depthBuffer&&U(t)},this.updateRenderTargetMipmap=function(e){const t=_(e)||a,i=!0===e.isWebGLMultipleRenderTargets?e.texture:[e.texture];for(let s=0,o=i.length;s<o;s++){const o=i[s];if(x(o,t)){const t=e.isWebGLCubeRenderTarget?34067:3553,i=n.get(o).__webglTexture;r.bindTexture(t,i),b(t),r.unbindTexture()}}},this.updateMultisampleRenderTarget=function(t){if(a&&t.samples>0&&!1===F(t)){const i=t.isWebGLMultipleRenderTargets?t.texture:[t.texture],s=t.width,o=t.height;let a=16384;const l=[],c=t.stencilBuffer?33306:36096,u=n.get(t),h=!0===t.isWebGLMultipleRenderTargets;if(h)for(let t=0;t<i.length;t++)r.bindFramebuffer(36160,u.__webglMultisampledFramebuffer),e.framebufferRenderbuffer(36160,36064+t,36161,null),r.bindFramebuffer(36160,u.__webglFramebuffer),e.framebufferTexture2D(36009,36064+t,3553,null,0);r.bindFramebuffer(36008,u.__webglMultisampledFramebuffer),r.bindFramebuffer(36009,u.__webglFramebuffer);for(let r=0;r<i.length;r++){l.push(36064+r),t.depthBuffer&&l.push(c);const p=void 0!==u.__ignoreDepthValues&&u.__ignoreDepthValues;if(!1===p&&(t.depthBuffer&&(a|=256),t.stencilBuffer&&(a|=1024)),h&&e.framebufferRenderbuffer(36008,36064,36161,u.__webglColorRenderbuffer[r]),!0===p&&(e.invalidateFramebuffer(36008,[c]),e.invalidateFramebuffer(36009,[c])),h){const t=n.get(i[r]).__webglTexture;e.framebufferTexture2D(36009,36064,3553,t,0)}e.blitFramebuffer(0,0,s,o,0,0,s,o,a,9728),d&&e.invalidateFramebuffer(36008,l)}if(r.bindFramebuffer(36008,null),r.bindFramebuffer(36009,null),h)for(let t=0;t<i.length;t++){r.bindFramebuffer(36160,u.__webglMultisampledFramebuffer),e.framebufferRenderbuffer(36160,36064+t,36161,u.__webglColorRenderbuffer[t]);const s=n.get(i[t]).__webglTexture;r.bindFramebuffer(36160,u.__webglFramebuffer),e.framebufferTexture2D(36009,36064+t,3553,s,0)}r.bindFramebuffer(36009,u.__webglMultisampledFramebuffer)}},this.setupDepthRenderbuffer=U,this.setupFrameBufferTexture=O,this.useMultisampledRTT=F}function da(e,t,r){const n=r.isWebGL2;return{convert:function(r,i=null){let s;if(r===fe)return 5121;if(r===we)return 32819;if(r===Se)return 32820;if(r===me)return 5120;if(r===ge)return 5122;if(r===ye)return 5123;if(r===ve)return 5124;if(r===_e)return 5125;if(r===xe)return 5126;if(r===be)return n?5131:(s=t.get("OES_texture_half_float"),null!==s?s.HALF_FLOAT_OES:null);if(r===Te)return 6406;if(r===Ee)return 6408;if(r===Ae)return 6409;if(r===Ce)return 6410;if(r===Le)return 6402;if(r===Re)return 34041;if(r===Ot)return s=t.get("EXT_sRGB"),null!==s?s.SRGB_ALPHA_EXT:null;if(r===Pe)return 6403;if(r===je)return 36244;if(r===Ie)return 33319;if(r===De)return 33320;if(r===Oe)return 36249;if(r===Ne||r===Ue||r===ke||r===Fe)if(i===Tt){if(s=t.get("WEBGL_compressed_texture_s3tc_srgb"),null===s)return null;if(r===Ne)return s.COMPRESSED_SRGB_S3TC_DXT1_EXT;if(r===Ue)return s.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT;if(r===ke)return s.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT;if(r===Fe)return s.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT}else{if(s=t.get("WEBGL_compressed_texture_s3tc"),null===s)return null;if(r===Ne)return s.COMPRESSED_RGB_S3TC_DXT1_EXT;if(r===Ue)return s.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(r===ke)return s.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(r===Fe)return s.COMPRESSED_RGBA_S3TC_DXT5_EXT}if(r===Be||r===ze||r===Ge||r===Ve){if(s=t.get("WEBGL_compressed_texture_pvrtc"),null===s)return null;if(r===Be)return s.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(r===ze)return s.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(r===Ge)return s.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(r===Ve)return s.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}if(r===He)return s=t.get("WEBGL_compressed_texture_etc1"),null!==s?s.COMPRESSED_RGB_ETC1_WEBGL:null;if(r===We||r===Xe){if(s=t.get("WEBGL_compressed_texture_etc"),null===s)return null;if(r===We)return i===Tt?s.COMPRESSED_SRGB8_ETC2:s.COMPRESSED_RGB8_ETC2;if(r===Xe)return i===Tt?s.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC:s.COMPRESSED_RGBA8_ETC2_EAC}if(r===qe||r===Ye||r===Ze||r===Je||r===Ke||r===Qe||r===$e||r===et||r===tt||r===rt||r===nt||r===it||r===st||r===ot){if(s=t.get("WEBGL_compressed_texture_astc"),null===s)return null;if(r===qe)return i===Tt?s.COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR:s.COMPRESSED_RGBA_ASTC_4x4_KHR;if(r===Ye)return i===Tt?s.COMPRESSED_SRGB8_ALPHA8_ASTC_5x4_KHR:s.COMPRESSED_RGBA_ASTC_5x4_KHR;if(r===Ze)return i===Tt?s.COMPRESSED_SRGB8_ALPHA8_ASTC_5x5_KHR:s.COMPRESSED_RGBA_ASTC_5x5_KHR;if(r===Je)return i===Tt?s.COMPRESSED_SRGB8_ALPHA8_ASTC_6x5_KHR:s.COMPRESSED_RGBA_ASTC_6x5_KHR;if(r===Ke)return i===Tt?s.COMPRESSED_SRGB8_ALPHA8_ASTC_6x6_KHR:s.COMPRESSED_RGBA_ASTC_6x6_KHR;if(r===Qe)return i===Tt?s.COMPRESSED_SRGB8_ALPHA8_ASTC_8x5_KHR:s.COMPRESSED_RGBA_ASTC_8x5_KHR;if(r===$e)return i===Tt?s.COMPRESSED_SRGB8_ALPHA8_ASTC_8x6_KHR:s.COMPRESSED_RGBA_ASTC_8x6_KHR;if(r===et)return i===Tt?s.COMPRESSED_SRGB8_ALPHA8_ASTC_8x8_KHR:s.COMPRESSED_RGBA_ASTC_8x8_KHR;if(r===tt)return i===Tt?s.COMPRESSED_SRGB8_ALPHA8_ASTC_10x5_KHR:s.COMPRESSED_RGBA_ASTC_10x5_KHR;if(r===rt)return i===Tt?s.COMPRESSED_SRGB8_ALPHA8_ASTC_10x6_KHR:s.COMPRESSED_RGBA_ASTC_10x6_KHR;if(r===nt)return i===Tt?s.COMPRESSED_SRGB8_ALPHA8_ASTC_10x8_KHR:s.COMPRESSED_RGBA_ASTC_10x8_KHR;if(r===it)return i===Tt?s.COMPRESSED_SRGB8_ALPHA8_ASTC_10x10_KHR:s.COMPRESSED_RGBA_ASTC_10x10_KHR;if(r===st)return i===Tt?s.COMPRESSED_SRGB8_ALPHA8_ASTC_12x10_KHR:s.COMPRESSED_RGBA_ASTC_12x10_KHR;if(r===ot)return i===Tt?s.COMPRESSED_SRGB8_ALPHA8_ASTC_12x12_KHR:s.COMPRESSED_RGBA_ASTC_12x12_KHR}if(r===at){if(s=t.get("EXT_texture_compression_bptc"),null===s)return null;if(r===at)return i===Tt?s.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT:s.COMPRESSED_RGBA_BPTC_UNORM_EXT}if(r===lt||r===ct||r===ut||r===ht){if(s=t.get("EXT_texture_compression_rgtc"),null===s)return null;if(r===at)return s.COMPRESSED_RED_RGTC1_EXT;if(r===ct)return s.COMPRESSED_SIGNED_RED_RGTC1_EXT;if(r===ut)return s.COMPRESSED_RED_GREEN_RGTC2_EXT;if(r===ht)return s.COMPRESSED_SIGNED_RED_GREEN_RGTC2_EXT}return r===Me?n?34042:(s=t.get("WEBGL_depth_texture"),null!==s?s.UNSIGNED_INT_24_8_WEBGL:null):void 0!==e[r]?e[r]:null}}}class pa extends Ai{constructor(e=[]){super(),this.isArrayCamera=!0,this.cameras=e}}class fa extends Sn{constructor(){super(),this.isGroup=!0,this.type="Group"}}const ma={type:"move"};class ga{constructor(){this._targetRay=null,this._grip=null,this._hand=null}getHandSpace(){return null===this._hand&&(this._hand=new fa,this._hand.matrixAutoUpdate=!1,this._hand.visible=!1,this._hand.joints={},this._hand.inputState={pinching:!1}),this._hand}getTargetRaySpace(){return null===this._targetRay&&(this._targetRay=new fa,this._targetRay.matrixAutoUpdate=!1,this._targetRay.visible=!1,this._targetRay.hasLinearVelocity=!1,this._targetRay.linearVelocity=new nr,this._targetRay.hasAngularVelocity=!1,this._targetRay.angularVelocity=new nr),this._targetRay}getGripSpace(){return null===this._grip&&(this._grip=new fa,this._grip.matrixAutoUpdate=!1,this._grip.visible=!1,this._grip.hasLinearVelocity=!1,this._grip.linearVelocity=new nr,this._grip.hasAngularVelocity=!1,this._grip.angularVelocity=new nr),this._grip}dispatchEvent(e){return null!==this._targetRay&&this._targetRay.dispatchEvent(e),null!==this._grip&&this._grip.dispatchEvent(e),null!==this._hand&&this._hand.dispatchEvent(e),this}connect(e){if(e&&e.hand){const t=this._hand;if(t)for(const r of e.hand.values())this._getHandJoint(t,r)}return this.dispatchEvent({type:"connected",data:e}),this}disconnect(e){return this.dispatchEvent({type:"disconnected",data:e}),null!==this._targetRay&&(this._targetRay.visible=!1),null!==this._grip&&(this._grip.visible=!1),null!==this._hand&&(this._hand.visible=!1),this}update(e,t,r){let n=null,i=null,s=null;const o=this._targetRay,a=this._grip,l=this._hand;if(e&&"visible-blurred"!==t.session.visibilityState){if(l&&e.hand){s=!0;for(const n of e.hand.values()){const e=t.getJointPose(n,r),i=this._getHandJoint(l,n);null!==e&&(i.matrix.fromArray(e.transform.matrix),i.matrix.decompose(i.position,i.rotation,i.scale),i.jointRadius=e.radius),i.visible=null!==e}const n=l.joints["index-finger-tip"],i=l.joints["thumb-tip"],o=n.position.distanceTo(i.position),a=.02,c=.005;l.inputState.pinching&&o>a+c?(l.inputState.pinching=!1,this.dispatchEvent({type:"pinchend",handedness:e.handedness,target:this})):!l.inputState.pinching&&o<=a-c&&(l.inputState.pinching=!0,this.dispatchEvent({type:"pinchstart",handedness:e.handedness,target:this}))}else null!==a&&e.gripSpace&&(i=t.getPose(e.gripSpace,r),null!==i&&(a.matrix.fromArray(i.transform.matrix),a.matrix.decompose(a.position,a.rotation,a.scale),i.linearVelocity?(a.hasLinearVelocity=!0,a.linearVelocity.copy(i.linearVelocity)):a.hasLinearVelocity=!1,i.angularVelocity?(a.hasAngularVelocity=!0,a.angularVelocity.copy(i.angularVelocity)):a.hasAngularVelocity=!1));null!==o&&(n=t.getPose(e.targetRaySpace,r),null===n&&null!==i&&(n=i),null!==n&&(o.matrix.fromArray(n.transform.matrix),o.matrix.decompose(o.position,o.rotation,o.scale),n.linearVelocity?(o.hasLinearVelocity=!0,o.linearVelocity.copy(n.linearVelocity)):o.hasLinearVelocity=!1,n.angularVelocity?(o.hasAngularVelocity=!0,o.angularVelocity.copy(n.angularVelocity)):o.hasAngularVelocity=!1,this.dispatchEvent(ma)))}return null!==o&&(o.visible=null!==n),null!==a&&(a.visible=null!==i),null!==l&&(l.visible=null!==s),this}_getHandJoint(e,t){if(void 0===e.joints[t.jointName]){const r=new fa;r.matrixAutoUpdate=!1,r.visible=!1,e.joints[t.jointName]=r,e.add(r)}return e.joints[t.jointName]}}class ya extends _r{constructor(e,t,r,n,i,s,o,a,l,c){if((c=void 0!==c?c:Le)!==Le&&c!==Re)throw new Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");void 0===r&&c===Le&&(r=_e),void 0===r&&c===Re&&(r=Me),super(null,n,i,s,o,a,c,r,l),this.isDepthTexture=!0,this.image={width:e,height:t},this.magFilter=void 0!==o?o:le,this.minFilter=void 0!==a?a:le,this.flipY=!1,this.generateMipmaps=!1}}class va extends Nt{constructor(e,t){super();const r=this;let n=null,i=1,s=null,o="local-floor",a=1,l=null,c=null,u=null,h=null,d=null,p=null;const f=t.getContextAttributes();let m=null,g=null;const y=[],v=[],_=new Set,x=new Map,b=new Ai;b.layers.enable(1),b.viewport=new xr;const w=new Ai;w.layers.enable(2),w.viewport=new xr;const S=[b,w],M=new pa;M.layers.enable(1),M.layers.enable(2);let T=null,E=null;function A(e){const t=v.indexOf(e.inputSource);if(-1===t)return;const r=y[t];void 0!==r&&r.dispatchEvent({type:e.type,data:e.inputSource})}function C(){n.removeEventListener("select",A),n.removeEventListener("selectstart",A),n.removeEventListener("selectend",A),n.removeEventListener("squeeze",A),n.removeEventListener("squeezestart",A),n.removeEventListener("squeezeend",A),n.removeEventListener("end",C),n.removeEventListener("inputsourceschange",L);for(let e=0;e<y.length;e++){const t=v[e];null!==t&&(v[e]=null,y[e].disconnect(t))}T=null,E=null,e.setRenderTarget(m),d=null,h=null,u=null,n=null,g=null,D.stop(),r.isPresenting=!1,r.dispatchEvent({type:"sessionend"})}function L(e){for(let t=0;t<e.removed.length;t++){const r=e.removed[t],n=v.indexOf(r);n>=0&&(v[n]=null,y[n].disconnect(r))}for(let t=0;t<e.added.length;t++){const r=e.added[t];let n=v.indexOf(r);if(-1===n){for(let e=0;e<y.length;e++){if(e>=v.length){v.push(r),n=e;break}if(null===v[e]){v[e]=r,n=e;break}}if(-1===n)break}const i=y[n];i&&i.connect(r)}}this.cameraAutoUpdate=!0,this.enabled=!1,this.isPresenting=!1,this.getController=function(e){let t=y[e];return void 0===t&&(t=new ga,y[e]=t),t.getTargetRaySpace()},this.getControllerGrip=function(e){let t=y[e];return void 0===t&&(t=new ga,y[e]=t),t.getGripSpace()},this.getHand=function(e){let t=y[e];return void 0===t&&(t=new ga,y[e]=t),t.getHandSpace()},this.setFramebufferScaleFactor=function(e){i=e,r.isPresenting},this.setReferenceSpaceType=function(e){o=e,r.isPresenting},this.getReferenceSpace=function(){return l||s},this.setReferenceSpace=function(e){l=e},this.getBaseLayer=function(){return null!==h?h:d},this.getBinding=function(){return u},this.getFrame=function(){return p},this.getSession=function(){return n},this.setSession=async function(c){if(n=c,null!==n){if(m=e.getRenderTarget(),n.addEventListener("select",A),n.addEventListener("selectstart",A),n.addEventListener("selectend",A),n.addEventListener("squeeze",A),n.addEventListener("squeezestart",A),n.addEventListener("squeezeend",A),n.addEventListener("end",C),n.addEventListener("inputsourceschange",L),!0!==f.xrCompatible&&await t.makeXRCompatible(),void 0===n.renderState.layers||!1===e.capabilities.isWebGL2){const r={antialias:void 0!==n.renderState.layers||f.antialias,alpha:f.alpha,depth:f.depth,stencil:f.stencil,framebufferScaleFactor:i};d=new XRWebGLLayer(n,t,r),n.updateRenderState({baseLayer:d}),g=new br(d.framebufferWidth,d.framebufferHeight,{format:Ee,type:fe,encoding:e.outputEncoding,stencilBuffer:f.stencil})}else{let r=null,s=null,o=null;f.depth&&(o=f.stencil?35056:33190,r=f.stencil?Re:Le,s=f.stencil?Me:_e);const a={colorFormat:32856,depthFormat:o,scaleFactor:i};u=new XRWebGLBinding(n,t),h=u.createProjectionLayer(a),n.updateRenderState({layers:[h]}),g=new br(h.textureWidth,h.textureHeight,{format:Ee,type:fe,depthTexture:new ya(h.textureWidth,h.textureHeight,s,void 0,void 0,void 0,void 0,void 0,void 0,r),stencilBuffer:f.stencil,encoding:e.outputEncoding,samples:f.antialias?4:0});e.properties.get(g).__ignoreDepthValues=h.ignoreDepthValues}g.isXRRenderTarget=!0,this.setFoveation(a),l=null,s=await n.requestReferenceSpace(o),D.setContext(n),D.start(),r.isPresenting=!0,r.dispatchEvent({type:"sessionstart"})}};const R=new nr,P=new nr;function j(e,t){null===t?e.matrixWorld.copy(e.matrix):e.matrixWorld.multiplyMatrices(t.matrixWorld,e.matrix),e.matrixWorldInverse.copy(e.matrixWorld).invert()}this.updateCamera=function(e){if(null===n)return;M.near=w.near=b.near=e.near,M.far=w.far=b.far=e.far,T===M.near&&E===M.far||(n.updateRenderState({depthNear:M.near,depthFar:M.far}),T=M.near,E=M.far);const t=e.parent,r=M.cameras;j(M,t);for(let e=0;e<r.length;e++)j(r[e],t);M.matrixWorld.decompose(M.position,M.quaternion,M.scale),e.matrix.copy(M.matrix),e.matrix.decompose(e.position,e.quaternion,e.scale);const i=e.children;for(let e=0,t=i.length;e<t;e++)i[e].updateMatrixWorld(!0);2===r.length?function(e,t,r){R.setFromMatrixPosition(t.matrixWorld),P.setFromMatrixPosition(r.matrixWorld);const n=R.distanceTo(P),i=t.projectionMatrix.elements,s=r.projectionMatrix.elements,o=i[14]/(i[10]-1),a=i[14]/(i[10]+1),l=(i[9]+1)/i[5],c=(i[9]-1)/i[5],u=(i[8]-1)/i[0],h=(s[8]+1)/s[0],d=o*u,p=o*h,f=n/(-u+h),m=f*-u;t.matrixWorld.decompose(e.position,e.quaternion,e.scale),e.translateX(m),e.translateZ(f),e.matrixWorld.compose(e.position,e.quaternion,e.scale),e.matrixWorldInverse.copy(e.matrixWorld).invert();const g=o+f,y=a+f,v=d-m,_=p+(n-m),x=l*a/y*g,b=c*a/y*g;e.projectionMatrix.makePerspective(v,_,x,b,g,y)}(M,b,w):M.projectionMatrix.copy(b.projectionMatrix)},this.getCamera=function(){return M},this.getFoveation=function(){if(null!==h||null!==d)return a},this.setFoveation=function(e){a=e,null!==h&&(h.fixedFoveation=e),null!==d&&void 0!==d.fixedFoveation&&(d.fixedFoveation=e)},this.getPlanes=function(){return _};let I=null;const D=new Fi;D.setAnimationLoop((function(t,n){if(c=n.getViewerPose(l||s),p=n,null!==c){const t=c.views;null!==d&&(e.setRenderTargetFramebuffer(g,d.framebuffer),e.setRenderTarget(g));let r=!1;t.length!==M.cameras.length&&(M.cameras.length=0,r=!0);for(let n=0;n<t.length;n++){const i=t[n];let s=null;if(null!==d)s=d.getViewport(i);else{const t=u.getViewSubImage(h,i);s=t.viewport,0===n&&(e.setRenderTargetTextures(g,t.colorTexture,h.ignoreDepthValues?void 0:t.depthStencilTexture),e.setRenderTarget(g))}let o=S[n];void 0===o&&(o=new Ai,o.layers.enable(n),o.viewport=new xr,S[n]=o),o.matrix.fromArray(i.transform.matrix),o.projectionMatrix.fromArray(i.projectionMatrix),o.viewport.set(s.x,s.y,s.width,s.height),0===n&&M.matrix.copy(o.matrix),!0===r&&M.cameras.push(o)}}for(let e=0;e<y.length;e++){const t=v[e],r=y[e];null!==t&&void 0!==r&&r.update(t,n,l||s)}if(I&&I(t,n),n.detectedPlanes){r.dispatchEvent({type:"planesdetected",data:n.detectedPlanes});let e=null;for(const t of _)n.detectedPlanes.has(t)||(null===e&&(e=[]),e.push(t));if(null!==e)for(const t of e)_.delete(t),x.delete(t),r.dispatchEvent({type:"planeremoved",data:t});for(const e of n.detectedPlanes)if(_.has(e)){const t=x.get(e);e.lastChangedTime>t&&(x.set(e,e.lastChangedTime),r.dispatchEvent({type:"planechanged",data:e}))}else _.add(e),x.set(e,n.lastChangedTime),r.dispatchEvent({type:"planeadded",data:e})}p=null})),this.setAnimationLoop=function(e){I=e},this.dispose=function(){}}}function _a(e,t){function r(r,n){r.opacity.value=n.opacity,n.color&&r.diffuse.value.copy(n.color),n.emissive&&r.emissive.value.copy(n.emissive).multiplyScalar(n.emissiveIntensity),n.map&&(r.map.value=n.map),n.alphaMap&&(r.alphaMap.value=n.alphaMap),n.bumpMap&&(r.bumpMap.value=n.bumpMap,r.bumpScale.value=n.bumpScale,n.side===p&&(r.bumpScale.value*=-1)),n.displacementMap&&(r.displacementMap.value=n.displacementMap,r.displacementScale.value=n.displacementScale,r.displacementBias.value=n.displacementBias),n.emissiveMap&&(r.emissiveMap.value=n.emissiveMap),n.normalMap&&(r.normalMap.value=n.normalMap,r.normalScale.value.copy(n.normalScale),n.side===p&&r.normalScale.value.negate()),n.specularMap&&(r.specularMap.value=n.specularMap),n.alphaTest>0&&(r.alphaTest.value=n.alphaTest);const i=t.get(n).envMap;if(i&&(r.envMap.value=i,r.flipEnvMap.value=i.isCubeTexture&&!1===i.isRenderTargetTexture?-1:1,r.reflectivity.value=n.reflectivity,r.ior.value=n.ior,r.refractionRatio.value=n.refractionRatio),n.lightMap){r.lightMap.value=n.lightMap;const t=!0===e.useLegacyLights?Math.PI:1;r.lightMapIntensity.value=n.lightMapIntensity*t}let s,o;n.aoMap&&(r.aoMap.value=n.aoMap,r.aoMapIntensity.value=n.aoMapIntensity),n.map?s=n.map:n.specularMap?s=n.specularMap:n.displacementMap?s=n.displacementMap:n.normalMap?s=n.normalMap:n.bumpMap?s=n.bumpMap:n.roughnessMap?s=n.roughnessMap:n.metalnessMap?s=n.metalnessMap:n.alphaMap?s=n.alphaMap:n.emissiveMap?s=n.emissiveMap:n.clearcoatMap?s=n.clearcoatMap:n.clearcoatNormalMap?s=n.clearcoatNormalMap:n.clearcoatRoughnessMap?s=n.clearcoatRoughnessMap:n.iridescenceMap?s=n.iridescenceMap:n.iridescenceThicknessMap?s=n.iridescenceThicknessMap:n.specularIntensityMap?s=n.specularIntensityMap:n.specularColorMap?s=n.specularColorMap:n.transmissionMap?s=n.transmissionMap:n.thicknessMap?s=n.thicknessMap:n.sheenColorMap?s=n.sheenColorMap:n.sheenRoughnessMap&&(s=n.sheenRoughnessMap),void 0!==s&&(s.isWebGLRenderTarget&&(s=s.texture),!0===s.matrixAutoUpdate&&s.updateMatrix(),r.uvTransform.value.copy(s.matrix)),n.aoMap?o=n.aoMap:n.lightMap&&(o=n.lightMap),void 0!==o&&(o.isWebGLRenderTarget&&(o=o.texture),!0===o.matrixAutoUpdate&&o.updateMatrix(),r.uv2Transform.value.copy(o.matrix))}return{refreshFogUniforms:function(t,r){r.color.getRGB(t.fogColor.value,Si(e)),r.isFog?(t.fogNear.value=r.near,t.fogFar.value=r.far):r.isFogExp2&&(t.fogDensity.value=r.density)},refreshMaterialUniforms:function(e,n,i,s,o){n.isMeshBasicMaterial||n.isMeshLambertMaterial?r(e,n):n.isMeshToonMaterial?(r(e,n),function(e,t){t.gradientMap&&(e.gradientMap.value=t.gradientMap)}(e,n)):n.isMeshPhongMaterial?(r(e,n),function(e,t){e.specular.value.copy(t.specular),e.shininess.value=Math.max(t.shininess,1e-4)}(e,n)):n.isMeshStandardMaterial?(r(e,n),function(e,r){e.roughness.value=r.roughness,e.metalness.value=r.metalness,r.roughnessMap&&(e.roughnessMap.value=r.roughnessMap);r.metalnessMap&&(e.metalnessMap.value=r.metalnessMap);const n=t.get(r).envMap;n&&(e.envMapIntensity.value=r.envMapIntensity)}(e,n),n.isMeshPhysicalMaterial&&function(e,t,r){e.ior.value=t.ior,t.sheen>0&&(e.sheenColor.value.copy(t.sheenColor).multiplyScalar(t.sheen),e.sheenRoughness.value=t.sheenRoughness,t.sheenColorMap&&(e.sheenColorMap.value=t.sheenColorMap),t.sheenRoughnessMap&&(e.sheenRoughnessMap.value=t.sheenRoughnessMap));t.clearcoat>0&&(e.clearcoat.value=t.clearcoat,e.clearcoatRoughness.value=t.clearcoatRoughness,t.clearcoatMap&&(e.clearcoatMap.value=t.clearcoatMap),t.clearcoatRoughnessMap&&(e.clearcoatRoughnessMap.value=t.clearcoatRoughnessMap),t.clearcoatNormalMap&&(e.clearcoatNormalScale.value.copy(t.clearcoatNormalScale),e.clearcoatNormalMap.value=t.clearcoatNormalMap,t.side===p&&e.clearcoatNormalScale.value.negate()));t.iridescence>0&&(e.iridescence.value=t.iridescence,e.iridescenceIOR.value=t.iridescenceIOR,e.iridescenceThicknessMinimum.value=t.iridescenceThicknessRange[0],e.iridescenceThicknessMaximum.value=t.iridescenceThicknessRange[1],t.iridescenceMap&&(e.iridescenceMap.value=t.iridescenceMap),t.iridescenceThicknessMap&&(e.iridescenceThicknessMap.value=t.iridescenceThicknessMap));t.transmission>0&&(e.transmission.value=t.transmission,e.transmissionSamplerMap.value=r.texture,e.transmissionSamplerSize.value.set(r.width,r.height),t.transmissionMap&&(e.transmissionMap.value=t.transmissionMap),e.thickness.value=t.thickness,t.thicknessMap&&(e.thicknessMap.value=t.thicknessMap),e.attenuationDistance.value=t.attenuationDistance,e.attenuationColor.value.copy(t.attenuationColor));e.specularIntensity.value=t.specularIntensity,e.specularColor.value.copy(t.specularColor),t.specularIntensityMap&&(e.specularIntensityMap.value=t.specularIntensityMap);t.specularColorMap&&(e.specularColorMap.value=t.specularColorMap)}(e,n,o)):n.isMeshMatcapMaterial?(r(e,n),function(e,t){t.matcap&&(e.matcap.value=t.matcap)}(e,n)):n.isMeshDepthMaterial?r(e,n):n.isMeshDistanceMaterial?(r(e,n),function(e,t){e.referencePosition.value.copy(t.referencePosition),e.nearDistance.value=t.nearDistance,e.farDistance.value=t.farDistance}(e,n)):n.isMeshNormalMaterial?r(e,n):n.isLineBasicMaterial?(function(e,t){e.diffuse.value.copy(t.color),e.opacity.value=t.opacity}(e,n),n.isLineDashedMaterial&&function(e,t){e.dashSize.value=t.dashSize,e.totalSize.value=t.dashSize+t.gapSize,e.scale.value=t.scale}(e,n)):n.isPointsMaterial?function(e,t,r,n){e.diffuse.value.copy(t.color),e.opacity.value=t.opacity,e.size.value=t.size*r,e.scale.value=.5*n,t.map&&(e.map.value=t.map);t.alphaMap&&(e.alphaMap.value=t.alphaMap);t.alphaTest>0&&(e.alphaTest.value=t.alphaTest);let i;t.map?i=t.map:t.alphaMap&&(i=t.alphaMap);void 0!==i&&(!0===i.matrixAutoUpdate&&i.updateMatrix(),e.uvTransform.value.copy(i.matrix))}(e,n,i,s):n.isSpriteMaterial?function(e,t){e.diffuse.value.copy(t.color),e.opacity.value=t.opacity,e.rotation.value=t.rotation,t.map&&(e.map.value=t.map);t.alphaMap&&(e.alphaMap.value=t.alphaMap);t.alphaTest>0&&(e.alphaTest.value=t.alphaTest);let r;t.map?r=t.map:t.alphaMap&&(r=t.alphaMap);void 0!==r&&(!0===r.matrixAutoUpdate&&r.updateMatrix(),e.uvTransform.value.copy(r.matrix))}(e,n):n.isShadowMaterial?(e.color.value.copy(n.color),e.opacity.value=n.opacity):n.isShaderMaterial&&(n.uniformsNeedUpdate=!1)}}}function xa(e,t,r,n){let i={},s={},o=[];const a=r.isWebGL2?e.getParameter(35375):0;function l(e,t,r){const n=e.value;if(void 0===r[t]){if("number"==typeof n)r[t]=n;else{const e=Array.isArray(n)?n:[n],i=[];for(let t=0;t<e.length;t++)i.push(e[t].clone());r[t]=i}return!0}if("number"==typeof n){if(r[t]!==n)return r[t]=n,!0}else{const e=Array.isArray(r[t])?r[t]:[r[t]],i=Array.isArray(n)?n:[n];for(let t=0;t<e.length;t++){const r=e[t];if(!1===r.equals(i[t]))return r.copy(i[t]),!0}}return!1}function c(e){const t={boundary:0,storage:0};return"number"==typeof e?(t.boundary=4,t.storage=4):e.isVector2?(t.boundary=8,t.storage=8):e.isVector3||e.isColor?(t.boundary=16,t.storage=12):e.isVector4?(t.boundary=16,t.storage=16):e.isMatrix3?(t.boundary=48,t.storage=48):e.isMatrix4?(t.boundary=64,t.storage=64):e.isTexture,t}function u(t){const r=t.target;r.removeEventListener("dispose",u);const n=o.indexOf(r.__bindingPointIndex);o.splice(n,1),e.deleteBuffer(i[r.id]),delete i[r.id],delete s[r.id]}return{bind:function(e,t){const r=t.program;n.uniformBlockBinding(e,r)},update:function(r,h){let d=i[r.id];void 0===d&&(!function(e){const t=e.uniforms;let r=0;const n=16;let i=0;for(let e=0,s=t.length;e<s;e++){const s=t[e],o={boundary:0,storage:0},a=Array.isArray(s.value)?s.value:[s.value];for(let e=0,t=a.length;e<t;e++){const t=c(a[e]);o.boundary+=t.boundary,o.storage+=t.storage}if(s.__data=new Float32Array(o.storage/Float32Array.BYTES_PER_ELEMENT),s.__offset=r,e>0){i=r%n;0!==i&&n-i-o.boundary<0&&(r+=n-i,s.__offset=r)}r+=o.storage}i=r%n,i>0&&(r+=n-i);e.__size=r,e.__cache={}}(r),d=function(t){const r=function(){for(let e=0;e<a;e++)if(-1===o.indexOf(e))return o.push(e),e;return 0}();t.__bindingPointIndex=r;const n=e.createBuffer(),i=t.__size,s=t.usage;return e.bindBuffer(35345,n),e.bufferData(35345,i,s),e.bindBuffer(35345,null),e.bindBufferBase(35345,r,n),n}(r),i[r.id]=d,r.addEventListener("dispose",u));const p=h.program;n.updateUBOMapping(r,p);const f=t.render.frame;s[r.id]!==f&&(!function(t){const r=i[t.id],n=t.uniforms,s=t.__cache;e.bindBuffer(35345,r);for(let t=0,r=n.length;t<r;t++){const r=n[t];if(!0===l(r,t,s)){const t=r.__offset,n=Array.isArray(r.value)?r.value:[r.value];let i=0;for(let s=0;s<n.length;s++){const o=n[s],a=c(o);"number"==typeof o?(r.__data[0]=o,e.bufferSubData(35345,t+i,r.__data)):o.isMatrix3?(r.__data[0]=o.elements[0],r.__data[1]=o.elements[1],r.__data[2]=o.elements[2],r.__data[3]=o.elements[0],r.__data[4]=o.elements[3],r.__data[5]=o.elements[4],r.__data[6]=o.elements[5],r.__data[7]=o.elements[0],r.__data[8]=o.elements[6],r.__data[9]=o.elements[7],r.__data[10]=o.elements[8],r.__data[11]=o.elements[0]):(o.toArray(r.__data,i),i+=a.storage/Float32Array.BYTES_PER_ELEMENT)}e.bufferSubData(35345,t,r.__data)}}e.bindBuffer(35345,null)}(r),s[r.id]=f)},dispose:function(){for(const t in i)e.deleteBuffer(i[t]);o=[],i={},s={}}}}function ba(e={}){this.isWebGLRenderer=!0;const t=void 0!==e.canvas?e.canvas:function(){const e=tr("canvas");return e.style.display="block",e}(),r=void 0!==e.context?e.context:null,i=void 0===e.depth||e.depth,s=void 0===e.stencil||e.stencil,o=void 0!==e.antialias&&e.antialias,a=void 0===e.premultipliedAlpha||e.premultipliedAlpha,l=void 0!==e.preserveDrawingBuffer&&e.preserveDrawingBuffer,c=void 0!==e.powerPreference?e.powerPreference:"default",u=void 0!==e.failIfMajorPerformanceCaveat&&e.failIfMajorPerformanceCaveat;let h;h=null!==r?r.getContextAttributes().alpha:void 0!==e.alpha&&e.alpha;let m=null,g=null;const y=[],v=[];this.domElement=t,this.debug={checkShaderErrors:!0},this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.sortObjects=!0,this.clippingPlanes=[],this.localClippingEnabled=!1,this.outputEncoding=Mt,this.useLegacyLights=!0,this.toneMapping=Y,this.toneMappingExposure=1;const _=this;let x=!1,b=0,w=0,S=null,M=-1,T=null;const E=new xr,A=new xr;let C=null,L=t.width,R=t.height,P=1,j=null,I=null;const D=new xr(0,0,L,R),O=new xr(0,0,L,R);let N=!1;const U=new ki;let k=!1,F=!1,B=null;const z=new Kr,G=new nr,V={background:null,fog:null,environment:null,overrideMaterial:null,isScene:!0};function H(){return null===S?P:1}let W,X,q,Z,J,K,Q,$,ee,te,re,ne,ie,se,oe,ae,le,ce,ue,he,de,me,ge,ye,ve=r;function _e(e,r){for(let n=0;n<e.length;n++){const i=e[n],s=t.getContext(i,r);if(null!==s)return s}return null}try{const e={alpha:!0,depth:i,stencil:s,antialias:o,premultipliedAlpha:a,preserveDrawingBuffer:l,powerPreference:c,failIfMajorPerformanceCaveat:u};if("setAttribute"in t&&t.setAttribute("data-engine",`three.js r${n}`),t.addEventListener("webglcontextlost",Me,!1),t.addEventListener("webglcontextrestored",Te,!1),t.addEventListener("webglcontextcreationerror",Ae,!1),null===ve){const t=["webgl2","webgl","experimental-webgl"];if(!0===_.isWebGL1Renderer&&t.shift(),ve=_e(t,e),null===ve)throw _e(t)?new Error("Error creating WebGL context with your selected attributes."):new Error("Error creating WebGL context.")}void 0===ve.getShaderPrecisionFormat&&(ve.getShaderPrecisionFormat=function(){return{rangeMin:1,rangeMax:1,precision:1}})}catch(e){throw e}function we(){W=new ms(ve),X=new Zi(ve,W,e),W.init(X),me=new da(ve,W,X),q=new ua(ve,W,X),Z=new vs,J=new Yo,K=new ha(ve,W,q,J,X,me,Z),Q=new Ki(_),$=new fs(_),ee=new Bi(ve,X),ge=new qi(ve,W,ee,X),te=new gs(ve,ee,Z,ge),re=new ws(ve,te,ee,Z),ue=new bs(ve,X,K),ae=new Ji(J),ne=new qo(_,Q,$,W,X,ge,ae),ie=new _a(_,J),se=new Qo,oe=new ia(W,X),ce=new Xi(_,Q,$,q,re,h,a),le=new ca(_,re,X),ye=new xa(ve,Z,X,q),he=new Yi(ve,W,Z,X),de=new ys(ve,W,Z,X),Z.programs=ne.programs,_.capabilities=X,_.extensions=W,_.properties=J,_.renderLists=se,_.shadowMap=le,_.state=q,_.info=Z}we();const Se=new va(_,ve);function Me(e){e.preventDefault(),x=!0}function Te(){x=!1;const e=Z.autoReset,t=le.enabled,r=le.autoUpdate,n=le.needsUpdate,i=le.type;we(),Z.autoReset=e,le.enabled=t,le.autoUpdate=r,le.needsUpdate=n,le.type=i}function Ae(e){}function Ce(e){const t=e.target;t.removeEventListener("dispose",Ce),function(e){(function(e){const t=J.get(e).programs;void 0!==t&&(t.forEach((function(e){ne.releaseProgram(e)})),e.isShaderMaterial&&ne.releaseShaderCache(e))})(e),J.remove(e)}(t)}this.xr=Se,this.getContext=function(){return ve},this.getContextAttributes=function(){return ve.getContextAttributes()},this.forceContextLoss=function(){const e=W.get("WEBGL_lose_context");e&&e.loseContext()},this.forceContextRestore=function(){const e=W.get("WEBGL_lose_context");e&&e.restoreContext()},this.getPixelRatio=function(){return P},this.setPixelRatio=function(e){void 0!==e&&(P=e,this.setSize(L,R,!1))},this.getSize=function(e){return e.set(L,R)},this.setSize=function(e,r,n=!0){Se.isPresenting||(L=e,R=r,t.width=Math.floor(e*P),t.height=Math.floor(r*P),!0===n&&(t.style.width=e+"px",t.style.height=r+"px"),this.setViewport(0,0,e,r))},this.getDrawingBufferSize=function(e){return e.set(L*P,R*P).floor()},this.setDrawingBufferSize=function(e,r,n){L=e,R=r,P=n,t.width=Math.floor(e*n),t.height=Math.floor(r*n),this.setViewport(0,0,e,r)},this.getCurrentViewport=function(e){return e.copy(E)},this.getViewport=function(e){return e.copy(D)},this.setViewport=function(e,t,r,n){e.isVector4?D.set(e.x,e.y,e.z,e.w):D.set(e,t,r,n),q.viewport(E.copy(D).multiplyScalar(P).floor())},this.getScissor=function(e){return e.copy(O)},this.setScissor=function(e,t,r,n){e.isVector4?O.set(e.x,e.y,e.z,e.w):O.set(e,t,r,n),q.scissor(A.copy(O).multiplyScalar(P).floor())},this.getScissorTest=function(){return N},this.setScissorTest=function(e){q.setScissorTest(N=e)},this.setOpaqueSort=function(e){j=e},this.setTransparentSort=function(e){I=e},this.getClearColor=function(e){return e.copy(ce.getClearColor())},this.setClearColor=function(){ce.setClearColor.apply(ce,arguments)},this.getClearAlpha=function(){return ce.getClearAlpha()},this.setClearAlpha=function(){ce.setClearAlpha.apply(ce,arguments)},this.clear=function(e=!0,t=!0,r=!0){let n=0;e&&(n|=16384),t&&(n|=256),r&&(n|=1024),ve.clear(n)},this.clearColor=function(){this.clear(!0,!1,!1)},this.clearDepth=function(){this.clear(!1,!0,!1)},this.clearStencil=function(){this.clear(!1,!1,!0)},this.dispose=function(){t.removeEventListener("webglcontextlost",Me,!1),t.removeEventListener("webglcontextrestored",Te,!1),t.removeEventListener("webglcontextcreationerror",Ae,!1),se.dispose(),oe.dispose(),J.dispose(),Q.dispose(),$.dispose(),re.dispose(),ge.dispose(),ye.dispose(),ne.dispose(),Se.dispose(),Se.removeEventListener("sessionstart",Re),Se.removeEventListener("sessionend",Pe),B&&(B.dispose(),B=null),je.stop()},this.renderBufferDirect=function(e,t,r,n,i,s){null===t&&(t=V);const o=i.isMesh&&i.matrixWorld.determinant()<0,a=function(e,t,r,n,i){!0!==t.isScene&&(t=V);K.resetTextureUnits();const s=t.fog,o=n.isMeshStandardMaterial?t.environment:null,a=null===S?_.outputEncoding:!0===S.isXRRenderTarget?S.texture.encoding:Mt,l=(n.isMeshStandardMaterial?$:Q).get(n.envMap||o),c=!0===n.vertexColors&&!!r.attributes.color&&4===r.attributes.color.itemSize,u=!!n.normalMap&&!!r.attributes.tangent,h=!!r.morphAttributes.position,d=!!r.morphAttributes.normal,p=!!r.morphAttributes.color,f=n.toneMapped?_.toneMapping:Y,m=r.morphAttributes.position||r.morphAttributes.normal||r.morphAttributes.color,y=void 0!==m?m.length:0,v=J.get(n),x=g.state.lights;if(!0===k&&(!0===F||e!==T)){const t=e===T&&n.id===M;ae.setState(n,e,t)}let b=!1;n.version===v.__version?v.needsLights&&v.lightsStateVersion!==x.state.version||v.outputEncoding!==a||i.isInstancedMesh&&!1===v.instancing?b=!0:i.isInstancedMesh||!0!==v.instancing?i.isSkinnedMesh&&!1===v.skinning?b=!0:i.isSkinnedMesh||!0!==v.skinning?v.envMap!==l||!0===n.fog&&v.fog!==s?b=!0:void 0===v.numClippingPlanes||v.numClippingPlanes===ae.numPlanes&&v.numIntersection===ae.numIntersection?(v.vertexAlphas!==c||v.vertexTangents!==u||v.morphTargets!==h||v.morphNormals!==d||v.morphColors!==p||v.toneMapping!==f||!0===X.isWebGL2&&v.morphTargetsCount!==y)&&(b=!0):b=!0:b=!0:b=!0:(b=!0,v.__version=n.version);let w=v.currentProgram;!0===b&&(w=Ue(n,t,i));let E=!1,A=!1,C=!1;const L=w.getUniforms(),j=v.uniforms;q.useProgram(w.program)&&(E=!0,A=!0,C=!0);n.id!==M&&(M=n.id,A=!0);if(E||T!==e){if(L.setValue(ve,"projectionMatrix",e.projectionMatrix),X.logarithmicDepthBuffer&&L.setValue(ve,"logDepthBufFC",2/(Math.log(e.far+1)/Math.LN2)),T!==e&&(T=e,A=!0,C=!0),n.isShaderMaterial||n.isMeshPhongMaterial||n.isMeshToonMaterial||n.isMeshStandardMaterial||n.envMap){const t=L.map.cameraPosition;void 0!==t&&t.setValue(ve,G.setFromMatrixPosition(e.matrixWorld))}(n.isMeshPhongMaterial||n.isMeshToonMaterial||n.isMeshLambertMaterial||n.isMeshBasicMaterial||n.isMeshStandardMaterial||n.isShaderMaterial)&&L.setValue(ve,"isOrthographic",!0===e.isOrthographicCamera),(n.isMeshPhongMaterial||n.isMeshToonMaterial||n.isMeshLambertMaterial||n.isMeshBasicMaterial||n.isMeshStandardMaterial||n.isShaderMaterial||n.isShadowMaterial||i.isSkinnedMesh)&&L.setValue(ve,"viewMatrix",e.matrixWorldInverse)}if(i.isSkinnedMesh){L.setOptional(ve,i,"bindMatrix"),L.setOptional(ve,i,"bindMatrixInverse");const e=i.skeleton;e&&X.floatVertexTextures&&(null===e.boneTexture&&e.computeBoneTexture(),L.setValue(ve,"boneTexture",e.boneTexture,K),L.setValue(ve,"boneTextureSize",e.boneTextureSize))}const I=r.morphAttributes;(void 0!==I.position||void 0!==I.normal||void 0!==I.color&&!0===X.isWebGL2)&&ue.update(i,r,w);(A||v.receiveShadow!==i.receiveShadow)&&(v.receiveShadow=i.receiveShadow,L.setValue(ve,"receiveShadow",i.receiveShadow));n.isMeshGouraudMaterial&&null!==n.envMap&&(j.envMap.value=l,j.flipEnvMap.value=l.isCubeTexture&&!1===l.isRenderTargetTexture?-1:1);A&&(L.setValue(ve,"toneMappingExposure",_.toneMappingExposure),v.needsLights&&(O=C,(D=j).ambientLightColor.needsUpdate=O,D.lightProbe.needsUpdate=O,D.directionalLights.needsUpdate=O,D.directionalLightShadows.needsUpdate=O,D.pointLights.needsUpdate=O,D.pointLightShadows.needsUpdate=O,D.spotLights.needsUpdate=O,D.spotLightShadows.needsUpdate=O,D.rectAreaLights.needsUpdate=O,D.hemisphereLights.needsUpdate=O),s&&!0===n.fog&&ie.refreshFogUniforms(j,s),ie.refreshMaterialUniforms(j,n,P,R,B),Ao.upload(ve,v.uniformsList,j,K));var D,O;n.isShaderMaterial&&!0===n.uniformsNeedUpdate&&(Ao.upload(ve,v.uniformsList,j,K),n.uniformsNeedUpdate=!1);n.isSpriteMaterial&&L.setValue(ve,"center",i.center);if(L.setValue(ve,"modelViewMatrix",i.modelViewMatrix),L.setValue(ve,"normalMatrix",i.normalMatrix),L.setValue(ve,"modelMatrix",i.matrixWorld),n.isShaderMaterial||n.isRawShaderMaterial){const e=n.uniformsGroups;for(let t=0,r=e.length;t<r;t++)if(X.isWebGL2){const r=e[t];ye.update(r,w),ye.bind(r,w)}}return w}(e,t,r,n,i);q.setMaterial(n,o);let l=r.index,c=1;!0===n.wireframe&&(l=te.getWireframeAttribute(r),c=2);const u=r.drawRange,h=r.attributes.position;let d=u.start*c,p=(u.start+u.count)*c;null!==s&&(d=Math.max(d,s.start*c),p=Math.min(p,(s.start+s.count)*c)),null!==l?(d=Math.max(d,0),p=Math.min(p,l.count)):null!=h&&(d=Math.max(d,0),p=Math.min(p,h.count));const f=p-d;if(f<0||f===1/0)return;let m;ge.setup(i,n,a,r,l);let y=he;if(null!==l&&(m=ee.get(l),y=de,y.setIndex(m)),i.isMesh)!0===n.wireframe?(q.setLineWidth(n.wireframeLinewidth*H()),y.setMode(1)):y.setMode(4);else if(i.isLine){let e=n.linewidth;void 0===e&&(e=1),q.setLineWidth(e*H()),i.isLineSegments?y.setMode(1):i.isLineLoop?y.setMode(2):y.setMode(3)}else i.isPoints?y.setMode(0):i.isSprite&&y.setMode(4);if(i.isInstancedMesh)y.renderInstances(d,f,i.count);else if(r.isInstancedBufferGeometry){const e=void 0!==r._maxInstanceCount?r._maxInstanceCount:1/0,t=Math.min(r.instanceCount,e);y.renderInstances(d,f,t)}else y.render(d,f)},this.compile=function(e,t){function r(e,t,r){!0===e.transparent&&e.side===f&&!1===e.forceSinglePass?(e.side=p,e.needsUpdate=!0,Ue(e,t,r),e.side=d,e.needsUpdate=!0,Ue(e,t,r),e.side=f):Ue(e,t,r)}g=oe.get(e),g.init(),v.push(g),e.traverseVisible((function(e){e.isLight&&e.layers.test(t.layers)&&(g.pushLight(e),e.castShadow&&g.pushShadow(e))})),g.setupLights(_.useLegacyLights),e.traverse((function(t){const n=t.material;if(n)if(Array.isArray(n))for(let i=0;i<n.length;i++){r(n[i],e,t)}else r(n,e,t)})),v.pop(),g=null};let Le=null;function Re(){je.stop()}function Pe(){je.start()}const je=new Fi;function Ie(e,t,r,n){if(!1===e.visible)return;if(e.layers.test(t.layers))if(e.isGroup)r=e.renderOrder;else if(e.isLOD)!0===e.autoUpdate&&e.update(t);else if(e.isLight)g.pushLight(e),e.castShadow&&g.pushShadow(e);else if(e.isSprite){if(!e.frustumCulled||U.intersectsSprite(e)){n&&G.setFromMatrixPosition(e.matrixWorld).applyMatrix4(z);const t=re.update(e),i=e.material;i.visible&&m.push(e,t,i,r,G.z,null)}}else if((e.isMesh||e.isLine||e.isPoints)&&(e.isSkinnedMesh&&e.skeleton.frame!==Z.render.frame&&(e.skeleton.update(),e.skeleton.frame=Z.render.frame),!e.frustumCulled||U.intersectsObject(e))){n&&G.setFromMatrixPosition(e.matrixWorld).applyMatrix4(z);const t=re.update(e),i=e.material;if(Array.isArray(i)){const n=t.groups;for(let s=0,o=n.length;s<o;s++){const o=n[s],a=i[o.materialIndex];a&&a.visible&&m.push(e,t,a,r,G.z,o)}}else i.visible&&m.push(e,t,i,r,G.z,null)}const i=e.children;for(let e=0,s=i.length;e<s;e++)Ie(i[e],t,r,n)}function De(e,t,r,n){const i=e.opaque,s=e.transmissive,a=e.transparent;g.setupLightsView(r),!0===k&&ae.setGlobalState(_.clippingPlanes,r),s.length>0&&function(e,t,r){const n=X.isWebGL2;null===B&&(B=new br(1024,1024,{generateMipmaps:!0,type:W.has("EXT_color_buffer_half_float")?be:fe,minFilter:pe,samples:n&&!0===o?4:0}));const i=_.getRenderTarget();_.setRenderTarget(B),_.clear();const s=_.toneMapping;_.toneMapping=Y,Oe(e,t,r),_.toneMapping=s,K.updateMultisampleRenderTarget(B),K.updateRenderTargetMipmap(B),_.setRenderTarget(i)}(i,t,r),n&&q.viewport(E.copy(n)),i.length>0&&Oe(i,t,r),s.length>0&&Oe(s,t,r),a.length>0&&Oe(a,t,r),q.buffers.depth.setTest(!0),q.buffers.depth.setMask(!0),q.buffers.color.setMask(!0),q.setPolygonOffset(!1)}function Oe(e,t,r){const n=!0===t.isScene?t.overrideMaterial:null;for(let i=0,s=e.length;i<s;i++){const s=e[i],o=s.object,a=s.geometry,l=null===n?s.material:n,c=s.group;o.layers.test(r.layers)&&Ne(o,t,r,a,l,c)}}function Ne(e,t,r,n,i,s){e.onBeforeRender(_,t,r,n,i,s),e.modelViewMatrix.multiplyMatrices(r.matrixWorldInverse,e.matrixWorld),e.normalMatrix.getNormalMatrix(e.modelViewMatrix),i.onBeforeRender(_,t,r,n,e,s),!0===i.transparent&&i.side===f&&!1===i.forceSinglePass?(i.side=p,i.needsUpdate=!0,_.renderBufferDirect(r,t,n,i,e,s),i.side=d,i.needsUpdate=!0,_.renderBufferDirect(r,t,n,i,e,s),i.side=f):_.renderBufferDirect(r,t,n,i,e,s),e.onAfterRender(_,t,r,n,i,s)}function Ue(e,t,r){!0!==t.isScene&&(t=V);const n=J.get(e),i=g.state.lights,s=g.state.shadowsArray,o=i.state.version,a=ne.getParameters(e,i.state,s,t,r),l=ne.getProgramCacheKey(a);let c=n.programs;n.environment=e.isMeshStandardMaterial?t.environment:null,n.fog=t.fog,n.envMap=(e.isMeshStandardMaterial?$:Q).get(e.envMap||n.environment),void 0===c&&(e.addEventListener("dispose",Ce),c=new Map,n.programs=c);let u=c.get(l);if(void 0!==u){if(n.currentProgram===u&&n.lightsStateVersion===o)return ke(e,a),u}else a.uniforms=ne.getUniforms(e),e.onBuild(r,a,_),e.onBeforeCompile(a,_),u=ne.acquireProgram(a,l),c.set(l,u),n.uniforms=a.uniforms;const h=n.uniforms;(e.isShaderMaterial||e.isRawShaderMaterial)&&!0!==e.clipping||(h.clippingPlanes=ae.uniform),ke(e,a),n.needsLights=function(e){return e.isMeshLambertMaterial||e.isMeshToonMaterial||e.isMeshPhongMaterial||e.isMeshStandardMaterial||e.isShadowMaterial||e.isShaderMaterial&&!0===e.lights}(e),n.lightsStateVersion=o,n.needsLights&&(h.ambientLightColor.value=i.state.ambient,h.lightProbe.value=i.state.probe,h.directionalLights.value=i.state.directional,h.directionalLightShadows.value=i.state.directionalShadow,h.spotLights.value=i.state.spot,h.spotLightShadows.value=i.state.spotShadow,h.rectAreaLights.value=i.state.rectArea,h.ltc_1.value=i.state.rectAreaLTC1,h.ltc_2.value=i.state.rectAreaLTC2,h.pointLights.value=i.state.point,h.pointLightShadows.value=i.state.pointShadow,h.hemisphereLights.value=i.state.hemi,h.directionalShadowMap.value=i.state.directionalShadowMap,h.directionalShadowMatrix.value=i.state.directionalShadowMatrix,h.spotShadowMap.value=i.state.spotShadowMap,h.spotLightMatrix.value=i.state.spotLightMatrix,h.spotLightMap.value=i.state.spotLightMap,h.pointShadowMap.value=i.state.pointShadowMap,h.pointShadowMatrix.value=i.state.pointShadowMatrix);const d=u.getUniforms(),p=Ao.seqWithValue(d.seq,h);return n.currentProgram=u,n.uniformsList=p,u}function ke(e,t){const r=J.get(e);r.outputEncoding=t.outputEncoding,r.instancing=t.instancing,r.skinning=t.skinning,r.morphTargets=t.morphTargets,r.morphNormals=t.morphNormals,r.morphColors=t.morphColors,r.morphTargetsCount=t.morphTargetsCount,r.numClippingPlanes=t.numClippingPlanes,r.numIntersection=t.numClipIntersection,r.vertexAlphas=t.vertexAlphas,r.vertexTangents=t.vertexTangents,r.toneMapping=t.toneMapping}je.setAnimationLoop((function(e){Le&&Le(e)})),"undefined"!=typeof self&&je.setContext(self),this.setAnimationLoop=function(e){Le=e,Se.setAnimationLoop(e),null===e?je.stop():je.start()},Se.addEventListener("sessionstart",Re),Se.addEventListener("sessionend",Pe),this.render=function(e,t){if(void 0!==t&&!0!==t.isCamera)return;if(!0===x)return;!0===e.matrixWorldAutoUpdate&&e.updateMatrixWorld(),null===t.parent&&!0===t.matrixWorldAutoUpdate&&t.updateMatrixWorld(),!0===Se.enabled&&!0===Se.isPresenting&&(!0===Se.cameraAutoUpdate&&Se.updateCamera(t),t=Se.getCamera()),!0===e.isScene&&e.onBeforeRender(_,e,t,S),g=oe.get(e,v.length),g.init(),v.push(g),z.multiplyMatrices(t.projectionMatrix,t.matrixWorldInverse),U.setFromProjectionMatrix(z),F=this.localClippingEnabled,k=ae.init(this.clippingPlanes,F),m=se.get(e,y.length),m.init(),y.push(m),Ie(e,t,0,_.sortObjects),m.finish(),!0===_.sortObjects&&m.sort(j,I),!0===k&&ae.beginShadows();const r=g.state.shadowsArray;if(le.render(r,e,t),!0===k&&ae.endShadows(),!0===this.info.autoReset&&this.info.reset(),ce.render(m,e),g.setupLights(_.useLegacyLights),t.isArrayCamera){const r=t.cameras;for(let t=0,n=r.length;t<n;t++){const n=r[t];De(m,e,n,n.viewport)}}else De(m,e,t);null!==S&&(K.updateMultisampleRenderTarget(S),K.updateRenderTargetMipmap(S)),!0===e.isScene&&e.onAfterRender(_,e,t),ge.resetDefaultState(),M=-1,T=null,v.pop(),g=v.length>0?v[v.length-1]:null,y.pop(),m=y.length>0?y[y.length-1]:null},this.getActiveCubeFace=function(){return b},this.getActiveMipmapLevel=function(){return w},this.getRenderTarget=function(){return S},this.setRenderTargetTextures=function(e,t,r){J.get(e.texture).__webglTexture=t,J.get(e.depthTexture).__webglTexture=r;const n=J.get(e);n.__hasExternalTextures=!0,n.__hasExternalTextures&&(n.__autoAllocateDepthBuffer=void 0===r,n.__autoAllocateDepthBuffer||!0===W.has("WEBGL_multisampled_render_to_texture")&&(n.__useRenderToTexture=!1))},this.setRenderTargetFramebuffer=function(e,t){const r=J.get(e);r.__webglFramebuffer=t,r.__useDefaultFramebuffer=void 0===t},this.setRenderTarget=function(e,t=0,r=0){S=e,b=t,w=r;let n=!0,i=null,s=!1,o=!1;if(e){const r=J.get(e);void 0!==r.__useDefaultFramebuffer?(q.bindFramebuffer(36160,null),n=!1):void 0===r.__webglFramebuffer?K.setupRenderTarget(e):r.__hasExternalTextures&&K.rebindTextures(e,J.get(e.texture).__webglTexture,J.get(e.depthTexture).__webglTexture);const a=e.texture;(a.isData3DTexture||a.isDataArrayTexture||a.isCompressedArrayTexture)&&(o=!0);const l=J.get(e).__webglFramebuffer;e.isWebGLCubeRenderTarget?(i=l[t],s=!0):i=X.isWebGL2&&e.samples>0&&!1===K.useMultisampledRTT(e)?J.get(e).__webglMultisampledFramebuffer:l,E.copy(e.viewport),A.copy(e.scissor),C=e.scissorTest}else E.copy(D).multiplyScalar(P).floor(),A.copy(O).multiplyScalar(P).floor(),C=N;if(q.bindFramebuffer(36160,i)&&X.drawBuffers&&n&&q.drawBuffers(e,i),q.viewport(E),q.scissor(A),q.setScissorTest(C),s){const n=J.get(e.texture);ve.framebufferTexture2D(36160,36064,34069+t,n.__webglTexture,r)}else if(o){const n=J.get(e.texture),i=t||0;ve.framebufferTextureLayer(36160,36064,n.__webglTexture,r||0,i)}M=-1},this.readRenderTargetPixels=function(e,t,r,n,i,s,o){if(!e||!e.isWebGLRenderTarget)return;let a=J.get(e).__webglFramebuffer;if(e.isWebGLCubeRenderTarget&&void 0!==o&&(a=a[o]),a){q.bindFramebuffer(36160,a);try{const o=e.texture,a=o.format,l=o.type;if(a!==Ee&&me.convert(a)!==ve.getParameter(35739))return;const c=l===be&&(W.has("EXT_color_buffer_half_float")||X.isWebGL2&&W.has("EXT_color_buffer_float"));if(!(l===fe||me.convert(l)===ve.getParameter(35738)||l===xe&&(X.isWebGL2||W.has("OES_texture_float")||W.has("WEBGL_color_buffer_float"))||c))return;t>=0&&t<=e.width-n&&r>=0&&r<=e.height-i&&ve.readPixels(t,r,n,i,me.convert(a),me.convert(l),s)}finally{const e=null!==S?J.get(S).__webglFramebuffer:null;q.bindFramebuffer(36160,e)}}},this.copyFramebufferToTexture=function(e,t,r=0){const n=Math.pow(2,-r),i=Math.floor(t.image.width*n),s=Math.floor(t.image.height*n);K.setTexture2D(t,0),ve.copyTexSubImage2D(3553,r,0,0,e.x,e.y,i,s),q.unbindTexture()},this.copyTextureToTexture=function(e,t,r,n=0){const i=t.image.width,s=t.image.height,o=me.convert(r.format),a=me.convert(r.type);K.setTexture2D(r,0),ve.pixelStorei(37440,r.flipY),ve.pixelStorei(37441,r.premultiplyAlpha),ve.pixelStorei(3317,r.unpackAlignment),t.isDataTexture?ve.texSubImage2D(3553,n,e.x,e.y,i,s,o,a,t.image.data):t.isCompressedTexture?ve.compressedTexSubImage2D(3553,n,e.x,e.y,t.mipmaps[0].width,t.mipmaps[0].height,o,t.mipmaps[0].data):ve.texSubImage2D(3553,n,e.x,e.y,o,a,t.image),0===n&&r.generateMipmaps&&ve.generateMipmap(3553),q.unbindTexture()},this.copyTextureToTexture3D=function(e,t,r,n,i=0){if(_.isWebGL1Renderer)return;const s=e.max.x-e.min.x+1,o=e.max.y-e.min.y+1,a=e.max.z-e.min.z+1,l=me.convert(n.format),c=me.convert(n.type);let u;if(n.isData3DTexture)K.setTexture3D(n,0),u=32879;else{if(!n.isDataArrayTexture)return;K.setTexture2DArray(n,0),u=35866}ve.pixelStorei(37440,n.flipY),ve.pixelStorei(37441,n.premultiplyAlpha),ve.pixelStorei(3317,n.unpackAlignment);const h=ve.getParameter(3314),d=ve.getParameter(32878),p=ve.getParameter(3316),f=ve.getParameter(3315),m=ve.getParameter(32877),g=r.isCompressedTexture?r.mipmaps[0]:r.image;ve.pixelStorei(3314,g.width),ve.pixelStorei(32878,g.height),ve.pixelStorei(3316,e.min.x),ve.pixelStorei(3315,e.min.y),ve.pixelStorei(32877,e.min.z),r.isDataTexture||r.isData3DTexture?ve.texSubImage3D(u,i,t.x,t.y,t.z,s,o,a,l,c,g.data):r.isCompressedArrayTexture?ve.compressedTexSubImage3D(u,i,t.x,t.y,t.z,s,o,a,l,g.data):ve.texSubImage3D(u,i,t.x,t.y,t.z,s,o,a,l,c,g),ve.pixelStorei(3314,h),ve.pixelStorei(32878,d),ve.pixelStorei(3316,p),ve.pixelStorei(3315,f),ve.pixelStorei(32877,m),0===i&&n.generateMipmaps&&ve.generateMipmap(u),q.unbindTexture()},this.initTexture=function(e){e.isCubeTexture?K.setTextureCube(e,0):e.isData3DTexture?K.setTexture3D(e,0):e.isDataArrayTexture||e.isCompressedArrayTexture?K.setTexture2DArray(e,0):K.setTexture2D(e,0),q.unbindTexture()},this.resetState=function(){b=0,w=0,S=null,q.reset(),ge.reset()},"undefined"!=typeof __THREE_DEVTOOLS__&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}Object.defineProperties(ba.prototype,{physicallyCorrectLights:{get:function(){return!this.useLegacyLights},set:function(e){this.useLegacyLights=!e}}});(class extends ba{}).prototype.isWebGL1Renderer=!0;class wa{constructor(e,t=1,r=1e3){this.isFog=!0,this.name="",this.color=new zn(e),this.near=t,this.far=r}clone(){return new wa(this.color,this.near,this.far)}toJSON(){return{type:"Fog",color:this.color.getHex(),near:this.near,far:this.far}}}class Sa extends Sn{constructor(){super(),this.isScene=!0,this.type="Scene",this.background=null,this.environment=null,this.fog=null,this.backgroundBlurriness=0,this.backgroundIntensity=1,this.overrideMaterial=null,"undefined"!=typeof __THREE_DEVTOOLS__&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}copy(e,t){return super.copy(e,t),null!==e.background&&(this.background=e.background.clone()),null!==e.environment&&(this.environment=e.environment.clone()),null!==e.fog&&(this.fog=e.fog.clone()),this.backgroundBlurriness=e.backgroundBlurriness,this.backgroundIntensity=e.backgroundIntensity,null!==e.overrideMaterial&&(this.overrideMaterial=e.overrideMaterial.clone()),this.matrixAutoUpdate=e.matrixAutoUpdate,this}toJSON(e){const t=super.toJSON(e);return null!==this.fog&&(t.object.fog=this.fog.toJSON()),this.backgroundBlurriness>0&&(t.object.backgroundBlurriness=this.backgroundBlurriness),1!==this.backgroundIntensity&&(t.object.backgroundIntensity=this.backgroundIntensity),t}get autoUpdate(){return this.matrixWorldAutoUpdate}set autoUpdate(e){this.matrixWorldAutoUpdate=e}}class Ma{constructor(e,t){this.isInterleavedBuffer=!0,this.array=e,this.stride=t,this.count=void 0!==e?e.length/t:0,this.usage=It,this.updateRange={offset:0,count:-1},this.version=0,this.uuid=zt()}onUploadCallback(){}set needsUpdate(e){!0===e&&this.version++}setUsage(e){return this.usage=e,this}copy(e){return this.array=new e.array.constructor(e.array),this.count=e.count,this.stride=e.stride,this.usage=e.usage,this}copyAt(e,t,r){e*=this.stride,r*=t.stride;for(let n=0,i=this.stride;n<i;n++)this.array[e+n]=t.array[r+n];return this}set(e,t=0){return this.array.set(e,t),this}clone(e){void 0===e.arrayBuffers&&(e.arrayBuffers={}),void 0===this.array.buffer._uuid&&(this.array.buffer._uuid=zt()),void 0===e.arrayBuffers[this.array.buffer._uuid]&&(e.arrayBuffers[this.array.buffer._uuid]=this.array.slice(0).buffer);const t=new this.array.constructor(e.arrayBuffers[this.array.buffer._uuid]),r=new this.constructor(t,this.stride);return r.setUsage(this.usage),r}onUpload(e){return this.onUploadCallback=e,this}toJSON(e){return void 0===e.arrayBuffers&&(e.arrayBuffers={}),void 0===this.array.buffer._uuid&&(this.array.buffer._uuid=zt()),void 0===e.arrayBuffers[this.array.buffer._uuid]&&(e.arrayBuffers[this.array.buffer._uuid]=Array.from(new Uint32Array(this.array.buffer))),{uuid:this.uuid,buffer:this.array.buffer._uuid,type:this.array.constructor.name,stride:this.stride}}}const Ta=new nr;class Ea{constructor(e,t,r,n=!1){this.isInterleavedBufferAttribute=!0,this.name="",this.data=e,this.itemSize=t,this.offset=r,this.normalized=n}get count(){return this.data.count}get array(){return this.data.array}set needsUpdate(e){this.data.needsUpdate=e}applyMatrix4(e){for(let t=0,r=this.data.count;t<r;t++)Ta.fromBufferAttribute(this,t),Ta.applyMatrix4(e),this.setXYZ(t,Ta.x,Ta.y,Ta.z);return this}applyNormalMatrix(e){for(let t=0,r=this.count;t<r;t++)Ta.fromBufferAttribute(this,t),Ta.applyNormalMatrix(e),this.setXYZ(t,Ta.x,Ta.y,Ta.z);return this}transformDirection(e){for(let t=0,r=this.count;t<r;t++)Ta.fromBufferAttribute(this,t),Ta.transformDirection(e),this.setXYZ(t,Ta.x,Ta.y,Ta.z);return this}setX(e,t){return this.normalized&&(t=Zt(t,this.array)),this.data.array[e*this.data.stride+this.offset]=t,this}setY(e,t){return this.normalized&&(t=Zt(t,this.array)),this.data.array[e*this.data.stride+this.offset+1]=t,this}setZ(e,t){return this.normalized&&(t=Zt(t,this.array)),this.data.array[e*this.data.stride+this.offset+2]=t,this}setW(e,t){return this.normalized&&(t=Zt(t,this.array)),this.data.array[e*this.data.stride+this.offset+3]=t,this}getX(e){let t=this.data.array[e*this.data.stride+this.offset];return this.normalized&&(t=Yt(t,this.array)),t}getY(e){let t=this.data.array[e*this.data.stride+this.offset+1];return this.normalized&&(t=Yt(t,this.array)),t}getZ(e){let t=this.data.array[e*this.data.stride+this.offset+2];return this.normalized&&(t=Yt(t,this.array)),t}getW(e){let t=this.data.array[e*this.data.stride+this.offset+3];return this.normalized&&(t=Yt(t,this.array)),t}setXY(e,t,r){return e=e*this.data.stride+this.offset,this.normalized&&(t=Zt(t,this.array),r=Zt(r,this.array)),this.data.array[e+0]=t,this.data.array[e+1]=r,this}setXYZ(e,t,r,n){return e=e*this.data.stride+this.offset,this.normalized&&(t=Zt(t,this.array),r=Zt(r,this.array),n=Zt(n,this.array)),this.data.array[e+0]=t,this.data.array[e+1]=r,this.data.array[e+2]=n,this}setXYZW(e,t,r,n,i){return e=e*this.data.stride+this.offset,this.normalized&&(t=Zt(t,this.array),r=Zt(r,this.array),n=Zt(n,this.array),i=Zt(i,this.array)),this.data.array[e+0]=t,this.data.array[e+1]=r,this.data.array[e+2]=n,this.data.array[e+3]=i,this}clone(e){if(void 0===e){const e=[];for(let t=0;t<this.count;t++){const r=t*this.data.stride+this.offset;for(let t=0;t<this.itemSize;t++)e.push(this.data.array[r+t])}return new Xn(new this.array.constructor(e),this.itemSize,this.normalized)}return void 0===e.interleavedBuffers&&(e.interleavedBuffers={}),void 0===e.interleavedBuffers[this.data.uuid]&&(e.interleavedBuffers[this.data.uuid]=this.data.clone(e)),new Ea(e.interleavedBuffers[this.data.uuid],this.itemSize,this.offset,this.normalized)}toJSON(e){if(void 0===e){const e=[];for(let t=0;t<this.count;t++){const r=t*this.data.stride+this.offset;for(let t=0;t<this.itemSize;t++)e.push(this.data.array[r+t])}return{itemSize:this.itemSize,type:this.array.constructor.name,array:e,normalized:this.normalized}}return void 0===e.interleavedBuffers&&(e.interleavedBuffers={}),void 0===e.interleavedBuffers[this.data.uuid]&&(e.interleavedBuffers[this.data.uuid]=this.data.toJSON(e)),{isInterleavedBufferAttribute:!0,itemSize:this.itemSize,data:this.data.uuid,offset:this.offset,normalized:this.normalized}}}const Aa=new nr,Ca=new xr,La=new xr,Ra=new nr,Pa=new Kr;class ja extends vi{constructor(e,t){super(e,t),this.isSkinnedMesh=!0,this.type="SkinnedMesh",this.bindMode="attached",this.bindMatrix=new Kr,this.bindMatrixInverse=new Kr}copy(e,t){return super.copy(e,t),this.bindMode=e.bindMode,this.bindMatrix.copy(e.bindMatrix),this.bindMatrixInverse.copy(e.bindMatrixInverse),this.skeleton=e.skeleton,this}bind(e,t){this.skeleton=e,void 0===t&&(this.updateMatrixWorld(!0),this.skeleton.calculateInverses(),t=this.matrixWorld),this.bindMatrix.copy(t),this.bindMatrixInverse.copy(t).invert()}pose(){this.skeleton.pose()}normalizeSkinWeights(){const e=new xr,t=this.geometry.attributes.skinWeight;for(let r=0,n=t.count;r<n;r++){e.fromBufferAttribute(t,r);const n=1/e.manhattanLength();n!==1/0?e.multiplyScalar(n):e.set(1,0,0,0),t.setXYZW(r,e.x,e.y,e.z,e.w)}}updateMatrixWorld(e){super.updateMatrixWorld(e),"attached"===this.bindMode?this.bindMatrixInverse.copy(this.matrixWorld).invert():"detached"===this.bindMode&&this.bindMatrixInverse.copy(this.bindMatrix).invert()}boneTransform(e,t){const r=this.skeleton,n=this.geometry;Ca.fromBufferAttribute(n.attributes.skinIndex,e),La.fromBufferAttribute(n.attributes.skinWeight,e),Aa.copy(t).applyMatrix4(this.bindMatrix),t.set(0,0,0);for(let e=0;e<4;e++){const n=La.getComponent(e);if(0!==n){const i=Ca.getComponent(e);Pa.multiplyMatrices(r.bones[i].matrixWorld,r.boneInverses[i]),t.addScaledVector(Ra.copy(Aa).applyMatrix4(Pa),n)}}return t.applyMatrix4(this.bindMatrixInverse)}}class Ia extends Sn{constructor(){super(),this.isBone=!0,this.type="Bone"}}class Da extends _r{constructor(e=null,t=1,r=1,n,i,s,o,a,l=le,c=le,u,h){super(null,s,o,a,l,c,n,i,u,h),this.isDataTexture=!0,this.image={data:e,width:t,height:r},this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}const Oa=new Kr,Na=new Kr;class Ua{constructor(e=[],t=[]){this.uuid=zt(),this.bones=e.slice(0),this.boneInverses=t,this.boneMatrices=null,this.boneTexture=null,this.boneTextureSize=0,this.frame=-1,this.init()}init(){const e=this.bones,t=this.boneInverses;if(this.boneMatrices=new Float32Array(16*e.length),0===t.length)this.calculateInverses();else if(e.length!==t.length){this.boneInverses=[];for(let e=0,t=this.bones.length;e<t;e++)this.boneInverses.push(new Kr)}}calculateInverses(){this.boneInverses.length=0;for(let e=0,t=this.bones.length;e<t;e++){const t=new Kr;this.bones[e]&&t.copy(this.bones[e].matrixWorld).invert(),this.boneInverses.push(t)}}pose(){for(let e=0,t=this.bones.length;e<t;e++){const t=this.bones[e];t&&t.matrixWorld.copy(this.boneInverses[e]).invert()}for(let e=0,t=this.bones.length;e<t;e++){const t=this.bones[e];t&&(t.parent&&t.parent.isBone?(t.matrix.copy(t.parent.matrixWorld).invert(),t.matrix.multiply(t.matrixWorld)):t.matrix.copy(t.matrixWorld),t.matrix.decompose(t.position,t.quaternion,t.scale))}}update(){const e=this.bones,t=this.boneInverses,r=this.boneMatrices,n=this.boneTexture;for(let n=0,i=e.length;n<i;n++){const i=e[n]?e[n].matrixWorld:Na;Oa.multiplyMatrices(i,t[n]),Oa.toArray(r,16*n)}null!==n&&(n.needsUpdate=!0)}clone(){return new Ua(this.bones,this.boneInverses)}computeBoneTexture(){let e=Math.sqrt(4*this.bones.length);e=Xt(e),e=Math.max(e,4);const t=new Float32Array(e*e*4);t.set(this.boneMatrices);const r=new Da(t,e,e,Ee,xe);return r.needsUpdate=!0,this.boneMatrices=t,this.boneTexture=r,this.boneTextureSize=e,this}getBoneByName(e){for(let t=0,r=this.bones.length;t<r;t++){const r=this.bones[t];if(r.name===e)return r}}dispose(){null!==this.boneTexture&&(this.boneTexture.dispose(),this.boneTexture=null)}fromJSON(e,t){this.uuid=e.uuid;for(let r=0,n=e.bones.length;r<n;r++){let n=t[e.bones[r]];void 0===n&&(n=new Ia),this.bones.push(n),this.boneInverses.push((new Kr).fromArray(e.boneInverses[r]))}return this.init(),this}toJSON(){const e={metadata:{version:4.5,type:"Skeleton",generator:"Skeleton.toJSON"},bones:[],boneInverses:[]};e.uuid=this.uuid;const t=this.bones,r=this.boneInverses;for(let n=0,i=t.length;n<i;n++){const i=t[n];e.bones.push(i.uuid);const s=r[n];e.boneInverses.push(s.toArray())}return e}}class ka extends Xn{constructor(e,t,r,n=1){super(e,t,r),this.isInstancedBufferAttribute=!0,this.meshPerAttribute=n}copy(e){return super.copy(e),this.meshPerAttribute=e.meshPerAttribute,this}toJSON(){const e=super.toJSON();return e.meshPerAttribute=this.meshPerAttribute,e.isInstancedBufferAttribute=!0,e}}const Fa=new Kr,Ba=new Kr,za=[],Ga=new Kr,Va=new vi;class Ha extends vi{constructor(e,t,r){super(e,t),this.isInstancedMesh=!0,this.instanceMatrix=new ka(new Float32Array(16*r),16),this.instanceColor=null,this.count=r,this.frustumCulled=!1;for(let e=0;e<r;e++)this.setMatrixAt(e,Ga)}copy(e,t){return super.copy(e,t),this.instanceMatrix.copy(e.instanceMatrix),null!==e.instanceColor&&(this.instanceColor=e.instanceColor.clone()),this.count=e.count,this}getColorAt(e,t){t.fromArray(this.instanceColor.array,3*e)}getMatrixAt(e,t){t.fromArray(this.instanceMatrix.array,16*e)}raycast(e,t){const r=this.matrixWorld,n=this.count;if(Va.geometry=this.geometry,Va.material=this.material,void 0!==Va.material)for(let i=0;i<n;i++){this.getMatrixAt(i,Fa),Ba.multiplyMatrices(r,Fa),Va.matrixWorld=Ba,Va.raycast(e,za);for(let e=0,r=za.length;e<r;e++){const r=za[e];r.instanceId=i,r.object=this,t.push(r)}za.length=0}}setColorAt(e,t){null===this.instanceColor&&(this.instanceColor=new ka(new Float32Array(3*this.instanceMatrix.count),3)),t.toArray(this.instanceColor.array,3*e)}setMatrixAt(e,t){t.toArray(this.instanceMatrix.array,16*e)}updateMorphTargets(){}dispose(){this.dispatchEvent({type:"dispose"})}}class Wa extends Nn{constructor(e){super(),this.isLineBasicMaterial=!0,this.type="LineBasicMaterial",this.color=new zn(16777215),this.linewidth=1,this.linecap="round",this.linejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.linewidth=e.linewidth,this.linecap=e.linecap,this.linejoin=e.linejoin,this.fog=e.fog,this}}const Xa=new nr,qa=new nr,Ya=new Kr,Za=new Jr,Ja=new Gr;class Ka extends Sn{constructor(e=new ni,t=new Wa){super(),this.isLine=!0,this.type="Line",this.geometry=e,this.material=t,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),this.material=e.material,this.geometry=e.geometry,this}computeLineDistances(){const e=this.geometry;if(null===e.index){const t=e.attributes.position,r=[0];for(let e=1,n=t.count;e<n;e++)Xa.fromBufferAttribute(t,e-1),qa.fromBufferAttribute(t,e),r[e]=r[e-1],r[e]+=Xa.distanceTo(qa);e.setAttribute("lineDistance",new Zn(r,1))}return this}raycast(e,t){const r=this.geometry,n=this.matrixWorld,i=e.params.Line.threshold,s=r.drawRange;if(null===r.boundingSphere&&r.computeBoundingSphere(),Ja.copy(r.boundingSphere),Ja.applyMatrix4(n),Ja.radius+=i,!1===e.ray.intersectsSphere(Ja))return;Ya.copy(n).invert(),Za.copy(e.ray).applyMatrix4(Ya);const o=i/((this.scale.x+this.scale.y+this.scale.z)/3),a=o*o,l=new nr,c=new nr,u=new nr,h=new nr,d=this.isLineSegments?2:1,p=r.index,f=r.attributes.position;if(null!==p){for(let r=Math.max(0,s.start),n=Math.min(p.count,s.start+s.count)-1;r<n;r+=d){const n=p.getX(r),i=p.getX(r+1);l.fromBufferAttribute(f,n),c.fromBufferAttribute(f,i);if(Za.distanceSqToSegment(l,c,h,u)>a)continue;h.applyMatrix4(this.matrixWorld);const s=e.ray.origin.distanceTo(h);s<e.near||s>e.far||t.push({distance:s,point:u.clone().applyMatrix4(this.matrixWorld),index:r,face:null,faceIndex:null,object:this})}}else{for(let r=Math.max(0,s.start),n=Math.min(f.count,s.start+s.count)-1;r<n;r+=d){l.fromBufferAttribute(f,r),c.fromBufferAttribute(f,r+1);if(Za.distanceSqToSegment(l,c,h,u)>a)continue;h.applyMatrix4(this.matrixWorld);const n=e.ray.origin.distanceTo(h);n<e.near||n>e.far||t.push({distance:n,point:u.clone().applyMatrix4(this.matrixWorld),index:r,face:null,faceIndex:null,object:this})}}}updateMorphTargets(){const e=this.geometry.morphAttributes,t=Object.keys(e);if(t.length>0){const r=e[t[0]];if(void 0!==r){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let e=0,t=r.length;e<t;e++){const t=r[e].name||String(e);this.morphTargetInfluences.push(0),this.morphTargetDictionary[t]=e}}}}}const Qa=new nr,$a=new nr;class el extends Ka{constructor(e,t){super(e,t),this.isLineSegments=!0,this.type="LineSegments"}computeLineDistances(){const e=this.geometry;if(null===e.index){const t=e.attributes.position,r=[];for(let e=0,n=t.count;e<n;e+=2)Qa.fromBufferAttribute(t,e),$a.fromBufferAttribute(t,e+1),r[e]=0===e?0:r[e-1],r[e+1]=r[e]+Qa.distanceTo($a);e.setAttribute("lineDistance",new Zn(r,1))}return this}}class tl extends Ka{constructor(e,t){super(e,t),this.isLineLoop=!0,this.type="LineLoop"}}class rl extends Nn{constructor(e){super(),this.isPointsMaterial=!0,this.type="PointsMaterial",this.color=new zn(16777215),this.map=null,this.alphaMap=null,this.size=1,this.sizeAttenuation=!0,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.alphaMap=e.alphaMap,this.size=e.size,this.sizeAttenuation=e.sizeAttenuation,this.fog=e.fog,this}}const nl=new Kr,il=new Jr,sl=new Gr,ol=new nr;class al extends Sn{constructor(e=new ni,t=new rl){super(),this.isPoints=!0,this.type="Points",this.geometry=e,this.material=t,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),this.material=e.material,this.geometry=e.geometry,this}raycast(e,t){const r=this.geometry,n=this.matrixWorld,i=e.params.Points.threshold,s=r.drawRange;if(null===r.boundingSphere&&r.computeBoundingSphere(),sl.copy(r.boundingSphere),sl.applyMatrix4(n),sl.radius+=i,!1===e.ray.intersectsSphere(sl))return;nl.copy(n).invert(),il.copy(e.ray).applyMatrix4(nl);const o=i/((this.scale.x+this.scale.y+this.scale.z)/3),a=o*o,l=r.index,c=r.attributes.position;if(null!==l){for(let r=Math.max(0,s.start),i=Math.min(l.count,s.start+s.count);r<i;r++){const i=l.getX(r);ol.fromBufferAttribute(c,i),ll(ol,i,a,n,e,t,this)}}else{for(let r=Math.max(0,s.start),i=Math.min(c.count,s.start+s.count);r<i;r++)ol.fromBufferAttribute(c,r),ll(ol,r,a,n,e,t,this)}}updateMorphTargets(){const e=this.geometry.morphAttributes,t=Object.keys(e);if(t.length>0){const r=e[t[0]];if(void 0!==r){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let e=0,t=r.length;e<t;e++){const t=r[e].name||String(e);this.morphTargetInfluences.push(0),this.morphTargetDictionary[t]=e}}}}}function ll(e,t,r,n,i,s,o){const a=il.distanceSqToPoint(e);if(a<r){const r=new nr;il.closestPointToPoint(e,r),r.applyMatrix4(n);const l=i.ray.origin.distanceTo(r);if(l<i.near||l>i.far)return;s.push({distance:l,distanceToRay:Math.sqrt(a),point:r,index:t,face:null,object:o})}}class cl extends ni{constructor(e=1,t=1,r=1,n=32,i=1,s=!1,o=0,a=2*Math.PI){super(),this.type="CylinderGeometry",this.parameters={radiusTop:e,radiusBottom:t,height:r,radialSegments:n,heightSegments:i,openEnded:s,thetaStart:o,thetaLength:a};const l=this;n=Math.floor(n),i=Math.floor(i);const c=[],u=[],h=[],d=[];let p=0;const f=[],m=r/2;let g=0;function y(r){const i=p,s=new Kt,f=new nr;let y=0;const v=!0===r?e:t,_=!0===r?1:-1;for(let e=1;e<=n;e++)u.push(0,m*_,0),h.push(0,_,0),d.push(.5,.5),p++;const x=p;for(let e=0;e<=n;e++){const t=e/n*a+o,r=Math.cos(t),i=Math.sin(t);f.x=v*i,f.y=m*_,f.z=v*r,u.push(f.x,f.y,f.z),h.push(0,_,0),s.x=.5*r+.5,s.y=.5*i*_+.5,d.push(s.x,s.y),p++}for(let e=0;e<n;e++){const t=i+e,n=x+e;!0===r?c.push(n,n+1,t):c.push(n+1,n,t),y+=3}l.addGroup(g,y,!0===r?1:2),g+=y}!function(){const s=new nr,y=new nr;let v=0;const _=(t-e)/r;for(let l=0;l<=i;l++){const c=[],g=l/i,v=g*(t-e)+e;for(let e=0;e<=n;e++){const t=e/n,i=t*a+o,l=Math.sin(i),f=Math.cos(i);y.x=v*l,y.y=-g*r+m,y.z=v*f,u.push(y.x,y.y,y.z),s.set(l,_,f).normalize(),h.push(s.x,s.y,s.z),d.push(t,1-g),c.push(p++)}f.push(c)}for(let e=0;e<n;e++)for(let t=0;t<i;t++){const r=f[t][e],n=f[t+1][e],i=f[t+1][e+1],s=f[t][e+1];c.push(r,n,s),c.push(n,i,s),v+=6}l.addGroup(g,v,0),g+=v}(),!1===s&&(e>0&&y(!0),t>0&&y(!1)),this.setIndex(c),this.setAttribute("position",new Zn(u,3)),this.setAttribute("normal",new Zn(h,3)),this.setAttribute("uv",new Zn(d,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new cl(e.radiusTop,e.radiusBottom,e.height,e.radialSegments,e.heightSegments,e.openEnded,e.thetaStart,e.thetaLength)}}class ul extends cl{constructor(e=1,t=1,r=32,n=1,i=!1,s=0,o=2*Math.PI){super(0,e,t,r,n,i,s,o),this.type="ConeGeometry",this.parameters={radius:e,height:t,radialSegments:r,heightSegments:n,openEnded:i,thetaStart:s,thetaLength:o}}static fromJSON(e){return new ul(e.radius,e.height,e.radialSegments,e.heightSegments,e.openEnded,e.thetaStart,e.thetaLength)}}class hl extends ni{constructor(e=.5,t=1,r=32,n=1,i=0,s=2*Math.PI){super(),this.type="RingGeometry",this.parameters={innerRadius:e,outerRadius:t,thetaSegments:r,phiSegments:n,thetaStart:i,thetaLength:s},r=Math.max(3,r);const o=[],a=[],l=[],c=[];let u=e;const h=(t-e)/(n=Math.max(1,n)),d=new nr,p=new Kt;for(let e=0;e<=n;e++){for(let e=0;e<=r;e++){const n=i+e/r*s;d.x=u*Math.cos(n),d.y=u*Math.sin(n),a.push(d.x,d.y,d.z),l.push(0,0,1),p.x=(d.x/t+1)/2,p.y=(d.y/t+1)/2,c.push(p.x,p.y)}u+=h}for(let e=0;e<n;e++){const t=e*(r+1);for(let e=0;e<r;e++){const n=e+t,i=n,s=n+r+1,a=n+r+2,l=n+1;o.push(i,s,l),o.push(s,a,l)}}this.setIndex(o),this.setAttribute("position",new Zn(a,3)),this.setAttribute("normal",new Zn(l,3)),this.setAttribute("uv",new Zn(c,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new hl(e.innerRadius,e.outerRadius,e.thetaSegments,e.phiSegments,e.thetaStart,e.thetaLength)}}class dl extends ni{constructor(e=1,t=32,r=16,n=0,i=2*Math.PI,s=0,o=Math.PI){super(),this.type="SphereGeometry",this.parameters={radius:e,widthSegments:t,heightSegments:r,phiStart:n,phiLength:i,thetaStart:s,thetaLength:o},t=Math.max(3,Math.floor(t)),r=Math.max(2,Math.floor(r));const a=Math.min(s+o,Math.PI);let l=0;const c=[],u=new nr,h=new nr,d=[],p=[],f=[],m=[];for(let d=0;d<=r;d++){const g=[],y=d/r;let v=0;0==d&&0==s?v=.5/t:d==r&&a==Math.PI&&(v=-.5/t);for(let r=0;r<=t;r++){const a=r/t;u.x=-e*Math.cos(n+a*i)*Math.sin(s+y*o),u.y=e*Math.cos(s+y*o),u.z=e*Math.sin(n+a*i)*Math.sin(s+y*o),p.push(u.x,u.y,u.z),h.copy(u).normalize(),f.push(h.x,h.y,h.z),m.push(a+v,1-y),g.push(l++)}c.push(g)}for(let e=0;e<r;e++)for(let n=0;n<t;n++){const t=c[e][n+1],i=c[e][n],o=c[e+1][n],l=c[e+1][n+1];(0!==e||s>0)&&d.push(t,i,l),(e!==r-1||a<Math.PI)&&d.push(i,o,l)}this.setIndex(d),this.setAttribute("position",new Zn(p,3)),this.setAttribute("normal",new Zn(f,3)),this.setAttribute("uv",new Zn(m,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new dl(e.radius,e.widthSegments,e.heightSegments,e.phiStart,e.phiLength,e.thetaStart,e.thetaLength)}}class pl extends Nn{constructor(e){super(),this.isMeshStandardMaterial=!0,this.defines={STANDARD:""},this.type="MeshStandardMaterial",this.color=new zn(16777215),this.roughness=1,this.metalness=0,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new zn(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=At,this.normalScale=new Kt(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.roughnessMap=null,this.metalnessMap=null,this.alphaMap=null,this.envMap=null,this.envMapIntensity=1,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.defines={STANDARD:""},this.color.copy(e.color),this.roughness=e.roughness,this.metalness=e.metalness,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.roughnessMap=e.roughnessMap,this.metalnessMap=e.metalnessMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapIntensity=e.envMapIntensity,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}}class fl extends pl{constructor(e){super(),this.isMeshPhysicalMaterial=!0,this.defines={STANDARD:"",PHYSICAL:""},this.type="MeshPhysicalMaterial",this.clearcoatMap=null,this.clearcoatRoughness=0,this.clearcoatRoughnessMap=null,this.clearcoatNormalScale=new Kt(1,1),this.clearcoatNormalMap=null,this.ior=1.5,Object.defineProperty(this,"reflectivity",{get:function(){return Gt(2.5*(this.ior-1)/(this.ior+1),0,1)},set:function(e){this.ior=(1+.4*e)/(1-.4*e)}}),this.iridescenceMap=null,this.iridescenceIOR=1.3,this.iridescenceThicknessRange=[100,400],this.iridescenceThicknessMap=null,this.sheenColor=new zn(0),this.sheenColorMap=null,this.sheenRoughness=1,this.sheenRoughnessMap=null,this.transmissionMap=null,this.thickness=0,this.thicknessMap=null,this.attenuationDistance=1/0,this.attenuationColor=new zn(1,1,1),this.specularIntensity=1,this.specularIntensityMap=null,this.specularColor=new zn(1,1,1),this.specularColorMap=null,this._sheen=0,this._clearcoat=0,this._iridescence=0,this._transmission=0,this.setValues(e)}get sheen(){return this._sheen}set sheen(e){this._sheen>0!=e>0&&this.version++,this._sheen=e}get clearcoat(){return this._clearcoat}set clearcoat(e){this._clearcoat>0!=e>0&&this.version++,this._clearcoat=e}get iridescence(){return this._iridescence}set iridescence(e){this._iridescence>0!=e>0&&this.version++,this._iridescence=e}get transmission(){return this._transmission}set transmission(e){this._transmission>0!=e>0&&this.version++,this._transmission=e}copy(e){return super.copy(e),this.defines={STANDARD:"",PHYSICAL:""},this.clearcoat=e.clearcoat,this.clearcoatMap=e.clearcoatMap,this.clearcoatRoughness=e.clearcoatRoughness,this.clearcoatRoughnessMap=e.clearcoatRoughnessMap,this.clearcoatNormalMap=e.clearcoatNormalMap,this.clearcoatNormalScale.copy(e.clearcoatNormalScale),this.ior=e.ior,this.iridescence=e.iridescence,this.iridescenceMap=e.iridescenceMap,this.iridescenceIOR=e.iridescenceIOR,this.iridescenceThicknessRange=[...e.iridescenceThicknessRange],this.iridescenceThicknessMap=e.iridescenceThicknessMap,this.sheen=e.sheen,this.sheenColor.copy(e.sheenColor),this.sheenColorMap=e.sheenColorMap,this.sheenRoughness=e.sheenRoughness,this.sheenRoughnessMap=e.sheenRoughnessMap,this.transmission=e.transmission,this.transmissionMap=e.transmissionMap,this.thickness=e.thickness,this.thicknessMap=e.thicknessMap,this.attenuationDistance=e.attenuationDistance,this.attenuationColor.copy(e.attenuationColor),this.specularIntensity=e.specularIntensity,this.specularIntensityMap=e.specularIntensityMap,this.specularColor.copy(e.specularColor),this.specularColorMap=e.specularColorMap,this}}class ml extends Nn{constructor(e){super(),this.isMeshLambertMaterial=!0,this.type="MeshLambertMaterial",this.color=new zn(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new zn(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=At,this.normalScale=new Kt(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=W,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}}function gl(e,t,r){return vl(e)?new e.constructor(e.subarray(t,void 0!==r?r:e.length)):e.slice(t,r)}function yl(e,t,r){return!e||!r&&e.constructor===t?e:"number"==typeof t.BYTES_PER_ELEMENT?new t(e):Array.prototype.slice.call(e)}function vl(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)}function _l(e){const t=e.length,r=new Array(t);for(let e=0;e!==t;++e)r[e]=e;return r.sort((function(t,r){return e[t]-e[r]})),r}function xl(e,t,r){const n=e.length,i=new e.constructor(n);for(let s=0,o=0;o!==n;++s){const n=r[s]*t;for(let r=0;r!==t;++r)i[o++]=e[n+r]}return i}function bl(e,t,r,n){let i=1,s=e[0];for(;void 0!==s&&void 0===s[n];)s=e[i++];if(void 0===s)return;let o=s[n];if(void 0!==o)if(Array.isArray(o))do{o=s[n],void 0!==o&&(t.push(s.time),r.push.apply(r,o)),s=e[i++]}while(void 0!==s);else if(void 0!==o.toArray)do{o=s[n],void 0!==o&&(t.push(s.time),o.toArray(r,r.length)),s=e[i++]}while(void 0!==s);else do{o=s[n],void 0!==o&&(t.push(s.time),r.push(o)),s=e[i++]}while(void 0!==s)}class wl{constructor(e,t,r,n){this.parameterPositions=e,this._cachedIndex=0,this.resultBuffer=void 0!==n?n:new t.constructor(r),this.sampleValues=t,this.valueSize=r,this.settings=null,this.DefaultSettings_={}}evaluate(e){const t=this.parameterPositions;let r=this._cachedIndex,n=t[r],i=t[r-1];e:{t:{let s;r:{n:if(!(e<n)){for(let s=r+2;;){if(void 0===n){if(e<i)break n;return r=t.length,this._cachedIndex=r,this.copySampleValue_(r-1)}if(r===s)break;if(i=n,n=t[++r],e<n)break t}s=t.length;break r}if(e>=i)break e;{const o=t[1];e<o&&(r=2,i=o);for(let s=r-2;;){if(void 0===i)return this._cachedIndex=0,this.copySampleValue_(0);if(r===s)break;if(n=i,i=t[--r-1],e>=i)break t}s=r,r=0}}for(;r<s;){const n=r+s>>>1;e<t[n]?s=n:r=n+1}if(n=t[r],i=t[r-1],void 0===i)return this._cachedIndex=0,this.copySampleValue_(0);if(void 0===n)return r=t.length,this._cachedIndex=r,this.copySampleValue_(r-1)}this._cachedIndex=r,this.intervalChanged_(r,i,n)}return this.interpolate_(r,i,e,n)}getSettings_(){return this.settings||this.DefaultSettings_}copySampleValue_(e){const t=this.resultBuffer,r=this.sampleValues,n=this.valueSize,i=e*n;for(let e=0;e!==n;++e)t[e]=r[i+e];return t}interpolate_(){throw new Error("call to abstract method")}intervalChanged_(){}}class Sl extends wl{constructor(e,t,r,n){super(e,t,r,n),this._weightPrev=-0,this._offsetPrev=-0,this._weightNext=-0,this._offsetNext=-0,this.DefaultSettings_={endingStart:gt,endingEnd:gt}}intervalChanged_(e,t,r){const n=this.parameterPositions;let i=e-2,s=e+1,o=n[i],a=n[s];if(void 0===o)switch(this.getSettings_().endingStart){case yt:i=e,o=2*t-r;break;case vt:i=n.length-2,o=t+n[i]-n[i+1];break;default:i=e,o=r}if(void 0===a)switch(this.getSettings_().endingEnd){case yt:s=e,a=2*r-t;break;case vt:s=1,a=r+n[1]-n[0];break;default:s=e-1,a=t}const l=.5*(r-t),c=this.valueSize;this._weightPrev=l/(t-o),this._weightNext=l/(a-r),this._offsetPrev=i*c,this._offsetNext=s*c}interpolate_(e,t,r,n){const i=this.resultBuffer,s=this.sampleValues,o=this.valueSize,a=e*o,l=a-o,c=this._offsetPrev,u=this._offsetNext,h=this._weightPrev,d=this._weightNext,p=(r-t)/(n-t),f=p*p,m=f*p,g=-h*m+2*h*f-h*p,y=(1+h)*m+(-1.5-2*h)*f+(-.5+h)*p+1,v=(-1-d)*m+(1.5+d)*f+.5*p,_=d*m-d*f;for(let e=0;e!==o;++e)i[e]=g*s[c+e]+y*s[l+e]+v*s[a+e]+_*s[u+e];return i}}class Ml extends wl{constructor(e,t,r,n){super(e,t,r,n)}interpolate_(e,t,r,n){const i=this.resultBuffer,s=this.sampleValues,o=this.valueSize,a=e*o,l=a-o,c=(r-t)/(n-t),u=1-c;for(let e=0;e!==o;++e)i[e]=s[l+e]*u+s[a+e]*c;return i}}class Tl extends wl{constructor(e,t,r,n){super(e,t,r,n)}interpolate_(e){return this.copySampleValue_(e-1)}}class El{constructor(e,t,r,n){if(void 0===e)throw new Error("THREE.KeyframeTrack: track name is undefined");if(void 0===t||0===t.length)throw new Error("THREE.KeyframeTrack: no keyframes in track named "+e);this.name=e,this.times=yl(t,this.TimeBufferType),this.values=yl(r,this.ValueBufferType),this.setInterpolation(n||this.DefaultInterpolation)}static toJSON(e){const t=e.constructor;let r;if(t.toJSON!==this.toJSON)r=t.toJSON(e);else{r={name:e.name,times:yl(e.times,Array),values:yl(e.values,Array)};const t=e.getInterpolation();t!==e.DefaultInterpolation&&(r.interpolation=t)}return r.type=e.ValueTypeName,r}InterpolantFactoryMethodDiscrete(e){return new Tl(this.times,this.values,this.getValueSize(),e)}InterpolantFactoryMethodLinear(e){return new Ml(this.times,this.values,this.getValueSize(),e)}InterpolantFactoryMethodSmooth(e){return new Sl(this.times,this.values,this.getValueSize(),e)}setInterpolation(e){let t;switch(e){case pt:t=this.InterpolantFactoryMethodDiscrete;break;case ft:t=this.InterpolantFactoryMethodLinear;break;case mt:t=this.InterpolantFactoryMethodSmooth}if(void 0===t){const t="unsupported interpolation for "+this.ValueTypeName+" keyframe track named "+this.name;if(void 0===this.createInterpolant){if(e===this.DefaultInterpolation)throw new Error(t);this.setInterpolation(this.DefaultInterpolation)}return this}return this.createInterpolant=t,this}getInterpolation(){switch(this.createInterpolant){case this.InterpolantFactoryMethodDiscrete:return pt;case this.InterpolantFactoryMethodLinear:return ft;case this.InterpolantFactoryMethodSmooth:return mt}}getValueSize(){return this.values.length/this.times.length}shift(e){if(0!==e){const t=this.times;for(let r=0,n=t.length;r!==n;++r)t[r]+=e}return this}scale(e){if(1!==e){const t=this.times;for(let r=0,n=t.length;r!==n;++r)t[r]*=e}return this}trim(e,t){const r=this.times,n=r.length;let i=0,s=n-1;for(;i!==n&&r[i]<e;)++i;for(;-1!==s&&r[s]>t;)--s;if(++s,0!==i||s!==n){i>=s&&(s=Math.max(s,1),i=s-1);const e=this.getValueSize();this.times=gl(r,i,s),this.values=gl(this.values,i*e,s*e)}return this}validate(){let e=!0;const t=this.getValueSize();t-Math.floor(t)!=0&&(e=!1);const r=this.times,n=this.values,i=r.length;0===i&&(e=!1);let s=null;for(let t=0;t!==i;t++){const n=r[t];if("number"==typeof n&&isNaN(n)){e=!1;break}if(null!==s&&s>n){e=!1;break}s=n}if(void 0!==n&&vl(n))for(let t=0,r=n.length;t!==r;++t){const r=n[t];if(isNaN(r)){e=!1;break}}return e}optimize(){const e=gl(this.times),t=gl(this.values),r=this.getValueSize(),n=this.getInterpolation()===mt,i=e.length-1;let s=1;for(let o=1;o<i;++o){let i=!1;const a=e[o];if(a!==e[o+1]&&(1!==o||a!==e[0]))if(n)i=!0;else{const e=o*r,n=e-r,s=e+r;for(let o=0;o!==r;++o){const r=t[e+o];if(r!==t[n+o]||r!==t[s+o]){i=!0;break}}}if(i){if(o!==s){e[s]=e[o];const n=o*r,i=s*r;for(let e=0;e!==r;++e)t[i+e]=t[n+e]}++s}}if(i>0){e[s]=e[i];for(let e=i*r,n=s*r,o=0;o!==r;++o)t[n+o]=t[e+o];++s}return s!==e.length?(this.times=gl(e,0,s),this.values=gl(t,0,s*r)):(this.times=e,this.values=t),this}clone(){const e=gl(this.times,0),t=gl(this.values,0),r=new(0,this.constructor)(this.name,e,t);return r.createInterpolant=this.createInterpolant,r}}El.prototype.TimeBufferType=Float32Array,El.prototype.ValueBufferType=Float32Array,El.prototype.DefaultInterpolation=ft;class Al extends El{}Al.prototype.ValueTypeName="bool",Al.prototype.ValueBufferType=Array,Al.prototype.DefaultInterpolation=pt,Al.prototype.InterpolantFactoryMethodLinear=void 0,Al.prototype.InterpolantFactoryMethodSmooth=void 0;class Cl extends El{}Cl.prototype.ValueTypeName="color";class Ll extends El{}Ll.prototype.ValueTypeName="number";class Rl extends wl{constructor(e,t,r,n){super(e,t,r,n)}interpolate_(e,t,r,n){const i=this.resultBuffer,s=this.sampleValues,o=this.valueSize,a=(r-t)/(n-t);let l=e*o;for(let e=l+o;l!==e;l+=4)rr.slerpFlat(i,0,s,l-o,s,l,a);return i}}class Pl extends El{InterpolantFactoryMethodLinear(e){return new Rl(this.times,this.values,this.getValueSize(),e)}}Pl.prototype.ValueTypeName="quaternion",Pl.prototype.DefaultInterpolation=ft,Pl.prototype.InterpolantFactoryMethodSmooth=void 0;class jl extends El{}jl.prototype.ValueTypeName="string",jl.prototype.ValueBufferType=Array,jl.prototype.DefaultInterpolation=pt,jl.prototype.InterpolantFactoryMethodLinear=void 0,jl.prototype.InterpolantFactoryMethodSmooth=void 0;class Il extends El{}Il.prototype.ValueTypeName="vector";class Dl{constructor(e,t=-1,r,n=2500){this.name=e,this.tracks=r,this.duration=t,this.blendMode=n,this.uuid=zt(),this.duration<0&&this.resetDuration()}static parse(e){const t=[],r=e.tracks,n=1/(e.fps||1);for(let e=0,i=r.length;e!==i;++e)t.push(Ol(r[e]).scale(n));const i=new this(e.name,e.duration,t,e.blendMode);return i.uuid=e.uuid,i}static toJSON(e){const t=[],r=e.tracks,n={name:e.name,duration:e.duration,tracks:t,uuid:e.uuid,blendMode:e.blendMode};for(let e=0,n=r.length;e!==n;++e)t.push(El.toJSON(r[e]));return n}static CreateFromMorphTargetSequence(e,t,r,n){const i=t.length,s=[];for(let e=0;e<i;e++){let o=[],a=[];o.push((e+i-1)%i,e,(e+1)%i),a.push(0,1,0);const l=_l(o);o=xl(o,1,l),a=xl(a,1,l),n||0!==o[0]||(o.push(i),a.push(a[0])),s.push(new Ll(".morphTargetInfluences["+t[e].name+"]",o,a).scale(1/r))}return new this(e,-1,s)}static findByName(e,t){let r=e;if(!Array.isArray(e)){const t=e;r=t.geometry&&t.geometry.animations||t.animations}for(let e=0;e<r.length;e++)if(r[e].name===t)return r[e];return null}static CreateClipsFromMorphTargetSequences(e,t,r){const n={},i=/^([\w-]*?)([\d]+)$/;for(let t=0,r=e.length;t<r;t++){const r=e[t],s=r.name.match(i);if(s&&s.length>1){const e=s[1];let t=n[e];t||(n[e]=t=[]),t.push(r)}}const s=[];for(const e in n)s.push(this.CreateFromMorphTargetSequence(e,n[e],t,r));return s}static parseAnimation(e,t){if(!e)return null;const r=function(e,t,r,n,i){if(0!==r.length){const s=[],o=[];bl(r,s,o,n),0!==s.length&&i.push(new e(t,s,o))}},n=[],i=e.name||"default",s=e.fps||30,o=e.blendMode;let a=e.length||-1;const l=e.hierarchy||[];for(let e=0;e<l.length;e++){const i=l[e].keys;if(i&&0!==i.length)if(i[0].morphTargets){const e={};let t;for(t=0;t<i.length;t++)if(i[t].morphTargets)for(let r=0;r<i[t].morphTargets.length;r++)e[i[t].morphTargets[r]]=-1;for(const r in e){const e=[],s=[];for(let n=0;n!==i[t].morphTargets.length;++n){const n=i[t];e.push(n.time),s.push(n.morphTarget===r?1:0)}n.push(new Ll(".morphTargetInfluence["+r+"]",e,s))}a=e.length*s}else{const s=".bones["+t[e].name+"]";r(Il,s+".position",i,"pos",n),r(Pl,s+".quaternion",i,"rot",n),r(Il,s+".scale",i,"scl",n)}}if(0===n.length)return null;return new this(i,a,n,o)}resetDuration(){let e=0;for(let t=0,r=this.tracks.length;t!==r;++t){const r=this.tracks[t];e=Math.max(e,r.times[r.times.length-1])}return this.duration=e,this}trim(){for(let e=0;e<this.tracks.length;e++)this.tracks[e].trim(0,this.duration);return this}validate(){let e=!0;for(let t=0;t<this.tracks.length;t++)e=e&&this.tracks[t].validate();return e}optimize(){for(let e=0;e<this.tracks.length;e++)this.tracks[e].optimize();return this}clone(){const e=[];for(let t=0;t<this.tracks.length;t++)e.push(this.tracks[t].clone());return new this.constructor(this.name,this.duration,e,this.blendMode)}toJSON(){return this.constructor.toJSON(this)}}function Ol(e){if(void 0===e.type)throw new Error("THREE.KeyframeTrack: track type undefined, can not parse");const t=function(e){switch(e.toLowerCase()){case"scalar":case"double":case"float":case"number":case"integer":return Ll;case"vector":case"vector2":case"vector3":case"vector4":return Il;case"color":return Cl;case"quaternion":return Pl;case"bool":case"boolean":return Al;case"string":return jl}throw new Error("THREE.KeyframeTrack: Unsupported typeName: "+e)}(e.type);if(void 0===e.times){const t=[],r=[];bl(e.keys,t,r,"value"),e.times=t,e.values=r}return void 0!==t.parse?t.parse(e):new t(e.name,e.times,e.values,e.interpolation)}const Nl={enabled:!1,files:{},add:function(e,t){!1!==this.enabled&&(this.files[e]=t)},get:function(e){if(!1!==this.enabled)return this.files[e]},remove:function(e){delete this.files[e]},clear:function(){this.files={}}};class Ul{constructor(e,t,r){const n=this;let i,s=!1,o=0,a=0;const l=[];this.onStart=void 0,this.onLoad=e,this.onProgress=t,this.onError=r,this.itemStart=function(e){a++,!1===s&&void 0!==n.onStart&&n.onStart(e,o,a),s=!0},this.itemEnd=function(e){o++,void 0!==n.onProgress&&n.onProgress(e,o,a),o===a&&(s=!1,void 0!==n.onLoad&&n.onLoad())},this.itemError=function(e){void 0!==n.onError&&n.onError(e)},this.resolveURL=function(e){return i?i(e):e},this.setURLModifier=function(e){return i=e,this},this.addHandler=function(e,t){return l.push(e,t),this},this.removeHandler=function(e){const t=l.indexOf(e);return-1!==t&&l.splice(t,2),this},this.getHandler=function(e){for(let t=0,r=l.length;t<r;t+=2){const r=l[t],n=l[t+1];if(r.global&&(r.lastIndex=0),r.test(e))return n}return null}}}const kl=new Ul;class Fl{constructor(e){this.manager=void 0!==e?e:kl,this.crossOrigin="anonymous",this.withCredentials=!1,this.path="",this.resourcePath="",this.requestHeader={}}load(){}loadAsync(e,t){const r=this;return new Promise((function(n,i){r.load(e,n,t,i)}))}parse(){}setCrossOrigin(e){return this.crossOrigin=e,this}setWithCredentials(e){return this.withCredentials=e,this}setPath(e){return this.path=e,this}setResourcePath(e){return this.resourcePath=e,this}setRequestHeader(e){return this.requestHeader=e,this}}const Bl={};class zl extends Error{constructor(e,t){super(e),this.response=t}}class Gl extends Fl{constructor(e){super(e)}load(e,t,r,n){void 0===e&&(e=""),void 0!==this.path&&(e=this.path+e),e=this.manager.resolveURL(e);const i=Nl.get(e);if(void 0!==i)return this.manager.itemStart(e),setTimeout((()=>{t&&t(i),this.manager.itemEnd(e)}),0),i;if(void 0!==Bl[e])return void Bl[e].push({onLoad:t,onProgress:r,onError:n});Bl[e]=[],Bl[e].push({onLoad:t,onProgress:r,onError:n});const s=new Request(e,{headers:new Headers(this.requestHeader),credentials:this.withCredentials?"include":"same-origin"}),o=this.mimeType,a=this.responseType;fetch(s).then((t=>{if(200===t.status||0===t.status){if(t.status,"undefined"==typeof ReadableStream||void 0===t.body||void 0===t.body.getReader)return t;const r=Bl[e],n=t.body.getReader(),i=t.headers.get("Content-Length")||t.headers.get("X-File-Size"),s=i?parseInt(i):0,o=0!==s;let a=0;const l=new ReadableStream({start(e){!function t(){n.read().then((({done:n,value:i})=>{if(n)e.close();else{a+=i.byteLength;const n=new ProgressEvent("progress",{lengthComputable:o,loaded:a,total:s});for(let e=0,t=r.length;e<t;e++){const t=r[e];t.onProgress&&t.onProgress(n)}e.enqueue(i),t()}}))}()}});return new Response(l)}throw new zl(`fetch for "${t.url}" responded with ${t.status}: ${t.statusText}`,t)})).then((e=>{switch(a){case"arraybuffer":return e.arrayBuffer();case"blob":return e.blob();case"document":return e.text().then((e=>(new DOMParser).parseFromString(e,o)));case"json":return e.json();default:if(void 0===o)return e.text();{const t=/charset="?([^;"\s]*)"?/i.exec(o),r=t&&t[1]?t[1].toLowerCase():void 0,n=new TextDecoder(r);return e.arrayBuffer().then((e=>n.decode(e)))}}})).then((t=>{Nl.add(e,t);const r=Bl[e];delete Bl[e];for(let e=0,n=r.length;e<n;e++){const n=r[e];n.onLoad&&n.onLoad(t)}})).catch((t=>{const r=Bl[e];if(void 0===r)throw this.manager.itemError(e),t;delete Bl[e];for(let e=0,n=r.length;e<n;e++){const n=r[e];n.onError&&n.onError(t)}this.manager.itemError(e)})).finally((()=>{this.manager.itemEnd(e)})),this.manager.itemStart(e)}setResponseType(e){return this.responseType=e,this}setMimeType(e){return this.mimeType=e,this}}class Vl extends Fl{constructor(e){super(e)}load(e,t,r,n){void 0!==this.path&&(e=this.path+e),e=this.manager.resolveURL(e);const i=this,s=Nl.get(e);if(void 0!==s)return i.manager.itemStart(e),setTimeout((function(){t&&t(s),i.manager.itemEnd(e)}),0),s;const o=tr("img");function a(){c(),Nl.add(e,this),t&&t(this),i.manager.itemEnd(e)}function l(t){c(),n&&n(t),i.manager.itemError(e),i.manager.itemEnd(e)}function c(){o.removeEventListener("load",a,!1),o.removeEventListener("error",l,!1)}return o.addEventListener("load",a,!1),o.addEventListener("error",l,!1),"data:"!==e.slice(0,5)&&void 0!==this.crossOrigin&&(o.crossOrigin=this.crossOrigin),i.manager.itemStart(e),o.src=e,o}}class Hl extends Fl{constructor(e){super(e)}load(e,t,r,n){const i=new _r,s=new Vl(this.manager);return s.setCrossOrigin(this.crossOrigin),s.setPath(this.path),s.load(e,(function(e){i.image=e,i.needsUpdate=!0,void 0!==t&&t(i)}),r,n),i}}class Wl extends Sn{constructor(e,t=1){super(),this.isLight=!0,this.type="Light",this.color=new zn(e),this.intensity=t}dispose(){}copy(e,t){return super.copy(e,t),this.color.copy(e.color),this.intensity=e.intensity,this}toJSON(e){const t=super.toJSON(e);return t.object.color=this.color.getHex(),t.object.intensity=this.intensity,void 0!==this.groundColor&&(t.object.groundColor=this.groundColor.getHex()),void 0!==this.distance&&(t.object.distance=this.distance),void 0!==this.angle&&(t.object.angle=this.angle),void 0!==this.decay&&(t.object.decay=this.decay),void 0!==this.penumbra&&(t.object.penumbra=this.penumbra),void 0!==this.shadow&&(t.object.shadow=this.shadow.toJSON()),t}}const Xl=new Kr,ql=new nr,Yl=new nr;class Zl{constructor(e){this.camera=e,this.bias=0,this.normalBias=0,this.radius=1,this.blurSamples=8,this.mapSize=new Kt(512,512),this.map=null,this.mapPass=null,this.matrix=new Kr,this.autoUpdate=!0,this.needsUpdate=!1,this._frustum=new ki,this._frameExtents=new Kt(1,1),this._viewportCount=1,this._viewports=[new xr(0,0,1,1)]}getViewportCount(){return this._viewportCount}getFrustum(){return this._frustum}updateMatrices(e){const t=this.camera,r=this.matrix;ql.setFromMatrixPosition(e.matrixWorld),t.position.copy(ql),Yl.setFromMatrixPosition(e.target.matrixWorld),t.lookAt(Yl),t.updateMatrixWorld(),Xl.multiplyMatrices(t.projectionMatrix,t.matrixWorldInverse),this._frustum.setFromProjectionMatrix(Xl),r.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),r.multiply(Xl)}getViewport(e){return this._viewports[e]}getFrameExtents(){return this._frameExtents}dispose(){this.map&&this.map.dispose(),this.mapPass&&this.mapPass.dispose()}copy(e){return this.camera=e.camera.clone(),this.bias=e.bias,this.radius=e.radius,this.mapSize.copy(e.mapSize),this}clone(){return(new this.constructor).copy(this)}toJSON(){const e={};return 0!==this.bias&&(e.bias=this.bias),0!==this.normalBias&&(e.normalBias=this.normalBias),1!==this.radius&&(e.radius=this.radius),512===this.mapSize.x&&512===this.mapSize.y||(e.mapSize=this.mapSize.toArray()),e.camera=this.camera.toJSON(!1).object,delete e.camera.matrix,e}}class Jl extends Zl{constructor(){super(new Ai(50,1,.5,500)),this.isSpotLightShadow=!0,this.focus=1}updateMatrices(e){const t=this.camera,r=2*Bt*e.angle*this.focus,n=this.mapSize.width/this.mapSize.height,i=e.distance||t.far;r===t.fov&&n===t.aspect&&i===t.far||(t.fov=r,t.aspect=n,t.far=i,t.updateProjectionMatrix()),super.updateMatrices(e)}copy(e){return super.copy(e),this.focus=e.focus,this}}class Kl extends Wl{constructor(e,t,r=0,n=Math.PI/3,i=0,s=2){super(e,t),this.isSpotLight=!0,this.type="SpotLight",this.position.copy(Sn.DEFAULT_UP),this.updateMatrix(),this.target=new Sn,this.distance=r,this.angle=n,this.penumbra=i,this.decay=s,this.map=null,this.shadow=new Jl}get power(){return this.intensity*Math.PI}set power(e){this.intensity=e/Math.PI}dispose(){this.shadow.dispose()}copy(e,t){return super.copy(e,t),this.distance=e.distance,this.angle=e.angle,this.penumbra=e.penumbra,this.decay=e.decay,this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}}const Ql=new Kr,$l=new nr,ec=new nr;class tc extends Zl{constructor(){super(new Ai(90,1,.5,500)),this.isPointLightShadow=!0,this._frameExtents=new Kt(4,2),this._viewportCount=6,this._viewports=[new xr(2,1,1,1),new xr(0,1,1,1),new xr(3,1,1,1),new xr(1,1,1,1),new xr(3,0,1,1),new xr(1,0,1,1)],this._cubeDirections=[new nr(1,0,0),new nr(-1,0,0),new nr(0,0,1),new nr(0,0,-1),new nr(0,1,0),new nr(0,-1,0)],this._cubeUps=[new nr(0,1,0),new nr(0,1,0),new nr(0,1,0),new nr(0,1,0),new nr(0,0,1),new nr(0,0,-1)]}updateMatrices(e,t=0){const r=this.camera,n=this.matrix,i=e.distance||r.far;i!==r.far&&(r.far=i,r.updateProjectionMatrix()),$l.setFromMatrixPosition(e.matrixWorld),r.position.copy($l),ec.copy(r.position),ec.add(this._cubeDirections[t]),r.up.copy(this._cubeUps[t]),r.lookAt(ec),r.updateMatrixWorld(),n.makeTranslation(-$l.x,-$l.y,-$l.z),Ql.multiplyMatrices(r.projectionMatrix,r.matrixWorldInverse),this._frustum.setFromProjectionMatrix(Ql)}}class rc extends Wl{constructor(e,t,r=0,n=2){super(e,t),this.isPointLight=!0,this.type="PointLight",this.distance=r,this.decay=n,this.shadow=new tc}get power(){return 4*this.intensity*Math.PI}set power(e){this.intensity=e/(4*Math.PI)}dispose(){this.shadow.dispose()}copy(e,t){return super.copy(e,t),this.distance=e.distance,this.decay=e.decay,this.shadow=e.shadow.clone(),this}}class nc extends Zl{constructor(){super(new Qi(-5,5,5,-5,.5,500)),this.isDirectionalLightShadow=!0}}class ic extends Wl{constructor(e,t){super(e,t),this.isDirectionalLight=!0,this.type="DirectionalLight",this.position.copy(Sn.DEFAULT_UP),this.updateMatrix(),this.target=new Sn,this.shadow=new nc}dispose(){this.shadow.dispose()}copy(e){return super.copy(e),this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}}class sc extends Wl{constructor(e,t){super(e,t),this.isAmbientLight=!0,this.type="AmbientLight"}}class oc{static decodeText(e){if("undefined"!=typeof TextDecoder)return(new TextDecoder).decode(e);let t="";for(let r=0,n=e.length;r<n;r++)t+=String.fromCharCode(e[r]);try{return decodeURIComponent(escape(t))}catch(e){return t}}static extractUrlBase(e){const t=e.lastIndexOf("/");return-1===t?"./":e.slice(0,t+1)}static resolveURL(e,t){return"string"!=typeof e||""===e?"":(/^https?:\/\//i.test(t)&&/^\//.test(e)&&(t=t.replace(/(^https?:\/\/[^\/]+).*/i,"$1")),/^(https?:)?\/\//i.test(e)||/^data:.*,.*$/i.test(e)||/^blob:.*$/i.test(e)?e:t+e)}}class ac extends Fl{constructor(e){super(e),this.isImageBitmapLoader=!0,this.options={premultiplyAlpha:"none"}}setOptions(e){return this.options=e,this}load(e,t,r,n){void 0===e&&(e=""),void 0!==this.path&&(e=this.path+e),e=this.manager.resolveURL(e);const i=this,s=Nl.get(e);if(void 0!==s)return i.manager.itemStart(e),setTimeout((function(){t&&t(s),i.manager.itemEnd(e)}),0),s;const o={};o.credentials="anonymous"===this.crossOrigin?"same-origin":"include",o.headers=this.requestHeader,fetch(e,o).then((function(e){return e.blob()})).then((function(e){return createImageBitmap(e,Object.assign(i.options,{colorSpaceConversion:"none"}))})).then((function(r){Nl.add(e,r),t&&t(r),i.manager.itemEnd(e)})).catch((function(t){n&&n(t),i.manager.itemError(e),i.manager.itemEnd(e)})),i.manager.itemStart(e)}}class lc{constructor(e=!0){this.autoStart=e,this.startTime=0,this.oldTime=0,this.elapsedTime=0,this.running=!1}start(){this.startTime=cc(),this.oldTime=this.startTime,this.elapsedTime=0,this.running=!0}stop(){this.getElapsedTime(),this.running=!1,this.autoStart=!1}getElapsedTime(){return this.getDelta(),this.elapsedTime}getDelta(){let e=0;if(this.autoStart&&!this.running)return this.start(),0;if(this.running){const t=cc();e=(t-this.oldTime)/1e3,this.oldTime=t,this.elapsedTime+=e}return e}}function cc(){return("undefined"==typeof performance?Date:performance).now()}class uc{constructor(e,t,r){let n,i,s;switch(this.binding=e,this.valueSize=r,t){case"quaternion":n=this._slerp,i=this._slerpAdditive,s=this._setAdditiveIdentityQuaternion,this.buffer=new Float64Array(6*r),this._workIndex=5;break;case"string":case"bool":n=this._select,i=this._select,s=this._setAdditiveIdentityOther,this.buffer=new Array(5*r);break;default:n=this._lerp,i=this._lerpAdditive,s=this._setAdditiveIdentityNumeric,this.buffer=new Float64Array(5*r)}this._mixBufferRegion=n,this._mixBufferRegionAdditive=i,this._setIdentity=s,this._origIndex=3,this._addIndex=4,this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,this.useCount=0,this.referenceCount=0}accumulate(e,t){const r=this.buffer,n=this.valueSize,i=e*n+n;let s=this.cumulativeWeight;if(0===s){for(let e=0;e!==n;++e)r[i+e]=r[e];s=t}else{s+=t;const e=t/s;this._mixBufferRegion(r,i,0,e,n)}this.cumulativeWeight=s}accumulateAdditive(e){const t=this.buffer,r=this.valueSize,n=r*this._addIndex;0===this.cumulativeWeightAdditive&&this._setIdentity(),this._mixBufferRegionAdditive(t,n,0,e,r),this.cumulativeWeightAdditive+=e}apply(e){const t=this.valueSize,r=this.buffer,n=e*t+t,i=this.cumulativeWeight,s=this.cumulativeWeightAdditive,o=this.binding;if(this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,i<1){const e=t*this._origIndex;this._mixBufferRegion(r,n,e,1-i,t)}s>0&&this._mixBufferRegionAdditive(r,n,this._addIndex*t,1,t);for(let e=t,i=t+t;e!==i;++e)if(r[e]!==r[e+t]){o.setValue(r,n);break}}saveOriginalState(){const e=this.binding,t=this.buffer,r=this.valueSize,n=r*this._origIndex;e.getValue(t,n);for(let e=r,i=n;e!==i;++e)t[e]=t[n+e%r];this._setIdentity(),this.cumulativeWeight=0,this.cumulativeWeightAdditive=0}restoreOriginalState(){const e=3*this.valueSize;this.binding.setValue(this.buffer,e)}_setAdditiveIdentityNumeric(){const e=this._addIndex*this.valueSize,t=e+this.valueSize;for(let r=e;r<t;r++)this.buffer[r]=0}_setAdditiveIdentityQuaternion(){this._setAdditiveIdentityNumeric(),this.buffer[this._addIndex*this.valueSize+3]=1}_setAdditiveIdentityOther(){const e=this._origIndex*this.valueSize,t=this._addIndex*this.valueSize;for(let r=0;r<this.valueSize;r++)this.buffer[t+r]=this.buffer[e+r]}_select(e,t,r,n,i){if(n>=.5)for(let n=0;n!==i;++n)e[t+n]=e[r+n]}_slerp(e,t,r,n){rr.slerpFlat(e,t,e,t,e,r,n)}_slerpAdditive(e,t,r,n,i){const s=this._workIndex*i;rr.multiplyQuaternionsFlat(e,s,e,t,e,r),rr.slerpFlat(e,t,e,t,e,s,n)}_lerp(e,t,r,n,i){const s=1-n;for(let o=0;o!==i;++o){const i=t+o;e[i]=e[i]*s+e[r+o]*n}}_lerpAdditive(e,t,r,n,i){for(let s=0;s!==i;++s){const i=t+s;e[i]=e[i]+e[r+s]*n}}}const hc="\\[\\]\\.:\\/",dc=new RegExp("["+hc+"]","g"),pc="[^"+hc+"]",fc="[^"+hc.replace("\\.","")+"]",mc=new RegExp("^"+/((?:WC+[\/:])*)/.source.replace("WC",pc)+/(WCOD+)?/.source.replace("WCOD",fc)+/(?:\.(WC+)(?:\[(.+)\])?)?/.source.replace("WC",pc)+/\.(WC+)(?:\[(.+)\])?/.source.replace("WC",pc)+"$"),gc=["material","materials","bones","map"];class yc{constructor(e,t,r){this.path=t,this.parsedPath=r||yc.parseTrackName(t),this.node=yc.findNode(e,this.parsedPath.nodeName),this.rootNode=e,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}static create(e,t,r){return e&&e.isAnimationObjectGroup?new yc.Composite(e,t,r):new yc(e,t,r)}static sanitizeNodeName(e){return e.replace(/\s/g,"_").replace(dc,"")}static parseTrackName(e){const t=mc.exec(e);if(null===t)throw new Error("PropertyBinding: Cannot parse trackName: "+e);const r={nodeName:t[2],objectName:t[3],objectIndex:t[4],propertyName:t[5],propertyIndex:t[6]},n=r.nodeName&&r.nodeName.lastIndexOf(".");if(void 0!==n&&-1!==n){const e=r.nodeName.substring(n+1);-1!==gc.indexOf(e)&&(r.nodeName=r.nodeName.substring(0,n),r.objectName=e)}if(null===r.propertyName||0===r.propertyName.length)throw new Error("PropertyBinding: can not parse propertyName from trackName: "+e);return r}static findNode(e,t){if(void 0===t||""===t||"."===t||-1===t||t===e.name||t===e.uuid)return e;if(e.skeleton){const r=e.skeleton.getBoneByName(t);if(void 0!==r)return r}if(e.children){const r=function(e){for(let n=0;n<e.length;n++){const i=e[n];if(i.name===t||i.uuid===t)return i;const s=r(i.children);if(s)return s}return null},n=r(e.children);if(n)return n}return null}_getValue_unavailable(){}_setValue_unavailable(){}_getValue_direct(e,t){e[t]=this.targetObject[this.propertyName]}_getValue_array(e,t){const r=this.resolvedProperty;for(let n=0,i=r.length;n!==i;++n)e[t++]=r[n]}_getValue_arrayElement(e,t){e[t]=this.resolvedProperty[this.propertyIndex]}_getValue_toArray(e,t){this.resolvedProperty.toArray(e,t)}_setValue_direct(e,t){this.targetObject[this.propertyName]=e[t]}_setValue_direct_setNeedsUpdate(e,t){this.targetObject[this.propertyName]=e[t],this.targetObject.needsUpdate=!0}_setValue_direct_setMatrixWorldNeedsUpdate(e,t){this.targetObject[this.propertyName]=e[t],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_array(e,t){const r=this.resolvedProperty;for(let n=0,i=r.length;n!==i;++n)r[n]=e[t++]}_setValue_array_setNeedsUpdate(e,t){const r=this.resolvedProperty;for(let n=0,i=r.length;n!==i;++n)r[n]=e[t++];this.targetObject.needsUpdate=!0}_setValue_array_setMatrixWorldNeedsUpdate(e,t){const r=this.resolvedProperty;for(let n=0,i=r.length;n!==i;++n)r[n]=e[t++];this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_arrayElement(e,t){this.resolvedProperty[this.propertyIndex]=e[t]}_setValue_arrayElement_setNeedsUpdate(e,t){this.resolvedProperty[this.propertyIndex]=e[t],this.targetObject.needsUpdate=!0}_setValue_arrayElement_setMatrixWorldNeedsUpdate(e,t){this.resolvedProperty[this.propertyIndex]=e[t],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_fromArray(e,t){this.resolvedProperty.fromArray(e,t)}_setValue_fromArray_setNeedsUpdate(e,t){this.resolvedProperty.fromArray(e,t),this.targetObject.needsUpdate=!0}_setValue_fromArray_setMatrixWorldNeedsUpdate(e,t){this.resolvedProperty.fromArray(e,t),this.targetObject.matrixWorldNeedsUpdate=!0}_getValue_unbound(e,t){this.bind(),this.getValue(e,t)}_setValue_unbound(e,t){this.bind(),this.setValue(e,t)}bind(){let e=this.node;const t=this.parsedPath,r=t.objectName,n=t.propertyName;let i=t.propertyIndex;if(e||(e=yc.findNode(this.rootNode,t.nodeName),this.node=e),this.getValue=this._getValue_unavailable,this.setValue=this._setValue_unavailable,!e)return;if(r){let n=t.objectIndex;switch(r){case"materials":if(!e.material)return;if(!e.material.materials)return;e=e.material.materials;break;case"bones":if(!e.skeleton)return;e=e.skeleton.bones;for(let t=0;t<e.length;t++)if(e[t].name===n){n=t;break}break;case"map":if("map"in e){e=e.map;break}if(!e.material)return;if(!e.material.map)return;e=e.material.map;break;default:if(void 0===e[r])return;e=e[r]}if(void 0!==n){if(void 0===e[n])return;e=e[n]}}const s=e[n];if(void 0===s){t.nodeName;return}let o=this.Versioning.None;this.targetObject=e,void 0!==e.needsUpdate?o=this.Versioning.NeedsUpdate:void 0!==e.matrixWorldNeedsUpdate&&(o=this.Versioning.MatrixWorldNeedsUpdate);let a=this.BindingType.Direct;if(void 0!==i){if("morphTargetInfluences"===n){if(!e.geometry)return;if(!e.geometry.morphAttributes)return;void 0!==e.morphTargetDictionary[i]&&(i=e.morphTargetDictionary[i])}a=this.BindingType.ArrayElement,this.resolvedProperty=s,this.propertyIndex=i}else void 0!==s.fromArray&&void 0!==s.toArray?(a=this.BindingType.HasFromToArray,this.resolvedProperty=s):Array.isArray(s)?(a=this.BindingType.EntireArray,this.resolvedProperty=s):this.propertyName=n;this.getValue=this.GetterByBindingType[a],this.setValue=this.SetterByBindingTypeAndVersioning[a][o]}unbind(){this.node=null,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}}yc.Composite=class{constructor(e,t,r){const n=r||yc.parseTrackName(t);this._targetGroup=e,this._bindings=e.subscribe_(t,n)}getValue(e,t){this.bind();const r=this._targetGroup.nCachedObjects_,n=this._bindings[r];void 0!==n&&n.getValue(e,t)}setValue(e,t){const r=this._bindings;for(let n=this._targetGroup.nCachedObjects_,i=r.length;n!==i;++n)r[n].setValue(e,t)}bind(){const e=this._bindings;for(let t=this._targetGroup.nCachedObjects_,r=e.length;t!==r;++t)e[t].bind()}unbind(){const e=this._bindings;for(let t=this._targetGroup.nCachedObjects_,r=e.length;t!==r;++t)e[t].unbind()}},yc.prototype.BindingType={Direct:0,EntireArray:1,ArrayElement:2,HasFromToArray:3},yc.prototype.Versioning={None:0,NeedsUpdate:1,MatrixWorldNeedsUpdate:2},yc.prototype.GetterByBindingType=[yc.prototype._getValue_direct,yc.prototype._getValue_array,yc.prototype._getValue_arrayElement,yc.prototype._getValue_toArray],yc.prototype.SetterByBindingTypeAndVersioning=[[yc.prototype._setValue_direct,yc.prototype._setValue_direct_setNeedsUpdate,yc.prototype._setValue_direct_setMatrixWorldNeedsUpdate],[yc.prototype._setValue_array,yc.prototype._setValue_array_setNeedsUpdate,yc.prototype._setValue_array_setMatrixWorldNeedsUpdate],[yc.prototype._setValue_arrayElement,yc.prototype._setValue_arrayElement_setNeedsUpdate,yc.prototype._setValue_arrayElement_setMatrixWorldNeedsUpdate],[yc.prototype._setValue_fromArray,yc.prototype._setValue_fromArray_setNeedsUpdate,yc.prototype._setValue_fromArray_setMatrixWorldNeedsUpdate]];class vc{constructor(e,t,r=null,n=t.blendMode){this._mixer=e,this._clip=t,this._localRoot=r,this.blendMode=n;const i=t.tracks,s=i.length,o=new Array(s),a={endingStart:gt,endingEnd:gt};for(let e=0;e!==s;++e){const t=i[e].createInterpolant(null);o[e]=t,t.settings=a}this._interpolantSettings=a,this._interpolants=o,this._propertyBindings=new Array(s),this._cacheIndex=null,this._byClipCacheIndex=null,this._timeScaleInterpolant=null,this._weightInterpolant=null,this.loop=2201,this._loopCount=-1,this._startTime=null,this.time=0,this.timeScale=1,this._effectiveTimeScale=1,this.weight=1,this._effectiveWeight=1,this.repetitions=1/0,this.paused=!1,this.enabled=!0,this.clampWhenFinished=!1,this.zeroSlopeAtStart=!0,this.zeroSlopeAtEnd=!0}play(){return this._mixer._activateAction(this),this}stop(){return this._mixer._deactivateAction(this),this.reset()}reset(){return this.paused=!1,this.enabled=!0,this.time=0,this._loopCount=-1,this._startTime=null,this.stopFading().stopWarping()}isRunning(){return this.enabled&&!this.paused&&0!==this.timeScale&&null===this._startTime&&this._mixer._isActiveAction(this)}isScheduled(){return this._mixer._isActiveAction(this)}startAt(e){return this._startTime=e,this}setLoop(e,t){return this.loop=e,this.repetitions=t,this}setEffectiveWeight(e){return this.weight=e,this._effectiveWeight=this.enabled?e:0,this.stopFading()}getEffectiveWeight(){return this._effectiveWeight}fadeIn(e){return this._scheduleFading(e,0,1)}fadeOut(e){return this._scheduleFading(e,1,0)}crossFadeFrom(e,t,r){if(e.fadeOut(t),this.fadeIn(t),r){const r=this._clip.duration,n=e._clip.duration,i=n/r,s=r/n;e.warp(1,i,t),this.warp(s,1,t)}return this}crossFadeTo(e,t,r){return e.crossFadeFrom(this,t,r)}stopFading(){const e=this._weightInterpolant;return null!==e&&(this._weightInterpolant=null,this._mixer._takeBackControlInterpolant(e)),this}setEffectiveTimeScale(e){return this.timeScale=e,this._effectiveTimeScale=this.paused?0:e,this.stopWarping()}getEffectiveTimeScale(){return this._effectiveTimeScale}setDuration(e){return this.timeScale=this._clip.duration/e,this.stopWarping()}syncWith(e){return this.time=e.time,this.timeScale=e.timeScale,this.stopWarping()}halt(e){return this.warp(this._effectiveTimeScale,0,e)}warp(e,t,r){const n=this._mixer,i=n.time,s=this.timeScale;let o=this._timeScaleInterpolant;null===o&&(o=n._lendControlInterpolant(),this._timeScaleInterpolant=o);const a=o.parameterPositions,l=o.sampleValues;return a[0]=i,a[1]=i+r,l[0]=e/s,l[1]=t/s,this}stopWarping(){const e=this._timeScaleInterpolant;return null!==e&&(this._timeScaleInterpolant=null,this._mixer._takeBackControlInterpolant(e)),this}getMixer(){return this._mixer}getClip(){return this._clip}getRoot(){return this._localRoot||this._mixer._root}_update(e,t,r,n){if(!this.enabled)return void this._updateWeight(e);const i=this._startTime;if(null!==i){const n=(e-i)*r;n<0||0===r?t=0:(this._startTime=null,t=r*n)}t*=this._updateTimeScale(e);const s=this._updateTime(t),o=this._updateWeight(e);if(o>0){const e=this._interpolants,t=this._propertyBindings;if(this.blendMode===xt)for(let r=0,n=e.length;r!==n;++r)e[r].evaluate(s),t[r].accumulateAdditive(o);else for(let r=0,i=e.length;r!==i;++r)e[r].evaluate(s),t[r].accumulate(n,o)}}_updateWeight(e){let t=0;if(this.enabled){t=this.weight;const r=this._weightInterpolant;if(null!==r){const n=r.evaluate(e)[0];t*=n,e>r.parameterPositions[1]&&(this.stopFading(),0===n&&(this.enabled=!1))}}return this._effectiveWeight=t,t}_updateTimeScale(e){let t=0;if(!this.paused){t=this.timeScale;const r=this._timeScaleInterpolant;if(null!==r){t*=r.evaluate(e)[0],e>r.parameterPositions[1]&&(this.stopWarping(),0===t?this.paused=!0:this.timeScale=t)}}return this._effectiveTimeScale=t,t}_updateTime(e){const t=this._clip.duration,r=this.loop;let n=this.time+e,i=this._loopCount;const s=2202===r;if(0===e)return-1===i?n:s&&1==(1&i)?t-n:n;if(r===dt){-1===i&&(this._loopCount=0,this._setEndings(!0,!0,!1));e:{if(n>=t)n=t;else{if(!(n<0)){this.time=n;break e}n=0}this.clampWhenFinished?this.paused=!0:this.enabled=!1,this.time=n,this._mixer.dispatchEvent({type:"finished",action:this,direction:e<0?-1:1})}}else{if(-1===i&&(e>=0?(i=0,this._setEndings(!0,0===this.repetitions,s)):this._setEndings(0===this.repetitions,!0,s)),n>=t||n<0){const r=Math.floor(n/t);n-=t*r,i+=Math.abs(r);const o=this.repetitions-i;if(o<=0)this.clampWhenFinished?this.paused=!0:this.enabled=!1,n=e>0?t:0,this.time=n,this._mixer.dispatchEvent({type:"finished",action:this,direction:e>0?1:-1});else{if(1===o){const t=e<0;this._setEndings(t,!t,s)}else this._setEndings(!1,!1,s);this._loopCount=i,this.time=n,this._mixer.dispatchEvent({type:"loop",action:this,loopDelta:r})}}else this.time=n;if(s&&1==(1&i))return t-n}return n}_setEndings(e,t,r){const n=this._interpolantSettings;r?(n.endingStart=yt,n.endingEnd=yt):(n.endingStart=e?this.zeroSlopeAtStart?yt:gt:vt,n.endingEnd=t?this.zeroSlopeAtEnd?yt:gt:vt)}_scheduleFading(e,t,r){const n=this._mixer,i=n.time;let s=this._weightInterpolant;null===s&&(s=n._lendControlInterpolant(),this._weightInterpolant=s);const o=s.parameterPositions,a=s.sampleValues;return o[0]=i,a[0]=t,o[1]=i+e,a[1]=r,this}}const _c=new Float32Array(1);class xc extends Nt{constructor(e){super(),this._root=e,this._initMemoryManager(),this._accuIndex=0,this.time=0,this.timeScale=1}_bindAction(e,t){const r=e._localRoot||this._root,n=e._clip.tracks,i=n.length,s=e._propertyBindings,o=e._interpolants,a=r.uuid,l=this._bindingsByRootAndName;let c=l[a];void 0===c&&(c={},l[a]=c);for(let e=0;e!==i;++e){const i=n[e],l=i.name;let u=c[l];if(void 0!==u)++u.referenceCount,s[e]=u;else{if(u=s[e],void 0!==u){null===u._cacheIndex&&(++u.referenceCount,this._addInactiveBinding(u,a,l));continue}const n=t&&t._propertyBindings[e].binding.parsedPath;u=new uc(yc.create(r,l,n),i.ValueTypeName,i.getValueSize()),++u.referenceCount,this._addInactiveBinding(u,a,l),s[e]=u}o[e].resultBuffer=u.buffer}}_activateAction(e){if(!this._isActiveAction(e)){if(null===e._cacheIndex){const t=(e._localRoot||this._root).uuid,r=e._clip.uuid,n=this._actionsByClip[r];this._bindAction(e,n&&n.knownActions[0]),this._addInactiveAction(e,r,t)}const t=e._propertyBindings;for(let e=0,r=t.length;e!==r;++e){const r=t[e];0==r.useCount++&&(this._lendBinding(r),r.saveOriginalState())}this._lendAction(e)}}_deactivateAction(e){if(this._isActiveAction(e)){const t=e._propertyBindings;for(let e=0,r=t.length;e!==r;++e){const r=t[e];0==--r.useCount&&(r.restoreOriginalState(),this._takeBackBinding(r))}this._takeBackAction(e)}}_initMemoryManager(){this._actions=[],this._nActiveActions=0,this._actionsByClip={},this._bindings=[],this._nActiveBindings=0,this._bindingsByRootAndName={},this._controlInterpolants=[],this._nActiveControlInterpolants=0;const e=this;this.stats={actions:{get total(){return e._actions.length},get inUse(){return e._nActiveActions}},bindings:{get total(){return e._bindings.length},get inUse(){return e._nActiveBindings}},controlInterpolants:{get total(){return e._controlInterpolants.length},get inUse(){return e._nActiveControlInterpolants}}}}_isActiveAction(e){const t=e._cacheIndex;return null!==t&&t<this._nActiveActions}_addInactiveAction(e,t,r){const n=this._actions,i=this._actionsByClip;let s=i[t];if(void 0===s)s={knownActions:[e],actionByRoot:{}},e._byClipCacheIndex=0,i[t]=s;else{const t=s.knownActions;e._byClipCacheIndex=t.length,t.push(e)}e._cacheIndex=n.length,n.push(e),s.actionByRoot[r]=e}_removeInactiveAction(e){const t=this._actions,r=t[t.length-1],n=e._cacheIndex;r._cacheIndex=n,t[n]=r,t.pop(),e._cacheIndex=null;const i=e._clip.uuid,s=this._actionsByClip,o=s[i],a=o.knownActions,l=a[a.length-1],c=e._byClipCacheIndex;l._byClipCacheIndex=c,a[c]=l,a.pop(),e._byClipCacheIndex=null;delete o.actionByRoot[(e._localRoot||this._root).uuid],0===a.length&&delete s[i],this._removeInactiveBindingsForAction(e)}_removeInactiveBindingsForAction(e){const t=e._propertyBindings;for(let e=0,r=t.length;e!==r;++e){const r=t[e];0==--r.referenceCount&&this._removeInactiveBinding(r)}}_lendAction(e){const t=this._actions,r=e._cacheIndex,n=this._nActiveActions++,i=t[n];e._cacheIndex=n,t[n]=e,i._cacheIndex=r,t[r]=i}_takeBackAction(e){const t=this._actions,r=e._cacheIndex,n=--this._nActiveActions,i=t[n];e._cacheIndex=n,t[n]=e,i._cacheIndex=r,t[r]=i}_addInactiveBinding(e,t,r){const n=this._bindingsByRootAndName,i=this._bindings;let s=n[t];void 0===s&&(s={},n[t]=s),s[r]=e,e._cacheIndex=i.length,i.push(e)}_removeInactiveBinding(e){const t=this._bindings,r=e.binding,n=r.rootNode.uuid,i=r.path,s=this._bindingsByRootAndName,o=s[n],a=t[t.length-1],l=e._cacheIndex;a._cacheIndex=l,t[l]=a,t.pop(),delete o[i],0===Object.keys(o).length&&delete s[n]}_lendBinding(e){const t=this._bindings,r=e._cacheIndex,n=this._nActiveBindings++,i=t[n];e._cacheIndex=n,t[n]=e,i._cacheIndex=r,t[r]=i}_takeBackBinding(e){const t=this._bindings,r=e._cacheIndex,n=--this._nActiveBindings,i=t[n];e._cacheIndex=n,t[n]=e,i._cacheIndex=r,t[r]=i}_lendControlInterpolant(){const e=this._controlInterpolants,t=this._nActiveControlInterpolants++;let r=e[t];return void 0===r&&(r=new Ml(new Float32Array(2),new Float32Array(2),1,_c),r.__cacheIndex=t,e[t]=r),r}_takeBackControlInterpolant(e){const t=this._controlInterpolants,r=e.__cacheIndex,n=--this._nActiveControlInterpolants,i=t[n];e.__cacheIndex=n,t[n]=e,i.__cacheIndex=r,t[r]=i}clipAction(e,t,r){const n=t||this._root,i=n.uuid;let s="string"==typeof e?Dl.findByName(n,e):e;const o=null!==s?s.uuid:e,a=this._actionsByClip[o];let l=null;if(void 0===r&&(r=null!==s?s.blendMode:_t),void 0!==a){const e=a.actionByRoot[i];if(void 0!==e&&e.blendMode===r)return e;l=a.knownActions[0],null===s&&(s=l._clip)}if(null===s)return null;const c=new vc(this,s,t,r);return this._bindAction(c,l),this._addInactiveAction(c,o,i),c}existingAction(e,t){const r=t||this._root,n=r.uuid,i="string"==typeof e?Dl.findByName(r,e):e,s=i?i.uuid:e,o=this._actionsByClip[s];return void 0!==o&&o.actionByRoot[n]||null}stopAllAction(){const e=this._actions;for(let t=this._nActiveActions-1;t>=0;--t)e[t].stop();return this}update(e){e*=this.timeScale;const t=this._actions,r=this._nActiveActions,n=this.time+=e,i=Math.sign(e),s=this._accuIndex^=1;for(let o=0;o!==r;++o){t[o]._update(n,e,i,s)}const o=this._bindings,a=this._nActiveBindings;for(let e=0;e!==a;++e)o[e].apply(s);return this}setTime(e){this.time=0;for(let e=0;e<this._actions.length;e++)this._actions[e].time=0;return this.update(e)}getRoot(){return this._root}uncacheClip(e){const t=this._actions,r=e.uuid,n=this._actionsByClip,i=n[r];if(void 0!==i){const e=i.knownActions;for(let r=0,n=e.length;r!==n;++r){const n=e[r];this._deactivateAction(n);const i=n._cacheIndex,s=t[t.length-1];n._cacheIndex=null,n._byClipCacheIndex=null,s._cacheIndex=i,t[i]=s,t.pop(),this._removeInactiveBindingsForAction(n)}delete n[r]}}uncacheRoot(e){const t=e.uuid,r=this._actionsByClip;for(const e in r){const n=r[e].actionByRoot[t];void 0!==n&&(this._deactivateAction(n),this._removeInactiveAction(n))}const n=this._bindingsByRootAndName[t];if(void 0!==n)for(const e in n){const t=n[e];t.restoreOriginalState(),this._removeInactiveBinding(t)}}uncacheAction(e,t){const r=this.existingAction(e,t);null!==r&&(this._deactivateAction(r),this._removeInactiveAction(r))}}class bc{constructor(e,t,r=0,n=1/0){this.ray=new Jr(e,t),this.near=r,this.far=n,this.camera=null,this.layers=new cn,this.params={Mesh:{},Line:{threshold:1},LOD:{},Points:{threshold:1},Sprite:{}}}set(e,t){this.ray.set(e,t)}setFromCamera(e,t){t.isPerspectiveCamera?(this.ray.origin.setFromMatrixPosition(t.matrixWorld),this.ray.direction.set(e.x,e.y,.5).unproject(t).sub(this.ray.origin).normalize(),this.camera=t):t.isOrthographicCamera&&(this.ray.origin.set(e.x,e.y,(t.near+t.far)/(t.near-t.far)).unproject(t),this.ray.direction.set(0,0,-1).transformDirection(t.matrixWorld),this.camera=t)}intersectObject(e,t=!0,r=[]){return Sc(e,this,r,t),r.sort(wc),r}intersectObjects(e,t=!0,r=[]){for(let n=0,i=e.length;n<i;n++)Sc(e[n],this,r,t);return r.sort(wc),r}}function wc(e,t){return e.distance-t.distance}function Sc(e,t,r,n){if(e.layers.test(t.layers)&&e.raycast(t,r),!0===n){const n=e.children;for(let e=0,i=n.length;e<i;e++)Sc(n[e],t,r,!0)}}class Mc{constructor(e=1,t=0,r=0){return this.radius=e,this.phi=t,this.theta=r,this}set(e,t,r){return this.radius=e,this.phi=t,this.theta=r,this}copy(e){return this.radius=e.radius,this.phi=e.phi,this.theta=e.theta,this}makeSafe(){const e=1e-6;return this.phi=Math.max(e,Math.min(Math.PI-e,this.phi)),this}setFromVector3(e){return this.setFromCartesianCoords(e.x,e.y,e.z)}setFromCartesianCoords(e,t,r){return this.radius=Math.sqrt(e*e+t*t+r*r),0===this.radius?(this.theta=0,this.phi=0):(this.theta=Math.atan2(e,r),this.phi=Math.acos(Gt(t/this.radius,-1,1))),this}clone(){return(new this.constructor).copy(this)}}"undefined"!=typeof __THREE_DEVTOOLS__&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("register",{detail:{revision:n}})),"undefined"!=typeof window&&(window.__THREE__||(window.__THREE__=n))},8012:(e,t,r)=>{"use strict";r.d(t,{z:()=>a});var n=r(6075);const i={type:"change"},s={type:"start"},o={type:"end"};class a extends n.pBf{constructor(e,t){super(),this.object=e,this.domElement=t,this.domElement.style.touchAction="none",this.enabled=!0,this.target=new n.Pa4,this.minDistance=0,this.maxDistance=1/0,this.minZoom=0,this.maxZoom=1/0,this.minPolarAngle=0,this.maxPolarAngle=Math.PI,this.minAzimuthAngle=-1/0,this.maxAzimuthAngle=1/0,this.enableDamping=!1,this.dampingFactor=.05,this.enableZoom=!0,this.zoomSpeed=1,this.enableRotate=!0,this.rotateSpeed=1,this.enablePan=!0,this.panSpeed=1,this.screenSpacePanning=!0,this.keyPanSpeed=7,this.autoRotate=!1,this.autoRotateSpeed=2,this.keys={LEFT:"ArrowLeft",UP:"ArrowUp",RIGHT:"ArrowRight",BOTTOM:"ArrowDown"},this.mouseButtons={LEFT:n.RsA.ROTATE,MIDDLE:n.RsA.DOLLY,RIGHT:n.RsA.PAN},this.touches={ONE:n.QmN.ROTATE,TWO:n.QmN.DOLLY_PAN},this.target0=this.target.clone(),this.position0=this.object.position.clone(),this.zoom0=this.object.zoom,this._domElementKeyEvents=null,this.getPolarAngle=function(){return u.phi},this.getAzimuthalAngle=function(){return u.theta},this.getDistance=function(){return this.object.position.distanceTo(this.target)},this.listenToKeyEvents=function(e){e.addEventListener("keydown",q),this._domElementKeyEvents=e},this.stopListenToKeyEvents=function(){this._domElementKeyEvents.removeEventListener("keydown",q),this._domElementKeyEvents=null},this.saveState=function(){r.target0.copy(r.target),r.position0.copy(r.object.position),r.zoom0=r.object.zoom},this.reset=function(){r.target.copy(r.target0),r.object.position.copy(r.position0),r.object.zoom=r.zoom0,r.object.updateProjectionMatrix(),r.dispatchEvent(i),r.update(),l=a.NONE},this.update=function(){const t=new n.Pa4,s=(new n._fP).setFromUnitVectors(e.up,new n.Pa4(0,1,0)),o=s.clone().invert(),m=new n.Pa4,g=new n._fP,y=2*Math.PI;return function(){const e=r.object.position;t.copy(e).sub(r.target),t.applyQuaternion(s),u.setFromVector3(t),r.autoRotate&&l===a.NONE&&A(2*Math.PI/60/60*r.autoRotateSpeed),r.enableDamping?(u.theta+=h.theta*r.dampingFactor,u.phi+=h.phi*r.dampingFactor):(u.theta+=h.theta,u.phi+=h.phi);let n=r.minAzimuthAngle,v=r.maxAzimuthAngle;return isFinite(n)&&isFinite(v)&&(n<-Math.PI?n+=y:n>Math.PI&&(n-=y),v<-Math.PI?v+=y:v>Math.PI&&(v-=y),u.theta=n<=v?Math.max(n,Math.min(v,u.theta)):u.theta>(n+v)/2?Math.max(n,u.theta):Math.min(v,u.theta)),u.phi=Math.max(r.minPolarAngle,Math.min(r.maxPolarAngle,u.phi)),u.makeSafe(),u.radius*=d,u.radius=Math.max(r.minDistance,Math.min(r.maxDistance,u.radius)),!0===r.enableDamping?r.target.addScaledVector(p,r.dampingFactor):r.target.add(p),t.setFromSpherical(u),t.applyQuaternion(o),e.copy(r.target).add(t),r.object.lookAt(r.target),!0===r.enableDamping?(h.theta*=1-r.dampingFactor,h.phi*=1-r.dampingFactor,p.multiplyScalar(1-r.dampingFactor)):(h.set(0,0,0),p.set(0,0,0)),d=1,!!(f||m.distanceToSquared(r.object.position)>c||8*(1-g.dot(r.object.quaternion))>c)&&(r.dispatchEvent(i),m.copy(r.object.position),g.copy(r.object.quaternion),f=!1,!0)}}(),this.dispose=function(){r.domElement.removeEventListener("contextmenu",Y),r.domElement.removeEventListener("pointerdown",G),r.domElement.removeEventListener("pointercancel",W),r.domElement.removeEventListener("wheel",X),r.domElement.removeEventListener("pointermove",V),r.domElement.removeEventListener("pointerup",H),null!==r._domElementKeyEvents&&(r._domElementKeyEvents.removeEventListener("keydown",q),r._domElementKeyEvents=null)};const r=this,a={NONE:-1,ROTATE:0,DOLLY:1,PAN:2,TOUCH_ROTATE:3,TOUCH_PAN:4,TOUCH_DOLLY_PAN:5,TOUCH_DOLLY_ROTATE:6};let l=a.NONE;const c=1e-6,u=new n.$V,h=new n.$V;let d=1;const p=new n.Pa4;let f=!1;const m=new n.FM8,g=new n.FM8,y=new n.FM8,v=new n.FM8,_=new n.FM8,x=new n.FM8,b=new n.FM8,w=new n.FM8,S=new n.FM8,M=[],T={};function E(){return Math.pow(.95,r.zoomSpeed)}function A(e){h.theta-=e}function C(e){h.phi-=e}const L=function(){const e=new n.Pa4;return function(t,r){e.setFromMatrixColumn(r,0),e.multiplyScalar(-t),p.add(e)}}(),R=function(){const e=new n.Pa4;return function(t,n){!0===r.screenSpacePanning?e.setFromMatrixColumn(n,1):(e.setFromMatrixColumn(n,0),e.crossVectors(r.object.up,e)),e.multiplyScalar(t),p.add(e)}}(),P=function(){const e=new n.Pa4;return function(t,n){const i=r.domElement;if(r.object.isPerspectiveCamera){const s=r.object.position;e.copy(s).sub(r.target);let o=e.length();o*=Math.tan(r.object.fov/2*Math.PI/180),L(2*t*o/i.clientHeight,r.object.matrix),R(2*n*o/i.clientHeight,r.object.matrix)}else r.object.isOrthographicCamera?(L(t*(r.object.right-r.object.left)/r.object.zoom/i.clientWidth,r.object.matrix),R(n*(r.object.top-r.object.bottom)/r.object.zoom/i.clientHeight,r.object.matrix)):r.enablePan=!1}}();function j(e){r.object.isPerspectiveCamera?d/=e:r.object.isOrthographicCamera?(r.object.zoom=Math.max(r.minZoom,Math.min(r.maxZoom,r.object.zoom*e)),r.object.updateProjectionMatrix(),f=!0):r.enableZoom=!1}function I(e){r.object.isPerspectiveCamera?d*=e:r.object.isOrthographicCamera?(r.object.zoom=Math.max(r.minZoom,Math.min(r.maxZoom,r.object.zoom/e)),r.object.updateProjectionMatrix(),f=!0):r.enableZoom=!1}function D(e){m.set(e.clientX,e.clientY)}function O(e){v.set(e.clientX,e.clientY)}function N(){if(1===M.length)m.set(M[0].pageX,M[0].pageY);else{const e=.5*(M[0].pageX+M[1].pageX),t=.5*(M[0].pageY+M[1].pageY);m.set(e,t)}}function U(){if(1===M.length)v.set(M[0].pageX,M[0].pageY);else{const e=.5*(M[0].pageX+M[1].pageX),t=.5*(M[0].pageY+M[1].pageY);v.set(e,t)}}function k(){const e=M[0].pageX-M[1].pageX,t=M[0].pageY-M[1].pageY,r=Math.sqrt(e*e+t*t);b.set(0,r)}function F(e){if(1==M.length)g.set(e.pageX,e.pageY);else{const t=K(e),r=.5*(e.pageX+t.x),n=.5*(e.pageY+t.y);g.set(r,n)}y.subVectors(g,m).multiplyScalar(r.rotateSpeed);const t=r.domElement;A(2*Math.PI*y.x/t.clientHeight),C(2*Math.PI*y.y/t.clientHeight),m.copy(g)}function B(e){if(1===M.length)_.set(e.pageX,e.pageY);else{const t=K(e),r=.5*(e.pageX+t.x),n=.5*(e.pageY+t.y);_.set(r,n)}x.subVectors(_,v).multiplyScalar(r.panSpeed),P(x.x,x.y),v.copy(_)}function z(e){const t=K(e),n=e.pageX-t.x,i=e.pageY-t.y,s=Math.sqrt(n*n+i*i);w.set(0,s),S.set(0,Math.pow(w.y/b.y,r.zoomSpeed)),j(S.y),b.copy(w)}function G(e){!1!==r.enabled&&(0===M.length&&(r.domElement.setPointerCapture(e.pointerId),r.domElement.addEventListener("pointermove",V),r.domElement.addEventListener("pointerup",H)),function(e){M.push(e)}(e),"touch"===e.pointerType?function(e){switch(J(e),M.length){case 1:switch(r.touches.ONE){case n.QmN.ROTATE:if(!1===r.enableRotate)return;N(),l=a.TOUCH_ROTATE;break;case n.QmN.PAN:if(!1===r.enablePan)return;U(),l=a.TOUCH_PAN;break;default:l=a.NONE}break;case 2:switch(r.touches.TWO){case n.QmN.DOLLY_PAN:if(!1===r.enableZoom&&!1===r.enablePan)return;r.enableZoom&&k(),r.enablePan&&U(),l=a.TOUCH_DOLLY_PAN;break;case n.QmN.DOLLY_ROTATE:if(!1===r.enableZoom&&!1===r.enableRotate)return;r.enableZoom&&k(),r.enableRotate&&N(),l=a.TOUCH_DOLLY_ROTATE;break;default:l=a.NONE}break;default:l=a.NONE}l!==a.NONE&&r.dispatchEvent(s)}(e):function(e){let t;switch(e.button){case 0:t=r.mouseButtons.LEFT;break;case 1:t=r.mouseButtons.MIDDLE;break;case 2:t=r.mouseButtons.RIGHT;break;default:t=-1}switch(t){case n.RsA.DOLLY:if(!1===r.enableZoom)return;!function(e){b.set(e.clientX,e.clientY)}(e),l=a.DOLLY;break;case n.RsA.ROTATE:if(e.ctrlKey||e.metaKey||e.shiftKey){if(!1===r.enablePan)return;O(e),l=a.PAN}else{if(!1===r.enableRotate)return;D(e),l=a.ROTATE}break;case n.RsA.PAN:if(e.ctrlKey||e.metaKey||e.shiftKey){if(!1===r.enableRotate)return;D(e),l=a.ROTATE}else{if(!1===r.enablePan)return;O(e),l=a.PAN}break;default:l=a.NONE}l!==a.NONE&&r.dispatchEvent(s)}(e))}function V(e){!1!==r.enabled&&("touch"===e.pointerType?function(e){switch(J(e),l){case a.TOUCH_ROTATE:if(!1===r.enableRotate)return;F(e),r.update();break;case a.TOUCH_PAN:if(!1===r.enablePan)return;B(e),r.update();break;case a.TOUCH_DOLLY_PAN:if(!1===r.enableZoom&&!1===r.enablePan)return;!function(e){r.enableZoom&&z(e),r.enablePan&&B(e)}(e),r.update();break;case a.TOUCH_DOLLY_ROTATE:if(!1===r.enableZoom&&!1===r.enableRotate)return;!function(e){r.enableZoom&&z(e),r.enableRotate&&F(e)}(e),r.update();break;default:l=a.NONE}}(e):function(e){switch(l){case a.ROTATE:if(!1===r.enableRotate)return;!function(e){g.set(e.clientX,e.clientY),y.subVectors(g,m).multiplyScalar(r.rotateSpeed);const t=r.domElement;A(2*Math.PI*y.x/t.clientHeight),C(2*Math.PI*y.y/t.clientHeight),m.copy(g),r.update()}(e);break;case a.DOLLY:if(!1===r.enableZoom)return;!function(e){w.set(e.clientX,e.clientY),S.subVectors(w,b),S.y>0?j(E()):S.y<0&&I(E()),b.copy(w),r.update()}(e);break;case a.PAN:if(!1===r.enablePan)return;!function(e){_.set(e.clientX,e.clientY),x.subVectors(_,v).multiplyScalar(r.panSpeed),P(x.x,x.y),v.copy(_),r.update()}(e)}}(e))}function H(e){Z(e),0===M.length&&(r.domElement.releasePointerCapture(e.pointerId),r.domElement.removeEventListener("pointermove",V),r.domElement.removeEventListener("pointerup",H)),r.dispatchEvent(o),l=a.NONE}function W(e){Z(e)}function X(e){!1!==r.enabled&&!1!==r.enableZoom&&l===a.NONE&&(e.preventDefault(),r.dispatchEvent(s),function(e){e.deltaY<0?I(E()):e.deltaY>0&&j(E()),r.update()}(e),r.dispatchEvent(o))}function q(e){!1!==r.enabled&&!1!==r.enablePan&&function(e){let t=!1;switch(e.code){case r.keys.UP:e.ctrlKey||e.metaKey||e.shiftKey?C(2*Math.PI*r.rotateSpeed/r.domElement.clientHeight):P(0,r.keyPanSpeed),t=!0;break;case r.keys.BOTTOM:e.ctrlKey||e.metaKey||e.shiftKey?C(-2*Math.PI*r.rotateSpeed/r.domElement.clientHeight):P(0,-r.keyPanSpeed),t=!0;break;case r.keys.LEFT:e.ctrlKey||e.metaKey||e.shiftKey?A(2*Math.PI*r.rotateSpeed/r.domElement.clientHeight):P(r.keyPanSpeed,0),t=!0;break;case r.keys.RIGHT:e.ctrlKey||e.metaKey||e.shiftKey?A(-2*Math.PI*r.rotateSpeed/r.domElement.clientHeight):P(-r.keyPanSpeed,0),t=!0}t&&(e.preventDefault(),r.update())}(e)}function Y(e){!1!==r.enabled&&e.preventDefault()}function Z(e){delete T[e.pointerId];for(let t=0;t<M.length;t++)if(M[t].pointerId==e.pointerId)return void M.splice(t,1)}function J(e){let t=T[e.pointerId];void 0===t&&(t=new n.FM8,T[e.pointerId]=t),t.set(e.pageX,e.pageY)}function K(e){const t=e.pointerId===M[0].pointerId?M[1]:M[0];return T[t.pointerId]}r.domElement.addEventListener("contextmenu",Y),r.domElement.addEventListener("pointerdown",G),r.domElement.addEventListener("pointercancel",W),r.domElement.addEventListener("wheel",X,{passive:!1}),this.update()}}},636:(e,t,r)=>{"use strict";r.d(t,{E:()=>s});var n=r(6075);function i(e,t){if(t===n.WwZ)return e;if(t===n.z$h||t===n.UlW){let r=e.getIndex();if(null===r){const t=[],n=e.getAttribute("position");if(void 0===n)return e;for(let e=0;e<n.count;e++)t.push(e);e.setIndex(t),r=e.getIndex()}const i=r.count-2,s=[];if(t===n.z$h)for(let e=1;e<=i;e++)s.push(r.getX(0)),s.push(r.getX(e)),s.push(r.getX(e+1));else for(let e=0;e<i;e++)e%2==0?(s.push(r.getX(e)),s.push(r.getX(e+1)),s.push(r.getX(e+2))):(s.push(r.getX(e+2)),s.push(r.getX(e+1)),s.push(r.getX(e)));s.length;const o=e.clone();return o.setIndex(s),o.clearGroups(),o}return e}class s extends n.aNw{constructor(e){super(e),this.dracoLoader=null,this.ktx2Loader=null,this.meshoptDecoder=null,this.pluginCallbacks=[],this.register((function(e){return new h(e)})),this.register((function(e){return new v(e)})),this.register((function(e){return new _(e)})),this.register((function(e){return new x(e)})),this.register((function(e){return new p(e)})),this.register((function(e){return new f(e)})),this.register((function(e){return new m(e)})),this.register((function(e){return new g(e)})),this.register((function(e){return new u(e)})),this.register((function(e){return new y(e)})),this.register((function(e){return new d(e)})),this.register((function(e){return new l(e)})),this.register((function(e){return new b(e)})),this.register((function(e){return new w(e)}))}load(e,t,r,i){const s=this;let o;o=""!==this.resourcePath?this.resourcePath:""!==this.path?this.path:n.Zp0.extractUrlBase(e),this.manager.itemStart(e);const a=function(t){i&&i(t),s.manager.itemError(e),s.manager.itemEnd(e)},l=new n.hH6(this.manager);l.setPath(this.path),l.setResponseType("arraybuffer"),l.setRequestHeader(this.requestHeader),l.setWithCredentials(this.withCredentials),l.load(e,(function(r){try{s.parse(r,o,(function(r){t(r),s.manager.itemEnd(e)}),a)}catch(e){a(e)}}),r,a)}setDRACOLoader(e){return this.dracoLoader=e,this}setDDSLoader(){throw new Error('THREE.GLTFLoader: "MSFT_texture_dds" no longer supported. Please update to "KHR_texture_basisu".')}setKTX2Loader(e){return this.ktx2Loader=e,this}setMeshoptDecoder(e){return this.meshoptDecoder=e,this}register(e){return-1===this.pluginCallbacks.indexOf(e)&&this.pluginCallbacks.push(e),this}unregister(e){return-1!==this.pluginCallbacks.indexOf(e)&&this.pluginCallbacks.splice(this.pluginCallbacks.indexOf(e),1),this}parse(e,t,r,n){let i;const s={},o={},l=new TextDecoder;if("string"==typeof e)i=JSON.parse(e);else if(e instanceof ArrayBuffer){if(l.decode(new Uint8Array(e,0,4))===S){try{s[a.KHR_BINARY_GLTF]=new E(e)}catch(e){return void(n&&n(e))}i=JSON.parse(s[a.KHR_BINARY_GLTF].content)}else i=JSON.parse(l.decode(e))}else i=e;if(void 0===i.asset||i.asset.version[0]<2)return void(n&&n(new Error("THREE.GLTFLoader: Unsupported asset. glTF versions >=2.0 are supported.")));const u=new K(i,{path:t||this.resourcePath||"",crossOrigin:this.crossOrigin,requestHeader:this.requestHeader,manager:this.manager,ktx2Loader:this.ktx2Loader,meshoptDecoder:this.meshoptDecoder});u.fileLoader.setRequestHeader(this.requestHeader);for(let e=0;e<this.pluginCallbacks.length;e++){const t=this.pluginCallbacks[e](u);o[t.name]=t,s[t.name]=!0}if(i.extensionsUsed)for(let e=0;e<i.extensionsUsed.length;++e){const t=i.extensionsUsed[e],r=i.extensionsRequired||[];switch(t){case a.KHR_MATERIALS_UNLIT:s[t]=new c;break;case a.KHR_DRACO_MESH_COMPRESSION:s[t]=new A(i,this.dracoLoader);break;case a.KHR_TEXTURE_TRANSFORM:s[t]=new C;break;case a.KHR_MESH_QUANTIZATION:s[t]=new L;break;default:r.indexOf(t)>=0&&o[t]}}u.setExtensions(s),u.setPlugins(o),u.parse(r,n)}parseAsync(e,t){const r=this;return new Promise((function(n,i){r.parse(e,t,n,i)}))}}function o(){let e={};return{get:function(t){return e[t]},add:function(t,r){e[t]=r},remove:function(t){delete e[t]},removeAll:function(){e={}}}}const a={KHR_BINARY_GLTF:"KHR_binary_glTF",KHR_DRACO_MESH_COMPRESSION:"KHR_draco_mesh_compression",KHR_LIGHTS_PUNCTUAL:"KHR_lights_punctual",KHR_MATERIALS_CLEARCOAT:"KHR_materials_clearcoat",KHR_MATERIALS_IOR:"KHR_materials_ior",KHR_MATERIALS_SHEEN:"KHR_materials_sheen",KHR_MATERIALS_SPECULAR:"KHR_materials_specular",KHR_MATERIALS_TRANSMISSION:"KHR_materials_transmission",KHR_MATERIALS_IRIDESCENCE:"KHR_materials_iridescence",KHR_MATERIALS_UNLIT:"KHR_materials_unlit",KHR_MATERIALS_VOLUME:"KHR_materials_volume",KHR_TEXTURE_BASISU:"KHR_texture_basisu",KHR_TEXTURE_TRANSFORM:"KHR_texture_transform",KHR_MESH_QUANTIZATION:"KHR_mesh_quantization",KHR_MATERIALS_EMISSIVE_STRENGTH:"KHR_materials_emissive_strength",EXT_TEXTURE_WEBP:"EXT_texture_webp",EXT_TEXTURE_AVIF:"EXT_texture_avif",EXT_MESHOPT_COMPRESSION:"EXT_meshopt_compression",EXT_MESH_GPU_INSTANCING:"EXT_mesh_gpu_instancing"};class l{constructor(e){this.parser=e,this.name=a.KHR_LIGHTS_PUNCTUAL,this.cache={refs:{},uses:{}}}_markDefs(){const e=this.parser,t=this.parser.json.nodes||[];for(let r=0,n=t.length;r<n;r++){const n=t[r];n.extensions&&n.extensions[this.name]&&void 0!==n.extensions[this.name].light&&e._addNodeRef(this.cache,n.extensions[this.name].light)}}_loadLight(e){const t=this.parser,r="light:"+e;let i=t.cache.get(r);if(i)return i;const s=t.json,o=((s.extensions&&s.extensions[this.name]||{}).lights||[])[e];let a;const l=new n.Ilk(16777215);void 0!==o.color&&l.fromArray(o.color);const c=void 0!==o.range?o.range:0;switch(o.type){case"directional":a=new n.Ox3(l),a.target.position.set(0,0,-1),a.add(a.target);break;case"point":a=new n.cek(l),a.distance=c;break;case"spot":a=new n.PMe(l),a.distance=c,o.spot=o.spot||{},o.spot.innerConeAngle=void 0!==o.spot.innerConeAngle?o.spot.innerConeAngle:0,o.spot.outerConeAngle=void 0!==o.spot.outerConeAngle?o.spot.outerConeAngle:Math.PI/4,a.angle=o.spot.outerConeAngle,a.penumbra=1-o.spot.innerConeAngle/o.spot.outerConeAngle,a.target.position.set(0,0,-1),a.add(a.target);break;default:throw new Error("THREE.GLTFLoader: Unexpected light type: "+o.type)}return a.position.set(0,0,0),a.decay=2,W(a,o),void 0!==o.intensity&&(a.intensity=o.intensity),a.name=t.createUniqueName(o.name||"light_"+e),i=Promise.resolve(a),t.cache.add(r,i),i}getDependency(e,t){if("light"===e)return this._loadLight(t)}createNodeAttachment(e){const t=this,r=this.parser,n=r.json.nodes[e],i=(n.extensions&&n.extensions[this.name]||{}).light;return void 0===i?null:this._loadLight(i).then((function(e){return r._getNodeRef(t.cache,i,e)}))}}class c{constructor(){this.name=a.KHR_MATERIALS_UNLIT}getMaterialType(){return n.vBJ}extendParams(e,t,r){const i=[];e.color=new n.Ilk(1,1,1),e.opacity=1;const s=t.pbrMetallicRoughness;if(s){if(Array.isArray(s.baseColorFactor)){const t=s.baseColorFactor;e.color.fromArray(t),e.opacity=t[3]}void 0!==s.baseColorTexture&&i.push(r.assignTexture(e,"map",s.baseColorTexture,n.knz))}return Promise.all(i)}}class u{constructor(e){this.parser=e,this.name=a.KHR_MATERIALS_EMISSIVE_STRENGTH}extendMaterialParams(e,t){const r=this.parser.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const n=r.extensions[this.name].emissiveStrength;return void 0!==n&&(t.emissiveIntensity=n),Promise.resolve()}}class h{constructor(e){this.parser=e,this.name=a.KHR_MATERIALS_CLEARCOAT}getMaterialType(e){const t=this.parser.json.materials[e];return t.extensions&&t.extensions[this.name]?n.EJi:null}extendMaterialParams(e,t){const r=this.parser,i=r.json.materials[e];if(!i.extensions||!i.extensions[this.name])return Promise.resolve();const s=[],o=i.extensions[this.name];if(void 0!==o.clearcoatFactor&&(t.clearcoat=o.clearcoatFactor),void 0!==o.clearcoatTexture&&s.push(r.assignTexture(t,"clearcoatMap",o.clearcoatTexture)),void 0!==o.clearcoatRoughnessFactor&&(t.clearcoatRoughness=o.clearcoatRoughnessFactor),void 0!==o.clearcoatRoughnessTexture&&s.push(r.assignTexture(t,"clearcoatRoughnessMap",o.clearcoatRoughnessTexture)),void 0!==o.clearcoatNormalTexture&&(s.push(r.assignTexture(t,"clearcoatNormalMap",o.clearcoatNormalTexture)),void 0!==o.clearcoatNormalTexture.scale)){const e=o.clearcoatNormalTexture.scale;t.clearcoatNormalScale=new n.FM8(e,e)}return Promise.all(s)}}class d{constructor(e){this.parser=e,this.name=a.KHR_MATERIALS_IRIDESCENCE}getMaterialType(e){const t=this.parser.json.materials[e];return t.extensions&&t.extensions[this.name]?n.EJi:null}extendMaterialParams(e,t){const r=this.parser,n=r.json.materials[e];if(!n.extensions||!n.extensions[this.name])return Promise.resolve();const i=[],s=n.extensions[this.name];return void 0!==s.iridescenceFactor&&(t.iridescence=s.iridescenceFactor),void 0!==s.iridescenceTexture&&i.push(r.assignTexture(t,"iridescenceMap",s.iridescenceTexture)),void 0!==s.iridescenceIor&&(t.iridescenceIOR=s.iridescenceIor),void 0===t.iridescenceThicknessRange&&(t.iridescenceThicknessRange=[100,400]),void 0!==s.iridescenceThicknessMinimum&&(t.iridescenceThicknessRange[0]=s.iridescenceThicknessMinimum),void 0!==s.iridescenceThicknessMaximum&&(t.iridescenceThicknessRange[1]=s.iridescenceThicknessMaximum),void 0!==s.iridescenceThicknessTexture&&i.push(r.assignTexture(t,"iridescenceThicknessMap",s.iridescenceThicknessTexture)),Promise.all(i)}}class p{constructor(e){this.parser=e,this.name=a.KHR_MATERIALS_SHEEN}getMaterialType(e){const t=this.parser.json.materials[e];return t.extensions&&t.extensions[this.name]?n.EJi:null}extendMaterialParams(e,t){const r=this.parser,i=r.json.materials[e];if(!i.extensions||!i.extensions[this.name])return Promise.resolve();const s=[];t.sheenColor=new n.Ilk(0,0,0),t.sheenRoughness=0,t.sheen=1;const o=i.extensions[this.name];return void 0!==o.sheenColorFactor&&t.sheenColor.fromArray(o.sheenColorFactor),void 0!==o.sheenRoughnessFactor&&(t.sheenRoughness=o.sheenRoughnessFactor),void 0!==o.sheenColorTexture&&s.push(r.assignTexture(t,"sheenColorMap",o.sheenColorTexture,n.knz)),void 0!==o.sheenRoughnessTexture&&s.push(r.assignTexture(t,"sheenRoughnessMap",o.sheenRoughnessTexture)),Promise.all(s)}}class f{constructor(e){this.parser=e,this.name=a.KHR_MATERIALS_TRANSMISSION}getMaterialType(e){const t=this.parser.json.materials[e];return t.extensions&&t.extensions[this.name]?n.EJi:null}extendMaterialParams(e,t){const r=this.parser,n=r.json.materials[e];if(!n.extensions||!n.extensions[this.name])return Promise.resolve();const i=[],s=n.extensions[this.name];return void 0!==s.transmissionFactor&&(t.transmission=s.transmissionFactor),void 0!==s.transmissionTexture&&i.push(r.assignTexture(t,"transmissionMap",s.transmissionTexture)),Promise.all(i)}}class m{constructor(e){this.parser=e,this.name=a.KHR_MATERIALS_VOLUME}getMaterialType(e){const t=this.parser.json.materials[e];return t.extensions&&t.extensions[this.name]?n.EJi:null}extendMaterialParams(e,t){const r=this.parser,i=r.json.materials[e];if(!i.extensions||!i.extensions[this.name])return Promise.resolve();const s=[],o=i.extensions[this.name];t.thickness=void 0!==o.thicknessFactor?o.thicknessFactor:0,void 0!==o.thicknessTexture&&s.push(r.assignTexture(t,"thicknessMap",o.thicknessTexture)),t.attenuationDistance=o.attenuationDistance||1/0;const a=o.attenuationColor||[1,1,1];return t.attenuationColor=new n.Ilk(a[0],a[1],a[2]),Promise.all(s)}}class g{constructor(e){this.parser=e,this.name=a.KHR_MATERIALS_IOR}getMaterialType(e){const t=this.parser.json.materials[e];return t.extensions&&t.extensions[this.name]?n.EJi:null}extendMaterialParams(e,t){const r=this.parser.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const n=r.extensions[this.name];return t.ior=void 0!==n.ior?n.ior:1.5,Promise.resolve()}}class y{constructor(e){this.parser=e,this.name=a.KHR_MATERIALS_SPECULAR}getMaterialType(e){const t=this.parser.json.materials[e];return t.extensions&&t.extensions[this.name]?n.EJi:null}extendMaterialParams(e,t){const r=this.parser,i=r.json.materials[e];if(!i.extensions||!i.extensions[this.name])return Promise.resolve();const s=[],o=i.extensions[this.name];t.specularIntensity=void 0!==o.specularFactor?o.specularFactor:1,void 0!==o.specularTexture&&s.push(r.assignTexture(t,"specularIntensityMap",o.specularTexture));const a=o.specularColorFactor||[1,1,1];return t.specularColor=new n.Ilk(a[0],a[1],a[2]),void 0!==o.specularColorTexture&&s.push(r.assignTexture(t,"specularColorMap",o.specularColorTexture,n.knz)),Promise.all(s)}}class v{constructor(e){this.parser=e,this.name=a.KHR_TEXTURE_BASISU}loadTexture(e){const t=this.parser,r=t.json,n=r.textures[e];if(!n.extensions||!n.extensions[this.name])return null;const i=n.extensions[this.name],s=t.options.ktx2Loader;if(!s){if(r.extensionsRequired&&r.extensionsRequired.indexOf(this.name)>=0)throw new Error("THREE.GLTFLoader: setKTX2Loader must be called before loading KTX2 textures");return null}return t.loadTextureImage(e,i.source,s)}}class _{constructor(e){this.parser=e,this.name=a.EXT_TEXTURE_WEBP,this.isSupported=null}loadTexture(e){const t=this.name,r=this.parser,n=r.json,i=n.textures[e];if(!i.extensions||!i.extensions[t])return null;const s=i.extensions[t],o=n.images[s.source];let a=r.textureLoader;if(o.uri){const e=r.options.manager.getHandler(o.uri);null!==e&&(a=e)}return this.detectSupport().then((function(i){if(i)return r.loadTextureImage(e,s.source,a);if(n.extensionsRequired&&n.extensionsRequired.indexOf(t)>=0)throw new Error("THREE.GLTFLoader: WebP required by asset but unsupported.");return r.loadTexture(e)}))}detectSupport(){return this.isSupported||(this.isSupported=new Promise((function(e){const t=new Image;t.src="data:image/webp;base64,UklGRiIAAABXRUJQVlA4IBYAAAAwAQCdASoBAAEADsD+JaQAA3AAAAAA",t.onload=t.onerror=function(){e(1===t.height)}}))),this.isSupported}}class x{constructor(e){this.parser=e,this.name=a.EXT_TEXTURE_AVIF,this.isSupported=null}loadTexture(e){const t=this.name,r=this.parser,n=r.json,i=n.textures[e];if(!i.extensions||!i.extensions[t])return null;const s=i.extensions[t],o=n.images[s.source];let a=r.textureLoader;if(o.uri){const e=r.options.manager.getHandler(o.uri);null!==e&&(a=e)}return this.detectSupport().then((function(i){if(i)return r.loadTextureImage(e,s.source,a);if(n.extensionsRequired&&n.extensionsRequired.indexOf(t)>=0)throw new Error("THREE.GLTFLoader: AVIF required by asset but unsupported.");return r.loadTexture(e)}))}detectSupport(){return this.isSupported||(this.isSupported=new Promise((function(e){const t=new Image;t.src="data:image/avif;base64,AAAAIGZ0eXBhdmlmAAAAAGF2aWZtaWYxbWlhZk1BMUIAAADybWV0YQAAAAAAAAAoaGRscgAAAAAAAAAAcGljdAAAAAAAAAAAAAAAAGxpYmF2aWYAAAAADnBpdG0AAAAAAAEAAAAeaWxvYwAAAABEAAABAAEAAAABAAABGgAAABcAAAAoaWluZgAAAAAAAQAAABppbmZlAgAAAAABAABhdjAxQ29sb3IAAAAAamlwcnAAAABLaXBjbwAAABRpc3BlAAAAAAAAAAEAAAABAAAAEHBpeGkAAAAAAwgICAAAAAxhdjFDgQAMAAAAABNjb2xybmNseAACAAIABoAAAAAXaXBtYQAAAAAAAAABAAEEAQKDBAAAAB9tZGF0EgAKCBgABogQEDQgMgkQAAAAB8dSLfI=",t.onload=t.onerror=function(){e(1===t.height)}}))),this.isSupported}}class b{constructor(e){this.name=a.EXT_MESHOPT_COMPRESSION,this.parser=e}loadBufferView(e){const t=this.parser.json,r=t.bufferViews[e];if(r.extensions&&r.extensions[this.name]){const e=r.extensions[this.name],n=this.parser.getDependency("buffer",e.buffer),i=this.parser.options.meshoptDecoder;if(!i||!i.supported){if(t.extensionsRequired&&t.extensionsRequired.indexOf(this.name)>=0)throw new Error("THREE.GLTFLoader: setMeshoptDecoder must be called before loading compressed files");return null}return n.then((function(t){const r=e.byteOffset||0,n=e.byteLength||0,s=e.count,o=e.byteStride,a=new Uint8Array(t,r,n);return i.decodeGltfBufferAsync?i.decodeGltfBufferAsync(s,o,a,e.mode,e.filter).then((function(e){return e.buffer})):i.ready.then((function(){const t=new ArrayBuffer(s*o);return i.decodeGltfBuffer(new Uint8Array(t),s,o,a,e.mode,e.filter),t}))}))}return null}}class w{constructor(e){this.name=a.EXT_MESH_GPU_INSTANCING,this.parser=e}createNodeMesh(e){const t=this.parser.json,r=t.nodes[e];if(!r.extensions||!r.extensions[this.name]||void 0===r.mesh)return null;const i=t.meshes[r.mesh];for(const e of i.primitives)if(e.mode!==I.TRIANGLES&&e.mode!==I.TRIANGLE_STRIP&&e.mode!==I.TRIANGLE_FAN&&void 0!==e.mode)return null;const s=r.extensions[this.name].attributes,o=[],a={};for(const e in s)o.push(this.parser.getDependency("accessor",s[e]).then((t=>(a[e]=t,a[e]))));return o.length<1?null:(o.push(this.parser.createNodeMesh(e)),Promise.all(o).then((e=>{const t=e.pop(),r=t.isGroup?t.children:[t],i=e[0].count,s=[];for(const e of r){const t=new n.yGw,r=new n.Pa4,o=new n._fP,l=new n.Pa4(1,1,1),c=new n.SPe(e.geometry,e.material,i);for(let e=0;e<i;e++)a.TRANSLATION&&r.fromBufferAttribute(a.TRANSLATION,e),a.ROTATION&&o.fromBufferAttribute(a.ROTATION,e),a.SCALE&&l.fromBufferAttribute(a.SCALE,e),c.setMatrixAt(e,t.compose(r,o,l));for(const t in a)"TRANSLATION"!==t&&"ROTATION"!==t&&"SCALE"!==t&&e.geometry.setAttribute(t,a[t]);n.Tme.prototype.copy.call(c,e),c.frustumCulled=!1,this.parser.assignFinalMaterial(c),s.push(c)}return t.isGroup?(t.clear(),t.add(...s),t):s[0]})))}}const S="glTF",M=1313821514,T=5130562;class E{constructor(e){this.name=a.KHR_BINARY_GLTF,this.content=null,this.body=null;const t=new DataView(e,0,12),r=new TextDecoder;if(this.header={magic:r.decode(new Uint8Array(e.slice(0,4))),version:t.getUint32(4,!0),length:t.getUint32(8,!0)},this.header.magic!==S)throw new Error("THREE.GLTFLoader: Unsupported glTF-Binary header.");if(this.header.version<2)throw new Error("THREE.GLTFLoader: Legacy binary file detected.");const n=this.header.length-12,i=new DataView(e,12);let s=0;for(;s<n;){const t=i.getUint32(s,!0);s+=4;const n=i.getUint32(s,!0);if(s+=4,n===M){const n=new Uint8Array(e,12+s,t);this.content=r.decode(n)}else if(n===T){const r=12+s;this.body=e.slice(r,r+t)}s+=t}if(null===this.content)throw new Error("THREE.GLTFLoader: JSON content not found.")}}class A{constructor(e,t){if(!t)throw new Error("THREE.GLTFLoader: No DRACOLoader instance provided.");this.name=a.KHR_DRACO_MESH_COMPRESSION,this.json=e,this.dracoLoader=t,this.dracoLoader.preload()}decodePrimitive(e,t){const r=this.json,n=this.dracoLoader,i=e.extensions[this.name].bufferView,s=e.extensions[this.name].attributes,o={},a={},l={};for(const e in s){const t=k[e]||e.toLowerCase();o[t]=s[e]}for(const t in e.attributes){const n=k[t]||t.toLowerCase();if(void 0!==s[t]){const i=r.accessors[e.attributes[t]],s=D[i.componentType];l[n]=s.name,a[n]=!0===i.normalized}}return t.getDependency("bufferView",i).then((function(e){return new Promise((function(t){n.decodeDracoFile(e,(function(e){for(const t in e.attributes){const r=e.attributes[t],n=a[t];void 0!==n&&(r.normalized=n)}t(e)}),o,l)}))}))}}class C{constructor(){this.name=a.KHR_TEXTURE_TRANSFORM}extendTexture(e,t){return t.texCoord,void 0===t.offset&&void 0===t.rotation&&void 0===t.scale||(e=e.clone(),void 0!==t.offset&&e.offset.fromArray(t.offset),void 0!==t.rotation&&(e.rotation=t.rotation),void 0!==t.scale&&e.repeat.fromArray(t.scale),e.needsUpdate=!0),e}}class L{constructor(){this.name=a.KHR_MESH_QUANTIZATION}}class R extends n._C8{constructor(e,t,r,n){super(e,t,r,n)}copySampleValue_(e){const t=this.resultBuffer,r=this.sampleValues,n=this.valueSize,i=e*n*3+n;for(let e=0;e!==n;e++)t[e]=r[i+e];return t}interpolate_(e,t,r,n){const i=this.resultBuffer,s=this.sampleValues,o=this.valueSize,a=2*o,l=3*o,c=n-t,u=(r-t)/c,h=u*u,d=h*u,p=e*l,f=p-l,m=-2*d+3*h,g=d-h,y=1-m,v=g-h+u;for(let e=0;e!==o;e++){const t=s[f+e+o],r=s[f+e+a]*c,n=s[p+e+o],l=s[p+e]*c;i[e]=y*t+v*r+m*n+g*l}return i}}const P=new n._fP;class j extends R{interpolate_(e,t,r,n){const i=super.interpolate_(e,t,r,n);return P.fromArray(i).normalize().toArray(i),i}}const I={FLOAT:5126,FLOAT_MAT3:35675,FLOAT_MAT4:35676,FLOAT_VEC2:35664,FLOAT_VEC3:35665,FLOAT_VEC4:35666,LINEAR:9729,REPEAT:10497,SAMPLER_2D:35678,POINTS:0,LINES:1,LINE_LOOP:2,LINE_STRIP:3,TRIANGLES:4,TRIANGLE_STRIP:5,TRIANGLE_FAN:6,UNSIGNED_BYTE:5121,UNSIGNED_SHORT:5123},D={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array},O={9728:n.TyD,9729:n.wem,9984:n.YLQ,9985:n.qyh,9986:n.aH4,9987:n.D1R},N={33071:n.uWy,33648:n.OoA,10497:n.rpg},U={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},k={POSITION:"position",NORMAL:"normal",TANGENT:"tangent",TEXCOORD_0:"uv",TEXCOORD_1:"uv2",COLOR_0:"color",WEIGHTS_0:"skinWeight",JOINTS_0:"skinIndex"},F={scale:"scale",translation:"position",rotation:"quaternion",weights:"morphTargetInfluences"},B={CUBICSPLINE:void 0,LINEAR:n.NMF,STEP:n.Syv},z="OPAQUE",G="MASK",V="BLEND";function H(e,t,r){for(const n in r.extensions)void 0===e[n]&&(t.userData.gltfExtensions=t.userData.gltfExtensions||{},t.userData.gltfExtensions[n]=r.extensions[n])}function W(e,t){void 0!==t.extras&&"object"==typeof t.extras&&Object.assign(e.userData,t.extras)}function X(e,t){if(e.updateMorphTargets(),void 0!==t.weights)for(let r=0,n=t.weights.length;r<n;r++)e.morphTargetInfluences[r]=t.weights[r];if(t.extras&&Array.isArray(t.extras.targetNames)){const r=t.extras.targetNames;if(e.morphTargetInfluences.length===r.length){e.morphTargetDictionary={};for(let t=0,n=r.length;t<n;t++)e.morphTargetDictionary[r[t]]=t}}}function q(e){const t=e.extensions&&e.extensions[a.KHR_DRACO_MESH_COMPRESSION];let r;return r=t?"draco:"+t.bufferView+":"+t.indices+":"+Y(t.attributes):e.indices+":"+Y(e.attributes)+":"+e.mode,r}function Y(e){let t="";const r=Object.keys(e).sort();for(let n=0,i=r.length;n<i;n++)t+=r[n]+":"+e[r[n]]+";";return t}function Z(e){switch(e){case Int8Array:return 1/127;case Uint8Array:return 1/255;case Int16Array:return 1/32767;case Uint16Array:return 1/65535;default:throw new Error("THREE.GLTFLoader: Unsupported normalized accessor component type.")}}const J=new n.yGw;class K{constructor(e={},t={}){this.json=e,this.extensions={},this.plugins={},this.options=t,this.cache=new o,this.associations=new Map,this.primitiveCache={},this.nodeCache={},this.meshCache={refs:{},uses:{}},this.cameraCache={refs:{},uses:{}},this.lightCache={refs:{},uses:{}},this.sourceCache={},this.textureCache={},this.nodeNamesUsed={};let r=!1,i=!1,s=-1;"undefined"!=typeof navigator&&(r=!0===/^((?!chrome|android).)*safari/i.test(navigator.userAgent),i=navigator.userAgent.indexOf("Firefox")>-1,s=i?navigator.userAgent.match(/Firefox\/([0-9]+)\./)[1]:-1),"undefined"==typeof createImageBitmap||r||i&&s<98?this.textureLoader=new n.dpR(this.options.manager):this.textureLoader=new n.QRU(this.options.manager),this.textureLoader.setCrossOrigin(this.options.crossOrigin),this.textureLoader.setRequestHeader(this.options.requestHeader),this.fileLoader=new n.hH6(this.options.manager),this.fileLoader.setResponseType("arraybuffer"),"use-credentials"===this.options.crossOrigin&&this.fileLoader.setWithCredentials(!0)}setExtensions(e){this.extensions=e}setPlugins(e){this.plugins=e}parse(e,t){const r=this,n=this.json,i=this.extensions;this.cache.removeAll(),this.nodeCache={},this._invokeAll((function(e){return e._markDefs&&e._markDefs()})),Promise.all(this._invokeAll((function(e){return e.beforeRoot&&e.beforeRoot()}))).then((function(){return Promise.all([r.getDependencies("scene"),r.getDependencies("animation"),r.getDependencies("camera")])})).then((function(t){const s={scene:t[0][n.scene||0],scenes:t[0],animations:t[1],cameras:t[2],asset:n.asset,parser:r,userData:{}};H(i,s,n),W(s,n),Promise.all(r._invokeAll((function(e){return e.afterRoot&&e.afterRoot(s)}))).then((function(){e(s)}))})).catch(t)}_markDefs(){const e=this.json.nodes||[],t=this.json.skins||[],r=this.json.meshes||[];for(let r=0,n=t.length;r<n;r++){const n=t[r].joints;for(let t=0,r=n.length;t<r;t++)e[n[t]].isBone=!0}for(let t=0,n=e.length;t<n;t++){const n=e[t];void 0!==n.mesh&&(this._addNodeRef(this.meshCache,n.mesh),void 0!==n.skin&&(r[n.mesh].isSkinnedMesh=!0)),void 0!==n.camera&&this._addNodeRef(this.cameraCache,n.camera)}}_addNodeRef(e,t){void 0!==t&&(void 0===e.refs[t]&&(e.refs[t]=e.uses[t]=0),e.refs[t]++)}_getNodeRef(e,t,r){if(e.refs[t]<=1)return r;const n=r.clone(),i=(e,t)=>{const r=this.associations.get(e);null!=r&&this.associations.set(t,r);for(const[r,n]of e.children.entries())i(n,t.children[r])};return i(r,n),n.name+="_instance_"+e.uses[t]++,n}_invokeOne(e){const t=Object.values(this.plugins);t.push(this);for(let r=0;r<t.length;r++){const n=e(t[r]);if(n)return n}return null}_invokeAll(e){const t=Object.values(this.plugins);t.unshift(this);const r=[];for(let n=0;n<t.length;n++){const i=e(t[n]);i&&r.push(i)}return r}getDependency(e,t){const r=e+":"+t;let n=this.cache.get(r);if(!n){switch(e){case"scene":n=this.loadScene(t);break;case"node":n=this._invokeOne((function(e){return e.loadNode&&e.loadNode(t)}));break;case"mesh":n=this._invokeOne((function(e){return e.loadMesh&&e.loadMesh(t)}));break;case"accessor":n=this.loadAccessor(t);break;case"bufferView":n=this._invokeOne((function(e){return e.loadBufferView&&e.loadBufferView(t)}));break;case"buffer":n=this.loadBuffer(t);break;case"material":n=this._invokeOne((function(e){return e.loadMaterial&&e.loadMaterial(t)}));break;case"texture":n=this._invokeOne((function(e){return e.loadTexture&&e.loadTexture(t)}));break;case"skin":n=this.loadSkin(t);break;case"animation":n=this._invokeOne((function(e){return e.loadAnimation&&e.loadAnimation(t)}));break;case"camera":n=this.loadCamera(t);break;default:if(n=this._invokeOne((function(r){return r!=this&&r.getDependency&&r.getDependency(e,t)})),!n)throw new Error("Unknown type: "+e)}this.cache.add(r,n)}return n}getDependencies(e){let t=this.cache.get(e);if(!t){const r=this,n=this.json[e+("mesh"===e?"es":"s")]||[];t=Promise.all(n.map((function(t,n){return r.getDependency(e,n)}))),this.cache.add(e,t)}return t}loadBuffer(e){const t=this.json.buffers[e],r=this.fileLoader;if(t.type&&"arraybuffer"!==t.type)throw new Error("THREE.GLTFLoader: "+t.type+" buffer type is not supported.");if(void 0===t.uri&&0===e)return Promise.resolve(this.extensions[a.KHR_BINARY_GLTF].body);const i=this.options;return new Promise((function(e,s){r.load(n.Zp0.resolveURL(t.uri,i.path),e,void 0,(function(){s(new Error('THREE.GLTFLoader: Failed to load buffer "'+t.uri+'".'))}))}))}loadBufferView(e){const t=this.json.bufferViews[e];return this.getDependency("buffer",t.buffer).then((function(e){const r=t.byteLength||0,n=t.byteOffset||0;return e.slice(n,n+r)}))}loadAccessor(e){const t=this,r=this.json,i=this.json.accessors[e];if(void 0===i.bufferView&&void 0===i.sparse){const e=U[i.type],t=D[i.componentType],r=!0===i.normalized,s=new t(i.count*e);return Promise.resolve(new n.TlE(s,e,r))}const s=[];return void 0!==i.bufferView?s.push(this.getDependency("bufferView",i.bufferView)):s.push(null),void 0!==i.sparse&&(s.push(this.getDependency("bufferView",i.sparse.indices.bufferView)),s.push(this.getDependency("bufferView",i.sparse.values.bufferView))),Promise.all(s).then((function(e){const s=e[0],o=U[i.type],a=D[i.componentType],l=a.BYTES_PER_ELEMENT,c=l*o,u=i.byteOffset||0,h=void 0!==i.bufferView?r.bufferViews[i.bufferView].byteStride:void 0,d=!0===i.normalized;let p,f;if(h&&h!==c){const e=Math.floor(u/h),r="InterleavedBuffer:"+i.bufferView+":"+i.componentType+":"+e+":"+i.count;let c=t.cache.get(r);c||(p=new a(s,e*h,i.count*h/l),c=new n.vpT(p,h/l),t.cache.add(r,c)),f=new n.kB5(c,o,u%h/l,d)}else p=null===s?new a(i.count*o):new a(s,u,i.count*o),f=new n.TlE(p,o,d);if(void 0!==i.sparse){const t=U.SCALAR,r=D[i.sparse.indices.componentType],l=i.sparse.indices.byteOffset||0,c=i.sparse.values.byteOffset||0,u=new r(e[1],l,i.sparse.count*t),h=new a(e[2],c,i.sparse.count*o);null!==s&&(f=new n.TlE(f.array.slice(),f.itemSize,f.normalized));for(let e=0,t=u.length;e<t;e++){const t=u[e];if(f.setX(t,h[e*o]),o>=2&&f.setY(t,h[e*o+1]),o>=3&&f.setZ(t,h[e*o+2]),o>=4&&f.setW(t,h[e*o+3]),o>=5)throw new Error("THREE.GLTFLoader: Unsupported itemSize in sparse BufferAttribute.")}}return f}))}loadTexture(e){const t=this.json,r=this.options,n=t.textures[e].source,i=t.images[n];let s=this.textureLoader;if(i.uri){const e=r.manager.getHandler(i.uri);null!==e&&(s=e)}return this.loadTextureImage(e,n,s)}loadTextureImage(e,t,r){const i=this,s=this.json,o=s.textures[e],a=s.images[t],l=(a.uri||a.bufferView)+":"+o.sampler;if(this.textureCache[l])return this.textureCache[l];const c=this.loadImageSource(t,r).then((function(t){t.flipY=!1,t.name=o.name||a.name||"";const r=(s.samplers||{})[o.sampler]||{};return t.magFilter=O[r.magFilter]||n.wem,t.minFilter=O[r.minFilter]||n.D1R,t.wrapS=N[r.wrapS]||n.rpg,t.wrapT=N[r.wrapT]||n.rpg,i.associations.set(t,{textures:e}),t})).catch((function(){return null}));return this.textureCache[l]=c,c}loadImageSource(e,t){const r=this,i=this.json,s=this.options;if(void 0!==this.sourceCache[e])return this.sourceCache[e].then((e=>e.clone()));const o=i.images[e],a=self.URL||self.webkitURL;let l=o.uri||"",c=!1;if(void 0!==o.bufferView)l=r.getDependency("bufferView",o.bufferView).then((function(e){c=!0;const t=new Blob([e],{type:o.mimeType});return l=a.createObjectURL(t),l}));else if(void 0===o.uri)throw new Error("THREE.GLTFLoader: Image "+e+" is missing URI and bufferView");const u=Promise.resolve(l).then((function(e){return new Promise((function(r,i){let o=r;!0===t.isImageBitmapLoader&&(o=function(e){const t=new n.xEZ(e);t.needsUpdate=!0,r(t)}),t.load(n.Zp0.resolveURL(e,s.path),o,void 0,i)}))})).then((function(e){var t;return!0===c&&a.revokeObjectURL(l),e.userData.mimeType=o.mimeType||((t=o.uri).search(/\.jpe?g($|\?)/i)>0||0===t.search(/^data\:image\/jpeg/)?"image/jpeg":t.search(/\.webp($|\?)/i)>0||0===t.search(/^data\:image\/webp/)?"image/webp":"image/png"),e})).catch((function(e){throw e}));return this.sourceCache[e]=u,u}assignTexture(e,t,r,n){const i=this;return this.getDependency("texture",r.index).then((function(s){if(!s)return null;if(void 0!==r.texCoord&&0!=r.texCoord&&("aoMap"!==t||r.texCoord),i.extensions[a.KHR_TEXTURE_TRANSFORM]){const e=void 0!==r.extensions?r.extensions[a.KHR_TEXTURE_TRANSFORM]:void 0;if(e){const t=i.associations.get(s);s=i.extensions[a.KHR_TEXTURE_TRANSFORM].extendTexture(s,e),i.associations.set(s,t)}}return void 0!==n&&(s.encoding=n),e[t]=s,s}))}assignFinalMaterial(e){const t=e.geometry;let r=e.material;const i=void 0===t.attributes.tangent,s=void 0!==t.attributes.color,o=void 0===t.attributes.normal;if(e.isPoints){const e="PointsMaterial:"+r.uuid;let t=this.cache.get(e);t||(t=new n.UY4,n.F5T.prototype.copy.call(t,r),t.color.copy(r.color),t.map=r.map,t.sizeAttenuation=!1,this.cache.add(e,t)),r=t}else if(e.isLine){const e="LineBasicMaterial:"+r.uuid;let t=this.cache.get(e);t||(t=new n.nls,n.F5T.prototype.copy.call(t,r),t.color.copy(r.color),this.cache.add(e,t)),r=t}if(i||s||o){let e="ClonedMaterial:"+r.uuid+":";i&&(e+="derivative-tangents:"),s&&(e+="vertex-colors:"),o&&(e+="flat-shading:");let t=this.cache.get(e);t||(t=r.clone(),s&&(t.vertexColors=!0),o&&(t.flatShading=!0),i&&(t.normalScale&&(t.normalScale.y*=-1),t.clearcoatNormalScale&&(t.clearcoatNormalScale.y*=-1)),this.cache.add(e,t),this.associations.set(t,this.associations.get(r))),r=t}r.aoMap&&void 0===t.attributes.uv2&&void 0!==t.attributes.uv&&t.setAttribute("uv2",t.attributes.uv),e.material=r}getMaterialType(){return n.Wid}loadMaterial(e){const t=this,r=this.json,i=this.extensions,s=r.materials[e];let o;const l={},c=[];if((s.extensions||{})[a.KHR_MATERIALS_UNLIT]){const e=i[a.KHR_MATERIALS_UNLIT];o=e.getMaterialType(),c.push(e.extendParams(l,s,t))}else{const r=s.pbrMetallicRoughness||{};if(l.color=new n.Ilk(1,1,1),l.opacity=1,Array.isArray(r.baseColorFactor)){const e=r.baseColorFactor;l.color.fromArray(e),l.opacity=e[3]}void 0!==r.baseColorTexture&&c.push(t.assignTexture(l,"map",r.baseColorTexture,n.knz)),l.metalness=void 0!==r.metallicFactor?r.metallicFactor:1,l.roughness=void 0!==r.roughnessFactor?r.roughnessFactor:1,void 0!==r.metallicRoughnessTexture&&(c.push(t.assignTexture(l,"metalnessMap",r.metallicRoughnessTexture)),c.push(t.assignTexture(l,"roughnessMap",r.metallicRoughnessTexture))),o=this._invokeOne((function(t){return t.getMaterialType&&t.getMaterialType(e)})),c.push(Promise.all(this._invokeAll((function(t){return t.extendMaterialParams&&t.extendMaterialParams(e,l)}))))}!0===s.doubleSided&&(l.side=n.ehD);const u=s.alphaMode||z;if(u===V?(l.transparent=!0,l.depthWrite=!1):(l.transparent=!1,u===G&&(l.alphaTest=void 0!==s.alphaCutoff?s.alphaCutoff:.5)),void 0!==s.normalTexture&&o!==n.vBJ&&(c.push(t.assignTexture(l,"normalMap",s.normalTexture)),l.normalScale=new n.FM8(1,1),void 0!==s.normalTexture.scale)){const e=s.normalTexture.scale;l.normalScale.set(e,e)}return void 0!==s.occlusionTexture&&o!==n.vBJ&&(c.push(t.assignTexture(l,"aoMap",s.occlusionTexture)),void 0!==s.occlusionTexture.strength&&(l.aoMapIntensity=s.occlusionTexture.strength)),void 0!==s.emissiveFactor&&o!==n.vBJ&&(l.emissive=(new n.Ilk).fromArray(s.emissiveFactor)),void 0!==s.emissiveTexture&&o!==n.vBJ&&c.push(t.assignTexture(l,"emissiveMap",s.emissiveTexture,n.knz)),Promise.all(c).then((function(){const r=new o(l);return s.name&&(r.name=s.name),W(r,s),t.associations.set(r,{materials:e}),s.extensions&&H(i,r,s),r}))}createUniqueName(e){const t=n.iUV.sanitizeNodeName(e||"");let r=t;for(let e=1;this.nodeNamesUsed[r];++e)r=t+"_"+e;return this.nodeNamesUsed[r]=!0,r}loadGeometries(e){const t=this,r=this.extensions,i=this.primitiveCache;function s(e){return r[a.KHR_DRACO_MESH_COMPRESSION].decodePrimitive(e,t).then((function(r){return Q(r,e,t)}))}const o=[];for(let r=0,l=e.length;r<l;r++){const l=e[r],c=q(l),u=i[c];if(u)o.push(u.promise);else{let e;e=l.extensions&&l.extensions[a.KHR_DRACO_MESH_COMPRESSION]?s(l):Q(new n.u9r,l,t),i[c]={primitive:l,promise:e},o.push(e)}}return Promise.all(o)}loadMesh(e){const t=this,r=this.json,s=this.extensions,o=r.meshes[e],a=o.primitives,l=[];for(let e=0,t=a.length;e<t;e++){const t=void 0===a[e].material?(void 0===(c=this.cache).DefaultMaterial&&(c.DefaultMaterial=new n.Wid({color:16777215,emissive:0,metalness:1,roughness:1,transparent:!1,depthTest:!0,side:n.Wl3})),c.DefaultMaterial):this.getDependency("material",a[e].material);l.push(t)}var c;return l.push(t.loadGeometries(a)),Promise.all(l).then((function(r){const l=r.slice(0,r.length-1),c=r[r.length-1],u=[];for(let r=0,h=c.length;r<h;r++){const h=c[r],d=a[r];let p;const f=l[r];if(d.mode===I.TRIANGLES||d.mode===I.TRIANGLE_STRIP||d.mode===I.TRIANGLE_FAN||void 0===d.mode)p=!0===o.isSkinnedMesh?new n.TUv(h,f):new n.Kj0(h,f),!0===p.isSkinnedMesh&&p.normalizeSkinWeights(),d.mode===I.TRIANGLE_STRIP?p.geometry=i(p.geometry,n.UlW):d.mode===I.TRIANGLE_FAN&&(p.geometry=i(p.geometry,n.z$h));else if(d.mode===I.LINES)p=new n.ejS(h,f);else if(d.mode===I.LINE_STRIP)p=new n.x12(h,f);else if(d.mode===I.LINE_LOOP)p=new n.blk(h,f);else{if(d.mode!==I.POINTS)throw new Error("THREE.GLTFLoader: Primitive mode unsupported: "+d.mode);p=new n.woe(h,f)}Object.keys(p.geometry.morphAttributes).length>0&&X(p,o),p.name=t.createUniqueName(o.name||"mesh_"+e),W(p,o),d.extensions&&H(s,p,d),t.assignFinalMaterial(p),u.push(p)}for(let r=0,n=u.length;r<n;r++)t.associations.set(u[r],{meshes:e,primitives:r});if(1===u.length)return u[0];const h=new n.ZAu;t.associations.set(h,{meshes:e});for(let e=0,t=u.length;e<t;e++)h.add(u[e]);return h}))}loadCamera(e){let t;const r=this.json.cameras[e],i=r[r.type];if(i)return"perspective"===r.type?t=new n.cPb(n.M8C.radToDeg(i.yfov),i.aspectRatio||1,i.znear||1,i.zfar||2e6):"orthographic"===r.type&&(t=new n.iKG(-i.xmag,i.xmag,i.ymag,-i.ymag,i.znear,i.zfar)),r.name&&(t.name=this.createUniqueName(r.name)),W(t,r),Promise.resolve(t)}loadSkin(e){const t=this.json.skins[e],r=[];for(let e=0,n=t.joints.length;e<n;e++)r.push(this._loadNodeShallow(t.joints[e]));return void 0!==t.inverseBindMatrices?r.push(this.getDependency("accessor",t.inverseBindMatrices)):r.push(null),Promise.all(r).then((function(e){const t=e.pop(),r=e,i=[],s=[];for(let e=0,o=r.length;e<o;e++){const o=r[e];if(o){i.push(o);const r=new n.yGw;null!==t&&r.fromArray(t.array,16*e),s.push(r)}}return new n.OdW(i,s)}))}loadAnimation(e){const t=this.json.animations[e],r=[],i=[],s=[],o=[],a=[];for(let e=0,n=t.channels.length;e<n;e++){const n=t.channels[e],l=t.samplers[n.sampler],c=n.target,u=c.node,h=void 0!==t.parameters?t.parameters[l.input]:l.input,d=void 0!==t.parameters?t.parameters[l.output]:l.output;r.push(this.getDependency("node",u)),i.push(this.getDependency("accessor",h)),s.push(this.getDependency("accessor",d)),o.push(l),a.push(c)}return Promise.all([Promise.all(r),Promise.all(i),Promise.all(s),Promise.all(o),Promise.all(a)]).then((function(r){const i=r[0],s=r[1],o=r[2],a=r[3],l=r[4],c=[];for(let e=0,t=i.length;e<t;e++){const t=i[e],r=s[e],u=o[e],h=a[e],d=l[e];if(void 0===t)continue;let p;switch(t.updateMatrix(),F[d.path]){case F.weights:p=n.dUE;break;case F.rotation:p=n.iLg;break;default:p=n.yC1}const f=t.name?t.name:t.uuid,m=void 0!==h.interpolation?B[h.interpolation]:n.NMF,g=[];F[d.path]===F.weights?t.traverse((function(e){e.morphTargetInfluences&&g.push(e.name?e.name:e.uuid)})):g.push(f);let y=u.array;if(u.normalized){const e=Z(y.constructor),t=new Float32Array(y.length);for(let r=0,n=y.length;r<n;r++)t[r]=y[r]*e;y=t}for(let e=0,t=g.length;e<t;e++){const t=new p(g[e]+"."+F[d.path],r.array,y,m);"CUBICSPLINE"===h.interpolation&&(t.createInterpolant=function(e){return new(this instanceof n.iLg?j:R)(this.times,this.values,this.getValueSize()/3,e)},t.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline=!0),c.push(t)}}const u=t.name?t.name:"animation_"+e;return new n.m7l(u,void 0,c)}))}createNodeMesh(e){const t=this.json,r=this,n=t.nodes[e];return void 0===n.mesh?null:r.getDependency("mesh",n.mesh).then((function(e){const t=r._getNodeRef(r.meshCache,n.mesh,e);return void 0!==n.weights&&t.traverse((function(e){if(e.isMesh)for(let t=0,r=n.weights.length;t<r;t++)e.morphTargetInfluences[t]=n.weights[t]})),t}))}loadNode(e){const t=this,r=this.json.nodes[e],n=t._loadNodeShallow(e),i=[],s=r.children||[];for(let e=0,r=s.length;e<r;e++)i.push(t.getDependency("node",s[e]));const o=void 0===r.skin?Promise.resolve(null):t.getDependency("skin",r.skin);return Promise.all([n,Promise.all(i),o]).then((function(e){const t=e[0],r=e[1],n=e[2];null!==n&&t.traverse((function(e){e.isSkinnedMesh&&e.bind(n,J)}));for(let e=0,n=r.length;e<n;e++)t.add(r[e]);return t}))}_loadNodeShallow(e){const t=this.json,r=this.extensions,i=this;if(void 0!==this.nodeCache[e])return this.nodeCache[e];const s=t.nodes[e],o=s.name?i.createUniqueName(s.name):"",a=[],l=i._invokeOne((function(t){return t.createNodeMesh&&t.createNodeMesh(e)}));return l&&a.push(l),void 0!==s.camera&&a.push(i.getDependency("camera",s.camera).then((function(e){return i._getNodeRef(i.cameraCache,s.camera,e)}))),i._invokeAll((function(t){return t.createNodeAttachment&&t.createNodeAttachment(e)})).forEach((function(e){a.push(e)})),this.nodeCache[e]=Promise.all(a).then((function(t){let a;if(a=!0===s.isBone?new n.N$j:t.length>1?new n.ZAu:1===t.length?t[0]:new n.Tme,a!==t[0])for(let e=0,r=t.length;e<r;e++)a.add(t[e]);if(s.name&&(a.userData.name=s.name,a.name=o),W(a,s),s.extensions&&H(r,a,s),void 0!==s.matrix){const e=new n.yGw;e.fromArray(s.matrix),a.applyMatrix4(e)}else void 0!==s.translation&&a.position.fromArray(s.translation),void 0!==s.rotation&&a.quaternion.fromArray(s.rotation),void 0!==s.scale&&a.scale.fromArray(s.scale);return i.associations.has(a)||i.associations.set(a,{}),i.associations.get(a).nodes=e,a})),this.nodeCache[e]}loadScene(e){const t=this.extensions,r=this.json.scenes[e],i=this,s=new n.ZAu;r.name&&(s.name=i.createUniqueName(r.name)),W(s,r),r.extensions&&H(t,s,r);const o=r.nodes||[],a=[];for(let e=0,t=o.length;e<t;e++)a.push(i.getDependency("node",o[e]));return Promise.all(a).then((function(e){for(let t=0,r=e.length;t<r;t++)s.add(e[t]);return i.associations=(e=>{const t=new Map;for(const[e,r]of i.associations)(e instanceof n.F5T||e instanceof n.xEZ)&&t.set(e,r);return e.traverse((e=>{const r=i.associations.get(e);null!=r&&t.set(e,r)})),t})(s),s}))}}function Q(e,t,r){const i=t.attributes,s=[];function o(t,n){return r.getDependency("accessor",t).then((function(t){e.setAttribute(n,t)}))}for(const t in i){const r=k[t]||t.toLowerCase();r in e.attributes||s.push(o(i[t],r))}if(void 0!==t.indices&&!e.index){const n=r.getDependency("accessor",t.indices).then((function(t){e.setIndex(t)}));s.push(n)}return W(e,t),function(e,t,r){const i=t.attributes,s=new n.ZzF;if(void 0===i.POSITION)return;{const e=r.json.accessors[i.POSITION],t=e.min,o=e.max;if(void 0===t||void 0===o)return;if(s.set(new n.Pa4(t[0],t[1],t[2]),new n.Pa4(o[0],o[1],o[2])),e.normalized){const t=Z(D[e.componentType]);s.min.multiplyScalar(t),s.max.multiplyScalar(t)}}const o=t.targets;if(void 0!==o){const e=new n.Pa4,t=new n.Pa4;for(let n=0,i=o.length;n<i;n++){const i=o[n];if(void 0!==i.POSITION){const n=r.json.accessors[i.POSITION],s=n.min,o=n.max;if(void 0!==s&&void 0!==o){if(t.setX(Math.max(Math.abs(s[0]),Math.abs(o[0]))),t.setY(Math.max(Math.abs(s[1]),Math.abs(o[1]))),t.setZ(Math.max(Math.abs(s[2]),Math.abs(o[2]))),n.normalized){const e=Z(D[n.componentType]);t.multiplyScalar(e)}e.max(t)}}}s.expandByVector(e)}e.boundingBox=s;const a=new n.aLr;s.getCenter(a.center),a.radius=s.min.distanceTo(s.max)/2,e.boundingSphere=a}(e,t,r),Promise.all(s).then((function(){return void 0!==t.targets?function(e,t,r){let n=!1,i=!1,s=!1;for(let e=0,r=t.length;e<r;e++){const r=t[e];if(void 0!==r.POSITION&&(n=!0),void 0!==r.NORMAL&&(i=!0),void 0!==r.COLOR_0&&(s=!0),n&&i&&s)break}if(!n&&!i&&!s)return Promise.resolve(e);const o=[],a=[],l=[];for(let c=0,u=t.length;c<u;c++){const u=t[c];if(n){const t=void 0!==u.POSITION?r.getDependency("accessor",u.POSITION):e.attributes.position;o.push(t)}if(i){const t=void 0!==u.NORMAL?r.getDependency("accessor",u.NORMAL):e.attributes.normal;a.push(t)}if(s){const t=void 0!==u.COLOR_0?r.getDependency("accessor",u.COLOR_0):e.attributes.color;l.push(t)}}return Promise.all([Promise.all(o),Promise.all(a),Promise.all(l)]).then((function(t){const r=t[0],o=t[1],a=t[2];return n&&(e.morphAttributes.position=r),i&&(e.morphAttributes.normal=o),s&&(e.morphAttributes.color=a),e.morphTargetsRelative=!0,e}))}(e,t.targets,r):e}))}},9352:(e,t,r)=>{"use strict";r.d(t,{M:()=>u,j:()=>i});var n=r(6075);class i extends n.Tme{constructor(e=document.createElement("div")){super(),this.isCSS2DObject=!0,this.element=e,this.element.style.position="absolute",this.element.style.userSelect="none",this.element.setAttribute("draggable",!1),this.addEventListener("removed",(function(){this.traverse((function(e){e.element instanceof Element&&null!==e.element.parentNode&&e.element.parentNode.removeChild(e.element)}))}))}copy(e,t){return super.copy(e,t),this.element=e.element.cloneNode(!0),this}}const s=new n.Pa4,o=new n.yGw,a=new n.yGw,l=new n.Pa4,c=new n.Pa4;class u{constructor(e={}){const t=this;let r,n,i,u;const h={objects:new WeakMap},d=void 0!==e.element?e.element:document.createElement("div");function p(e,r,n){if(e.isCSS2DObject){s.setFromMatrixPosition(e.matrixWorld),s.applyMatrix4(a);const o=!0===e.visible&&s.z>=-1&&s.z<=1&&!0===e.layers.test(n.layers);if(e.element.style.display=!0===o?"":"none",!0===o){e.onBeforeRender(t,r,n);const o=e.element;o.style.transform="translate(-50%,-50%) translate("+(s.x*i+i)+"px,"+(-s.y*u+u)+"px)",o.parentNode!==d&&d.appendChild(o),e.onAfterRender(t,r,n)}const l={distanceToCameraSquared:f(n,e)};h.objects.set(e,l)}for(let t=0,i=e.children.length;t<i;t++)p(e.children[t],r,n)}function f(e,t){return l.setFromMatrixPosition(e.matrixWorld),c.setFromMatrixPosition(t.matrixWorld),l.distanceToSquared(c)}d.style.overflow="hidden",this.domElement=d,this.getSize=function(){return{width:r,height:n}},this.render=function(e,t){!0===e.matrixWorldAutoUpdate&&e.updateMatrixWorld(),null===t.parent&&!0===t.matrixWorldAutoUpdate&&t.updateMatrixWorld(),o.copy(t.matrixWorldInverse),a.multiplyMatrices(t.projectionMatrix,o),p(e,e,t),function(e){const t=function(e){const t=[];return e.traverse((function(e){e.isCSS2DObject&&t.push(e)})),t}(e).sort((function(e,t){if(e.renderOrder!==t.renderOrder)return t.renderOrder-e.renderOrder;return h.objects.get(e).distanceToCameraSquared-h.objects.get(t).distanceToCameraSquared})),r=t.length;for(let e=0,n=t.length;e<n;e++)t[e].element.style.zIndex=r-e}(e)},this.setSize=function(e,t){r=e,n=t,i=r/2,u=n/2,d.style.width=e+"px",d.style.height=t+"px"}}}}}]);